{
  "task_id": "2020_C",
  "problem": "本赛题包含2个附件（数据文件），四个课题任务。具体说明如下：\n\n附件1：P300脑机接口实验数据\n\n提供了5个健康成年被试（S1-S5）的P300脑机接口实验数据，平均年龄为20岁。在实验的过程中，要求每一位被试（被测试者）集中注意力。P300脑机接口实验的设计如下：每位被试能够观察到一个由36个字符组成的字符矩阵，如图3所示，字符矩阵以行或列为单位（共6行6列）。每轮实验的设计流程：首先，提示被试注视“目标字符”，例如在图3的字符矩阵上方，出现的灰色字符“A”；其次，进入字符矩阵的闪烁模式，每次以随机的顺序闪烁字符矩阵的一行或一列，闪烁时长为80毫秒，间隔为80毫秒；最后，当所有行和列均闪烁一次后，则结束一轮实验。在被试注视“目标字符”的过程中，当目标字符所在行或列闪烁时，脑电信号中会出现P300电位；而当其他行和列闪烁时，则不会出现P300电位。上述实验流程为1轮，共重复5轮。\n\n每位被试的P300脑电数据包含有4个文件，具体说明如下：\n\n- \\texttt{train\\_data}: 训练用数据；\n- \\texttt{train\\_event}: 训练数据的事件标签；\n- \\texttt{test\\_data}: 测试用数据；\n- \\texttt{test\\_event}: 测试数据的事件标签。\n\n训练用数据包括12个已知目标字符的数据（char01~char12），测试用数据包括10个待识别目标字符的数据（char13~char22）。每个字符矩阵闪烁实验中，脑电数据表格包含有 $20$ 列（每列表示 $1$ 个记录通道，记录通道依次进行编号，表1为记录通道的标识符，图5对应了记录通道的位置），脑电数据表格的行表示样本点数据，采样频率为 $250Hz$。信号采集设备设置了参考电极和接地电极，即记录通道的信号为作用电极与参考电极之间的差值。\n\n\\begin{table}[H]\n\\centering\n\\caption{采集通道的标识符}\n\\begin{tabular}{|c|c|c|c|}\n\\hline\n标识符 & 通道名称 & 标识符 & 通道名称 \\\\\n\\hline\n1 & Fz & 11 & CP6 \\\\\n2 & F3 & 12 & O1 \\\\\n3 & F4 & 13 & O2 \\\\\n4 & C3 & 14 & P7 \\\\\n5 & Cz & 15 & P8 \\\\\n6 & C4 & 16 & T7 \\\\\n7 & P3 & 17 & T8 \\\\\n8 & Pz & 18 & CP3 \\\\\n9 & P4 & 19 & CP4 \\\\\n10 & CP5 & 20 & Oz \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=0.6\\textwidth]{brain_channel.png}\n\\caption{脑电信号采集通道图}\n\\end{figure}\n\n训练数据中的标签文件同样是以子表形式与实验数据相对应，子表的名称为 “charXX(Y)”，$XX$ 对应相应字符的序列号，$Y$ 表示实际的目标字符。子表的内容包含了两列，第一列表示标签，第二列为采样点序号。每轮实验的起始标签为目标字符对应的标识符（字符矩阵中 $36$ 个字符的标识符详见表2，如“101”表示“A”），接下来为闪烁的行或列的标识符（详见图6，如“2”表示第2行，“9”表示第3列），一轮实验的结束标签为“100”。在训练数据的事件标签文件中，第一行给出了目标字符的标识符和对应的采样点序号，接下来是随机闪烁的行和列的标识符和对应的采样点序号，每轮实验以“100”标识符结束，共重复5次。\n\n测试数据中的标签文件同样是以子表形式与实验数据相对应，子表的名称为 “charXX”，$XX$ 对应相应字符的序列号。在测试数据的事件标签文件中，第一行给出了待识别目标字符的标识符，统一表示为“666”，需要通过对脑电信号进行分析，得到出现P300电位的行和列，并判断得到目标字符的识别结果。\\begin{table}[H]\n\\centering\n\\caption{字符矩阵的标识符}\n\\begin{tabular}{|c|c|c|c|c|c|}\n\\hline\nA & 101 & B & 102 & C & 103 \\\\\n\\hline\nD & 104 & E & 105 & F & 106 \\\\\n\\hline\nG & 107 & H & 108 & I & 109 \\\\\n\\hline\nJ & 110 & K & 111 & L & 112 \\\\\n\\hline\nM & 113 & N & 114 & O & 115 \\\\\n\\hline\nP & 116 & Q & 117 & R & 118 \\\\\n\\hline\nS & 119 & T & 120 & U & 121 \\\\\n\\hline\nV & 122 & W & 123 & X & 124 \\\\\n\\hline\nY & 125 & Z & 126 & 1 & 127 \\\\\n\\hline\n2 & 128 & 3 & 129 & 4 & 130 \\\\\n\\hline\n5 & 131 & 6 & 132 & 7 & 133 \\\\\n\\hline\n8 & 134 & 9 & 135 & 0 & 136 \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=0.8\\textwidth]{row_col_identifier.png}\n\\caption{行/列的标识符}\n\\end{figure}\n\n附件2：睡眠脑电数据\n\n提供3000个睡眠脑电特征样本及其标签，取自不同的健康成年人整夜睡眠过程。第一列为“已知标签”，用数字形式来表示不同的睡眠分期：清醒期（6），快速眼动期（5），睡眠Ⅰ期（4），睡眠Ⅱ期（3），深睡眠期（2）；第二至五列为从原始时序列中计算得到的特征参数，依次包括“Alpha”，“Beta”，“Theta”，“Delta”，分别对应了脑电信号在“8-13Hz”，“14-25Hz”，“4-7Hz”和“0.5-4Hz”频率范围内的能量占比，特征参数单位为百分比。\n\n根据以上附件所给出的数据来源和实验数据，请研究以下问题：\n\n问题一：在脑-机接口系统中既要考虑目标的分类准确率，同时又要保证一定的信息传输速率。请根据附件1所给数据，设计或采用一个方法，在尽可能使用较少轮次（要求轮次数小于等于5）的测试数据的情况下，找出附件1中5个被试测试集中的10个待识别目标，并给出具体的分类识别过程，可与几种方法进行对比，来说明设计方法的合理性。\n\n问题二：由于采集的原始脑电数据量较大，这样的信号势必包含较多的冗余信息。根据图5和表1，在20个脑电信号采集通道中，无关或冗余的通道数据不仅会增加系统的复杂度，且影响分类识别的准确率和性能。请分析附件1所给数据，并设计一个通道选择算法，给出针对每个被试的、更有利于分类的通道名称。称组合（要求通道组合的数量小于20大于等于10，每个被试所选的通道可以不相同，具体的通道名称见图5和表1）。基于通道选择的结果，进一步分析对于所有被试都较适用的一组最优通道名称组合，并给出具体分析过程。为了方便参赛者对最优通道组合进行选择，赛题给出了测试数据（char13-char17）的结果，它们的字符分别是：M、F、5、2、I。\n\n问题三：在P300脑-机接口系统中，往往需要花费很长时间获取有标签样本来训练模型。为了减少训练时间，请根据附件1所给数据，选择适量的样本作为有标签样本，其余训练样本作为无标签样本，在问题二所得一组最优通道组合的基础上，设计一种学习的方法，并利用问题二的测试数据（char13-char17）检验方法的有效性，同时利用所设计的学习方法找出测试集中的其余待识别目标（char18-char22）。\n\n问题四：根据附件2中所给出的特征样本，请设计一个睡眠分期预测模型，在尽可能少的训练样本的基础上，得到相对较高的预测准确率，给出训练数据和测试数据的选取方式和分配比例，说明具体的分类识别过程，并结合分类性能指标对预测的效果进行分析。\n\n注意：在研究问题一时，不能将问题二提供的5个测试数据的结果作为已知条件，若使用该条件，则被判为作弊处理。",
  "subtask": {
    "1": {
      "subtask": "子任务1（数据预处理与特征构建）旨在把每位被试的原始多通道时序脑电文件（每被试的 train_data/train_event 与 test_data/test_event，采样率250 Hz，20通道）系统地清理、对齐、分段并提取可供后续判别与空间分析使用的事件级特征与汇总统计量；其输出为经滤波与伪迹剔除的连续数据、每次闪烁的时域 epoch（含标签）、每个 epoch 的特征向量、被试级平均ERP模板及用于空间处理的协方差矩阵和通道质量报告。具体步骤与技术要点：1) 数据载入与校验：读取 Excel/CSV 原始通道数据与事件标注，校验采样率与事件时间点一致、删除空列/冗余列并按题目通道映射重命名；对已知缺失（例如个别被试的丢失条目）做记录并在后续处理时限制相应字符序列；2) 滤波与去噪：对连续数据做 50 Hz 工频陷波（如需）和带通 0.5–30 Hz 滤波以保留ERP成分，建议使用零相位 FIR/IIR 滤波器以避免相位失真；3) 参考与重参考：若原始为单端参考，建议转为公共平均参考（common-average）或记录推导的参考以统一空间基准；4) 下采样与分段：为降低维度将数据下采样（例如 250→125 Hz），基于事件标记截取每次闪烁的 epoch（建议窗口为刺激前 −200 ms 到刺激后 +800 ms），并对每个 epoch 做基线校正（以 −200∼0 ms 平均值扣除）；5) 伪迹与坏道处理：采用峰峰值阈值（例如 ±100 μV）、通道间相关性和时域方差检测异常 epoch 与坏通道，记录并剔除或用通道插值（邻近通道加权）恢复坏通道；在必要时用 ICA（若通道数与数据量允许）识别并去除眼电等独立成分，但需保留记录日志并人工/自动判定成分；6) 事件对齐与标签构建：根据事件序列把每个 epoch 标注为目标/非目标（训练集）并校验每轮闪烁次数与标签完整性，输出每个 epoch 的元数据（被试、字符编号、行/列编号、轮次、时间戳）；7) 特征提取（每 epoch）：提取多层次特征包括（a）时域特征：下采样后的时序样本向量、在预定潜伏区间（如 250–600 ms 或 300–500 ms）内的峰值幅度与峰值延迟、若干非重叠窗口的平均电位与能量（例如 0–300、300–500、500–800 ms）、RMS 与 AUC；（b）频域/时频特征：使用 Welch 或短时变换估计各通道在 Delta (0.5–4 Hz)、Theta (4–7 Hz)、Alpha (8–13 Hz)、Beta (14–25 Hz) 的绝对/相对功率与比值；（c）空间统计特征：每 epoch 的通道协方差矩阵（或其上三角向量化）以供后续空间滤波与降维使用；可选（d）对时延漂移容忍的匹配滤波响应或在潜伏窗内的最大响应值与相应延迟作为额外特征；8) 维度约简与标准化：对原始时序/协方差/频域特征采用 z-score 标准化（被试内标准化优先），并视需要用 PCA 保留 95% 方差或固定成分数以减少维度，保存降维映射以便测试数据一致处理；9) ERP 模板与协方差估计：基于训练集中目标与非目标 epoch 计算被试级平均 ERP（用于后续模板匹配或空间滤波初始化），同时计算目标相关协方差 S_signal 与总体协方差 S_total 并持久化；10) 输出与验证：将清洗后的连续数据、epoch（含标签）、特征矩阵、平均 ERP、协方差矩阵、通道质量报告与处理日志保存为可复现格式（NumPy/CSV/EDF/MNE 原始对象），并生成快速可视化检查项（平均 ERP 波形图、通道热度图、坏 epoch 统计、事件计数一致性）以验证预处理正确性。推荐使用成熟工具库（如 MNE-Python 或 EEGLAB + NumPy/SciPy/Scikit-learn）以实现上述流水线并确保可重复性与参数可配置（滤波带、阈值、下采样率、epoch 窗口、基线区间、PCA 保留能量等应作为可调整超参数）。",
      "criteria": {
        "task_understanding": {
          "core_goal": "对P300脑机接口原始20通道EEG进行预处理、对齐与分段，提取事件级特征并估计ERP模板与协方差以支撑后续分类与空间分析的构建与评估",
          "expected_output": "经滤波与伪迹剔除的连续数据文件；带标签的每次闪烁epoch集合；每个epoch的特征矩阵（时域/频域/空间协方差/匹配滤波）；被试级平均ERP模板（目标/非目标）；S_signal与S_total协方差矩阵；通道质量报告；处理日志与快速可视化（ERP波形、坏epoch统计、事件计数）；保存的标准化与PCA映射以便复用",
          "key_inputs_constraints": "输入：train_data/test_data（20通道、250Hz）、train_event/test_event（含目标与行/列/结束标签）；约束：采样率固定250Hz；通道命名映射按表1；轮次数≤5且事件序列完整（起始标识符、6行+6列随机、结束=100）；处理参数可配置（带通0.5–30Hz、陷波50Hz、epoch窗[-200,800]ms、基线[-200,0]ms、下采样至125Hz、阈值±100μV）；输出需被试内z-score并保持训练/测试一致的PCA映射；缺失/坏道需记录并可插值",
          "modeling_type": "评价+分类+拟合（特征工程与统计估计）",
          "role_in_pipeline": "作为数据清洗与特征工程阶段，位于原始数据获取之后、分类器训练与通道选择之前；前序依赖：原始EEG与事件标签读取；后序任务：问题一的行列判别/目标识别、问题二的通道选择、问题三的半监督学习与模板匹配、问题四独立于本数据",
          "assumptions": "原始事件时间戳与数据采样点同一时间基准；可能存在少量缺失事件与坏通道；ICA仅在数据量足够时启用；50Hz工频为主要干扰频率"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "明确P300 ERP处理目标与事件级特征提取",
              "description": "是否准确指出需围绕P300潜伏窗（如300–500ms）进行epoch级特征提取并服务于后续行/列分类与ERP模板估计",
              "score": 30,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：清楚界定潜伏窗与事件粒度；中分：只提取epoch无潜伏窗细化；低分：停留在连续信号层面无事件级目标"
            },
            {
              "sub_criteria": "识别关键输入/约束（20通道、250Hz、5轮、标签语义）",
              "description": "是否明确采样率、通道映射、轮次≤5、事件标识符（目标、行/列、100结束）等刚性约束",
              "score": 30,
              "evaluation_focus": "需求抽取",
              "scoring_hint": "高分：列全并用于设计；中分：提到部分；低分：未体现或误解事件标签"
            },
            {
              "sub_criteria": "识别伪迹/坏道与可复现性需求",
              "description": "是否提出伪迹阈值、ICA可选、通道质量报告、日志与参数可配置等复现实践要求",
              "score": 40,
              "evaluation_focus": "工程规范",
              "scoring_hint": "高分：给出阈值/日志/报告方案；中分：笼统提去噪；低分：忽略伪迹与可复现性"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "数据载入与校验（采样率/事件时间点一致）",
              "description": "复述需比对事件采样点与数据长度、删除空列并按表1重命名",
              "score": 35,
              "evaluation_focus": "需求对齐",
              "scoring_hint": "高分：包含一致性检查与异常处理；中分：只提读取；低分：无校验步骤"
            },
            {
              "sub_criteria": "滤波、参考、下采样与epoch窗口复述",
              "description": "准确描述0.5–30Hz带通、50Hz陷波、CAR重参考、250→125Hz、[-200,800]ms与基线校正",
              "score": 35,
              "evaluation_focus": "流程把握",
              "scoring_hint": "高分：参数齐全且合理；中分：参数缺失或不一致；低分：无关键步骤或不当参数"
            },
            {
              "sub_criteria": "特征与输出资产复述",
              "description": "清楚列出时域/频域/协方差特征、ERP模板、S_signal/S_total、PCA/z-score与可视化产物",
              "score": 30,
              "evaluation_focus": "表达精确",
              "scoring_hint": "高分：覆盖全面；中分：缺少协方差或模板；低分：仅泛称“特征”"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "信号与噪声假设（P300潜伏与频带）",
              "description": "明确P300为正向波，潜伏约300–500ms，主要能量<30Hz，支撑滤波与窗口选择",
              "score": 35,
              "evaluation_focus": "数理假设",
              "scoring_hint": "高分：量化潜伏窗与频段；中分：模糊描述；低分：与文献常识冲突"
            },
            {
              "sub_criteria": "独立成分与ICA使用假设",
              "description": "说明EOG等伪迹可被ICA分离，且需数据量足够与组件判定准则",
              "score": 25,
              "evaluation_focus": "方法假设",
              "scoring_hint": "高分：给出启停条件与判定；中分：仅提可用；低分：误用或不加约束"
            },
            {
              "sub_criteria": "数据缺失/坏道处理假设",
              "description": "假设少量事件缺失可剔除，坏道可邻近插值并记录影响，不影响整体统计",
              "score": 40,
              "evaluation_focus": "工程假设",
              "scoring_hint": "高分：含记录与限制策略；中分：只说剔除；低分：忽略或不一致处理"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "滤波器与参考构建（零相位FIR/IIR与CAR）",
              "description": "设计零相位滤波与重参考策略，避免相位失真并统一空间基准",
              "score": 25,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：说明filtfilt/线性相位与阶数；中分：仅提滤波；低分：可能引入时延"
            },
            {
              "sub_criteria": "epoch与基线校正模型",
              "description": "严格定义epoch索引、基线均值扣除与事件元数据结构",
              "score": 20,
              "evaluation_focus": "数据建模",
              "scoring_hint": "高分：含对齐与边界检查；中分：仅提窗口；低分：无基线或错对齐"
            },
            {
              "sub_criteria": "特征空间设计（时域/频域/协方差/匹配滤波）",
              "description": "给出具体窗口、功率频带、协方差向量化方案与匹配滤波响应定义",
              "score": 35,
              "evaluation_focus": "特征工程",
              "scoring_hint": "高分：参数明确且避免泄露；中分：部分定义不清；低分：仅原始波形"
            },
            {
              "sub_criteria": "标准化与PCA降维映射",
              "description": "被试内z-score与训练拟合PCA后应用于测试，保留95%方差或固定维数",
              "score": 20,
              "evaluation_focus": "规范化",
              "scoring_hint": "高分：区分fit/transform；中分：混用；低分：数据泄露"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "参数求解与验证（带宽/阈值/窗长）",
              "description": "给出选择0.5–30Hz、±100μV阈值、[-200,800]ms等参数的依据与敏感性检查",
              "score": 30,
              "evaluation_focus": "参数化",
              "scoring_hint": "高分：有消融或网格检验；中分：经验值无验证；低分：参数缺失或不合理"
            },
            {
              "sub_criteria": "协方差与ERP模板估计稳定性",
              "description": "采用稳健协方差/收缩估计与重复/轮次平均获取稳定ERP模板",
              "score": 40,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：说明收缩或稳健方法；中分：普通样本协方差；低分：未计算或不稳定"
            },
            {
              "sub_criteria": "事件对齐与计数一致性校验",
              "description": "验证每轮包含12次闪烁（6行6列）、起止标签与时间戳连续性并记录异常",
              "score": 30,
              "evaluation_focus": "数据校验",
              "scoring_hint": "高分：实现自动校验与报告；中分：手工检查；低分：无校验"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "可复现流水线与参数可配置",
              "description": "实现端到端脚本/函数（MNE/NumPy/SciPy）并以配置文件控制滤波带、阈值、窗口、PCA等",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：一键重跑与固定随机种子；中分：脚本可跑但硬编码；低分：零散不可复现"
            },
            {
              "sub_criteria": "高质量I/O与日志、通道质量报告",
              "description": "保存原始/清洗数据、epoch、特征矩阵、ERP、协方差、映射与可视化；记录处理日志",
              "score": 30,
              "evaluation_focus": "工程实现",
              "scoring_hint": "高分：结构化输出与日志；中分：部分保存；低分：结果不可追溯"
            },
            {
              "sub_criteria": "伪迹/坏道处理与ICA实现细节",
              "description": "实现峰峰值阈值、相关性筛查、插值与可选ICA，组件保留/剔除记录",
              "score": 25,
              "evaluation_focus": "算法实现",
              "scoring_hint": "高分：模块化与参数化；中分：仅阈值；低分：未实现"
            },
            {
              "sub_criteria": "标准化与PCA的fit/transform隔离",
              "description": "确保仅用训练拟合z-score/PCA，测试只transform，避免数据泄露",
              "score": 15,
              "evaluation_focus": "数据规范",
              "scoring_hint": "高分：单元测试或断言；中分：口头声明；低分：混淆导致泄露"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "预处理正确性可视化与统计",
              "description": "提供平均ERP波形（目标vs非目标）、坏epoch比例、事件计数一致性图表",
              "score": 35,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：图表完整且解释到位；中分：部分图；低分：无可视化或与预期相悖未解释"
            },
            {
              "sub_criteria": "特征有效性与P300潜伏检验",
              "description": "展示潜伏窗内峰值/能量差异、频带功率差异或匹配滤波响应分布",
              "score": 35,
              "evaluation_focus": "诊断分析",
              "scoring_hint": "高分：显著性或效应量；中分：定性描述；低分：未验证特征"
            },
            {
              "sub_criteria": "鲁棒性与参数敏感性",
              "description": "分析滤波带、阈值、下采样率变化对ERP与特征稳定性的影响",
              "score": 30,
              "evaluation_focus": "稳健性评估",
              "scoring_hint": "高分：对比多设定并量化变化；中分：仅一处探查；低分：无敏感性分析"
            }
          ]
        }
      }
    },
    "2": {
      "subtask": "子任务2（空间滤波与通道选择）旨在在给定每位被试预处理并分段后的事件级多通道ERP数据（每次闪烁的 epoch、目标/非目标标签、采样率及通道名称映射）基础上，找出对P300判别最有利的通道子集（每个子集通道数 m 满足 10 ≤ m < 20），并输出每个被试的最优通道组合与一个对所有被试均较稳健的跨被试通道组合；为实现这一目标，任务采用明确的两阶段流程：第一阶段为过滤式预筛（filter stage），对每个被试计算每通道的单通道判别度量（例如基于训练集的AUC、互信息、目标/非目标平均振幅差或信噪比）以及基于xDAWN或目标平均ERP构造的通道贡献度（通道在xDAWN投影或信号协方差中所占能量），对通道按这些归一化得分作初步排序并剔除明显低信息通道以形成候选集合；第二阶段为包装式递归消除（wrapper stage），对候选通道集合执行递归通道消除（RCE）：在每一步在当前通道子集上重估 xDAWN 空间滤波器（可选固定分量数K或通过交叉验证选择K）并以收缩LDA或正则化逻辑回归作为基线判别器，通过分层k折交叉验证（例如k=5）评估分类性能指标（主要为字符最终识别相关的事件级AUC和被试内字符识别准确率），将对性能影响最小的通道剔除，迭代直至通道数降至候选范围内的每个 m 值；对于每个被试记录各 m 下的最优子集与对应性能曲线。为得到跨被试通用组合，对每位被试独立执行上述流程以得到通道保留频次或基于交叉验证得分的通道排名，然后采用聚合策略（如Borda计数或归一化得分平均）生成跨被试通道重要度排序，并在留一被试（leave-one-subject-out）或跨被试交叉验证框架下对备选的前 m 个通道子集进行搜索以选择在不同被试间平均性能最优且方差最小的“通用”子集；在选择过程中应始终在每个候选子集上重新估计 xDAWN 与判别器参数以保证评估的一致性。为量化显著性与稳健性，要求对最终候选子集执行置换检验（随机打乱事件标签或通道索引得到零分布）以检验性能提升的统计显著性，并通过模拟通道丢失/噪声增加的鲁棒性测试（随机去除若干通道或加入高斯噪声）评估所选子集在传感器故障下的退化情况。实现细节与工具建议：输入为每位被试的 epoch 矩阵、目标/非目标标签、通道名称（如表1中的 Fz、F3…Oz）；使用现成库（例如 MNE-Python 实现 xDAWN、NumPy/SciPy 做矩阵运算、scikit-learn 做 LDA/逻辑回归与交叉验证、joblib/并行化加速 RCE）并保存中间结果（通道得分向量、xDAWN 投影矩阵、交叉验证返回的性能曲线、选择过程日志）；超参数需明确并记录（单通道度量类型、xDAWN 分量数 K 的候选值、交叉验证折数 k、RCE 的停止准则与目标 m 值范围、置换检验次数），并输出标准化的结果文件：每个被试的按 m 排序的通道排名与最优 m 对应的通道名称列表、跨被试通用通道组合、对应的交叉验证性能与显著性p值、以及对候选组合的稳健性测试报告，确保该子任务的流程可独立重复执行并为后续判别器训练提供明确的通道输入。",
      "criteria": {
        "task_understanding": {
          "core_goal": "在事件级多通道ERP数据上优化并评估P300判别的通道选择，构建被试内最优通道组合与跨被试通用组合（10≤m<20），通过xDAWN+LDA/逻辑回归与交叉验证最大化AUC与字符识别准确率并检验稳健性与显著性。",
          "expected_output": "每被试的按m（10≤m<20）最优通道名称列表与性能曲线；跨被试通用通道组合；xDAWN投影矩阵与超参数K；交叉验证AUC/准确率及方差；置换检验p值；鲁棒性测试报告；处理与选择日志；可复现代码与配置。",
          "key_inputs_constraints": "输入：每被试经子任务1预处理的epoch矩阵(X: epochs×channels×time)、目标/非目标标签y、采样率、通道名称映射；约束：通道数选择10≤m<20；两阶段流程（过滤式预筛+包装式RCE）；在每个候选子集上重新估计xDAWN与分类器；评估以分层k折CV（建议k=5）；需置换检验与通道丢失/噪声鲁棒性；记录超参数（单通道度量、K、k、停止准则、置换次数）。",
          "modeling_type": "优化+分类+评价",
          "role_in_pipeline": "作为特征工程后、最终判别器训练前的通道优化子任务，直接依赖子任务1（数据预处理与特征构建）的epoch与协方差信息；其输出作为后续被试内字符识别与跨被试模型训练的固定通道输入与空间滤波初始化。",
          "assumptions": "若个别被试存在坏道或缺失epoch，则在预筛阶段先行剔除并在RCE中跳过；若xDAWN组件数K未指定，则在{2,3,4,5}上CV选择；若数据量不足以稳定ICA结果，则省略ICA相关输入。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "明确优化目标：P300判别AUC与字符识别准确率",
              "description": "是否将事件级AUC与被试内字符识别准确率作为主评估指标，并指出两者都用于通道选择的目标函数或多指标权衡。",
              "score": 35,
              "evaluation_focus": "目标设定/评价指标",
              "scoring_hint": "高分：同时报告AUC与字符准确率并说明权重或选择准则；中分：只报告其一但提及另一项；低分：未绑定到AUC/字符准确率。"
            },
            {
              "sub_criteria": "通道数约束10≤m<20与两阶段流程约束",
              "description": "是否识别并遵循通道数量范围及“过滤式预筛+包装式RCE”两阶段要求。",
              "score": 25,
              "evaluation_focus": "约束理解/流程合规",
              "scoring_hint": "高分：严格执行两阶段且m在范围内；中分：两阶段其一不完整或偶有越界m；低分：未分两阶段或m越界。"
            },
            {
              "sub_criteria": "跨被试通用组合与稳健性需求",
              "description": "是否识别需生成跨被试通用通道组合并进行稳健性与显著性（置换检验）评估。",
              "score": 25,
              "evaluation_focus": "任务覆盖度",
              "scoring_hint": "高分：提供通用组合、置换检验与鲁棒性测试；中分：只做其二；低分：三者均缺或仅口述。"
            },
            {
              "sub_criteria": "依赖前序数据：epoch、标签、通道映射",
              "description": "是否明确依赖子任务1输出（epoch、目标/非目标标签、通道名称、采样率）。",
              "score": 15,
              "evaluation_focus": "上下游衔接",
              "scoring_hint": "高分：列出全部依赖并校验一致性；中分：列出多数；低分：未提。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "两阶段流程精准复述（过滤式预筛+RCE）",
              "description": "准确复述先基于单通道度量与xDAWN贡献度排序，再用RCE在每步重估xDAWN+LDA/逻辑回归并CV评估。",
              "score": 35,
              "evaluation_focus": "流程把握",
              "scoring_hint": "高分：包含单通道AUC/MI/幅度差、xDAWN贡献、RCE细节；中分：缺少其一；低分：流程模糊。"
            },
            {
              "sub_criteria": "评估方案（分层k折CV、AUC/准确率曲线）",
              "description": "复述需采用分层k折交叉验证并输出随m变化的性能曲线与方差。",
              "score": 25,
              "evaluation_focus": "评价设计",
              "scoring_hint": "高分：指明k、分层、曲线/误差条；中分：k或分层缺失；低分：无CV或无曲线。"
            },
            {
              "sub_criteria": "跨被试聚合策略（Borda/得分平均）",
              "description": "复述如何从被试内排名聚合生成跨被试通道重要度并在LOSO评估中选定通用m。",
              "score": 25,
              "evaluation_focus": "跨被试设计",
              "scoring_hint": "高分：说明聚合法与LOSO；中分：仅聚合法或仅LOSO；低分：未给出方法。"
            },
            {
              "sub_criteria": "显著性与鲁棒性程序",
              "description": "复述置换检验（标签或通道随机化）与通道丢失/噪声模拟步骤与判定准则。",
              "score": 15,
              "evaluation_focus": "统计与稳健性",
              "scoring_hint": "高分：给出置换次数与p值阈、噪声级别；中分：仅提概念；低分：缺失。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "xDAWN分量数K与分类器正则假设",
              "description": "阐明K的候选集与选择准则，LDA收缩或逻辑回归正则的设定及合理性。",
              "score": 35,
              "evaluation_focus": "模型假设",
              "scoring_hint": "高分：给出K∈{2,3,4,5}并CV选、说明LDA shrinkage或C值；中分：给定固定K/C无解释；低分：未说明。"
            },
            {
              "sub_criteria": "单通道度量选择与ERP潜伏窗假设",
              "description": "说明AUC/互信息/幅度差的计算窗口（如300–500ms）与理由。",
              "score": 25,
              "evaluation_focus": "特征假设",
              "scoring_hint": "高分：明确时间窗并与P300潜伏一致；中分：给窗但无依据；低分：无窗或与P300不符。"
            },
            {
              "sub_criteria": "CV与LOSO数据独立性假设",
              "description": "说明折内独立性、分层策略与LOSO避免信息泄漏的假设与保障措施。",
              "score": 25,
              "evaluation_focus": "验证设定",
              "scoring_hint": "高分：描述分层按目标/非目标、按字符/轮次分割；中分：仅声明分层；低分：可能泄漏。"
            },
            {
              "sub_criteria": "置换检验与鲁棒性测试参数",
              "description": "假设置换次数（如≥1000）、通道丢失比例、噪声方差范围并说明阈值。",
              "score": 15,
              "evaluation_focus": "统计与稳健性",
              "scoring_hint": "高分：明确次数与阈；中分：仅口述；低分：未设定。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "过滤式预筛实现（单通道AUC/MI/幅度差与xDAWN贡献度归一化排名）",
              "description": "构建多指标归一化与加权排名，形成候选集合并剔除低信息通道。",
              "score": 30,
              "evaluation_focus": "算法设计",
              "scoring_hint": "高分：多指标融合、阈值与可视化；中分：单一指标；低分：无系统预筛。"
            },
            {
              "sub_criteria": "包装式RCE策略与停止准则",
              "description": "在每步重估xDAWN与分类器，分层k折CV评估，剔除边际贡献最小通道，直至10≤m<20并记录各m子集。",
              "score": 30,
              "evaluation_focus": "搜索策略",
              "scoring_hint": "高分：清晰剔除准则与记录；中分：不重估或停止不清；低分：未递归。"
            },
            {
              "sub_criteria": "跨被试聚合与LOSO选择通用组合",
              "description": "实现Borda计数或得分平均排序，基于LOSO在前m集合中选平均性能最优且方差最小的m。",
              "score": 25,
              "evaluation_focus": "跨被试方法",
              "scoring_hint": "高分：含方差约束与网格m搜索；中分：仅平均性能；低分：未实现聚合。"
            },
            {
              "sub_criteria": "统计检验与鲁棒性评估设计",
              "description": "置换零分布估计p值，随机通道丢失与加噪退化曲线设计。",
              "score": 15,
              "evaluation_focus": "统计设计",
              "scoring_hint": "高分：完整p值与退化曲线；中分：仅其一；低分：缺失。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "分层k折CV求解与性能曲线生成",
              "description": "正确执行k折（如k=5）分层CV，输出随m变化的AUC/准确率均值±方差。",
              "score": 35,
              "evaluation_focus": "求解与验证",
              "scoring_hint": "高分：可复现均值/方差与曲线；中分：仅均值或无分层；低分：无CV或错误。"
            },
            {
              "sub_criteria": "xDAWN与分类器重估一致性",
              "description": "在每个候选通道子集与CV折内重新估计xDAWN与LDA/逻辑回归，避免信息泄漏。",
              "score": 30,
              "evaluation_focus": "一致性/严谨性",
              "scoring_hint": "高分：折内拟合、管道化；中分：仅全数据拟合后评估；低分：明显泄漏。"
            },
            {
              "sub_criteria": "置换检验与p值计算",
              "description": "执行≥1000次置换生成零分布并报告p值与置信区间。",
              "score": 20,
              "evaluation_focus": "统计实现",
              "scoring_hint": "高分：次数充分且报告p；中分：次数不足或仅描述；低分：未执行。"
            },
            {
              "sub_criteria": "鲁棒性退化实验",
              "description": "通道随机丢失与高斯噪声注入，绘制性能随丢失比例/噪声方差的退化曲线。",
              "score": 15,
              "evaluation_focus": "鲁棒性评估",
              "scoring_hint": "高分：两类退化均有；中分：仅其一；低分：无实验。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "可复现管道（MNE/NumPy/Sklearn）与配置化超参数",
              "description": "使用标准库实现xDAWN、LDA/LogReg、CV与RCE；超参数（K、k、m范围、置换次数）可配置并记录日志。",
              "score": 35,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：模块化、yaml/json配置、日志；中分：硬编码但可运行；低分：脚本零散难复现。"
            },
            {
              "sub_criteria": "数据接口与通道名称映射一致性",
              "description": "正确读取被试epoch、标签、通道名称，保持子任务1到本任务的一致映射与形状校验。",
              "score": 25,
              "evaluation_focus": "数据工程",
              "scoring_hint": "高分：含校验与错误处理；中分：基本读取；低分：映射错误或崩溃。"
            },
            {
              "sub_criteria": "并行化与效率（RCE/置换加速）",
              "description": "对CV折、置换或RCE步骤使用并行/缓存（joblib）以降低时间。",
              "score": 20,
              "evaluation_focus": "性能工程",
              "scoring_hint": "高分：明显加速与缓存；中分：部分并行；低分：无优化且运行缓慢。"
            },
            {
              "sub_criteria": "结果产物与可视化输出",
              "description": "导出通道排名、最优组合、性能曲线、p值、鲁棒性图；文件命名规范可追溯。",
              "score": 20,
              "evaluation_focus": "产物完备",
              "scoring_hint": "高分：图表与表格齐全；中分：缺少其一；低分：产物不全或不可读。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "被试内性能解释与m选择理由",
              "description": "解释AUC/准确率随m变化的趋势、拐点与选择最终m的依据（均值-方差权衡）。",
              "score": 35,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：有拐点分析与方差考虑；中分：仅报告最优值；低分：无解释。"
            },
            {
              "sub_criteria": "跨被试通用组合有效性与方差比较",
              "description": "比较通用组合与被试特定组合的平均性能与方差，说明泛化与稳定性。",
              "score": 25,
              "evaluation_focus": "泛化评估",
              "scoring_hint": "高分：提供均值±方差与统计比较；中分：仅均值；低分：未比较。"
            },
            {
              "sub_criteria": "显著性（置换p值）与稳健性（退化曲线）结论",
              "description": "报告p值是否显著、鲁棒性在通道丢失/噪声下的退化速率与可接受范围。",
              "score": 25,
              "evaluation_focus": "统计结论",
              "scoring_hint": "高分：清楚p<0.05与阈值讨论；中分：仅p值或仅曲线；低分：无结论支持。"
            },
            {
              "sub_criteria": "通道生理合理性讨论（Pz/CPz/Oz等）",
              "description": "联系P300枕-顶区分布讨论所选通道（如Pz、Cz、Oz、P3/4、CP3/4）的生理合理性。",
              "score": 15,
              "evaluation_focus": "领域理解",
              "scoring_hint": "高分：结合文献或ERP拓扑；中分：笼统描述；低分：不涉及生理解释。"
            }
          ]
        }
      }
    },
    "3": {
      "subtask": "子任务3（事件级判别、序列后验决策与半监督自适应学习）旨在以有限有标签样本为起点，在给定的预处理且按事件分段的多通道 epoch 特征与对应刺激序列（每次闪烁对应行/列标识）输入下，构建并部署一个稳健的事件级 P300 判别器、基于事件概率的字符后验累积与早停决策机制，并通过保守且可控的半监督策略扩展训练数据以提高在最多5轮交互约束下的字符识别准确率与信息传输速率（ITR）；本子任务的输入包括：每次闪烁的多通道时序或经空间投影后的特征向量（可已降维）、对应的目标/非目标（若有）标签的少量训练样本、未标注的训练样本集合、以及测试阶段的刺激时序流。方法步骤明确为：1) 初始判别器训练——对有标签样本做标准化与可选PCA后，训练正则化线性模型（首选收缩LDA或带 L2 的逻辑回归），处理类不平衡（类别加权或采样），并用嵌套交叉验证确定正则化强度与降维维度；2) 判别分数校准——将线性得分经 Platt 标定或温度化 sigmo id 映射为概率 P(y=1|f)，并在验证集上标定温度与偏置；3) 事件到字符的后验更新与决策规则——在测试或仿真阶段，对每一次闪烁观测 f_t 计算事件级 P_t = P(y=1|f_t)，对于每个候选字符 c 按其是否被当前刺激 r_t 覆盖，使用对数域累积更新 logPosterior_c ← logPosterior_c + log( P_t ) 若覆盖，或 + log(1−P_t) 若不覆盖；在每次闪烁后评估最大后验字符 p_max 并应用早停准则（当 p_max ≥ θ_conf 且 p_max − p_second ≥ δ 或达到最大允许轮次数 R ≤ 5 时输出决策），θ_conf、δ 和 R 通过在有标签验证集上基于准确率与 ITR 的网格搜索优化；4) 时间漂移鲁棒性——在特征构造或判别阶段对潜伏期做容忍处理（在候选延迟窗口如 250–600 ms 做匹配滤波或在该窗口内取最大相关/能量响应作为特征）以减少潜伏期偏移造成的错误；5) 半监督扩展策略——采用保守的自训练与图传播/EM 混合方案：以初始判别器对无标签样本打分，仅将满足高置信度条件（P≥τ_pos 或 P≤τ_neg，建议 τ_pos≈0.90–0.99、τ_neg≈0.01–0.10）且满足一致性校验（例如两个不同初始化的分类器或一个小型模型集体一致）的小批样本接纳为伪标签，每次迭代接纳数量受限（如不超过未标注池的 5–15% 或不超过每类 K 个样本）并将其加入有标签池重训练；并行用基于 RBF 相似度构建的图传播对软标签进行平滑（sigma 以中位距离启发式设定），或在 EM 框架中把图传播后的后验作为 E 步的软标签以更新模型参数；6) 伪标签误差控制与回滚机制——每次迭代在独立的验证集上检查性能提升，若性能下降超过容忍阈值则回滚上一次更新并降低接纳阈值或终止半监督过程；7) 参数选择与评估指标——在嵌套交叉验证中同时监控事件级 AUC、字符级准确率与 ITR（采用标准 ITR 公式结合每字符平均耗时），以这些指标的加权目标在验证集上选定 θ_conf、δ、τ_pos、伪标签接纳速率与最大迭代次数；8) 实现与工具建议——推荐使用 scikit-learn 实现 LDA/Logistic、Platt 标定与交叉验证，sklearn.semi_supervised 或自实现图传播用于标签平滑，NumPy/SciPy 做数值计算，joblib 并行化训练与迭代；9) 输出与日志——输出包括最终训练好的判别器、校准参数、迭代中加入的伪标签列表及其置信度、测试阶段每次闪烁的事件概率序列、字符后验随时间的轨迹与最终决策以及验证集上的 AUC/准确率/ITR 曲线，所有半监督迭代均保留回滚检查点以保证可复现与可审查。该子任务的目标是以谨慎可控的半监督扩展在不超出 5 轮刺激约束下提升判别与字符识别性能，同时保证伪标签带来的风险可被验证集检测并回滚，从而实现稳健的在线或离线模型增强。",
      "criteria": {
        "task_understanding": {
          "core_goal": "在最多5轮闪烁约束下，构建并校准事件级P300分类器并进行字符后验累积与早停决策，同时通过半监督自训练/图传播优化判别性能与信息传输速率。",
          "expected_output": "事件级概率序列P(y=1|f_t)、字符后验轨迹与最终决策、早停阈值(θ_conf, δ, R)、已校准判别器与模型文件、半监督迭代日志与伪标签列表、验证集AUC/字符准确率/ITR曲线及最终指标。",
          "key_inputs_constraints": "输入：预处理后的epoch特征（含时域/时频/空间投影）、刺激序列行/列标识r_t、少量有标签样本与未标注样本池、通道组合与采样率；约束：轮次数R≤5、类不平衡显著、需要概率校准与时间漂移容忍；前置：已完成子任务1的标准化与对齐、子任务2的通道子集与空间投影。",
          "modeling_type": "分类+优化",
          "role_in_pipeline": "作为特征工程与通道选择之后、字符级决策与系统评估之前的核心判别环节；前序依赖子任务1（预处理与特征）与子任务2（空间滤波与通道选择），后续输出供问题一字符识别与系统ITR评估使用。",
          "assumptions": "若验证集不足，采用被试内分层K折进行嵌套交叉验证；若无显式噪声标签，时间漂移通过潜伏窗内最大响应特征近似处理。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "R≤5轮与ITR优化目标的冲突识别",
              "description": "明确指出需在字符准确率与信息传输速率(ITR)之间权衡，并受最大轮次数R≤5的硬约束影响决策与阈值设计。",
              "score": 30,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：清晰量化ITR公式并讨论R对ITR与准确率的影响；中分：提及权衡但无量化；低分：未识别R与ITR关系。"
            },
            {
              "sub_criteria": "事件级判别到字符后验累积的映射",
              "description": "阐明从P(y=1|f_t)到字符log posterior的覆盖/非覆盖更新规则及其对早停的作用。",
              "score": 30,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：给出对数域更新公式并解释数值稳定性；中分：口头描述无公式；低分：未建立映射或错误。"
            },
            {
              "sub_criteria": "半监督自训练风险与验证集监控",
              "description": "识别伪标签噪声带来漂移风险，提出独立验证集监控与回滚需求。",
              "score": 40,
              "evaluation_focus": "风险控制",
              "scoring_hint": "高分：定义回滚阈值与迭代接纳上限；中分：仅提醒风险；低分：未考虑半监督风险。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "核心目标重述：P300分类+后验早停+半监督",
              "description": "用任务术语准确复述包含收缩LDA/逻辑回归、Platt标定、θ_conf/δ网格搜索、τ_pos/τ_neg自训练的整体流程。",
              "score": 35,
              "evaluation_focus": "表达与对齐",
              "scoring_hint": "高分：逐步关联三块模块及其超参；中分：覆盖两块；低分：泛化表述或遗漏关键模块。"
            },
            {
              "sub_criteria": "输入与约束边界复述",
              "description": "明确epoch特征、r_t刺激序列、类不平衡、R≤5与时间漂移容忍的要求。",
              "score": 35,
              "evaluation_focus": "需求对齐",
              "scoring_hint": "高分：列举全部关键输入与约束；中分：遗漏1-2项；低分：不成体系。"
            },
            {
              "sub_criteria": "输出物与评估指标复述",
              "description": "列出概率序列、后验轨迹、模型文件、AUC/准确率/ITR曲线与最终阈值。",
              "score": 30,
              "evaluation_focus": "验收定义",
              "scoring_hint": "高分：完整匹配预期输出；中分：缺少曲线或日志；低分：只给最终标签无过程产物。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "时间漂移假设与潜伏窗处理",
              "description": "说明P300潜伏期在250–600 ms波动并采用匹配滤波或窗口内最大响应特征以提升鲁棒性。",
              "score": 30,
              "evaluation_focus": "假设合理性",
              "scoring_hint": "高分：定义具体窗口与特征构造；中分：仅口述存在漂移；低分：未处理漂移。"
            },
            {
              "sub_criteria": "类不平衡与校准假设",
              "description": "假设目标事件稀少，采用类权重/重采样与Platt/温度标定保证概率可比性。",
              "score": 30,
              "evaluation_focus": "数据假设",
              "scoring_hint": "高分：给出权重或采样比例与校准验证方案；中分：仅提校准；低分：忽略不平衡与校准。"
            },
            {
              "sub_criteria": "半监督安全假设与伪标签阈值",
              "description": "设定τ_pos/τ_neg范围(如0.9/0.1)、每轮接纳比例(≤15%)、独立验证集监控与回滚触发。",
              "score": 40,
              "evaluation_focus": "风险边界",
              "scoring_hint": "高分：量化阈值与上限并含回滚条件；中分：给范围无回滚细节；低分：无阈值控制。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "初始判别器：收缩LDA/逻辑回归+嵌套CV",
              "description": "在z-score与可选PCA后构建正则化线性模型，使用嵌套交叉验证选择正则与维度并处理类不平衡。",
              "score": 30,
              "evaluation_focus": "算法设计",
              "scoring_hint": "高分：明确CV层次与超参网格；中分：单层CV；低分：无验证或忽略不平衡。"
            },
            {
              "sub_criteria": "概率校准：Platt/温度化",
              "description": "将线性得分映射为P(y=1|f)，在独立验证集拟合温度与偏置并报告Brier或ECE。",
              "score": 20,
              "evaluation_focus": "概率建模",
              "scoring_hint": "高分：提供校准度量；中分：做了校准无评估；低分：直接把得分当概率。"
            },
            {
              "sub_criteria": "后验更新与早停阈值优化",
              "description": "使用log域累积与(p_max≥θ_conf且差距≥δ)规则，基于准确率+ITR加权目标网格搜索θ_conf, δ, R。",
              "score": 30,
              "evaluation_focus": "决策优化",
              "scoring_hint": "高分：给出权重或帕累托选择；中分：固定阈值无依据；低分：无早停或错误规则。"
            },
            {
              "sub_criteria": "半监督框架：自训练+图传播/EM",
              "description": "双模型一致性或小型集成筛选伪标签，图传播平滑软标签并在EM中更新参数。",
              "score": 20,
              "evaluation_focus": "半监督设计",
              "scoring_hint": "高分：描述一致性检查与图参数(sigma)设定；中分：仅自训练；低分：无半监督或不可控接纳。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "嵌套交叉验证与稳定性报告",
              "description": "在被试内分层K折进行超参选择与外层评估，报告AUC/准确率方差。",
              "score": 30,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：外内层K与重复次数清晰；中分：仅单K；低分：无CV或数据泄漏。"
            },
            {
              "sub_criteria": "数值稳定：log-sum-exp与裁剪",
              "description": "在log域累积使用数值稳定技巧避免log(0)，对P_t裁剪至[eps,1-eps]。",
              "score": 25,
              "evaluation_focus": "数值计算",
              "scoring_hint": "高分：给出eps值与实现策略；中分：口头提及；低分：未处理溢出/NaN。"
            },
            {
              "sub_criteria": "半监督迭代与回滚实现",
              "description": "限制每轮接纳比例/每类K，独立验证集监控，性能下降超过阈值即回滚与降速。",
              "score": 25,
              "evaluation_focus": "优化实现",
              "scoring_hint": "高分：量化阈值与最大迭代；中分：仅描述流程；低分：无限制扩张或无验证。"
            },
            {
              "sub_criteria": "时间漂移容忍特征计算",
              "description": "在250–600ms内计算最大响应/匹配滤波分数并证明其提升验证AUC。",
              "score": 20,
              "evaluation_focus": "算法落地",
              "scoring_hint": "高分：报告带来ΔAUC>0；中分：实现未评估；低分：未实现。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "可复现训练管线与随机种子",
              "description": "使用scikit-learn等实现标准化→PCA→分类→校准→CV的流水线，固定随机种子与版本。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：Pipeline/Config驱动与seed固定；中分：散乱脚本；低分：不可复现。"
            },
            {
              "sub_criteria": "后验累积与早停代码正确性",
              "description": "实现覆盖/非覆盖更新、log域运算与p_max/差距δ判断，支持R≤5轮控制。",
              "score": 30,
              "evaluation_focus": "算法正确性",
              "scoring_hint": "高分：含单元测试或断言；中分：仅流程；低分：覆盖逻辑或阈值错误。"
            },
            {
              "sub_criteria": "半监督迭代与日志/回滚检查点",
              "description": "实现阈值筛选、接纳上限、验证监控、模型checkpoint与回滚日志。",
              "score": 25,
              "evaluation_focus": "工程实现",
              "scoring_hint": "高分：持久化伪标签列表与性能曲线；中分：仅基本循环；低分：无日志与回滚。"
            },
            {
              "sub_criteria": "指标计算：AUC/字符准确率/ITR",
              "description": "提供一致的指标实现与可视化，ITR基于标准公式并匹配R与时间配置。",
              "score": 15,
              "evaluation_focus": "评估实现",
              "scoring_hint": "高分：指标与图表齐全；中分：部分指标；低分：无ITR或实现错误。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "事件级AUC与校准度(Brier/ECE)报告",
              "description": "分别在基线与半监督后对AUC与校准度进行对比并解释变化原因。",
              "score": 30,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：量化提升与置信区间；中分：仅给数值无解释；低分：缺失或不一致。"
            },
            {
              "sub_criteria": "字符准确率与ITR权衡分析",
              "description": "呈现θ_conf/δ/R对准确率与ITR的敏感性曲线，说明最终阈值取舍。",
              "score": 30,
              "evaluation_focus": "权衡分析",
              "scoring_hint": "高分：含多点曲线或表格；中分：口述趋势；低分：未分析或与约束冲突。"
            },
            {
              "sub_criteria": "半监督有效性与消融实验",
              "description": "与无半监督、仅自训练、仅图传播进行对比，并报告伪标签接纳速率与误差。",
              "score": 25,
              "evaluation_focus": "实验设计",
              "scoring_hint": "高分：完整消融与错误率；中分：单一对比；低分：无对比。"
            },
            {
              "sub_criteria": "时间漂移鲁棒性与失败案例",
              "description": "展示潜伏窗策略对边缘样本的影响并分析失败字符或轮次的原因与改进方向。",
              "score": 15,
              "evaluation_focus": "稳健性评估",
              "scoring_hint": "高分：具体案例与改进建议；中分：泛化描述；低分：无案例分析。"
            }
          ]
        }
      }
    },
    "4": {
      "subtask": "子任务4（睡眠分期模型设计与少样本训练策略）：本子任务的目标是在尽可能少的已标注样本条件下，基于附件2提供的每个样本的 Alpha/Beta/Theta/Delta 百分比特征，构建一个能稳定预测五类睡眠分期（清醒6、REM5、N1(4)、N2(3)、N3(2)）的可复现流程并量化其性能与不确定性；任务范围包括数据清洗与预处理、根据数据是否为整夜连续序列选择建模框架、少样本或半监督训练策略、超参数调优与验证方案、以及统一的性能评估与不确定性估计方法。具体步骤与方法如下：1) 数据清洗与预处理：读取表格，去除空列与冗余列，检查并记录缺失值（用分层中位数、KNN插补或多重插补填补），做必要的异常值处理；对四个频带百分比做归一化（如 z-score 或 min–max）并检查其和约束（若总和不为100%则按比例重归一化），并做基础可视化与类分布统计以评估类别不平衡。2) 模型选择依据数据结构：若数据按整夜序列提供且时间序列信息保留，优先采用隐马尔可夫模型（HMM）或半隐马尔可夫模型（HSMM）——将隐状态定义为五个睡眠阶段、观测分布设为状态条件下的多元高斯（或混合高斯），通过带先验的 Baum–Welch（EM）估计发射与转移参数并用 Viterbi 解码进行预测；HSMM 可在样本量允许时用于显式建模状态持续时间分布以改善边界识别；若数据为独立样本（无时间连续性），则采用少样本鲁棒的判别模型如带 L2 正则与 class-weight 的多项逻辑回归或随机森林，并可作为基线。3) 少样本与半监督策略：在有标签样本极少时，优先采用半监督 EM（将未标注样本的后验概率作为软标签参与参数更新）、标签传播/图传播平滑或自训练（只接纳高置信度伪标签并在每次迭代用验证集检测回退），同时使用参数收缩（L2、贝叶斯先验或协方差收缩）以减少过拟合；推荐的有标签比例实验范围为 5%/10%/20%（分层抽样保证各类代表），其余作为无标签用于半监督训练。4) 划分与交叉验证：对整夜序列优先采用留一被试（leave-one-subject-out）交叉验证以评估泛化；对独立样本采用分层 k 折交叉验证（k=5–10）并在内部做嵌套 CV 进行超参数网格搜索（正则化强度、HMM 状态协方差形式、HSMM 持续时间分布参数、树的数目与深度等）。5) 类不平衡与稳健性：通过类别权重、过/欠采样（SMOTE 等）、阈值调整及代价敏感学习缓解不平衡；同时用正则化与先验避免稀少类别过拟合。6) 性能度量与不确定性评估：报告总体准确率、每类精确率/召回率/F1、混淆矩阵与 Cohen’s kappa；对时间序列模型还评估阶段持续时间分布与阶段转换的一致性；通过概率输出校准（Platt 或 isotonic）并用自助法（bootstrap）估计性能置信区间，必要时给出样本级预测概率以供下游决策。7) 敏感性分析与学习曲线：绘制学习曲线（准确率或 kappa 相对于标注比例）评估标注收益，分析关键超参数与填补策略对性能的影响。8) 工具与实现建议：推荐使用 pandas/numpy 做数据处理，scikit-learn 实现逻辑回归、随机森林和交叉验证，hmmlearn 或 pomegranate 实现 HMM/HSMM，imbalanced-learn 做采样，matplotlib/seaborn 做可视化；所有实验需保存随机种子与模型检查点以保证可复现性。最终输出包括已清洗的数据集、所选模型与超参数、训练/测试划分方案、性能报告（含混淆矩阵与置信区间）、学习曲线与模型概率输出与校准信息。",
      "criteria": {
        "task_understanding": {
          "core_goal": "在少量已标注样本条件下，利用 Alpha/Beta/Theta/Delta 百分比特征构建并评估五类睡眠分期分类模型，预测分期并量化不确定性。",
          "expected_output": "数据清洗与预处理脚本；分层抽样划分方案与少样本/半监督训练流程；已训练模型与超参数；总体准确率、各类Precision/Recall/F1、Cohen’s kappa、混淆矩阵；校准曲线与置信区间（bootstrap）；学习曲线；可复现实验代码与随机种子。",
          "key_inputs_constraints": "输入：3000条样本，列包含label(2..6)、Alpha、Beta、Theta、Delta（百分比）。约束：四频带总和≈100%，若不等需重归一化；类别不平衡需分层采样；少样本比例5%/10%/20%用于监督，其余可作无标签；若为整夜序列则需时序建模（HMM/HSMM），若为独立样本则判别模型为主；需要概率输出与校准并报告置信区间。",
          "modeling_type": "分类+预测+评价",
          "role_in_pipeline": "作为整套流程的下游核心建模与评估环节：在数据清洗与可视化后，进行模型选择（HMM/HSMM或判别模型）、半监督/少样本训练、超参数调优与交叉验证，并输出性能与不确定性；其结果为后续报告撰写与对比实验提供依据。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "目标界定：五类睡眠分期预测与不确定性评估",
              "description": "是否明确任务是基于Alpha/Beta/Theta/Delta百分比进行五类（2/3/4/5/6）睡眠分期分类，并需要报告置信区间与校准。",
              "score": 30,
              "evaluation_focus": "任务界定/评价指标",
              "scoring_hint": "高分：清晰列出五类、概率校准与CI；中分：仅提准确率与F1；低分：未明确五类或无不确定性评估。"
            },
            {
              "sub_criteria": "数据结构识别：整夜序列 vs 独立样本",
              "description": "能否识别数据是否保留时间连续性，并据此提出HMM/HSMM或判别模型路线的条件分支。",
              "score": 30,
              "evaluation_focus": "问题分型/算法选择",
              "scoring_hint": "高分：给出两套框架与触发条件；中分：只选一种但说明理由；低分：忽略时间结构影响。"
            },
            {
              "sub_criteria": "少样本学习需求与类不平衡",
              "description": "是否捕捉到5%/10%/20%标注比例实验与类别不平衡处理（class-weight/SMOTE/阈值）。",
              "score": 40,
              "evaluation_focus": "数据约束/学习策略",
              "scoring_hint": "高分：制定分层抽样和不平衡方案；中分：提到class-weight或SMOTE但无细节；低分：未考虑少样本与不平衡。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "输入输出与约束重述（百分比归一化与总和约束）",
              "description": "准确复述四频带总和≈100%并提出不满足时的重归一化方案。",
              "score": 25,
              "evaluation_focus": "需求对齐/数据理解",
              "scoring_hint": "高分：给出比例重标或闭合归一化；中分：仅提z-score；低分：忽略总和约束。"
            },
            {
              "sub_criteria": "评估协议复述（CV/LOS O/嵌套CV）",
              "description": "说明分层k折或留一被试验证、嵌套CV用于调参与评估分离。",
              "score": 35,
              "evaluation_focus": "验证设计",
              "scoring_hint": "高分：明确k与内外层目的；中分：仅k折；低分：随机切分且数据泄漏。"
            },
            {
              "sub_criteria": "性能度量与校准复述",
              "description": "列出总体准确率、每类F1、混淆矩阵、Cohen’s kappa、校准（Platt/Isotonic）、bootstrap CI。",
              "score": 40,
              "evaluation_focus": "评价体系",
              "scoring_hint": "高分：覆盖全部并说明用途；中分：部分度量；低分：仅准确率。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "观测分布与先验假设（HMM/HSMM多元高斯/协方差收缩）",
              "description": "明确观测为状态条件下多元高斯/混合高斯，协方差使用收缩或对角假设以适配少样本。",
              "score": 35,
              "evaluation_focus": "统计建模假设",
              "scoring_hint": "高分：阐明协方差形式与正则；中分：仅高斯；低分：无分布假设。"
            },
            {
              "sub_criteria": "标注稀缺与半监督可用性假设",
              "description": "假设无标签样本可代表同分布，支持半监督EM/自训练/标签传播的合理性与风控。",
              "score": 30,
              "evaluation_focus": "数据假设/可泛化性",
              "scoring_hint": "高分：讨论分布漂移与置信阈值；中分：仅说明可用；低分：无相关假设。"
            },
            {
              "sub_criteria": "类别不平衡与代价敏感假设",
              "description": "提出类别权重或代价矩阵（如N3漏检代价更高）设定依据。",
              "score": 35,
              "evaluation_focus": "代价建模",
              "scoring_hint": "高分：给出权重/代价并与目标对齐；中分：提到权重；低分：忽视不平衡。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "两路线设计：HMM/HSMM与判别基线（逻辑回归/随机森林）",
              "description": "给出时序与非时序两套结构，含状态定义、发射分布、持续时间建模与判别基线。",
              "score": 30,
              "evaluation_focus": "架构设计/可替代性",
              "scoring_hint": "高分：两套完整可切换；中分：单一路线；低分：模型不匹配数据结构。"
            },
            {
              "sub_criteria": "少样本与半监督机制集成",
              "description": "集成半监督EM/自训练（高置信伪标签）、标签传播，含回退与早停策略。",
              "score": 30,
              "evaluation_focus": "方法整合/稳健性",
              "scoring_hint": "高分：明确阈值与验证回退；中分：仅简单伪标签；低分：未用半监督。"
            },
            {
              "sub_criteria": "正则化与超参数空间设计",
              "description": "L2/协方差收缩、class-weight、树数与深度、HMM协方差类型、HSMM持续时间分布等搜索空间与先验范围。",
              "score": 25,
              "evaluation_focus": "泛化/调参策略",
              "scoring_hint": "高分：给出合理网格/贝叶斯范围；中分：少量手工调参；低分：无正则与调参。"
            },
            {
              "sub_criteria": "数据预处理流水线",
              "description": "缺失值处理（分层中位数/KNN/多重插补）、比例重归一化、z-score、异常值稳健处理与变换次序。",
              "score": 15,
              "evaluation_focus": "数据工程/可复现",
              "scoring_hint": "高分：固定顺序与fit在训练集；中分：部分环节；低分：泄漏或缺失处理。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "训练与验证协议（分层k折/LOS O与嵌套CV）",
              "description": "严格区分内外层，避免数据泄漏，固定随机种子与重复实验。",
              "score": 30,
              "evaluation_focus": "实验设计/可靠性",
              "scoring_hint": "高分：嵌套CV与多次重复；中分：单次k折；低分：随机切分且泄漏。"
            },
            {
              "sub_criteria": "半监督优化流程（EM/Viterbi、自训练迭代）",
              "description": "描述E/M步、软标签融合、置信阈值、早停与回滚机制；HSMM持续时间参数估计。",
              "score": 30,
              "evaluation_focus": "算法实现细节",
              "scoring_hint": "高分：完整EM与收敛准则；中分：简述步骤；低分：无细节或不当使用。"
            },
            {
              "sub_criteria": "类别不平衡处理与阈值调整",
              "description": "使用class-weight/SMOTE，并基于PR或ROC优化阈值以提升少数类F1。",
              "score": 20,
              "evaluation_focus": "实用优化",
              "scoring_hint": "高分：报告阈值选择依据与提升；中分：仅启用权重；低分：未处理不平衡。"
            },
            {
              "sub_criteria": "概率校准与置信区间估计",
              "description": "Platt/Isotonic校准并通过bootstrap给出准确率/F1/kappa的95% CI。",
              "score": 20,
              "evaluation_focus": "不确定性量化",
              "scoring_hint": "高分：提供校准曲线与CI；中分：仅校准或仅CI；低分：缺失两者。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "可复现性（随机种子/版本/管道封装）",
              "description": "固定random_state、保存环境与依赖版本，使用Pipeline封装预处理与模型。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：一键重现实验；中分：部分固定；低分：结果不可复现。"
            },
            {
              "sub_criteria": "实现完整性（预处理、模型、半监督、验证、评估）",
              "description": "包含数据清洗、分层抽样、半监督训练、嵌套CV、评估与可视化全部模块。",
              "score": 30,
              "evaluation_focus": "工程完备性",
              "scoring_hint": "高分：端到端脚本与函数化；中分：缺少1–2模块；低分：零散难运行。"
            },
            {
              "sub_criteria": "算法正确性（HMM/HSMM与基线实现）",
              "description": "正确使用hmmlearn/pomegranate或等价库，判别模型（逻辑回归/随机森林）参数设置合理。",
              "score": 25,
              "evaluation_focus": "实现正确性",
              "scoring_hint": "高分：参数与API正确、数值稳定；中分：小瑕疵不影响结果；低分：错误导致失效。"
            },
            {
              "sub_criteria": "效率与稳健性（收敛、早停、内存占用）",
              "description": "设置最大迭代、容忍度，避免过拟合与震荡，合理的计算复杂度。",
              "score": 15,
              "evaluation_focus": "性能与稳健",
              "scoring_hint": "高分：训练稳定且高效；中分：效率一般；低分：频繁不收敛或崩溃。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "性能报告：准确率/各类F1/混淆矩阵/Cohen’s kappa",
              "description": "系统展示总体与分类别指标，解释混淆模式（如N1与N2混淆）。",
              "score": 30,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：有洞见的误差分析；中分：仅列指标；低分：无分解与解释。"
            },
            {
              "sub_criteria": "不确定性与校准分析（校准曲线与CI）",
              "description": "评估概率校准（ECE/Brier可选）与bootstrap置信区间，讨论可信度。",
              "score": 25,
              "evaluation_focus": "不确定性评估",
              "scoring_hint": "高分：呈现曲线与CI并解读；中分：单一要素；低分：缺失或误解。"
            },
            {
              "sub_criteria": "学习曲线与少样本效益",
              "description": "给出5%/10%/20%标注比例的学习曲线与收益分析，说明边际效益。",
              "score": 25,
              "evaluation_focus": "数据效率",
              "scoring_hint": "高分：曲线与定量比较；中分：定性描述；低分：未做。"
            },
            {
              "sub_criteria": "稳健性与敏感性（超参/插补策略影响）",
              "description": "分析正则强度、协方差形式、插补方法对kappa/F1的影响。",
              "score": 20,
              "evaluation_focus": "稳健性分析",
              "scoring_hint": "高分：对比并量化变化；中分：粗略讨论；低分：未分析。"
            }
          ]
        }
      }
    }
  }
}