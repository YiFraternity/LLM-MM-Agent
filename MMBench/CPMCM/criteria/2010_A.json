{
  "task_id": "2010_A",
  "problem": "1. 由于基因表示之间存在着很强的相关性，所以对于某种特定的肿瘤，似乎会有大量的基因都与该肿瘤类型识别相关，但一般认为与一种肿瘤直接相关的突变基因数目很少。对于给定的数据（见附件），如何从上述观点出发，选择最好的分类因素？\n\n2. 相对于基因数目，样本往往很小，如果直接用于分类会造成小样本的学习问题，如何减少用于分类识别的基因特征是分类问题的核心，事实上只有当这种特征较少时，分类的效果才更好些。对于给定的结肠癌数据如何从分类的角度确定相应的基因“标签”？ \n\n3. 基因表达谱中不可避免地含有噪声（见1999 年Golub在《Science》发表的文章），有的噪声强度甚至较大，对含有噪声的基因表达谱提取信息时会产生偏差。通过建立噪声模型，分析给定数据中的噪声能否对确定基因标签产生有利的影响？\n\n4. 在肿瘤研究领域通常会已知若干个信息基因与某种癌症的关系密切，建立融入了这些有助于诊断肿瘤信息的确定基因“标签”的数学模型。比如临床有下面的生理学信息：大约90%结肠癌在早期有5号染色体长臂APC基因的失活，而只有40%~50%的ras相关基因突变。",
  "subtask": {
    "1": {
      "subtask": "子任务1（数据预处理与噪声建模与假设检验）旨在把原始微阵列/基因表达数据转换为可直接用于后续统计建模的高质量矩阵，并对测量误差结构给出可量化的估计与检验结论：其范围包括原始探针到基因的注释与汇总、背景校正与归一化、样本与探针质量控制、缺失值处理、低表达与低变异基因过滤、批次/系统偏差识别与校正、基因特异性测量误差（异方差与厚尾性）估计、并对噪声模型假设做形式化检验；最终产出为经校正的表达矩阵 X'、每基因的噪声参数（如 σ_j^2 或稳健方差估计）、每个样本/基因的质量标记与一份可复现的诊断报告。为实现上述目标应按下列步骤执行：1) 平台与注释处理：移除控制探针、用最新注释把探针汇总到基因层（如用探针中位数或基于表达一致性的聚合），记录多对一映射并保留可追溯的注释表；2) 背景校正与变换：对原始强度做背景校正并根据平台采用适当变换（如 RMA 或 vsn 的方差稳定化，或对数转 log2），检查转换后基因表达分布的对称性；3) 归一化与样本 QC：采用全局或分位数归一化（quantile normalization）并用主成分分析(PCA)、层次聚类、样本间相关矩阵及 arrayQualityMetrics 等工具识别离群样本与批次效应，统计各主成分与已知元数据（批次、芯片、处理日）之间的相关性以识别潜在混杂因子；4) 缺失值与低质量探针处理：若缺失比例很小，可用基于最近邻（KNN）或基于模型的插补（如 missForest/missMDA）填补，否则剔除高缺失探针/样本；5) 低表达/低变异过滤：基于检测 p 值或表达阈值剔除在多数样本中未检测到的基因（例如在 >80% 样本低于阈值），并剔除变异度极低的基因（如 IQR 或方差处于最低若干百分位），以降低后续噪声干扰；6) 批次与系统性效应校正：对识别出的批次变量采用 ComBat（sva 包）或线性混合模型校正，并在校正前后比较基于 PCA/方差分解的批次贡献以验证校正效果；7) 基因特异性噪声估计：在有重复实验或技术复刻时用重复内方差估计 σ_j^2，否则采用经验贝叶斯方差收缩（limma）或稳健估计（MAD）得到每基因的测量不确定度，并对残差分布检查是否显示异方差（Levene 或 Breusch–Pagan 测试）、厚尾（QQ 图、Shapiro–Wilk 或拟合 t 分布）或样本相关性；8) 噪声模型假设检验与调整建议：基于残差分析、拟合优度检验与可视化（QQ 图、残差-拟合值图）判断是否可假定 ε_ij ~ N(0,σ_j^2) 或应采用 t 分布/稳健模型，必要时记录采用 SIMEX 或误差在变量方法对后续估计进行校正的可行性与参数估计精度；9) 输出与记录：生成经校正的表达矩阵 X'（样本与基因均有质量标记）、每基因 σ_j^2 与置信区间或稳健替代值、对每个样本的质量评估、批次校正前后比较图及诊断测试结果，并把所有预处理脚本/参数化流水线（建议使用 Bioconductor 包如 affy/oligo、preprocessCore、vsn、limma、sva、arrayQualityMetrics、impute、simex 等）记录以保证可复现性。整个子任务应强调可复现的代码化流程、明确的阈值选择原则与对噪声假设的定量检验输出，以便后续任何建模步骤都能基于经验证的、带不确定度量化的输入数据进行。",
      "criteria": {
        "task_understanding": {
          "core_goal": "对原始微阵列/基因表达数据进行预处理与噪声建模与假设检验，拟合与评估测量误差结构并输出可用于后续建模的经校正表达矩阵 X' 与基因级方差参数",
          "expected_output": "经背景校正与归一化的表达矩阵 X'；基因级噪声参数 σ_j^2 或稳健方差估计及其区间；样本/基因质量标记与剔除列表；批次校正前后 PCA/方差分解与诊断图；噪声模型检验（QQ 图、Levene/BP/Shapiro/t 拟合）与结论；可复现实验脚本与参数化流水线报告",
          "key_inputs_constraints": "原始探针级强度矩阵（含平台与注释版本）；样本元数据（批次、芯片、处理日、分组）；检测p值或表达检测标记；允许使用的Bioconductor工具（affy/oligo、preprocessCore、vsn、limma、sva、arrayQualityMetrics、impute等）；缺失值比例与过滤阈值需事先设定并可复现；批次变量需在元数据中可识别",
          "modeling_type": "评价+拟合",
          "role_in_pipeline": "作为特征工程与模型训练前的清洗与误差建模环节；前序依赖原始芯片数据与注释；后序任务为特征选择/分类器训练与推断。该环节输出X'与误差参数供后续差异分析、特征筛选和分类模型使用",
          "assumptions": "附件数据为单色微阵列或已可转为探针强度；存在可用的批次标注；重复技术测量可能不足，需采用经验贝叶斯或稳健估计替代"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "明确“预处理与噪声建模与假设检验”的核心范围",
              "description": "是否把任务边界限定为注释汇总、背景校正/变换、归一化、QC、缺失处理、低表达/低变异过滤、批次校正、基因特异性方差估计与正态/厚尾假设检验，并指向产出 X' 与 σ_j^2",
              "score": 30,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：逐条覆盖全部步骤且无越界；中分：缺1–2项（如未含厚尾检验）；低分：混淆与后续分类训练或缺失关键环节"
            },
            {
              "sub_criteria": "识别关键输入与约束（平台、元数据、检测p值）",
              "description": "是否点出平台与注释版本依赖、批次元数据必要性、检测p值/低表达阈值的重要性与可复现参数化",
              "score": 25,
              "evaluation_focus": "需求抽取",
              "scoring_hint": "高分：列出平台/批次/检测p值并量化阈值；中分：提及其一两项；低分：未提输入依赖"
            },
            {
              "sub_criteria": "区分X与X'及σ_j^2的角色",
              "description": "是否清晰区分原始表达矩阵X、经校正矩阵X'与基因级噪声参数σ_j^2的用途与下游影响",
              "score": 25,
              "evaluation_focus": "概念分辨",
              "scoring_hint": "高分：解释三者及其流向；中分：只区分X与X'；低分：混用术语"
            },
            {
              "sub_criteria": "识别小样本与异方差/厚尾挑战",
              "description": "是否指出样本少、基因多导致估计不稳，需经验贝叶斯/稳健估计与t分布备选",
              "score": 20,
              "evaluation_focus": "风险识别",
              "scoring_hint": "高分：提出具体策略（limma、MAD、t拟合）；中分：泛提稳健；低分：未识别"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "用任务术语复述“背景校正与变换（log2/RMA/vsn）”",
              "description": "能否准确复述需对原始强度执行背景校正并进行log2或vsn的方差稳定化处理，检查分布对称性",
              "score": 30,
              "evaluation_focus": "精准复述",
              "scoring_hint": "高分：指明RMA/vsn与对称性检查；中分：只提log变换；低分：遗漏背景校正"
            },
            {
              "sub_criteria": "复述“归一化与样本QC（quantile、PCA、arrayQualityMetrics）”",
              "description": "是否指出分位数归一化与PCA/层次聚类/样本相关矩阵/arrayQualityMetrics识别离群与批次效应",
              "score": 30,
              "evaluation_focus": "流程把握",
              "scoring_hint": "高分：工具与目的匹配；中分：工具不全；低分：未提QC"
            },
            {
              "sub_criteria": "复述“批次校正（ComBat/混合模型）与前后验证”",
              "description": "是否复述使用sva::ComBat或LMM并用PCA/方差分解比较前后批次贡献",
              "score": 20,
              "evaluation_focus": "方法对齐",
              "scoring_hint": "高分：包含前后验证指标；中分：只说校正；低分：未提批次"
            },
            {
              "sub_criteria": "复述“基因特异性噪声估计与假设检验（Levene/BP/QQ/t）”",
              "description": "是否复述重复内方差/limma EB/MAD估计σ_j^2，并进行Levene或BP、QQ、Shapiro或t拟合检验",
              "score": 20,
              "evaluation_focus": "统计严谨",
              "scoring_hint": "高分：点名≥3种检验；中分：仅一种；低分：未提检验"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "噪声分布假设 ε_ij ~ N(0, σ_j^2) 或 t分布",
              "description": "明确提出基因特异性方差与可选厚尾t分布，并给出何时采用的判定准则",
              "score": 30,
              "evaluation_focus": "统计假设",
              "scoring_hint": "高分：基于QQ/KS/Shapiro与信息准则切换；中分：仅口头；低分：无假设"
            },
            {
              "sub_criteria": "异方差性与批次可加性假设",
              "description": "假设样本间方差随基因变化（异方差）且批次为可加效应并可被ComBat/LMM消除",
              "score": 25,
              "evaluation_focus": "模型设定",
              "scoring_hint": "高分：给出检验（Levene/BP、方差分解比例）；中分：只说明；低分：未考虑"
            },
            {
              "sub_criteria": "缺失机制假设（MAR/MCAR）",
              "description": "说明缺失近似MCAR/MAR并据此选择KNN/missForest，否则剔除高缺失基因/样本的阈值",
              "score": 20,
              "evaluation_focus": "数据机制",
              "scoring_hint": "高分：设定比例阈值（如>20%剔除）；中分：笼统；低分：未声明"
            },
            {
              "sub_criteria": "可复现性与阈值选择原则",
              "description": "明确低表达/低变异过滤、离群样本识别的可复现阈值与理由",
              "score": 25,
              "evaluation_focus": "规范性",
              "scoring_hint": "高分：具体数值（如>80%低于阈值、方差最低10%）；中分：模糊范围；低分：无阈值"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "注释汇总模型（探针→基因）与追溯表",
              "description": "设计探针到基因的聚合（中位数/一致性权重）并生成可追溯多对一注释表",
              "score": 25,
              "evaluation_focus": "数据建模",
              "scoring_hint": "高分：说明一致性判据或权重；中分：仅中位数；低分：跳过"
            },
            {
              "sub_criteria": "背景校正/变换与方差稳定化（RMA/vsn/log2）",
              "description": "给出选择RMA或vsn的依据，验证转换后对称性/均方稳定",
              "score": 25,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：含诊断图或数值检验；中分：仅说明方法；低分：未验证"
            },
            {
              "sub_criteria": "归一化与QC设计（quantile、PCA、arrayQualityMetrics）",
              "description": "构建分位数归一化流程与PCA/聚类/相关矩阵多图诊断，定义离群规则",
              "score": 25,
              "evaluation_focus": "流程设计",
              "scoring_hint": "高分：明确离群阈值（如PC1±3SD）；中分：无阈值；低分：无QC"
            },
            {
              "sub_criteria": "批次校正模型（ComBat/LMM）与验证指标",
              "description": "设定ComBat或线性混合模型公式并用方差分解/PCA相关评估校正效果",
              "score": 25,
              "evaluation_focus": "模型设定",
              "scoring_hint": "高分：报告批次方差占比下降；中分：仅运行；低分：无验证"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "缺失值插补/剔除的求解与敏感性分析",
              "description": "执行KNN或missForest并报告插补误差或对下游方差/PC的影响；高缺失剔除",
              "score": 25,
              "evaluation_focus": "实现细节",
              "scoring_hint": "高分：比较不同k或OOB误差；中分：单一路径；低分：忽略缺失"
            },
            {
              "sub_criteria": "基因特异性方差 σ_j^2 的估计与收缩",
              "description": "使用重复或limma EB/MAD稳健估计，报告方差分布与收缩前后对比",
              "score": 25,
              "evaluation_focus": "数值稳定",
              "scoring_hint": "高分：提供均值/中位数变化与直方图；中分：仅点估计；低分：未估计"
            },
            {
              "sub_criteria": "异方差与厚尾检验（Levene/BP、QQ、Shapiro/t拟合）",
              "description": "对残差执行多项检验并给出显著性与模型选择决策",
              "score": 25,
              "evaluation_focus": "统计检验",
              "scoring_hint": "高分：≥3检验一致并据此切换模型；中分：检验但无决策；低分：无检验"
            },
            {
              "sub_criteria": "批次前后PCA/方差分解对比与停止准则",
              "description": "量化批次贡献降低并设定停止或重试准则（如占比<5%）",
              "score": 25,
              "evaluation_focus": "质量控制",
              "scoring_hint": "高分：给出数值阈值与达到与否；中分：只有图；低分：无对比"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "可复现流水线与参数化（脚本化、种子、版本）",
              "description": "Bioconductor包版本锁定、随机种子、参数集中配置，生成完整运行日志",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：renv/lockfile与参数yaml；中分：部分固定；低分：不可复现"
            },
            {
              "sub_criteria": "使用指定工具链（affy/oligo、preprocessCore、vsn、limma、sva、arrayQualityMetrics、impute）",
              "description": "正确调用并串联上述包完成RMA/vsn、quantile、ComBat、EB方差与QC报告",
              "score": 30,
              "evaluation_focus": "工具熟练",
              "scoring_hint": "高分：工具调用覆盖全链路；中分：替代但等效；低分：自实现且不稳"
            },
            {
              "sub_criteria": "高效数据处理与内存管理",
              "description": "对大矩阵采用稀疏/块处理或矩阵运算，避免不必要复制并记录运行时间",
              "score": 20,
              "evaluation_focus": "工程能力",
              "scoring_hint": "高分：有性能指标；中分：尚可；低分：崩溃或明显低效"
            },
            {
              "sub_criteria": "诊断图与报告自动生成",
              "description": "自动导出PCA、QQ、残差图、批次前后对比、质量标记表与HTML报告",
              "score": 20,
              "evaluation_focus": "可视与报告",
              "scoring_hint": "高分：一键生成完整报告；中分：零散图；低分：无报告"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "X'质量评估与与X对比（分布/相关/变异）",
              "description": "对比X与X'在全局分布、样本间相关、基因变异的改变并解释合理性",
              "score": 25,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：给出定量差异与可视化；中分：定性描述；低分：无对比"
            },
            {
              "sub_criteria": "批次校正成效与残余混杂分析",
              "description": "报告批次方差占比下降、PC与批次相关性减弱以及是否存在残余混杂",
              "score": 25,
              "evaluation_focus": "因果辨析",
              "scoring_hint": "高分：占比数值与p值；中分：只有图；低分：无分析"
            },
            {
              "sub_criteria": "噪声模型适配性结论与调整建议（t分布/稳健/误差在变量）",
              "description": "基于检验决定采用正态或t分布/稳健模型，并提出SIMEX或误差在变量的可行性",
              "score": 25,
              "evaluation_focus": "方法选择",
              "scoring_hint": "高分：清晰决策与后续影响；中分：含糊；低分：无结论"
            },
            {
              "sub_criteria": "阈值敏感性与稳健性检查",
              "description": "分析低表达/低变异过滤阈值、缺失比例、ComBat参数对结果的敏感性",
              "score": 25,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：多阈值对比并量化变化；中分：少量试验；低分：未检验"
            }
          ]
        }
      }
    },
    "2": {
      "subtask": "子任务2（粗筛与候选基因集构建）的目标是从预处理后的基因表达矩阵 X′ 和对应样本标签 y 中，按明确、可复现且计算可行的规则快速将高维基因集合降为一个中等规模的候选集 J0（建议 p0≈500–2000，但可根据样本量 n 调整，如 p0 ≤ 10·n），以便后续多变量建模能在可信基因上进行细化选择；该子任务应输出候选基因索引 J0、对应的子矩阵 X′_{J0} 以及每个基因的注释与多项单变量评分和质量指标。具体步骤为： (1) 输入校验：读取已做背景校正、归一化和探针→基因汇总的表达矩阵 X′、样本标签 y、探针/基因注释表及每基因的测量不确定度估计 σ_j^2 或检测标志；剔除控制探针与注释缺失项目； (2) 低表达/低变异过滤：按检测阈值或表达量（例如在 >80% 样本中低于检测阈值）和变异阈值（如 IQR 或方差在最低若干百分位）剔除测量不可用或恒定的基因； (3) 单基因差异性与判别性评分：对每个剩余基因计算多种稳健单变量统计量——例如 limma 的 moderated t 及其 p 值和 log fold change、信噪比（SNR）、非参数 Wilcoxon/Mann–Whitney 检验、效应量（Cohen's d）、单基因 ROC-AUC 以及按 σ_j^2 加权的检验统计量；对 p 值进行多重假设校正（Benjamini–Hochberg）并记录校正后 q 值；(4) 可靠性与噪声权重校正：结合每基因的测量不确定度 σ_j^2、检测率与表达水平对评分做加权或下调，必要时剔除异方差极大或厚尾异常过多的基因；(5) 多指标汇总与排名策略：用明确规则将多项评分汇总为单一排序指标（可选方法：标准化后加权线性组合、秩聚合/Borda、Stouffer 合并 z 值或使用 IHW/weighted p-value 方法把可靠性作为权重），并明确权重设定；(6) 临床先验整合（软性保留）：若有先验基因集合 G0，可通过在汇总评分中给予这些基因预设加权或直接在最终候选集中保证出现来软性融入先验（应记录所用规则）；(7) 候选集确定准则：根据排名选取前 p0 基因，或采用复合阈（例如 q < α 且 |logFC| > δ 且检测率 > τ），并在选择时报告所用阈值；推荐同时输出若干备选 p0 值以便后续灵活调整；(8) 注释与输出：为 J0 中的每个基因导出详细元数据，包括基因ID、symbol、通路/组注释、所有原始评分、校正后的 p/q 值、σ_j^2、表达摘要统计（均值、IQR、检测率）以及在汇总排名中的位次；(9) 可重复性与实现细节：全部步骤应以脚本化流程实现（建议使用 Bioconductor 包如 limma、genefilter、IHW、pROC、rankaggregation 等或等效 R/Python 工具），记录随机种子和所有阈值/权重参数，并在需要的情形下在每个交叉验证训练子集中重复本粗筛流程以避免信息泄露；最终交付物为候选基因列表 J0、X′_{J0} 与完整的评分与质量表，供后续多变量建模使用。",
      "criteria": {
        "task_understanding": {
          "core_goal": "在给定经预处理的表达矩阵 X′ 与标签 y 的前提下，构建并评估可复现的粗筛与候选基因集构建流程，对单基因判别性进行评估与加权汇总，从而选择并输出候选基因集合 J0。",
          "expected_output": "候选基因索引 J0；子矩阵 X′_{J0}；包含基因ID/symbol、logFC、moderated t、SNR、Wilcoxon p、Cohen's d、ROC-AUC、BH q 值、σ_j^2、检测率、IQR、汇总排名等的评分与质量报表；参数与阈值配置、随机种子、先验整合规则的记录。",
          "key_inputs_constraints": "输入：经子任务1产出的 X′ (样本×基因矩阵)、样本标签 y、基因注释表、每基因测量不确定度 σ_j^2 或检测标志。约束：p0≈500–2000 或 p0 ≤ 10·n；多重检验需BH校正；需记录阈值(如 q<α、|logFC|>δ、检测率>τ)与权重；避免信息泄露（在交叉验证训练折内重复粗筛）。前置：完成背景校正/归一化/批次校正与QC。",
          "modeling_type": "评价+分类",
          "role_in_pipeline": "作为特征工程后、模型训练前的基因降维子任务，直接依赖子任务1（数据预处理与噪声建模），其输出（J0 与 X′_{J0}）供后续多变量模型（如Lasso/Elastic Net/SVM/贝叶斯模型）进行精细特征选择与分类评估。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "明确 X′ 与 y 的粗筛目标与 p0 ≤ 10·n 约束",
              "description": "是否清晰界定任务为从 X′ 与 y 构建候选基因集 J0，且显式采用 p0≈500–2000 或 p0 ≤ 10·n 的规模控制逻辑。",
              "score": 35,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：提出 p0 策略且给出计算规则；中分：提到控制规模但无量化；低分：未限制 p0 或规模不当。"
            },
            {
              "sub_criteria": "区分粗筛与后续多变量建模的角色",
              "description": "是否准确定位为单基因统计评价与候选集构建（非最终分类器），并强调避免信息泄露。",
              "score": 25,
              "evaluation_focus": "问题界定",
              "scoring_hint": "高分：说明在交叉验证训练折内重复粗筛；中分：仅提避免泄露；低分：未提信息泄露。"
            },
            {
              "sub_criteria": "纳入噪声与 σ_j^2 对评分的影响",
              "description": "是否识别需要用 σ_j^2、检测率、异方差对单基因评分做加权或下调。",
              "score": 20,
              "evaluation_focus": "统计意识",
              "scoring_hint": "高分：提出具体加权/剔除阈值；中分：仅口头说明；低分：完全忽略噪声权重。"
            },
            {
              "sub_criteria": "多重检验与 q 值控制",
              "description": "是否明确采用 BH 校正并在阈值中使用 q 值而非仅 p 值。",
              "score": 20,
              "evaluation_focus": "统计规范",
              "scoring_hint": "高分：给出 BH 与目标 FDR（如5%）；中分：仅写BH无阈；低分：未做多重校正。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "用任务术语复述 X′、J0、p0、q 值、logFC",
              "description": "复述中应包含关键对象与动作：对 X′ 计算单基因评分并汇总排序，输出 J0 与 X′_{J0}。",
              "score": 35,
              "evaluation_focus": "沟通表达",
              "scoring_hint": "高分：涵盖全部术语且逻辑顺序清楚；中分：缺少1–2个术语；低分：术语不一致或误导。"
            },
            {
              "sub_criteria": "阈值与排名策略的明确性",
              "description": "是否用明确阈值（q<α、|logFC|>δ、检测率>τ）或排名前 p0 两种之一并说明选择理由。",
              "score": 35,
              "evaluation_focus": "规范性",
              "scoring_hint": "高分：给出数值与依据；中分：给出形式未给数值；低分：未说明策略。"
            },
            {
              "sub_criteria": "先验基因 G0 的软性保留规则",
              "description": "是否准确描述对 G0 的加权或保留规则并强调可追溯记录。",
              "score": 30,
              "evaluation_focus": "需求把握",
              "scoring_hint": "高分：给定加权系数或保留比例；中分：只提软性保留；低分：未提或硬性强制且无说明。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "单基因统计检验前提（分布/异方差）",
              "description": "明确 t 检验/limma 需要的近似正态与方差稳健性假设，并提出用 limma/稳健统计缓解。",
              "score": 30,
              "evaluation_focus": "统计假设",
              "scoring_hint": "高分：指明 moderated t 与经验贝叶斯；中分：笼统正态假设；低分：无假设说明。"
            },
            {
              "sub_criteria": "独立性与多重检验控制假设",
              "description": "说明 BH 对相关性稳健的前提与在基因相关下的适用性或改进（如 IHW/weighted p）。",
              "score": 25,
              "evaluation_focus": "方法认知",
              "scoring_hint": "高分：提及 IHW/加权 p；中分：仅写BH可用；低分：忽略相关性问题。"
            },
            {
              "sub_criteria": "σ_j^2 可靠性与权重化假设",
              "description": "阐明测量不确定度可作为权重或惩罚项，且极端异方差基因需下调或剔除的假设。",
              "score": 25,
              "evaluation_focus": "鲁棒性",
              "scoring_hint": "高分：给出阈值如权重∝1/(σ_j^2+ε)；中分：仅原则性描述；低分：无处理。"
            },
            {
              "sub_criteria": "信息泄露避免的数据划分假设",
              "description": "明确粗筛需在每个训练折内重复，不得用全体样本进行筛选。",
              "score": 20,
              "evaluation_focus": "实验设计",
              "scoring_hint": "高分：写出折内重复流程；中分：仅提醒避免泄露；低分：默认全数据筛选。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "单基因多指标计算（limma t、logFC、SNR、Wilcoxon、d、ROC-AUC）",
              "description": "实现并列出上述指标及 BH 校正 q 值，确保对二分类 y 适配。",
              "score": 35,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：齐全且参数可见；中分：缺少2项以内；低分：仅单一指标或无 q 值。"
            },
            {
              "sub_criteria": "σ_j^2 与检测率的权重/下调机制",
              "description": "对评分进行基因级权重化或剔除（如检测率<τ、σ_j^2 位于顶端百分位）。",
              "score": 25,
              "evaluation_focus": "鲁棒建模",
              "scoring_hint": "高分：给定具体 τ 与分位阈值；中分：只口头描述；低分：未实施。"
            },
            {
              "sub_criteria": "多指标汇总策略与权重说明",
              "description": "采用标准化后加权和、秩聚合或 Stouffer z 合并，并给出权重或合并公式。",
              "score": 25,
              "evaluation_focus": "模型设计",
              "scoring_hint": "高分：公式/权重明确且可复现；中分：方法有但权重缺失；低分：简单平均且无依据。"
            },
            {
              "sub_criteria": "先验 G0 的软性整合",
              "description": "在汇总得分或排名中对 G0 加分或保留比例，并记录规则。",
              "score": 15,
              "evaluation_focus": "先验融合",
              "scoring_hint": "高分：量化加分或保留阈值；中分：仅声明保留；低分：未整合或不可追溯。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "阈值与 p0 选择的程序化实现",
              "description": "按照排名选前 p0 或复合阈(q<α、|logFC|>δ、检测率>τ)选取 J0，并可输出多档 p0。",
              "score": 35,
              "evaluation_focus": "实现可行",
              "scoring_hint": "高分：支持多档 p0 与复合阈；中分：仅一种策略；低分：人工挑选无代码。"
            },
            {
              "sub_criteria": "稳定性与敏感性检查",
              "description": "对随机种子、权重、阈值变化进行敏感性分析或重采样稳定排名评估。",
              "score": 25,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：报告重采样一致性指标（如Jaccard>0.6）；中分：定性说明；低分：未检查。"
            },
            {
              "sub_criteria": "计算效率与可扩展性",
              "description": "对高维基因数 p 的单基因计算与汇总采用向量化/并行，满足计算可行性。",
              "score": 20,
              "evaluation_focus": "计算工程",
              "scoring_hint": "高分：并行或矢量化且记录耗时；中分：可运行但慢；低分：不可扩展。"
            },
            {
              "sub_criteria": "交叉验证内重复粗筛流程",
              "description": "提供在训练折内重跑筛选并生成折别 J0 的实现接口，避免信息泄露。",
              "score": 20,
              "evaluation_focus": "实验流程",
              "scoring_hint": "高分：API/脚本示例清晰；中分：仅文字说明；低分：未提供。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "可复现性（随机种子、参数、版本）",
              "description": "固定随机种子，记录 α、δ、τ、p0、权重，记录依赖包版本与平台信息。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：自动写入元数据到报告；中分：手写在文档；低分：无记录。"
            },
            {
              "sub_criteria": "输入校验与数据一致性检查",
              "description": "校验 X′、y 维度与样本对齐、注释完整性、σ_j^2 可用性并剔除控制探针。",
              "score": 25,
              "evaluation_focus": "健壮性",
              "scoring_hint": "高分：显式断言与错误信息；中分：部分检查；低分：无检查导致潜在错配。"
            },
            {
              "sub_criteria": "指标计算与多重校正实现正确性",
              "description": "正确实现 limma moderated t、BH q 值、ROC-AUC、Wilcoxon、SNR、Cohen's d。",
              "score": 25,
              "evaluation_focus": "算法正确",
              "scoring_hint": "高分：与基准包结果一致性单测；中分：无单测但结果合理；低分：实现错误。"
            },
            {
              "sub_criteria": "输出结构化与可追溯",
              "description": "导出 J0、X′_{J0}、评分表；包含基因ID/symbol、全部原始评分、q 值、σ_j^2、检测率、IQR、排名位次。",
              "score": 20,
              "evaluation_focus": "工程产物",
              "scoring_hint": "高分：标准列名与字典；中分：缺少少量字段；低分：输出不完整或不可读。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "排名与阈值效果的可视化与解读",
              "description": "提供火山图、AUC分布、q 值–排名曲线，解读阈值对 J0 大小与质量的影响。",
              "score": 35,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：图+定量说明；中分：图或文其一；低分：无可视化与解释。"
            },
            {
              "sub_criteria": "噪声权重影响评估",
              "description": "比较有/无 σ_j^2 加权后的排名变化与候选集重叠（如Jaccard）并讨论稳健性。",
              "score": 25,
              "evaluation_focus": "稳健性评估",
              "scoring_hint": "高分：量化重叠和性能 proxy；中分：定性描述；低分：未比较。"
            },
            {
              "sub_criteria": "先验 G0 融合的透明度与影响",
              "description": "报告 G0 基因在最终排名/入选比例的变化，并说明权重选择的依据与敏感性。",
              "score": 20,
              "evaluation_focus": "先验评估",
              "scoring_hint": "高分：入选比例提升与统计检验；中分：仅比例；低分：未报告。"
            },
            {
              "sub_criteria": "可迁移性与后续建模适配性",
              "description": "讨论 J0 对后续多变量建模（Lasso/SVM）的样本维度适配与信息泄露控制策略。",
              "score": 20,
              "evaluation_focus": "流程衔接",
              "scoring_hint": "高分：提出在每折内重筛与管道接口；中分：笼统可用；低分：忽略后续需求。"
            }
          ]
        }
      }
    },
    "3": {
      "subtask": "子任务3（稀疏结构化多变量建模与求解）的目标是：在给定候选基因子集的表达矩阵 X_{J0}（n×p0）、对应的二分类标签 y、可选的基因网络或通路信息以形成子图拉普拉斯 L_{J0}、临床先验基因集 G0 以及每基因的噪声/不确定度估计 σ_j^2 的前提下，构建并求解一组能够同时实现（1）高泛化判别能力、（2）稀疏可解释的特征选择、（3）对基因间高度相关性与通路结构的稳健处理与（可选）不确定性量化的多变量判别模型；为此本子任务应按以下明确步骤执行并交付确定性与贝叶斯两类实现选项、相应求解器与输出。首先明确定义可选的模型形式（至少包括：A. 带复合惩罚的广义线性模型，如 logistic 损失 + λ1 ∑_j α_j |w_j| + λ2 ||w||_2^2 + λ_net w^T L_{J0} w，以实现 L1 稀疏、L2 稳定与图平滑；B. 组/稀疏组惩罚（group LASSO 或 sparse-group LASSO）以利用通路/基因组注释；C. 稀疏贝叶斯模型（spike-and-slab 或层次 Laplace/Gaussian 混合先验，结合图平滑先验 p(w) ∝ exp(−½ λ_net w^T L w)）以给出后验包含概率和不确定性），并说明如何将临床先验通过基因特定惩罚权重 α_j（对 j∈G0 设较小 α_j）或先验包含概率 π_j 融入模型。其次指定对测量不确定性的处理策略：若提供 σ_j^2，则在损失中采用基因加权（如按 1/σ_j^2 加权特征或样本），或在贝叶斯层次模型中显式建模观测误差（X = Z + ε）；若存在厚尾或异常值，提供替代稳健损失（Huber 或绝对偏差）或 t 分布误差模型的可选实现。第三明确求解方法与实现细节：确定性模型推荐使用坐标下降或近端梯度/ADMM 来处理 L1+L2+graph 项，建议借助成熟库（如 glmnet 为基础的弹性网实现并扩展以加入图惩罚、或使用 grpreg/gglasso/sparse-group LASSO 实现分组惩罚）；贝叶斯实现推荐用变分贝叶斯以获得可伸缩近似，或在最终小规模候选集上使用 MCMC（Stan/PyMC）以获取精确后验；并说明路径求解（λ 网格的 warm start）用于高效生成稀疏路径。第四给出超参数调优与收敛判据：要求在模型内层使用交叉验证或贝叶斯证据/信息准则选择 λ1,λ2,λ_net 及 α_j 权重，明确收敛阈值（相对目标函数变化 < 1e−6 或最大迭代数），并记录随机种子与初始化策略以保证可重复性。第五列出输出项：稀疏系数向量 w 与截距 b、非零特征索引与对应系数路径、若贝叶斯则给出每基因的后验包含概率与系数后验均值/置信区间、模型在训练/验证折上的预测度量（AUC/accuracy）、以及用于下游稳定性分析的中间结果（例如在不同 λ 下的非零集合）。第六说明计算规模与资源建议：建议 p0 尽量控制（典型≤2000），并提供时间复杂度与并行化策略（并行交叉验证与并行 λ 网格），若使用贝叶斯 MCMC 应限定在最终小集合上或采用变分近似以节省时间。最后明确交付物应为：可执行的脚本/函数（R/Python），包含模型公式、求解器配置、超参数搜索流程、收敛日志与所有结果文件，且每一步均能接受 X_{J0}, y, L_{J0}, G0, σ_j^2 为输入独立运行并生成上述输出，以便后续稳定性选择或生物学验证能够直接调用。",
      "criteria": {
        "task_understanding": {
          "core_goal": "在给定 X_{J0}, y, L_{J0}, G0 与 σ_j^2 的条件下，优化并拟合稀疏结构化多变量分类模型（如带 L1/L2/图惩罚的logistic回归与稀疏贝叶斯）以预测肿瘤类别并选择可解释基因特征。",
          "expected_output": "稀疏系数向量 w 与截距 b；非零特征索引与系数路径；交叉验证AUC/accuracy等评估；若为贝叶斯则给出后验包含概率、系数后验均值/区间；超参数(λ1,λ2,λ_net, α_j)与收敛日志；可执行脚本/函数与模型文件；中间结果用于稳定性分析。",
          "key_inputs_constraints": "输入：X_{J0}(n×p0 数值矩阵), y(二分类标签), L_{J0}(图拉普拉斯矩阵), G0(先验基因集), σ_j^2(每基因噪声估计)。约束：p0≤10·n 且典型≤2000；需要预处理完成且无严重批次未校正；L_{J0}需半正定；y类不极端失衡或需权重；随机种子需固定以复现。",
          "modeling_type": "分类+拟合+优化",
          "role_in_pipeline": "作为特征粗筛（子任务2）之后、稳定性选择与生物学验证之前的核心模型训练环节；前序依赖子任务1的预处理与子任务2的候选基因集，后序输出供稳定性评估、通路解释与临床整合。",
          "assumptions": "样本量中等（n≈50–300），p0已通过子任务2控制；类别标签可靠；允许交叉验证；可使用R/Python与常用库（glmnet/gglasso/Stan/PyMC）。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "明确分类目标与预测指标（AUC/accuracy）",
              "description": "是否将任务界定为对 y 的二分类预测，并明确以交叉验证AUC为主、accuracy为辅的评估框架。",
              "score": 30,
              "evaluation_focus": "问题边界",
              "scoring_hint": "高分：清晰指定CV-AUC为主指标并说明折数与重复；中分：提到AUC但未说明CV设置；低分：未说明分类指标或只给训练集精度。"
            },
            {
              "sub_criteria": "稀疏与可解释性需求识别（非零特征）",
              "description": "是否将特征选择与稀疏性作为核心目标，要求输出非零 w_j 集合与系数路径。",
              "score": 30,
              "evaluation_focus": "目标要点",
              "scoring_hint": "高分：设定L1/稀疏组约束并计划输出路径；中分：仅提到L1但无路径；低分：忽略稀疏或无非零集合。"
            },
            {
              "sub_criteria": "相关性与结构信息（L_{J0}, 通路）",
              "description": "是否识别到基因相关性与通路结构需通过图惩罚或组惩罚处理。",
              "score": 20,
              "evaluation_focus": "结构认知",
              "scoring_hint": "高分：明确使用 w^T L_{J0} w 或group LASSO；中分：笼统说明利用通路；低分：完全未提结构信息处理。"
            },
            {
              "sub_criteria": "噪声与不确定度（σ_j^2）权重处理",
              "description": "是否识别到测量不确定度需要在损失或先验中加权或建模。",
              "score": 20,
              "evaluation_focus": "鲁棒意识",
              "scoring_hint": "高分：提出1/σ_j^2加权或层次误差模型；中分：只提稳健损失无σ_j^2；低分：未考虑噪声。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "重述输入集合（X_{J0}, y, L_{J0}, G0, σ_j^2）",
              "description": "是否准确复述并区分必需输入与可选输入，并说明数据类型与维度。",
              "score": 30,
              "evaluation_focus": "信息提炼",
              "scoring_hint": "高分：列出尺寸与PSD要求；中分：列出但无约束；低分：输入缺失或混淆。"
            },
            {
              "sub_criteria": "模型形式A/B/C精确复述",
              "description": "是否逐一定义A:logistic+L1/L2+图，B:组/稀疏组，C:稀疏贝叶斯并点明用途。",
              "score": 30,
              "evaluation_focus": "规范表达",
              "scoring_hint": "高分：三类模型皆有且含惩罚项符号；中分：漏一类或不完整；低分：泛泛而谈。"
            },
            {
              "sub_criteria": "超参数与调优目标复述（λ1,λ2,λ_net, α_j）",
              "description": "是否明确需通过CV/证据准则选择超参数并固定随机种子。",
              "score": 20,
              "evaluation_focus": "约束梳理",
              "scoring_hint": "高分：说明网格/路径与折数；中分：只说调参；低分：未提超参数。"
            },
            {
              "sub_criteria": "计算规模与资源限制复述（p0≤2000）",
              "description": "是否指出规模控制与并行策略（并行CV与λ网格）。",
              "score": 20,
              "evaluation_focus": "可行性",
              "scoring_hint": "高分：给出并行点与内存考量；中分：仅提规模；低分：无任何规模讨论。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "噪声分布与稳健性假设（正态/厚尾）",
              "description": "阐明ε或观测误差模型，何时改用Huber/绝对偏差或t分布误差。",
              "score": 25,
              "evaluation_focus": "统计假设",
              "scoring_hint": "高分：给出基于残差/QQ图触发条件；中分：泛述厚尾；低分：无噪声假设。"
            },
            {
              "sub_criteria": "图拉普拉斯与组结构假设",
              "description": "说明L_{J0}为半正定、连接表示相关基因/通路；组定义来源与重叠处理策略。",
              "score": 25,
              "evaluation_focus": "结构假设",
              "scoring_hint": "高分：阐明构图/归一化与重叠组处理；中分：仅说使用通路；低分：未提。"
            },
            {
              "sub_criteria": "先验整合假设（G0与α_j或π_j）",
              "description": "定义对G0降低惩罚或提高先验包含概率的规则与边界。",
              "score": 25,
              "evaluation_focus": "先验建模",
              "scoring_hint": "高分：给出α_j缩放范围或π_j设定；中分：仅口头偏置；低分：无先验机制。"
            },
            {
              "sub_criteria": "类不平衡与CV假设",
              "description": "说明分层CV或类别权重的假设，避免信息泄露（按训练折内调参）。",
              "score": 25,
              "evaluation_focus": "可靠评估",
              "scoring_hint": "高分：声明分层k折与内外层设置；中分：普通CV；低分：混用全数据调参。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "A模型公式：logistic + λ1∑α_j|w_j| + λ2||w||_2^2 + λ_net w^T L w",
              "description": "是否给出完整目标函数、包含σ_j^2加权或稳健替代选项。",
              "score": 35,
              "evaluation_focus": "公式完备",
              "scoring_hint": "高分：明确损失、惩罚、权重并可选Huber/t；中分：缺一项；低分：无公式。"
            },
            {
              "sub_criteria": "B模型：group/sparse-group LASSO构造",
              "description": "定义组索引、组惩罚与L1稀疏权衡，并说明通路到组的映射。",
              "score": 25,
              "evaluation_focus": "结构利用",
              "scoring_hint": "高分：给出λ_group与L1混合比例；中分：只提group；低分：未定义组。"
            },
            {
              "sub_criteria": "C模型：稀疏贝叶斯先验与图平滑先验",
              "description": "给出spike-and-slab或层次Laplace/Gaussian混合，叠加图先验与π_j。",
              "score": 25,
              "evaluation_focus": "贝叶斯建模",
              "scoring_hint": "高分：写出先验层级与π_j/σ_j^2作用；中分：仅口述；低分：无先验细节。"
            },
            {
              "sub_criteria": "临床先验 G0 融合为α_j或π_j",
              "description": "明确软性保留规则与对排名/惩罚的影响，避免硬性泄漏。",
              "score": 15,
              "evaluation_focus": "先验融合",
              "scoring_hint": "高分：量化α_j缩减比例并限定范围；中分：只说降低惩罚；低分：未融合或硬性固定特征。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "优化算法选择（坐标下降/近端梯度/ADMM）",
              "description": "为L1+L2+图项选择合适求解器并说明收敛判据（相对目标<1e−6或最大迭代）。",
              "score": 30,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：算法与惩罚匹配且含收敛阈值；中分：给算法无判据；低分：算法不当或缺失。"
            },
            {
              "sub_criteria": "路径求解与warm start（λ网格）",
              "description": "说明λ路径构造、warm start与并行策略以提升效率。",
              "score": 20,
              "evaluation_focus": "效率优化",
              "scoring_hint": "高分：几何级网格+warm start；中分：仅网格；低分：单点λ或无说明。"
            },
            {
              "sub_criteria": "贝叶斯推断（变分或MCMC）",
              "description": "选择VB用于可扩展性或小规模用MCMC（Stan/PyMC），给出收敛/诊断标准。",
              "score": 25,
              "evaluation_focus": "推断策略",
              "scoring_hint": "高分：VB容差/ELBO收敛或MCMC Rhat<1.1与有效样本量；中分：仅提VB/MCMC；低分：无诊断。"
            },
            {
              "sub_criteria": "超参数调优与交叉验证",
              "description": "分层k折CV或外层验证，选择λ1,λ2,λ_net, α_j，并固定随机种子。",
              "score": 25,
              "evaluation_focus": "调参与验证",
              "scoring_hint": "高分：明确k与重复次数、种子与网格范围；中分：仅k折；低分：训练集内调参无CV。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "可执行脚本/函数接口（输入X_{J0}, y, L_{J0}, G0, σ_j^2）",
              "description": "提供清晰API与参数校验，独立运行生成全部输出。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：类型/维度检查与错误信息；中分：基本运行；低分：依赖手工步骤。"
            },
            {
              "sub_criteria": "库与求解器正确调用（glmnet/grpreg/gglasso/Stan/PyMC）",
              "description": "正确映射惩罚与权重到库参数，保存收敛日志。",
              "score": 25,
              "evaluation_focus": "工程落地",
              "scoring_hint": "高分：含日志与警告处理；中分：可运行但无日志；低分：参数映射错误。"
            },
            {
              "sub_criteria": "可复现性（随机种子、配置、版本锁定）",
              "description": "固定种子、记录软件版本与超参数配置文件。",
              "score": 25,
              "evaluation_focus": "复现保障",
              "scoring_hint": "高分：配置文件+环境说明；中分：仅设种子；低分：结果不可重现。"
            },
            {
              "sub_criteria": "并行与性能（并行CV/λ网格）",
              "description": "实现可选并行，避免内存峰值，控制p0≤2000。",
              "score": 20,
              "evaluation_focus": "性能工程",
              "scoring_hint": "高分：可配置并行和资源限制；中分：单线程可接受；低分：运行缓慢或崩溃。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "预测性能报告（CV AUC/accuracy与区间）",
              "description": "提供折间均值±标准差或置信区间，基线对比。",
              "score": 30,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：AUC均值±SD与基线；中分：仅均值；低分：只报训练集。"
            },
            {
              "sub_criteria": "稀疏特征与系数路径解读",
              "description": "报告非零集合、通路分布、λ路径下稳定性趋势。",
              "score": 25,
              "evaluation_focus": "可解释性",
              "scoring_hint": "高分：稳定性随λ图与生物学注释；中分：列出基因；低分：无解读。"
            },
            {
              "sub_criteria": "不确定性与噪声影响（σ_j^2或贝叶斯区间）",
              "description": "分析σ_j^2权重对选择的影响，或报告后验包含概率与区间。",
              "score": 25,
              "evaluation_focus": "不确定度",
              "scoring_hint": "高分：比较加权vs不加权结果；中分：仅给区间；低分：未涉及。"
            },
            {
              "sub_criteria": "结构与先验贡献评估（L_{J0}, G0, α_j/π_j）",
              "description": "消融实验：无图/无先验与完整模型对比，量化AUC变化。",
              "score": 20,
              "evaluation_focus": "因果归因",
              "scoring_hint": "高分：报告ΔAUC与显著性；中分：定性说明；低分：无消融分析。"
            }
          ]
        }
      }
    },
    "4": {
      "subtask": "子任务4（稳定性选择、嵌套交叉验证、敏感性分析、外部生物学验证与部署）旨在以可控的假阳性率和可量化的不确定性输出最终、少量且稳定的“信息基因”集合并交付可复现的分类器与部署说明：输入为已预处理并经过粗筛得到的候选基因子集表达矩阵 X_{J0}、标签向量 y、（可选）基因网络/分组信息 L_{J0}、临床先验基因集合 G0 及每基因噪声或不确定度估计 σ_j^2；输出为（1）最终候选基因列表及每基因的选择频率/后验包含概率和排名，（2）最终训练的低维分类器参数与决策阈值，（3）严格的泛化性能估计（外层嵌套交叉验证下的 AUC、敏感性、特异性、准确率及其置信区间）、（4）稳定性与敏感性诊断报告（选择频率分布、Jaccard 相似度矩阵、稀疏路径图、对关键超参数的性能/选择变化表）、（5）可执行的预测脚本、预处理与特征标准化规范、以及外部验证与在线更新的操作说明。方法与步骤应包括：采用稳定性选择框架——对原始样本进行 B 次随机子抽样（推荐每次抽取约 ⌊n/2⌋ 的样本且分层抽样以保留类别比例，B 建议 100–500，根据计算资源调整），在每次子样本上运行完整的特征选择与模型拟合流程（包括内层超参数选择），记录每次拟合中被选中基因的指标并计算选择频率 π̂_j；为抗相关性和增加随机化可在每次拟合中引入特征扰动（如随机权重或随机子集）或使用随机化 Lasso/Sparse-Group Lasso 变体；使用 Meinshausen–Bühlmann 稳定性选择的理论或经验启发式来设定选择频率阈值（例如 0.6–0.9）以控制期望假阳性数，并报告所用阈值对应的理论/经验错误率控制依据。并行地采用嵌套交叉验证估计泛化性能：外层 K_outer（通常 5 或 10）用于性能评估，内层 K_inner（通常 5）用于超参数调优和每次训练时的完整筛选流程（必须在每个内层训练折内重复粗筛以避免信息泄露），对每次外层测试折收集性能指标并通过重复随机划分或自助法求取置信区间；在内层超参搜索时应同步记录不同 λ、p0、噪声加权和先验权重 α_j 下的非零特征路径以供稳定性分析使用。敏感性分析应系统评估并报告最终基因集合与性能对以下因素的依赖性：候选集规模 p0、选择频率阈值、子抽样比例 B 与抽样策略、正则化强度 λ 的范围与选择方法、噪声模型（高斯/厚尾/带权重）、对临床先验权重 α_j/π_j 的变化，以及是否使用图/组惩罚；对每个因素输出定量表（例如 Jaccard 随参数变化曲线、AUC 随参数变化曲线）并标识对结果影响最大的参数。外部生物学验证步骤应明确操作流程：优先在独立队列（技术平台相同或可比的队列）上评估分类器表现并报告差异；对排序靠前的若干基因（建议 5–20，依据稳定性与临床可行性）制定 qPCR/低通量验证计划并给出所需样本量的粗略计算以达到预期的检验功效；在跨平台验证时要求对输入数据采用与训练时一致的归一化/批次校正流程或提供再校准方案（例如基于参考样本或标准化系数）。部署与交付应包含：基于全训练数据在最终选定基因上重训练并固化模型（包含系数、截距、特征顺序和标准化参数）、提供可执行代码（R/Python，包含随机种子、依赖项和运行参数）、预测 API 或脚本说明、模型版本号与元数据、模型校准建议（阈值选择准则或成本敏感决策规则）以及在线更新策略（warm start 指南、何时触发重新训练、如何保留历史选择频率以维持可比性）。在计算实施上建议并行化 B 次子样本拟合和 λ 网格搜索来缩短时间，使用成熟工具（例如 R 的 glmnet、stabs 或 Python 的 scikit-learn + joblib；如需贝叶斯后验概率可在最终小集合上用 Stan/PyMC 运行 MCMC 或变分推断）并确保所有随机过程均记录随机种子以保证可重复性。最终交付的报告需包含：选择频率表与排序、最终模型与性能摘要、稳定性与敏感性图表、外部验证结果与实验验证建议、以及完整的可运行代码与运行说明，所有结果应以可复现、可审计的形式存档以便临床或实验组按步骤复现与部署。",
      "criteria": {
        "task_understanding": {
          "core_goal": "在候选基因表达矩阵 X_{J0} 与标签 y 上，通过稳定性选择与嵌套交叉验证拟合与评估稀疏分类模型，输出稳定的信息基因集合与可部署分类器并量化不确定性。",
          "expected_output": "最终基因列表及选择频率/后验包含概率排名；最终训练的低维分类器参数与决策阈值；外层嵌套交叉验证的 AUC/敏感性/特异性/准确率及置信区间；稳定性与敏感性诊断图表与报告；可执行预测脚本与部署说明、模型文件与版本元数据。",
          "key_inputs_constraints": "输入：X_{J0}(n×p0) 数值矩阵、y 二分类标签、可选 L_{J0} 图拉普拉斯、G0 先验集合、每基因噪声估计 σ_j^2；约束：稳定性选择需 B∈[100,500] 次分层子抽样且每次样本量≈⌊n/2⌋；嵌套交叉验证需 K_outer∈{5,10}、K_inner≈5；每个内层训练折必须重复粗筛以避免信息泄露；p0≤10·n 且建议≤2000；记录随机种子与超参网格。",
          "modeling_type": "分类+评价",
          "role_in_pipeline": "作为最终选择与验证部署环节，位于粗筛与多变量建模之后、应用部署之前；前序依赖：子任务1预处理与噪声建模、子任务2候选集、子任务3模型族与求解器；后序输出供生物学外部验证与临床部署使用。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "稳定性选择目标与假阳性控制",
              "description": "是否明确以 B 次分层子抽样与选择频率 π̂_j 估计为核心，设定阈值(如0.6–0.9)并依据 Meinshausen–Bühlmann 理论控制期望假阳性数。",
              "score": 30,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：给出阈值与期望假阳性公式并计算；中分：给出阈值与经验理由；低分：未提阈值或无法说明错误率控制。"
            },
            {
              "sub_criteria": "嵌套交叉验证的泛化评估",
              "description": "是否识别必须使用外层 K_outer 与内层 K_inner，并在内层进行超参选择、外层仅评估，避免信息泄露。",
              "score": 30,
              "evaluation_focus": "评价设计",
              "scoring_hint": "高分：清晰区分内外层并在内层重复粗筛；中分：有内外层但未提粗筛重复；低分：仅单层CV或泄露。"
            },
            {
              "sub_criteria": "不确定性量化与性能指标",
              "description": "是否要求输出 AUC、敏感性、特异性、准确率及置信区间，并说明获取方式（重复划分/自助法）。",
              "score": 20,
              "evaluation_focus": "指标选择",
              "scoring_hint": "高分：列全指标并给CI方法；中分：部分指标或无CI方法；低分：仅单一指标或无量化不确定性。"
            },
            {
              "sub_criteria": "部署与可复现要求",
              "description": "是否识别需要固定特征顺序、标准化参数、系数与阈值、随机种子、版本与API说明。",
              "score": 20,
              "evaluation_focus": "工程规范",
              "scoring_hint": "高分：列举全部要素并落到产出物；中分：提及部分；低分：无可复现与部署要素。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "X_{J0}, y, σ_j^2, L_{J0}, G0 的使用边界",
              "description": "能否复述并区分必需输入（X_{J0}, y）与可选输入（σ_j^2, L_{J0}, G0）及其作用（加权、图惩罚、先验权重）。",
              "score": 30,
              "evaluation_focus": "需求澄清",
              "scoring_hint": "高分：逐项说明用途；中分：笼统描述；低分：混淆或遗漏关键输入。"
            },
            {
              "sub_criteria": "稳定性选择与随机化策略复述",
              "description": "准确复述 B 次⌊n/2⌋分层子抽样、特征扰动/随机化 Lasso 以抗相关性的目的与流程。",
              "score": 30,
              "evaluation_focus": "流程把握",
              "scoring_hint": "高分：给出子抽样规模与扰动方式；中分：仅说子抽样；低分：未提随机化或规模。"
            },
            {
              "sub_criteria": "嵌套CV与信息泄露防控",
              "description": "清楚陈述在每个内层训练折内需重复粗筛与预处理标准化拟合，避免外层测试信息进入训练。",
              "score": 40,
              "evaluation_focus": "风险控制",
              "scoring_hint": "高分：明确在内层管道化重复；中分：提到避免泄露但无操作细节；低分：未考虑泄露。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "选择频率阈值与错误率假设",
              "description": "给出选择频率阈值与期望假阳性控制假设（如基于MB框架）及其适用前提（近似独立/稀疏）。",
              "score": 30,
              "evaluation_focus": "统计假设",
              "scoring_hint": "高分：阐明公式与前提；中分：仅经验阈值；低分：无假设或与目标不符。"
            },
            {
              "sub_criteria": "噪声模型与稳健性假设",
              "description": "说明使用 σ_j^2 加权或厚尾稳健损失（t/Huber）的假设与何时启用。",
              "score": 25,
              "evaluation_focus": "鲁棒性",
              "scoring_hint": "高分：给出启用判据（如残差重尾诊断）；中分：泛述；低分：忽略噪声处理。"
            },
            {
              "sub_criteria": "先验基因 G0 的软性整合假设",
              "description": "阐明通过 α_j 或 π_j 调整但不强制选择的假设与潜在偏差控制。",
              "score": 20,
              "evaluation_focus": "先验融合",
              "scoring_hint": "高分：说明权重范围与敏感性评估；中分：仅说提高权重；低分：硬性纳入或未说明。"
            },
            {
              "sub_criteria": "嵌套交叉验证独立性假设",
              "description": "假设外层测试折独立且不参与任何拟合或超参选择，并给出随机种子管理。",
              "score": 25,
              "evaluation_focus": "实验设计",
              "scoring_hint": "高分：描述分层拆分与种子固定；中分：只说独立；低分：无提及或混用数据。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "稳定性选择管道定义",
              "description": "完整定义一次子样本中的流程：分层抽样→特征扰动/子集→内层调参→稀疏模型拟合→记录被选基因。",
              "score": 30,
              "evaluation_focus": "流程设计",
              "scoring_hint": "高分：步骤齐全并可复现；中分：缺1–2步；低分：流程缺失或不一致。"
            },
            {
              "sub_criteria": "嵌套CV搜索空间与日志",
              "description": "明确 λ、p0、α_j、λ_net 等搜索范围与步长，并记录路径与非零集合。",
              "score": 25,
              "evaluation_focus": "超参设计",
              "scoring_hint": "高分：列网格/自适应策略与记录项；中分：给粗略范围；低分：无范围或未记录。"
            },
            {
              "sub_criteria": "不确定性与阈值/成本敏感决策",
              "description": "构建阈值选择准则（如Youden、固定灵敏度）并考虑类别不均衡与成本权重。",
              "score": 20,
              "evaluation_focus": "决策制定",
              "scoring_hint": "高分：给出阈值规则与类权；中分：单一阈值；低分：默认0.5且无依据。"
            },
            {
              "sub_criteria": "外部生物学验证接口",
              "description": "在模型构建中预留导出前20基因与注释、供qPCR/外部队列验证的接口与格式。",
              "score": 25,
              "evaluation_focus": "可用性",
              "scoring_hint": "高分：定义字段与文件格式；中分：只提导出；低分：无接口。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "并行化与可扩展性",
              "description": "并行 B 次子样本与 λ 网格，控制 p0≤2000，报告时间与资源占用。",
              "score": 30,
              "evaluation_focus": "计算工程",
              "scoring_hint": "高分：实际并行与资源报告；中分：声明可并行；低分：串行且无规模控制。"
            },
            {
              "sub_criteria": "收敛与停止准则",
              "description": "设定相对目标变化<1e-6或最大迭代数，并记录收敛日志与失败重试策略。",
              "score": 25,
              "evaluation_focus": "数值稳定",
              "scoring_hint": "高分：具体阈值与日志；中分：笼统“直至收敛”；低分：无准则。"
            },
            {
              "sub_criteria": "噪声加权/稳健求解实现",
              "description": "在损失中应用 1/σ_j^2 加权或使用Huber/t损失，并验证对路径与选择频率的影响。",
              "score": 25,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：实现并对比影响；中分：仅实现未评估；低分：未实现。"
            },
            {
              "sub_criteria": "随机性控制与复现实验",
              "description": "固定多处随机种子（拆分、特征扰动、初始化），并复现实验得到相近 π̂_j 与AUC。",
              "score": 20,
              "evaluation_focus": "可复现性",
              "scoring_hint": "高分：复现实验差异<±0.02 AUC；中分：差异较大但趋势一致；低分：不可复现。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "管道化与无信息泄露实现",
              "description": "以可执行脚本/R或Python包形式实现：在每个内层折内重复粗筛、标准化、调参与拟合。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：模块化Pipeline并自动化验证；中分：手写流程可运行；低分：泄露或不可运行。"
            },
            {
              "sub_criteria": "接口与产物规范",
              "description": "导出选择频率表、最终模型文件（系数、截距、特征顺序、标准化参数）、预测API/CLI与版本元数据。",
              "score": 25,
              "evaluation_focus": "工程规范",
              "scoring_hint": "高分：齐全且含示例；中分：部分产物；低分：仅打印结果无文件。"
            },
            {
              "sub_criteria": "并行与日志监控",
              "description": "整合joblib/未来包等并行，提供进度条、种子、超参与性能日志，失败重试与缓存。",
              "score": 25,
              "evaluation_focus": "可维护性",
              "scoring_hint": "高分：稳定并行与详尽日志；中分：并行但日志简略；低分：无并行无日志。"
            },
            {
              "sub_criteria": "可配置性与参数记录",
              "description": "配置文件/命令行参数化 B、K_outer、K_inner、阈值、λ网格、α_j，自动保存配置快照。",
              "score": 20,
              "evaluation_focus": "可配置性",
              "scoring_hint": "高分：配置驱动与快照；中分：代码内常量；低分：难以复用。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "选择频率与稳定性报告",
              "description": "提供 π̂_j 排名、频率分布、阈值选择依据、不同 λ 下非零集合与Jaccard相似度矩阵。",
              "score": 30,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：图表与数表完整；中分：仅频率排名；低分：无稳定性分析。"
            },
            {
              "sub_criteria": "泛化性能与置信区间",
              "description": "汇总外层折 AUC/敏感性/特异性/准确率，给出95%CI与统计不确定性解读。",
              "score": 25,
              "evaluation_focus": "统计报告",
              "scoring_hint": "高分：含CI与解读；中分：无CI；低分：训练集性能代替泛化。"
            },
            {
              "sub_criteria": "敏感性分析与关键参数识别",
              "description": "量化 p0、阈值、B、λ、α_j、λ_net、噪声模型对AUC与Jaccard的影响并指出最敏感参数。",
              "score": 25,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：提供曲线与排序；中分：定性描述；低分：未做敏感性。"
            },
            {
              "sub_criteria": "外部生物学验证与部署准备",
              "description": "报告独立队列表现差异、给出前5–20基因qPCR建议与样本量估算，并提供最终重训练与阈值校准说明。",
              "score": 20,
              "evaluation_focus": "转化能力",
              "scoring_hint": "高分：含样本量粗算与再校准方案；中分：仅列基因与外部AUC；低分：无外部验证或建议。"
            }
          ]
        }
      }
    }
  }
}