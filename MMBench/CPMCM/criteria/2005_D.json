{
  "task_id": "2005_D",
  "problem": "某商场销售的某种商品。市场上这种商品的销售速率假设是不变的，记为 $r$；每次进货的订货费为常数 $c_1$，与商品的数量和品种无关；使用自己的仓库存贮商品时，单位商品每天的存贮费用记为 $c_2$，由于自己的仓库容量有限，超出时需要使用租借的仓库存贮商品，单位商品每天的存贮费用记为 $c_3$，且 $c_2 \\leq c_3$；允许商品缺货，但因缺货而减少销售要造成损失，单位商品的损失记为 $c_4$；每次订货，设货物在 $x$ 天后到达，交货时间 $x$ 是随机的；自己的仓库用于存贮该商品的最大容量为 $Q_0$，每次到货后使这种商品的存贮量 $q$ 补充到固定值 $Q$ 为止，且 $Q_0 < Q$；在销售过程中每当存贮量 $q$ 降到 $L$ 时即开始订货。请你给出求使总损失费用达到最低的订货点 $L^*$（最优订货点）的数学模型。\n\n问题2 以下是来自某个大型超市的关于三种商品的真实数据：\n\n商品一：康师傅精装巧碗香菇炖鸡面 \n$r = 12~\\text{盒/天}$；\n$c_1 = 10~\\text{元}$；\n$c_2 = 0.01~\\text{元/盒·天}$；\n$c_3 = 0.02~\\text{元/盒·天}$；\n$c_4 = 0.95~\\text{元/盒·天}$；\n$Q_0 = 40~\\text{盒}$；\n$Q = 60~\\text{盒}$。\n共有连续的 $36$ 次订货后到达时间天数记录如下：\n$3,3,7,1,2,3,3,0,3,4,6,1,4,3,3,2,5,2,3,2,5,2,3,3,0,3,4,3,1,4,5,4,3,1$。 \n\n商品二：心相印手帕纸 $10$ 小包装 \n$r = 15~\\text{盒/天}$；\n$c_1 = 10~\\text{元}$；\n$c_2 = 0.03~\\text{元/盒·天}$心相印手帕纸 $10$ 小包装 \n$c_3 = 0.04~\\text{元/盒·天}$；\n$c_4 = 1.50~\\text{元/盒·天}$；\n$Q_0 = 40~\\text{盒}$；\n$Q = 60~\\text{盒}$。\n共有连续的 $43$ 次订货后到达时间天数记录如下：\n$4,2,3,3,2,2,2,2,2,2,2,3,2,1,2,4,3,2,2,4,2,4,3,3,3,2,3,2,3,2,1,3,2,5,3,2,4,2,2$。 \n\n商品三：中汇香米 $5\\,\\text{KG}$ 装 \n$r = 20~\\text{袋/天}$；\n$c_1 = 10~\\text{元}$；\n$c_2 = 0.06~\\text{元/袋·天}$；\n$c_3 = 0.08~\\text{元/袋·天}$；\n$c_4 = 1.25~\\text{元/袋·天}$；\n$Q_0 = 20~\\text{袋}$；\n$Q = 40~\\text{袋}$。\n共有连续的 $61$ 次订货后到达时间天数记录如下：\n$3,4,4,2,3,2,3,2,3,1,2,1,1,1,2,1,1,1,1,2,5,1,1,1,1,1,2,2,1,2,2,3,3,1,2,2,1,2,2,1,2,1,2,1,2,1,1,2,3,2,5,6,3,4,3,1$。 \n\n按你的模型分别计算出这三种商品各自相应的最优订货点 $L^*$。\n\n问题3：问题1是只有一种商品需要定货的情形。实际上常遇到在库存容量有限的情况下，有多种商品需要同时订货的情形，这时需考虑充分利用库存体积的问题。设有 $m$ 种商品需要订货，它们每次同一间从一个供应站订货，每次进货的订货费为常数 $c_1$，与商品的数量和品种无关；订购的货物同时到达，到货天数 $X$ 如问题1所述是随机的。这 $m$ 种商品的销售速率分别为 $r_i$（袋或盒/天）$\\,(i=1,2,\\ldots,m)$，每袋（或盒）的体积分别为 $v_i\\,(i=1,2,\\ldots,m)$。使用自己的仓库和租借的仓库时单位体积商品每天的存贮费分别记成 $c_{2i}$ 和 $c_{3i}\\,(i=1,2,\\ldots,m)$，单位体积商品每天的缺货损失记成 $c_{4i}\\,(i=1,2,\\ldots,m)$，自己的仓库用于存贮这 $m$ 种商品的总体积容量为 $Q_0$，每次到货后这 $m$ 种商品的存贮量总体积补充到固定体积容量 $Q$ 为止，且 $Q_0<Q$。每当这 $m$ 种商品的存贮量总体积 $q$ 降到 $L$ 时即开始订货。试通过建立数学模型说明应如何确定最优订货点 $L^*$ 和自己的仓库用于存贮这 $m$ 种商品的各自体积容量 $Q_{0i}\\,(i=1,2,\\ldots,m)$，以及在订货到达时使这 $m$ 种商品各自存贮量补充到的固定体积 $Q_i\\,(i=1,2,\\ldots,m)$，才能使总损失费用达到最低？\n\n问题4：如果把问题2中的三种商品按问题3的方法同时订货，其中 $v_1 = 0.05\\,\\text{立方米}$，$v_2 = 0.04\\,\\text{立方米}$，$v_3 = 0.10\\,\\text{立方米}$，自己的仓库用于存贮这3种商品的总体积容量 $Q_0 = 6\\,\\text{立方米}$，每次到货后这3种商品的存贮量总体积补充到固定体积容量 $Q = 10\\,\\text{立方米}$ 为止，且该供应站从接到订货通知到货物送达商场的天数 $X$ 服从在 $1$ 天到 $3$ 天之间的均匀分布。其余数据同问题2中相应的商品中所列出的数据。试按问题3的模型求出这3种商品的最优订货点 $L^*$ 和自己的仓库用于存贮这3种商品的各自体积容量 $Q_{0i} \\,(i=1,2,3)$，以及在订货到达时使这3种商品各自存贮量补充到的固定体积 $Q_i\\,(i=1,2,3)$。\n\n问题5商品的销售经常是随机的、订货情况在一段时间后是会发生变化的，相应地商家就应该调整订货和存贮策略。你们能否对此建立数学模型加以讨论。",
  "subtask": {
    "1": {
      "subtask": "子任务1（单品基线模型建立与解析）：本子任务的目标是建立一个关于单一商品、在“到货补至固定上限 Q、当库存降至订货点 L 发单、提前期 X 为随机变量且自有仓容量 Q0 < Q”的周期性库存模型，并把库存轨迹、各类成本（订货费、在自有仓与租赁仓的持有费、以及缺货损失）用精确的数学表达式刻画出来，给出用于数值计算与求最优订货点 L* 的完整方法与步骤；为此需首先明确定义参数与变量：销售速率 r（单位/天）、固定订货费 c1（元/次）、自有仓单位持有费 c2（元/单位·天）、租赁仓单位持有费 c3（元/单位·天，c2 ≤ c3）、缺货代价 c4（注意先明确其单位：要么为“每丢失一单位的一次性损失（元/单位）”，要么为“每短缺单位每一天的损失（元/单位·天）”），自有仓容量 Q0、到货后补至上限 Q（且 Q0 < Q），订货点 L（决策变量，0 ≤ L ≤ Q 或根据需要取整），随机提前期 X（以分布 F_X 或历史样本 {X_j} 给出）；然后描述库存随时间的确定性轨迹：到货时记为 t=0，q(t)=Q − r t 在 0 ≤ t ≤ t1，t1=(Q − L)/r 为下单时刻，下单后在 t ∈ (t1, t1+X] 库存为 q(t)=L − r (t − t1)，周期长度 T = t1 + X；据此精确写出周期内各成本的积分表达式：订货成本每周期为 c1；自有仓持有费期望 E[H_own] = c2 · E[ ∫_0^{T} min( max(q(t),0), Q0 ) dt ]；租赁仓持有费期望 E[H_rent] = c3 · E[ ∫_0^{T} max(0, q(t) − Q0) dt ]（这两项在 q(t) 为线性函数时可化为分段二次多项式并对 X 求期望）；缺货成本按两种情形分别给出：若 c4 为一次性失销代价，则 E[S] = c4 · E[ max(0, r X − L) ]；若 c4 为按天计费用，则 E[S] = c4 · E[ ∫_0^{T} max(0, −q(t)) dt ]。长期平均成本率的目标函数为 C(L) = [ c1 + E[H_own] + E[H_rent] + E[S] ] / E[T]，其中 E[T] = (Q − L)/r + E[X]；为求 L* 给出可操作的计算与优化流程：若 F_X 可解析则对上述期望做解析或数值积分以得到 C(L) 的闭式或数值函数，并（当 c4 表示一次性失销代价时）利用一阶条件导出 dE[H]/dL = c4 · P(r X > L) 的边际平衡式作为解析判据；若 F_X 通过历史样本 {X_j}_{j=1}^N 给出，则用样本平均替代期望：对每个候选 L 计算每个样本下的 t1、T_j 与相应积分（显式计算分段面积），对样本取均值得到估计的 C(L)，在 L 的连续或离散网格上做一维搜索（穷举、黄金分割或数值优化）找最小点并对结果四舍五入到整数单位；数值实现建议包括并行化样本评估、对积分用解析分段公式避免数值误差、在不可导或复杂情形采用网格搜索以保证全局最优性，以及在求解后检查单位一致性（确认 c4 单位与短缺积分的一致）与可行域（0 ≤ L ≤ Q 或根据 r·max(X) 设上界）；该子任务的输入数据为 r, c1, c2, c3, c4, Q0, Q 以及 X 的分布或样本，所需工具为基本的数值积分/期望估计、简单的一维优化例程（或直接网格搜索）和可选的并行计算手段；输出为可用于实施的明确数学表达式、计算程序与最优订货点 L* 的求解程序（含对 c4 单位歧义的分支处理说明）。",
      "criteria": {
        "task_understanding": {
          "core_goal": "建立并优化单品周期性库存模型以求最优订货点 L*（优化长期平均成本 C(L)），明确库存轨迹、各类成本的数学表达并给出数值求解流程",
          "expected_output": "数学模型表达式（q(t)、E[H_own]、E[H_rent]、E[S]、C(L)、E[T]）、若干情形的解析导出式、数值求解步骤/伪代码、可运行的计算程序或脚本、最终最优订货点 L* 及可选置信区间/敏感性图表",
          "key_inputs_constraints": "1) 输入参数：r（常数，单位/天）、c1、c2、c3、c4；2) 库容参数：Q0（自有仓容量，Q0<Q）、Q（补至上限）、决策变量 L（0≤L≤Q）；3) 提前期：X 的分布 F_X 或样本 {X_j}；其它约束：c2≤c3，若样本给出需具备足够 N；（若 c4 单位不明需声明是一次性失销或按天计）",
          "modeling_type": "优化（含概率期望/仿真评估）",
          "role_in_pipeline": "作为核心建模与参数化子任务：在数据清洗后、并行于库存策略比较之前执行，依赖已清洗的 r, c1,c2,c3,c4,Q0,Q 及 X 的分布/样本；输出 L* 与模型函数供后序数值优化、仿真验证与成本敏感性分析使用"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "识别关键参数 r,c1,c2,c3,c4,Q0,Q,L,X",
              "description": "精确列出并解释 r,c1,c2,c3,c4,Q0,Q,L 和提前期 X 的含义、单位与相互关系（例如 c2≤c3、Q0<Q）。",
              "score": 25,
              "evaluation_focus": "参数识别",
              "scoring_hint": "高分：所有参数逐一列出、单位正确且注明 c2≤c3 与 Q0<Q；中分：遗漏次要参数或单位有一处不一致；低分：缺失任一核心参数或单位混淆（如把 c4 单位未说明）。"
            },
            {
              "sub_criteria": "识别 c4 单位歧义并给出处理方案",
              "description": "明确说明 c4 是一次性失销损失还是按天计短缺损失，并给出两种情形的不同数学表达与求解流程。",
              "score": 25,
              "evaluation_focus": "假设处理",
              "scoring_hint": "高分：明确两类 c4 并分别给出 E[S] 公式与计算流程；中分：识别歧义但仅处理一种情形；低分：未识别或误用 c4 单位导致公式不一致。"
            },
            {
              "sub_criteria": "识别提前期 X 的不确定性及数据形式（分布/样本）",
              "description": "说明 X 为随机变量，标明接受解析分布或历史样本 {X_j} 两种输入形式及各自的处理要求（样本量、独立性等）。",
              "score": 25,
              "evaluation_focus": "随机性理解",
              "scoring_hint": "高分：准确指出 F_X 可解析时与样本时的不同计算路径并给出样本量建议；中分：仅泛述为随机或样本；低分：把 X 误当常数或未说明数据要求。"
            },
            {
              "sub_criteria": "识别目标函数与决策变量 L 的约束",
              "description": "明确长期平均成本率 C(L) 为最小化目标、决策变量为 L（0≤L≤Q，可整化），并说明 E[T] 的计算式。",
              "score": 25,
              "evaluation_focus": "目标识别",
              "scoring_hint": "高分：给出 C(L) 的构成并说明 L 的可行域与整数化处理；中分：目标与 L 明确但缺整数化或边界说明；低分：目标函数或 L 的约束未明确。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "复述库存轨迹 q(t) 与下单时刻 t1=(Q−L)/r",
              "description": "用文字与公式复述：到货记 t=0，q(t)=Q−rt（0≤t≤t1），下单后 q(t)=L−r(t−t1) 在 t∈(t1,t1+X]，并说明周期长度 T=t1+X。",
              "score": 30,
              "evaluation_focus": "轨迹表达",
              "scoring_hint": "高分：轨迹公式完整且包含 t1 和 T 定义；中分：轨迹正确但漏写周期端点或符号说明；低分：轨迹错误或与题意不符。"
            },
            {
              "sub_criteria": "复述自有仓与租赁仓持有费的积分式",
              "description": "给出 E[H_own]=c2·E[∫_0^T min(max(q(t),0),Q0) dt ] 和 E[H_rent]=c3·E[∫_0^T max(0,q(t)−Q0) dt ] 的含义与求期望的解释。",
              "score": 35,
              "evaluation_focus": "成本表达",
              "scoring_hint": "高分：两积分式书写正确并解释分段含义；中分：公式有小的符号或下标错误但语义正确；低分：遗漏租赁/自有任一项或积分表达错误。"
            },
            {
              "sub_criteria": "复述缺货成本两种情形的表达 E[S]",
              "description": "当 c4 为一次性失销给出 E[S]=c4·E[max(0,rX−L)]；当 c4 为按天计给出 E[S]=c4·E[∫_0^T max(0,−q(t)) dt]，并注明单位一致性要求。",
              "score": 35,
              "evaluation_focus": "缺货表达",
              "scoring_hint": "高分：两种情形均准确且说明单位一致性；中分：写出一种情形正确；低分：式子错误或未区分两种情形。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "假设销售速率 r 恒定且独立于 X",
              "description": "明确假设 r 为常数（单位/天）且需求在周期内确定，提前期 X 与销售独立，说明适用性与局限性。",
              "score": 25,
              "evaluation_focus": "建模假设",
              "scoring_hint": "高分：明确并讨论适用场景与局限并给出替代方案；中分：仅陈述假设无讨论；低分：未说明或与模型表达冲突。"
            },
            {
              "sub_criteria": "假设到货瞬时补至 Q 且补货量为连续变量",
              "description": "说明到货瞬间库存补至 Q，允许连续单位 q(t)；若实际需整数盒/袋注明离散化处理方式。",
              "score": 25,
              "evaluation_focus": "补货假设",
              "scoring_hint": "高分：陈述并给出整数化处理建议；中分：仅陈述补至 Q；低分：未说明或与离散现实冲突。"
            },
            {
              "sub_criteria": "对提前期 X 的独立同分布与样本代表性假设",
              "description": "说明若以样本 {X_j} 代替需假定历史样本独立同分布及样本量充足，并提出 bootstrap 或稳健处理建议。",
              "score": 25,
              "evaluation_focus": "样本假设",
              "scoring_hint": "高分：明确样本假设并给出检验/修正方法（自相关检验、bootstrap）；中分：指出样本代表性问题但无修正建议；低分：忽略样本代表性。"
            },
            {
              "sub_criteria": "假设成本线性且单位一致",
              "description": "假设持有费与缺货损失为单位线性函数（c2,c3,c4），并要求在推导前统一单位以避免混淆。",
              "score": 25,
              "evaluation_focus": "单位一致",
              "scoring_hint": "高分：明确单位校验流程并在示例中演示；中分：提及需统一单位但无实现方案；低分：未提单位一致性。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "构建 q(t) 的分段线性表达并标注 t1,T",
              "description": "给出分段函数 q(t)=Q−rt（0≤t≤t1）；q(t)=L−r(t−t1)（t1<t≤t1+X），并说明当 q<0 的解释为缺货量。",
              "score": 25,
              "evaluation_focus": "轨迹建模",
              "scoring_hint": "高分：分段函数完整且缺货段处理清晰；中分：分段正确但缺货解释不明确；低分：分段或符号错误。"
            },
            {
              "sub_criteria": "写出自有仓与租赁仓成本的分段解析式（可对 X 做期望）",
              "description": "在 q(t) 为线性时化简积分为分段二次多项式并给出对 X 的期望表达或计算策略（解析积分或数值积分）。",
              "score": 25,
              "evaluation_focus": "成本推导",
              "scoring_hint": "高分：正确导出分段二次多项式并给出求期望的解析或数值方法；中分：给出积分式但未化简；低分：积分表达错误或不可实现。"
            },
            {
              "sub_criteria": "明确长期平均成本函数 C(L) 与 E[T] 表达",
              "description": "给出 C(L)=[c1+E[H_own]+E[H_rent]+E[S]]/E[T] 且 E[T]=(Q−L)/r+E[X]，并讨论分母为零或边界情况处理。",
              "score": 25,
              "evaluation_focus": "目标函数",
              "scoring_hint": "高分：公式完整并讨论边界/异常情况；中分：公式正确但未讨论边界；低分：公式不完整或错误。"
            },
            {
              "sub_criteria": "导出边际平衡式及给出其适用条件（当 c4 为一次性失销时）",
              "description": "在 c4 为一次性失销的情形，推导出边际条件 dE[H]/dL = c4·P(rX>L) 或等效平衡式，并注明适用的可微条件。",
              "score": 25,
              "evaluation_focus": "解析推导",
              "scoring_hint": "High: 正确推导并注明假设（可微、F_X 可导或使用次导数）；中: 推导有小错但思路正确；低: 推导错误或缺乏条件说明。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "解析情形的期望计算与一阶条件求解 L*",
              "description": "若 F_X 可解析，给出对 X 的期望积分步骤、可得的闭式或半闭式解并列出求解一阶条件的实现方法。",
              "score": 25,
              "evaluation_focus": "解析解法",
              "scoring_hint": "高分：正确给出解析积分并根据一阶条件求解 L*；中分：积分表达正确但未得出或只说明数值解；低分：解析步骤错误或遗漏。"
            },
            {
              "sub_criteria": "样本平均替代期望的数值求解流程（{X_j}）",
              "description": "说明用样本平均估计期望的具体步骤：对每候选 L 用所有样本计算周期内积分、取均值得 Ĉ(L)，并在 L 网格上搜索最小值。",
              "score": 25,
              "evaluation_focus": "样本估计",
              "scoring_hint": "高分：给出明确伪代码/流程并处理样本并行化与数值稳定；中分：流程描述但无伪代码；低分：样本替代方法模糊或有逻辑错误。"
            },
            {
              "sub_criteria": "数值优化与全局性保证（网格/黄金分割/穷举）",
              "description": "建议使用一维全局网格搜索或合理加速的数值方法（黄金分割/二分/局部优化），并说明如何保证全局最优或检验多起始点。",
              "score": 25,
              "evaluation_focus": "优化方法",
              "scoring_hint": "高分：提供具体算法选择并说明收敛与全局检验；中分：推荐方法但无保证策略；低分：无优化策略或使用不适方法。"
            },
            {
              "sub_criteria": "数值稳定性与单元/可行域检查",
              "description": "给出检查单位一致性、L 可行域（0≤L≤Q 或依据 r·max(X) 设上界）及对异常 X 样本的稳健处理（截尾/修正）。",
              "score": 25,
              "evaluation_focus": "数值检验",
              "scoring_hint": "高分：包含具体检查与异常处理并演示；中分：提到检查但无实现细节；低分：忽略一致性或可行域检查。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "实现 C(L) 评估函数（支持解析 F_X 与样本 {X_j}）",
              "description": "提供可运行函数/模块，输入 r,c1,c2,c3,c4,Q0,Q,L 与 F_X 或 {X_j}，输出 C(L) 并支持两种 c4 情形的分支处理。",
              "score": 25,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：函数可运行、文档齐全、涵盖 F_X 与样本分支并含单元测试；中分：函数可运行但仅覆盖部分情形或缺少测试；低分：代码无法运行或未实现分支。"
            },
            {
              "sub_criteria": "数值积分/分段公式的精确实现与向量化",
              "description": "在样本情形使用解析分段面积避免数值误差，并实现向量化/并行化以加速对大量样本的评估。",
              "score": 25,
              "evaluation_focus": "数值实现",
              "scoring_hint": "高分：使用解析分段公式、向量化并提供性能数据；中分：使用数值积分或循环但可运行；低分：数值不稳定或效率极低。"
            },
            {
              "sub_criteria": "优化搜索与结果复现性（网格、随机初值、并行）",
              "description": "实现 L 的网格搜索或优化接口，保证可复现（固定随机种子）、并提供并行计算选项以处理大样本。",
              "score": 25,
              "evaluation_focus": "可复现性",
              "scoring_hint": "高分：提供脚本、说明、固定种子并行实现且运行时间合理；中分：复现性部分保证；低分：结果难以复现或无说明。"
            },
            {
              "sub_criteria": "输入校验、异常处理与文档注释",
              "description": "实现单位校验、参数边界检查（如 c2≤c3、Q0<Q、0≤L≤Q）和清晰注释与使用说明。",
              "score": 25,
              "evaluation_focus": "代码质量",
              "scoring_hint": "高分：详尽校验与文档；中分：有基本校验但文档不足；低分：无校验或注释。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "报告最终最优订货点 L* 与 E[T]、分项成本构成",
              "description": "给出 L* 数值、对应 E[T]、周期内各项期望成本（c1、H_own、H_rent、S）明细表并验证单位一致性。",
              "score": 25,
              "evaluation_focus": "结果报告",
              "scoring_hint": "高分：给出完整数值表并通过单元检验；中分：提供主要数值但缺少分项细化；低分：仅给 L* 无成本明细。"
            },
            {
              "sub_criteria": "敏感性分析（对 r,c4,Q0,Q 的影响）",
              "description": "对关键参数（至少 r 与 c4）做局部敏感性分析，画出 C(L) 随 L 变化曲线并指出 L* 的稳健性区间或变化趋势。",
              "score": 25,
              "evaluation_focus": "敏感性",
              "scoring_hint": "高分：至少两参数敏感性图并定量描述 L* 变化；中分：做单参数扫描但分析浅显；低分：无敏感性分析或仅文字推测。"
            },
            {
              "sub_criteria": "不确定性与置信区间（样本/bootstrap）",
              "description": "若使用样本 {X_j}，提供 L* 的不确定性估计（如 bootstrap 得到的分布或置信区间）并报告样本大小影响。",
              "score": 25,
              "evaluation_focus": "不确定性",
              "scoring_hint": "高分：提供 bootstrap 置信区间并说明样本影响；中分：给出经验性波动但无正式置信区间；低分：忽略不确定性。"
            },
            {
              "sub_criteria": "可视化与合理性检验（库存轨迹、成本曲线、边际平衡）",
              "description": "提供 q(t) 样例轨迹图、C(L) 曲线、并检验解析边际平衡式（如 c4·P(rX>L)）是否近似成立以验证模型一致性。",
              "score": 25,
              "evaluation_focus": "可视化",
              "scoring_hint": "高分：图形清晰且用图验证理论；中分：有图但解释不足；低分：无图或图与结论不符。"
            }
          ]
        }
      }
    },
    "2": {
      "subtask": "子任务2（多品共用有限自有仓的耦合分配与最优订货点建模）：给定 m 种商品的参数（对每种 i 提供恒定销售速率 r_i（件/天）、单件体积 v_i、单位体积自有仓持有费 c_{2i}（元/立方米·天）、租赁仓持有费 c_{3i}（元/立方米·天）、单位短缺代价 c_{4i}（可按件一次性或按件·天计）、以及可观测或样本化的提前期随机变量 X 的分布或样本），并给定统一下单时到货后总体补货体积上限 Q 和自有仓总体积容量 Q0（∑ Q_i = Q，∑ Q_{0i} = Q0，且 Q0 < Q），本子任务的目标是以长期平均成本率最小化为准则，构造并求解一个数学优化模型来确定（1）总体或分品种的最优订货触发量（可以选择决策变量为总体体积订货点 L 或分配到各品种的体积阈值 L_i，满足 L = ∑_i L_i），（2）每次到货时各品种的补货目标体积 Q_i（决策变量，Q_i ≥ 0，∑_i Q_i = Q），以及（3）自有仓在各品种之间的体积分配 Q_{0i}（决策变量，Q_{0i} ≥ 0，∑_i Q_{0i} = Q0），使得長期平均成本 C_total = [ c1 + ∑_{i=1}^m (E[H_i(Q_i,Q_{0i},L_i)] + E[S_i(Q_i,Q_{0i},L_i)]) ] / E[T(Q,L)] 最小，其中 c1 为每次订货固定费用，E[H_i] 与 E[S_i] 分别是按给定库存轨迹（每次到货补至 Q_i、库存按速率 r_i v_i 递减、当总体或分品种体积降至相应阈值触发下单、提前期为 X）计算的品种 i 在自有仓与租赁仓两类持有成本和短缺成本的期望（可按体积尺度把 q_i(t) 分段积分得到封闭式或数值表达），E[T] = (∑_i Q_i − L)/(∑_i r_i v_i) + E[X] 为周期期望长度；模型应包含变量界限（Q_{0i},Q_i,L_i ≥ 0）和线性耦合约束（和等式）以及必要的整数/离散化约束（若体积或件数必须取整）。为求解该非线性耦合问题，要求采取下列明确方法步骤：① 用历史提前期样本或估计分布对期望项进行样本平均或蒙特卡洛估计（對每候选向量并行计算每次样本下的周期成本並取均值，必要时用方差缩减）；② 构造目标函数与约束的数值实现，若能得到解析导数则使用自动微分工具或推导出显式偏导表达式，否则用有控制步长的有限差分估计梯度；③ 优化策略上优先采用约束非线性规划求解器（如 SQP、IPOPT、SNOPT）求解连续松弛问题，求解时以拉格朗日乘子或增广拉格朗日处理线性约束；若维度较高或目标不光滑，备用无梯度全局/局部启发式算法（粒子群、模拟退火、SPSA 或坐标/交替下降）并配合多起点初值；④ 设计合理的初始化策略以加速收敛（例如按体积需求率 r_i v_i 或按单位体积边际持有差 c_{3i}−c_{2i} 分配 Q_i、按收益/风险比率分配 Q_{0i}、并用各品种单独最优 L_i 作初值）；⑤ 在数值实现中采用投影或修正步骤保证每次迭代满足 ∑Q_i=Q 和 ∑Q_{0i}=Q0，必要时在求得连续解后进行整数化/四舍五入并做局部再优化以恢复可行性；⑥ 为提高计算效率和鲁棒性，建议并行化样本评估、对高维问题构建代理响应面(如高斯过程或多项式近似)以减少昂贵的目标评估次数，并在求解后进行样本外验证与敏感性分析（检查 c_{4i}, c_{3i}, Q0 与提前期尾部对解的影响）。输出应为一组可执行的决策值 {Q_i^*, Q_{0i}^*, L_i^* (或 L^*)}，并附带目标函数值、约束满足情况及对关键参数的灵敏度指标；实现工具可选用 Python/R + 数值优化库（IPOPT/CasADi、NLopt、scipy.optimize）及并行/蒙特卡洛模块。",
      "criteria": {
        "task_understanding": {
          "core_goal": "题目要考什么——按题型拆解关键能力：优化多品在有限自有仓条件下的库存策略，构建并求解以长期平均成本最小化为目标的优化模型（优化 Q_i、Q_{0i} 与 L_i 或总体 L，并处理随机提前期与样本估计）。",
          "expected_output": "数学模型（目标函数与约束的解析表达）、期望成本的样本/蒙特卡洛估计公式、数值求解流程与算法选择（如 SQP/IPOPT 或启发式备选）、可执行代码模块、最优解集合 {Q_i^*,Q_{0i}^*,L_i^*或L^*}、最优目标值、约束可行性报告与敏感性/验证图表与说明文档。",
          "key_inputs_constraints": "必须输入：(1) 每种商品参数 {r_i (件/天), v_i (体积/件), c_{2i}, c_{3i}, c_{4i}（单位需明示）}；(2) 供应提前期 X 的分布或样本 {X_j} 或蒙特卡洛采样器；(3) 全局参数 c1、总体补货体积 Q、总体自有仓容量 Q0（并约束 ∑Q_i=Q, ∑Q_{0i}=Q0, Q0<Q）；必要前置条件：体积/件换算一致、短缺代价单位已确定、参数有量纲一致性。",
          "modeling_type": "优化+仿真（样本/蒙特卡洛估计）",
          "role_in_pipeline": "本子任务为决策层建模阶段：依赖前序的数据清洗/参数估计（X 样本、r_i、v_i、成本参数）和单品基线模型的推导，输出被后序实现（代码部署）与样本外仿真/策略调整模块使用；直接依赖：到货提前期样本、单品库存轨迹表达；后续为：实施仿真验证与敏感性分析。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "识别长期平均成本最小化目标（长期平均成本）",
              "description": "明确将优化目标定义为长期平均成本率 C_total = [c1 + ∑(E[H_i]+E[S_i])]/E[T] 并说明 E[T] 的表达。",
              "score": 40,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：明确写出长期平均成本公式并解释分母 E[T]；中分：指出最小化长期成本但公式不完整；低分：未明确长期平均或混淆周期与期望。"
            },
            {
              "sub_criteria": "识别决策变量 Q_i, Q_{0i}, L_i 或总体 L",
              "description": "明确列出需要优化的变量集合（可选择总体 L 或分品种 L_i）并说明变量的物理含义与域约束。",
              "score": 30,
              "evaluation_focus": "问题拆解",
              "scoring_hint": "高分：列出 Q_i,Q_{0i},L_i 或 L 并给出 ∑Q_i=Q, ∑Q_{0i}=Q0 等约束；中分：列出部分变量或约束；低分：遗漏主要决策变量或违反总量约束。"
            },
            {
              "sub_criteria": "识别随机性与数据依赖（提前期 X 与样本处理）",
              "description": "明确提前期 X 为随机变量，需用样本平均或蒙特卡洛估计期望并讨论方差缩减或样本量需求。",
              "score": 20,
              "evaluation_focus": "随机建模",
              "scoring_hint": "高分：说明用样本平均/蒙特卡洛并提出方差缩减或并行化；中分：提到随机性但无估计策略；低分：忽略提前期随机性或误用确定性替代。"
            },
            {
              "sub_criteria": "识别约束与可行域（Q0<Q、非负、整化）",
              "description": "识别并列出必要的线性耦合约束与变量界限，包括体积守恒、非负及可选的整数化约束。",
              "score": 10,
              "evaluation_focus": "约束识别",
              "scoring_hint": "高分：完整列出 ∑Q_i=Q, ∑Q_{0i}=Q0, Q0<Q, Q_i,Q_{0i},L_i≥0 及整化说明；中分：列出部分约束；低分：缺失耦合或容量约束。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "复述库存策略（到货补至 Q，触发规则）",
              "description": "精确重述“每次到货补至 Q、当总体或分品种体积降至 L 或 L_i 时发单”的 order‑up‑to 策略细节。",
              "score": 40,
              "evaluation_focus": "模型准确性",
              "scoring_hint": "高分：文字与数学并行，明确 t1=(∑Q_i−L)/∑(r_i v_i) 或分品种对应公式；中分：文字正确但数学表达缺失；低分：描述模糊或与题意不符。"
            },
            {
              "sub_criteria": "复述成本项分解（订货/自有/租赁/缺货）",
              "description": "明确列出并解释 c1、E[H_i]（含 c_{2i},Q_{0i} 分段）、E[租赁]（含 c_{3i}）与 E[S_i] 两种短缺计价情形。",
              "score": 35,
              "evaluation_focus": "成本识别",
              "scoring_hint": "高分：对每项写出积分或期望表达并区分 c4 单位分支；中分：列出成本项但表达不精确；低分：遗漏持有或缺货项。"
            },
            {
              "sub_criteria": "复述期望计算方法（样本平均/蒙特卡洛）",
              "description": "阐明对期望项使用历史样本平均或蒙特卡洛，并说明对每个样本如何计算周期成本。",
              "score": 25,
              "evaluation_focus": "数值流程",
              "scoring_hint": "高分：给出样本替代公式并说明并行化与方差缩减；中分：说明采样但无细节；低分：未说明样本估计方法。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "明确提前期与销售速率假设（X 分布与 r_i 恒定）",
              "description": "陈述关于 X 的独立性/同分布假设与 r_i 恒定、需求不可回溯等，并说明违反时的后果或替代处理。",
              "score": 30,
              "evaluation_focus": "假设合理性",
              "scoring_hint": "高分：列明独立同分布假设、可替代的非平稳处理方案；中分：仅写出假设但不讨论影响；低分：未写或矛盾性假设。"
            },
            {
              "sub_criteria": "短缺代价单位与处理分支假设（c_{4i}）",
              "description": "明确 c_{4i} 是“按件一次性”还是“按件·天”并在模型中对应两种短缺表达，或说明如何在代码中自动识别分支。",
              "score": 25,
              "evaluation_focus": "单位一致性",
              "scoring_hint": "高分：清楚给出两分支的数学表达并在实现中可切换；中分：指出单位歧义但未实现分支；低分：忽略 c4 单位问题。"
            },
            {
              "sub_criteria": "仓储可分配性与体积换算假设",
              "description": "说明体积可连续分配或需件数整化，及 v_i 与 Q,Q0 的量纲一致性；若取整化给出整化规则。",
              "score": 25,
              "evaluation_focus": "实现前提",
              "scoring_hint": "高分：明确连续/离散假设并给整化策略；中分：说明但不具体；低分：忽略体积与件数换算问题。"
            },
            {
              "sub_criteria": "其他简化（成本线性、无提前补货）",
              "description": "列出并解释为可解性作出的合理简化（如持有费按体积线性、无部分到货、一次供货到达），并评估其影响。",
              "score": 20,
              "evaluation_focus": "简化说明",
              "scoring_hint": "高分：列出并评估每条简化对结果的偏差；中分：列出但无影响评估；低分：未列或不一致。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "目标函数形式化（长期平均成本 C_total）",
              "description": "给出 C_total 的数学表达并将 E[H_i],E[S_i] 与 E[T] 用 q_i(t) 的积分形式表示，明确体积尺度转换。",
              "score": 30,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：提供完整可计算的解析表达式；中分：表达基本正确但缺少某些期望项；低分：目标函数模糊或错误。"
            },
            {
              "sub_criteria": "品种持有成本与短缺成本的分段积分表达",
              "description": "对每个品种写出 H_i = c_{2i}·E[∫min(q_i,Q_{0i})dt] + c_{3i}·E[∫max(q_i−Q_{0i},0)dt] 及 S_i 对应分支的明确公式。",
              "score": 30,
              "evaluation_focus": "解析表达",
              "scoring_hint": "高分：对线性 q_i(t) 给出分段二次解析并对 X 求期望表达；中分：给出积分形式但未解析；低分：积分表达错误或缺失。"
            },
            {
              "sub_criteria": "耦合约束与变量域建模（∑Q_i=Q 等）",
              "description": "用数学约束形式写出 ∑Q_i=Q, ∑Q_{0i}=Q0, Q_{0i}≤Q_i（若适用）及非负/整化约束，并指出可放松做连续松弛。",
              "score": 20,
              "evaluation_focus": "约束建模",
              "scoring_hint": "高分：约束完整且解释可松弛策略；中分：约束基本正确但漏项；低分：约束不完整或逻辑冲突。"
            },
            {
              "sub_criteria": "样本估计与方差缩减策略建模（样本平均/蒙特卡洛）",
              "description": "给出用样本平均估计期望的数学式，说明是否用方差缩减（控制变量、重要性采样）或并行化以提高效率。",
              "score": 20,
              "evaluation_focus": "数值仿真",
              "scoring_hint": "高分：提供样本估计公式并建议具体方差缩减方法；中分：只用样本平均；低分：忽略样本方法或可重复性。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "数值求解方法选择（SQP/IPOPT/启发式）",
              "description": "明确首选连续非线性规划求解器（如 SQP/IPOPT），并在不可导或多峰时提供备用启发式（粒子群、SPSA）。",
              "score": 40,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：合理匹配问题性质并说明理由；中分：选择合理工具但无备选策略；低分：选择不匹配或无说明。"
            },
            {
              "sub_criteria": "梯度与导数处理（自动微分或有限差分）",
              "description": "说明是否使用自动微分/显式导数或受控有限差分估计梯度，及数值步长与稳定性对策。",
              "score": 20,
              "evaluation_focus": "导数处理",
              "scoring_hint": "高分：提供自动微分或有界差分方案；中分：仅提有限差分；低分：无导数处理或忽略数值稳定性。"
            },
            {
              "sub_criteria": "初始化、多起点及代理模型（响应面）",
              "description": "给出初始化策略（如按 r_i v_i 或边际持有差分配 Q_i）、多起点搜索与构建代理以减少昂贵评估的计划。",
              "score": 20,
              "evaluation_focus": "求解工程",
              "scoring_hint": "高分：明确初始化公式并设计代理/多起点方案；中分：给出经验性初始化；低分：无初始化或单起点易陷局部。"
            },
            {
              "sub_criteria": "可行性修正、整数化与样本外验证",
              "description": "描述投影保证线性约束、整数化后局部再优化，以及用保留样本或独立仿真验证解的步骤。",
              "score": 20,
              "evaluation_focus": "解的可靠性",
              "scoring_hint": "高分：实现投影/修正并给出样本外验证结果；中分：只做投影或只做简单验证；低分：无修正或验证。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "样本化成本评估的正确实现与并行化（样本平均/蒙特卡洛）",
              "description": "代码应能依历史样本并行计算每候选向量下的周期成本并返回 E[H_i],E[S_i],E[T] 的样本均值，避免逐点 Python 循环低效实现。",
              "score": 30,
              "evaluation_focus": "代码效率",
              "scoring_hint": "高分：向量化/并行实现、使用解析分段积分；中分：部分向量化或并行；低分：逐样本逐L循环、运行极慢。"
            },
            {
              "sub_criteria": "优化调用与约束处理（IPOPT/CasADi 或备选）",
              "description": "实现约束非线性优化接口（含雅可比/约束投影），并提供启发式备选实现与参数可配置性。",
              "score": 25,
              "evaluation_focus": "实现可靠性",
              "scoring_hint": "高分：集成 IPOPT/CasADi 或 SciPy 且约束正确；中分：使用 SciPy 简单实现但缺雅可比；低分：不处理约束或调用错误。"
            },
            {
              "sub_criteria": "数值稳定性、解析积分与单元测试",
              "description": "优先用解析分段面积替代数值积分并提供单元测试覆盖关键函数（成本计算、约束投影、样本估计）。",
              "score": 25,
              "evaluation_focus": "数值可靠性",
              "scoring_hint": "高分：解析公式实现并有单元测试；中分：数值积分并带基本测试；低分：无测试且易受数值误差影响。"
            },
            {
              "sub_criteria": "可复现性文档与输入/输出接口",
              "description": "提供 README、示例输入文件与输出格式说明，模块化代码便于替换分布或并行策略。",
              "score": 20,
              "evaluation_focus": "工程化",
              "scoring_hint": "高分：有完整示例与说明、可复现结果；中分：有基本说明但缺示例；低分：无文档或难以运行。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "呈现最优解集合与目标值（{Q_i^*,Q_{0i}^*,L_i^*}）",
              "description": "报告最优解、目标函数值与是否满足 ∑Q_i=Q, ∑Q_{0i}=Q0，并给出收敛/迭代信息。",
              "score": 30,
              "evaluation_focus": "结果呈现",
              "scoring_hint": "高分：给出完整解、目标值与收敛诊断；中分：给出解但无收敛细节；低分：只给部分解或不报告目标值。"
            },
            {
              "sub_criteria": "成本分项贡献分析（自有/租赁/缺货/订货）",
              "description": "按品种和总体分解持有（自有/租赁）、缺货与订货成本占比，并可视化展示，便于决策解释。",
              "score": 30,
              "evaluation_focus": "解释力",
              "scoring_hint": "高分：清晰表格/图示分项占比并讨论原因；中分：给出数值但无图示；低分：未分项或解释不足。"
            },
            {
              "sub_criteria": "不确定性度量（置信区间/Bootstrap）与样本外验证",
              "description": "通过自助法或保留样本提供 L_i^*/Q_i^* 的置信区间，并用独立仿真估计长期成本稳健性。",
              "score": 20,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：提供置信区间与样本外仿真结果；中分：只做其中一项；低分：无不确定性评估。"
            },
            {
              "sub_criteria": "敏感性分析与实施建议（对 c_{4i},c_{3i},Q0 等）",
              "description": "系统改变关键参数并绘制 L^*/成本响应曲线，基于结果给出实施层面建议与模型局限性讨论。",
              "score": 20,
              "evaluation_focus": "决策支撑",
              "scoring_hint": "高分：提供多参数敏感图并给出明确策略建议；中分：做单参数敏感性或定性讨论；低分：无敏感性分析或建议不具体。"
            }
          ]
        }
      }
    },
    "3": {
      "subtask": "子任务3（具体数值实现、样本估计与求解步骤、验证与敏感性分析）的目标是给出一套可直接运行、基于历史到货时间样本或蒙特卡洛模拟的逐步算法流程，用以在单品 order‑up‑to 策略下精确估计并优化订货点 L 的长期平均成本率并输出可实施的 L* 与诊断指标；其作用范围仅限于：以已知参数 r, c1, c2, c3, c4, Q0, Q 和到货提前期样本 {X_j}_{j=1..N}（或可由分布采样得到的一组模拟样本）为输入，按样本平均方法计算各候选 L 对应的周期内持有成本、缺货成本与周期时长的样本均值，进而求出平均成本率 C(L) 并确定最小点。具体实施步骤与技术要求如下：1) 数据准备：核验并标准化单位（确认 c4 是“每短缺单位一次性损失（元/件）”还是“每短缺单位每天损失（元/件·天）”），读入 X 样本、速率 r 与容量参数 Q,Q0；2) 离散化决策空间：在可行区间（例如整数 0..Q 或更精细的实数网格）建立候选 L 列表，若需高精度可先粗网格扫寻再在最优邻域细化；3) 单样本成本计算（向量化/并行实现）：对每一候选 L 和每一样本 X_j 计算 t1=(Q−L)/r 与周期时长 T_j=t1+X_j，利用库存轨迹 q(t)=Q−rt (0≤t≤t1) 与 q(t)=L−r(t−t1) (t1<t≤T_j) 的解析分段表达，显式求解自有仓持有成本 H_own_j = c2·∫_0^{T_j} min(max(q(t),0),Q0) dt、租赁仓持有成本 H_rent_j = c3·∫_0^{T_j} max(0,q(t)−Q0) dt；若 c4 为按件一次性损失，则短缺成本 S_j = c4·max(0,r X_j − L)；若 c4 为按天计损失，则 S_j = c4·∫_0^{T_j} max(0,−q(t)) dt；为提高速度尽量用解析二次/线性面积公式代替数值积分并对样本并行计算以降低复杂度 O(N·#L)。4) 估计期望与成本率：对每个 L 取样本均值 E[H]=mean(H_own_j+H_rent_j), E[S]=mean(S_j), E[T]=mean(T_j)，计算 C(L)=[c1+E[H]+E[S]]/E[T]；5) 优化与整化：在候选 L 上找使 C(L) 最小的点 L_hat，若 L 必须为整数件则对最优附近整数值做局部评估并取整数最优 L*；可用黄金分割/二分或局部有导方法对实数情形加速收敛；6) 置信度与稳健性估计：用自助法（bootstrap）或样本子抽样计算 L* 与 C(L*) 的置信区间，报告持有/租赁/短缺三项的贡献比；7) 样本外验证与蒙特卡洛仿真：用保留的历史段或用 F_X 生成的新样本对 L* 做独立仿真以估计长期成本的稳定性与偏差；8) 敏感性分析：系统地改变关键参数（c4、c3、Q0、E[X] 与分布尾部概率）并重算 L*，绘制 L* 与总成本对这些参数的响应曲线以评估决策鲁棒性；9) 工程实现建议与工具：建议用 Python 或 R 实现，核心库为 numpy/pandas（数据处理）、numba 或 multiprocessing（并行/加速）、scipy.optimize（若需连续优化）、matplotlib/seaborn（可视化），并优先采用解析积分公式与向量化计算以保证效率；10) 输出与交付物：返回最优订货点 L*（及其整数形式）、对应的平均成本率 C(L*)、各成本项的分摊、置信区间、样本外验证报告与参数敏感性图表，以及可复现的代码/脚本与示例运行说明。整个子任务只实现上述基于样本的估计、数值优化、验证和敏感性分析步骤，不引入多品种分配或动态在线更新策略的设计。",
      "criteria": {
        "task_understanding": {
          "core_goal": "基于历史到货提前期样本或蒙特卡洛仿真，估计并优化单品 order‑up‑to 策略下的长期平均成本率，求出最优订货点 L*（优化长期平均成本率并输出 L*）",
          "expected_output": "最优订货点 L*（实数与整数形式）、对应长期平均成本率 C(L*)、各成本项（自有仓持有、租赁持有、缺货、订货）分摊、置信区间/不确定性估计、样本外仿真报告、敏感性分析图表、可复现代码与运行说明",
          "key_inputs_constraints": "输入：速率 r（数值/天）、订货费 c1（元/次）、自有仓单位持有费 c2（元/件·天）、租赁仓 c3（元/件·天，c2≤c3）、缺货代价 c4（需先明确为元/件或元/件·天）、自有仓容量 Q0、补至上限 Q（且 Q0<Q）、到货提前期样本 {X_j}（或可采样分布）；约束：0≤L≤Q、Q0<Q、c2≤c3；必要前置条件：单位一致性检验与 c4 单位确认",
          "modeling_type": "优化+仿真（样本估计）",
          "role_in_pipeline": "作为模型求解与验证环节：依赖前序的数据清洗/单位校验与到货样本提取，输出最优订货点 L* 与成本估计供后序的多品种分配或在线调整模块使用"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "明确优化目标：长期平均成本率 C(L)",
              "description": "检查是否精确定义以样本均值估计的长期平均成本率 C(L)=[c1+E[H_own]+E[H_rent]+E[S]]/E[T] 作为优化目标并说明目标依赖的随机量（X）和样本方法",
              "score": 40,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：明确定义 C(L) 并写出分子分母的样本估计公式；中分：仅部分列出成本项或未把 E[T] 放入分母；低分：未给出 C(L) 的样本估计表达或目标模糊。"
            },
            {
              "sub_criteria": "输入数据与单位一致性识别（含 c4 单位）",
              "description": "检查是否核验并标准化单位，明确 c4 是“元/件”还是“元/件·天”，并说明单位不一致时的处理策略",
              "score": 30,
              "evaluation_focus": "数据质量",
              "scoring_hint": "高分：提供清晰单位检验步骤并在数据缺失时给出替代策略；中分：识别单元不一致但未给出完整修正方案；低分：忽略 c4 单位或未做单位检验。"
            },
            {
              "sub_criteria": "约束与可行域识别（Q0,Q,L范围）",
              "description": "检查是否列明 Q0<Q、0≤L≤Q（或基于 r·max(X) 的更紧上界）并识别 c2≤c3 等参数约束",
              "score": 20,
              "evaluation_focus": "约束识别",
              "scoring_hint": "高分：完整列出所有约束并在网格生成时应用；中分：列出部分约束；低分：未列出或逻辑错误（如 Q0≥Q）。"
            },
            {
              "sub_criteria": "随机性与样本方法确认（X_j 与 N）",
              "description": "检查是否识别到货提前期 X 的样本化处理（{X_j}）或需要蒙特卡洛采样，并说明样本数 N 的作用",
              "score": 10,
              "evaluation_focus": "随机建模",
              "scoring_hint": "高分：明确使用样本平均估计并讨论样本量影响；中分：确认样本但未讨论 N；低分：忽略样本或样本使用方式不明。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "复述库存轨迹与 order‑up‑to 策略（Q→L→补至 Q）",
              "description": "应清晰复述到货后库存补至 Q、库存线性下降至 L 时下单、并指出 t1=(Q−L)/r 与周期 T_j=t1+X_j 的关系",
              "score": 40,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：精确写出 q(t) 分段式并给出 t1、T_j 表达；中分：给出 q(t) 但缺少期望关系；低分：轨迹或 t1、T_j 表述错误或缺失。"
            },
            {
              "sub_criteria": "复述各成本项的数学形式（H_own,H_rent,S）",
              "description": "应准确复述自有仓持有积分、租赁持有积分以及两类缺货成本（一次性与按天）的期望形式并指出如何用样本替代期望",
              "score": 40,
              "evaluation_focus": "成本建模",
              "scoring_hint": "高分：列出积分形式并说明样本替代 E[·]=mean(·_j)；中分：列出成本项但积分或期望替代有遗漏；低分：成本表达模糊或错误。"
            },
            {
              "sub_criteria": "复述数值求解流程（候选 L 网格与样本均值评估）",
              "description": "应说明先构造 L 候选集（粗查+精查），对每个 L 在所有 X_j 上计算周期成本并取均值，最后选最小 C(L)",
              "score": 20,
              "evaluation_focus": "流程理解",
              "scoring_hint": "高分：给出网格细化与整化说明并提到并行化；中分：描述基本网格搜索流程；低分：流程不完整或遗漏样本平均步骤。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "就 c4 单位作出明确假设或分支处理",
              "description": "必须在模型里明确两种 c4 解释之一并给出对应 S_j 表达，或同时建两套分支并在实现中选择",
              "score": 30,
              "evaluation_focus": "假设明确",
              "scoring_hint": "高分：明确 c4 单位并实现对应缺货成本公式或提供双分支实现；中分：提出问题但未实现分支；低分：忽略 c4 单位矛盾。"
            },
            {
              "sub_criteria": "假定需求速率 r 恒定且与 X 独立",
              "description": "应显式说明假设销售速率 r 恒定、提前期 X 与销售独立，并讨论该假设的合理性与限制",
              "score": 25,
              "evaluation_focus": "合理性评估",
              "scoring_hint": "高分：明确假设并讨论其在样本/实务中的适用性；中分：仅陈述假设；低分：未说明或与模型矛盾。"
            },
            {
              "sub_criteria": "L 连续或离散处理与四舍五入策略",
              "description": "应说明候选 L 的离散化粒度（整数件或实数网格）、精细化步骤及最终整数化规则",
              "score": 20,
              "evaluation_focus": "离散化策略",
              "scoring_hint": "高分：给出粗网格→细化→整数化流程并验证邻域最优；中分：仅给出整数化规则；低分：无整数化说明或规则不合理。"
            },
            {
              "sub_criteria": "样本代表性与独立同分布假设",
              "description": "应说明对 {X_j} 的代表性假设（如平稳/独立同分布），或对非 iid 情况给出调整建议（分块重采样等）",
              "score": 25,
              "evaluation_focus": "样本假设",
              "scoring_hint": "高分：明确样本假设并给出替代方案（如时间簇、bootstrap-block）；中分：提及代表性但无对策；低分：忽略样本假设。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "建立 q(t) 的解析分段表达并用于积分",
              "description": "必须给出 q(t)=Q−rt (0≤t≤t1) 与 q(t)=L−r(t−t1) (t1<t≤T_j) 的明确表达并说明积分上下界与零截断",
              "score": 25,
              "evaluation_focus": "解析推导",
              "scoring_hint": "高分：给出完整分段表达并标注零截断处；中分：表达正确但未讨论截断或边界；低分：q(t) 表达或边界错误。"
            },
            {
              "sub_criteria": "自有仓与租赁仓持有成本的解析积分公式",
              "description": "需推导 H_own_j=c2·∫ min(max(q,0),Q0) dt 与 H_rent_j=c3·∫ max(0,q−Q0) dt 的解析二次/一次分段公式并给出可直接计算的闭式面积",
              "score": 30,
              "evaluation_focus": "积分化简",
              "scoring_hint": "高分：提供分段闭式面积公式并能对不同 X_j 使用；中分：仅给出积分形式但未化简；低分：积分表述错误或不可计算。"
            },
            {
              "sub_criteria": "缺货成本 S_j 两种情形的明确表达",
              "description": "对 c4 为一次性损失给出 S_j=c4·max(0,r X_j−L)，对 c4 为按天损失给出 S_j=c4·∫ max(0,−q(t)) dt，并推导闭式情形",
              "score": 20,
              "evaluation_focus": "成本建模",
              "scoring_hint": "高分：两种情形均给出解析表达并示例计算；中分：仅给出一种情形或未解析化；低分：表达不当或遗漏。"
            },
            {
              "sub_criteria": "样本估计与 C(L) 的最终数学表达",
              "description": "给出用样本平均替代期望的公式：E[H]=mean(H_j), E[S]=mean(S_j), E[T]=mean(T_j) 及 C(L)=[c1+E[H]+E[S]]/E[T]",
              "score": 25,
              "evaluation_focus": "公式一致性",
              "scoring_hint": "高分：公式正确且注明样本平均替代的无偏/方差影响；中分：公式正确但缺少统计讨论；低分：公式错误或遗漏 E[T]。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "样本级成本计算的向量化/并行实现方案",
              "description": "需具体说明对每个候选 L 如何对所有 X_j 向量化或并行计算 H_own_j、H_rent_j、S_j 与 T_j 以降低复杂度 O(N·#L)",
              "score": 25,
              "evaluation_focus": "算法工程",
              "scoring_hint": "高分：提供向量化/numba/multiprocessing 实现思路或伪码；中分：提出并行化但无实现细节；低分：未考虑效率或仍采用逐样本逐 L 嵌套循环。"
            },
            {
              "sub_criteria": "优化与搜索策略（粗网格→细化→整数化）",
              "description": "应给出一维搜索策略：初始粗网格扫寻、在最优邻域细化、对整数 L 做局部评估，以及可选的黄金分割/二分加速方法",
              "score": 25,
              "evaluation_focus": "优化方法",
              "scoring_hint": "高分：提出并实现粗→细→整数化流程并验证全局最优；中分：仅网格搜索；低分：无细化或整化策略。"
            },
            {
              "sub_criteria": "不确定性估计：bootstrap 与置信区间",
              "description": "需说明如何用自助法估计 L* 与 C(L*) 的置信区间（重采样步骤、重算 L* 或对 C(L*) 取分布），并给出可操作流程",
              "score": 25,
              "evaluation_focus": "统计推断",
              "scoring_hint": "高分：实现 bootstrap 重采样并报告置信区间；中分：提及 bootstrap 但实现欠缺；低分：无不确定性估计。"
            },
            {
              "sub_criteria": "样本外验证与蒙特卡洛仿真流程",
              "description": "应给出用保留样本或新的 F_X 蒙特卡洛样本对 L* 做独立仿真的具体步骤与评价指标（平均成本、方差）",
              "score": 25,
              "evaluation_focus": "验证测试",
              "scoring_hint": "高分：提供独立仿真并给出偏差/方差评估；中分：做了仿真但统计报告不全；低分：无样本外验证。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "可复现的代码与模块化实现（输出 L*, C(L*) 与分项）",
              "description": "代码应能从输入 r,c1,c2,c3,c4,Q0,Q, {X_j} 直接运行，输出 L*、C(L*)、各成本项均值与置信区间，并包含示例运行说明",
              "score": 40,
              "evaluation_focus": "可复现性",
              "scoring_hint": "高分：提供可运行脚本/Notebook、示例数据与运行说明；中分：代码部分可运行但缺示例或说明；低分：代码不可运行或缺关键模块。"
            },
            {
              "sub_criteria": "实现效率：解析积分与并行化优先",
              "description": "优先使用解析分段面积公式替代数值积分，并采用向量化或并行化以降低运行时间，注明时间复杂度",
              "score": 30,
              "evaluation_focus": "运行效率",
              "scoring_hint": "高分：使用闭式面积并行实现，文档说明复杂度与实际运行时间；中分：使用向量化但未并行；低分：使用数值积分与低效循环，运行缓慢。"
            },
            {
              "sub_criteria": "代码质量与文档（注释、参数校验、单元测试）",
              "description": "代码应包含输入校验（单位检查）、清晰注释、必要的单元测试或示例验证用例，并输出可解释日志",
              "score": 30,
              "evaluation_focus": "代码质量",
              "scoring_hint": "高分：有完整参数校验、注释和测试；中分：基本注释与少量测试；低分：无注释、无校验或难以读懂。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "报告最优订货点 L* 与平均成本率 C(L*)（含整数化结果）",
              "description": "应明确报告实数最优 L_hat、整数化后 L*、相应 C(L*) 与 E[T]，并对取整误差进行说明",
              "score": 30,
              "evaluation_focus": "结果呈现",
              "scoring_hint": "高分：同时报告 L_hat 与 L*、C(L*) 并量化取整影响；中分：只报 L* 或只报实数解；低分：结果报告不完整或无成本值。"
            },
            {
              "sub_criteria": "成本分项贡献与决策含义（持有/租赁/缺货/订货）",
              "description": "需展示各成本项占比并讨论哪个成本主导最优 L* 的形成，为库存策略给出解释性建议",
              "score": 25,
              "evaluation_focus": "解释能力",
              "scoring_hint": "高分：给出分项占比并解释 L* 与参数间的因果关系；中分：列出分项但解释浅显；低分：无分项分析或解释错误。"
            },
            {
              "sub_criteria": "敏感性分析与参数响应图（含 c4,c3,Q0,E[X]）",
              "description": "应系统改变关键参数（至少 c4、c3、Q0、E[X]）并绘制 L* 与总成本对这些参数的响应曲线，判断决策稳健性",
              "score": 25,
              "evaluation_focus": "鲁棒性",
              "scoring_hint": "高分：提供多参敏感性图并讨论转折点；中分：只变化一两个参数；低分：无敏感性分析或图表缺乏解释。"
            },
            {
              "sub_criteria": "样本外验证与不确定性报告（bootstrap/仿真）",
              "description": "需给出 bootstrap 或样本外蒙特卡洛验证的结果，报告 L* 的置信区间与样本外成本偏差",
              "score": 20,
              "evaluation_focus": "统计可靠性",
              "scoring_hint": "高分：完整提供置信区间与样本外偏差并讨论可能原因；中分：提供置信区间但无样本外验证；低分：无不确定性或验证报告。"
            }
          ]
        }
      }
    },
    "4": {
      "subtask": "子任务4（动态适应性与稳健化实施任务）——目标是为库存订货策略构建并实现一套可操作的在线自适应与鲁棒化框架，使在需求速率、提前期分布或成本参数随时间变化或存在估计不确定性时，系统能自动检测变化、更新参数估计、并以明确的风险偏好（如置信水平或CVaR权重）输出新的订货决策与保护缓冲，从而在降低长期平均成本的同时控制极端缺货风险；该子任务的工作范围包括数据采集与预处理、参数估计与不确定性表征、变动检测与触发策略、基于不确定性/风险的决策算子设计、在线再优化与部署流程、以及验证与监控。具体步骤和方法：1) 数据输入与预处理：持续接收并清洗历史与实时数据流，包括每次下单的发出时间与到货延迟X、日销售量或累计销量以估计速率r、以及成本参数（c1,c2,c3,c4）和仓容Q0,Q；为后续统计和仿真保留时间戳并做缺失值处理与异常点标注。 2) 在线参数估计与不确定性量化：实现两类并行估计器——短期自适应频率方法（滑动窗口、指数加权移动平均EWMA）用于快速跟踪变动；贝叶斯/状态空间方法（如卡尔曼滤波或贝叶斯层级模型，使用 PyMC3/NumPyro/Stan）用于产生 X 与 r 的后验分布和预测分布，从而得到参数不确定性度量（方差/置信区间/后验样本）。3) 变动检测与再优化触发规则：部署统计检测器（CUSUM、Page‑Hinckley、序列概率比检验或基于后验概率阈值的贝叶斯变点检测）对关键指标（E[X]、Var[X]、r、缺货率）进行实时监控，定义两类触发：定期重算（例如每日/每周定时）与事件驱动重算（在检测到显著分布漂移或供应中断指示时立即触发），并对触发阈值和最小重算间隔设定保护以防频繁震荡。4) 鲁棒与风险敏感决策方法：在每次重算时以后验预测分布为输入采用样本平均近似（SAA）或蒙特卡洛评估成本，并支持三种可选目标/约束形式——（A）风险中性期望成本最小化（基准）；（B）置信水平约束或概率约束（保证短缺概率≤α）；（C）下尾风险控制（最小化CVaRα或采用拉格朗日权重将CVaR与期望结合），同时支持鲁棒最小化（minimax）针对参数不确定区间的最坏情形优化；优化实现可用 cvxpy/pyomo + IPOPT/CPLEX 或样本驱动的黑箱优化（SPSA、Bayesian optimization）以处理复杂非凸成本。5) 模型预测控制（MPC）与再优化流程：采用滚动时域（MPC）策略——每次重算根据当前库存状态和后验预测对未来若干周期模拟并求解短期最优订货点/补货目标（并提供置信区间或保守缓冲），仅实施当前周期决策并在下周期重复；参数化重算频率、预测窗口长度和保守系数以权衡稳定性与响应速度。6) 供应信息与情景整合：若可获得供应商实时信息（如可用发货窗口、分批发货选项或ETA更新），将其作为条件变量纳入提前期预测模型并在优化中作为情景权重；对罕见极端延迟情形做压力测试与情景优化，并在决策中引入额外安全库存或优先级调度规则。7) 强化学习（可选的长期自学习模块）：在数据丰富且允许仿真试错的场景下，构建受约束的强化学习代理（状态含当前库存、历史X样本统计与时间，动作为订货点/量，奖励为负即时成本并加上约束惩罚），先在仿真环境离线训练（使用历史生成的预模拟环境）并用保守探索策略在线逐步部署；采用策略梯度或深度Q与Lagrangian约束技术并限制在线学习变动速率以避免突发缺货。8) 验证、回测与监控：在每次模型更新后运行滚动回测（保留窗口或交叉验证）与蒙特卡洛仿真评估决策的平均成本、缺货概率与CVaR，输出性能报告并在部署前通过A/B或影子模式在线验证；部署后持续监控关键KPI（填充率、缺货次数、平均持有与租仓成本、决策变动频率），并对异常或性能下降自动触发回退策略或人工审查。9) 工程实现与工具链：建议使用可复现的代码框架（Python），数据与快速分析用 pandas/numpy，时序建模用 statsmodels/pmdarima，贝叶斯推断用 PyMC3/NumPyro/Stan，优化与CVaR实现用 cvxpy/pyomo + IPOPT，变动检测用 ruptures 或自实现CUSUM，强化学习可用 Stable‑Baselines3 或 RLlib，全部部署在容器化服务中并配合调度器（Airflow）与监控（Prometheus/Grafana）；为保证稳定性，设置模型注册、版本控制、自动回滚与可视化决策面板。10) 可配置参数与产出物：明确并文件化可调超参数（滑动窗口长度、EWMA衰减、贝叶斯先验、变动检测阈值、重算频率、风险偏好α或CVaR权重、最大允许在线学习步长），输出包括每次重算建议的订货点与补货量、对应的成本/风险预测分布、置信区间、触发日志以及回测与实时监控报表。任务完成标准为：部署后系统能在规定的数据延迟内（例如每24小时或事件触发后1小时）生成新的决策建议、在历史回测中显示显著降低极端缺货损失或CVaR、并通过监控界面实时呈现性能指标与自动报警。",
      "criteria": {
        "task_understanding": {
          "core_goal": "检测供应与需求分布变化、在线更新提前期X与速率r的参数估计，并基于风险偏好（如CVaR或置信水平）再优化订货点以控制缺货风险并最小化长期平均成本",
          "expected_output": "实时可执行的订货决策流（每次重算的L建议与补货量）、带不确定性/风险度量的成本预测分布、回测报告、监控告警及可复现代码与容器镜像",
          "key_inputs_constraints": "1) 历史与实时数据流：到货提前期样本X (数值序列，带时间戳)；2) 日或周期销售速率r（数值/时间序列）；3) 成本参数c1,c2,c3,c4与仓容Q0,Q（标量）；4) 实时重算频率与最大响应延迟（例如每日或事件触发、目标延迟≤1小时）；5) 风险偏好配置（置信水平α或CVaR权重）",
          "modeling_type": "预测+优化+仿真（含变动检测与MPC）",
          "role_in_pipeline": "作为决策执行层：依赖前序的数据清洗与历史样本（子任务3 的输出），在参数估计与变动检测后生成订货点决策并将结果供后序部署/监控；直接依赖前序：样本化提前期X与初始L基线；后序：部署/监控与A/B回测"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "漂移检测（检测 E[X], r, Var[X]）",
              "description": "评价是否基于历史/实时数据建立了对 E[X], Var[X], r 的漂移检测器（如 CUSUM、Page‑Hinckley 或贝叶斯变点），并能区分瞬时噪声与真实分布漂移。",
              "score": 30,
              "evaluation_focus": "统计检测",
              "scoring_hint": "高分：实现并验证 CUSUM/Page‑Hinckley 或后验变点检测，历史回测能在已知漂移点检出且误报率低；中分：使用 EWMA 指标有经验阈值但无严格检测；低分：仅人工观察或无变动检测。"
            },
            {
              "sub_criteria": "不确定性量化（后验/置信区间）",
              "description": "考察是否对提前期 X 和速率 r 给出不确定性度量（贝叶斯后验、卡尔曼滤波方差或样本置信区间），并可用于下游优化的样本化输入。",
              "score": 25,
              "evaluation_focus": "不确定度表征",
              "scoring_hint": "高分：提供后验样本或方差并展示收敛与校准；中分：提供滑动窗口标准误估计；低分：只给点估计无不确定性度量。"
            },
            {
              "sub_criteria": "风险目标明确定义（CVaR/置信约束/缺货概率）",
              "description": "检验是否明确了风险目标（如最小化CVaRα、或约束短缺概率≤α）并将其作为优化目标或约束。",
              "score": 25,
              "evaluation_focus": "风险规范",
              "scoring_hint": "高分：明确 CVaRα 或概率约束并能解释α含义；中分：提出风险项但未量化α或未整合到优化；低分：无风险目标或笼统表述。"
            },
            {
              "sub_criteria": "触发策略与延迟要求（定期+事件驱动）",
              "description": "评价是否制定清晰再优化触发规则（滑动窗口/EWMA阈值/变点）并给出允许的最大决策延迟（例如事件触发后≤1小时或日内重算策略）。",
              "score": 20,
              "evaluation_focus": "运维约束",
              "scoring_hint": "高分：同时实现定期（如每日）与事件驱动触发，并量化最大响应时延；中分：仅定期重算或阈值未量化；低分：无触发规范或无法执行实时更新。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "目标复述（检测-更新-再优化-控制CVaR）",
              "description": "考察是否能将任务复述为：实时检测分布漂移→在线更新 X 与 r 的估计→基于 CVaR/置信约束再优化订货点 L，以降低长期平均成本并控制缺货极端损失。",
              "score": 40,
              "evaluation_focus": "目标重述",
              "scoring_hint": "高分：逐条精确复述并给出度量指标（长期成本与CVaR）；中分：复述大方向但缺少CVaR或实现细节；低分：复述模糊或未包含再优化/风险控制要素。"
            },
            {
              "sub_criteria": "输入/输出与KPI明确（X, r, c1.., Q0, 输出L）",
              "description": "检查是否明确列出关键输入（X样本、r、c1..c4、Q0,Q）与输出（每次建议 L、成本/风险分布）及主要KPI（缺货概率、CVaR、平均成本）。",
              "score": 30,
              "evaluation_focus": "接口说明",
              "scoring_hint": "高分：所有输入输出与KPI完整并说明单位与更新频率；中分：主要项列出但缺少单位或频率；低分：输入输出或KPI不明确。"
            },
            {
              "sub_criteria": "约束与可行域说明（响应延时、计算预算）",
              "description": "验证是否明确系统约束，如最小重算间隔、最大计算时间、并发样本数限制与部署资源（容器化/CPU/GPU）。",
              "score": 30,
              "evaluation_focus": "工程约束",
              "scoring_hint": "高分：列出延时/计算预算并给出满足方法（并行、代理）；中分：有约束但无解决方案；低分：无工程可行性说明。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "数据生成与独立性假设（X 与需求样本）",
              "description": "检验是否明确对提前期 X 与销售 r 的时间独立性、周期间独立或相关性假设，并说明窗口长度对估计偏差的影响。",
              "score": 30,
              "evaluation_focus": "统计假设",
              "scoring_hint": "高分：明确假设并做后验检验（自相关/白噪声检验）；中分：给出假设无检验；低分：未陈述或假设明显矛盾史料。"
            },
            {
              "sub_criteria": "关于成本参数稳定性的假设（c1..c4 常数）",
              "description": "评价是否说明 c1,c2,c3,c4 在重算周期内被视为常数或具可更新策略并讨论其不确定性影响。",
              "score": 25,
              "evaluation_focus": "成本假设",
              "scoring_hint": "高分：明确并给出参数更新机制或敏感性分析；中分：假设常数但无不确定性讨论；低分：未说明成本参数假设。"
            },
            {
              "sub_criteria": "提前期分布形态与可采样性假设",
              "description": "要求说明是否假定 X 可从历史样本直接蒙特卡洛采样或拟合为某族分布，并论证尾部行为处理（极端延迟）。",
              "score": 25,
              "evaluation_focus": "分布假设",
              "scoring_hint": "高分：提供分布拟合与尾部修正方案；中分：仅用样本无尾部讨论；低分：对 X 的处理含糊或不合理。"
            },
            {
              "sub_criteria": "MPC与回滚策略的稳定性假设",
              "description": "评估是否假定滚动MPC短期最优决策可被频繁更新且存在回退策略以避免决策震荡。",
              "score": 20,
              "evaluation_focus": "控制假设",
              "scoring_hint": "高分：给出保守系数与最小重算间隔并检验稳定性；中分：提出MPC但无防震荡措施；低分：无稳定性考量。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "参数估计器设计（EWMA 与贝叶斯后验）",
              "description": "检查是否实现短期自适应（EWMA/滑动窗口）与长期贝叶斯/卡尔曼后验并能输出后验样本用于优化（X, r 的分布化估计）。",
              "score": 25,
              "evaluation_focus": "估计方法",
              "scoring_hint": "高分：并行实现 EWMA 与贝叶斯，展示后验样本并度量不确定性；中分：只实现单一估计器；低分：估计器缺乏自适应或不提供不确定性。"
            },
            {
              "sub_criteria": "变动检测模块（CUSUM/贝叶斯变点）",
              "description": "验证是否将变动检测输出（检测时间、置信度）与触发重算规则耦合，并给出误报/漏报控制手段。",
              "score": 20,
              "evaluation_focus": "变动检测",
              "scoring_hint": "高分：检测器输出阈值并与重算策略联动；中分：检测器存在但联动不充分；低分：无检测器或无联动。"
            },
            {
              "sub_criteria": "风险敏感优化构型（CVaR / 概率约束 / 最坏情形）",
              "description": "考察是否把 CVaRα、概率约束或鲁棒最坏情形纳入目标/约束，且能用样本平均（SAA）或凸化技术求解。",
              "score": 30,
              "evaluation_focus": "风险建模",
              "scoring_hint": "高分：明确 CVaR 或概率约束并给出可解化方案；中分：提出风险项但未给出数值化求解方法；低分：无风险建模。"
            },
            {
              "sub_criteria": "MPC 滚动再优化与情景整合",
              "description": "评估是否设计滚动时域（MPC）再优化流程，能接纳供应场景/ETA更新并输出本期执行策略与未来预测区间。",
              "score": 25,
              "evaluation_focus": "控制策略",
              "scoring_hint": "高分：实现滚动窗口决策并演示情景条件化；中分：MPC 设计但未集成情景数据；低分：无 MPC 或只一次性优化。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "求解方法与求解器选择（SAA/IPOPT/黑箱）",
              "description": "检验是否为期望或CVaR优化选择合适求解器（IPOPT/CPLEX 或黑箱如SPSA），并说明约束处理（拉格朗日/增广）。",
              "score": 30,
              "evaluation_focus": "求解器选择",
              "scoring_hint": "高分：选择与实现 IPOPT/CVX/样本平均并展示收敛；中分：使用数值优化但缺少约束处理细节；低分：仅用启发式无证据其可行性。"
            },
            {
              "sub_criteria": "样本平均/蒙特卡洛实现与方差控制（SAA/方差缩减）",
              "description": "评价是否采用 SAA 或蒙特卡洛估计期望成本，并使用方差缩减/并行化减少评估噪声以确保优化稳定。",
              "score": 25,
              "evaluation_focus": "样本方法",
              "scoring_hint": "高分：实现方差缩减（控制变量/重要抽样）并并行加速；中分：普通蒙特卡洛并行化；低分：样本数不足或无并行/方差控制。"
            },
            {
              "sub_criteria": "鲁棒/尾部优化（CVaR 求解或最坏情形）",
              "description": "考察是否能计算并优化 CVaRα 或执行区间/最坏情形优化并给出对偶或内点求解路径。",
              "score": 20,
              "evaluation_focus": "尾部控制",
              "scoring_hint": "高分：CVaR 被数值化并优化，回测降低缺货尾部损失；中分：CVaR 估计存在但未纳入优化；低分：未考虑尾部风险。"
            },
            {
              "sub_criteria": "计算效率与实时性保障（并行/代理/延迟）",
              "description": "验证是否为在线部署设计了并行评估、代理模型或时间预算保障，以满足最大响应延迟约束。",
              "score": 25,
              "evaluation_focus": "计算工程",
              "scoring_hint": "High: 提供代理模型/并行实现并实测满足延迟要求; Mid: 并行实现但未实测延迟; Low: 无效率或超时风险。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "数据管道与实时预处理实现（X, r 流收集）",
              "description": "考察代码是否实现端到端数据收集与清洗（时间戳、缺失/异常处理），并能输出供估计器使用的标准化样本流。",
              "score": 30,
              "evaluation_focus": "工程实现",
              "scoring_hint": "高分：有自动化流水线与单元测试并支持流入/回溯；中分：脚本化处理但无实时接口或测试；低分：需手工准备数据或不完整。"
            },
            {
              "sub_criteria": "模块化优化与估计代码、可复现性（容器/版本）",
              "description": "检查是否将估计、检测、优化模块化，提供可复现代码、requirements 与容器镜像，便于部署（如 Docker + Airflow skeleton）。",
              "score": 25,
              "evaluation_focus": "可复现性",
              "scoring_hint": "高分：提供容器镜像、CI 测试与版本说明；中分：代码整洁可运行但无容器；低分：代码难以运行或无说明。"
            },
            {
              "sub_criteria": "使用库与数值稳健性（PyMC3/NumPyro/IPOPT/cvxpy）",
              "description": "评价是否合理使用推荐库（贝叶斯：PyMC3/NumPyro，优化：IPOPT/cvxpy）并进行数值稳定性处理（缩放、正则化）。",
              "score": 25,
              "evaluation_focus": "数值稳健",
              "scoring_hint": "高分：正确调用并处理数值问题；中分：使用库但无稳健性处理；低分：滥用库或频繁数值失败。"
            },
            {
              "sub_criteria": "监控/日志/报警与自动回滚实现",
              "description": "检查是否实现决策日志、性能监控指标输出（Prometheus/Grafana）与回滚策略以应对模型故障。",
              "score": 20,
              "evaluation_focus": "运维可靠性",
              "scoring_hint": "高分：监控面板与报警与回滚策略齐全；中分：日志与手工监控；低分：无监控或回滚手段。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "滚动回测与 A/B/影子部署评估（平均成本与CVaR）",
              "description": "评价是否对策略进行历史滚动回测与影子/小规模 A/B 部署，并报告平均成本、缺货概率与 CVaR 改善情况。",
              "score": 35,
              "evaluation_focus": "回测评估",
              "scoring_hint": "高分：回测显示显著降低 CVaR/缺货概率并有统计检验；中分：回测提供指标但无显著性分析；低分：无回测或回测方法有缺陷。"
            },
            {
              "sub_criteria": "敏感性与稳健性分析（对 c4, Q0, 尾部 X）",
              "description": "检验是否对关键参数（c4、Q0、提前期尾部）做系统敏感性分析并展示 L 与成本对这些参数的响应曲线。",
              "score": 25,
              "evaluation_focus": "敏感性",
              "scoring_hint": "高分：给出响应曲线与稳健性结论；中分：有限参数扫描；低分：无敏感性分析。"
            },
            {
              "sub_criteria": "不确定性汇报（置信区间/后验样本）",
              "description": "评估是否报告决策不确定性（L 的置信区间或后验分布）与成本分布，并用自助/蒙特卡洛验证置信度。",
              "score": 20,
              "evaluation_focus": "不确定性报告",
              "scoring_hint": "高分：提供置信区间与自助检验；中分：仅提供样本分布图；低分：无不确定性量化。"
            },
            {
              "sub_criteria": "在线监控 KPI 报告与自动告警效果",
              "description": "考察是否提供实时 KPI 仪表（填充率、缺货次数、持有成本）并验证告警触发的正确性与人工审查流程。",
              "score": 20,
              "evaluation_focus": "监控效果",
              "scoring_hint": "高分：监控覆盖关键 KPI 并能自动触发回退；中分：有监控但需人工干预；低分：无或不可用监控指标。"
            }
          ]
        }
      }
    }
  }
}