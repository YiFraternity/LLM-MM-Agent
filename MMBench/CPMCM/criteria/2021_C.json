{
  "task_id": "2021_C",
  "problem": "问题 1. 利用给出的神经元 Hodgkin-Huxley 模型（附件 1），数值模拟外界刺激（包括直流刺激和交流刺激）情况下，单个神经元的电位发放情况，并给出神经元电位发放的特征指标。\n\n问题 2. 根据问题 1 的神经元 Hodgkin-Huxley 模型，结合附件 1 中神经元之间的突触连接理论，建立基底神经节神经回路的理论模型，计算基底神经节内部神经元的电位发放（每个神经团块可以简化为 5-10 个神经元）。\n\n问题 3. 根据建立的基底神经节回路模型，理论分析正常状态（图 2 中 Healthy 回路）和帕金森病态（图 2 的 PD 回路中去掉黑质 SNc）基底神经节回路电位发放的特征指标。\n\n问题 4. 利用建立的基底神经节回路模型，对帕金森病态的基底神经节靶点添加高频电刺激，可以模拟脑深部电刺激治疗帕金森病的状态。请模型确定最佳刺激靶点，是刺激靶点 STN，还是刺激靶点 GPi；请模型优化刺激的参数，如电刺激强度，电刺激频率和电刺激模式等。\n\n问题 5. 在直接通路的神经通路中，或者间接通路的神经通路中，模型回答脑深部电刺激治疗是否存在其它最优电刺激靶点。",
  "subtask": {
    "1": {
      "subtask": "子任务1（单细胞 HH 模型的刺激响应与特征提取）：以附件1 中给定的单点 Hodgkin–Huxley 型神经元方程及通道参数为唯一动力学描述，实施系统化的数值仿真以量化该神经元在各类外界激励下的膜电位发放特征；具体工作范围和步骤为：一、模型与初始标定——严格采用附件1 中的电导项、门控方程、反转电位与所有给定常数，实现点电容 HH 方程 C_m dV/dt = −∑I_ion(V, gates) − I_syn + I_ext，并输出膜电位 V(t) 与全部门控变量时间序列；二、噪声与背景输入（可选但推荐）——为模拟体内条件，可加入白噪声或基于电导的 Poisson/Ornstein–Uhlenbeck 背景输入，噪声强度作为可控参数；三、刺激类型与参数扫描——对单元分别施加（1）直流电流 I_DC，扫描范围从零到产生持续放电的阈值若干倍（先通过 f–I 曲线确定阈值/rheobase）；（2）正弦交流电 I_AC(t)=A sin(2πft)，系统扫频 f（例如 1–200 Hz）与幅度 A 的矩阵；（3）单次矩形脉冲与脉冲列；（4）DBS 风格的窄脉冲序列（单相/双相，脉宽 τ_pw 在 0.05–0.5 ms 范围内，频率 f 在 20–200 Hz 范围内，幅度 A 扫掠至安全/有效上限）；每一组刺激均做多参数网格扫描并记录响应；四、数值求解与可重复性——采用刚性 ODE 求解器（如 CVODE/BDF）或高精度显式方法（RK4）并采用 dt≈0.01–0.05 ms（依据通道动力学和脉冲宽度选择更小 dt），仿真时长建议足够长以统计稳态行为（典型≥10 s，视指标而定），对每组参数做多次（建议 N=20–30）随机种子重复以量化变异并保存随机种子与所有参数用于复现；五、输出数据与保存规范——保存原始时间序列（V 和门控变量）、检测到的峰时刻（用阈值与/或导数法判定）、刺激时间戳与所用参数集合，采样率与数据格式明确记录；六、特征指标与计算方法（根据附件2 指标精确实现）——从膜电位与峰时刻计算瞬时/平均放电率、ISI 分布与 CV(ISI)、f–I 曲线与阈值/rheobase、爆发/簇发放指数（基于 ISI 阈值定义的 burst 检测）、峰峰电位与最大放电速率、相位锁定值/向量强度（针对于周期刺激）、刺激—相位响应关系与锁相范围、功率谱（Welch 或 STFT，去除初始瞬态并统计 β 带与其它频带能量）、以及必要时的相位反应曲线（PRC，采用小幅短脉冲扰动测得）；七、分析流程与工具建议——实现与仿真推荐使用 Brian2、NEURON 或 MATLAB，数据分析可用 Python (NumPy/SciPy/MNE) 或 MATLAB 工具箱，所有计算应包括置信区间估计和参数敏感性（局部变动）检验；八、结果文件与记录要求——每次仿真输出应包含输入刺激配置、求解器设置、随机种子、原始时间序列、峰时间列表与已计算的所有指标，以便后续网络建模阶段可直接引用该单细胞响应特征作为基线与参数化依据。",
      "criteria": {
        "task_understanding": {
          "core_goal": "基于附件1的单点 Hodgkin–Huxley 模型仿真并评估在直流/交流/脉冲/DBS 风格刺激下的膜电位发放特征与指标（含 f–I、ISI、相位锁定、功率谱等）。",
          "expected_output": "时间序列(V与门控变量)、峰时刻列表、参数与随机种子记录、特征指标报表与图表（f–I 曲线、ISI 分布、CV(ISI)、相位锁定值、功率谱）、可复现实验配置与代码/模型文件。",
          "key_inputs_constraints": "输入：附件1给定的HH方程与通道参数；刺激配置（I_DC、I_AC幅度A与频率f、矩形脉冲、DBS脉宽τ_pw/频率/幅度/单相或双相）；噪声参数（白噪声或OU/Poisson电导）；求解器与步长dt(0.01–0.05 ms)；仿真时长(≥10 s)；重复次数(N=20–30)；输出需记录随机种子与采样率。约束：严格使用附件1参数；稳定数值积分；DBS脉宽0.05–0.5 ms、频率20–200 Hz；网格扫描覆盖阈值若干倍。",
          "modeling_type": "仿真+评价",
          "role_in_pipeline": "作为基底神经节网络建模前的单细胞基线仿真与指标提取环节；前序依赖：附件1模型与参数确认、工具环境；后序任务：网络模型构建、健康/PD态对比、DBS靶点与参数优化、最优靶点探查。",
          "assumptions": "附件2指标口径未给出时，采用常用定义：峰检测阈值-20 mV或dV/dt法；相位锁定值用向量强度R；功率谱用Welch，去除前1 s瞬态；PRC以小幅短脉冲测量。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "识别仿真+评价双目标与HH单元约束",
              "description": "明确该任务是对附件1的Hodgkin–Huxley模型进行系统仿真并评估发放特征，且必须严格使用附件1电导、门控与反转电位。",
              "score": 35,
              "evaluation_focus": "任务界定",
              "scoring_hint": "高分：同时点出“仿真+评价”与“严格采用附件1参数”；中分：只提到仿真或评价之一；低分：未限制模型或偏离HH。"
            },
            {
              "sub_criteria": "覆盖刺激类型与参数扫描矩阵",
              "description": "指出需覆盖I_DC、I_AC(A,f)、矩形脉冲、DBS(τ_pw, f, A,单/双相)的多参数网格扫描。",
              "score": 25,
              "evaluation_focus": "范围识别",
              "scoring_hint": "高分：四类刺激均列出并含关键参数；中分：缺少1类或缺关键参数；低分：仅单一刺激或无参数扫描。"
            },
            {
              "sub_criteria": "识别数值精度与可重复性要求",
              "description": "指出刚性ODE或高精度RK4、dt≈0.01–0.05 ms、仿真≥10 s、N=20–30重复、记录随机种子。",
              "score": 25,
              "evaluation_focus": "约束理解",
              "scoring_hint": "高分：同时写出dt、时长、重复次数、随机种子；中分：缺少其中任两项；低分：未提数值或复现实验要点。"
            },
            {
              "sub_criteria": "识别特征指标与分析输出",
              "description": "点出f–I、ISI与CV、爆发指数、相位锁定值/锁相范围、功率谱(β带)、峰峰电位、PRC等输出指标。",
              "score": 15,
              "evaluation_focus": "指标范围",
              "scoring_hint": "高分：列出≥6项且含相位与频谱；中分：3–5项；低分：≤2项或笼统表述。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "精确复述f–I与rheobase提取",
              "description": "清晰表述通过直流I_DC扫描得到f–I曲线并估计阈值/最小放电电流(rheobase)。",
              "score": 25,
              "evaluation_focus": "需求映射",
              "scoring_hint": "高分：给出扫描流程与阈值定义；中分：只提f–I或阈值之一；低分：未提。"
            },
            {
              "sub_criteria": "复述AC扫频与相位锁定评估",
              "description": "表述I_AC=A sin(2πft)的扫频/幅度矩阵并计算向量强度或锁相信息。",
              "score": 25,
              "evaluation_focus": "准确复述",
              "scoring_hint": "高分：含频率范围与R值计算；中分：仅提扫频；低分：未提相位指标。"
            },
            {
              "sub_criteria": "复述DBS脉冲参数范围与模式",
              "description": "明确DBS窄脉冲τ_pw=0.05–0.5 ms，f=20–200 Hz，幅度A扫掠，单相/双相模式。",
              "score": 25,
              "evaluation_focus": "边界条件",
              "scoring_hint": "高分：四项参数与模式齐全；中分：缺1–2项；低分：未限定范围。"
            },
            {
              "sub_criteria": "复述数据保存规范与可复现元数据",
              "description": "强调保存V与门控时间序列、峰时刻、刺激时间戳、参数集合、采样率、随机种子与求解器设置。",
              "score": 25,
              "evaluation_focus": "规范意识",
              "scoring_hint": "高分：列出≥6项元数据；中分：3–5项；低分：笼统‘保存结果’。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "峰检测阈值/导数法假设",
              "description": "明确峰检测采用固定阈值(如-20 mV)与/或dV/dt联合判定，并说明对爆发/簇检测的ISI阈值设定方法。",
              "score": 30,
              "evaluation_focus": "可操作性",
              "scoring_hint": "高分：给出数值阈值与依据；中分：只给方法不定量；低分：未说明。"
            },
            {
              "sub_criteria": "噪声模型与强度范围假设",
              "description": "说明白噪声或OU/Poisson电导背景的统计特性与强度范围，并与N=20–30重复关联。",
              "score": 25,
              "evaluation_focus": "建模假设",
              "scoring_hint": "高分：给出分布/时间常数与幅度范围；中分：仅名称无参数；低分：忽略噪声或不当设置。"
            },
            {
              "sub_criteria": "功率谱与瞬态剔除假设",
              "description": "指明使用Welch或STFT、窗口/重叠策略并剔除前1 s瞬态，报告β带能量。",
              "score": 25,
              "evaluation_focus": "分析假设",
              "scoring_hint": "高分：工具+窗口+瞬态剔除齐全；中分：缺其一；低分：未说明或包含瞬态。"
            },
            {
              "sub_criteria": "PRC测量与扰动幅度假设",
              "description": "阐明PRC用小幅短脉冲扰动、相位定义与采样相位点数。",
              "score": 20,
              "evaluation_focus": "实验设定",
              "scoring_hint": "高分：给出幅度、脉宽、相位采样数；中分：只述方法；低分：未提PRC或设定不当。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "严格实现附件1 HH方程与门控动力学",
              "description": "复现C_m dV/dt=−∑I_ion−I_syn+I_ext，使用指定电导、反转电位与α/β或m∞/τ方程。",
              "score": 35,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：列出全部离子通道与参数来源说明；中分：缺少次要通道或常数；低分：偏离附件1或错误方程。"
            },
            {
              "sub_criteria": "刺激生成器设计(I_DC/I_AC/脉冲/DBS)",
              "description": "实现可配置的刺激模块，支持幅度、频率、脉宽、相位、双相对称与占空比控制。",
              "score": 25,
              "evaluation_focus": "模块设计",
              "scoring_hint": "高分：四类均参数化且可组合；中分：缺1类或参数不全；低分：硬编码或单一刺激。"
            },
            {
              "sub_criteria": "噪声/背景输入注入位置与尺度",
              "description": "明确电流噪声或电导噪声注入项位置(I_ext或g_syn)及单位一致性与尺度校准。",
              "score": 20,
              "evaluation_focus": "一致性检查",
              "scoring_hint": "高分：单位与尺度自洽并验证静默/放电边界；中分：有说明但未验证；低分：未考虑单位或注入错误。"
            },
            {
              "sub_criteria": "指标计算管线与数据结构",
              "description": "设计从原始V/gates到峰、ISI、f–I、R值、功率谱、PRC的流水线与清晰的数据模式。",
              "score": 20,
              "evaluation_focus": "可维护性",
              "scoring_hint": "高分：有独立模块与标准化输出字段；中分：脚本化但耦合高；低分：零散且难以复用。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "数值积分器与时间步选择",
              "description": "选用CVODE/BDF或RK4并给出dt≈0.01–0.05 ms，针对窄脉冲自动减小dt以解析τ_pw。",
              "score": 30,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：自适应或事件驱动处理窄脉冲；中分：固定dt在允许范围；低分：dt过大导致脉冲失真。"
            },
            {
              "sub_criteria": "稳态统计时长与瞬态剔除",
              "description": "确保仿真≥10 s并剔除初始瞬态区段进行统计与谱分析。",
              "score": 20,
              "evaluation_focus": "数值稳健",
              "scoring_hint": "高分：给出具体剔除时长并验证稳态；中分：剔除但未验证；低分：未剔除。"
            },
            {
              "sub_criteria": "参数网格扫描与批处理执行",
              "description": "实现对I_DC、(A,f)、(τ_pw,f,A)等网格扫描与进度/失败重试机制。",
              "score": 25,
              "evaluation_focus": "工程执行",
              "scoring_hint": "高分：完整网格与日志/断点续跑；中分：网格有限；低分：手动少量跑。"
            },
            {
              "sub_criteria": "重复试验与置信区间估计",
              "description": "对每组参数进行N=20–30随机重复并计算均值±CI或bootstrap区间。",
              "score": 25,
              "evaluation_focus": "统计严谨",
              "scoring_hint": "高分：N≥20且报告95%CI；中分：N<20或仅均值；低分：无重复。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "正确实现HH通道与单位一致性",
              "description": "代码层面准确复刻附件1离子电流与门控方程，单位明确且通过基本单元测试。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：含参数校验与测试比对基准轨迹；中分：实现正确无测试；低分：实现错误或单位混乱."
            },
            {
              "sub_criteria": "刺激与噪声模块化API",
              "description": "提供I_DC/I_AC/脉冲/DBS与白噪声/OU/Poisson接口，支持组合与复用。",
              "score": 20,
              "evaluation_focus": "可复用性",
              "scoring_hint": "高分：统一接口与配置文件驱动；中分：部分函数化；低分：散乱硬编码。"
            },
            {
              "sub_criteria": "峰检测与指标计算的鲁棒实现",
              "description": "实现阈值/导数联合峰检、ISI/ CV、f–I、相位锁定R、Welch谱、PRC测量。",
              "score": 25,
              "evaluation_focus": "数值实现",
              "scoring_hint": "高分：边界条件与异常处理完备；中分：功能基本全；低分：缺关键指标或不稳。"
            },
            {
              "sub_criteria": "数据保存规范与可复现日志",
              "description": "保存原始时间序列、峰时刻、刺激时间戳、参数、求解器设置、随机种子、采样率，结构化文件命名。",
              "score": 25,
              "evaluation_focus": "可复现性",
              "scoring_hint": "高分：元数据齐全+README/manifest；中分：大部分保存；低分：无法复现。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "f–I曲线与rheobase报告",
              "description": "给出f–I曲线、rheobase点及CI，讨论数值步长/噪声对阈值的影响。",
              "score": 25,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：曲线+定量阈值+不确定性；中分：曲线无CI；低分：无曲线或错误读解。"
            },
            {
              "sub_criteria": "ISI分布与CV(ISI)/爆发指数",
              "description": "报告ISI直方图、CV与基于ISI阈值的爆发检测结果，比较不同刺激强度与噪声条件。",
              "score": 20,
              "evaluation_focus": "统计分析",
              "scoring_hint": "高分：跨条件比较并给CI；中分：单条件或无CI；低分：仅口述。"
            },
            {
              "sub_criteria": "相位锁定值与锁相范围",
              "description": "对AC/DBS周期刺激计算向量强度R与锁相区间，展示频率-幅度相图。",
              "score": 20,
              "evaluation_focus": "同步度量",
              "scoring_hint": "高分：相图+R定量阈值；中分：仅R随f曲线；低分：未提供锁相结果。"
            },
            {
              "sub_criteria": "功率谱与β带能量变化",
              "description": "用Welch或STFT展示谱密度，报告β带能量随刺激参数的变化并剔除瞬态。",
              "score": 20,
              "evaluation_focus": "频域分析",
              "scoring_hint": "高分：定量β能量与显著性；中分：谱图无定量；低分：无谱或含瞬态伪影。"
            },
            {
              "sub_criteria": "PRC与刺激—相位响应解读",
              "description": "给出PRC曲线并解释抑制/促进区段与潜在锁相机制，关联DBS脉冲相位效果。",
              "score": 15,
              "evaluation_focus": "机制洞察",
              "scoring_hint": "高分：PRC类型(I/II)与机制解释；中分：曲线无解释；低分：未做PRC。"
            }
          ]
        }
      }
    },
    "2": {
      "subtask": "子任务2（精炼版）：构建并验证一个小规模、可重复的基底神经节（BG）回路网络模型，范围限定为按生物学拓扑包含下列核团：皮层（Cortex）、纹状体分别的直接型与间接型投射神经元（dMSN、iMSN）、外侧苍白球（GPe）、下丘脑核（STN）、内侧苍白球/黑质网状部（GPi/SNr）与丘脑（Thalamus），并保留黑质致动调制量（SNc）作为可参数化调节项；每一核团用 5–10 个点神经元表示（具体个数在该区间内可调），单元动力学采用附件1 中给定的 Hodgkin–Huxley 型点模型，突触使用电导式模型（AMPA、NMDA、GABA_A），明确为每类突触指定反转电位（例如 E_exc≈0 mV，E_inh≈−70 mV）、上升/衰减时间常数范围（AMPA τ_rise≈0.5–1 ms τ_decay≈2–5 ms；NMDA τ_decay≈50–150 ms；GABA_A τ_decay≈5–20 ms）和突触延迟范围（典型 1–10 ms，可按连接类型微调）；按照经典 BG 拓扑构建连接矩阵 W（包括 Cortex→Str、dMSN→GPi、iMSN→GPe、GPe→STN、STN→GPi、GPe↔STN、GPi→Thalamus 等关键投射），每类投射采用概率连接（p 可在 0.2–0.8 范围内设定并记录），权重按指定分布（如均匀或对数正态）抽样并标注初始值区间以便后续灵敏度分析；外源皮层输入用 Poisson 或时变速率 r(t) 模型化（可包含带谱信号成分），所有随机化（连边抽样、权重采样、噪声和初始条件）须记录随机种子以保证可重现性。实施步骤：1) 根据附件1 精确实现单元动力学与突触动力学子模块并对单元/突触的时程响应做单元测试；2) 构造各核团的神经元集合并按 W 生成带延迟的突触耦合网络，保存邻接矩阵、权重、延迟与突触类型的完整配置文件；3) 在给定时间步长（建议 dt≈0.01–0.05 ms）和足够生物时间长度（建议 ≥10 s，以获取稳态统计量）下运行多次（每组参数至少 N_seed≥20）数值仿真，输出并存储每个神经元的膜电位时间序列、峰时点、每条突触的电流時間序列以及核团汇总信号（LFP 代理，如核团突触總電流或膜電位平均）；4) 计算并导出回路层面的定量指标（群体平均放电率、ISI 的 CV、burst/簇发放率、同步性量度如 Kuramoto 指数或平均互相关、功率谱及 β 频带能量 13–30 Hz、丘脑转导可靠度等），并对这些指标做统计汇总（均值、标准误和置信区间）；5) 实施参数敏感性分析（局部偏导或 Sobol 等全局方法）以识别对网络动力学影响最大的参数（突触权重、延迟、外源输入率与单元电导等），并在模型配置中明确标注哪些参数来自文献、哪些为拟合/假设值。所需输入与工具：必须使用附件1 中的单元与突触参数作为基线输入，外源输入谱与连接概率表格作为可配置输入；实现与仿真建议使用支持精确时程和突触延迟的数值平台（如 Brian2、NEURON、NEST 或 MATLAB），并在脚本中明确记录求解器设置、随机种子和输出格式。输出文件应包含网络配置、所有仿真原始数据与派生指标，以便后续对比不同生理状态或参数化病态情形时能直接复用本子任务生成的标准化网络与基线结果。",
      "criteria": {
        "task_understanding": {
          "core_goal": "仿真并评估基于附件1 Hodgkin–Huxley 模型与电导型突触的基底神经节小规模网络在给定连接拓扑与外源输入下的群体动力学与统计指标",
          "expected_output": "可复现实验代码与模型配置文件（网络拓扑、权重、延迟、种子）、神经元与突触电流时间序列、峰时刻列表、核团LFP代理、群体指标表（放电率、ISI-CV、Kuramoto、互相关、功率谱与β能量、丘脑转导可靠度）、参数敏感性分析报表与图表",
          "key_inputs_constraints": "输入：附件1的HH单元与突触（AMPA/NMDA/GABA_A）参数；BG连接矩阵W与概率p∈[0.2,0.8]、权重分布（如对数正态）与延迟1–10 ms；核团规模各5–10点神经元；外源皮层Poisson或时变速率r(t)；求解器设置dt=0.01–0.05 ms、仿真≥10 s、N_seed≥20。约束：准确实现电导式反转电位E_exc≈0 mV、E_inh≈−70 mV及时间常数范围；记录随机种子与所有配置以可重现；平台需支持突触延迟。",
          "modeling_type": "仿真+评价",
          "role_in_pipeline": "作为网络层建模与基线生成环节：前序依赖子任务1的单细胞HH实现与特征提取；后续为病理状态对比、DBS参数优化与目标选择提供基线与参数化依据。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "识别仿真目标与对象（BG网络+HH+电导突触）",
              "description": "明确该任务是对包含Cortex/dMSN/iMSN/GPe/STN/GPi-SNr/Thalamus且含SNc调节项的BG网络进行仿真与评估，而非单细胞或统计模型。",
              "score": 25,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：点出全部核团与SNc调节项并强调电导突触与延迟；中分：少量遗漏核团或未提延迟；低分：将任务误解为单细胞或非HH模型。"
            },
            {
              "sub_criteria": "识别关键约束（dt、仿真时长、N_seed≥20）",
              "description": "指出需要dt≈0.01–0.05 ms、仿真≥10 s、每组参数至少20个随机种子以获得稳态和统计置信。",
              "score": 25,
              "evaluation_focus": "约束把握",
              "scoring_hint": "高分：同时覆盖dt、时长、N_seed并给出理由；中分：覆盖其二；低分：缺失或给出与任务冲突的设置。"
            },
            {
              "sub_criteria": "识别输出指标（放电率、ISI-CV、Kuramoto、β能量、丘脑转导）",
              "description": "点明需计算群体平均放电率、ISI的CV、同步性（Kuramoto或互相关）、功率谱及13–30 Hz β带能量、丘脑转导可靠度。",
              "score": 25,
              "evaluation_focus": "指标框定",
              "scoring_hint": "高分：列全并说明计算窗口/稳态剔除；中分：缺1–2项；低分：仅口头描述或未对应β带。"
            },
            {
              "sub_criteria": "识别可重现性要求（随机种子与配置存档）",
              "description": "要求保存随机种子、连接矩阵W、权重与延迟、求解器设置与输出格式以保证复现。",
              "score": 25,
              "evaluation_focus": "实验规范",
              "scoring_hint": "高分：明确文件内容与元数据；中分：仅提保存种子或配置之一；低分：无复现考虑。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "复述核心目标（仿真+评价BG网络群体动力学）",
              "description": "用任务词重述：基于附件1 HH与电导突触，仿真并评价BG小网络的群体动力学与统计特征。",
              "score": 30,
              "evaluation_focus": "表达准确",
              "scoring_hint": "高分：含“附件1”“HH”“电导突触”“BG网络”；中分：缺1关键词；低分：目标偏离仿真+评价。"
            },
            {
              "sub_criteria": "复述输入与拓扑（W、p、延迟、权重分布）",
              "description": "明确连接采用概率连接p∈[0.2,0.8]、延迟1–10 ms、权重按指定分布抽样。",
              "score": 35,
              "evaluation_focus": "要素覆盖",
              "scoring_hint": "高分：覆盖p区间、延迟范围与分布类型；中分：缺区间数值；低分：未提概率连接或延迟。"
            },
            {
              "sub_criteria": "复述输出与统计（N_seed与置信区间）",
              "description": "说明每组参数N_seed≥20并输出均值、标准误或置信区间。",
              "score": 35,
              "evaluation_focus": "结果规范",
              "scoring_hint": "高分：明确CI或SEM计算方法；中分：仅提均值方差；低分：未提多次仿真统计。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "核团规模与外源输入假设（5–10个/核团、Poisson或r(t)）",
              "description": "明确每核团5–10点神经元并说明皮层输入为Poisson或时变速率及参数范围。",
              "score": 30,
              "evaluation_focus": "建模假设",
              "scoring_hint": "高分：给出具体选择与理由；中分：给出范围无理由；低分：与要求不符或缺失。"
            },
            {
              "sub_criteria": "突触时间常数与反转电位假设（AMPA/NMDA/GABA_A）",
              "description": "在规定范围内设定τ_rise/τ_decay与E_exc≈0 mV、E_inh≈−70 mV并说明选择依据。",
              "score": 35,
              "evaluation_focus": "参数设定",
              "scoring_hint": "高分：列数值区间与所用值；中分：仅给典型值；低分：数值错误或未说明。"
            },
            {
              "sub_criteria": "SNc调制量参数化假设",
              "description": "明确SNc作为可参数化调节项（如调制Str通道电导或外加偏置）的实现与取值范围。",
              "score": 35,
              "evaluation_focus": "生理映射",
              "scoring_hint": "高分：给出具体映射与范围；中分：仅口述调制作用；低分：忽略SNc。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "单元与突触子模块实现（附件1 HH+电导型AMPA/NMDA/GABA_A）",
              "description": "严格按附件1实现HH及电导突触动力学，并通过单元/突触时程响应单元测试。",
              "score": 30,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：展示测试脉冲响应/IV曲线对齐文献；中分：仅基本运行；低分：模型方程与附件不符。"
            },
            {
              "sub_criteria": "拓扑与连接矩阵W构造（概率连接p与延迟1–10 ms）",
              "description": "按经典BG拓扑生成W，记录p、权重分布与延迟，并导出邻接矩阵与元数据。",
              "score": 30,
              "evaluation_focus": "结构设计",
              "scoring_hint": "高分：提供可视化或摘要统计；中分：仅生成无校验；低分：缺关键投射或不成连通。"
            },
            {
              "sub_criteria": "权重采样与再现性（对数正态/均匀+随机种子）",
              "description": "权重按指定分布抽样并固定随机种子，保存配置以复现。",
              "score": 20,
              "evaluation_focus": "实验规范",
              "scoring_hint": "高分：记录种子并存档分布参数；中分：仅固定种子；低分：随机不可复现。"
            },
            {
              "sub_criteria": "LFP代理定义与核团汇总信号",
              "description": "定义核团级LFP代理（如突触总电流或膜电位平均）并统一单位与采样率。",
              "score": 20,
              "evaluation_focus": "指标设计",
              "scoring_hint": "高分：说明选择理由与滤波；中分：仅给平均值；低分：未提供群体信号。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "数值积分设置（dt=0.01–0.05 ms，支持延迟）",
              "description": "选择支持突触延迟的平台（Brian2/NEURON/NEST/MATLAB），设置合适dt并验证稳定性。",
              "score": 30,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：给出步长敏感性检查；中分：仅设置dt；低分：dt不合适或不支持延迟。"
            },
            {
              "sub_criteria": "仿真时长与稳态剔除（≥10 s）",
              "description": "总时长≥10 s，明确定义初始瞬态剔除窗口并用于统计与谱分析。",
              "score": 25,
              "evaluation_focus": "数值稳定",
              "scoring_hint": "高分：给具体剔除比例/秒数；中分：模糊提及；低分：未剔除瞬态。"
            },
            {
              "sub_criteria": "多种子重复与并行（N_seed≥20）",
              "description": "每组参数至少20个种子，合理使用并行并汇总统计量。",
              "score": 25,
              "evaluation_focus": "计算实现",
              "scoring_hint": "高分：报告加速与种子列表；中分：N_seed不足或无并行；低分：单次运行。"
            },
            {
              "sub_criteria": "数据完整保存（V、峰时、突触电流、配置）",
              "description": "保存膜电位、门控可选、峰时刻、突触电流时间序列及完整配置与求解器设置。",
              "score": 20,
              "evaluation_focus": "工程规范",
              "scoring_hint": "高分：带版本与单位；中分：部分缺失；低分：无法重算指标。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "附件1参数与方程一致性测试",
              "description": "提供自动化单元测试比对附件1电导、反转电位、门控方程与数值范围。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：测试覆盖通道与突触；中分：少量断言；低分：无测试或不一致。"
            },
            {
              "sub_criteria": "可配置性与重现（随机种子、W、p、分布、dt）",
              "description": "通过配置文件/CLI参数设置网络规模、p、分布参数、dt、时长与种子，并固化输出目录结构。",
              "score": 25,
              "evaluation_focus": "工程实现",
              "scoring_hint": "高分：提供schema与校验；中分：可配置但无校验；低分：硬编码。"
            },
            {
              "sub_criteria": "性能与内存管理（事件驱动/稀疏结构）",
              "description": "使用稀疏连接、事件驱动突触或批量矢量化，支撑≥10 s×N_seed运行。",
              "score": 25,
              "evaluation_focus": "效率优化",
              "scoring_hint": "高分：展示复杂度与用时；中分：可运行但慢；低分：内存溢出或难以完成。"
            },
            {
              "sub_criteria": "数据格式与元数据（采样率、单位、版本）",
              "description": "输出包含采样率、单位、版本、求解器设置与依赖版本，便于下游使用。",
              "score": 20,
              "evaluation_focus": "数据工程",
              "scoring_hint": "高分：机器可读元数据；中分：文本记录不完整；低分：无元数据。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "群体指标计算正确性（放电率、ISI-CV、burst）",
              "description": "按峰时刻与窗口正确计算放电率、ISI-CV与簇发放率，并报告均值与CI。",
              "score": 30,
              "evaluation_focus": "统计实现",
              "scoring_hint": "高分：阈值/窗口说明清楚并重算一致；中分：缺CI或方法模糊；低分：计算错误。"
            },
            {
              "sub_criteria": "同步性与相关性（Kuramoto/互相关）",
              "description": "计算Kuramoto指数或平均互相关，说明相位提取方法与带宽设置。",
              "score": 20,
              "evaluation_focus": "方法选择",
              "scoring_hint": "高分：明确定义相位与滤波；中分：仅给结果；低分：指标不当或无法复现。"
            },
            {
              "sub_criteria": "频谱与β带能量（13–30 Hz）",
              "description": "使用Welch或STFT在稳态段估计功率谱并量化β带能量，含参数报告。",
              "score": 25,
              "evaluation_focus": "信号分析",
              "scoring_hint": "高分：报告窗长、重叠、频率分辨率；中分：仅图无参数；低分：未聚焦β带或谱不可信。"
            },
            {
              "sub_criteria": "丘脑转导可靠度与网络解释",
              "description": "定义并计算Thalamus转导可靠度（输入-输出匹配/相干），并解释在拓扑与参数下的变化。",
              "score": 25,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：清晰定义度量与不确定性；中分：给出趋势无定义；低分：缺该指标或解释不当。"
            }
          ]
        }
      }
    },
    "3": {
      "subtask": "在本子任务中，目标是对给定的帕金森病（PD）基底神经节网络模型（即已配置的网络拓扑、细胞与突触参数和 PD 状态参数化）系统化地建立并比较两类可操作的 DBS 表征模型、在统一评价指标下对候选靶点（至少包括 STN 与 GPi，并可扩展至 GPe、SNr 或穿行轴突）进行参数扫掠与多目标优化，以产生可重复、鲁棒的最优刺激参数集与 Pareto 折衷解；为此需完成如下具体步骤与方法：一）输入与数值设定：以子任务 2 输出的网络配置文件为输入（包含每个神经元的动力学参数、突触矩阵与延迟、外源皮层输入设定及 LFP 代理定义），数值求解器建议使用能处理刚性 ODE 的工具（例如 Brian2/NEURON 或 MATLAB + CVODE），时间步 dt 取 0.01–0.05 ms，单次仿真时长建议 ≥10 s（达到稳态统计），每组参数至少用 N_seed≥20 个随机种子重复以估计均值与不确定度；二）DBS 表征模型：实现兩种可替代但互补的简化实现——(A) 膜注入模型：对靶区细胞体/胞体群直接注入周期性电流脉冲 I_DBS(t)=A·∑_k p(t−kT)，参数空间 f∈[20,200]Hz、A 从阈值至安全上限（按每细胞阈值或文献电流范围设定）、脉宽 τ_pw∈[0.05,0.5] ms、波形可选单相/双相/矩形；(B) 轴突激活近似：将 DBS 视作周期性激发穿行轴突，等价地在被激活单元的下游注入短时突触事件或强迫发放，模拟远端轴突驱动效应；对每种模型实现多种刺激模式（连续高频、burst、带抖动高频/随机化间隔）；三）评价指标与度量方法：用统一、可量化的目标向量 J(θ) 评估每个仿真配置，包括：β_band_power（13–30 Hz 带在核团 LFP 代理上的绝对或归一化功率，采用 Welch 法估算，窗长建议 1 s、50% 重叠）、thalamic_relay_fidelity（定义为皮层触发后在预设时间窗内成功诱发丘脑/下游有效响应的比例）、群体同步度（Kuramoto 或平均互相关）、放电统计（平均放电率、CV(ISI)、burst 指数）、以及能量/安全代理（如平均脉冲能量或单位时间内脉冲电荷）；并对过度抑制（丘脑响应率低于阈值）施加惩罚项确保临床可接受性；四）参数探索與优化流程：先用粗网格或拉丁超立方/ Sobol 抽样在参数空间做 100–300 次仿真以构建训练数据集，基于此训练代理模型（高斯过程回归或随机森林），然后在代理上用贝叶斯优化或多目标进化算法（例如 NSGA‑II）搜索 Pareto 最优集，對候选最优参数在真实仿真上复核并以多随机种子评估其稳健性；五）约束与安全边界：在优化中施加物理/临床约束——单脉冲峰电流/电荷上限、平均功率上限、频率/脉宽范围限制，并在代理训练与验证阶段显式包含这些约束；六）稳健性与敏感度检验：对优化所得解做局部灵敏度分析与蒙特卡洛验证（变动关键生理参数如突触权重、延迟与膜电导）以评估对参数不确定性的鲁棒性；七）输出要求：对每个靶点分别产出（a）参数—性能曲面或 Pareto 前沿，（b）经真实仿真验证并含不确定度的候选最优参数（频率、幅度、脉宽、模式），以及（c）基于相同评价指标的靶点效能比较报告；八）工具与可复现性：推荐使用支持并行批量仿真的平台（Brian2/NEURON、MATLAB 并行工具箱），并保存完整仿真种子、输入网络配置与结果数据表，确保后续可重现与进一步验证。以上步骤应独立于其它子任务的分析结果、仅以网络模型配置和 PD 状态为输入，确保该子任务的实施流程、评价标准与优化方法精确且可执行。",
      "criteria": {
        "task_understanding": {
          "core_goal": "在已给定的 PD 基底神经节网络上仿真并评估两类 DBS 表征模型，进行参数扫掠与多目标优化以寻找 STN 与 GPi 等靶点的最优刺激参数及 Pareto 折衷解，降低β_band_power并提升thalamic_relay_fidelity等指标。",
          "expected_output": "批量仿真结果数据表（含参数与J(θ)各子指标）、Pareto 前沿图与参数—性能曲面、各靶点的候选最优参数集（频率/幅度/脉宽/模式）及置信区间、优化与稳健性报告、可复现实验代码与配置、随机种子与求解器设置记录。",
          "key_inputs_constraints": "输入：子任务2输出的网络配置（细胞/突触参数、连接矩阵W、延迟、外源皮层输入、LFP代理定义）；DBS参数空间：f∈[20,200]Hz、τ_pw∈[0.05,0.5]ms、A（不超过电流/电荷/功率安全上限）；仿真设置：dt=0.01–0.05ms、时长≥10s、N_seed≥20；约束：丘脑过度抑制惩罚、物理/临床上限、代理模型需显式包含约束；输出需包含随机种子与参数元数据。",
          "modeling_type": "仿真+优化+评价",
          "role_in_pipeline": "作为DBS策略设计与比较环节：前序依赖子任务2的网络实现与PD状态参数化；后序将输出的最优/折衷参数用于网络层验证与论文图表、并为后续临床可行性讨论与更大规模网络仿真提供基线。",
          "assumptions": "若附件1未给出安全电流上限，按常见DBS文献设定每脉冲电荷≤30 µC/cm^2等代理上限；若未提供LFP代理，采用核团膜电位均值或总突触电流作为代理。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "明确两类DBS表征模型（膜注入与轴突激活近似）的评估目标",
              "description": "是否将膜注入模型与轴突激活近似并列纳入评估，且指出它们在PD BG网络中对β_band_power与thalamic_relay_fidelity的不同作用路径。",
              "score": 35,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：清楚区分两模型介入部位与效应指标；中分：提及两模型但未关联指标；低分：仅使用单一模型或未说明差异。"
            },
            {
              "sub_criteria": "识别优化对象与约束（Pareto、能量/安全上限、过度抑制惩罚）",
              "description": "是否同时最小化β_band_power、同步度并最大化thalamic_relay_fidelity，且包含电流/电荷/功率上限与惩罚项。",
              "score": 35,
              "evaluation_focus": "目标设定",
              "scoring_hint": "高分：列出具体约束与惩罚函数；中分：只口头提及安全约束；低分：忽略约束或单目标。"
            },
            {
              "sub_criteria": "识别参数空间与仿真要求（f, A, τ_pw, 模式, dt, 时长, N_seed）",
              "description": "是否覆盖20–200 Hz、0.05–0.5 ms、幅度至安全上限、多模式（连续高频、burst、抖动）及dt、仿真时长、N_seed重复。",
              "score": 30,
              "evaluation_focus": "实验设计",
              "scoring_hint": "高分：参数边界与重复数完整；中分：缺少一种模式或边界模糊；低分：参数与数值设定不全或不合规。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "用J(θ)目标向量复述评价指标",
              "description": "是否将β_band_power、thalamic_relay_fidelity、同步度、放电统计、能量/安全代理构造成明确的J(θ)并说明权衡。",
              "score": 40,
              "evaluation_focus": "表达与形式化",
              "scoring_hint": "高分：明确多目标及度量方法；中分：列出指标但无统一表达；低分：指标缺失或无多目标表述。"
            },
            {
              "sub_criteria": "复述靶点比较任务（STN vs GPi 可扩展至GPe/SNr）",
              "description": "是否明确需要在相同指标下比较STN与GPi并允许扩展其它靶点，输出效能比较报告。",
              "score": 30,
              "evaluation_focus": "任务边界",
              "scoring_hint": "高分：给出统一比较框架；中分：仅声明比较无细节；低分：未体现多靶点比较。"
            },
            {
              "sub_criteria": "复述数值设定（dt、≥10s、N_seed≥20、刚性ODE）",
              "description": "是否准确复述时间步、仿真时长、重复次数与求解器要求，强调稳态统计与不确定度估计。",
              "score": 30,
              "evaluation_focus": "数值规范",
              "scoring_hint": "高分：参数完整且合理；中分：缺少其一；低分：与要求不一致。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "安全约束与电荷/功率代理假设",
              "description": "是否明确单脉冲电流/电荷/功率上限与计算方法，若文献缺失给出合理代理值与来源。",
              "score": 35,
              "evaluation_focus": "约束建模",
              "scoring_hint": "高分：数值上限与公式清楚；中分：仅定性描述；低分：未设安全约束。"
            },
            {
              "sub_criteria": "LFP代理与thalamic_relay_fidelity计算假设",
              "description": "是否定义LFP代理（膜电位均值或突触总电流）与丘脑转导判据（时间窗、阈值）。",
              "score": 35,
              "evaluation_focus": "指标定义",
              "scoring_hint": "高分：窗长、阈值与检出算法明确；中分：给出思路未量化；低分：无定义。"
            },
            {
              "sub_criteria": "轴突激活近似细节",
              "description": "是否假设在下游注入短时突触事件或强迫发放并说明延迟、概率、幅度设定。",
              "score": 30,
              "evaluation_focus": "机制假设",
              "scoring_hint": "高分：事件统计与参数清晰；中分：描述笼统；低分：未实现该近似。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "DBS波形生成与模式实现（连续/burst/抖动）",
              "description": "是否实现单相/双相矩形脉冲，参数化f、A、τ_pw与burst占空比、抖动分布。",
              "score": 30,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：多模式可切换且参数化完整；中分：缺少一种模式；低分：仅固定波形。"
            },
            {
              "sub_criteria": "两类DBS模型嵌入BG网络（膜注入与轴突事件）",
              "description": "是否在STN/GPi节点正确注入电流或生成下游突触事件/强迫发放，兼容延迟与多靶点。",
              "score": 30,
              "evaluation_focus": "系统集成",
              "scoring_hint": "高分：可切换靶点和模型；中分：仅支持单靶点或单模型；低分：集成错误。"
            },
            {
              "sub_criteria": "统一评价管线与J(θ)计算",
              "description": "是否按Welch功率谱（窗1s、50%重叠）计算β_band_power，Kuramoto/互相关同步度，CV(ISI)、burst指数，能量代理。",
              "score": 25,
              "evaluation_focus": "指标实现",
              "scoring_hint": "高分：实现与参数匹配要求；中分：部分指标缺失；低分：无统一计算。"
            },
            {
              "sub_criteria": "约束编码与惩罚项",
              "description": "是否对电流/电荷/功率与过度抑制加入硬约束或惩罚并记录触发情况。",
              "score": 15,
              "evaluation_focus": "约束处理",
              "scoring_hint": "高分：硬/软约束齐备；中分：仅口头说明；低分：无约束。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "数值稳定性（dt=0.01–0.05ms、≥10s、刚性ODE）",
              "description": "是否选择合适求解器（BDF/CVODE或等效）与时间步，保证脉宽解析与稳态统计。",
              "score": 30,
              "evaluation_focus": "数值方法",
              "scoring_hint": "高分：稳定且无走样；中分：边界设置粗糙；低分：数值不稳定或解析不足。"
            },
            {
              "sub_criteria": "重复与不确定度（N_seed≥20）",
              "description": "是否进行至少20个随机种子重复并输出均值、置信区间/标准误。",
              "score": 30,
              "evaluation_focus": "统计估计",
              "scoring_hint": "高分：满足N_seed并报告CI；中分：少量重复或仅均值；低分：无重复。"
            },
            {
              "sub_criteria": "参数探索与优化（LHS/Sobol+代理+NSGA-II/贝叶斯）",
              "description": "是否先粗采样构建训练集，再用GPR/RF代理与多目标优化搜索Pareto，并回代真实仿真复核。",
              "score": 40,
              "evaluation_focus": "优化策略",
              "scoring_hint": "高分：三阶段流程完整且复核；中分：任一环节缺失；低分：仅网格或手调，无Pareto。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "可复现实验管线（随机种子、配置与日志）",
              "description": "是否保存随机种子、求解器设置、输入网络配置、参数与结果到结构化文件并可一键重跑。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：配置+结果版本化；中分：部分记录；低分：不可复现。"
            },
            {
              "sub_criteria": "批量并行仿真调度与资源管理",
              "description": "是否实现并行运行（Brian2/NEURON/MATLAB并行），带失败重试与进度/错误日志。",
              "score": 25,
              "evaluation_focus": "工程实现",
              "scoring_hint": "高分：稳定并行与容错；中分：可并行但脆弱；低分：串行且不稳定。"
            },
            {
              "sub_criteria": "指标计算与可视化输出（β功率、Pareto、曲面）",
              "description": "是否产出Welch谱、β带能量、Pareto前沿和参数—性能曲面图与表格导出。",
              "score": 25,
              "evaluation_focus": "工具实现",
              "scoring_hint": "高分：图表与数据齐全；中分：缺少其一；低分：无可视化或导出。"
            },
            {
              "sub_criteria": "约束与惩罚的程序化校验",
              "description": "是否在运行时检查电流/电荷/功率与丘脑抑制阈值并记录违规与剪切操作。",
              "score": 20,
              "evaluation_focus": "健壮性",
              "scoring_hint": "高分：自动校验与审计日志；中分：部分检查；低分：未实现。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "靶点效能比较（STN vs GPi，统一J(θ)）",
              "description": "是否在相同条件下比较STN与GPi，报告β_band_power、thalamic_relay_fidelity、同步度与能量代理差异。",
              "score": 35,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：定量对比与统计显著性；中分：定性描述；低分：未比较或不一致。"
            },
            {
              "sub_criteria": "Pareto前沿与折衷解解读",
              "description": "是否给出Pareto前沿、标注候选解，并解释β抑制与丘脑传导之间的权衡与选择理由。",
              "score": 30,
              "evaluation_focus": "多目标权衡",
              "scoring_hint": "高分：清晰前沿与选择标准；中分：展示前沿无解读；低分：无Pareto。"
            },
            {
              "sub_criteria": "稳健性与敏感度（参数扰动与蒙特卡洛）",
              "description": "是否对最优解做局部灵敏度与蒙特卡洛验证（突触权重、延迟、膜电导），报告性能区间变化。",
              "score": 25,
              "evaluation_focus": "稳健性评估",
              "scoring_hint": "高分：系统性扰动与区间呈现；中分：少量扰动；低分：无稳健性分析。"
            },
            {
              "sub_criteria": "临床/物理约束合规性复核",
              "description": "是否验证候选参数满足电流/电荷/功率上限与不过度抑制（丘脑响应率≥阈值）。",
              "score": 10,
              "evaluation_focus": "规范合规",
              "scoring_hint": "高分：逐项合规清单；中分：部分检查；低分：违规未指出。"
            }
          ]
        }
      }
    },
    "4": {
      "subtask": "子任务4（数值实现、验证、灵敏度/不确定性量化、计算资源估算与扩展规划）的目标是把已定义的Hodgkin–Huxley点神经元与突触耦合网络数值化为可复现、高精度并可并行化的仿真与分析流水线，明确数值方法、数据输入/输出规范、统计与不确定性分析流程、加速策略与触发扩展的判据，从而为后续的大规模参数扫描与优化提供可靠基础；为此必须按以下精确规范实施：在数值求解上优先使用能处理刚性问题的求解器（如SUNDIALS/CVODE BDF或在NEURON中使用内建刚性求解器）以保证在包含快速电位上升与短脉冲刺激时的稳定性，若采用显式方法则应使用高阶RK（如RK4）并严格限定时间步dt以解析最短时间尺度——推荐基于最小通道时间常数和最短脉冲宽度自动选择dt，通常取0.01–0.02 ms（脉冲宽度≤0.1 ms时取更小dt）；所有求解器相关设定（相对/绝对容差、dt、最大步长）须记录入仿真配置文件。输入数据包括网络配置（神经元参数、突触类型/时间常数、连接概率与权重分布、延迟矩阵）、外源驱动定义与随机种子集合；仿真输出应以压缩且自描述格式（推荐HDF5）保存：每次仿真存储时间向量、每个细胞的膜电位时间序列（可按需子采样并保留完整数据对照）、门控变量（按需）、每条突触的瞬时电流、峰时点（spike times）、以及事先定义的核团LFP代理（例如群体突触电流和膜电位均值）；每个输出文件必须包含完整的元数据（仿真ID、随机种子、求解器设置、参数快照与代码版本）。为统计稳健性，任一参数配置下的重复仿真次数应不小于N_seed=20–30，并对每组结果计算均值、标准差与95%置信区间；功率谱估计采用Welch方法（建议窗长1 s、50%重叠，或按分析窗必要性调整），时间-频率分析采用短时傅里叶或多窄带小波，并用群体统计（例如非参数置换检验或FDR校正）评估条件差异。不确定性与敏感度分析分两层：局部灵敏度通过一阶偏导或有限差分评估主要参数（离子电导、关键突触权重、延迟、外源速率）对输出指標的敏感性；全局灵敏度采用Morris筛选或Sobol方差分解（Sobol）以定量分配方差貢獻，若参数维数高先用Morris降维再对关键参数做Sobol；为得到可靠Sobol指数，样本量按参数数目扩展（典型在数千到上万次模型评估，视维度而定）。鉴于直接全参数仿真计算代价高，建议先用拉丁超立方或Sobol序列做100–300个高维采样训练集以构建代理模型（高斯过程回归或随机森林），在代理上进行贝叶斯优化或多目标进化（如NSGA‑II）搜索并在真实仿真上对候选解做验证与额外重复；代理模型训练应采用交叉验证并把代理误差阈值（例如相对误差<10%或RMSE小于目标指标变异的1/3）作为停止准则。并行化与资源管理方面，参数扫描与重复仿真应实现“嵌入式并行性”——使用多进程/多线程（Python multiprocessing、Dask）或在集群上通过作业数组（SLURM/HTCondor）分发独立任务，单次仿真（示例：60 s生物时间、60个神经元、dt=0.02 ms）在一核CPU上预估耗时约数十秒到数分钟；因此数百到上千次仿真需通过并行（例如100核并行）或代理加速来完成，必要时使用Brian2的CUDA后端或NEURON+CoreNEURON在GPU上加速。为保证可复现性，所有代码与配置应纳入版本控制（Git），并提供可执行环境快照（Docker或Singularity容器），仿真脚本应自动记录时间戳、Git提交哈希与依赖包版本。验证流程应包括：单元测试（单细胞在已知刺激下产生可比f–I曲线与AP形态）、网络级别基本不变量检查（质量控制：电荷守恒、无未定义NaN）、以及统计一致性检查（重复种子间指标方差在可接受范围内）。扩展判据明确化：当灵敏度或优化结果对空间电场分布或轴突选择性高度敏感（代理模型预测的局部最优对小幅空间参数变动不稳健）时，应触发更高保真扩展——即整合多节段轴突模型与外部电场（FEM解）以评估激活函数，但该扩展仅在明确显示空间效应可能改变结论时实施。最后规定输出与报告规范：每次完成的不确定性分析或优化实验必须提交包含（1）仿真配置与代码版本（2）原始与派生数据文件路径（3）统计汇总表（均值、置信区间、样本数）和（4）敏感度/Sobol结果与代理模型性能指标，以便同行审查与后续复现。",
      "criteria": {
        "task_understanding": {
          "core_goal": "实现、验证并量化一个可复现且可并行化的 Hodgkin–Huxley 点神经元与突触耦合网络数值仿真流水线，并估算计算资源与触发高保真扩展的判据",
          "expected_output": "可执行仿真代码仓库（含 Docker 容器）、仿真配置文件、HDF5 格式原始时程与派生指标文件、单元与网络级验证报告、不确定性/灵敏度分析结果、代理模型与优化/并行资源估算报告",
          "key_inputs_constraints": "1) 网络配置文件（神经元参数、突触类型/时间常数、连接矩阵、延迟矩阵、外源驱动），2) 求解器设置与数值约束（指定 CVODE/BDF 或显式 dt 范围、相对/绝对容差），3) 随机种子集合与重复次数规范（N_seed≥20–30），4) 输出格式约束（HDF5，需包含完整元数据），5) 计算资源边界（可用 CPU/GPU 核心数及内存上限），",
          "modeling_type": "仿真+验证+不确定性量化",
          "role_in_pipeline": "作为子任务2/子任务3 的数值化与验证环节：依赖子任务2（网络配置与单元参数），输出被子任务3（DBS 参数扫描/优化）直接使用；同时为后续高保真扩展（多节段轴突+FEM 电场）提供触发判据与资源估算"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "识别刚性数值求解需求与求解器（CVODE/BDF 或 RK4+dt 策略）",
              "description": "明确指出 HH 模型在快速上升相与短脉冲下的刚性问题，列出至少一种刚性求解器与显式方法及自动 dt 选择规则（基于最小通道时间常数与最短脉冲宽度）。",
              "score": 30,
              "evaluation_focus": "数值判断",
              "scoring_hint": "高分：给出 CVODE/BDF 优先级并列出 dt 选择准则（例如脉冲≤0.1ms 时 dt≤0.01ms）；中分：仅给出求解器建议无自动 dt 规则；低分：未识别刚性或未给出求解器。"
            },
            {
              "sub_criteria": "识别输入/输出数据与元数据规范（HDF5）",
              "description": "明确规定仿真输出格式为 HDF5，需包含时间向量、每细胞 V(t)、峰时点、突触电流、仿真ID、随机种子与求解器设置等元数据字段。",
              "score": 25,
              "evaluation_focus": "数据规范",
              "scoring_hint": "高分：提供完整 HDF5 结构示例并覆盖所有元数据；中分：列出主要字段但缺少部分元数据；低分：仅笼统说明输出无结构细则。"
            },
            {
              "sub_criteria": "识别重复与随机性规范（N_seed 和统计稳健性）",
              "description": "明确 N_seed 下限（≥20–30），并说明需报告均值、标准差与95%置信区间，且保存每次随机种子以保证复现。",
              "score": 20,
              "evaluation_focus": "统计设计",
              "scoring_hint": "高分：明确 N_seed≥20 且给出置信区间计算方法；中分：给出 N_seed 但无置信区间说明；低分：未指定重复次数或无复现要求。"
            },
            {
              "sub_criteria": "识别并行化与资源估算需求（并行策略与单次仿真时间估计）",
              "description": "识别需使用作业数组或多进程并行，对典型单次仿真（示例：60 s、60 细胞、dt=0.02 ms）给出在单核与多核/ GPU 下的时间估算范围。",
              "score": 25,
              "evaluation_focus": "资源规划",
              "scoring_hint": "高分：给出具体单核耗时估计与并行扩展策略（如100核并行），并估算总任务时长；中分：给出单核估计但并行细节不足；低分：无时间/并行估计。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "复述核心目标：实现可复现并行化仿真流水线",
              "description": "用任务特定术语复述需‘实现、验证并量化可复现且可并行化的 HH 网络仿真流水线’并说明主要交付物（代码、HDF5、报告）。",
              "score": 40,
              "evaluation_focus": "目标对齐",
              "scoring_hint": "高分：精确复述目标并列出三项交付物；中分：复述目标但遗漏交付物细节；低分：复述笼统且未提可复现/并行。"
            },
            {
              "sub_criteria": "明确数值边界与精度要求（dt、时长、容差）",
              "description": "明确给出 dt 选择范围（0.01–0.02 ms 推荐）、仿真时长建议（≥10 s 或示例60 s）、相对/绝对容差与最大步长限制等数值边界。",
              "score": 30,
              "evaluation_focus": "数值规范",
              "scoring_hint": "高分：列出具体 dt、容差与仿真时长并解释选择理由；中分：给出部分数值但无理由；低分：未给出具体数值。"
            },
            {
              "sub_criteria": "明确扩展触发条件（何时需高保真轴突+FEM 扩展）",
              "description": "陈述触发扩展的判据（例如代理模型对空间参数敏感、最优解对微小空间变动不稳健）并说明扩展所需额外输入（多节段轴突、FEM 网格）。",
              "score": 30,
              "evaluation_focus": "扩展规划",
              "scoring_hint": "高分：给出量化触发阈值与所需新数据清单；中分：描述触发情形但无量化阈值；低分：未描述扩展触发条件。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "明确生物/模型假设（点神经元可替代多节段）",
              "description": "列出生理假设（如点神经元近似、可忽略空间电场或外周电荷分布）并说明适用范围与限制。",
              "score": 35,
              "evaluation_focus": "生物假设",
              "scoring_hint": "高分：列举至少三条假设并说明何种情形下不成立；中分：列出假设但缺限制说明；低分：未明确或不合理假设。"
            },
            {
              "sub_criteria": "数值近似假设（刚性求解或显式 dt 近似）",
              "description": "说明对数值方法的假设（例如采用 CVODE 可处理刚性，显式 RK4 需 dt 控制），并给出误差控制策略与稳定性保证措施。",
              "score": 35,
              "evaluation_focus": "数值假设",
              "scoring_hint": "高分：给出误差控制与稳定性检测方法（如步长限制、残差检查）；中分：给出方法无检测策略；低分：无数值假设或不一致。"
            },
            {
              "sub_criteria": "统计与代理建模假设（独立重复与代理误差阈值）",
              "description": "说明随机性假设（实验重复独立）与代理模型可接受误差（如相对误差<10% 或 RMSE<目标变异1/3）与交叉验证策略。",
              "score": 30,
              "evaluation_focus": "统计假设",
              "scoring_hint": "高分：给出明确代理误差阈值与验证方法；中分：给出代理训练方案但无误差阈值；低分：未说明代理假设。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "实现刚性求解器设置与自适应 dt 规则（涉及 CVODE/BDF 或 RK4）",
              "description": "给出求解器参数（相对/绝对容差、最大步长）、显式方法的 dt 选择准则以及在短脉冲场景下的特别处理（脉冲内子步长等）。",
              "score": 30,
              "evaluation_focus": "数值实现",
              "scoring_hint": "高分：提供完整求解器配置文件与自动 dt 算法；中分：给出部分配置但无自动化规则；低分：配置模糊或不适合刚性问题。"
            },
            {
              "sub_criteria": "数据 I/O 与元数据规范（HDF5 存储与子采样策略）",
              "description": "定义 HDF5 组织结构、必要元数据字段、子采样策略（何时保存全时程或降采样）及压缩策略以平衡存储与可复现性。",
              "score": 25,
              "evaluation_focus": "数据工程",
              "scoring_hint": "高分：给出 HDF5 数据模式示例与子采样规则；中分：列出要保存字段但无示例；低分：无完整 I/O 规范。"
            },
            {
              "sub_criteria": "不确定性与灵敏度分析设计（Morris -> Sobol 路线图与样本估算）",
              "description": "制定两层不确定性分析流程：先 Morris 筛选降维，再对关键参数执行 Sobol，并提供样本量估算与计算成本预估。",
              "score": 25,
              "evaluation_focus": "不确定性设计",
              "scoring_hint": "高分：给出 Morris/Sobol 参数、样本量与计算代价估计；中分：方法正确但无样本量估计；低分：无分层灵敏度方案。"
            },
            {
              "sub_criteria": "代理模型构建与性能准则（训练数据、误差阈值）",
              "description": "说明用于加速的代理（如 GPR/随机森林）训练集构建方式（拉丁超立方或 Sobol 采样 100–300 次）及代理性能停止准则（相对误差<10%）。",
              "score": 20,
              "evaluation_focus": "代理建模",
              "scoring_hint": "高分：给出采样策略、模型类型与交叉验证准则；中分：提出代理但无采样细节；低分：无代理或不合理阈值。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "仿真复现性与随机种子管理（N_seed 重复与 CI 报告）",
              "description": "在求解流程中实现自动化重复（N_seed≥20–30）、记录每次随机种子并对每个指标计算均值、标准差与 95% 置信区间。",
              "score": 25,
              "evaluation_focus": "复现性",
              "scoring_hint": "高分：自动化执行多种子仿真并输出置信区间；中分：手动重复但记录不全；低分：无重复或无随机种子记录。"
            },
            {
              "sub_criteria": "数值稳定性检测与验证流程（单细胞 f–I 与 AP 形态检查）",
              "description": "实施单元测试：单细胞在标准刺激下应重现 f–I 曲线与动作电位形态；网络级检查包括无 NaN、电荷守恒等质量控制准则。",
              "score": 30,
              "evaluation_focus": "验证",
              "scoring_hint": "高分：包含自动单元与网络质控并通过示例验证；中分：有部分测试但缺网络级质控；低分：无验证或未通过基本测试。"
            },
            {
              "sub_criteria": "并行化执行与性能估算（作业数组/多进程/GPU）",
              "description": "实现并行任务分发策略（如 SLURM 作业数组或 Dask），并提供单次仿真在不同硬件下的时间剖面与扩展效率估计。",
              "score": 25,
              "evaluation_focus": "性能工程",
              "scoring_hint": "高分：实现并行化且给出扩展效率曲线；中分：实现并行但无性能估计；低分：无并行实现或不可扩展。"
            },
            {
              "sub_criteria": "代理模型候选解的真实仿真复核",
              "description": "对代理预测的候选参数在真实仿真上复核并以多随机种子评估稳健性，报告代理偏差与复核结果。",
              "score": 20,
              "evaluation_focus": "模型复核",
              "scoring_hint": "高分：对所有候选均做真实仿真验证并报告误差；中分：仅验证部分候选；低分：未验证候选或无报告。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "代码可复现性与版本控制（Git 与容器 Docker）",
              "description": "提供 Git 仓库与至少一个可执行容器（Docker/Singularity），并在输出报告中记录 Git 提交哈希与容器镜像标签。",
              "score": 35,
              "evaluation_focus": "工程可靠性",
              "scoring_hint": "高分：提供可运行容器、Git 哈希与构建说明；中分：有代码与版本说明但无容器；低分：无版本控制或不可复现代码。"
            },
            {
              "sub_criteria": "仿真配置自动化脚本与日志记录（求解器设置、随机种子）",
              "description": "实现参数化仿真脚本，可通过配置文件启动，并自动记录求解器参数、随机种子、仿真ID与运行时日志。",
              "score": 30,
              "evaluation_focus": "自动化",
              "scoring_hint": "高分：完整自动化并生成详尽日志；中分：部分自动化但需手动干预；低分：无自动化或日志不足。"
            },
            {
              "sub_criteria": "并行/分布式实现与容错（作业失败重试策略）",
              "description": "实现并行调度接口并支持任务失败检测与重试，说明集群作业数组配置示例（如 SLURM 脚本）。",
              "score": 20,
              "evaluation_focus": "分布式可靠性",
              "scoring_hint": "高分：包含容错重试与作业脚本示例；中分：并行但无容错；低分：并行不可用或无作业说明。"
            },
            {
              "sub_criteria": "单元测试与持续集成（单细胞与突触响应测试）",
              "description": "提供单元测试覆盖关键模块（单细胞 f–I、突触时程）并建议或实现 CI 流程以自动运行测试。",
              "score": 15,
              "evaluation_focus": "代码质量",
              "scoring_hint": "高分：单元测试齐全且集成 CI；中分：有测试但无 CI；低分：无测试或测试覆盖率极低。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "结果存储与元数据合规（HDF5 文件与完整元数据）",
              "description": "检验输出 HDF5 文件包含时间向量、每细胞 V、峰时点、突触电流、LFP 代理、仿真ID、随机种子与求解器设置等元数据并可直接用于后续分析。",
              "score": 25,
              "evaluation_focus": "数据合规",
              "scoring_hint": "高分：HDF5 完整且可直接加载并含元数据；中分：数据完整但元数据部分缺失；低分：输出不规范或数据难以复用。"
            },
            {
              "sub_criteria": "统计汇总与功率谱分析（置信区间与 Welch 设置）",
              "description": "按规范计算群体指标（均放电率、CV(ISI)、群体同步度）并用 Welch（窗长1s、50%重叠）估算功率谱，报告均值±95%CI 与统计显著性测试方法。",
              "score": 30,
              "evaluation_focus": "统计分析",
              "scoring_hint": "高分：所有指标含 95%CI 并说明 Welch 参数与显著性检验；中分：计算主要指标但无 CI 或未说明 Welch 参数；低分：无统计指标或无功率谱说明。"
            },
            {
              "sub_criteria": "灵敏度/Sobol 结果解释与决策支持（关键参数与方差贡献）",
              "description": "提供 Morris/Sobol 结果表与图，指出前 N 个关键参数及其 Sobol 一阶/总效应值，并基于此给出模型改进或实验优先级建议。",
              "score": 25,
              "evaluation_focus": "不确定性解读",
              "scoring_hint": "高分：给出关键参数列表、Sobol 指数与具体改进建议；中分：提供指数但无决策建议；低分：无或无法解读的灵敏度结果。"
            },
            {
              "sub_criteria": "扩展触发判断与计算资源报告（何时进行高保真扩展）",
              "description": "基于代理误差、灵敏度及最优解对空间参数敏感性，给出是否触发高保真扩展的明确判定，并提供所需增加的计算资源估算。",
              "score": 20,
              "evaluation_focus": "决策报告",
              "scoring_hint": "高分：提供量化触发阈值与资源清单（CPU/GPU/内存/预估工时）；中分：提出触发情形但无量化资源估算；低分：无触发判定或资源估算。"
            }
          ]
        }
      }
    }
  }
}