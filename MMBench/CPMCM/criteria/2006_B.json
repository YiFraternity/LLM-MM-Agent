{
  "task_id": "2006_B",
  "problem": "一：考虑航天器在仅受到地球万有引力、航天器自身发动机作用力的作用下作平面运动，将地球和航天器视为质点，试建立航天器运动的数学模型（只要列出模型，不要求解）。\n\n显然这样的数学模型在精度上是远远不能满足实际需要的，在其他要求精确制导等有关高科技的实际问题中，我们都面临着类似的问题：我们必须建立高精度的数学模型，必须高精度地估计模型中的大批参数，因为只有这样的数学模型才能解决实际问题，而不会出现差之毫厘，结果却失之千里的情况。这时所建立数学模型的精度就成了数学模型的生命线。例如上述问题中的航天器还要受到地球质量分布不均匀所引起的摄动力，大气阻力，日、月及其它星球的摄动引力的影响，以及航天器发动机为调整航天器自身姿态运作时作用力的影响。这样不但数学模型十分复杂，而且在这些数学模型中还要涉及到许多重要的参数，如地球的引力场模型就有许多待定参数。不仅如此，在对航天器进行测量时，还涉及到观测站的地理位置以及设备的系统误差等参数。为此人们要设法利用长期积累的丰富的观测资料，高精度确定这些重要的参数。\n\n由于航天器的问题太复杂，下面本题仅考虑较简单的确定高精度参数问题。\n\n假设有一个生态系统，其中含有两种生物，即： A生物和B生物，其中A生物是捕食者，B生物是被捕食者。假设 $t$ 时刻捕食者A的数目为 $x(t)$，被捕食者B数目为 $y(t)$，它们之间满足以下变化规律：\n\n\\[\n\\begin{cases}\n  x'(t) = x(t)[\\alpha_1 + \\alpha_2 y(t)] \\\\\n  y'(t) = y(t)[\\alpha_3 + \\alpha_4 x(t)]\n\\end{cases}\n\\]\n\n初始条件为：\n\n\\[\n\\begin{cases}\n  x(t_0) = \\alpha_5 \\\\\n  y(t_0) = \\alpha_6\n\\end{cases}\n\\]\n\n其中 $\\alpha_k (1 \\leq k \\leq 6)$ 为模型的待定参数。\n\n通过对此生态系统的观测，可以得到相关的观测数据。观测数据的格式依次为：\n\n观测时刻 $t_j$，A 生物数目 $x(t_j)$，B 生物数目 $y(t_j)$。\n\n---\n\n二：请利用有关数据，解决以下问题：\n\n1) 在观测数据无误差的情况下，若已知 $\\alpha_2 = \\frac{1}{5}$，求其它 5 个参数 $\\alpha_k (k=1,3,4,5,6)$？\n   有关数据见数据文件：DATA1.TXT。\n\n2) 在观测数据无误差的情况下，若 $\\alpha_2$ 也未知，问至少需要多少组观测数据，才能确定参数 $\\alpha_k (1 \\leq k \\leq 6)$？\n   有关数据见数据文件：DATA1.TXT。\n\n3) 在观测资料有误差（时间变量不含有误差）的情况下，请分别利用观测数据 DATA2.TXT 和 DATA3.TXT，确定参数 $\\alpha_k (1 \\leq k \\leq 6)$ 在某种意义下的最优解，并与仿真结果比较，进而改进你们的数学模型。\n\n4) 假设连观测资料的时间变量也含有误差，试利用数据DATA4.TXT，建立数学模型，确定参数 $\\alpha_k (1 \\leq k \\leq 6)$ 在某种意义下的最优解。",
  "subtask": {
    "1": {
      "subtask": "子任务 1（模型建立、变量变换与可辨识性分析）的目标是以严格、可操作的方式把题目给定的动力学和观测假设形式化，导出便于辨识分析的等价表达，并给出可判定参数在结构上是否可由给定类型观测唯一恢复的具体检验步骤和必要数据条件；其范围仅限于数学模型的明确化与可辨识性（structural and local identifiability）分析，不涉及参数估计算法或拟合结果。 具体要求和步骤如下：首先明确建模前提与观测模型的数学表述——状态方程为 dx/dt = x(α1 + α2 y), dy/dt = y(α3 + α4 x)（t ∈ [t0, T]），初始条件 x(t0)=α5, y(t0)=α6；观测方程为在离散时刻 t_j 观测到 x_j = x(t_j)+ε^x_j, y_j = y(t_j)+ε^y_j（若假定时间观测无误则 t_j 精确，否则视为潜在变量，此处仅记明情况），并明确基本假设（参数常数、连续变量近似、观测噪声独立零均值或噪声无穷小情形等）。 其次做代数变换以显性化参数结构：引入 u=ln x, v=ln y，可得 u'(t)=α1+α2 y(t), v'(t)=α3+α4 x(t)，从而把参数线性出现在时间导数方程中；据此说明若能获得连续观测或精确的 u',v'，每一时刻可得两条线性方程，参数 α1..α4 的辨识就归结为线性回归型问题，α5,α6 则由是否观测到 t0 决定。 然后给出可辨识性分析的操作性流程： (A) 形式化结构可辨识性问题为映射 Φ: θ=(α1..α6) ↦ {x(t_j;θ), y(t_j;θ)}_{j=1..N}（或在可得导数情形为映射到 {u'(t_j),v'(t_j)}），并说明两种分析途径——微分代数/符号法（使用工具如 DAISY/Maple/SIAN）用于全局结构可辨识性证明；雅可比法（局部可辨识性）用于数值判定，即在给定名义参数值处构造靶映射的Jacobian J = ∂Φ/∂θ 或当可得导数时构造线性回归矩阵，使用数值线性代数（SVD 或秩判定）检验列满秩；(B) 若采用雅可比法，明确计算细节：若只有状态观测（x,y）在 N 个时刻，求解数值敏感性方程 ∂x/∂α_i, ∂y/∂α_i（可通过解附随敏感性 ODE 或数值差分）以构造灵敏度矩阵 S of size (2N)×6，检验 rank(S)=6 为局部可辨识的必要且充分条件；(C) 若能获得 u',v'（连续观测或可直接导出导数），则在每一时刻构造线性系统 [1 y(t_j); 0 0] 等相应方程并检验由这些线性方程组成的回归矩阵的秩。 接着给出必要的可辨识性条件与最小信息量陈述（以便在后续数据检验时使用）：明确指出必需条件包括（i）是否观测到 t0（决定 α5,α6 是否已知），（ii）x(t) 与 y(t) 在观测区间必须有足够变化以避免回归误差矩阵列相关（例如若 y(t) 恒定则无法区分 α1 与 α2），（iii）观测时刻应相互独立且包含不同状态以使灵敏度矩阵非奇异；并给出“最小样本量”的理论边界说明：在理想化的连续导数可得情形，N distinct times providing u',v' must yield at least 6 independent linear equations (so at least 3 distinct t_j if t0 not providing α5,α6), whereas在仅有离散 x,y 的情形，可辨识性取决于 rank( S )（通常要求 N such that 2N ≥ 6 and rank 6, i.e. N≥3 but rank condition must hold），并强调实际判定以秩检验为准。 最后列出为执行本子任务所需的具体计算与工具：符号可辨识性可借助差代数软件（DAISY、Maple、Mathematica）或專門軟件 SIAN；局部可辨识性与數值檢驗用数值 ODE 求解器（用于计算状态与敏感性方程）和线性代数库（SVD/QR、条件数估计）来计算灵敏度矩阵及其秩/条件数；并建议在真实数据上先进行数据一致性检查（是否包含 t0、是否有常数段、是否存在测量零或负值使对数无效）和数值正则化策略（如基于奇异值判定近似秩）以判断参数能否被唯一确定。 通过上述严格、可重复的步骤，本子任务将给出一份清晰的、可执行的可辨识性检验清单和数学表达（方程与矩阵形式），为后续的参数估计与模型改进提供必要的理论判断依据。",
      "criteria": {
        "task_understanding": {
          "core_goal": "对捕食-被捕食系统进行可辨识性评估与检验，形式化观测与动力学模型并推导变量变换后参数线性结构以评估参数 α1–α6 的结构与局部可辨识性",
          "expected_output": "一套数学模型与观测模型的正式表述；u=ln x, v=ln y 的变量变换与导出方程；结构与局部可辨识性的判定流程与秩检验矩阵构造；最小观测条件与样本量边界陈述；可执行的检查清单与所需工具列表",
          "key_inputs_constraints": "输入：离散观测{t_j, x_j, y_j}；模型参数θ=（α1..α6）；时间区间[t0, T]。约束：x(t), y(t)>0 以使ln有效；αk为常数；噪声独立零均值（或无误差情形）。前置：是否包含t0决定α5,α6可辨识；观测时刻需多于参数数目且覆盖不同状态；禁止y(t)或x(t)恒定以避免矩阵退化",
          "modeling_type": "评价",
          "role_in_pipeline": "作为参数估计与仿真前的可辨识性与可行性评估环节；前序依赖：数据定义与清洗、模型假设明确；后序任务：参数估计算法设计、仿真与模型改进"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "界定可辨识性评估目标（参数 α1–α6）",
              "description": "是否明确本子任务是对α1–α6进行结构与局部可辨识性评价，而非进行参数拟合或数值求解。",
              "score": 35,
              "evaluation_focus": "问题界定",
              "scoring_hint": "高分：清晰区分可辨识性与估计，列出α1–α6；中分：提到可辨识性但混入估计步骤；低分：把任务等同于求解参数或仿真"
            },
            {
              "sub_criteria": "识别观测模型与噪声设定（x_j,y_j 与 ε）",
              "description": "是否指出观测方程x_j=x(t_j)+ε^x_j, y_j=y(t_j)+ε^y_j及无误差/有误差两种情形对评估影响。",
              "score": 25,
              "evaluation_focus": "模型理解",
              "scoring_hint": "高分：分别讨论无误差与含噪对检验矩阵构造的影响；中分：仅笼统提噪声；低分：忽略观测误差设定"
            },
            {
              "sub_criteria": "辨别t0与初值 α5,α6 的作用",
              "description": "是否识别是否观测到t0决定α5,α6是否可从数据直接确定或需纳入待辨识集合。",
              "score": 20,
              "evaluation_focus": "关键信息",
              "scoring_hint": "高分：明确两种场景与可辨识影响；中分：提到t0但未连到α5,α6；低分：未提及"
            },
            {
              "sub_criteria": "识别变量正性约束以支持ln变换",
              "description": "是否说明x(t), y(t)>0是u=ln x, v=ln y变换的必要条件并影响可用样本。",
              "score": 20,
              "evaluation_focus": "约束识别",
              "scoring_hint": "高分：明确正性与对数据筛选影响；中分：仅提到需要正值；低分：未考虑该条件"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "准确复写动力学与初值（dx/dt, dy/dt, α5,α6）",
              "description": "是否无误抄写dx/dt=x(α1+α2 y), dy/dt=y(α3+α4 x)及x(t0)=α5, y(t0)=α6。",
              "score": 30,
              "evaluation_focus": "精确表述",
              "scoring_hint": "高分：完全一致；中分：有轻微符号或括号错误不致混淆；低分：结构或参数索引错误"
            },
            {
              "sub_criteria": "明确观测方程与时间误差两情形",
              "description": "是否区分t_j精确与含误差作为潜在变量两种设定（本子任务记明即可，不求求解）。",
              "score": 25,
              "evaluation_focus": "场景区分",
              "scoring_hint": "高分：两情形均描述并说明对评估映射Φ的影响；中分：只提一情形；低分：未说明"
            },
            {
              "sub_criteria": "复述评估映射 Φ 与输出集合",
              "description": "是否把可辨识性形式化为Φ: θ→{x(t_j;θ), y(t_j;θ)}或θ→{u'(t_j),v'(t_j)}。",
              "score": 25,
              "evaluation_focus": "形式化",
              "scoring_hint": "高分：给出映射及输出元素；中分：仅口头描述不形式化；低分：无映射定义"
            },
            {
              "sub_criteria": "指明任务边界（不做参数估计）",
              "description": "是否明确本任务不涉及拟合/最优解，仅做结构与局部可辨识性分析。",
              "score": 20,
              "evaluation_focus": "范围控制",
              "scoring_hint": "高分：清晰声明且后文不越界；中分：偶有越界；低分：大量展开估计算法"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "参数常数与噪声（独立零均值/无误差）假设",
              "description": "是否陈述αk为常数；噪声独立零均值或无误差极限，并解释对秩判定的意义。",
              "score": 30,
              "evaluation_focus": "假设清单",
              "scoring_hint": "高分：逐项说明并联系矩阵秩稳健性；中分：只列出不解释；低分：缺失或不当"
            },
            {
              "sub_criteria": "可观测性与样本覆盖假设（N、状态多样性）",
              "description": "是否提出观测时刻需覆盖不同状态以避免列相关并给出N下界直觉。",
              "score": 25,
              "evaluation_focus": "数据条件",
              "scoring_hint": "高分：给出2N≥6与秩条件、或u',v'场景N要求；中分：仅笼统提样本多；低分：未设定"
            },
            {
              "sub_criteria": "正性与可微性假设支持ln与导数计算",
              "description": "是否假设x,y>0且解可微以支持u,v及u',v'构造。",
              "score": 25,
              "evaluation_focus": "数理基础",
              "scoring_hint": "高分：明确并检查数据中零/负值处理；中分：只提正性；低分：忽略"
            },
            {
              "sub_criteria": "时间戳精确性假设的记录",
              "description": "是否记录t_j精确或含误差两设定并限定本任务以记明为主。",
              "score": 20,
              "evaluation_focus": "边界假设",
              "scoring_hint": "高分：两设定均记述；中分：只述其一；低分：未提"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "u=ln x, v=ln y 变换与导数方程",
              "description": "是否正确推导u'=α1+α2 y, v'=α3+α4 x并指出参数线性化结构。",
              "score": 30,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：推导准确并阐明线性回归结构；中分：式子正确但解释不足；低分：推导或式子错误"
            },
            {
              "sub_criteria": "可辨识性映射与矩阵构造（灵敏度/回归）",
              "description": "是否定义Φ与两类矩阵：灵敏度矩阵S(2N×6)与回归矩阵（基于u',v'），含精确列定义。",
              "score": 30,
              "evaluation_focus": "结构设计",
              "scoring_hint": "高分：给出S的列为∂x/∂α_i,∂y/∂α_i采样堆叠；回归矩阵含[1 y;0 0]与[0 0;1 x]结构；中分：仅口述；低分：无矩阵或错误"
            },
            {
              "sub_criteria": "最小信息量与秩条件（2N≥6、秩=6）",
              "description": "是否陈述N下界与秩满条件；讨论y或x恒定导致α1/α2或α3/α4不可分。",
              "score": 25,
              "evaluation_focus": "可辨识条件",
              "scoring_hint": "高分：清楚列出条件与反例；中分：只提秩需要满；低分：未给条件"
            },
            {
              "sub_criteria": "初值参数 α5,α6 的确定路径",
              "description": "是否说明包含t0观测可直接取α5,α6，否则作为待辨识并进入S的列。",
              "score": 15,
              "evaluation_focus": "边界处理",
              "scoring_hint": "高分：两情形明确；中分：只提其一；低分：未说明"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "局部可辨识性雅可比/灵敏度秩检验流程",
              "description": "是否给出在名义θ处构造J或S并用SVD/QR判定列满秩的步骤。",
              "score": 40,
              "evaluation_focus": "求解流程",
              "scoring_hint": "高分：列出求解灵敏度ODE/差分、组装S、SVD阈值判断；中分：只说检查秩；低分：无流程"
            },
            {
              "sub_criteria": "符号/微分代数全局结构可辨识性途径",
              "description": "是否提出用DAISY/Maple/SIAN进行结构可辨识性证明的可行路径。",
              "score": 25,
              "evaluation_focus": "方法广度",
              "scoring_hint": "高分：点名工具与输入输出预期；中分：笼统说符号法；低分：未提"
            },
            {
              "sub_criteria": "u',v'可得时的线性回归判定",
              "description": "是否构造基于u',v'的线性系统并以列满秩检验α1..α4，说明所需样本量。",
              "score": 20,
              "evaluation_focus": "专项求解",
              "scoring_hint": "高分：明确每时刻两方程、样本量≥3（若需估计α5,α6另计）；中分：只说可线性回归；低分：未提"
            },
            {
              "sub_criteria": "数值稳定性与近似秩判断",
              "description": "是否给出奇异值阈值、条件数或正则化建议以处理近相关。",
              "score": 15,
              "evaluation_focus": "数值性",
              "scoring_hint": "高分：提出阈值如σ_min/σ_max或机器精度倍数；中分：泛谈稳定性；低分：未考虑"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "灵敏度方程或差分的可实现说明",
              "description": "是否给出计算∂x/∂α_i, ∂y/∂α_i的实现思路（敏感性ODE或有限差分）并讨论优缺点。",
              "score": 35,
              "evaluation_focus": "实现路径",
              "scoring_hint": "高分：两法均述及并提到伴随/自动微分可选；中分：只提其一；低分：未给实现思路"
            },
            {
              "sub_criteria": "SVD/QR秩检验与阈值设定",
              "description": "是否提出使用SVD或QR并给出近似秩阈值设定方法。",
              "score": 25,
              "evaluation_focus": "线代实现",
              "scoring_hint": "高分：给出阈值如τ=max(m,n)·ε·σ_max；中分：只说用SVD；低分：未述"
            },
            {
              "sub_criteria": "数据前置校验（t0、正性、常数段）",
              "description": "是否提出程序化检查是否包含t0、x/y>0、以及常数段导致列相关的检测。",
              "score": 25,
              "evaluation_focus": "数据校验",
              "scoring_hint": "高分：列出三项并说明拒绝/告警逻辑；中分：仅两项；低分：未校验"
            },
            {
              "sub_criteria": "工具链与可重复性",
              "description": "是否点明可用工具（DAISY/Maple/SIAN、ODE求解器、线代库）与重现步骤。",
              "score": 15,
              "evaluation_focus": "可复现性",
              "scoring_hint": "高分：工具+命令/流程；中分：只列工具；低分：未提"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "秩检验结论与参数组可辨识性判读",
              "description": "是否根据秩或奇异值谱给出α1–α6哪些可（不可）辨识的结论与原因。",
              "score": 40,
              "evaluation_focus": "结果判读",
              "scoring_hint": "高分：逐类参数解释（如α1/α2受y变化影响）；中分：仅给总体可辨识/不可；低分：无结论"
            },
            {
              "sub_criteria": "最小样本量与必要条件回溯检查",
              "description": "是否核对N与2N≥6、t0是否包含、状态多样性等必要条件是否满足。",
              "score": 25,
              "evaluation_focus": "条件核验",
              "scoring_hint": "高分：逐条勾检并指出缺口；中分：部分核验；低分：未核验"
            },
            {
              "sub_criteria": "对模型改进或观测设计的建议",
              "description": "是否基于秩退化提出增加激励区段、扩展观测（u',v'或更多时刻）或记录t0的建议。",
              "score": 20,
              "evaluation_focus": "改进建议",
              "scoring_hint": "高分：具体到变量与时段设计；中分：泛泛建议；低分：无建议"
            },
            {
              "sub_criteria": "数值不稳定或近相关的诊断",
              "description": "是否通过条件数/奇异值比诊断并说明对结论置信度的影响。",
              "score": 15,
              "evaluation_focus": "稳健性评估",
              "scoring_hint": "高分：给出阈值或比值并解释；中分：定性提及；低分：忽略"
            }
          ]
        }
      }
    },
    "2": {
      "subtask": "子任务 2（无观测误差条件下的参数恢复）：在假定观测数据精确且只含离散时刻样本 {(t_j, x_j, y_j)} 的前提下，本子任务的目标是给出一套可直接实施的、解析与数值两条互补路线以精确恢复模型参数 θ=(α1,α2,α3,α4,α5,α6)，并明确对不同已知/未知情形所需的最小观测数与具体计算步骤。范围限定为：不考虑观测噪声或时间误差，模型为 dx/dt = x(α1+α2 y), dy/dt = y(α3+α4 x)，初值定义为 α5=x(t0), α6=y(t0)（若数据包含 t0 则可直接读出，否则视为待估量）；仅使用解析微分回归（基于对数变换 u=ln x, v=ln y）和基于数值积分的非线性最小二乘两种方法，不引入随机或贝叶斯成分。具体步骤：1) 数据检查与预处理：确认所有 x_j,y_j>0 以便取对数，检查是否包含 t0；2) 解析微分回归路径（优先用于生成初值并在数据稠密时直接给出精确解）：计算 u_j=ln x_j, v_j=ln y_j，并用高精度差商（中心差分、高阶差分）或在必要时用无噪声条件下的精确插值求导得到 u'_j≈du/dt|_{t_j}, v'_j≈dv/dt|_{t_j}；对于已知 α2，用 α1_j = u'_j - α2 y_j 在所有时刻验证一致性并用普通最小二乘取平均以得到 α1，随后对线性回归 v'_j = α3 + α4 x_j 用最小二乘解出 α3,α4；对于未知 α2，将 u'_j = α1 + α2 y_j 和 v'_j = α3 + α4 x_j 在多时刻联立为线性回归问题（矩阵形式)并用最小二乘求解全部 α1..α4；若 t0 不在数据中则把 α5,α6 视为额外未知并用相应方程一并求解。这里的理论最小样本数（在可精确获得导数的理想化情形）为：若包含 t0 且 α2 已知，至少需两个不同时间点提供导数信息（总计可恢复剩余五个参数）；若 α2 也未知且包含 t0，则至少需要另外两个时间点（共计至少3组时刻）以获得四条独立方程解 α1..α4；若 t0 未观测则需至少三个不同时间点来解全部六个未知。3) 数值轨道拟合路径（在数据较稀疏或为稳健精确恢复时首选）：将 θ 作为待估参，选用高精度 ODE 求解器（例如 RK4/RK45 或自适应步长方法），构造目标函数 S(θ)=Σ_j [(x_model(t_j;θ)-x_j)^2+(y_model(t_j;θ)-y_j)^2]，用非线性最小二乘算法（如 Levenberg–Marquardt 或信赖域反向差分法）求 θ 的最优解；为提高收敛性，先用解析微分回归结果作为初值；建议在优化中采用自动微分或 adjoint 方法计算雅可比以获得精确梯度/Hessian，从而快速收敛；如对初值敏感或存在数值病态，可采用 multiple-shooting 或 direct collocation 把状态在网格点作为变量并用 ODE 作为约束以改善稳定性。4) 验证与输出：在无噪声情形两条方法应收敛到一致解——验证方法包括将所得 θ 前代入 ODE 用高精度积分重建轨迹并与数据比较（残差应接近零）、检查最小二乘残差与 Jacobian 条件数，若 t0 在数据中则核对 α5,α6 与观测一致。5) 建议的软件与数值参数：可用 MATLAB (ode45 + lsqnonlin) 或 Python (scipy.integrate + scipy.optimize.least_squares / lmfit) 实现，必要时用 CasADi/Ipopt 或 JAX/Autograd 获得自动微分支持；积分相对误差容限建议设置在 1e-8–1e-6 之间，优化停止准则采用梯度范数与参数增量阈值（如1e-8）与最大迭代次数联合控制。该子任务并不涉及含噪声或时间误差的统计建模、置信区间估计或模型扩展，仅在无误差假定下提供可重复、可实现的解析与数值参数恢复流程及所需最小观测量说明。",
      "criteria": {
        "task_understanding": {
          "core_goal": "在无观测误差且给定离散样本 {(t_j, x_j, y_j)} 下，精确拟合并恢复动力学模型参数 θ=(α1,α2,α3,α4,α5,α6)，通过解析微分回归与数值最小二乘两条路径求解。",
          "expected_output": "参数向量θ的数值解（α1..α6），最小观测数与可辨识性说明，导数回归矩阵/灵敏度矩阵与秩检验结果，ODE重建轨迹与残差接近零的验证结论；可选输出：用于求解的代码或伪代码。",
          "key_inputs_constraints": "输入：离散观测 {(t_j, x_j, y_j)}；约束：x_j>0, y_j>0 以便取对数；若包含 t0 可直接得到 α5=x(t0), α6=y(t0)；模型固定为 dx/dt=x(α1+α2 y), dy/dt=y(α3+α4 x)；无噪声与无时间误差；时间序列需有足够变化避免秩亏；数值法需可用高精度ODE与最小二乘。",
          "modeling_type": "拟合+仿真",
          "role_in_pipeline": "作为参数估计阶段的无噪声基准求解环节：前序依赖子任务1的模型明确化与可辨识性结论；后序为含噪声估计、置信区间与模型改进的基线与初值来源。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "无误差离散样本拟合目标的界定",
              "description": "明确子任务在无观测误差、仅有 {(t_j,x_j,y_j)} 的前提下恢复 θ=(α1..α6)，区分与含噪声/时间误差任务的边界。",
              "score": 30,
              "evaluation_focus": "问题界定",
              "scoring_hint": "高分：清楚排除噪声/时间误差并定位到无误差参数恢复；中分：提及无误差但夹杂噪声讨论；低分：未区分误差设定或目标含混。"
            },
            {
              "sub_criteria": "两条路径（解析微分回归与数值最小二乘）的必要性",
              "description": "说明为何提供解析u=ln x,v=ln y导数回归与数值轨道拟合两条互补路线并各自适用场景。",
              "score": 35,
              "evaluation_focus": "方案选择",
              "scoring_hint": "高分：给出两路优缺点与适用数据稠密/稀疏条件；中分：仅罗列不解释适用性；低分：只给一路或混淆。"
            },
            {
              "sub_criteria": "最小观测数与可辨识性连接",
              "description": "指出在已知/未知α2、是否含t0下的最小时刻数要求并与秩条件关联。",
              "score": 35,
              "evaluation_focus": "可辨识性",
              "scoring_hint": "高分：分别给出N的下界并说明秩满条件；中分：仅给数目不解释秩；低分：缺失或错误最小样本量。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "动力学与初值的精确重述",
              "description": "准确写出 dx/dt=x(α1+α2 y), dy/dt=y(α3+α4 x) 与 α5=x(t0), α6=y(t0)。",
              "score": 25,
              "evaluation_focus": "准确性",
              "scoring_hint": "高分：公式无误且点明α5,α6定义；中分：轻微符号或排版瑕疵；低分：方程写错或漏初值。"
            },
            {
              "sub_criteria": "观测模型与对数变换复述",
              "description": "清楚给出 u=ln x, v=ln y 以及 u'(t)=α1+α2 y(t), v'(t)=α3+α4 x(t)。",
              "score": 35,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：推导正确并说明对数的正值条件；中分：给出等式但未提正性要求；低分：导数关系错误。"
            },
            {
              "sub_criteria": "数据情形划分（含/不含t0，α2已知/未知）",
              "description": "将任务拆分为多情形，明确输出与步骤差异。",
              "score": 40,
              "evaluation_focus": "任务分解",
              "scoring_hint": "高分：四象限情形皆覆盖；中分：覆盖不全；低分：未区分情形。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "无噪声与时间精确假设",
              "description": "明确观测无误差且 t_j 精确，作为解析回归与数值拟合的前提。",
              "score": 30,
              "evaluation_focus": "前提设定",
              "scoring_hint": "高分：清楚写明两者均精确；中分：只提其一；低分：未声明或与噪声混用。"
            },
            {
              "sub_criteria": "对数变换可用性条件",
              "description": "给出 x_j>0, y_j>0 的必要性与零/负值的处理策略（排除或改走数值拟合）。",
              "score": 30,
              "evaluation_focus": "可用性",
              "scoring_hint": "高分：明确阈值与分支；中分：仅口头提及；低分：未考虑。"
            },
            {
              "sub_criteria": "秩与状态变化的必要条件",
              "description": "阐明y或x不变将导致 u',v' 回归矩阵列相关，需足够状态变化。",
              "score": 40,
              "evaluation_focus": "可辨识性",
              "scoring_hint": "高分：明确列相关示例与规避；中分：笼统提及变化；低分：未涉及。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "解析微分回归矩阵构造",
              "description": "构造线性系统 [u'_j v'_j] 与 [1 y_j; 1 x_j] 形式，区分α2已知/未知的回归矩阵。",
              "score": 35,
              "evaluation_focus": "矩阵建模",
              "scoring_hint": "高分：写清设计矩阵与参数向量；中分：仅口述线性回归；低分：无矩阵化表达。"
            },
            {
              "sub_criteria": "数值轨道拟合目标函数S(θ)",
              "description": "明确 S(θ)=Σ[(x_model(t_j;θ)-x_j)^2+(y_model(t_j;θ)-y_j)^2] 与求解器选择。",
              "score": 35,
              "evaluation_focus": "目标设计",
              "scoring_hint": "高分：目标函数与求解器（RK45+LM）齐备；中分：缺少一个要素；低分：目标函数含糊。"
            },
            {
              "sub_criteria": "最小观测数与情形映射",
              "description": "给出包含t0/不含t0、α2已知/未知下的N最小值与对应可解参数集合。",
              "score": 30,
              "evaluation_focus": "设计完整性",
              "scoring_hint": "高分：逐情形列出N与可解参数；中分：遗漏个别情形；低分：未给出映射。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "导数计算与高精度差分/插值",
              "description": "在无噪声下使用中心差分/高阶差分或插值精确求 u'_j, v'_j 并说明阶数选择。",
              "score": 30,
              "evaluation_focus": "数值细节",
              "scoring_hint": "高分：给出具体差分模板或插值策略；中分：泛指“求导”；低分：未说明如何得导数。"
            },
            {
              "sub_criteria": "线性回归与秩检验/SVD",
              "description": "用最小二乘求 α1..α4（或其中子集），并通过SVD检查设计矩阵列满秩。",
              "score": 35,
              "evaluation_focus": "线性代数",
              "scoring_hint": "高分：包含SVD与阈值判断；中分：仅OLS无秩检验；低分：无求解细节。"
            },
            {
              "sub_criteria": "非线性最小二乘与ODE积分精度",
              "description": "采用LM/信赖域优化，使用高精度ODE（如RK45）和严格容差(1e-8~1e-6)。",
              "score": 35,
              "evaluation_focus": "优化实现",
              "scoring_hint": "高分：给出容差与停止准则；中分：只述方法名；低分：未指明优化与积分设置。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "可复现的数据预处理与u,v求导代码",
              "description": "实现 x_j,y_j 检查、对数变换与 u'_j,v'_j 的高精度差分/插值函数。",
              "score": 35,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：边界检查与函数化；中分：脚本式实现；低分：无实现或不处理边界。"
            },
            {
              "sub_criteria": "解析回归与SVD秩检验实现",
              "description": "提供构建设计矩阵与调用线性代数库（SVD/QR）的示例代码。",
              "score": 35,
              "evaluation_focus": "数值线代",
              "scoring_hint": "高分：含条件数或近似秩阈值；中分：仅OLS；低分：缺失。"
            },
            {
              "sub_criteria": "ODE求解与非线性最小二乘优化脚本",
              "description": "用 scipy/Matlab 实现 S(θ) 与 least_squares/lsqnonlin，设置容差与回调验证残差。",
              "score": 30,
              "evaluation_focus": "工程实现",
              "scoring_hint": "高分：含容差与收敛准则；中分：能跑但默认参数；低分：无法运行或缺少求解。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "参数一致性与两路结果对比",
              "description": "比较解析回归与非线性拟合得到的 α1..α6 是否一致；不一致时定位原因（导数误差/秩问题）。",
              "score": 35,
              "evaluation_focus": "一致性检验",
              "scoring_hint": "高分：定量比较并解释差异；中分：只口述一致；低分：未比较。"
            },
            {
              "sub_criteria": "残差与再仿真验证",
              "description": "用估计θ重积分，报告 S(θ)≈0、点对点误差≈机器精度，给出最大绝对误差。",
              "score": 35,
              "evaluation_focus": "验证指标",
              "scoring_hint": "高分：给出数值阈值如 max|e|<1e-8；中分：仅“接近零”；低分：无验证或误差大。"
            },
            {
              "sub_criteria": "最小观测数与秩结果的复核",
              "description": "报告样本量N、设计/灵敏度矩阵的秩与条件数，确认满足理论最小样本量。",
              "score": 30,
              "evaluation_focus": "可辨识性",
              "scoring_hint": "高分：提供秩=参数数与cond值；中分：仅称“满秩”；低分：缺少秩信息或不满足仍继续结论。"
            }
          ]
        }
      }
    },
    "3": {
      "subtask": "子任务 3（含观测误差的数据估计、不确定性量化与模型检验与改进）只处理在观测时间被视为精确的情形，目标是用 DATA2.TXT 和 DATA3.TXT 中的离散有噪声观测 (t_j, x_obs_j, y_obs_j) 估计参数 θ = (α1,..,α6)，给出统计意义下的“最优”估计及其不确定性，并通过严格的残差与敏感性分析判断并提出必要的模型改进方案；本子任务须并行采用两条互补且可验证的途径：A. 平滑-微分回归路径：对原始观测 x,y 分别做带惩罚的平滑（建议用三次平滑样条或高斯过程回归，平滑强度由广义交叉验证/GCV 或边际似然确定），从平滑表示解析导出 u'(t)=d ln x/dt 与 v'(t)=d ln y/dt 及其估计方差，构造加权线性回归 u'(t_j)=α1+α2 y(t_j)+ε_u, v'(t_j)=α3+α4 x(t_j)+ε_v（权重用导数方差或观测方差的倒数），回归得估计值并以非参数引导法（bootstrap）或解析回归方差给出置信区间；平滑路径提供稳定的初值和导数不确定性估计。 B. 轨道拟合路径（首选的精确方法）：以 ODE 的数值解为内核，定义加权最小二乘或似然目标 S(θ)=Σ_j [w_x_j (x_model(t_j;θ)-x_obs_j)^2 + w_y_j (y_model- y_obs_j)^2]（权重按观测方差设定），用梯度基优化（Levenberg–Marquardt 或信赖域）求 MLE/MAP；为高效且准确地计算梯度/雅可比，使用自动微分或求解伴随敏感性方程；若问题多模态或初值敏感，先用平滑路径结果作为初值并可结合全局优化（差分进化、多起点搜索）。在轨道拟合中应支持鲁棒损失（如 Huber）以抗异常值，并可在贝叶斯框架中以具物理意义的先验进行 MAP 或用 HMC/NUTS 获得后验分布和不确定性（输出 R̂、ESS、后验预测检验）。估计完成后必须做系统性的诊断和不确定性量化：残差自相关与异方差检测（ACF、Ljung–Box、Breusch–Pagan）、后验/渐进协方差（Hessian^-1）、配置似然剖面 (profile likelihood)、bootstrap 置信区间与后验区间互证；计算灵敏度矩阵 ∂[x,y]/∂α 并用奇异值分解评价可辨识性与参数共线性，若条件数过大则采用正则化（Tikhonov 或贝叶斯先验）或参数重参数化。若残差或灵敏度分析显示动力学模型系统性失配，则按生物学合理顺序检验模型改进：引入 Holling-II/饱和捕食项、密度依赖自限项、或在状态方程中加入过程噪声（随机微分方程），并用信息准则（AIC/BIC）和交叉验证比较模型拟合与预测性能。实现细节：建议使用成熟数值与统计工具（Python: scipy.integrate, scipy.optimize.least_squares, statsmodels, pymc/numpyro/JAX；R: deSolve, nlme, mgcv, rstan；或 MATLAB: ode45+lsqnonlin）并把 ODE 积分容差设为 1e-8–1e-6、优化收敛阈值设为 1e-8；在贝叶斯采样中以 R̂<1.1、ESS 足够为收敛准则。最终交付物应包括：参数点估计与不确定区间、残差与后验预测检验报告、灵敏度/可辨识性分析结果、若干候选模型改进建议及其比较结论，以及可重复的实现脚本与初值设置说明。",
      "criteria": {
        "task_understanding": {
          "core_goal": "题目要考什么——按题型拆解关键能力：对含观测误差且时间精确的离散观测(DATA2.TXT, DATA3.TXT)进行参数估计与拟合，给出参数估计、不确定性量化并对模型残差与灵敏度进行检验以提出模型改进方案。",
          "expected_output": "参数点估计与置信区间（α1..α6）、平滑导数与其不确定度、加权最小二乘/似然的最优解、残差诊断图表（ACF、残差分布）、灵敏度与可辨识性报告、候选模型改进与比较表、可复现代码与运行说明",
          "key_inputs_constraints": "1) 观测序列 {(t_j,x_obs_j,y_obs_j)}（实数时间、数值观测）；2) 假定时间观测精确、观测误差仅在 x,y（独立或已建模异方差）；3) x_j,y_j>0 以支持 u=ln x, v=ln y 变换；4) 给定原始 ODE 形式 dx/dt=x(α1+α2 y), dy/dt=y(α3+α4 x)；5) 需选择平滑参数或先验并能提供初值",
          "modeling_type": "拟合+不确定性量化+模型检验",
          "role_in_pipeline": "作为参数估计与模型验证环节：依赖前序的数据清洗/子任务1(模型明确化/可辨识性)与子任务2(无噪声初值/解析解作为初值)，为后续子任务(模型改进与预测)提供估计结果、不确定性与改进建议"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "明确提出要对 DATA2.TXT 与 DATA3.TXT 做参数估计(α1..α6)",
              "description": "检验是否明确识别任务核心为在有观测误差下对 α1..α6 进行估计并量化不确定性；需指明数据集名和误差仅在 x,y。",
              "score": 30,
              "evaluation_focus": "任务识别",
              "scoring_hint": "高分：明确写出估计 α1..α6，列出使用 DATA2.TXT、DATA3.TXT，注明时间精确且噪声在 x,y；中分：目标与数据提及不全；低分：未表明要估计全部 α1..α6 或混淆数据集。"
            },
            {
              "sub_criteria": "识别需并行采用“平滑-微分回归路径”与“轨道拟合路径”",
              "description": "检验是否识别并列两条互补方法作为估计策略，并说明二者作用（初值/鲁棒性/不确定性）。",
              "score": 25,
              "evaluation_focus": "方法选择",
              "scoring_hint": "高分：同时明确两条路径用途并给出各自输出(导数估计、MLE)；中分：提及两法但未说明差异；低分：仅提一种方法或误将时间误差纳入。"
            },
            {
              "sub_criteria": "识别需进行不确定性量化与残差诊断",
              "description": "需识别并列出要做的诊断项目：残差自相关(ACF/Ljung-Box)、异方差检验、置信区间/后验分布、profile likelihood 或 bootstrap。",
              "score": 25,
              "evaluation_focus": "诊断要求",
              "scoring_hint": "高分：列出至少 ACF、Ljung-Box、bootstrap/Hessian 或贝叶斯后验；中分：仅列出部分检验；低分：未列出具体诊断。"
            },
            {
              "sub_criteria": "识别模型改进方向与可辨识性核查需求",
              "description": "需指出若残差/灵敏度异常时要检验的改进项（Holling-II、密度依赖、过程噪声）并提出可辨识性检验的必要性。",
              "score": 20,
              "evaluation_focus": "模型检验",
              "scoring_hint": "高分：给出具体备选模型并说明用 AIC/BIC/交叉验证比较；中分：给出模糊改进方向；低分：未提改进或不可识别性检查。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "用“参数估计+不确定性量化”重述任务目标",
              "description": "要求能用一句话精炼复述子任务为‘在时间精确数据上估计α1..α6并给出置信区间与诊断’。",
              "score": 40,
              "evaluation_focus": "表达准确性",
              "scoring_hint": "高分：一句话精确包含估计对象(α1..α6)、数据集(DATA2/3)、不确定性量化与诊断；中分：信息不全；低分：复述与原任务偏离。"
            },
            {
              "sub_criteria": "明确复述两条并行路径与各自输出",
              "description": "要求复述平滑-微分回归输出（导数、回归估计、方差）与轨道拟合输出（MLE/残差、置信区间/后验）。",
              "score": 30,
              "evaluation_focus": "方法说明",
              "scoring_hint": "高分：分别列出两法的具体输出项；中分：只说明方法不说明输出；低分：未区分两法或功能混淆。"
            },
            {
              "sub_criteria": "复述数据与前提假设（时间精确、x,y>0）",
              "description": "要求明确写出数据类型、时间无误差、需要 x,y>0 支持对数变换、观测噪声独立或可建模。",
              "score": 30,
              "evaluation_focus": "前提说明",
              "scoring_hint": "高分：列出时间精确、x,y>0、噪声形式；中分：缺少 x,y>0 或噪声描述；低分：前提错误或遗漏时间精确性。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "明确定义观测误差模型与统计假设",
              "description": "需明确噪声模型（例如 x_obs = x + ε_x，ε_x 独立零均值或异方差）并说明估计方法如何反映噪声（加权LS或似然）。",
              "score": 40,
              "evaluation_focus": "概率假设",
              "scoring_hint": "高分：写出误差分布/方差估计策略并用于权重；中分：说明独立零均值但不指定方差处理；低分：未说明噪声或假设与方法不符。"
            },
            {
              "sub_criteria": "给出对数变换的可行性与光滑性假设",
              "description": "说明采用 u=ln x, v=ln y 需要 x,y>0 与足够平滑以估导数，并列出处理零/负值的策略。",
              "score": 30,
              "evaluation_focus": "数值前提",
              "scoring_hint": "高分：明确处理零值策略(截断/小常数)并要求导数存在；中分：仅说明需正值；低分：忽略对数前提或无处理方法。"
            },
            {
              "sub_criteria": "说明模型简化与备选过程噪声假设",
              "description": "指出基本 ODE 是确定性近似，如有系统性残差须考虑过程噪声或结构项(饱和项)并说明如何比较模型。",
              "score": 30,
              "evaluation_focus": "建模合理性",
              "scoring_hint": "高分：列出明确备选(如 Holling-II、SDE)并给出比较准则(AIC/BIC/CV)；中分：提及改进但无比较方案；低分：未考虑模型结构风险。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "构造平滑-微分回归路径（平滑选择与导数不确定度估计）",
              "description": "需给出平滑方法（样条或GP）、平滑参数选择(GCV/marginal likelihood)、导数求取和导数方差估计的具体公式/步骤。",
              "score": 30,
              "evaluation_focus": "数值方法",
              "scoring_hint": "高分：指定 cubic spline/GP，给出GCV/边际似然选择并产出导数方差；中分：指定平滑但无参数选择细节；低分：模糊描述或无导数方差估计。"
            },
            {
              "sub_criteria": "构造轨道拟合的加权最小二乘/似然目标与权重策略",
              "description": "需明确目标 S(θ)=Σ w_x (x_model-x_obs)^2+...，权重来自观测方差或平滑导数估计，并说明鲁棒损失选用场景。",
              "score": 25,
              "evaluation_focus": "目标函数",
              "scoring_hint": "高分：给出加权目标与权重来源并说明 Huber 用于异常值；中分：仅给出无权重目标；低分：目标不与噪声假设一致。"
            },
            {
              "sub_criteria": "给出灵敏度/伴随方程构造用于雅可比与不确定度分析",
              "description": "需写出敏感性方程的形式或说明采用自动微分/伴随以高效计算雅可比和 Fisher 信息矩阵。",
              "score": 25,
              "evaluation_focus": "灵敏度构造",
              "scoring_hint": "高分：提供敏感性ODE或说明使用 adjoint/AD，并用于 Hessian 估计；中分：仅提 AD 或仅数值差分；低分：无灵敏度计算计划。"
            },
            {
              "sub_criteria": "列出候选模型改进(例如 Holling-II、密度依赖、过程噪声)并给出比较方案",
              "description": "构建可比较的备选模型族并描述用 AIC/BIC/profile likelihood/交叉验证 进行选择的具体步骤。",
              "score": 20,
              "evaluation_focus": "模型改进",
              "scoring_hint": "高分：列出至少两种改进并给出量化比较流程；中分：仅列出改进但无比较细节；低分：无或不切实际的改进建议。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "数值求解器与容差设置与稳定性策略（轨道拟合路径）",
              "description": "需指定 ODE 求解器类型(RK45/自适应)、相对/绝对误差容限(建议1e-8~1e-6)以及多起点/全局优化策略以避免局部极值。",
              "score": 30,
              "evaluation_focus": "数值可靠性",
              "scoring_hint": "高分：指定求解器与容差并说明多起点或全局策略；中分：给出求解器但无容差或稳定性策略；低分：无具体数值设置。"
            },
            {
              "sub_criteria": "梯度与雅可比计算（自动微分/伴随/有限差分）",
              "description": "需说明采用 AD 或伴随敏感性以高效准确得到 Jacobian/Hessian，或在受限资源下说明有限差分与步长控制。",
              "score": 25,
              "evaluation_focus": "梯度计算",
              "scoring_hint": "高分：采用 AD/adjoint 并说明实现工具；中分：采用有限差分并说明步长控制；低分：无梯度策略或用未检验差分步长。"
            },
            {
              "sub_criteria": "不确定性量化方法实现（渐进协方差、bootstrap、贝叶斯采样）",
              "description": "需给出至少一种不确定性估计路径并说明实现细节（Hessian^-1、bootstrap 重采样次数、或 MCMC 收敛指标）。",
              "score": 25,
              "evaluation_focus": "不确定性",
              "scoring_hint": "高分：实现两种以上并给出参数(bootstrap 1k次或 MCMC R̂<1.1 ESS>200)；中分：仅实现一种并说明参数；低分：未提供可验证不确定性度量。"
            },
            {
              "sub_criteria": "鲁棒性与异常值处理（Huber/权重重估计）",
              "description": "需说明在异常值存在时使用鲁棒损失或加权重估计的条件与实现方式，并验证对参数影响。",
              "score": 20,
              "evaluation_focus": "鲁棒拟合",
              "scoring_hint": "高分：给出 Huber 对应阈值并展示结果对比；中分：提及鲁棒方法但无实现细节；低分：忽视异常值影响。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "可复现的实现与运行说明（包含 DATA2/3 路径与随机种子）",
              "description": "代码需包含完整运行脚本、依赖声明、数据读取路径与确定性运行(随机种子)，能重现主要数值结果。",
              "score": 30,
              "evaluation_focus": "复现性",
              "scoring_hint": "高分：提供可直接运行脚本、requirements 与随机种子并能复现表中结果；中分：提供代码但需小改动；低分：缺少运行说明或依赖不明。"
            },
            {
              "sub_criteria": "数值稳定性与测试（单元/回归测试或示例验证）",
              "description": "代码应包含基本测试用例或示例验证（如将无噪声解析解作为回归测试），并验证求解器收敛与容差影响。",
              "score": 25,
              "evaluation_focus": "代码质量",
              "scoring_hint": "高分：含单元测试/示例与收敛验证并通过；中分：有示例但无自动测试；低分：无测试或示例。"
            },
            {
              "sub_criteria": "高效实现梯度与灵敏度（使用 AD/adjoint 或高效敏感性求解）",
              "description": "要求在代码中实现自动微分或伴随敏感性以供优化与不确定性分析使用，或说明受限环境下的替代方案。",
              "score": 25,
              "evaluation_focus": "性能实现",
              "scoring_hint": "高分：实现 AD/adjoint 并在文档中说明工具；中分：使用有限差分并说明步长控制；低分：无雅可比/敏感性实现。"
            },
            {
              "sub_criteria": "输出报告与可视化（残差、ACF、灵敏度图）",
              "description": "代码应生成关键图表（平滑拟合与导数、残差分布/ACF、灵敏度热图、参数后验/CI）以支持结果分析。",
              "score": 20,
              "evaluation_focus": "可视化",
              "scoring_hint": "高分：自动生成所有关键图表并可导出；中分：部分图表需手工绘制；低分：无图表或图表无法复现。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "残差诊断与假设检验（ACF/Ljung-Box/Breusch-Pagan）",
              "description": "需提供残差自相关与异方差检验并给出数值结论（p 值、是否拒绝独立同分布假设）。",
              "score": 30,
              "evaluation_focus": "残差检验",
              "scoring_hint": "高分：给出 ACF 图并报告 Ljung-Box p>0.05 说明无显著自相关，BP p>0.05 说明无异方差；中分：只做部分检验；低分：无统计检验或结论不明确。"
            },
            {
              "sub_criteria": "参数不确定性与置信区间报告（Hessian^-1 / bootstrap /后验）",
              "description": "需报告每个参数的点估计与区间(例如 95% CI)，并说明估计方法(Hessian/ bootstrap/ MCMC)与数值参数。",
              "score": 25,
              "evaluation_focus": "不确定性报告",
              "scoring_hint": "高分：为 α1..α6 给出 95% CI 且方法说明(bootstrap 1000 次或 MCMC R̂<1.1)；中分：仅给点估计与标准误；低分：无或错误的置信区间。"
            },
            {
              "sub_criteria": "灵敏度与可辨识性分析（灵敏度矩阵与条件数）",
              "description": "需计算灵敏度矩阵、SVD/条件数，判断参数共线性并提供正则化或重参数化建议当条件数过大时。",
              "score": 25,
              "evaluation_focus": "可辨识性",
              "scoring_hint": "高分：提供奇异值谱、条件数(例如 <1e8 可接受)并给出具体正则化方案；中分：仅报告条件数无进一步措施；低分：未计算或忽视高条件数风险。"
            },
            {
              "sub_criteria": "基于诊断给出模型改进建议并用信息准则比较",
              "description": "需基于残差与灵敏度结果提出明确改进（Holling-II、SDE 等）并用 AIC/BIC/CV 给出比较结论与推荐模型。",
              "score": 20,
              "evaluation_focus": "模型决策",
              "scoring_hint": "高分：列出候选并用 AIC/BIC 或 CV 数值支持改进决策；中分：提出改进但无量化比较；低分：无改进建议或与诊断矛盾。"
            }
          ]
        }
      }
    },
    "4": {
      "subtask": "子任务4（时间观测含误差的参数估计与时间配准）：本子任务的目标是针对包含观测时间误差的离散数据集（输入为 DATA4.TXT 中的观测三元组 {t_obs_j, x_obs_j, y_obs_j}, j=1..N），建立可实现的数学表述并提供一套数值化、可重复的估计流程，输出包括模型参数 θ=(α1..α6) 的点估计与不确定性指标、对观测真实时刻 t*_j 的校正或确定的时间变换函数以及一组收敛与模型诊断准则；范围限于时间误差建模、估计算法、数值实现细节与诊断，不包含对其他模型结构改动的深入讨论。为此首先把观测模型明确定义为状态方程 dx/dt = x(α1+α2 y), dy/dt = y(α3+α4 x)（真实时间为 t*），观测方程为 x_obs_j = x(t*_j)+ε^x_j, y_obs_j = y(t*_j)+ε^y_j, t_obs_j = t*_j + δ_j，其中 ε 项为已建模的观测噪声（例如零均值独立正态或计数分布）且 δ_j 为时间误差；对 δ_j 提供三类可选参数化形式并在实施时择一或比较：(A) 观测独立误差模型 δ_j ~ N(0, σ_t^2)（σ_t 可估计），(B) 低维漂移模型 δ_j = c0 + c1 t*_j + η_j（η_j iid 小噪声），或 (C) 单调光滑时间配准 w(t_obs; φ) = t*（time-warping），其中 w 用 I‑样条或单调 B‑spline 展开并以平滑惩罚约束。针对上述时间误差模型，给出三类估计策略：1) 层级贝叶斯方法：把 θ 与潜在时间向量 {t*_j}（或 warp 参数 φ）联合作为未知量，指定先验（对 {t*_j} 施加二阶差分平滑先验或对 φ 施加平滑惩罚以控制复杂度），用 Hamiltonian Monte Carlo / NUTS（Stan、NumPyro、PyMC）对联合后验取样，输出后验均值、后验置信区间及后验预测检验结果，采样诊断用 R̂、ESS 与后验预测残差；2) EM 或变分近似：把 {t*_j} 视为隐变量，E 步用 Laplace 近似或数值优化求取 t*_j 的条件期望（或 MAP），M 步在固定 t*_j 下用非线性最小二乘或最大似然更新 θ；交替迭代直到收敛，E 步可通过多起点局部优化或多重射击（multiple‑shooting）增加鲁棒性；3) 参数化 time‑warping（优化解法）：以单调基函数表示 w(t_obs; φ)，把 φ 与 θ 联合放入约束最小二乘/惩罚最小化问题中（目标为观测误差的加权平方和加上时间平滑罚项），用信赖域或 L‑BFGS‑B 求解，单调性可通过 I‑spline 基或不等式约束实现。数值实现要点包括：用精确、可自动微分的 ODE 积分器（如 Runge–Kutta 及其自动微分实现：JAX/ODE、CasADi、CVODES）或使用伴随/自动微分计算灵敏度以高效获得梯度与 Hessian；若采用贝叶斯采样，优先使用能利用逆向微分的 HMC 实现以减小每步采样成本；为提升稳定性与可扩展性建议在联立估计中采用 multiple‑shooting 或 direct collocation，将状态在网格点作为变量并以连续性/ODE 残差作为惩罚从而显著降低对初值和潜在时间的敏感性；当潜在时间变量维数大时应降低自由度（采用低维 φ 或漂移模型）或施加强平滑先验以避免过拟合。正则化超参数（如时间平滑强度、σ_t 的先验尺度）通过边际似然最大化、广义交叉验证或基于后验预测的模型选择准则确定；若时间误差预估较小，可使用 SIMEX 作为快速校正备选：在观测时间上模拟扩大噪声、估计参数随噪声强度的响应并外推至零噪声。并行化与资源建议：在贝叶斯或全局优化情形并行运行多条链或多起点；在优化过程中把 spline 平滑估计作为初值并在精化阶段切换到高精度积分；为保证数值精度，ODE 相对误差容差建议 1e‑6–1e‑8，梯度收敛阈值建议 1e‑8，MCMC 采样以 R̂<1.1、有效样本数充足为收敛准则。诊断与输出必须包含：对校正后时间 t*_j 或 w 的可视化、参数估计与不确定度、残差自相关检验、后验预测检验以及灵敏度分析（对 θ 与 φ 的局部灵敏度与 Fisher 信息矩阵的条件数）以评估可辨识性并指导是否需降低时间模型自由度或引入更强先验。推荐可用工具栈包括 Python (scipy.integrate, scipy.optimize, JAX, NumPyro, PyMC), Stan, CasADi/Ipopt 或 MATLAB (ode solvers + optimization toolboxes), 并要求提交可复现的代码、超参数设置、初值选择与计算资源说明。",
      "criteria": {
        "task_understanding": {
          "core_goal": "在观测时间含误差的条件下，拟合并估计动力学参数θ=(α1..α6)，同时校正观测真实时刻t*_j（通过time‑warping/漂移/随机误差模型），并评估估计不确定性与收敛性",
          "expected_output": "参数点估计与不确定性报告（置信区间/后验区间）、校正后时间序列{t*_j}或time‑warp函数φ、残差与后验预测检验图表、可复现的代码/脚本与运行日志",
          "key_inputs_constraints": "1) 观测三元组 (t_obs_j, x_obs_j, y_obs_j), j=1..N，数值序列；2) 假定状态方程 dx/dt=x(α1+α2 y), dy/dt=y(α3+α4 x)（模型结构固定）；3) 时间误差可参数化为独立高斯/漂移/单调warp 三类之一；4) 观测噪声假设（例如独立零均值高斯）或需明示；5) x,y>0 以便对数变换（如用平滑‑微分法）",
          "modeling_type": "拟合+校正+不确定性评估（混合）",
          "role_in_pipeline": "作为参数估计与时间配准的核心环节，依赖前序的数据清洗与正号/单位校验；为后序的模型诊断、敏感性分析与模型改进（如引入Holling项或过程噪声）提供校正时刻和不确定性度量；直接依赖子任务1的可辨识性结论与子任务3的噪声处理策略。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "明确建模目标：参数θ估计与时间校正",
              "description": "是否准确识别子任务需同时估计动力学参数θ和校正真实时刻t*_j（或time‑warp φ），并在问题识别中写明两者共同影响拟合结果的因果关系",
              "score": 40,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：明确写出θ与t*_j耦合并举例说明误差传播；中分：仅写出要估计θ与t*_j但未论述耦合；低分：只估计θ或只校正时间，未识别耦合。"
            },
            {
              "sub_criteria": "识别时间误差模型类别（A/B/C）",
              "description": "是否识别并列出三类时间误差模型：独立高斯σ_t、低维漂移(c0,c1+η)和单调time‑warp(φ)，及各自的可辨识性与复杂度差异",
              "score": 30,
              "evaluation_focus": "问题分解",
              "scoring_hint": "高分：列出三类并说明各类对参数可辨识性的影响；中分：列出三类但未讨论可辨识性；低分：只列出一类或错误描述。"
            },
            {
              "sub_criteria": "识别数值与统计诊断需求",
              "description": "是否识别需给出的诊断项：ODE容差、雅可比/伴随计算、R̂/ESS、残差自相关与时间配准可视化等",
              "score": 30,
              "evaluation_focus": "评估设计",
              "scoring_hint": "高分：明确列出至少3项诊断（如R̂<1.1, ODE tol 1e-6–1e-8）；中分：列出诊断但无阈值；低分：未列出关键诊断。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "用数学表述复述观测模型",
              "description": "是否用方程形式明确写出真实时间t*下的状态方程、观测方程 x_obs=x(t*)+ε, t_obs=t*+δ，并指出ε与δ的统计假定",
              "score": 40,
              "evaluation_focus": "数理表述",
              "scoring_hint": "高分：方程完整，写明噪声分布/先验并区分t_obs与t*；中分：方程完整但未写噪声假定；低分：方程不全或混淆t_obs与t*。"
            },
            {
              "sub_criteria": "复述估计目标与输出形式",
              "description": "是否明确复述需输出参数估计θ、校正后的时刻{t*_j}或warp φ、以及不确定性指标（置信区间/后验区间）与诊断图表",
              "score": 30,
              "evaluation_focus": "目标对齐",
              "scoring_hint": "高分：列出所有输出并指明格式（数值表+图）；中分：列出部分输出；低分：输出不明确。"
            },
            {
              "sub_criteria": "复述可选估计策略（贝叶斯/EM/优化）",
              "description": "能否简要复述三类估计策略（层级贝叶斯、EM/变分、参数化time‑warping优化）并指出各自适用情形",
              "score": 30,
              "evaluation_focus": "方法选择",
              "scoring_hint": "高分：每种方法给出适用场景与优缺点；中分：列出方法但无适用性说明；低分：仅给出单一方法。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "观测噪声假设的明确性",
              "description": "是否给出ε^x_j,ε^y_j的分布假定（例如独立高斯或方差结构），并讨论对估计的影响",
              "score": 30,
              "evaluation_focus": "统计假设",
              "scoring_hint": "高分：给出明确分布并讨论异方差或自相关的影响；中分：假定独立噪声但未讨论影响；低分：未说明噪声模型。"
            },
            {
              "sub_criteria": "时间误差δ_j的假设与正则化",
              "description": "是否对δ_j选择A/B/C之一并给出正则化/先验（如σ_t、二阶差分平滑或I‑spline光滑罚）以控制自由度",
              "score": 25,
              "evaluation_focus": "正则化设计",
              "scoring_hint": "高分：明确模型并给出正则化超参选择方法（GCV/边际似然）；中分：给出模型但未说明超参选择；低分：未考虑正则化。"
            },
            {
              "sub_criteria": "ODE模型与初始条件假设",
              "description": "是否说明初始条件α5,α6的处理（若t0被观测则固定，否则作为估计量），并讨论x,y>0及对数变换条件",
              "score": 25,
              "evaluation_focus": "边界条件",
              "scoring_hint": "高分：明确区分含/不含t0的处理方案并说明x,y正值检查；中分：提及初始值但无具体处理；低分：忽略初始条件问题。"
            },
            {
              "sub_criteria": "可辨识性与降维假设",
              "description": "是否就参数可辨识性给出明确假设（如限制time‑warp自由度或对φ施加单调性）以保证问题可解",
              "score": 20,
              "evaluation_focus": "可辨识性",
              "scoring_hint": "高分：给出可辨识性条件或引用灵敏度/秩检验；中分：提到可辨识性但无操作性检验；低分：未考虑可辨识性。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "完整观测-状态-时间联合模型构造",
              "description": "是否以数学形式构造联合似然/后验 L(θ,{t*_j}|data) 或受限最小二乘目標并包含time‑warp参数φ或δ_j变量",
              "score": 25,
              "evaluation_focus": "数学建模",
              "scoring_hint": "高分：给出明确目标函数（含时间惩罚项）与约束；中分：目标函数给出但不完整；低分：目标函数缺失或模糊。"
            },
            {
              "sub_criteria": "时间配准参数化与单调性约束",
              "description": "对time‑warping选择I‑spline/单调B‑spline或低维漂移并给出单调性实现（基函数或不等式约束）",
              "score": 25,
              "evaluation_focus": "参数化方案",
              "scoring_hint": "高分：明确基函数形式并说明单调性实现；中分：给出warp思路但无实现细节；低分：未参数化warp。"
            },
            {
              "sub_criteria": "估计策略设计（Bayes/EM/优化）",
              "description": "是否为三种估计策略给出可执行步骤（先验选择/EM E步MAP求解/联合优化与多起点方案）并建议初值来源",
              "score": 25,
              "evaluation_focus": "算法设计",
              "scoring_hint": "高分：每策略写出步骤与收敛控制（e.g. Laplace E步, HMC诊断）；中分：策略描述但无步骤细化；低分：仅提名方法。"
            },
            {
              "sub_criteria": "数值稳定性与正则化项的融入",
              "description": "是否把平滑罚项、Tikhonov正则或先验与目标函数结合，并说明如何用GCV/边际似然选超参",
              "score": 25,
              "evaluation_focus": "数值健壮",
              "scoring_hint": "高分：明确给出正则化形式与超参选择方法；中分：提到正则化但无选择方法；低分：忽略正则化。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "ODE积分与灵敏度计算方法选择",
              "description": "是否推荐可自动微分/伴随法的高精度ODE求解器（建议误差容差1e-6–1e-8）并说明为何用伴随或AD计算雅可比/Hessian",
              "score": 30,
              "evaluation_focus": "数值方法",
              "scoring_hint": "高分：指定工具(如JAX/CasADi/CVODES)与容差范围并说明伴随优点；中分：提到高精度但无工具或容差；低分：未提及灵敏度计算或容差。"
            },
            {
              "sub_criteria": "多起点/多射击与降维策略",
              "description": "是否提出multiple‑shooting或direct collocation以降低对潜在时间初值的敏感性，并给出网格选择原则",
              "score": 25,
              "evaluation_focus": "数值鲁棒",
              "scoring_hint": "高分：说明shooting的实现要点与网格策略；中分：提出但无实现细节；低分：未提及。"
            },
            {
              "sub_criteria": "贝叶斯采样或优化收敛准则",
              "description": "是否给出MCMC诊断准则（R̂<1.1, ESS阈值）或优化停止准则（梯度范数、参数增量阈值如1e-8）",
              "score": 25,
              "evaluation_focus": "收敛诊断",
              "scoring_hint": "高分：给出具体阈值并说明多链并行策略；中分：给出诊断项但无阈值；低分：无诊断准则。"
            },
            {
              "sub_criteria": "可扩展性的计算资源建议",
              "description": "是否提供并行化、多线程或GPU加速建议，并针对高维时间变量给出降维或平滑优先策略",
              "score": 20,
              "evaluation_focus": "可扩展性",
              "scoring_hint": "高分：列出并行化方案与降维建议；中分：提到并行化但无细节；低分：未考虑可扩展性。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "可复现的实现与工具链说明",
              "description": "是否提供可运行代码结构说明（脚本/函数分层）、依赖库（NumPyro/JAX/Stan/CasADi/Scipy）与复现步骤",
              "score": 30,
              "evaluation_focus": "可复现性",
              "scoring_hint": "高分：给出完整依赖清单与运行命令并附示例输入；中分：列出工具但无运行脚本；低分：无实现细节。"
            },
            {
              "sub_criteria": "数值与优化超参数在代码中的明确设置",
              "description": "代码中是否明确设置并可修改：ODE容差、优化停止阈值、正则化强度、MCMC链数与步数等",
              "score": 30,
              "evaluation_focus": "工程细节",
              "scoring_hint": "高分：所有关键超参可配置并有推荐默认值；中分：列出部分超参；低分：超参散落或不可调。"
            },
            {
              "sub_criteria": "自动微分/伴随实现与Jacobian验证",
              "description": "是否在代码中使用AD或伴随灵敏度并包含雅可比一致性测试（数值差分对比）以验证梯度正确性",
              "score": 20,
              "evaluation_focus": "数值准确性",
              "scoring_hint": "高分：包含AD实现与数值一致性检验并通过；中分：使用AD但无检验；低分：未使用AD或未检验梯度。"
            },
            {
              "sub_criteria": "结果输出、可视化与日志",
              "description": "代码是否自动生成参数表、t*_j校正图、残差自相关图与采样诊断图，并保存运行日志与随机种子",
              "score": 20,
              "evaluation_focus": "结果呈现",
              "scoring_hint": "高分：自动产出全部诊断图与机器可读结果；中分：产出部分图表或需手动绘制；低分：没有可视化或日志。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "参数估计与不确定性报告",
              "description": "是否报告θ点估计与不确定度（置信区间/后验区间）、并给出参数协方差或后验样本摘要",
              "score": 25,
              "evaluation_focus": "统计解释",
              "scoring_hint": "高分：提供区间、协方差矩阵与解释；中分：仅给点估计或仅近似不确定度；低分：无不确定性报告。"
            },
            {
              "sub_criteria": "校正后时间t*_j或warp的可视化与解释",
              "description": "是否提供校正前后time‑series对比图、warp函数可视化并解释校正的物理/测量意义",
              "score": 20,
              "evaluation_focus": "结果解读",
              "scoring_hint": "高分：有对比图并解释校正趋势；中分：有图但无解释；低分：无可视化或解释。"
            },
            {
              "sub_criteria": "残差、后验预测与自相关诊断",
              "description": "是否做残差自相关检测（ACF/Ljung‑Box）、后验预测检验，并据此判断时间误差模型的充分性",
              "score": 20,
              "evaluation_focus": "模型诊断",
              "scoring_hint": "高分：给出检验统计与结论（p值阈明示）；中分：做了检验但无结论；低分：未做检验。"
            },
            {
              "sub_criteria": "灵敏度/可辨识性分析",
              "description": "是否计算灵敏度矩阵或Fisher信息并报告条件数/奇异值以评估θ与φ的可辨识性并提出降维或强先验建议",
              "score": 20,
              "evaluation_focus": "可辨识性",
              "scoring_hint": "高分：提供奇异值谱与建议（如降维或惩罚）；中分：计算但无解释；低分：未做分析。"
            },
            {
              "sub_criteria": "模型选择与超参数确认",
              "description": "是否用边际似然/GCV/AIC/BIC或后验预测比较不同时间误差模型并给出选择理由",
              "score": 15,
              "evaluation_focus": "模型比较",
              "scoring_hint": "高分：给出量化准则与最终选择并解释；中分：列出准则但未量化比较；低分：未进行模型比较。"
            }
          ]
        }
      }
    }
  }
}