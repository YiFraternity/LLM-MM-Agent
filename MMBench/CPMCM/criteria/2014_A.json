{
  "task_id": "2014_A",
  "problem": "请研究如下问题（部分问题给出了猜想，但问题的解决不局限于这些猜想）：\n\n1. 由于对呼吸的观测是间接的，能否通过分析呼吸的机理，建立数学模型反映小鼠在睡眠状态下与呼吸相关联的脑电波。（猜测：呼吸过程是由脑干部分发出“呼”和“吸”的命令，由神经元集群同步产生动作电位，该电位完成呼吸过程。）\n\n2. 一般认为：在睡眠状态下，小鼠脑电波的周期节律有可能与呼吸相关联[2]。该结论是否正确？通过对所给的视觉感受区的局部电位数据建立模型论证你的结论。\n\n3. 研究在清醒状态下，小鼠视觉感受区的局部电位信号是否有周期性的变化？该周期性的变化是否与小鼠呼吸所对应的脑电波的周期性的变化有关？是线性相关吗？如果不是线性相关，是否具有其他形式的相关性？\n\n4. 建立脑电波信号的分离模型，能否从前两种状态（睡眠状态、无视觉刺激的清醒状态）的局部脑电位信号LC01_20131204_Data10_V1_50s_70s_1kHz.mat、V01_20131126_Data03_80s_110s_LFP_NoStim_1khz.mat中分离出与小鼠呼吸相关联的脑电波信号？\n\n5. 通过Checkboard随时间变化的曲线，分析小鼠视觉刺激的时间曲线及其功率谱，并与呼吸曲线的功率谱对比。利用问题(4)所建立的信号分离模型，从数据V01_20131126_Data03_300s_330s_LFP_VisStim_1khz.mat中分离出与Checkboard刺激相关的脑电波信号成份和可能与呼吸相关的脑电波信号成份？请验证所分离出来的刺激脑电波成份与视觉刺激之间的相关性，并说明该脑电波成份中是否包含图形形状因素。",
  "subtask": {
    "1": {
      "subtask": "子任务1（数据预处理与基础时频/事件描述性分析）旨在把三份原始 .mat 记录（每份 5 路视觉皮层 LFP：Ch11–Ch15，并包含呼吸通道 Ch17、第三份含刺激通道 Ch18；采样 fs=1000 Hz，int16）系统化为可复现、可验证的干净输入并产出一组标准化的描述性输出，用以支持后续建模；其工作范围包括：A) 数据读取与格式化——以 MATLAB/Python（推荐 MATLAB + Signal Processing Toolbox 或 Python 的 SciPy/NumPy/MNE/Neo）读取文件，将 int16 转为浮点并记录原始采样率与通道映射、添加明确元数据；B) 去趋势与工频陷波——对每通道去直流并用零相位（filtfilt）高通滤波（例如 0.1 Hz）去缓慢漂移，按需做 50/60 Hz 陷波（IIR 或 FIR notch）；C) 参考与空间预处理——提供可选参考策略：公共平均参考（CAR）与局部拉普拉斯/CSD（如有电极几何信息）以减少体积传导伪影，并记录所用参考；D) 伪迹与异常检测处理——自动标注并可视化突发大幅值／坡度异常（例如幅值或一阶差分超过通道均值 ±5σ、或超出物理阈值），对短时伪迹用线性插值或用 NaN 标记并在后续分析中排除/补偿，对长段伪迹提出剔除建议；E) 抗混叠下采样（可选）——在需要减小计算负担时先做低通滤波（切频低于目标采样率的一半）再下采样至 200–250 Hz（若需分析 γ 带则不低于 250 Hz），同时保留一份原始 1 kHz 数据以便对高频成分核查；F) 呼吸事件与瞬时相位提取——从 Ch17 提取呼吸峰/谷时刻：先用小带宽平滑（例如 0.5–6 Hz 带通 FIR），用 find_peaks 设置最小峰间隔（根据小鼠呼吸常见范围 1–6 Hz 设置最小间隔 ~0.15–1 s）与 prominence/height 阈值自动检测并人工核验，输出峰/谷时间序列；基于带通后的呼吸信号对其做 Hilbert 变换获得瞬时相位 φ_resp(t)（或用峰间线性相位插值），并输出相位时间序列与相位不确定性估计（考虑传感器延迟的敏感性）；G) 刺激事件提取（仅第三文件）——从 Ch18 检测刺激开始时刻（阈值检测、最小抑制期约 50–100 ms），生成事件时间列表并与原始视频/说明（moveonoff.pdf）比对确认；H) 基础频谱与时频描述——对每通道与通道平均计算功率谱密度（PSD）：推荐使用 Welch（窗长 2 s、50% 重叠）和 multi-taper（time–bandwidth 3、K=5）以获得稳健谱估计，输出 0–200 Hz（或根据下采样调整）的 PSD；计算短时傅里叶谱/连续小波（Morlet）或 multi-taper spectrogram（窗口长度与频率分辨率按所关注频段设定，低频用长窗以提高频率分辨率，高频用短窗以提高时间分辨率），并对功率作基线归一化（dB 或百分比变化）；I) 事件相关平均与时频事件分析——基于刺激时刻计算 ERP（建议基线窗 −200 到 0 ms，响应窗 0–500 ms），并做事件触发的时频分析以识别诱发/诱导频段；J) 初步耦合与描述性度量（描述性，不作深入推断）——计算呼吸通道与各 LFP 通道在呼吸带的线性相关/相干（coherence）与相位一致性（PLV）作为初步描述指标，计算高频包络（γ 带，示例 30–100 Hz，带通后取 Hilbert 包络）与呼吸相位的相位—幅度粗略指标（如 Modulation Index）以供初步观察；K) 统计显著性框架准备——为所有初步度量建立置换检验流程（例如相位随机化、呼吸峰时间打乱、事件时间抖动）以生成零分布并估计 p 值与置信区间，同时保存所有中间伪数据以便复现；L) 可视化与输出——为每一记录产出并存档（1）经处理的 LFP（去趋势、参考后，及下采样版本）；（2）呼吸峰/谷时间表与瞬时相位数组；（3）刺激事件时间表；（4）每通道及平均的 PSD、时频图、ERP 图；（5）初步 PLV/coherence/PAC 数值表与相应置换检验结果；并以标准化格式（.mat/.npy + JSON/YAML 元数据）保存处理参数与日志以确保可重现。该子任务应在实现代码（MATLAB 脚本或 Python notebook）中明确所有滤波器设计（FIR/IIR、阶数、零相位应用）、阈值和参数并提供交互式检查点以便人工核验检测结果，完成后输出用于后续分析的一致、注释齐全且经统计检验准备好的数据集和基础描述性报告。",
      "criteria": {
        "task_understanding": {
          "core_goal": "预处理并评估原始 LFP/呼吸/刺激 数据（int16→浮点、去趋势、陷波、参考、伪迹检测、事件提取、时频/ERP 描述），输出可复现的标准化描述性结果以支持后续建模与评估",
          "expected_output": "已去趋势与陷波的 LFP 时序文件（.mat/.npy）、保留原始 1 kHz 副本、可选下采样版（200–250 Hz）、Ch17 呼吸峰/谷时间序列与瞬时相位数组、Ch18 刺激事件时间表、每通道及均值 PSD（Welch/multi-taper）、时频图谱（STFT/Morlet/multi-taper）、ERP 图、PLV/coherence/PAC 数值表及置换检验 p 值、处理代码与 JSON/YAML 元数据与日志",
          "key_inputs_constraints": "1) 原始三份 .mat 文件（int16, fs=1000 Hz），必须读取并记录通道映射 (Ch11–Ch15 LFP, Ch17 呼吸, Ch18 刺激)；2) 必须实现零相位滤波（filtfilt）并记录滤波器类型/阶数/切频与幅频响应；3) 呼吸峰/谷检测需考虑小鼠呼吸频率范围（约 1–6 Hz），设置最小峰间隔并提供人工核验交互；4) 若电极几何仅为线阵（5 电极，间距 0.25 mm），可选择 CAR 或局部 CSD，需声明几何假设；5) 保留原始 1 kHz 数据以便高频核查（若分析 γ 带，下采样不得低于 250 Hz）。",
          "modeling_type": "评价",
          "role_in_pipeline": "作为特征工程与数据清洗环节，位于模型训练/信号分离前，依赖原始 .mat 数据与实验元信息；为后续信号分离（盲源/半盲）、耦合分析与可视化提供经统计检验准备的输入与诊断报告。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "识别原始数据格式与通道映射（int16 → float，Ch11–Ch15, Ch17, Ch18）",
              "description": "是否识别并记录原始 .mat 的 int16 数据类型、采样率 1 kHz、以及通道映射 Ch11–Ch15（LFP）、Ch17（呼吸）、Ch18（刺激）并保存元数据。",
              "score": 30,
              "evaluation_focus": "数据理解",
              "scoring_hint": "高分：准确列出所有文件名、采样率与通道映射并提供示例读取代码；中分：列出大部分元信息但缺少示例代码；低分：未列出通道映射或采样率错误。"
            },
            {
              "sub_criteria": "识别需要去趋势与工频陷波（filtfilt、0.1 Hz 高通、50/60 Hz notch）",
              "description": "是否指出直流漂移与工频干扰为主要预处理问题，并建议零相位高通（例如 0.1 Hz）与 50/60 Hz 陷波方案并说明使用场景。",
              "score": 25,
              "evaluation_focus": "信号处理",
              "scoring_hint": "高分：明确 0.1 Hz 高通 + notch 方案并说明滤波器类型与理由；中分：提出去趋势与陷波但参数不明确；低分：未识别工频或去趋势需求。"
            },
            {
              "sub_criteria": "识别空间参考与体积传导问题（CAR / 局部 CSD）",
              "description": "是否识别体积传导伪影与参考选择问题并建议至少两种参考策略（公共平均参考与局部拉普拉斯/CSD）同时备注几何假设。",
              "score": 20,
              "evaluation_focus": "空间预处理",
              "scoring_hint": "高分：提出 CAR 与 CSD，两者可行性与实现说明；中分：仅提出一种参考策略；低分：忽略参考/体积传导问题。"
            },
            {
              "sub_criteria": "识别伪迹/异常段及事件（呼吸峰/谷、刺激）提取需求",
              "description": "是否识别瞬时伪迹（大幅值/高坡度）、长段坏段、以及 Ch17/Ch18 的呼吸与刺激事件提取需求并建议人工核验步骤。",
              "score": 25,
              "evaluation_focus": "事件检测",
              "scoring_hint": "高分：列出幅值/一阶差分 ±5σ 等检测规则并要求交互核验；中分：给出检测思路但无阈值；低分：未提出伪迹或事件检测方法。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "复述并分解预处理流水线（int16→float、去直流、陷波、参考、伪迹）",
              "description": "是否将子任务分解为可执行步骤：读取并转浮点、记录元数据、去直流与 0.1 Hz 零相位高通、可选 50/60 Hz 陷波、参考重构、伪迹检测与标注。",
              "score": 30,
              "evaluation_focus": "流程化思维",
              "scoring_hint": "高分：按顺序列出每步并给出实现细节与输出文件名；中分：步骤完整但细节不足；低分：步骤不连贯或遗漏关键步骤。"
            },
            {
              "sub_criteria": "明确滤波器设计参数与零相位实现（filtfilt、FIR/IIR、阶数、切频）",
              "description": "是否复述需在代码中明确记录滤波器类型、阶数、窗函数、切频，并要求呈现频率响应用于验证零相位处理。",
              "score": 25,
              "evaluation_focus": "滤波规格",
              "scoring_hint": "高分：给出具体滤波器类型/阶数/窗与示例；中分：指出需记录但未给参数；低分：未提及滤波器细节或零相位。"
            },
            {
              "sub_criteria": "复述呼吸与刺激事件提取策略（Ch17 峰/谷、Ch18 阈值）",
              "description": "是否说明从 Ch17 用 0.5–6 Hz 带通后 find_peaks 提取峰/谷，并从 Ch18 用阈值与最小抑制期提取刺激起始时刻及人工核验流程。",
              "score": 25,
              "evaluation_focus": "事件提取",
              "scoring_hint": "高分：给出频带、最小峰间隔范围和 prominence/height 建议；中分：给出方法但参数模糊；低分：未说明事件提取细则。"
            },
            {
              "sub_criteria": "复述输出格式与可重现性要求（.mat/.npy + JSON/YAML 元数据）",
              "description": "是否明确要求保存经处理数据、呼吸/刺激时间表、PSD/时频图、置换检验中间数据及完整 JSON/YAML 日志以便复现。",
              "score": 20,
              "evaluation_focus": "可复现性",
              "scoring_hint": "高分：列出所有输出文件与字段并示例元数据；中分：提到保存但无字段细节；低分：未提及可重现性输出。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "对滤波与下采样的稳健性假设（零相位、反走样滤波）",
              "description": "是否明确假设零相位滤波（filtfilt）不会引入相位畸变，并在下采样前做低通以避免混叠，且记录切频与过渡带。",
              "score": 30,
              "evaluation_focus": "方法假设",
              "scoring_hint": "高分：列出具体切频、过渡带与对 γ 带保留的下采样策略；中分：说明原则但无具体数值；低分：未给出下采样/抗混叠假设。"
            },
            {
              "sub_criteria": "对呼吸相位提取与传感器延迟的假设（Hilbert 或峰间插值）",
              "description": "是否陈述对 Ch17 传感器延迟或相对相位不确定性的假设，并说明使用 Hilbert 或峰间线性插值及如何估计相位不确定性。",
              "score": 25,
              "evaluation_focus": "生理假设",
              "scoring_hint": "高分：量化延迟敏感性并给出相位不确定性估计方法；中分：指出可能的延迟影响但无量化；低分：忽略传感器延迟与相位不确定性。"
            },
            {
              "sub_criteria": "对伪迹处理策略的假设（短伪迹插值、长段剔除）",
              "description": "是否假设短时伪迹可线性插值或标记为 NaN，而长段伪迹需剔除并在后续分析中说明影响。",
              "score": 25,
              "evaluation_focus": "伪迹处理",
              "scoring_hint": "高分：给出短/长伪迹判断阈值（如持续时间）并说明插值/剔除规则；中分：给出策略但无阈值；低分：未提出伪迹处置方法。"
            },
            {
              "sub_criteria": "对电极几何与参考方法的假设（线阵 5 电极，间距 0.25 mm）",
              "description": "是否明确电极为一排 5 点、间距 0.25 mm，并据此说明何时可做局部 CSD 与何时仅可用 CAR。",
              "score": 20,
              "evaluation_focus": "几何假设",
              "scoring_hint": "高分：说明何种几何信息满足 CSD 前提并备用方案；中分：提到几何但不说明限制；低分：忽视几何约束。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "滤波器与去趋势模块构建（filtfilt 实现、FIR/IIR 规格）",
              "description": "是否在模型中实施 0.1 Hz 零相位高通、必要的 50/60 Hz notch，并在代码中明确滤波器类型、阶数、窗函数与频率响应验证步骤。",
              "score": 20,
              "evaluation_focus": "滤波实现",
              "scoring_hint": "高分：提供实现代码、频率响应图与量化衰减；中分：提供代码但无响应图；低分：仅口头说明无实现细节。"
            },
            {
              "sub_criteria": "参考与空间预处理模块（CAR 与局部 CSD 可选实现）",
              "description": "是否实现 CAR，并在条件满足时实现局部拉普拉斯/CSD，且记录用于计算的电极坐标与公式/差分权重。",
              "score": 20,
              "evaluation_focus": "空间预处理",
              "scoring_hint": "高分：实现并对比 CAR vs CSD 的示例图；中分：实现一种参考并说明另一种可行性；低分：未实现参考重构或无说明。"
            },
            {
              "sub_criteria": "伪迹检测与处理模块（阈值规则、短伪迹插值/标注）",
              "description": "是否实现自动检测（幅值或一阶差分 ±5σ 或物理阈）并提供交互图形界面供人工校正，短伪迹插值与长段剔除机制需明确。",
              "score": 20,
              "evaluation_focus": "异常处理",
              "scoring_hint": "高分：自动检测＋交互校验＋记录所有修改；中分：自动检测但无交互界面；低分：未实现或无记录。"
            },
            {
              "sub_criteria": "事件提取与相位计算模块（Ch17 峰/谷，Hilbert 相位）",
              "description": "是否实现从 Ch17 的 0.5–6 Hz 带通后提取峰/谷，设置最小峰间隔并输出瞬时相位（Hilbert）与相位不确定性估计方法。",
              "score": 20,
              "evaluation_focus": "事件/相位",
              "scoring_hint": "高分：输出峰/谷表、相位时间序列与不确定性估计；中分：输出峰/谷但无不确定性评估；低分：事件提取不可复现。"
            },
            {
              "sub_criteria": "谱估计与时频分析模块（Welch/multi-taper/STFT/Morlet）",
              "description": "是否实现 Welch（2s 窗 50% 重叠）与 multi-taper（TW=3,K=5）PSD，以及 STFT/Morlet 或 multi-taper spectrogram，并提供基线归一化选项。",
              "score": 20,
              "evaluation_focus": "时频分析",
              "scoring_hint": "高分：实现并展示 PSD 与时频基线归一化图；中分：实现 PSD 或时频之一；低分：缺少稳健谱估计。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "实现与验证滤波/下采样数值稳定性（频率响应、零相位检验）",
              "description": "运行滤波与下采样并通过频率响应图、前后信号对比与相位保持检验验证数值稳定性与无混叠。",
              "score": 25,
              "evaluation_focus": "数值验证",
              "scoring_hint": "高分：提供频率响应图、时域前后比较和无混叠证明；中分：提供部分验证图；低分：无验证或出现混叠痕迹。"
            },
            {
              "sub_criteria": "呼吸与刺激事件检测准确性验证（精确时间表与人工核验）",
              "description": "对 Ch17 峰/谷与 Ch18 刺激起始的检测结果进行人工抽样核验并报告检测准确率或误检率。",
              "score": 20,
              "evaluation_focus": "事件准确性",
              "scoring_hint": "高分：报告检测准确率 ≥ 95%（抽样验证）并列出误检示例；中分：提供模糊准确率估计；低分：无人工核验或准确率极低。"
            },
            {
              "sub_criteria": "谱与时频结果稳健性检验（不同方法一致性）",
              "description": "通过比较 Welch 与 multi-taper、STFT 与 Morlet 结果检验谱/时频一致性，并报告关键频段（如 δ, θ, γ）是否稳健出现。",
              "score": 20,
              "evaluation_focus": "结果稳健性",
              "scoring_hint": "高分：不同方法在关键频段一致并给出量化相似度；中分：部分一致；低分：方法间矛盾且无解释。"
            },
            {
              "sub_criteria": "置换检验/零分布实现以支持后续显著性判断",
              "description": "是否实现相位随机化或事件时间抖动等置换检验生成零分布，并保存中间伪数据以供 p 值估算与置信区间计算。",
              "score": 20,
              "evaluation_focus": "统计准备",
              "scoring_hint": "高分：实现置换检验并给出示例 p 值与置信区间；中分：描述置换方法但未实现；低分：无置换检验准备。"
            },
            {
              "sub_criteria": "数据保存与可复现性（保存所有中间数据）",
              "description": "是否将原始、去噪、下采样版以及事件表、相位序列、PSD/时频数据与日志全部保存为标准化文件并提供读取示例。",
              "score": 15,
              "evaluation_focus": "复现输出",
              "scoring_hint": "高分：所有中间与最终文件完整保存并有读取示例；中分：部分保存；低分：保存不完整或无读取示例。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "可运行的读取与预处理代码（MATLAB/Python notebook，含示例数据路径）",
              "description": "是否提供可执行脚本/Notebook，能从原始 .mat 生成经处理数据（int16→float、去趋势、陷波、参考），并在单次运行中复现结果。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：提供能在干净环境运行的脚本与依赖说明；中分：代码需小改动才能运行；低分：代码无法运行或无示例。"
            },
            {
              "sub_criteria": "完整记录滤波器设计与参数（在代码中注释并输出频率响应）",
              "description": "代码中是否明确记录 FIR/IIR 类型、阶数、窗、切频、零相位应用，并能输出滤波器频率响应图作为检查点。",
              "score": 25,
              "evaluation_focus": "参数可追溯",
              "scoring_hint": "高分：所有滤波参数在代码与元数据中明示并输出响应图；中分：参数部分记录；低分：未记录或不可读取。"
            },
            {
              "sub_criteria": "交互化检查点与可视化（伪迹标注、呼吸峰展示、事件核验）",
              "description": "是否在代码中提供交互检查点（或生成易核验图）用于人工核验伪迹标注、Ch17 峰/谷和 Ch18 刺激事件并允许修改/确认。",
              "score": 20,
              "evaluation_focus": "人工校验",
              "scoring_hint": "高分：有交互或明确生成便于核验的静态图并记录人工调整；中分：仅生成图无交互；低分：无可视化或交互点。"
            },
            {
              "sub_criteria": "输出保存、参数化与文档（.mat/.npy + JSON/YAML 元数据）",
              "description": "代码是否以参数化方式运行（config 文件或函数参数）并将所有输出与处理参数保存为 .mat/.npy 及 JSON/YAML 元数据与运行日志。",
              "score": 25,
              "evaluation_focus": "工程化",
              "scoring_hint": "高分：参数化入口 + 完整输出与元数据；中分：代码可改参数但无 config；低分：硬编码路径且无元数据。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "PSD 与时频图质量检验（Welch/multi-taper 输出与基线归一化）",
              "description": "是否提供每通道与平均的 PSD（Welch & multi-taper）并展示基线归一化后的时频图，同时注注明谱估计参数。",
              "score": 25,
              "evaluation_focus": "谱描述",
              "scoring_hint": "高分：PSD 与时频图清晰、参数齐全并有基线归一化；中分：有图但参数或归一化不完整；低分：缺少 PSD/时频 或参数未说明。"
            },
            {
              "sub_criteria": "ERP 与事件触发时频分析结果（刺激 ERP, 基线 −200–0 ms）",
              "description": "是否提供刺激事件的 ERP（基线 −200–0 ms）和事件触发的时频响应，量化峰值幅度与显著性时窗。",
              "score": 20,
              "evaluation_focus": "事件响应",
              "scoring_hint": "高分：ERP 有置信区间并报告显著时窗；中分：ERP 有但无统计区间；低分：无 ERP 或基线不当。"
            },
            {
              "sub_criteria": "初步耦合度量与置换检验（呼吸-LFP coherence/PLV/PAC 与 p 值）",
              "description": "是否给出呼吸通道与 LFP 在呼吸带的 coherence/PLV 以及呼吸相位—γ 幅度粗略 PAC 并用置换检验估计 p 值/置信区间。",
              "score": 25,
              "evaluation_focus": "耦合描绘",
              "scoring_hint": "高分：给出数值表、置换检验 p 值并解释统计含义；中分：给出数值但无置换检验；低分：仅口头描述无量化。"
            },
            {
              "sub_criteria": "可视化报告与局限性说明（保存图表并说明方法局限）",
              "description": "是否生成结构化描述性报告（包含关键图、方法参数、假设与局限性、供后续建模的建议）并保存所有图表。",
              "score": 30,
              "evaluation_focus": "报告质量",
              "scoring_hint": "高分：完整报告含图表、方法参数、局限与建议；中分：有图表但限于技术细节；低分：无综合报告或未讨论局限。"
            }
          ]
        }
      }
    },
    "2": {
      "subtask": "子任务二目标是从已预处理的多通道视觉皮层LFP（输入：C=5 个经去噪/去趋势并统一参考的通道时间序列，采样率 fs，另带呼吸通道和在有视觉刺激记录时的刺激事件时间表）构建并验证稳健的“半盲”空间滤波器，以分离出与呼吸相关的成分与与视觉刺激相关的成分，方法需在通道数少且时长短的条件下利用外部生理参考（呼吸相位/刺激事件）提供约束而非纯盲ICA；为此任务请按下列步骤执行：一是为目标驱动构造判别统计量——在呼吸分析中，基于呼吸峰/谷周围的短时窗或基于呼吸带（建议初始带宽如0.5–6 Hz，可根据数据自适应调整）提取解析信号（Hilbert）并计算带通实部/包络的协方差矩阵 S_resp_target 与背景协方差 S_bg（背景可取全记录或呼吸外窗口）；在刺激分析中，基于刺激后响应窗口计算刺激后功率或时域响应的协方差 S_stim_target 与基线协方差 S_bg；二是求解广义特征分解（GED）问题 max_w (w^T S_target w)/(w^T S_bg w) 得到按判别力排序的空间滤波器 w（对协方差矩阵需做收缩/正则化 R+λI，λ 通过交叉验证或譜率截断选择），并保留若干最大特征值对应的成分作候选分量；三是作为补充或备选方案，实施约束ICA/ICA-with-reference（以呼吸相位或刺激基函数作为参考约束）及基于回归的空间权重估计：对每通道在目标带的解析信号或包络用呼吸相位基函数（sinφ, cosφ 或更高谐项）和刺激卷积基做岭回归或LASSO，跨通道合并回归系数得到空间权重向量 w；四是对得到的每个空间滤波器产出投影时间序列 y(t)=w^T x(t) 并计算其时频谱、事件触发平均（ERP）、呼吸相位锁定指标（例如 PLV）或带内包络与呼吸相位的相位—幅度相关量，以初步判定该成分是否为目标驱动；五是严格的数值与统计控制：对协方差估计采用正则化与多段平均以减少估计方差，采用交叉验证或留出法选择正则化参数与保留分量数，采用置换检验（如打乱呼吸峰时间、刺激时间抖动或相位随机化）估计成分显著性并控制多重比较；六是为降低体积传导与伪迹风险，建议并行计算孔径参考或局部CSD并检查空间拓扑（w 的元素分布）、分量间相位延迟与相位斜率指数（phase slope index）以判别传播性而非零时刻共同传导伪相关；七是输出规范化结果集——每个候选滤波器的权重向量、投影时间序列、投影的频谱/时频图、事件触发统计、重构能量占比与置换 p 值，并记录所有参数（滤波器规格、窗口长度、正则化λ、交叉验证折数）；八是实现建议与工具链：优先使用线性代数稳定实现（奇异值分解 / 广义特征值解算器），并推荐在 MATLAB（FieldTrip/Chronux）或 Python（MNE-Python, SciPy, sklearn, nitime）环境中实现，确保每一步可重复、参数可变、并能导出可用于下游验证的分量与度量。该子任务的成功判据为：在严格正则化与置换检验下获得若干空间滤波器，它们在统计上显著地捕获与呼吸或刺激时间对齐的时频成分且投影具有明确且可解释的空间拓扑和重构贡献。",
      "criteria": {
        "task_understanding": {
          "core_goal": "构建并验证稳健的“半盲”空间滤波器，通过求解广义特征分解（GED）并进行正则化与置换检验，分离并评估与呼吸相位和视觉刺激事件相关的LFP成分（分离/拟合/评估）",
          "expected_output": "空间滤波器权重向量文件(w向量)、每个滤波器的投影时间序列y(t)、投影的功率谱与时频图、事件触发平均(ERP)、呼吸相位耦合指标(PLV/PAC)、置换检验p值表、重构能量占比、参数/日志文件与可运行代码（MATLAB或Python）",
          "key_inputs_constraints": "1) 预处理后多通道LFP：5通道浮点时间序列（Ch11–Ch15），采样率 fs（Hz），已去趋势与参考；2) 呼吸通道：呼吸峰/谷时间表与瞬时相位 φ_resp(t)；3) 刺激事件表（仅第三记录）：刺激开始时刻数组；4) 约束：短时记录≈30s、通道少（C=5），需协方差正则化与交叉验证；5) 必须记录滤波与参考策略元数据",
          "modeling_type": "混合（分解/拟合 + 评价）",
          "role_in_pipeline": "作为预处理（子任务1）之后的特征/成分提取与验证环节，依赖前序的去趋势/陷波/参考与呼吸相位/刺激事件提取，向后续的耦合分析或行为相关建模输出显著的成分与其度量（PLV/PAC/ERP）"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "识别分离目标：呼吸相关成分与刺激相关成分",
              "description": "明确区分需分离的两类目标成分：与呼吸相位相关的成分和与视觉刺激事件相关的成分，并说明各自判别统计量（S_resp_target、S_stim_target）定义原则。",
              "score": 30,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：准确写出 S_resp_target 与 S_stim_target 的时间窗/频段定义并给出理由；中分：仅笼统描述目标但无明确窗/频段；低分：未区分呼吸与刺激目标或定义矛盾。"
            },
            {
              "sub_criteria": "识别数据约束：短时（≈30s）与少通道（C=5）影响",
              "description": "识别并量化短时、少通道对协方差估计方差、正则化强度与可辨分辨率的影响，并提出对策（收缩/分段平均/降采样策略）。",
              "score": 25,
              "evaluation_focus": "评价/约束处理",
              "scoring_hint": "高分：给出数值估计（如协方差样本数 vs 参数数），并提出具体正则化范围；中分：描述影响但无量化；低分：忽略短时/少通道影响。"
            },
            {
              "sub_criteria": "识别验证准则：置换检验与多重比较控制",
              "description": "明确要用置换检验（如呼吸峰打乱/事件抖动/相位随机化）来评估成分显著性，并说明多重比较修正策略（FDR/最大统计量法）。",
              "score": 25,
              "evaluation_focus": "统计设计",
              "scoring_hint": "高分：指定置换次数（如≥1000）、修正方法并说明零分布构造；中分：使用置换但未说明次数/修正；低分：无置换或仅使用参数检验。"
            },
            {
              "sub_criteria": "识别物理伪影风险：体积传导与伪迹",
              "description": "识别体积传导与电极伪迹对“空间滤波器”解读的风险，并提出判别手段（CSD、相位斜率指数、拓扑检验）。",
              "score": 20,
              "evaluation_focus": "结果可信度",
              "scoring_hint": "高分：列出至少两种判别方法并说明判别阈值或实践步骤；中分：提出方法但无阈值；低分：未考虑体积传导/伪迹。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "复述核心目标：构建半盲空间滤波器并验证",
              "description": "用一两句重述任务：通过 GED/正则化求解空间滤波器，利用呼吸相位与刺激事件作为外部参考，分离并统计检验目标LFP成分。",
              "score": 40,
              "evaluation_focus": "任务对齐",
              "scoring_hint": "高分：复述包含 'GED'、'正则化λ'、'置换检验'、'呼吸相位/刺激事件' 等关键词；中分：提到分离与验证但缺关键方法词；低分：未准确描述使用GED或参考约束。"
            },
            {
              "sub_criteria": "复述预期产出：权重、投影、时频与统计",
              "description": "明确列出预期输出项：权重向量w、投影y(t)、PSD/时频、ERP、PLV/PAC、置换p值与参数日志。",
              "score": 30,
              "evaluation_focus": "输出对齐",
              "scoring_hint": "高分：列出所有关键输出并说明格式（.mat/.npy + JSON元数据）；中分：列出大部分输出；低分：输出描述不完整或模糊。"
            },
            {
              "sub_criteria": "复述实施约束：短数据与交叉验证",
              "description": "明确说明在短时(≈30s)与C=5的约束下要采用收缩协方差、交叉验证选择λ与分量数，并保留原始1kHz以核查高频。",
              "score": 30,
              "evaluation_focus": "可执行性",
              "scoring_hint": "高分：给出交叉验证折数、λ搜索范围或谱率截断策略；中分：提出交叉验证但无细节；低分：未提交叉验证或保留原始数据策略。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "假设信号模型：线性混合模型与空间不变权重",
              "description": "明确假设LFP为线性时不变通道加权的源成分叠加（x(t)=A s(t)+ε），并讨论该假设对GED分离的影响。",
              "score": 30,
              "evaluation_focus": "建模假设",
              "scoring_hint": "高分：明确书写线性模型并讨论非线性/时变对策；中分：仅口头说明线性混合；低分：未声明或与方法不一致。"
            },
            {
              "sub_criteria": "假设呼吸-脑电耦合局限：频带与相位稳定性",
              "description": "假设呼吸相关成分主要限于指定低频带（例如0.5–6 Hz可自适应）且相位可在短窗内近似稳定，说明若不成立的补救策略。",
              "score": 25,
              "evaluation_focus": "频带假设",
              "scoring_hint": "高分：给出频段判定方法（data-driven）与备选频段；中分：使用文献带宽但无自适应策略；低分：无频带假设或与数据不符。"
            },
            {
              "sub_criteria": "假设统计独立性与置换的适用性",
              "description": "假设置换（峰时间打乱/事件抖动）能破坏真实耦合而保留时序特征，说明置换前提与潜在偏差。",
              "score": 25,
              "evaluation_focus": "统计假设",
              "scoring_hint": "高分：解释置换保持自相关结构的方法并说明局限；中分：使用置换但未讨论自相关；低分：盲目置换导致偏差无说明。"
            },
            {
              "sub_criteria": "假设传感器与延迟：呼吸通道时延可校正",
              "description": "假设呼吸传感器有可估计的延迟，应在相位对齐或置换时进行敏感性分析并报告不确定性。",
              "score": 20,
              "evaluation_focus": "实验假设",
              "scoring_hint": "高分：提供延迟估计方案并量化不确定性；中分：提到延迟但无估计；低分：忽略传感器延迟问题。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "构建 S_resp_target 与 S_bg 的协方差定义与窗口选择",
              "description": "详细定义呼吸判别协方差 S_resp_target（基于呼吸带解析信号实部/包络在呼吸周围短窗）与背景 S_bg 的取法并给出窗长/重叠/带宽参数。",
              "score": 25,
              "evaluation_focus": "统计量设计",
              "scoring_hint": "高分：窗长/带宽有数据驱动选择并给出数值（如0.5–6 Hz，窗2s）；中分：给出经验值但无自适应；低分：未定义或参数明显不合理。"
            },
            {
              "sub_criteria": "GED求解与正则化λ选择",
              "description": "构建 GED 问题 max_w (w^T S_target w)/(w^T S_bg w)，并说明协方差收缩/正则化策略（R+λI），λ 的选择方法（交叉验证或谱率截断）。",
              "score": 20,
              "evaluation_focus": "线代/正则",
              "scoring_hint": "高分：实现SVD/广义特征解并用交叉验证或解释性截断确定λ；中分：使用固定λ有理由但无CV；低分：无正则或数值不稳。"
            },
            {
              "sub_criteria": "备选方法：约束ICA/回归权重与比较基线",
              "description": "提出并实现约束ICA或以呼吸基函数(sinφ,cosφ)与刺激卷积基进行岭回归得到空间权重，并将其作为与GED结果的比较基线。",
              "score": 20,
              "evaluation_focus": "方法多样性",
              "scoring_hint": "高分：实现至少一项备选方法并与GED定量比较；中分：提出方法但未实现比较；低分：仅单一方法无备选。"
            },
            {
              "sub_criteria": "成分候选选择与多重比较预处理",
              "description": "定义保留若干特征值最大的成分标准（例如特征值差异阈值或解释方差阈值）并说明如何在后续统计中控制多个候选分量的比较。",
              "score": 20,
              "evaluation_focus": "模型选择",
              "scoring_hint": "高分：给出数值阈值并结合置换最大统计量法控制FWE；中分：有经验阈值但无多重校正；低分：任意保留成分无说明。"
            },
            {
              "sub_criteria": "重构评估指标：能量占比与频谱一致性",
              "description": "定义成分重构能量占比计算方法并要求与投影的PSD/时频一致（呼吸带或刺激带能量增强）。",
              "score": 15,
              "evaluation_focus": "质量度量",
              "scoring_hint": "高分：给出公式并用数值阈值（例如能量占比>2–5%作为初判）；中分：有指标但无阈值；低分：无重构评估。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "数值实现：稳定的GED/SVD解算",
              "description": "使用稳定数值方法（奇异值分解或广义特征值解算器）求解 GED，并说明对协方差矩阵的常规化与条件数控制措施。",
              "score": 30,
              "evaluation_focus": "算法实现",
              "scoring_hint": "高分：提供SVD/GEP调用细节并报告条件数与正则化效果；中分：使用求解器但无条件数诊断；低分：存在数值不稳定或解发散。"
            },
            {
              "sub_criteria": "交叉验证/留一法选择λ与保留分量数",
              "description": "通过交叉验证或留出法选择正则化参数λ与保留分量数，报告验证曲线与选择准则（例如最大化置换z值或解释方差）。",
              "score": 25,
              "evaluation_focus": "参数选择",
              "scoring_hint": "高分：CV结果图与数值并说明选择理由；中分：使用CV但无图或细节；低分：未使用CV或选择任意λ。"
            },
            {
              "sub_criteria": "置换检验与显著性估计",
              "description": "实施置换检验（推荐≥1000次）以评估每个成分与呼吸/刺激的显著性，并报告p值、置信区间与多重比较校正结果。",
              "score": 25,
              "evaluation_focus": "统计检验",
              "scoring_hint": "高分：报告置换次数、p值及FDR或最大统计量校正，显著性阈 p<0.05 或 p<0.01；中分：有置换但次数不足或无校正；低分：无置换检验或报告不完整。"
            },
            {
              "sub_criteria": "成分诊断：空间拓扑与相位传播性检验",
              "description": "对每个成分检查权重向量拓扑（w元素分布）、成分间相位延迟与相位斜率指数以判别传播性与体积传导伪相关。",
              "score": 20,
              "evaluation_focus": "成分解释",
              "scoring_hint": "高分：给出拓扑图、相位延迟统计和PSI结果并据此判定成分类型；中分：提供拓扑但无相位传播检验；低分：无诊断或诊断结论与数据不符。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "可复现的代码与参数记录（滤波器/λ/窗长）",
              "description": "提供可运行脚本或notebook，记录所有滤波器设计（类型、阶数、零相位使用）、λ搜索范围、窗长与重叠等参数，并能从原始预处理数据复现全部结果。",
              "score": 35,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：代码一键运行并输出与报告一致结果且包含参数JSON/YAML；中分：代码可运行但需手动修改参数；低分：代码无法运行或无参数记录。"
            },
            {
              "sub_criteria": "数值稳定性与单元测试",
              "description": "实现数值检查与基本单元测试（协方差正定性检查、奇异值报告、置换流程的随机种子可控），并记录运行时间与资源需求。",
              "score": 25,
              "evaluation_focus": "软件工程",
              "scoring_hint": "高分：包含自动检测与unit test，结果可复现；中分：有基本检测但无测试框架；低分：无检测，随机结果不可复现。"
            },
            {
              "sub_criteria": "交互式检查点与人工核验支持",
              "description": "代码提供交互性检查点（可视化呼吸峰检测、事件检测、协方差热图）以便人工核验并允许调整阈值再运行。",
              "score": 20,
              "evaluation_focus": "可审查性",
              "scoring_hint": "高分：提供交互或脚本化可视化步骤并示例交互调整；中分：提供静态图但无交互；低分：无可视化或核验支持。"
            },
            {
              "sub_criteria": "输出保存与元数据日志",
              "description": "将所有中间与最终结果保存为标准化格式（.mat/.npy + JSON/YAML元数据），并包含随机种子、软件环境与依赖清单。",
              "score": 20,
              "evaluation_focus": "可重现性",
              "scoring_hint": "高分：输出完整并包含环境说明；中分：输出完整但缺环境或依赖说明；低分：无结构化输出或缺元数据。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "显著性报告：置换p值与多重校正结果",
              "description": "清晰报告每个候选成分的置换p值、置信区间及多重比较校正结果（FDR或最大统计量法），并解释统计结论的局限性。",
              "score": 30,
              "evaluation_focus": "统计解释",
              "scoring_hint": "高分：p值<0.05且校正后仍显著；中分：未校正但原始p<0.05；低分：无显著性检验或结果不一致。"
            },
            {
              "sub_criteria": "生理可解释性：拓扑、频谱与相位耦合一致性",
              "description": "基于权重拓扑、投影时频与PLV/PAC结果判断成分是否生理可解释（例如呼吸成分应在低频带增加且与φ_resp相位一致）。",
              "score": 25,
              "evaluation_focus": "生理解释",
              "scoring_hint": "高分：拓扑、频谱与相位耦合三者一致支持呼吸/刺激身份；中分：部分一致；低分：矛盾或无解释。"
            },
            {
              "sub_criteria": "排除伪影：体积传导与伪迹证据评估",
              "description": "通过CSD对比、相位斜率或延迟分析说明成分是否可能由体积传导或电极伪迹引起，并据此调整结论的置信度。",
              "score": 25,
              "evaluation_focus": "特异性",
              "scoring_hint": "高分：提供证据排除体积传导（如非零相位延迟或局部CSD增强）；中分：提供间接证据；低分：无伪影评估。"
            },
            {
              "sub_criteria": "可视化与报告完整性",
              "description": "提供清晰的拓扑图、投影时序、时频图、ERP图与统计表并在报告中总结主要发现、参数与局限性，便于阅卷和复现。",
              "score": 20,
              "evaluation_focus": "沟通表达",
              "scoring_hint": "高分：图表完整并标明参数、显著性与结论；中分：图表较完整但缺部分注释；低分：图表缺失或与文字不一致。"
            }
          ]
        }
      }
    },
    "3": {
      "subtask": "子任务3（动态源模型、耦合形式建模与统计推断）的目标是基于已预处理的多通道LFP（输入：C个参考/去噪后的通道时间序列 x(t)，采样率 fs），以及外生参考信号（呼吸瞬时相位 φ_resp(t) 和可选的刺激事件时间 τ_i），建立并估计一个可解释的动力学因子/状态空间模型以量化潜在神经源的时变轨迹 s(t)、它们的空间混合矩阵 M 及源间耦合结构，并严格判断耦合形式是线性相位锁定还是非线性的相位—幅度调制（PAC）或更复杂的方向性因果关系；为实现该目标请按下列步骤执行：第一，明确并形式化模型框架——以线性高斯状态空间为基础设观测方程 x_t = M s_t + r_t（r_t 为观测噪声）和源动力学 s_t = A s_{t−1} + B u_t + q_t，其中外生输入 u_t 包含呼吸相位的基函数（如 sin(kφ), cos(kφ) 若干谐项）及刺激事件的卷积基（延迟簇），并对高频幅度调制采用扩展形式（例如将高频包络作为状态分量並在其动力学中以非线性函數 g(φ_resp) 建模，或在观测方程中引入乘性项以表示相位—幅度耦合）；第二，参数估计与潜在状态恢复——对线性高斯部分使用EM算法估计参数 (M, A, B, Q, R) 并用卡尔曼滤波/平滑求得 s_t 的后验均值与协方差；对显著非线性部分采用扩展/无迹卡尔曼滤波（EKF/UKF）或粒子滤波器，或采取两阶段方法：先从原始LFP提取低频相位与高频包络（Hilbert），再用带圆形基函数的GLM回归包络以量化PAC；第三，频域与相位测度并行验证——在通道或恢复的源上计算PLV、频域相干（coherence）、相位斜率指数（phase slope index）以检测相位锁定与方向性，计算Modulation Index或基于GLM的循环回归系数以量化PAC强度，并用转移熵/条件互信息等信息论量度作为非线性因果性的补充；第四，统计显著性与模型选择——对所有耦合指标与模型参数通过置换检验（例如呼吸相位随机化、事件时间抖动、相位反转）生成零分布以估计p值并通过FDR校正多重比较；对状态空间模型使用交叉验证、AIC/BIC或留一法来选择潜在源数K与AR阶数P，并通过岭/收缩正则化或贝叶斯先验控制过拟合；第五，不确定性量化与灵敏度分析——通过卡尔曼平滑提供的后验协方差、bootstrap 自助法或贝叶斯变分/MCMC 获取参数与源时间序列的置信区间；并对关键超参（带通带宽、下采样率、正则化强度、基函数数目）做系统敏感性分析以报告结论稳健性；第六，仿真验证与性能评估——构建含已知低频呼吸源、相位调制高频源、刺激响应以及已知混合矩阵的合成数据，在不同SNR、通道数与记录长度下评估模型恢复率（源时间序列相关系数、重构误差、耦合强度偏差）并据此校准估计流程；第七，输出与诊断——最终产出经估计的混合矩阵 M、各潜在源 s_t 的后验均值与不确定区间、线性与非线性耦合度量（含p值）、模型选择指标与残差诊断（残差自相关/白化检验、似然曲线），并保存用于审查的中间产物（滤波器参数、基函数设计、置换样本）；建议实现工具包括 MATLAB（State-Space/Control 工具箱、KF/EM 实现）或 Python（numpy/scipy, ssm/pykalman/pyro, MNE, nitime, tensorpac），并在报告中明确所有算法超参数与判定阈值以确保可复现性。",
      "criteria": {
        "task_understanding": {
          "core_goal": "拟合并估计线性高斯状态空间模型以量化潜在神经源 s(t)、混合矩阵 M 与源间耦合，并评估耦合形式（线性相位锁定 vs 非线性相位—幅度调制PAC）",
          "expected_output": "数值序列（后验源时序 s_t 与置信区间）、矩阵文件（估计的 M, A, B, Q, R）、耦合度量表（PLV, coherence, Modulation Index 与 p 值）、模型选择指标（AIC/BIC/交叉验证结果）、仿真验证报告与可执行代码",
          "key_inputs_constraints": "1) 经预处理的多通道 LFP 时间序列 x(t) (C×T 浮点数组)，采样率 fs（数值）；2) 呼吸瞬时相位 φ_resp(t)（T 长度数组）与可选刺激事件时间 τ_i（时间点数组）；3) 预处理假设：已去趋势、滤波、参考并标注伪迹；额外约束：通道数 C 小、记录时长短、需正则化/收缩；",
          "modeling_type": "拟合+仿真+评价",
          "role_in_pipeline": "作为在数据预处理（子任务1）与半盲空间分离（子任务2）之后的核心建模与统计推断环节，依赖前序提供的经处理 LFP、呼吸相位与刺激事件；为下游解释/可视化和生物学结论提供量化证据与置信区间。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "识别需估计的参数集 M,A,B,Q,R",
              "description": "是否明确定义要拟合的状态空间参数集（混合矩阵 M、动力学矩阵 A、外生输入权重 B、过程噪声 Q、观测噪声 R）并指出其可辨识性问题",
              "score": 40,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：列出 M,A,B,Q,R 并给出可辨识性讨论与约束策略（例如正则化、先验）；中分：列出参数但无可辨识性讨论；低分：参数不全或混淆观测/状态参数。"
            },
            {
              "sub_criteria": "识别耦合形式（线性相位锁定 vs PAC）",
              "description": "能否明确区分并定义线性相位锁定（相位—相位/PLV）与非线性相位—幅度调制（PAC/调制指数）作为待检验耦合形式",
              "score": 35,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：给出 PLV 与 Modulation Index 的数学定义并说明检验方法；中分：描述两类耦合但无具体检验量化；低分：混淆两类或遗漏PAC。"
            },
            {
              "sub_criteria": "识别外生输入与观测约束（呼吸相位与刺激事件）",
              "description": "是否将呼吸相位 φ_resp(t) 与刺激事件 τ_i 明确为外生输入 u_t，并说明如何构造基函数（sin/cos harmonics，卷积基）",
              "score": 25,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：给出具体基函数集合（例如 sin(kφ),cos(kφ), k=1..K）与卷积基参数；中分：声明为外生输入但未给具体基函数；低分：未识别或未利用外生输入。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "复述线性高斯状态空间观测与动力学方程",
              "description": "是否准确写出观测方程 x_t = M s_t + r_t 与动力学 s_t = A s_{t-1} + B u_t + q_t，并说明噪声分布假设",
              "score": 30,
              "evaluation_focus": "数理表达",
              "scoring_hint": "高分：方程精确且给出 r_t,q_t 的分布（零均值、高斯及协方差矩阵）；中分：方程正确但噪声细节缺失；低分：方程错误或遗漏关键项。"
            },
            {
              "sub_criteria": "复述非线性/PAC建模策略",
              "description": "是否阐明处理 PAC 的方案（扩展状态带入高频包络并用 g(φ_resp) 建模，或先提取包络后做 GLM 轮廓回归）",
              "score": 35,
              "evaluation_focus": "方法选择",
              "scoring_hint": "高分：清楚对比两种方案并给出选择依据；中分：描述一种方案但缺少实现细节；低分：忽略或混淆非线性建模。"
            },
            {
              "sub_criteria": "复述模型选择与正则化原则",
              "description": "是否提出选取源数 K、AR 阶数 P 的方法（交叉验证/AIC/BIC），并给出正则化或先验以防过拟合",
              "score": 35,
              "evaluation_focus": "模型选择",
              "scoring_hint": "高分：列出具体选择准则和正则化（岭/收缩或贝叶斯先验）及参数搜索策略；中分：有建议但无量化选择门槛；低分：无模型选择或正则化方案。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "关于线性高斯假设的明确与评价",
              "description": "是否明确假设线性动力学与高斯噪声及其适用范围，并提出检验（残差白化、正态性检验）",
              "score": 25,
              "evaluation_focus": "假设合理性",
              "scoring_hint": "高分：说明何时线性高斯合理并给出残差检验流程；中分：声明假设但无检验方法；低分：未声明或未考虑检验。"
            },
            {
              "sub_criteria": "关于源数 K 与可辨识性的假设",
              "description": "是否假设潜在源数 K ≤ 通道数 C 并说明当 K> C 或源时间短的应对方法（降维/稀疏约束）",
              "score": 25,
              "evaluation_focus": "可辨识性",
              "scoring_hint": "高分：给出 K 的初始选择策略与当 K> C 的备选方案；中分：声明 K≤C 但无备选措施；低分：忽略源数约束。"
            },
            {
              "sub_criteria": "关于呼吸相位与传感器延迟的假设",
              "description": "是否假设呼吸相位 φ_resp(t) 与 LFP 同步或说明如何校正传感器延迟与相位不确定性",
              "score": 25,
              "evaluation_focus": "生理约束",
              "scoring_hint": "高分：提出延迟估计/敏感性分析并给出最大允许延迟；中分：提及延迟但无具体校正措施；低分：忽略延迟问题。"
            },
            {
              "sub_criteria": "关于非线性耦合表现形式的假设",
              "description": "是否假设 PAC 可通过高频包络与低频相位的函数关系表示并说明基函数数目和非线性项形式",
              "score": 25,
              "evaluation_focus": "非线性假设",
              "scoring_hint": "高分：明确 g(φ) 形式或 GLM 基函数并给出选择准则；中分：笼统描述 PAC；低分：未建假设。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "实现状态空间观测与动力学矩阵的构造",
              "description": "是否用矩阵形式构造 M, A 并说明其约束（稀疏性、正交性或生理先验）和正则化实现细节",
              "score": 20,
              "evaluation_focus": "矩阵建模",
              "scoring_hint": "高分：给出约束类型与正则化项并量化（λ范围）；中分：给出约束但无参数范围；低分：无约束说明。"
            },
            {
              "sub_criteria": "外生输入 u_t（呼吸基函数/刺激卷积基）设计",
              "description": "是否具体构造呼吸基函数（sin(kφ),cos(kφ)）与刺激卷积基并说明时延簇与采样对应关系",
              "score": 20,
              "evaluation_focus": "基函数设计",
              "scoring_hint": "高分：明确 k 值、卷积核长度与采样对应；中分：描述形式无具体参数；低分：未构造或与采样不匹配。"
            },
            {
              "sub_criteria": "PAC 与非线性项在模型中的体现方式",
              "description": "是否在状态或观测方程中明确加入高频包络乘性项或在两阶段中用 GLM 描述包络对相位基函数的依赖",
              "score": 20,
              "evaluation_focus": "非线性表示",
              "scoring_hint": "高分：给出数学表达并说明估计方法；中分：提出思想但无公式；低分：忽略或混淆PAC建模位置。"
            },
            {
              "sub_criteria": "模型选择与正则化策略的嵌入",
              "description": "是否在模型构建中预置交叉验证、AIC/BIC 选择 K/P 的流程并说明正则化（岭/LASSO/贝叶斯先验）如何嵌入估计",
              "score": 20,
              "evaluation_focus": "模型选择",
              "scoring_hint": "高分：给出选择流程、折数与阈值；中分：提出方法但无细节；低分：未提供模型选择策略。"
            },
            {
              "sub_criteria": "可解释性与拓扑约束（空间权重 M 的生理解释）",
              "description": "是否为混合矩阵 M 设计可解释性约束或后处理（旋转/归一化）以便空间拓扑解释",
              "score": 20,
              "evaluation_focus": "可解释性",
              "scoring_hint": "高分：提供 M 的归一化/旋转与空间拓扑检验流程；中分：有说明但无具体方法；低分：忽略可解释性。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "参数估计方法与数值稳定性（EM+KF/UKF/Particle）",
              "description": "是否指定 EM + 卡尔曼滤波/平滑用于线性高斯部分，并给出非线性部分的 EKF/UKF 或粒子滤波选择与数值稳定化（SVD、奇异值截断）",
              "score": 30,
              "evaluation_focus": "算法实现",
              "scoring_hint": "高分：列出具体算法、迭代收敛判据与稳定化处理；中分：仅列算法名无稳定化细节；低分：算法选择不当或无收敛判据。"
            },
            {
              "sub_criteria": "正则化参数与交叉验证流程的具体实现",
              "description": "是否给出正则化 λ 的搜索范围、折数、验证指标（对数似然/预测误差）与选择准则",
              "score": 30,
              "evaluation_focus": "模型选择",
              "scoring_hint": "高分：提供 λ 搜索表、折数和评估指标阈值；中分：描述交叉验证但无参数范围；低分：无交叉验证或说明。"
            },
            {
              "sub_criteria": "耦合测度计算与置换检验流程",
              "description": "是否实现 PLV/coherence/PhaseSlopeIndex 与 Modulation Index，并用呼吸相位随机化或事件时间抖动做置换检验与多重比较校正（FDR）",
              "score": 20,
              "evaluation_focus": "统计检验",
              "scoring_hint": "高分：实现置换次数、显著性阈值与 FDR 校正并输出 p 值；中分：做置换但无多重比较校正；低分：无置换检验。"
            },
            {
              "sub_criteria": "仿真验证与性能度量",
              "description": "是否构建含已知呼吸源与PAC的合成数据并报告恢复率（相关系数、重构误差、耦合强度偏差）作为算法验证",
              "score": 20,
              "evaluation_focus": "仿真验证",
              "scoring_hint": "高分：至少两种 SNR 与记录长度场景的量化恢复率；中分：单场景验证；低分：无仿真验证。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "可复现代码与参数记录",
              "description": "是否提供可运行代码（MATLAB/Python）并记录所有滤波器/基函数/正则化等超参数与随机种子以确保复现",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：代码可直接运行并含参数日志与示例数据；中分：代码可运行但参数记录不完整；低分：代码不可运行或无参数说明。"
            },
            {
              "sub_criteria": "数值稳定性与线性代数实现（SVD/GED/奇异值截断）",
              "description": "代码是否使用稳定的线性代数实现（SVD、广义特征值解算器）并处理协方差矩阵正则化/病态问题",
              "score": 25,
              "evaluation_focus": "数值可靠性",
              "scoring_hint": "高分：使用 SVD/GED 且有正则化并给出阈值；中分：使用标准求解器但无病态处理；低分：直接矩阵反演导致不稳定。"
            },
            {
              "sub_criteria": "计算效率与可重复实验接口",
              "description": "是否提供下采样选项、并行化或向量化实现与自动化置换检验接口以便在短记录上可重复运行",
              "score": 25,
              "evaluation_focus": "工程实现",
              "scoring_hint": "高分：实现向量化/并行、提供配置接口与运行时间说明；中分：部分向量化但缺并行或接口；低分：单线程且难以复现。"
            },
            {
              "sub_criteria": "单元测试与示例（含合成数据案例）",
              "description": "是否包含单元测试与合成数据示例验证关键模块（滤波、Hilbert、KF、EM、置换检验）",
              "score": 20,
              "evaluation_focus": "测试覆盖",
              "scoring_hint": "高分：覆盖主要模块且测试通过；中分：含示例但无完整测试；低分：无测试示例。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "源与 M 的估计与不确定度报告",
              "description": "是否提供每个潜在源 s_t 的后验均值、平滑协方差与混合矩阵 M 的置信区间或 bootstrap 结果",
              "score": 25,
              "evaluation_focus": "不确定性量化",
              "scoring_hint": "高分：给出置信区间/误差带并解释生理意义；中分：仅给点估计或仅给方差；低分：无不确定性报告。"
            },
            {
              "sub_criteria": "耦合度量（PLV/PAC/PSI）与显著性",
              "description": "是否对恢复的源或投影计算 PLV/coherence/Modulation Index 与置换检验 p 值并做 FDR 多重比较校正",
              "score": 20,
              "evaluation_focus": "统计推断",
              "scoring_hint": "高分：提供量化值、p 值、FDR 结果并可视化显著频段；中分：提供量化值与置换但无 FDR；低分：仅给原始值无显著性检验。"
            },
            {
              "sub_criteria": "残差诊断与模型拟合优度",
              "description": "是否对观测残差做自相关/白化检验并报告拟合优度（对数似然、AIC/BIC 或预测误差）",
              "score": 20,
              "evaluation_focus": "模型诊断",
              "scoring_hint": "高分：残差无显著自相关且给出多指标拟合度；中分：做部分诊断；低分：无残差检验。"
            },
            {
              "sub_criteria": "灵敏度分析与稳健性检验",
              "description": "是否对关键超参数（带宽、下采样率、λ、基函数数）做系统灵敏度分析并报告结论稳健性",
              "score": 20,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：提供参数网格与结果可视化并说明结论对参数不敏感区间；中分：有限参数检验；低分：无敏感性分析。"
            },
            {
              "sub_criteria": "仿真结果对真实数据结论的映射与生理解释",
              "description": "是否将合成数据验证结果映射回真实数据的结论，讨论生理可解释性（呼吸源、视觉刺激源）与局限",
              "score": 15,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：清晰映射并指出生理意义和局限；中分：有部分讨论但欠深入；低分：结论与仿真不对应或无生理解释。"
            }
          ]
        }
      }
    },
    "4": {
      "subtask": "子任务4（比较分析、刺激成分验证与结果解释）的目标是基于已预处理的数据（输入：参考/去噪且去趋势的视觉皮层多通道LFP（Ch11–Ch15）、呼吸通道的峰/谷时间与/或瞬时相位、以及视觉刺激事件时间表）系统地比较睡眠与清醒（无刺激）条件下呼吸—LFP耦合的差异，检验清醒伴随视觉刺激时提取的刺激相关成分的时间—频率特征与对刺激时序的一致性，并通过一系列严格的对照和统计检验排查替代性解释（如体积传导、传感器延迟或运动伪迹）；为实现该目标按以下步骤实施：1) 明确度量与频带，预先定义呼吸带（建议初值0.5–6 Hz，但要求对每条记录自适应微调）、高频包络带（例如 30–100 Hz）、以及分析窗与谱估计参数（如multi-taper PSD: time–bandwidth 3, K=5；Welch: 2 s 窗、50%重叠）；2) 在睡眠与清醒无刺激两条件下分别计算并比较每通道及通道平均的频谱峰位与功率（multi-taper/Welch），计算呼吸通道与各LFP通道的频域相干（coherence）、低频相位一致性指标PLV（对带通后解析信号用Hilbert提取相位）、以及相位—幅度耦合（PAC，采用Tort的Modulation Index或GLM基函数回归包络对呼吸相位的循环项，典型相位分箱数18）；3) 使用统计显著性框架：对所有主要指标运行置换检验（例如相位随机化、呼吸峰时间打乱或事件时间抖动）以建立零分布，建议置换次数≥2000，并对多重比较采用FDR校正（q=0.05）；明确判定规则（例如：在FDR校正后p<0.05且效应量显著增加被视为支持条件差异）；4) 为区分真实神经耦合与体积传导或伪迹，计算相位斜率指数（Phase Slope Index）或时延-基度量以检测方向性传播，计算局部CSD或参考变换结果以验证空间局部性，并通过对呼吸事件施加时间抖动/延迟敏感性分析评估传感器延时对相位度量的影响；5) 在含视觉刺激的数据中，基于刺激事件做事件触发平均（ERP，基线 −200 至 0 ms，响应窗 0–500 ms）和事件相关时频图（Morlet或multi-taper），并用受约束的空间滤波（例如 GED，正则化协方差 R+λI，建议λ按协方差迹的1e-2比例交叉验证选择）或回归（在设计矩阵中同时包含呼吸相位基和刺激卷积基）提取刺激主导成分；6) 验证刺激成分与刺激时序的一致性：在提取的投影上检验ERP显著性（置换检验）、时频诱发/诱导功率的时空分布，并在存在多类刺激模式时用交叉验证的分类器（正则化线性判别或SVM）检验不同刺激类别在该投影空间的可分性并通过置换估计分类显著性；若刺激仅为二值开/关，则限制性说明仅能检测全局视觉驱动而无法恢复复杂图形编码；7) 汇总输出：为每一比较与检验产出规范化表格（频带功率、coherence、PLV、PAC、PSI、ERP振幅/延迟、分类准确率）、对应的p值与置信区间、使用的参数与正则化值、置换零分布样本、以及必须的可视化（频谱图、时频图、相位直方图、空间权重向量地图）；8) 必备工具与可复现性要求：建议使用具备时频与统计工具箱的环境（例如 MATLAB + FieldTrip/Chronux 或 Python + MNE/nitime/tensorpac），所有处理参数、随机种子和中间数据必须记录并以可重现格式导出；9) 结果解释与保守性声明：在报告中并列展示原始与对照分析（例如带/不带CSD、不同参考）、敏感性测试结果及可能的替代解释，并在结论中仅在统计与控制分析均支持的情况下声明呼吸或刺激为主要驱动因素。",
      "criteria": {
        "task_understanding": {
          "core_goal": "评估并比较睡眠与清醒（无刺激）条件下的呼吸—LFP耦合差异，并检验含视觉刺激记录中提取的刺激相关成分与刺激时序及空间拓扑的一致性与显著性",
          "expected_output": "数值表格（频带功率、coherence、PLV、PAC、PSI、ERP振幅/时延、分类准确率及p值/置信区间）、置换零分布、时频图/ERP图/相位直方图、空间权重向量图、可复现的代码与参数日志、经注释的中间数据文件（.mat/.npy + JSON元数据）",
          "key_inputs_constraints": "1) 预处理后的多通道视觉皮层LFP（Ch11–Ch15，浮点、去趋势、指定参考，采样率fs），2) 呼吸通道峰/谷时间表与瞬时相位φ_resp(t)（Ch17），3) 刺激事件时间表（Ch18，适用于第三文件），4) 限制：记录时长短（30s段）、通道数少（C=5），需严格置换检验与正则化以防过拟合，5) 必需保留原始1kHz数据以便核查高频γ成分。",
          "modeling_type": "评价+拟合+分类",
          "role_in_pipeline": "作为比较分析与验证环节，位于子任务1（数据预处理）和子任务2（分量分离）之后，依赖已预处理的LFP、呼吸相位与刺激事件；为子任务3（动态源模型）提供比较结果、筛选的刺激/呼吸主导成分与统计结论作为输入。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "明确比较对象：睡眠 vs 清醒 的呼吸—LFP耦合指标",
              "description": "是否明确以呼吸—LFP耦合量（例如 coherence、PLV、PAC、PSI）在‘睡眠’与‘清醒（无刺激）’两条件间做定量比较并预先声明比较次序与效应量指标。",
              "score": 40,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：明确定义比较指标（coherence/PLV/PAC/PSI）与效应量度量并给出预期方向；中分：列出指标但未给出效应量单位或方向；低分：未区分睡眠/清醒或未指定耦合指标。"
            },
            {
              "sub_criteria": "识别替代解释与伪迹风险（体积传导、传感器延迟、运动伪迹）",
              "description": "是否识别并列出体积传导、CSD/参考选择、呼吸传感器延迟与运动伪迹等替代解释并给出对策（如CSD、Phase Slope Index、时间抖动检验）。",
              "score": 35,
              "evaluation_focus": "结果可信度",
              "scoring_hint": "高分：明确至少3种替代解释并对应控制方法（CSD/PSI/抖动）；中分：识别若干替代解释但控制策略单一；低分：未识别或忽视关键伪迹。"
            },
            {
              "sub_criteria": "识别刺激一致性检验目标（ERP/时频/分类）",
              "description": "是否识别并界定在含视觉刺激记录中要检验的内容：ERP显著性、事件相关时频诱发/诱导、投影空间对刺激时序的一致性及分类可分性。",
              "score": 25,
              "evaluation_focus": "任务聚焦",
              "scoring_hint": "高分：列明ERP窗（−200–0ms基线，0–500ms响应）、时频方法与分类策略并关联到刺激事件；中分：给出部分指标但缺少窗或统计方案；低分：未明确刺激检验指标。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "复述比较假设与统计判定规则（置换检验+FDR）",
              "description": "是否以置换检验（例≥2000次）与FDR校正明确复述零假设、替代假设、单尾/双尾检验方向及显著性阈值（例如FDR后p<0.05）。",
              "score": 40,
              "evaluation_focus": "统计设计",
              "scoring_hint": "高分：精确说明置换类型（相位随机化/峰时间打乱）、置换次数≥2000、FDR参数及判定规则；中分：提到置换检验但未指定次数或校正方法；低分：未提供统计判定规则。"
            },
            {
              "sub_criteria": "复述频带与谱估计参数（呼吸带0.5–6Hz、高频包络30–100Hz等）",
              "description": "是否明确呼吸带初值（0.5–6Hz）并声明对每记录自适应调整规则，同时复述PSD/时频参数（multi-taper TW=3,K=5；Welch窗2s/50%重叠）。",
              "score": 35,
              "evaluation_focus": "方法细节",
              "scoring_hint": "高分：给出默认带宽并说明自适应调整准则与谱估计参数；中分：给出部分参数但未说明自适应策略；低分：频带或谱参数模糊。"
            },
            {
              "sub_criteria": "复述控制分析与灵敏度测试方案",
              "description": "是否复述将执行的对照（CSD/不同参考、呼吸延迟敏感性、时间抖动）与灵敏度分析以检验结论稳健性。",
              "score": 25,
              "evaluation_focus": "验证设计",
              "scoring_hint": "高分：逐项列出对照及评判标准并指明预期判据；中分：列出对照但无判据；低分：未包含对照或敏感性测试。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "生理与信号学假设（呼吸能驱动0.5–6Hz LFP）",
              "description": "是否明确假设：呼吸节律可在视觉皮层产生可测低频成分（默认呼吸带0.5–6Hz），并说明对传感器延迟或相位偏移的容忍度。",
              "score": 40,
              "evaluation_focus": "生理假设",
              "scoring_hint": "高分：明确呼吸带并量化相位不确定性/延迟容忍（例如≤50ms）及其对PLV/PSI的影响；中分：提出假设但无量化细节；低分：未提出生理假设或不切实际。"
            },
            {
              "sub_criteria": "关于刺激驱动假设（ERP/诱发功率应对刺激时序相符）",
              "description": "是否假定刺激成分在刺激后短时窗内（0–500ms）表现为ERP或时频功率上升，并说明成分可能是否包含图形形状信息的局限性。",
              "score": 30,
              "evaluation_focus": "刺激假设",
              "scoring_hint": "高分：明确定义ERP窗与对图形编码的解释边界；中分：仅给出ERP窗但未讨论形状信息限制；低分：未说明刺激假设。"
            },
            {
              "sub_criteria": "统计与估计假设（置换独立性、正则化可行性）",
              "description": "是否明确置换检验所依赖的独立性假设、协方差正则化（R+λI）可行性及在短时长与少通道条件下的稳健性边界。",
              "score": 30,
              "evaluation_focus": "统计假设",
              "scoring_hint": "高分：描述置换独立性限制、正则化选择方法（交叉验证或迹比例）并给出可接受样本量/通道数下界；中分：提及但无界定；低分：忽视统计假设限制。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "构建比较模型并选择耦合度量（coherence/PLV/PAC/PSI）",
              "description": "是否在模型中明确使用coherence、PLV、PAC（例如Tort MI或GLM回归）、Phase Slope Index来量化呼吸—LFP耦合与方向性，并说明计算参数。",
              "score": 25,
              "evaluation_focus": "指标选择",
              "scoring_hint": "高分：为每个指标给出计算参数（窗长、分箱数18、频带），并说明为何该指标用于呼吸/刺激；中分：指标合适但参数不完全；低分：指标选择与任务不匹配。"
            },
            {
              "sub_criteria": "刺激成分提取模型（GED/正则化回归/ERP）",
              "description": "是否搭建受约束的空间滤波或回归方案（GED: S_target vs S_bg, λ正则化策略；或回归包括呼吸相位基与刺激卷积基）用于提取刺激主导成分。",
              "score": 25,
              "evaluation_focus": "空间滤波",
              "scoring_hint": "高分：明确GED矩阵构造、正则化选择与保留分量判据；中分：使用GED但未给出正则化细节；低分：未提供可复现的提取方案。"
            },
            {
              "sub_criteria": "统计显著性模型（置换检验、FDR、多重比较控制）",
              "description": "是否为每一主要比较建立置换检验流程（如相位随机化/峰打乱）、置换次数与FDR多重比较控制，并定义显著性解读准则。",
              "score": 25,
              "evaluation_focus": "统计控制",
              "scoring_hint": "高分：提供置换类型、次数（≥2000）、FDR参数并明确p阈值；中分：有置换但次数或校正不充分；低分：无或不当的统计控制。"
            },
            {
              "sub_criteria": "区分体积传导与传播性（CSD、PSI、相位延迟检验）",
              "description": "模型是否包含用于判别体积传导与方向性传播的度量（局部CSD、Phase Slope Index、相位斜率或时延敏感性分析）。",
              "score": 25,
              "evaluation_focus": "伪迹区分",
              "scoring_hint": "High: 使用CSD+PSI并报告阈值与结果；中: 使用其中一种方法；低: 未考虑体积传导。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "数值求解与正则化（GED求解、λ选择）",
              "description": "是否稳健求解广义特征分解并说明数值方法（SVD/GEV解算器）、协方差收缩/λ选择（交叉验证/迹比例），以及对短时数据的处理策略。",
              "score": 30,
              "evaluation_focus": "数值稳定性",
              "scoring_hint": "高分：使用SVD/GE解并给出λ选择过程与交叉验证结果；中分：提供数值方法但未验证λ选择；低分：数值方法欠缺或无正则化。"
            },
            {
              "sub_criteria": "置换检验与置信区间估计实现",
              "description": "是否实现置换检验获得零分布并从中计算p值与置信区间，置换种类（相位/峰打乱）与次数记录完整并可重现。",
              "score": 25,
              "evaluation_focus": "统计实现",
              "scoring_hint": "高分：置换≥2000次且返回p值、CI及零分布图；中分：置换次数不足或报告不全；低分：无置换检验或不可复现。"
            },
            {
              "sub_criteria": "交叉验证与分类检验（刺激成分可分性）",
              "description": "在刺激成分的分类检验中是否使用交叉验证（折数说明）、正则化分类器（LDA/SVM）并通过置换估计准确率显著性。",
              "score": 25,
              "evaluation_focus": "预测验证",
              "scoring_hint": "高分：使用k折交叉验证、报告混淆矩阵与置换p值；中分：有分类但无置换显著性检验；低分：分类方法缺乏交叉验证或不可复现。"
            },
            {
              "sub_criteria": "可复现性与数值诊断（残差、自相关检验）",
              "description": "是否对模型残差做自相关/白化检验并报告残差统计，记录随机种子及计算环境确保结果可复现。",
              "score": 20,
              "evaluation_focus": "可复现性",
              "scoring_hint": "高分：提供残差检验结果、随机种子与运行环境；中分：部分记录运行环境或无残差检验；低分：不可复现或无诊断。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "可复现的代码与参数记录",
              "description": "代码是否提供执行脚本/notebook、依赖清单、随机种子、并以 .mat/.npy + JSON元数据形式保存中间结果与最终表格。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：提供可运行脚本、依赖清单、示例命令与参数JSON；中分：有代码但缺依赖清单或参数文件；低分：代码缺失或不可运行。"
            },
            {
              "sub_criteria": "滤波/陷波/参考处理实现细节（零相位filtfilt、notch等）",
              "description": "代码是否明确实现去直流、零相位高通（例如0.1Hz）、50/60Hz陷波及参考策略（CAR或CSD）并记录滤波器设计细节（FIR/IIR、阶数）。",
              "score": 25,
              "evaluation_focus": "信号处理",
              "scoring_hint": "高分：代码注释并输出滤波器响应、相位特性和参数；中分：实现但缺响应说明；低分：滤波器参数不明确或实现错误（无filtfilt）。"
            },
            {
              "sub_criteria": "交互式质检与可视化检查点",
              "description": "是否在代码中提供交互或静态QC图（原始/去趋势/下采样对比、呼吸峰标注、异常段可视化）以便人工核验检测结果。",
              "score": 25,
              "evaluation_focus": "QC可视化",
              "scoring_hint": "高分：提供一组QC图并自动保存；中分：提供部分QC图需手动调用；低分：无QC或难以核验。"
            },
            {
              "sub_criteria": "单元测试与参数范围检查",
              "description": "是否包含基本单元测试或断言（如峰间最小间隔、采样率一致性、协方差矩阵正定性）以防输入异常导致结果失真。",
              "score": 20,
              "evaluation_focus": "代码健壮性",
              "scoring_hint": "高分：有单元测试并对异常输入给出清晰错误消息；中分：部分断言；低分：无测试或错误处理。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "统计结论与效应量报告（频带功率/coherence/PLV/PAC）",
              "description": "是否为每项比较报告效应量（均值差、置信区间）、置换p值及FDR校正后的显著性，并对呼吸带与高频包络给出具体数值表。",
              "score": 30,
              "evaluation_focus": "统计解释",
              "scoring_hint": "高分：完整表格含效应量、CI、FDR后p值并解释生理意义；中分：有p值但无CI或效应量；低分：只陈述显著/不显著无定量。"
            },
            {
              "sub_criteria": "可视化与诊断图（时频、ERP、相位直方图、空间权重）",
              "description": "是否提供清晰的时频图、ERP图、相位直方图、空间权重向量图并在图注中注明频带、窗口与统计显著区域。",
              "score": 20,
              "evaluation_focus": "图表质量",
              "scoring_hint": "高分：图含显著标注、色标、频带注释与对比面板；中分：图较完整但缺显著区域标注；低分：图欠缺或难以解读。"
            },
            {
              "sub_criteria": "对照/灵敏度分析结果解读（CSD/参考/延迟抖动）",
              "description": "是否呈现并解读对照分析结果（不同参考、CSD、呼吸延迟抖动）以说明结论在不同处理下的稳健性。",
              "score": 25,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：展示多种对照的结果并说明哪些结论稳健；中分：有部分对照但解释不足；低分：未做对照。"
            },
            {
              "sub_criteria": "结论保守性与替代解释陈述",
              "description": "是否在结论中谨慎陈述：仅在统计与对照分析均支持下宣称呼吸/刺激为主要驱动，并列出可能的替代解释与局限（如记录长度短、通道数少、图形编码限制）。",
              "score": 25,
              "evaluation_focus": "解释合理性",
              "scoring_hint": "高分：结论与证据尺度一致并列出局限与未来验证步骤；中分：结论基本合理但过度推广；低分：断言性结论未受控证据支持。"
            }
          ]
        }
      }
    }
  }
}