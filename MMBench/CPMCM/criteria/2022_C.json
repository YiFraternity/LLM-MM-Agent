{
  "task_id": "2022_C",
  "problem": "\\section*{优化目标：}\n1. 混动车型间隔 2 台非混动车型为优，权重系数 0.4。\n2. 四驱车型与两驱车型倾向 1:1 出车序列，权重系数 0.3。\n3. 返回道使用次数倾向于 0，权重系数 0.2。\n4. 倾向总调度时间越短越好，权重系数 0.1。\n\n注：该权重系数用于多目标得分加权，各权重系数相加等于 1。\n\n\\section*{优化目标具体量化逻辑：}\n设置每个优化目标初始分，根据下述逻辑更新得分后，再乘以相应系数，得到最终加权总分（理论最高分 100 分）。\n\n1. 优化目标 1（权重系数 0.4，初始分 100 分）：检查出车序列，找到所有混动车身，从出车序列头部按照先后顺序开始算，计算每连续两辆混动车身之间的非混动车身数，不等于 2 则扣 1 分。\n\n2. 优化目标 2（权重系数 0.3，初始分 100 分）：对出车序列进行分块，判断每一分快中的四驱车型与两驱车型之比是否满足 1:1，若不满足，则扣 1 分。对出车序列分块的依据是：如果序列以 4 开头，则根据从 2 变为 4 将序列进行分块；如果序列以 2 开头，则根据从 4 变为 2 将序列进行分块。例如：如果出车序列为 442242444224（4 代表四驱车型，2 代表两驱车型），则该序列分块结果为：4422，42，44422，4，最后两个分块 44422 和 4 都不满足 1:1，扣 2 分。\n\n3. 优化目标3（权重系数0.2，初始分100分）：统计返回道使用次数，每使用一次扣1分。\n\n4. 优化目标4（权重系数0.1，初始分为100分）：假设出车队列长度为$C$，第一辆车身进入涂装-PBS出车口时刻记为零，以最后一个车身进入PBS-总装接车口的时刻$T$为总完成时间，其理论最快完成时间为$9C+72$（全部走进车道4，出车序列与入车序列相同），其时间惩罚值设置为$0.01 \\times (T - 9C - 72)$，最后目标得分为$100 - $时间惩罚值。\n\n\\section*{请建模完成以下优化问题：}\n\n\\textbf{问题1：} 严格按照PBS约束说明及相关时间数据说明，根据涂装出车序列，考虑PBS区域调度能力及限制，建立PBS优化调度模型，使得总装进车序列尽可能满足总装生产需求。给出将你们的优化调度方案分别应用于附件1和附件2数据的得分结果，并将使用附件1和附件2两套数据的调度输出结果按照附件4格式分别存入result11.xlsx和result12.xlsx。\n\n\\textbf{问题2：} 如果去除PBS约束说明中第6、7两条约束，其余约束不变，根据涂装出车序列，考虑PBS区域调度能力及限制，建立PBS优化调度模型，使得总装进车序列尽可能满足总装生产需求。给出将你们的优化调度方案分别应用于附件1和附件2数据的得分结果，并将使用附件1和附件2两套数据的调度输出结果按照附件4格式分别存入result21.xlsx和result22.xlsx。",
  "subtask": {
    "1": {
      "subtask": "子任务1 的目标是对原始输入数据和说明性参数进行系统化清洗、校验与参数化，生成一组结构化、可直接供后续仿真与优化模块使用的规范化输入文件和参数字典。具体范围包括：读取并校验附件1、附件2（涂装出车序列与车辆属性表）、附件3（74 个区域与进/返道停车位及设备位置代码映射表）和附件4（输出矩阵模板的宽表），对字段名称统一、数据类型强制转换并处理缺失或重复值（包括但不限于：确保每辆车有唯一 ID 与进车顺序、车型/动力/驱动字段非空且为规定类别、进车顺序连续且无重复），若发现缺失或异常记录则生成错误报告并按预定义策略（报错/补全/剔除）处理；将附件4 的宽表格式转换为按车和时间索引的长表（每条记录至少包含：车辆ID、时间戳、原始位置编码或空值），并建立时间轴与序号映射（约定第一辆到达涂装‑PBS 出车口的时刻为 0 秒）；显式参数化并输出 PBS 的常量时序参数和约束开关为机器可读字典（包含接车横移机涂装->进车道耗时 t_in = [18,12,6,0,12,18] 秒、送车横移机出车耗时 t_out = [18,12,6,0,12,18] 秒、车进/出返回道往返耗时 t_return = [24,18,12,6,12,18] 秒、道内相邻停车位前移耗时 t_move = 9 秒，以及题目中被允许忽略的装/卸瞬时假设），并将 PBS 规则中可选项（尤其约束6 与 7：返回道10 优先及进车道1 先到优先）实现为布尔配置项以便上层模块开/关；同时根据附件3 校验并输出完整的区域代码映射表（确认总数为 74，并标注涂装‑PBS 出车口、中位位置、各进车道1–10 位编码、返回道1–10 编码、接/送横移机与 PBS‑总装接车口编码），并生成车道容量和位序约束的静态检查报告（核对每道最多10位、每位最多1车的规则是否在初始数据上被违反）；明确输出交付物格式与位置（清洗后的附件1/2 CSV 或 Excel、长表格式的附件4 转换结果、region_code_mapping.csv、pbs_parameters.json、数据校验日志与错误列表），并建议实施工具与方法（推荐使用 Python + pandas/openpyxl 进行读取与转换、使用断言与 schema 校验库进行完整性检查、记录处理步骤与变更日志以保证可复现性）。该子任务不进行调度或仿真求解，其产出应为后续仿真/优化可直接加载的、格式一致且经校验的输入数据集与参数字典。",
      "criteria": {
        "task_understanding": {
          "core_goal": "对附件1/2/3/4进行数据清洗与校验，并参数化PBS约束生成规范化输入与参数字典以供后续仿真与优化",
          "expected_output": "经校验与标准化的附件1/2车辆清单CSV或Excel、附件4宽转长的长表、region_code_mapping.csv、pbs_parameters.json、数据校验日志与错误列表",
          "key_inputs_constraints": "输入：附件1与附件2（涂装出车序列与车辆属性，需唯一车辆ID、连续进车顺序、车型/动力/驱动取值在规定集合且非空）、附件3（74个区域代码映射，需总数=74且编码唯一且覆盖所有位置）、附件4（输出矩阵宽表模板，需转换为按车×时间的长表）。约束：每道容量10、每位最多1车、时间轴以首车到达=0秒、忽略装卸瞬时、参数t_in/t_out/t_return/t_move固定且可配置、约束6/7需以布尔开关输出。",
          "modeling_type": "评价",
          "role_in_pipeline": "作为数据准备与参数化环节，位于仿真/优化求解之前，直接依赖原始附件数据并为后续调度仿真加载；后序任务包括调度仿真、优化求解与指标打分",
          "assumptions": "若附件存在缺失或重复：按策略记录错误日志并剔除无法补全的记录；车型/动力/驱动合法集合以题面与附件字典为准；时间轴上仅建立索引不执行调度。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "识别清洗与校验核心：唯一ID与进车顺序连续性",
              "description": "明确指出需对附件1/2进行唯一车辆ID检查、进车顺序无重复且从1开始连续的系统化校验与修复策略。",
              "score": 35,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：给出唯一性、连续性校验SQL/断言或规则与异常处理；中分：仅口头说明检查；低分：未提及或误将为可缺省。"
            },
            {
              "sub_criteria": "识别字段合法性：车型/动力/驱动枚举校验",
              "description": "指出车型/动力/驱动必须在规定类别集合内且非空，含大小写与别名归一策略。",
              "score": 25,
              "evaluation_focus": "数据规则",
              "scoring_hint": "高分：列出合法集合与映射表；中分：仅说明需合法但无集合；低分：未校验或放任缺失。"
            },
            {
              "sub_criteria": "识别附件3的74个区域代码完整性要求",
              "description": "强调区域代码总数=74、编码唯一、覆盖涂装-PBS出车口、进车道1–10、返回道1–10、接/送横移机、中位与PBS-总装接车口等。",
              "score": 25,
              "evaluation_focus": "约束识别",
              "scoring_hint": "高分：列出需覆盖位置类别并检查去重；中分：仅说明总数=74；低分：忽略或未验证唯一性。"
            },
            {
              "sub_criteria": "识别参数化与约束开关输出需求",
              "description": "识别需输出pbs_parameters.json，含t_in/t_out/t_return/t_move与约束6/7布尔开关。",
              "score": 15,
              "evaluation_focus": "规范意识",
              "scoring_hint": "高分：明确键名与布尔开关；中分：仅提参数不提格式；低分：未输出参数。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "复述输出工件与路径规范",
              "description": "准确重述需产出清洗后的附件1/2、长表、region_code_mapping.csv、pbs_parameters.json、校验日志与错误列表。",
              "score": 35,
              "evaluation_focus": "沟通表达",
              "scoring_hint": "高分：逐项对应并无遗漏；中分：少1项；低分：多数遗漏或混淆格式。"
            },
            {
              "sub_criteria": "复述时间轴与0秒定义",
              "description": "说明时间轴建立方法：第一辆车到达涂装-PBS出车口为0秒，长表以车ID×时间索引。",
              "score": 25,
              "evaluation_focus": "规范理解",
              "scoring_hint": "高分：包含索引粒度与空值处理；中分：仅提0秒；低分：无时间轴或定义错误。"
            },
            {
              "sub_criteria": "复述PBS常量与忽略时刻假设",
              "description": "清楚重述t_in/t_out/t_return/t_move常量与装/卸瞬时忽略的假设在本子任务仅记录不求解。",
              "score": 20,
              "evaluation_focus": "要求对齐",
              "scoring_hint": "高分：枚举数值并指明不求解；中分：缺数值；低分：误将用于计算或未提。"
            },
            {
              "sub_criteria": "复述附件4宽转长与空值规则",
              "description": "说明宽表列为时间、需转为长表记录(车ID,时间,位置编码或空)且支持多区域同时刻取最后区域编码。",
              "score": 20,
              "evaluation_focus": "数据建模",
              "scoring_hint": "高分：描述取最后区域逻辑；中分：仅说宽转长；低分：未提或规则错误。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "缺失与重复处理策略（报错/补全/剔除）",
              "description": "对缺失车型/动力/驱动、重复ID/顺序等给出具体优先级：记录错误、可映射则补全，否则剔除并写入日志。",
              "score": 35,
              "evaluation_focus": "策略设计",
              "scoring_hint": "高分：分情形说明及日志示例字段；中分：泛讲剔除；低分：无策略或随意填充。"
            },
            {
              "sub_criteria": "类别归一与字典假设",
              "description": "对大小写、同义词（如“HEV/混动”）设定映射表并存档版本号。",
              "score": 20,
              "evaluation_focus": "规范治理",
              "scoring_hint": "高分：给出映射示例；中分：仅说明需要；低分：无归一或硬编码隐含。"
            },
            {
              "sub_criteria": "区域代码完整性缺口处理",
              "description": "若附件3少于74或重复，假设流程：阻断下游、报错并请求补齐；不自造编码。",
              "score": 25,
              "evaluation_focus": "风险控制",
              "scoring_hint": "高分：明确阻断并输出缺口清单；中分：仅提示警告；低分：继续运行导致不一致。"
            },
            {
              "sub_criteria": "时间轴边界与空白填充假设",
              "description": "未在74区域时填空白；时间范围以最大完工秒为列数占位但本任务可不生成完整矩阵，仅保持长表空值。",
              "score": 20,
              "evaluation_focus": "一致性",
              "scoring_hint": "高分：明确空值符号与导出类型；中分：未明确定义；低分：混用占位导致歧义。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "数据schema与断言规则构建",
              "description": "为附件1/2/3/4定义字段名、类型、唯一/外键/枚举约束与断言顺序（ID→顺序→类别→区域）。",
              "score": 35,
              "evaluation_focus": "数据建模",
              "scoring_hint": "高分：提供可执行schema或伪代码；中分：部分约束；低分：无schema。"
            },
            {
              "sub_criteria": "宽表到长表的索引与字段设计",
              "description": "长表字段至少含vehicle_id、time_sec、region_code（可空），并定义主键(vehicle_id,time_sec)。",
              "score": 25,
              "evaluation_focus": "结构设计",
              "scoring_hint": "高分：主键与类型明确；中分：缺主键；低分：字段不全或歧义。"
            },
            {
              "sub_criteria": "pbs_parameters.json结构设计",
              "description": "键：t_in,t_out,t_return,t_move,ignore_load_unload,constraint_6_priority,constraint_7_priority，含单位与数组顺序(道1-6)。",
              "score": 25,
              "evaluation_focus": "配置建模",
              "scoring_hint": "高分：列出完整键和值示例；中分：缺1-2键；低分：字段命名混乱或缺数组顺序。"
            },
            {
              "sub_criteria": "region_code_mapping.csv规范",
              "description": "包含region_code, category(如lane_in, lane_return, transfer, interface), lane_id, slot(1-10), uniqueness与计数=74的校验。",
              "score": 15,
              "evaluation_focus": "数据规范",
              "scoring_hint": "高分：给出列定义与计数校验；中分：仅保留code；低分：无法验证完整性。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "求解环节定位为校验执行而非调度仿真",
              "description": "明确不进行调度或优化，只执行规则校验、转换与参数生成的“求解”流程控制与依赖顺序。",
              "score": 40,
              "evaluation_focus": "流程控制",
              "scoring_hint": "高分：列出执行顺序与失败回滚；中分：仅概述；低分：混入调度或无流程。"
            },
            {
              "sub_criteria": "静态容量与位序约束检查实现",
              "description": "基于附件3与初始数据，验证每道最多10位、每位最多1车是否被违反并输出报告。",
              "score": 30,
              "evaluation_focus": "规则验证",
              "scoring_hint": "高分：有具体检查项与输出格式；中分：口头说明；低分：未检查。"
            },
            {
              "sub_criteria": "时间参数与开关可读性与可切换性",
              "description": "验证t_in/t_out/t_return/t_move读取正确、单位一致、约束6/7开关切换生效日志。",
              "score": 30,
              "evaluation_focus": "可配置性",
              "scoring_hint": "高分：读写回显与测试例；中分：仅写入不验证；低分：硬编码。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "使用Python+pandas/openpyxl实现读取与类型强制",
              "description": "提供加载附件1/2/3/4的代码或伪代码，含dtype指定与日期/类别强制转换。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：含异常捕获与dtype；中分：基本读取；低分：无实现细节。"
            },
            {
              "sub_criteria": "宽转长与最后区域编码规则实现",
              "description": "实现按列时间展开，冲突时取同秒最后区域编码，空白填充空值。",
              "score": 30,
              "evaluation_focus": "数据处理",
              "scoring_hint": "高分：明确列名解析与优先顺序；中分：仅melt；低分：未处理冲突。"
            },
            {
              "sub_criteria": "schema断言与错误日志记录",
              "description": "实现断言/校验库（如pandera/自定义）与错误列表CSV/JSON输出、行号与字段级原因。",
              "score": 25,
              "evaluation_focus": "工程稳健",
              "scoring_hint": "高分：结构化日志含计数；中分：简单print；低分：无日志。"
            },
            {
              "sub_criteria": "可复现性：配置与版本记录",
              "description": "记录映射表版本、参数字典版本、运行时间与输入哈希以保证可复现。",
              "score": 15,
              "evaluation_focus": "可复现",
              "scoring_hint": "高分：含版本与哈希；中分：部分记录；低分：无记录。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "校验覆盖率与错误统计报告",
              "description": "输出各类校验的通过率、错误计数（ID重复、顺序缺口、类别非法、区域重复/缺失）。",
              "score": 40,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：表格化指标与比例；中分：仅总数；低分：无统计。"
            },
            {
              "sub_criteria": "区域代码计数=74与唯一性证明",
              "description": "给出计数=74与去重后计数、缺失/多余列表，明确覆盖所有必需类别。",
              "score": 30,
              "evaluation_focus": "一致性验证",
              "scoring_hint": "高分：列出缺失/多余清单；中分：仅给总数；低分：未验证或错误。"
            },
            {
              "sub_criteria": "参数字典正确性与可读性检查",
              "description": "展示pbs_parameters.json内容片段与单位/顺序说明，验证布尔开关写入正确。",
              "score": 30,
              "evaluation_focus": "配置核验",
              "scoring_hint": "高分：含示例与校验日志；中分：仅展示；低分：缺失或字段错误。"
            }
          ]
        }
      }
    },
    "2": {
      "subtask": "子任务2的目标是以“可被执行的目标总装进车序列 σ”为决策变量，系统性地构造并评估一组高质量候选进车序列以最大化题目四项加权得分（混动车间隔 s1、四驱/两驱分块配比 s2、返回道使用次数 s3 及总完成时间 s4）的近似或精确值；为此要求本子任务完成如下工作：输入（清洗后的车辆属性表，包含每辆车的唯一ID、到达顺序、车型/动力/驱动等字段）后，定义 σ 为长度 C 的车辆ID序列，并明确定义并编码评分规则——严格按题目规则计算 s1（对 σ 从头到尾识别所有混动车并统计两者间非混动车数是否等于2 的违例数）与 s2（按从2变为4或从4变为2处断块并判断每块内4:2是否为1:1 的违例计数）；由于 s3（返回道使用次数）与 s4（基于物理调度的完成时 T）需要对缓冲与横移动作代价做时序估计，本子任务须提供两类评估手段：一是快速启发估算器——基于静态成本模型（使用给定的横移时矩阵、道内前移代价 t_move=9s、并假设合理的道位分配策略）计算每个 σ 的预计返回次数与预计完成时间的保守上界或经验值；二是可选的学习型代理（surrogate），用小规模精确仿真样本训练回归模型（例如随机森林或轻量神经网）以在候选搜索中快速预测 s3、s4，从而在搜索迭代中替代昂贵仿真。序列生成方法应包括：（a）基于问题启发的贪心初解构建器：保留涂装到达顺序的局部因果性（例如采用滑动窗口 W 限制的可重排策略），优先把期望快速出库的车辆放置到进车道4类低延迟通道尾位，并在插入时考虑混动车间隔与4/2平衡；（b）定义并实现多种邻域算子：相邻交换、任意位置插入、块交换、k-opt、以及“标记为返回道并在后续位置重插入”的复合操作（用于表示可能的长距离重排）；（c）采用元启发式搜索框架（可选遗传算法、模拟退火或迭代局部搜索/禁忌搜索）在序列空间中并行迭代：个体编码可为直接排列或基于优先级的列表调度编码以便高效交叉/变异且易于保持到达因果性约束；在每次变换后用精确计算的 s1、s2 与启发估算或代理模型预测的 s3、s4 计算综合适应度并用于选择与引导搜索；（d）实现约束处理与可配置策略参数：允许通过参数控制滑动窗口 W、返回操作的单位代价、邻域规模、种群大小与迭代次数，并保证产生的候选序列不会违反基本物理因果性（例如不安排某车在其到达之前进入出车口）——长距离重排必须以“需要使用返回道”的操作标注，以便后续时序验证；输出要求为：一组按得分排序的候选序列集合，每个序列附带精确计算的 s1、s2 值、启发或代理估算的 s3_est、s4_est、产生该序列所用的操作日志（插入/交换/返回标注）以及用于后续评估的元数据（如预计横移机调用次数、预估道位分配概要）；实现建议使用 Python（pandas/numpy 进行数据处理）、DEAP/pygad 等库实现遗传或模拟退火算法、scikit-learn 实现代理模型，并将所有算法参数与随机种子记录以保证可复现性。",
      "criteria": {
        "task_understanding": {
          "core_goal": "优化与评估候选总装进车序列 σ，精确计算 s1/s2 并用启发估算器或代理模型预测 s3/s4，以最大化加权得分",
          "expected_output": "按得分排序的候选序列集合（每条含：σ、s1、s2、s3_est、s4_est、加权总分、生成操作日志、参数与随机种子），可选已训练的代理模型文件与评估报表",
          "key_inputs_constraints": "输入为清洗后的车辆属性表（字段：id、到达顺序、车型、动力、驱动）；σ 为长度 C 的车辆ID排列且不违反到达因果性；s1 按“混动间隔2台非混动”计违例；s2 按2↔4断块计算1:1违例；s3/s4需由启发估算器或学习型代理预测；可配置窗口W与约束6/7开关在本子任务仅用于估算策略；评分权重固定为[0.4,0.3,0.2,0.1]",
          "modeling_type": "优化+评价+预测",
          "role_in_pipeline": "作为调度搜索与评分层：上承子任务1的清洗数据与参数字典，下接子任务3的DES精确验证。该层负责生成高质量σ候选并提供s3/s4快速估计以加速搜索与供后续仿真筛选"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "识别四项评分s1/s2/s3/s4与权重加权",
              "description": "清楚界定混动车间隔s1、四驱/两驱分块s2、返回道次数s3、完成时间s4的定义与计分，并给出0.4/0.3/0.2/0.1的加权总分公式",
              "score": 35,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：给出逐项违例计数与加权汇总公式；中分：描述不全或权重有误；低分：混淆指标或缺少加权"
            },
            {
              "sub_criteria": "到达因果性与σ可行性边界",
              "description": "明确σ必须与到达顺序相容（重排需标注‘返回’代价），并说明长距离重排对应s3成本",
              "score": 25,
              "evaluation_focus": "约束理解",
              "scoring_hint": "高分：定义窗口W或返回标注以保证因果；中分：仅口头提及不落实现；低分：忽略因果性"
            },
            {
              "sub_criteria": "启发估算器与代理模型角色划分",
              "description": "区分静态启发估算器（基于t_in/t_out/t_return/t_move）与学习型代理对s3/s4的用途与适用范围",
              "score": 20,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：阐明两者互补与何时调用；中分：仅列举不区分场景；低分：未提或混淆"
            },
            {
              "sub_criteria": "与子任务3（DES）的接口定位",
              "description": "说明本层输出用于DES精确验证与筛选，避免在本层进行物理仿真",
              "score": 20,
              "evaluation_focus": "流程把控",
              "scoring_hint": "高分：清晰定义输入/输出接口；中分：接口含混；低分：越权实现或缺接口说明"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "严格复述s1定义（混动间隔2台非混动）",
              "description": "按序扫描σ，仅在混动车之间统计非混动车数，偏离2计1违例",
              "score": 30,
              "evaluation_focus": "规则还原",
              "scoring_hint": "高分：给出扫描与计数细节；中分：理解基本正确但边界不全；低分：将间隔误解为任意两车"
            },
            {
              "sub_criteria": "严格复述s2断块与1:1判断",
              "description": "σ以驱动2或4开头，按首次切换处分块，块内4:2不为1:1则计1违例",
              "score": 30,
              "evaluation_focus": "规则还原",
              "scoring_hint": "高分：含示例与起始位处理；中分：无示例或起始条件不明；低分：用固定窗口替代断块"
            },
            {
              "sub_criteria": "s3/s4估算边界与单位时间定义",
              "description": "说明s3为预计返回次数，s4为预计T（秒），引用t_in/t_out/t_return/t_move并遵守装卸瞬时假设",
              "score": 20,
              "evaluation_focus": "量纲一致",
              "scoring_hint": "高分：单位与参数一一对应；中分：单位未统一；低分：时间未定义或与给定常数不符"
            },
            {
              "sub_criteria": "可配置参数与约束6/7在估算器中的作用",
              "description": "阐明窗口W、约束6/7开关如何影响估算策略与成本上界",
              "score": 20,
              "evaluation_focus": "策略理解",
              "scoring_hint": "高分：明确开启/关闭的影响；中分：泛述；低分：未涉及"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "启发估算器对道位分配与排队的合理假设",
              "description": "给出进车道选择、拥塞近似、FIFO与t_move累计的保守或经验假设",
              "score": 35,
              "evaluation_focus": "假设设计",
              "scoring_hint": "高分：明确上界/期望值计算；中分：仅口述策略；低分：无假设即直接打分"
            },
            {
              "sub_criteria": "返回操作与长距离重排成本绑定",
              "description": "假设何种重排必须标注‘返回’并计入s3，避免免费跨越",
              "score": 25,
              "evaluation_focus": "约束量化",
              "scoring_hint": "高分：规则可执行且覆盖边界；中分：规则模糊；低分：忽视返回代价"
            },
            {
              "sub_criteria": "代理模型训练样本与泛化假设",
              "description": "声明用小规模DES样本训练，说明特征、目标（s3,s4）与外推限制",
              "score": 20,
              "evaluation_focus": "数据假设",
              "scoring_hint": "高分：列出特征集与样本量规划；中分：仅提训练；低分：无训练设定"
            },
            {
              "sub_criteria": "随机性与种子控制",
              "description": "假设搜索与代理训练使用固定随机种子确保可复现",
              "score": 20,
              "evaluation_focus": "可复现性",
              "scoring_hint": "高分：明确记录与传递种子；中分：仅在代码中固定；低分：未考虑"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "s1/s2精确计分函数实现与边界处理",
              "description": "提供可调用的σ→(s1,s2)函数，覆盖起始块、尾块与无混动/单驱动边界",
              "score": 30,
              "evaluation_focus": "算法正确",
              "scoring_hint": "高分：线性时间实现+单测样例；中分：实现但边界缺失；低分：与题意不符"
            },
            {
              "sub_criteria": "s3/s4启发估算器设计",
              "description": "构造基于t_in/t_out/t_return/t_move的时间-资源模型，给出T与返回次数的估算公式或仿真近似",
              "score": 25,
              "evaluation_focus": "模型设计",
              "scoring_hint": "高分：给出可复用函数与复杂度；中分：仅伪代码；低分：口头描述"
            },
            {
              "sub_criteria": "代理模型（可选）特征工程与目标定义",
              "description": "定义σ特征（局部4/2比例、混动间距分布、预计道位占用等）与回归目标(s3,s4)",
              "score": 20,
              "evaluation_focus": "特征设计",
              "scoring_hint": "高分：明确10+维特征与标准化；中分：少量特征；低分：直接黑盒训练"
            },
            {
              "sub_criteria": "序列生成与邻域算子集合",
              "description": "构建贪心初解（窗口W）并实现交换/插入/块交换/k-opt/返回标注重插入等操作",
              "score": 25,
              "evaluation_focus": "结构设计",
              "scoring_hint": "高分：至少4类算子+复杂度说明；中分：2-3类；低分：仅随机打乱"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "元启发式搜索框架与适应度",
              "description": "实现GA/SA/ILS/禁忌等之一，适应度=加权(s1,s2,s3_est,s4_est)，并含约束惩罚",
              "score": 35,
              "evaluation_focus": "算法实现",
              "scoring_hint": "高分：含交叉/变异/退火或禁忌列表；中分：简单爬山；低分：无系统搜索"
            },
            {
              "sub_criteria": "参数化与可配置（W、种群、迭代、邻域规模）",
              "description": "所有关键超参可通过配置或命令行设置并记录在结果元数据",
              "score": 20,
              "evaluation_focus": "工程能力",
              "scoring_hint": "高分：参数全可控+落盘；中分：部分可控；低分：硬编码"
            },
            {
              "sub_criteria": "代理训练与交叉验证（若使用）",
              "description": "用小规模DES生成样本，分训练/验证集，报告误差（MAE/R2）并阈值控制替代使用",
              "score": 25,
              "evaluation_focus": "模型选择",
              "scoring_hint": "高分：给出MAE/R2与早停；中分：仅训练无验证；低分：无评估"
            },
            {
              "sub_criteria": "计算性能与并行评估",
              "description": "支持并行评估多个σ（多进程/线程）与批量打分缓存",
              "score": 20,
              "evaluation_focus": "性能优化",
              "scoring_hint": "高分：明确并行与缓存命中；中分：部分并行；低分：串行慢且无缓存"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "s1/s2函数与单元测试",
              "description": "提供可复用API与覆盖典型与边界用例的测试（含题示例442242444224）",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：测试通过且覆盖率说明；中分：少量测试；低分：无测试"
            },
            {
              "sub_criteria": "启发估算器与接口定义",
              "description": "实现s3_est/s4_est函数签名稳定，输入σ与参数字典，返回标量估计与摘要",
              "score": 20,
              "evaluation_focus": "接口设计",
              "scoring_hint": "高分：类型注解与文档；中分：函数可用但文档少；低分：耦合严重"
            },
            {
              "sub_criteria": "搜索与邻域算子实现的健壮性",
              "description": "算子维护到达因果性与返回标注一致性，出错有断言与日志",
              "score": 25,
              "evaluation_focus": "健壮性",
              "scoring_hint": "高分：异常处理与回滚；中分：基本断言；低分：易崩溃"
            },
            {
              "sub_criteria": "可复现性与配置落盘",
              "description": "记录随机种子、超参、版本号；输出JSON/CSV的候选集与日志",
              "score": 25,
              "evaluation_focus": "可复现性",
              "scoring_hint": "高分：运行即复现实验；中分：部分记录；低分：无记录"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "候选序列排名与分数分解",
              "description": "报告前K条σ的s1/s2/s3_est/s4_est与加权总分，展示权重贡献",
              "score": 35,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：表格+贡献图；中分：仅列表；低分：仅给总分"
            },
            {
              "sub_criteria": "敏感性分析（权重或W/约束6/7开关）",
              "description": "展示权重或窗口W/开关变化对最优σ与分数的影响",
              "score": 25,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：至少2种参数情景；中分：定性讨论；低分：无分析"
            },
            {
              "sub_criteria": "估算器/代理与小规模DES对比校验",
              "description": "抽样若干σ用DES计算真实s3,s4并对比s3_est/s4_est误差",
              "score": 25,
              "evaluation_focus": "校验能力",
              "scoring_hint": "高分：给出MAE或相对误差≤20%；中分：给出误差但较大；低分：无对比"
            },
            {
              "sub_criteria": "操作日志与可行性说明",
              "description": "说明生成σ所用交换/插入/返回标注等操作是否与物理因果一致",
              "score": 15,
              "evaluation_focus": "一致性",
              "scoring_hint": "高分：日志可追溯；中分：部分缺失；低分：无法复现操作路径"
            }
          ]
        }
      }
    },
    "3": {
      "subtask": "子任务3（PBS 物理仿真器与可行性验证器）要求独立实现一个精确、确定性的离散事件仿真（DES）内核，用以严格执行题目给定的 PBS 物理结构与操作规则并输出逐秒的车辆区域状态与关键运行指标。其范围与目标：输入为已清洗的车辆到达序列（按涂装‑PBS 出车口顺序）、PBS 参数字典（各进车道/返回道停车位数、横移机往返各道耗时数组 t_in/t_out/t_return、道内相邻位前移耗时 t_move=9s、被忽略的装卸瞬时假设等）、区域代码映射表；输出为（1）按实际进入 PBS‑总装接车口顺序生成的进车序列，(2) 最后一辆进入接车口的绝对时刻 T，(3) 返回道被使用的累计次数 R，(4) 按题目格式的 C × (T+1) 秒级矩阵（每行为一车，每列为该秒内最后到达区域的代码），以及详尽事件日志和状态快照用于验证。实现要点与步骤：使用事件队列（优先级堆）管理事件（车辆到达中位、接车横移机开始/结束、送车横移机开始/结束、道内车辆前移开始/结束、车辆装卸到总装或返回道等）；用明确的数据结构表示系统状态：每条进车道与返回道为长度为10的数组或循环队列记录各停车位占用与“正在前移”标志，横移机状态记录 busy 标志、当前动作目标道及动作完成时刻；为保证不可中断性，任何横移机开始动作即在事件队列中注册完成事件，期间禁止对该机调度其他动作；对道内前移实现原子动作：当位 p 变为空且位 p+1 有车时立即（在相同仿真时间点）计划一个耗时 t_move 的前移事件并标注该车在该区间不可被调度或移动（以满足题目第11、12条）；实现互斥规则确保任一停车位在任一时刻最多被一个车辆占用且在前移期间被锁定。优先与策略规则应作为可配置项实现（布尔开关）：约束6/7（当返回道10有车且接车机空闲优先处理；当若干进车道1有车且送车机空闲优先最先到达者）在仿真器中可启用或禁用；送车机不得直接将返回道车辆送入接车口等硬约束必须强制执行。时间建模细节：按题目假定将装卸到横移机与从横移机卸载到位的瞬时时间视为零，横移机动作耗时以给定常数表为准，从中位出发并在完成后隐式生成“返回中位”动作（即动作结束即处于中位空闲）；若在同一秒内车辆跨越多个区域，记录时刻列时以事件完成顺序最后发生的区域代码为该秒值。实现细节与健壮性：事件处理采用严格时间顺序且处理同一时刻多事件的确定性策略（例如先处理横移机完成，再处理前移开始，以明确冲突和优先级），对并发冲突使用可配置的 tie‑break 规则（首到优先或按车辆 ID），并在仿真开始前对输入完整性与容量约束做断言检查。验证与输出：在仿真后运行一致性校验（无重叠占用、道内 FIFO 保持、横移机不可同时承担两次动作、返回道/进道位容量未超限），并导出每秒区域矩阵、事件日志、横移机利用率曲线、各道位占用随时间变化的快照；为便于回溯与重复性，仿真应接受随机种子（仅影响并发 tie‑break）并在日志中记录所有配置参数和版本信息。性能与工程实现建议：推荐使用高性能语言或成熟 DES 库（例如 Python+heapq/SimPy、或 C++ 实现）以保证对 200–450 辆规模的多次仿真在秒级或数十秒内完成，事件复杂度近似 O(事件数)；支持批量并行仿真评估（多线程/多进程）与可视化输出（时序图、道位占用热力图）以便上层调度器调用与验证。总体要求：仿真器必须能在不依赖外部调度模块的情况下，单独接收输入参数严格执行所有物理与逻辑约束、切换约束6/7 的实现方式，并输出题目要求的逐秒状态矩阵与完整可验证的运行日志。",
      "criteria": {
        "task_understanding": {
          "core_goal": "构建并评估一个确定性的离散事件仿真（DES）内核以仿真PBS物理调度、验证可行性并逐秒输出区域矩阵与关键指标。",
          "expected_output": "（1）总装接车口实际进车序列；（2）最后一车进入时刻T；（3）返回道使用次数R；（4）C×(T+1)逐秒区域代码矩阵；（5）事件日志与状态快照；（6）一致性校验报告。",
          "key_inputs_constraints": "输入：清洗后的车辆到达序列（含车型/动力/驱动/唯一ID、顺序）；pbs_parameters.json（t_in/t_out/t_return/t_move、装卸瞬时、容量=10等）；region_code_mapping（74个代码完整且唯一）；约束6/7布尔开关；时间从0秒起。关键约束：横移机动作不可中断、同位互斥、道内FIFO前移t_move=9s、送车机不得由返回道直接送入接车口、同秒多事件确定性处理顺序。",
          "modeling_type": "仿真",
          "role_in_pipeline": "作为中间核心环节：在子任务1数据清洗/参数化之后、上层调度与优化评分之前，独立执行PBS物理与逻辑规则并产出可验证轨迹与指标；前序依赖：子任务1；后续依赖：调度策略评估与优化打分。",
          "assumptions": "并发tie-break仅影响同刻竞争的进/送车选择，使用固定规则（先到时间戳、若并列按车辆ID升序）；装卸时间按题设忽略为0；事件处理顺序采用“横移机完成→前移完成→新动作开始”的确定序。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "识别DES内核与PBS物理约束的核心范围",
              "description": "明确本任务是构建确定性离散事件仿真以执行PBS规则（横移机、进/返道、道内移动）并生成逐秒区域矩阵与T、R等指标，而非优化调度器。",
              "score": 35,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：清楚区分仿真与优化，列出T、R、矩阵输出；中分：指出仿真但遗漏部分指标；低分：将任务当作优化或仅描述数据处理。"
            },
            {
              "sub_criteria": "关键输入与约束识别（t_in/t_out/t_return/t_move与约束6/7开关）",
              "description": "准确点名并约束使用pbs_parameters与region_code_mapping、容量=10及约束6/7可开关，送车机不得直接送返回道至接车口等硬约束。",
              "score": 35,
              "evaluation_focus": "需求拆解",
              "scoring_hint": "高分：完整覆盖四类耗时与硬/软约束；中分：缺少1-2个关键耗时或约束；低分：未提关键耗时或误解硬约束。"
            },
            {
              "sub_criteria": "时间刻度与同秒事件处理顺序",
              "description": "确认秒级时间轴起点为0，并提出同刻事件确定性顺序（如先横移机完成再前移），解决并发冲突。",
              "score": 30,
              "evaluation_focus": "时序理解",
              "scoring_hint": "高分：给出明确且一致的处理序；中分：有顺序但含糊；低分：未说明或顺序自相矛盾。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "逐秒区域矩阵与“最后到达区域代码”规则复述",
              "description": "准确复述同秒多区域经过时记录最后到达区域代码的填充规则，并覆盖C×(T+1)矩阵的维度定义。",
              "score": 35,
              "evaluation_focus": "需求澄清",
              "scoring_hint": "高分：给出示例/边界说明；中分：仅口述规则无实例；低分：忽略该规则或维度定义错误。"
            },
            {
              "sub_criteria": "R与T的定义与度量口径",
              "description": "阐明返回道使用次数R的计数口径（每次送入返回道计1）与总完成时间T（最后一车进入接车口的秒）。",
              "score": 35,
              "evaluation_focus": "指标口径",
              "scoring_hint": "高分：口径清晰并与事件匹配；中分：概念正确但口径模糊；低分：混淆或遗漏R/T定义。"
            },
            {
              "sub_criteria": "约束6/7优先策略的可配置复述",
              "description": "说明当开关启用时接车机优先返回道10、送车机优先最先到达1位车辆；禁用时采用通用tie-break。",
              "score": 30,
              "evaluation_focus": "规则解读",
              "scoring_hint": "高分：描述启用/禁用两种行为与冲突解决；中分：只述启用行为；低分：未提可配置或误解优先级。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "装卸瞬时与“返回中位”行为假设",
              "description": "明确装/卸为0时长，横移机动作完成即处于中位空闲，不需单独建模返程事件。",
              "score": 35,
              "evaluation_focus": "建模假设",
              "scoring_hint": "高分：与题设一致并说明对事件队列影响；中分：只提0时长；低分：引入非零装卸或遗漏返中位假设。"
            },
            {
              "sub_criteria": "并发tie-break与确定性种子",
              "description": "提出先到时间戳、同刻按车辆ID等稳定规则，并支持固定随机种子记录于日志（虽为确定性）。",
              "score": 35,
              "evaluation_focus": "冲突处理",
              "scoring_hint": "高分：给出可复现实施细则；中分：仅口头说明；低分：无规则导致不确定结果。"
            },
            {
              "sub_criteria": "道内前移的原子性与锁定期",
              "description": "当p+1空且p有车，立即计划t_move=9s前移，期间锁定位点与车辆，禁止被调度。",
              "score": 30,
              "evaluation_focus": "时序细化",
              "scoring_hint": "高分：定义锁定对象与触发条件；中分：只提立即前移；低分：允许前移被打断或调度。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "事件队列（heapq）与事件类型设计",
              "description": "定义到达中位、接车横移机开始/结束、送车横移机开始/结束、前移开始/结束、装卸到接车口/返回道等事件集合与字段。",
              "score": 25,
              "evaluation_focus": "结构设计",
              "scoring_hint": "高分：事件覆盖全面且字段完备；中分：缺少1类事件；低分：无事件化设计或混用轮询。"
            },
            {
              "sub_criteria": "系统状态结构：车道数组与互斥锁",
              "description": "每道10位数组含占用/进行中标志；横移机busy、目标道、完成时刻；位级互斥与占用校验。",
              "score": 25,
              "evaluation_focus": "数据建模",
              "scoring_hint": "高分：位级与车级状态清晰；中分：到道级但缺位级锁；低分：仅列表车辆无位状态。"
            },
            {
              "sub_criteria": "优先策略与约束开关注入（约束6/7）",
              "description": "将优先逻辑抽象为策略模块，布尔开关切换两套决策；硬约束（返回道→接车口禁止）强制检查。",
              "score": 25,
              "evaluation_focus": "可配置性",
              "scoring_hint": "高分：策略可替换且覆盖校验；中分：硬编码策略；低分：忽略开关或破坏硬约束。"
            },
            {
              "sub_criteria": "逐秒区域矩阵生成机制",
              "description": "基于事件完成顺序在每秒末确定“最后到达区域代码”；处理空白与多区域同秒覆盖。",
              "score": 25,
              "evaluation_focus": "输出建模",
              "scoring_hint": "高分：提供确定的落点时机与覆盖规则；中分：仅累积位置；低分：无法还原逐秒矩阵或错位。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "事件处理顺序与不可中断性实现",
              "description": "同刻按既定顺序执行，横移机开始即登记结束事件，中途不接收新任务；前移原子执行。",
              "score": 35,
              "evaluation_focus": "算法执行",
              "scoring_hint": "高分：代码或伪码体现锁与排他；中分：口述实现；低分：允许中断或并发冲突。"
            },
            {
              "sub_criteria": "容量与FIFO一致性检查",
              "description": "全过程断言每位≤1车、每道≤10、FIFO顺序不被跨越（同道内不可插队）。",
              "score": 30,
              "evaluation_focus": "正确性校验",
              "scoring_hint": "高分：有在线断言+终局验证；中分：仅终局；低分：无校验或发现违规仍继续。"
            },
            {
              "sub_criteria": "指标计算（进车序列、T、R）正确性",
              "description": "从事件日志稳定提取接车口到达顺序、最后到达时刻T、返回道送入次数R。",
              "score": 35,
              "evaluation_focus": "指标计算",
              "scoring_hint": "高分：给出事件类型到指标的映射；中分：可得但口径含糊；低分：遗漏或口径错误。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "性能与可扩展性（200–450车规模）",
              "description": "使用heapq/优先队列，复杂度近似O(事件数)；单次仿真秒级至数十秒；支持批量运行。",
              "score": 30,
              "evaluation_focus": "代码效率",
              "scoring_hint": "高分：有基准或复杂度分析；中分：无数据但结构合理；低分：使用低效轮询导致不可用。"
            },
            {
              "sub_criteria": "可配置参数加载与版本化日志",
              "description": "从pbs_parameters.json与region_code_mapping加载；日志记录随机种子、配置、版本与开关状态。",
              "score": 25,
              "evaluation_focus": "工程规范",
              "scoring_hint": "高分：配置热插拔与完整日志；中分：加载但日志简略；低分：硬编码参数无追溯。"
            },
            {
              "sub_criteria": "状态快照与事件日志可回放",
              "description": "提供事件序列与关键状态快照（位占用、横移机状态）以复现实验与定位问题。",
              "score": 25,
              "evaluation_focus": "可调试性",
              "scoring_hint": "高分：可重放到任意时间点；中分：仅全程日志；低分：无日志或不可读。"
            },
            {
              "sub_criteria": "输出生成（区域矩阵与CSV/Excel导出）",
              "description": "正确生成C×(T+1)矩阵并按区域代码映射导出，索引对齐（车ID×秒）。",
              "score": 20,
              "evaluation_focus": "IO正确性",
              "scoring_hint": "高分：含校验与示例导出；中分：能导出但缺校验；低分：维度/编码错位。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "一致性校验与错误报告",
              "description": "提供无重叠占用、FIFO保持、横移机互斥、容量未超限等校验结果与异常列表。",
              "score": 35,
              "evaluation_focus": "结果验证",
              "scoring_hint": "高分：系统性校验并定位到车/位/秒；中分：部分校验；低分：无校验或仅口头保证。"
            },
            {
              "sub_criteria": "敏感性分析（约束6/7开关）",
              "description": "对比启用/禁用约束6/7的T、R与进车序列差异，解释优先规则对吞吐的影响。",
              "score": 35,
              "evaluation_focus": "对比解释",
              "scoring_hint": "高分：给出量化对比与原因；中分：仅描述趋势；低分：未做或无依据推断。"
            },
            {
              "sub_criteria": "时间轴与区域矩阵抽样核对",
              "description": "随机抽样车辆与秒点，将事件日志与矩阵值逐条对齐核验“最后到达区域代码”。",
              "score": 30,
              "evaluation_focus": "一致性检查",
              "scoring_hint": "高分：提供核对步骤与样例；中分：少量检查；低分：未核对或发现问题未修正。"
            }
          ]
        }
      }
    },
    "4": {
      "subtask": "子任务4（迭代优化与并行评估、稳健性分析与最终输出生成）应作为一个自包含的闭环优化与验证模块，其输入为：经清洗的车辆属性与到达顺序表（每车唯一ID、车型/动力/驱动等）、PBS参数字典（各进/返回道位数、横移机时长向量、道内前移耗时等）、可调用的PBS离散事件仿真器接口（输入候选进车序列或动作序列，输出按秒的车辆区域矩阵、实际进车序列、完成时间T、返回道使用次数R及事件日志）、以及评分函数实现（按题目规定计算s1—混动车间隔违例数、s2—4/2分块违例数、s3=R、s4基于T与基准时间的惩罚并合成加权总分S）；目标是以有限计算预算在可行空间内寻找并验证高得分的可执行调度方案并生成规定格式的最终输出和完整可复现日志。实现步骤与方法：一）初始化：根据输入生成初始候选集（多起点），可混合使用启发式构造（保留涂装到达顺序的局部性、优先放置低延迟通道车辆、先实现混动车/4‑2平衡的插入策略）与随机扰动以保证多样性；二）主搜索循环：采用元启发式框架（建议遗传算法或迭代局部搜索/模拟退火，支持并行种群评估），定义邻域算子集（相邻交换、任意位置插入、块交换、标记为返回并重新插入等复合算子），在每代/每轮对候选用仿真器严格评估得到真实指标（T、R、按秒矩阵）并计算S，用选择/交叉/变异或局部改进生成新候选；三）并行化与加速：并行化仿真评估（多进程/分布式任务队列）以提高吞吐，采用异步评估与缓存已评估序列结果避免重复仿真；对大规模搜索引入代理/代理模型（surrogate）作为筛选层：用已仿真样本训练回归模型（随机森林或LightGBM）预测R与T，用交叉验证控制代理误差并周期性用真实仿真更新训练集与重训练以避免偏差累积；四）自适应控制：在搜索过程中记录操作有效性并采用自适应算子选择（提升对改善S贡献大的算子的使用频率），并实现重启策略和多起点并行以防早期收敛；五）终止准则与精验：按给定的终止条件（最大仿真次数、最大时间或多代无改进）结束搜索，取前K个候选在仿真器上做最后一次高精度验证（同一随机种子、完整日志记录），生成最终的按秒区域矩阵输出和唯一的最终进车序列；六）稳健性与敏感性分析：对最终候选执行一组预定义扰动实验（例如涂装到达时刻加入 ±Δt 噪声若干次重复、横移/前移时间±10%场景、启用/禁用优先规则6/7的对比），统计得分分布、最坏/均值/方差，评估策略对输入与设备参数扰动的稳健性；七）输出与可复现性：将最终按秒矩阵以题目规定格式写入 Excel/CSV（并包含区域代码映射），同时导出每个候选的摘要 CSV（S、s1–s4、T、R）、完整事件日志、仿真快照、代理模型文件（若使用）、运行配置文件（包含所有算法参数、随机种子、PBS参数、版本信息）和迭代历史以便审计与重复实验；八）实施细节与工具建议：推荐使用 Python 生态（pandas/numpy、multiprocessing/joblib、DEAP/pygad 或自实现元启发式、scikit‑learn/LightGBM 作 surrogate、openpyxl/xlsxwriter 生成 Excel、heapq/SimPy 或 C++ 后端做高性能仿真接口），并在并行环境下合理分配核心用于仿真评估以保证整体效率。整个子任务应以可配置、可复现、日志充分的工程化流程交付——明确保存输入快照、所有随机种子和最终输出路径，且在终稿中包含一份简短的执行报告（最优候选的S分解、T、R、扰动测试摘要和关键算法参数）。",
      "criteria": {
        "task_understanding": {
          "core_goal": "在给定PBS仿真器与评分函数接口下，优化并评估候选总装进车序列以最大化加权总分S，并生成最终按秒区域矩阵与可复现输出。",
          "expected_output": "1) 最优可执行进车序列σ及其加权总分S与分解s1–s4、T、R；2) 对应按秒的车辆区域矩阵文件（Excel/CSV）；3) 候选序列评估汇总表；4) 仿真事件日志与快照；5) 若使用代理模型则其文件；6) 运行配置与随机种子；7) 稳健性/敏感性分析报告。",
          "key_inputs_constraints": "输入：清洗后的车辆属性与到达顺序表（含ID、车型/动力/驱动）、pbs_parameters.json（t_in/t_out/t_return/t_move、容量与开关约束6/7）、PBS离散事件仿真器接口、评分函数s1/s2/s3=R/s4(T)。约束：候选σ须物理可行（不违反到达因果与PBS硬约束），评估需用仿真器得到T、R与按秒矩阵，终止条件（仿真次数/时间/无改进）明确，可并行与缓存避免重复仿真。",
          "modeling_type": "优化+仿真+评价",
          "role_in_pipeline": "作为闭环迭代优化与最终验证输出环节；前序依赖：子任务1数据清洗与参数化、子任务2候选生成与启发评分、子任务3精确DES仿真器；后序：无（本任务产出即最终交付）。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "优化目标S与分解s1–s4的准确界定",
              "description": "是否明确以加权总分S最大化为核心，并严格按题目定义实现s1（混动间隔2）、s2（4/2分块1:1）、s3=R、s4基于T的惩罚。",
              "score": 30,
              "evaluation_focus": "目标对齐/评价",
              "scoring_hint": "高分：S与s1–s4完全一致且给出公式与单位；中分：S正确但s1或s2细则有疏漏；低分：混淆目标或缺少s4时间惩罚。"
            },
            {
              "sub_criteria": "可行性与PBS硬约束识别",
              "description": "识别送车机不得直接送返回道至接车口、不可中断、容量与方向性、约束6/7为可开关等硬规则对搜索空间与评估的影响。",
              "score": 25,
              "evaluation_focus": "约束理解",
              "scoring_hint": "高分：列出关键硬约束并说明对σ可行性的限制；中分：提及部分约束；低分：未考虑关键硬约束。"
            },
            {
              "sub_criteria": "仿真与代理在评估链路中的定位",
              "description": "阐明必须用DES仿真器得到T与R，代理模型仅作为筛选层且需周期校准。",
              "score": 25,
              "evaluation_focus": "评估设计",
              "scoring_hint": "高分：明确仿真为真值、代理仅预筛且有重训练策略；中分：提到代理但无校准；低分：用代理替代全部仿真。"
            },
            {
              "sub_criteria": "终止条件与资源预算识别",
              "description": "明确最大仿真次数/时间或无改进代数，并考虑并行评估与缓存以匹配预算。",
              "score": 20,
              "evaluation_focus": "工程约束",
              "scoring_hint": "高分：给出量化终止准则与并行/缓存策略；中分：仅口头说明；低分：无终止或资源考虑。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "任务输入/输出精确复述",
              "description": "用规范术语重述输入（车辆表、pbs参数、仿真器、评分函数）与输出（最优σ、按秒矩阵、日志、配置）。",
              "score": 30,
              "evaluation_focus": "需求对齐",
              "scoring_hint": "高分：逐项对应且无遗漏；中分：少量缺漏；低分：混淆或遗漏关键输出。"
            },
            {
              "sub_criteria": "约束6/7开关场景复述",
              "description": "准确描述启用/禁用约束6/7的评估差异与对搜索策略的影响。",
              "score": 30,
              "evaluation_focus": "约束表达",
              "scoring_hint": "高分：清楚两种模式并提出相应策略；中分：仅提到可开关；低分：未涵盖。"
            },
            {
              "sub_criteria": "评分与仿真耦合流程图或步骤",
              "description": "以步骤化方式复述从序列生成→仿真→得分→选择→输出的闭环流程。",
              "score": 40,
              "evaluation_focus": "流程表达",
              "scoring_hint": "高分：步骤清晰且包含并行与缓存；中分：流程基本正确；低分：流程不连贯或缺关键环节。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "随机性与tie-break处理假设",
              "description": "说明并固定仿真随机种子与并发冲突（同秒事件）决策规则对结果再现性的影响。",
              "score": 30,
              "evaluation_focus": "可复现性",
              "scoring_hint": "高分：明确种子、并给出tie-break规则；中分：仅说明固定种子；低分：未给出。"
            },
            {
              "sub_criteria": "代理模型使用与误差控制假设",
              "description": "假设代理仅用于预筛，设定误差阈值、交叉验证与重训练频率。",
              "score": 30,
              "evaluation_focus": "模型假设",
              "scoring_hint": "高分：定义MAE/RMSE阈值与更新策略；中分：有校验无阈值；低分：无误差控制。"
            },
            {
              "sub_criteria": "计算预算与并行度假设",
              "description": "假设可用核数/时间上限，并据此设定每代评估批量与缓存政策。",
              "score": 40,
              "evaluation_focus": "工程假设",
              "scoring_hint": "高分：量化核数、超时与最大仿真数；中分：粗略假设；低分：无预算假设导致不可实现方案。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "元启发式框架设计（GA/ILS/SA）",
              "description": "清晰定义个体编码（σ或优先级编码）、选择/交叉/变异或邻域算子，保持到达因果性与返回标注。",
              "score": 30,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：给出编码细节与算子集合；中分：仅给出框架；低分：无可执行设计。"
            },
            {
              "sub_criteria": "邻域算子与复合操作实现",
              "description": "包含相邻交换、任意插入、块交换、k-opt、‘标记返回后重插’等并描述约束保护。",
              "score": 25,
              "evaluation_focus": "算子设计",
              "scoring_hint": "高分：≥4类算子且含返回复合操作；中分：2–3类；低分：单一算子或违规。"
            },
            {
              "sub_criteria": "适应度函数与s1/s2精确计算、s3/s4评估集成",
              "description": "严格实现s1、s2精确；将仿真器产出的T、R并入S；可在早期用代理/启发估计筛选。",
              "score": 25,
              "evaluation_focus": "目标建模",
              "scoring_hint": "高分：公式与实现路径清晰；中分：s1/s2正确但s3/s4整合粗糙；低分：目标实现不一致。"
            },
            {
              "sub_criteria": "稳健性与敏感性试验设计",
              "description": "构建±Δt到达扰动、±10%时长、约束6/7切换的试验矩阵与统计指标（均值/方差/最坏）。",
              "score": 20,
              "evaluation_focus": "鲁棒设计",
              "scoring_hint": "高分：定义多场景与统计汇总；中分：单场景或无统计；低分：未设计。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "并行评估与缓存去重",
              "description": "采用多进程/队列并行仿真，基于序列哈希缓存已评估σ，避免重复仿真。",
              "score": 30,
              "evaluation_focus": "效率工程",
              "scoring_hint": "高分：并行+缓存均落地；中分：仅其一；低分：均无导致低效。"
            },
            {
              "sub_criteria": "自适应算子选择与重启策略",
              "description": "记录算子贡献度并调整使用频率，提供停滞重启与多起点并行避免早熟。",
              "score": 25,
              "evaluation_focus": "搜索策略",
              "scoring_hint": "高分：实现统计与动态调整；中分：手工调度；低分：无机制。"
            },
            {
              "sub_criteria": "代理模型训练与在线校准",
              "description": "用仿真样本训练（RF/GBM），交叉验证、误差阈值筛选、周期性增量重训。",
              "score": 25,
              "evaluation_focus": "学习集成",
              "scoring_hint": "高分：CV指标+阈值+重训频率；中分：仅训练；低分：代理无验证。"
            },
            {
              "sub_criteria": "终止准则与精验回合",
              "description": "达到最大仿真数/时间或无改进代数终止，并对Top-K进行同种子高精度复仿真确认。",
              "score": 20,
              "evaluation_focus": "收敛控制",
              "scoring_hint": "高分：Top-K精验并一致；中分：有终止无精验；低分：无终止或结果不复现。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "接口契约与数据管道",
              "description": "与DES仿真器、评分函数的接口一致性（输入σ→输出T、R、矩阵），类型与错误处理健壮。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：类型校验/异常处理完备；中分：基本可用；低分：接口不匹配或崩溃。"
            },
            {
              "sub_criteria": "并行与缓存实现质量",
              "description": "使用multiprocessing/joblib等实现并行；对σ进行哈希缓存与落盘，线程安全。",
              "score": 25,
              "evaluation_focus": "性能工程",
              "scoring_hint": "高分：稳定提速且无竞争问题；中分：有提速偶发冲突；低分：并行导致错误或无效。"
            },
            {
              "sub_criteria": "可复现性与配置管理",
              "description": "记录随机种子、PBS参数、算法参数与版本；保存运行配置与日志，结果可重跑一致。",
              "score": 25,
              "evaluation_focus": "工程规范",
              "scoring_hint": "高分：一次点击重现；中分：部分参数记录；低分：不可复现。"
            },
            {
              "sub_criteria": "输出文件与格式合规",
              "description": "按要求生成按秒矩阵（Excel/CSV）、候选摘要、事件日志、代理模型与报告，路径清晰。",
              "score": 20,
              "evaluation_focus": "交付合规",
              "scoring_hint": "高分：全部文件校验通过；中分：小瑕疵；低分：缺失关键文件或格式错误。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "最优解S分解与权衡解释",
              "description": "给出最优σ的S及s1–s4分解，解释混动间隔、4/2平衡与T、R之间的trade-off。",
              "score": 30,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：量化拆解并有可视化/表格；中分：定性描述；低分：仅报S无分析。"
            },
            {
              "sub_criteria": "稳健性/敏感性统计",
              "description": "报告扰动场景下S、T、R的均值/方差/最坏，并对约束6/7开关对表现的影响做比较。",
              "score": 30,
              "evaluation_focus": "鲁棒评估",
              "scoring_hint": "高分：多场景统计充分；中分：场景少或统计不全；低分：无稳健性分析。"
            },
            {
              "sub_criteria": "对基线或启发式的改进幅度",
              "description": "与简单基线（按到达序列或纯贪心）比较S、T、R提升并报告显著性或相对提升。",
              "score": 20,
              "evaluation_focus": "对比评估",
              "scoring_hint": "高分：量化相对提升≥明确阈值（如S≥+5分）；中分：有对比无量化；低分：无基线。"
            },
            {
              "sub_criteria": "失败案例与迭代改进建议",
              "description": "分析低分序列或代理误判案例，指出瓶颈（如算子不足、代理偏差）并提出改进方案。",
              "score": 20,
              "evaluation_focus": "诊断改进",
              "scoring_hint": "高分：具体案例与可执行建议；中分：泛化建议；低分：无诊断。"
            }
          ]
        }
      }
    }
  }
}