{
  "task_id": "2012_A",
  "problem": "二、数字序列映射与频谱3-周期性：\n\n对给定的DNA序列，怎么去识别出其中的编码序列（即外显子），也称为基因预测，是一个尚未完全解决的问题，也是当前生物信息学的一个最基础、最首要的问题。\n\n基因预测问题的一类方法是基于统计学的[1]。很多国际生物数据网站上也有“基因识别”的算法。比如知名的数据网站http://genes.mit.edu/GENSCAN.html提供的基因识别软件GENSCAN（由斯坦福大学研究人员研发的、可免费使用的基因预测软件）,主要就是基于隐马尔科夫链（HMM）方法。但是，它预测人的基因组中有45000个基因，相当于现在普遍认可数目的两倍。另外，统计预测方法通常需要将编码序列信息已知的DNA序列作为训练数据集来确定模型中的参数，从而提高模型的预测水平。但在对基因信息了解不多的情况下，基因识别的准确率会明显下降。\n\n因此在目前基因预测研究中，采用信号处理与分析方法来发现基因编码序列也受到广泛重视 [4]。1. 数字序列映射\n\n在 DNA 序列研究中，首先需要把 $A, T, G, C$ 四种核苷酸的符号序列，根据一定的规则映射成相应的数值序列，以便于对其作数字处理。令 $I = \\{A, T, G, C\\}$，长度（即核苷酸符号个数，又称碱基对 (Base-Pair) 长度，单位记为 $bp$）为 $N$ 的任意 DNA 序列，可表达为\\[ S = \\{ S[n] \\mid S[n] \\in I, \\; n=0,1,2,\\cdots,N-1 \\} \\]即 $A, T, G, C$ 的符号序列 $S$：$S[0], S[1], \\cdots, S[N-1]$。  现对于任意确定的 $b \\in I$，令\\[ u_b[n] = \\begin{cases} 1, & S[n] = b \\\\ 0, & S[n] eq b \\end{cases}, \\quad n=0,1,2,\\cdots,N-1 \\]称之为 Voss 映射，于是生成相应的 0-1 序列（即二进制序列）$\\{u_b[n]\\}$：$u_b[0], u_b[1], \\cdots, u_b[N-1]$（$b \\in I$）。例如，假设给定的一段 DNA 序列片段为 $S = ATCGTACTG$，则所生成的四个 0-1 序列分别为：\\[ \\{u_A[n]\\} : \\{1,0,0,0,0,1,0,0\\}; \\quad \\{u_G[n]\\} : \\{0,0,0,1,0,0,0,1\\}; \\]\\[ \\{u_C[n]\\} : \\{0,0,1,0,0,0,1,0\\}; \\quad \\{u_T[n]\\} : \\{0,1,0,0,1,0,0,0\\}. \\]这样产生的四个数字序列又称为 DNA 序列的指示序列 (indicator sequence)。为研究 DNA 编码序列（外显子）的特性，对指示序列分别做离散 Fourier 变换 (DFT)：\\[ U_b[k] = \\sum_{n=0}^{N-1} u_b[n] e^{-j \\frac{2\\pi nk}{N}}, \\quad k = 0,1,\\cdots,N-1 \\tag{1} \\]以此可得到四个长度均为 $N$ 的复数序列 $\\{U_b[k]\\},\\; b \\in I$。  计算每个复序列 $\\{U_b[k]\\}$ 的平方功率谱，并相加则得到整个 DNA 序列 $S$ 的功率谱序列 $\\{P[k]\\}$：\\[ P[k] = |U_A[k]|^2 + |U_T[k]|^2 + |U_G[k]|^2 + |U_C[k]|^2, \\quad k = 0,1,\\cdots,N-1 \\tag{2} \\]对于同一段 DNA 序列，其外显子与内含子序列片段的功率谱通常表现出不同的特性。\\vspace{0.3cm}\\textbf{图3：} 编号为 BK006948.2 的酵母基因 DNA 序列的功率谱  （\\textbf{因为对称性，实际这里只给出了功率谱图的一半}）。  \\(a)：上图是基因上一段外显子（区间为 [81787, 82920]，长 1134bp）对应的指示序列映射的功率谱，它具有 3-周期性；  \\(b)：下图是基因上一段内含子（区间为 [96361, 97551]，长 1191bp）的指示序列的功率谱，它不具有 3-周期性。\\vspace{0.3cm}可以看到：外显子序列的功率谱曲线在频率 $k = \\frac{N}{3}$ 处，具有较大的频谱峰值 (Peak Value)，而内含子则没有类似的峰值。这种统计现象被称为碱基的 3-周期 (3-base Periodicity)。记 DNA 序列 $S$ 的总功率谱的平均值为：\\[ \\bar{E} = \\frac{1}{N} \\sum_{k=0}^{N-1} P[k] \\tag{3} \\] 而将 DNA 序列在特定位置，即 $k = \\frac{N}{3}$ 处的功率谱值，与整个序列 $S$ 的总功率谱的平均值的比率称为 DNA 序列的 “信噪比” (Signal-Noise Ratio, SNR)，即\\[ R = \\frac{P\\left[\\frac{N}{3}\\right]}{\\bar{E}} \\tag{4} \\]DNA 序列的信噪比值的大小，既表示频谱峰值 (Peak-Value) 的相对高度，也反映编码或非编码序列 3-周期性的强弱。信噪比 R 大于某个适当选定的阈值 $R_0$ (比如 $R_0=2$)，是 DNA 序列上编码序列片段（外显子）通常满足的特性；而内含子则一般不具有该性质。在 DNA 序列 $\\{S[n], \\; n=0,1,2,\\cdots,N-1\\}$ 中，若 N 为 3 的倍数，将核苷酸符号 $b \\in I=\\{A,T,G,C\\}$ 出现在该序列的 0,3,6,…,N-3 与 1,4,7,…,N-2 以及 2,5,8,…,N-1 等位置上的频数分别记为 $x_b, y_b, z_b$，则 $N/3$ 处的总功率谱值即为：\\[ P\\left[\\frac{N}{3}\\right] = \\sum_{b \\in I} \\left| U_b\\left[\\frac{N}{3}\\right] \\right|^2  = \\sum_{b \\in I} \\left| \\sum_{n=0}^{N-1} u_b[n] e^{-j \\frac{2\\pi n}{3}} \\right|^2 \\]\\[ = \\sum_{b \\in I} \\left| x_b + y_b e^{-j \\frac{2\\pi}{3}} + z_b e^{j \\frac{2\\pi}{3}} \\right|^2 = \\sum_{b \\in I} \\left( x_b^2 + y_b^2 + z_b^2 - x_b y_b - x_b z_b - y_b z_b \\right) \\]易见，当四种核苷酸符号 $b \\in I$ 在序列的上述第一、第二、第三个子序列上出现的频数 $x_b,y_b,z_b$ 越接近相等时，$N/3$ 处的谱值也就越接近于零。所以，基因外显子序列的功率谱曲线，在 $N/3$ 频率处具有较大的频谱峰值 (Peak-Value)，反映了在基因外显子片段上，四种核苷酸符号在序列的三个子序列上分布的 “非均衡性”。通常认为这种现象源于编码基因序列 “密码子” (codon) 使用的偏向性 (bias)。虽然目前对此现象产生的 “机理” 还不是十分地清楚，但是频谱的 3-周期性被普遍认为是可用于识别基因编码序列（外显子）的一个重要的特征信息。\\begin{figure}[h]\\centering\\includegraphics[width=0.9\\textwidth]{流程图示意}\\caption{基于序列频谱 3-周期性的基因预测方法流程图}\\end{figure}已经有一些研究者提出了识别基因的算法（如参见文献[6]及其后的文献）。目前利用信噪比的基因识别算法通常有两种：一种是固定长度窗口滑动法[2][3]，另一是移动信噪比曲线识别方法[6]。\\subsection*{基于固定长度滑动窗口上频谱曲线的基因识别方法}对一个 DNA 序列 $S$ 和它的指示序列 $\\{u_b[n]\\}, \\; b \\in I, \\; n=0,1,2,\\cdots,N-1$。取长度 $M$（通常取为 3 的倍数，例如 $M=99,129,255,513$ 等）作为固定窗口长度。对任意 $n (0 \\leq n \\leq N-1)$，在以 $n$ 为中心的长度为 $M$ 的序列片段 $\\left[n-\\frac{M-1}{2}, \\; n+\\frac{M-1}{2}\\right]$ 上（当 $n$ 接近序列的两端时，窗口实际有效长度可能会小于 $M$），作四个指示序列的离散 Fourier 变换 (DFT)：\\[ U_b[k] = \\sum_{i=n-\\frac{M-1}{2}}^{n+\\frac{M-1}{2}} u_b[i] e^{-j \\frac{2\\pi i k}{M}}, \\quad k=0,1,\\cdots,M-1 \\]并求出在 $\\frac{M}{3}$ 处总频谱 $p(n; \\frac{M}{3})$，即\\[ P\\left[\\frac{M}{3}\\right] = |U_A[\\tfrac{M}{3}]|^2 + |U_T[\\tfrac{M}{3}]|^2 + |U_G[\\tfrac{M}{3}]|^2 + |U_C[\\tfrac{M}{3}]|^2 \\triangleq p\\left(n;\\tfrac{M}{3}\\right) \\]把这样得到的谱值 $p(n;\\tfrac{M}{3}), \\; n=0,1,2,\\cdots,N-1$，经过标准化处理（即除以最大谱值 $\\max\\limits_{0 \\leq n \\leq N-1}\\{p(n;\\tfrac{M}{3})\\}$），并画出其频谱曲线。三、请研究的几个问题：\\textbf{1. 功率谱与信噪比的快速算法}对很多长的 DNA 序列，在计算其功率谱或信噪比时，离散 Fourier 变换 (DFT) 的总体计算量仍然很大，会影响到所设计的基因识别算法的效率。大家能否对 Voss 映射，探求功率谱与信噪比的某种快速计算方法？在基因识别研究中，为了通过引入更好的数值映射而获取 DNA 序列更多的信息，除了上面介绍的 Voss 映射外，实际上人们还研究过许多不同的数值映射方法。例如，著名的 Z-curve 映射（参见[5]或者附件1）。试探讨 Z-curve 映射的频谱与信噪比和 Voss 映射下的频谱与信噪比之间的关系；此外，能否对实数映射，如：$A \\rightarrow 0, \\; C \\rightarrow 1, \\; G \\rightarrow 2, \\; T \\rightarrow 3$，也给出功率谱与信噪比的快速计算公式？\\vspace{0.3cm}\\textbf{2. 对不同物种类型基因的阈值确定}对特定的基因类型的 DNA 序列，将其信噪比 $R$ 的判别阈值取为 $R_0=2$，带有一定的主观性、经验性。对不同的基因类型，所选取的判别阈值也许应该是不同的。附件中给出了若干著名的生物数据库网站：\\url{http://www.ncbi.nlm.nih.gov/guide/} 的几个基因序列数据，另外也给出了带有编码外显子信息的 100 个人人和鼠类的，以及 200 个哺乳动物类的基因序列的样本数据集合。大家还可以从生物数据库下载更多的数据，找你们认为具有代表性的基因序列，并对每类基因研究其阈值确定方法和阈值结果。此外，对按照频谱或信噪比特征将编码与非编码区间分类的有效性，以及分类识别时所产生的分类错误作适当分析。\\vspace{0.3cm}\\textbf{3. 基因识别算法的实现}我们的目的是要预测、预报尚未被注释的、完整的 DNA 序列的所有基因编码序列（外显子）。目前基因识别方面的多数算法结果还不是很充分。例如前面所列举的某些基因识别算法，由于 DNA 序列随机噪声的影响等原因，还很难 “精确地” 确定基因外显子区间的两端点。对比，你的建模团队有没有更好的解决方法？请对你们所设计的基因识别算法的准确率做出适当评估，并将算法用于对附件中给出的 6 个未被注释的 DNA 序列（gene6）的编码区域的预测。\n\n4. 延展性研究\n\n在基因识别研究中，还有很多问题有待深入探讨。比如\n\n（1）采用频谱或信噪比这样单一的判别特征，也许是影响、限制基因识别正确率的一个重要原因。人们发现，对某些DNA序列而言，其部分编码序列（外显子），尤其是短的（长度小于100bp）的编码序列，就可能不具有频谱或者信噪比显著性。你们团队能否总结，甚至独自提出一些识别基因编码序列的其它特征指数，并对此做相关的分析？\n\n（2）“基因突变”是生物医学等方面的一个关注热点。基因突变包括DNA序列中单个核苷酸的替换，删除或者插入等。那么，能否利用频谱或信噪比方法去发现基因编码序列可能存在的突变呢？\n\n上面提出的基于频谱3-周期性的基因预测四个方面问题中，“快速算法”与“阈值确定”是为设计基因预测算法做准备的。此外，在最后的延展性研究中，各队也可以对你们自己认为有价值的其它相关问题展开探讨。",
  "subtask": {
    "1": {
      "subtask": "子任务 1（数值映射与频谱特征定义）的目标是把原始碱基符号序列 S[0..N-1] 明确定义为一组可用于局部频谱分析的数值表示，并为每个预定滑动窗口输出一组统一、可重复计算的谱特征向量，以便下游检测算法使用；该子任务仅包含数据映射、窗级统计量和谱量的精确定义与计算步骤，不涉及判别或后处理策略。 具体工作内容和步骤如下：输入为原始 DNA 序列 S（字符集 I={A,T,G,C}）以及待考察的窗口长度集合 M（通常取 3 的倍数，可包含若干尺度），以及窗口对齐策略（中心/左对齐）和边界处理规则；首先对序列做 Voss 映射：为每个碱基 b∈I 生成指示序列 u_b[n]=1_{S[n]=b}, n=0..N−1；对于给定窗口（长度为 M，在靠近端点时以有效长度 D 表示），按位置模 3 将窗口内位置分为三帧（frame 0,1,2），并对每个碱基在三帧上的出现次数计数为 x_b,y_b,z_b（当窗口被截断时以实际覆盖计数替代）；利用计数直接计算目标频点 k=M/3 处的总功率 P3（无需完整 DFT）按闭式公式 P3 = Σ_{b∈I} (x_b^2 + y_b^2 + z_b^2 − x_b y_b − x_b z_b − y_b z_b)（等价写法为 ½ Σ_b[(x_b−y_b)^2+(x_b−z_b)^2+(y_b−z_b)^2]），并将窗口平均功率取为 Ē = D（满窗时 Ē=M）以得到归一化信噪比 R = P3 / Ē；若需要完整功率谱或其它频点，可按定义 U_b[k] = Σ u_b[n] e^{−j2πnk/M} 和 P[k]=Σ_b |U_b[k]|^2 计算（用 FFT 库如 FFTW/numpy.fft），但仅当必须分析全谱时才使用完整变换。 另外明确不同映射之间的代数关系以便一致输出：任何实数映射 s[n]=Σ_b c_b u_b[n] 的频谱在 k 处为 S[k]=Σ_b c_b U_b[k]，其功率包含碱基间的交叉项；Z-curve 各分量可表示为 Voss 指示序列的线性组合或其累积差分，因此其在 k=M/3 处的谱能通过已知系数与 U_b[M/3] 或等价的帧计数 x_b,y_b,z_b 的线性/二次变换直接得到（即可在不做额外逐点 DFT 的情况下计算 Z-curve 在目标频点的能量）。 规定在每个窗口必须输出的标准特征字段：窗口起止位置与有效长度 D、三帧计数向量 {x_b,y_b,z_b}_{b∈I}、P3、Ē 和 R；可选但应标准化的扩展特征包括：目标频点邻近频带能量比（例如 P[k±Δ]/Ē）、Z-curve 各分量在 k=M/3 处的能量、窗口内 GC 含量、每帧的 k-mer（例如三核苷酸）频率向量及窗口序列的香农熵。 实现说明：推荐采用滑动窗口的增量计数实现（维护三帧×四碱基的整型计数表并在窗口移动时以 O(1) 更新）以高效计算每窗的 x_b,y_b,z_b 和 P3；当需要跨尺度计算时对每个 M 并行或串行执行相同流程并输出多尺度特征集合；所需输入仅为原始序列 S、待用 M 列表及可选的实数映射系数 c_b 或 Z-curve系数；常用工具包括 Python+NumPy（快速原型）和 C/C++ 或 Rust（高性能实现），FFT 库仅用于需要全谱时调用。 该子任务的输出是按窗口（及可选择的尺度）排列的、格式化的特征表（位置、D、x_b,y_b,z_b、P3,Ē,R 以及选填扩展特征），这些特征必须以一致的数值/单位定义保存以便其他模块直接使用。",
      "criteria": {
        "task_understanding": {
          "core_goal": "构建并评估将 DNA 序列进行 Voss 映射与窗级频谱特征（含 k=M/3 处功率 P3 与信噪比 R）计算的流程，输出标准化特征表以供下游检测使用",
          "expected_output": "按窗口与尺度输出的特征表/数据帧：窗口起止位置、有效长度D、{x_b,y_b,z_b}_{b∈{A,T,G,C}}、P3、Ē、R；可选含邻频带比、Z-curve能量、GC含量、k-mer频率、熵；以及可复现实验的代码与配置",
          "key_inputs_constraints": "输入：DNA序列S（仅含A/T/G/C）、窗口长度集合M（优先为3的倍数）、窗口对齐策略（中心/左对齐）、边界处理规则；约束：在端点处使用有效长度D计数；P3按闭式计数公式计算；R=P3/Ē且Ē=D（满窗M）；增量滑窗需O(1)更新三帧×四碱基计数；可选实数映射s[n]=Σ_b c_b u_b[n]及Z-curve系数需与Voss线性关系一致",
          "modeling_type": "评价",
          "role_in_pipeline": "作为特征工程阶段（数据映射与谱特征生成），位于数据清洗/标准化之后、判别与后处理之前；前序依赖：原始序列合法性校验与缺失/非ATGC清理；后序任务：阈值确定、分类/检测、区段合并与可视化",
          "assumptions": "若出现非ATGC字符则剔除或按边界规则跳过不计入D；多尺度M独立计算并合并为同一特征表，时间索引对齐在窗口中心位置"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "识别核心动作：Voss 映射与频谱特征计算",
              "description": "是否明确该子任务仅负责将S映射为四个指示序列并计算窗级P3、Ē、R，而不涉及判别阈值或外显子预测决策",
              "score": 35,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：清楚划界到“仅特征生成”；中分：提到P3或R但混入判别；低分：将任务表述为预测外显子"
            },
            {
              "sub_criteria": "目标频点 k=M/3 与3-周期性",
              "description": "是否点出目标频点为k=M/3，说明其与3-base periodicity相关且P3由三帧计数闭式给出",
              "score": 25,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：准确给出k=M/3与闭式；中分：只提k=M/3无公式；低分：目标频点错误或缺失"
            },
            {
              "sub_criteria": "窗级输出字段定义与一致性",
              "description": "是否列出必须输出字段：起止位置、D、{x_b,y_b,z_b}、P3、Ē、R，并强调单位/对齐一致性",
              "score": 20,
              "evaluation_focus": "规范性",
              "scoring_hint": "高分：字段全且单位清晰；中分：字段不全；低分：未定义输出结构"
            },
            {
              "sub_criteria": "边界与对齐策略的重要性",
              "description": "是否识别中心/左对齐与端点有效长度D对P3与R计算的影响",
              "score": 20,
              "evaluation_focus": "细节把控",
              "scoring_hint": "高分：明确D替代M并影响Ē；中分：泛述边界；低分：忽略边界处理"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "精确复述 Voss 指示序列 u_b[n]",
              "description": "是否将u_b[n]=1_{S[n]=b}的定义与n范围0..N−1、b∈{A,T,G,C}准确复述",
              "score": 25,
              "evaluation_focus": "准确表达",
              "scoring_hint": "高分：公式与域完全正确；中分：口述正确无公式；低分：定义含糊或符号错误"
            },
            {
              "sub_criteria": "三帧计数 x_b,y_b,z_b 的窗口化定义",
              "description": "是否按窗口内位置模3分帧并用实际覆盖计数补偿截断窗",
              "score": 30,
              "evaluation_focus": "细节把控",
              "scoring_hint": "高分：明确模3与截断处理；中分：只述模3；低分：不区分帧或忽略截断"
            },
            {
              "sub_criteria": "P3、Ē、R 的闭式与关系",
              "description": "是否给出P3二次型公式与Ē=D（满窗M）并写出R=P3/Ē",
              "score": 30,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：三者关系与公式齐全；中分：缺其一；低分：R或Ē定义错误"
            },
            {
              "sub_criteria": "范围与尺度：多 M 处理",
              "description": "是否复述多尺度M独立计算并输出统一特征表",
              "score": 15,
              "evaluation_focus": "系统意识",
              "scoring_hint": "高分：说明合并规则；中分：提及多M未述合并；低分：只支持单一M"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "非ATGC字符与缺失处理假设",
              "description": "是否提出对N/Ns或非标准字符的处理（剔除或不计入D）并说明影响",
              "score": 30,
              "evaluation_focus": "数据假设",
              "scoring_hint": "高分：给出可执行策略并评估对R影响；中分：仅口头说明；低分：未提"
            },
            {
              "sub_criteria": "对齐与边界假设",
              "description": "是否明确选择中心/左对齐及端点截断的默认规则并保持一致",
              "score": 25,
              "evaluation_focus": "规范约定",
              "scoring_hint": "高分：固定策略并贯穿实现；中分：策略不一致；低分：未设定"
            },
            {
              "sub_criteria": "多尺度独立性与合并假设",
              "description": "是否假设不同M下特征独立计算、统一坐标（窗口中心）对齐输出",
              "score": 20,
              "evaluation_focus": "系统设计",
              "scoring_hint": "高分：明确对齐点与冲突避免；中分：只提独立；低分：混淆索引"
            },
            {
              "sub_criteria": "实数映射与Z-curve 的线性关系假设",
              "description": "是否说明s[n]=Σ_b c_b u_b[n]与U_b[k]线性关系，以及Z-curve能量可由U_b或(x,y,z)二次变换得到",
              "score": 25,
              "evaluation_focus": "理论假设",
              "scoring_hint": "高分：写出S[k]=Σ c_b U_b[k]并提交叉项；中分：仅口述线性；低分：未涉及或错误"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "三帧计数到 P3 的二次型构造",
              "description": "是否正确从{x_b,y_b,z_b}构造P3=Σ_b(x_b^2+y_b^2+z_b^2−x_by_b−x_bz_b−y_bz_b)或等价½和差平方形式",
              "score": 35,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：两种等价式均给出并说明等价；中分：仅一种；低分：系数或项有误"
            },
            {
              "sub_criteria": "平均功率 Ē 与归一化 R 的建模",
              "description": "是否将Ē设为D（满窗M）并据此定义R=P3/Ē，解释D变化影响",
              "score": 25,
              "evaluation_focus": "量纲一致",
              "scoring_hint": "高分：量纲自洽且考虑截断；中分：设Ē=M不区分截断；低分：R未归一"
            },
            {
              "sub_criteria": "扩展特征设计的可复用性",
              "description": "是否规范定义邻频带能量比、Z-curve能量、GC含量、k-mer、香农熵的计算口径与单位",
              "score": 20,
              "evaluation_focus": "特征工程",
              "scoring_hint": "高分：给出明确窗口内算法与单位；中分：列名无定义；低分：无扩展或含糊"
            },
            {
              "sub_criteria": "多尺度输出模式",
              "description": "是否定义每个M独立特征命名与合并键（如center_idx, M）避免冲突",
              "score": 20,
              "evaluation_focus": "系统设计",
              "scoring_hint": "高分：键/列名方案明确；中分：部分说明；低分：易冲突或未定义"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "滑动窗口增量计数 O(1) 更新",
              "description": "是否提出并实现三帧×四碱基计数表，窗口滑动进出各更新一次，整体O(N)",
              "score": 40,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：明确进出更新与模3索引；中分：部分增量；低分：每窗重算O(NM)"
            },
            {
              "sub_criteria": "避免完整DFT：闭式直算 k=M/3",
              "description": "是否强调仅在必要时调用FFT，全流程默认用计数闭式求P3与R",
              "score": 25,
              "evaluation_focus": "计算效率",
              "scoring_hint": "高分：无冗余FFT；中分：偶用FFT；低分：每窗FFT"
            },
            {
              "sub_criteria": "边界与有效长度 D 的正确求解",
              "description": "是否在端点按实际覆盖计算D与{x_b,y_b,z_b}并据此更新P3、Ē、R",
              "score": 20,
              "evaluation_focus": "实现细节",
              "scoring_hint": "高分：明确首尾处理；中分：提及未实现；低分：忽略导致偏差"
            },
            {
              "sub_criteria": "实数映射与Z-curve的频点能量复用",
              "description": "是否用S[k]=Σ c_b U_b[k]及计数到U_b[M/3]的关系避免额外DFT",
              "score": 15,
              "evaluation_focus": "数理运用",
              "scoring_hint": "高分：给出线性/二次变换步骤；中分：口述复用；低分：重复计算"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "数据结构与时间复杂度",
              "description": "是否采用整数计数表（3帧×4碱基）与O(N)滑窗，跨尺度循环M",
              "score": 30,
              "evaluation_focus": "代码效率",
              "scoring_hint": "高分：实测O(N)且常数低；中分：O(N)但实现冗余；低分：O(NM)或更差"
            },
            {
              "sub_criteria": "边界与对齐的一致实现",
              "description": "是否在代码中统一中心/左对齐策略，D与索引映射一致且有单元测试",
              "score": 25,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：测试覆盖首窗/尾窗/短序列；中分：少量测试；低分：出现索引越界/错位"
            },
            {
              "sub_criteria": "特征表输出规范",
              "description": "是否输出标准字段与列名（start,end,center,D,x_b,y_b,z_b,P3,Ebar,R,M），类型与单位一致",
              "score": 25,
              "evaluation_focus": "工程规范",
              "scoring_hint": "高分：Schema固定且可序列化；中分：列名不统一；低分：无法直接被下游消费"
            },
            {
              "sub_criteria": "可选FFT与扩展特征模块化",
              "description": "是否将FFT调用与扩展特征置于可选模块，默认关闭避免开销",
              "score": 20,
              "evaluation_focus": "可维护性",
              "scoring_hint": "高分：配置开关清晰；中分：硬编码；低分：混杂在主路径难以关闭"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "数值一致性与可重复性检查",
              "description": "是否对同一窗口用DFT与闭式P3对比（允许浮点误差），验证R一致",
              "score": 35,
              "evaluation_focus": "结果验证",
              "scoring_hint": "高分：给出误差阈值如相对误差≤1e-6；中分：定性一致；低分：未验证或差异大"
            },
            {
              "sub_criteria": "边界与截断对 R 的影响评估",
              "description": "是否展示满窗与截断窗的R差异案例并解释Ē=D的必要性",
              "score": 25,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：提供最小示例与数值；中分：口头说明；低分：无评估"
            },
            {
              "sub_criteria": "多尺度 M 的稳定性与对齐检验",
              "description": "是否比较不同M下P3或R在同一中心的趋势一致性与索引对齐正确性",
              "score": 20,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：图/表或统计一致；中分：零散示例；低分：对齐错误或未检验"
            },
            {
              "sub_criteria": "扩展特征的合理性核对",
              "description": "是否对GC含量、Z-curve能量、邻频带比等做范围/单位检查与异常检测",
              "score": 20,
              "evaluation_focus": "质量控制",
              "scoring_hint": "高分：有断言/范围校验；中分：肉眼检查；低分：未校验导致异常值"
            }
          ]
        }
      }
    },
    "2": {
      "subtask": "子任务2 的目标是设计与实现一个面向一维 DNA 碱基序列的高效滑动窗口谱能量计算引擎，要求在不对每个窗口执行完整 FFT 的前提下，以 O(1) 的摊销成本更新并输出每个窗口在目标频点 k = M/3 处的总功率 P3 以及归一化信噪比 R（其中 M 通常取为 3 的倍数），并支持多尺度并行计算、基于窗口得分到碱基级平滑得分的转换、边界窗口的有效长度处理与可扩展的实现细节；具体而言，本子任务包括以下内容并必须完整实现：输入为原始碱基序列 S[0..N-1]（字符集 {A,C,G,T}）、一个或多个窗口长度集合 {M_i}（优先选择 M_i 为 3 的倍数）、窗口步长（通常为 1）、窗口对齐策略（建议左对齐或中心对齐并在实现中明确任选一种），以及可选的多尺度融合权重与平滑核参数；算法核心基于在窗口上按位置模 3 分为三个帧并维护每个帧对四种碱基的整型计数矩阵 C[f∈{0,1,2}, b∈{A,C,G,T}]，对初始窗口一次性统计得到 C 并用闭式公式 P3 = Σ_b (x_b^2 + y_b^2 + z_b^2 − x_b y_b − x_b z_b − y_b z_b)（等价于 ½ Σ_b[(x_b−y_b)^2+(x_b−z_b)^2+(y_b−z_b)^2]）计算目标频点功率，窗口的平均功率 Ē 在满窗时等于 M（边界或截断窗用有效长度 D 代替），因此 R = P3 / Ē；随后窗口右移一位时只需识别被移出的碱基与新加入的碱基、确定它们在三个帧中的模 3 索引并在相应 C 元素上做常数次（O(1)）的加减更新，随后用整数计数代入闭式表达式重算 P3（建议用 64-bit 整数累加以防溢出并在最终计算 R 时转换为浮点），整个序列扫描对每个尺度的时间复杂度为 O(N) 且内存额外开销仅为每尺度 3×4 个计数与输出缓冲区；实现细节包括：为简化帧索引建议采用左对齐窗口（帧索引为全局位置 mod 3，避免中心对齐时帧随窗口移动的复杂映射），或若采用中心对齐则维护一个循环缓冲区记录窗口中每个位置的碱基与其帧编号以便快速移入移出；边界处理明确采用“有效窗长 D”策略（窗被截断时按实际覆盖长度计算 C 与 Ē），并可提供镜像填充或零填充作为可选策略（但须记录 D 以用于归一化）；多尺度支持要求为每个尺度并行维护各自的 C 矩阵并在同一次序列遍历中同时更新以减少内存访问与提高缓存效率，也可将不同尺度任务并行分配到线程/进程；基于窗口得分转为碱基级得分的步骤为：为每个窗口的中心或覆盖区累加其 R（或 P3）到覆盖的碱基位置上，并可按与窗口中心距离的高斯/三角权重进行加权累加，最终对每个碱基做归一化以得到平滑的 S_base[n]，该转换用于后续定位与分段；在某些情形下若需要完整频谱或 M 非 3 的倍数、或需分析邻域频带，则保留对候选段或少量窗口调用 FFT（推荐使用高性能库如 FFTW 或 numpy.fft），但不得对所有窗口频繁调用 FFT；实现时应优先使用低层高效语言（C/C++/Rust）实现滑动计数与 P3 更新内核，提供 Python/R 的高层封装用于参数配置、I/O 与可视化，使用 64-bit 整数计数和浮点归一化以保证数值稳定性，优化点包括：预计算碱基到索引的查表、避免分支的模 3 运算（用循环增量替代模运算以加速）、对多尺度并行更新做向量化或多线程分配，以及在大序列上分块处理以控制内存占用；输出格式应为按窗口记录的字段（窗口起止、有效长度 D、三帧计数向量、P3、Ē、R）与按碱基记录的 S_base 序列，并应提供可配置的参数（M 列表、对齐方式、权重、平滑核），最后明确时间复杂度为 O(N × S)（S 为尺度数）、附加内存为 O(S)（计数矩阵）加输出缓冲，且该模块应可独立运行、并能被上层模块调用用于候选段筛选或作为进一步统计/机器学习处理的特征输入。",
      "criteria": {
        "task_understanding": {
          "core_goal": "设计与优化一维 DNA 序列的滑动窗口谱能量计算引擎，以O(1)摊销更新目标频点k=M/3的总功率P3并评估归一化信噪比R用于下游预测外显子片段。",
          "expected_output": "按窗口记录的特征表（起止位置、有效长度D、三帧计数{xb,yb,zb}、P3、Ē、R），按碱基的平滑得分S_base[n]，以及可复现实验的代码/模块接口与性能报告（时间复杂度、吞吐、内存占用）。",
          "key_inputs_constraints": "输入序列S[0..N-1]（字符集{A,C,G,T}，必须无未知符号），窗口长度集合{M_i}（优先为3的倍数），步长（默认1），对齐策略（左对齐或中心对齐，需全局一致），边界处理规则（有效长度D或填充策略并记录D），多尺度融合权重与平滑核参数（可选，需给定默认值与范围）。",
          "modeling_type": "评价+优化",
          "role_in_pipeline": "作为频谱3-周期性特征的高效计算内核，位于数据映射/指标定义之后、候选片段检测与分类之前；前序依赖子任务1（数值映射与谱量定义），后序为阈值确定/分类与区域定位、可视化与评估。",
          "assumptions": "若出现非{A,C,G,T}字符则跳过并记为窗口有效长度D减少；多尺度并行默认独立维护计数矩阵；左对齐为默认以简化帧索引（pos%3）。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "锁定目标频点k=M/3的P3与R评估",
              "description": "是否明确本任务仅需在k=M/3计算总功率P3与归一化信噪比R，而非全谱FFT。",
              "score": 35,
              "evaluation_focus": "问题边界",
              "scoring_hint": "高分：强调闭式P3与R，拒绝对每窗FFT；中分：提及k=M/3但仍描述部分不必要频点；低分：将任务等同全谱计算。"
            },
            {
              "sub_criteria": "O(1)摊销更新与O(N×S)总体复杂度",
              "description": "能否识别到核心是滑动窗口的常数次更新和整体线性时间并行多尺度目标。",
              "score": 35,
              "evaluation_focus": "复杂度意识",
              "scoring_hint": "高分：给出O(1)更新与O(N×S)并量化内存O(S)；中分：仅声称线性未说明O(1)；低分：复杂度模糊或劣于线性。"
            },
            {
              "sub_criteria": "边界有效长度D与对齐策略",
              "description": "是否识别并要求在截断窗下用D归一化Ē，且对齐策略需统一。",
              "score": 30,
              "evaluation_focus": "约束识别",
              "scoring_hint": "高分：清晰说明D替代M，左/中心对齐择一且一致；中分：提到边界但未用D归一；低分：忽略边界或混用对齐。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "三帧计数C与闭式P3公式",
              "description": "能否复述按pos%3计数C[f,b]并用P3=Σ_b(x^2+y^2+z^2-xy-xz-yz)或等价形式。",
              "score": 40,
              "evaluation_focus": "精确表达",
              "scoring_hint": "高分：两种等价式之一无误且变量含义清晰；中分：式子正确但符号含糊；低分：公式错误或缺失。"
            },
            {
              "sub_criteria": "R= P3/Ē与Ē的定义",
              "description": "是否准确表述Ē为满窗M、截断窗D的平均功率并据此求R。",
              "score": 30,
              "evaluation_focus": "量纲一致",
              "scoring_hint": "高分：明确Ē与单位一致性；中分：给出R但未区分M与D；低分：R公式错误或未归一化。"
            },
            {
              "sub_criteria": "多尺度与碱基级平滑转换",
              "description": "是否复述对多尺度{M_i}并行更新及将窗口R累计到S_base[n]的规则。",
              "score": 30,
              "evaluation_focus": "流程把握",
              "scoring_hint": "高分：说明累计/加权与归一；中分：只提到平均未谈权重或归一；低分：未提转换。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "字符集与缺失处理假设",
              "description": "对非{A,C,G,T}字符或N的处理（跳过/不计入D）假设是否完整且一贯。",
              "score": 35,
              "evaluation_focus": "鲁棒性假设",
              "scoring_hint": "高分：定义进窗/出窗规则与D同步更新；中分：提到跳过但未述D；低分：未处理或自相矛盾。"
            },
            {
              "sub_criteria": "对齐与帧索引假设",
              "description": "是否假设左对齐并用全局pos%3，或若中心对齐则说明帧映射机制。",
              "score": 35,
              "evaluation_focus": "一致性假设",
              "scoring_hint": "高分：给出统一索引与实现依据；中分：提到两种对齐但无统一选择；低分：帧定义前后不一致。"
            },
            {
              "sub_criteria": "数值范围与精度假设",
              "description": "计数/累加用64位整数，R用浮点，防溢出的假设是否明确。",
              "score": 30,
              "evaluation_focus": "数值稳定",
              "scoring_hint": "高分：明确类型与可能上限；中分：部分提及；低分：忽略类型导致潜在溢出。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "滑动计数矩阵C的结构设计",
              "description": "是否设计3×4矩阵C[f,b]与入窗/出窗的索引与基表映射。",
              "score": 30,
              "evaluation_focus": "数据结构",
              "scoring_hint": "高分：无分支查表，帧索引循环增量避免模运算；中分：有模运算但正确；低分：结构混乱或错误。"
            },
            {
              "sub_criteria": "P3闭式重算与增量策略",
              "description": "每步O(1)更新C后直接重算P3（或维护部分二次项）设计是否清晰且正确。",
              "score": 35,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：正确分解到每碱基帧二次项；中分：重算正确但无优化；低分：计算错误或重复高代价步骤。"
            },
            {
              "sub_criteria": "边界与有效长度D的建模",
              "description": "首窗、首尾截断、跨块处理时D与C的建模是否完备。",
              "score": 35,
              "evaluation_focus": "边界处理",
              "scoring_hint": "高分：明确初始化与递推D；中分：只处理首窗；低分：边界未定义。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "时间与空间复杂度证明",
              "description": "是否给出O(N×S)时间、O(S)附加内存与证明要点（常数更新、固定大小C）。",
              "score": 35,
              "evaluation_focus": "复杂度证明",
              "scoring_hint": "高分：文字或式子论证；中分：仅口头声称；低分：与实现矛盾或错误。"
            },
            {
              "sub_criteria": "多尺度并行/向量化求解",
              "description": "是否提出同扫更新多尺度或多线程/向量化策略并说明代价与收益。",
              "score": 35,
              "evaluation_focus": "算法工程",
              "scoring_hint": "高分：描述线程划分/缓存友好；中分：泛泛而谈并行；低分：未考虑并行。"
            },
            {
              "sub_criteria": "从窗口R到S_base的求解步骤",
              "description": "说明加权核（高斯/三角）、覆盖累计与归一流程，避免边界偏置。",
              "score": 30,
              "evaluation_focus": "数值求解",
              "scoring_hint": "高分：给出权重归一细节；中分：仅平均；低分：未实现或明显偏置。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "O(1)更新与查表映射实现",
              "description": "基于查表的碱基→索引、无需分支的帧索引循环增量，单步常数次加减更新。",
              "score": 30,
              "evaluation_focus": "代码效率",
              "scoring_hint": "高分：无模运算热路径且通过基准测试；中分：含%运算但性能可接受；低分：每步高开销或错误。"
            },
            {
              "sub_criteria": "数值类型与溢出防护",
              "description": "计数与P3累加用64位，R用双精度，边界检查与输入校验齐全。",
              "score": 25,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：单元测试覆盖极端M,N；中分：类型正确但测试不足；低分：潜在溢出或崩溃。"
            },
            {
              "sub_criteria": "多尺度接口与参数化",
              "description": "支持{M_i}、步长、对齐、权重、平滑核参数，可批处理与并行。",
              "score": 20,
              "evaluation_focus": "可扩展性",
              "scoring_hint": "高分：参数校验与默认值，线程安全；中分：部分可配；低分：硬编码。"
            },
            {
              "sub_criteria": "I/O与输出格式一致性",
              "description": "输出窗口表字段完整（起止、D、计数、P3、Ē、R）与S_base[n]，单位一致。",
              "score": 25,
              "evaluation_focus": "可用性",
              "scoring_hint": "高分：字段齐全且对齐规范；中分：缺少少量字段；低分：格式不一致或缺关键字段。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "正确性验证（对照DFT/FFT）",
              "description": "在样例上将P3与R与直接DFT/FFT的k=M/3结果对比验证误差。",
              "score": 40,
              "evaluation_focus": "结果正确性",
              "scoring_hint": "高分：误差为零或浮点≤1e-9；中分：小差异已解释；低分：未验证或误差大。"
            },
            {
              "sub_criteria": "性能评测与扩展性",
              "description": "报告吞吐（bp/s）、内存占用、线程扩展性，比较与逐窗FFT基线。",
              "score": 35,
              "evaluation_focus": "性能分析",
              "scoring_hint": "高分：≥10×快于逐窗FFT且资源曲线明确；中分：给出指标但无基线；低分：无评测。"
            },
            {
              "sub_criteria": "边界与异常用例覆盖",
              "description": "测试N<M、M非3倍数、含N字符、序列首尾与分块拼接的一致性。",
              "score": 25,
              "evaluation_focus": "测试覆盖",
              "scoring_hint": "高分：列举并通过全部边界用例；中分：覆盖部分；低分：缺少关键边界测试。"
            }
          ]
        }
      }
    },
    "3": {
      "subtask": "子任务 3（统计校准、判别规则与模型融合）的目标是把滑动窗口或片段级的频谱得分（如 P3、归一化 SNR 及可选的多尺度谱与 Z-curve 等衍生特征）转换为经过统计校准的判决与置信度，并将这些谱特征以可训练的方式融入概率模型或监督分类器以实现稳健的外显子/内含子分类；为此应按如下有序步骤精确实现：一、输入与准备——接收已注释的训练集（按碱基或按窗/片段标注的外显子/内含子标签）、每窗/片段的谱特征向量（P3、R、邻域频带能量、Z-curve 分量能量、GC 含量等）、以及可选的剪接位点 PWM 评分与物种先验；对训练集做清洗与平衡处理（记录类别不均衡并准备加权或重采样策略）；二、经验分布估计与单特征可区分性评估——在训练集上分别估计外显子与内含子在关键谱量（P3、R）上的经验分布，绘制并量化 ROC 曲线与 AUC，以判断单一谱特征的判别能力并据此决定是否需要多特征融合；三、统计显著性检验与多重检验校正——为获得可解释的阈值，基于保守与非保守的零假设构造 null 分布（例如完全随机打乱、保留单核苷酸频率或保留二联体频率的置换），对观测的 P3 计算经验 p 值，采用 Benjamini–Hochberg 等方法控制 FDR 并将 p 值门限映射回等效的 R/P3 阈值；四、阈值选择策略——根据应用需求在训练集上用交叉验证确定操作点：可选准则包括最大化 F1、在给定假阳性率(FPR)下最大召回、或在保证最小精确率下最大化召回；同时记录所选阈值在不同物种或不同基因类型上的性能差异以支持后续适配；五、多特征监督学习与概率校准——将谱特征与其它有用特征（Z-curve 能量、多尺度 P3、frame-specific k-mer 频率、splice-site 分数、局部熵等）构建特征矩阵并训练可解释或高性能分类器（如带正则化的逻辑回归、随机森林、XGBoost 或轻量神经网络），在训练过程中用嵌套交叉验证进行超参数搜索并采用类别权重或重采样处理不平衡；训练后对分类器输出的置信分数进行概率校准（Platt scaling 或 isotonic regression）以便输出可比较的后验概率；六、时序上下文整合（可选 HMM/semi‑Markov）——若需要利用序列上下文和长度约束，将经校准的谱特征作为发射概率融入 HMM 或半马尔科夫模型（显式建模外显子长度分布与剪接位点转移先验）并用 Viterbi 解码得到最优状态序列，或把监督分类器的局部概率作为 HMM 的输入以实现两步融合；七、后处理与置信度输出——对分类结果应用生物学约束（剔除短于 L_min 的片段、合并间距小于 G_max 的片段、基于局部 P3 峰或 splice-site PWM 评分微调端点），并为每个候选外显子输出综合置信度指标（校准后的后验概率、置换 p 值与 FDR 校正后的显著性、以及端点不确定性的置信区间）；八、评估与重校准流程——在独立验证集上报告核苷酸级与外显子段级的精确率/召回、ROC/AUC、端点误差分布与混淆矩阵，并据此迭代调整阈值与模型（必要时对不同物种或基因类型做分层/层次贝叶斯校准以应对样本量不足）；九、实施细节与工具建议——建议使用成熟机器学习与统计库（scikit-learn、XGBoost、statsmodels、pomegranate 或 hmmlearn 等 HMM 实现）、用置换检验实现经验 p 值（并行化置换以加速）、用 Benjamini–Hochberg 控制 FDR、采用嵌套交叉验证和训练集/验证集划分以避免过拟合，并保存训练好的模型与阈值以便在新数据上复用与增量重校准。该子任务的最终产出应包含：训练好的（并校准的）判别模型或阈值策略、可复现的显著性检验流程、统一的后处理规则以及对每个预测片段提供的概率化置信度和多重检验调整后的显著性指标。",
      "criteria": {
        "task_understanding": {
          "core_goal": "基于训练集对滑动窗口谱特征（P3、归一化 SNR、Z-curve 能量等）进行统计校准与阈值/分类器拟合，并预测外显子/内含子标签与置信度。",
          "expected_output": "已校准的判别阈值或监督分类模型文件（含超参数与类别权重）、概率校准函数、显著性检验与FDR流程脚本、面向窗口/碱基的预测标签与后验概率、候选外显子片段清单（含置信度与p值/FDR）、评估报表与ROC/PR曲线图。",
          "key_inputs_constraints": "输入：标注训练集（按碱基或窗口的外显子/内含子标签），每窗/片段谱特征矩阵（含P3、R、邻域频带、Z-curve能量、GC等），可选剪接位点PWM分数与物种先验；约束：类别不均衡需加权/重采样；多尺度特征需对齐同一窗口索引；边界窗口需携带有效长度D以保证R=P3/D一致；输出需提供可重复的阈值和校准曲线；训练/验证严格分离以避免泄漏。",
          "modeling_type": "分类+评价+拟合",
          "role_in_pipeline": "作为谱特征后、结构预测前的决策层：依赖子任务1的特征定义与子任务2的高效滑窗P3/R计算；其输出（概率、片段与阈值）供后续HMM/后处理与端点微调使用并反馈评估结果用于重校准。",
          "assumptions": "若标注粒度混合（碱基/窗口），以窗口覆盖率≥τ作为正例阈值；若物种先验缺失，默认均匀先验；若样本量不足，采用分层K折交叉验证与简单模型（逻辑回归或XGBoost）以控过拟合。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "识别统计校准与阈值选择的核心目标（P3、SNR）",
              "description": "是否明确本任务是将P3、归一化SNR等谱特征校准为可操作的阈值/概率以进行外显子/内含子分类。",
              "score": 30,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：清晰阐述R=P3/D校准与阈值的作用并关联分类；中分：提到阈值但未关联校准或SNR；低分：将任务误解为仅计算谱量或仅做FFT。"
            },
            {
              "sub_criteria": "区分单特征判别与多特征融合（Z-curve、邻域频带）",
              "description": "是否识别单一R不足并提出多特征（Z-curve能量、P[k±Δ]、GC）融合的必要性。",
              "score": 30,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：提出并列举具体扩展特征与动机；中分：笼统提融合但无细节；低分：只依赖单一R且无讨论。"
            },
            {
              "sub_criteria": "考虑类别不均衡与物种/基因类型差异",
              "description": "是否识别外显子/内含子不均衡与跨物种阈值差异并提出应对（加权/分层）。",
              "score": 40,
              "evaluation_focus": "问题洞察",
              "scoring_hint": "高分：提出类别权重/重采样与分物种阈值或层次校准；中分：仅口头提不均衡；低分：忽视不均衡与物种差异。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "精确复述输入输出（窗口谱特征→标签与后验概率）",
              "description": "是否将输入（P3、R、Z-curve、PWM）与输出（阈值/模型、概率、FDR）一一对应复述。",
              "score": 35,
              "evaluation_focus": "表达准确",
              "scoring_hint": "高分：列清输入字段与产出件；中分：部分列举；低分：泛化表述不具体。"
            },
            {
              "sub_criteria": "明确训练/验证分离与交叉验证流程",
              "description": "是否复述需使用交叉验证与独立验证集避免泄漏。",
              "score": 35,
              "evaluation_focus": "方法规范",
              "scoring_hint": "高分：说明K折/嵌套CV与固定操作点；中分：仅提CV无细节；低分：未区分训练与验证。"
            },
            {
              "sub_criteria": "阈值策略与操作点（F1、FPR约束）",
              "description": "是否阐明以F1最大化或给定FPR下最大召回等选择准则。",
              "score": 30,
              "evaluation_focus": "任务对齐",
              "scoring_hint": "高分：给出至少一种可检验的操作点准则；中分：模糊提到‘调阈值’；低分：无阈值策略。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "Null分布构造（随机、保留单核苷酸/二联体）",
              "description": "是否提出用于P3或R显著性的置换/保留频率的零假设建模。",
              "score": 35,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：对比多种null并说明适用性；中分：只提随机打乱；低分：无null设定。"
            },
            {
              "sub_criteria": "标签粒度假设（窗口为正的覆盖率τ）",
              "description": "当标签为碱基级时，是否提出窗口正例判定阈值τ并说明影响。",
              "score": 25,
              "evaluation_focus": "建模假设",
              "scoring_hint": "高分：明确τ并讨论敏感性；中分：提到需阈值未定量；低分：忽略粒度差异。"
            },
            {
              "sub_criteria": "先验与长度约束（物种先验、外显子长度分布）",
              "description": "是否假设并利用物种先验与长度分布用于后续HMM/后处理。",
              "score": 40,
              "evaluation_focus": "领域知识",
              "scoring_hint": "高分：提出具体分布或来源；中分：泛指‘利用先验’；低分：未提先验与长度约束。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "单特征判别与ROC/AUC评估（P3、SNR）",
              "description": "是否构建以R或P3为分数的单变量模型并提供ROC/AUC基线。",
              "score": 25,
              "evaluation_focus": "评价设计",
              "scoring_hint": "高分：提供AUC并解释；中分：给ROC无数值；低分：无基线评估。"
            },
            {
              "sub_criteria": "多特征监督学习（逻辑回归/随机森林/XGBoost）",
              "description": "是否构建含Z-curve能量、多尺度P3、PWM、GC等特征的分类器并正则化。",
              "score": 35,
              "evaluation_focus": "模型设计",
              "scoring_hint": "高分：说明特征、正则与超参；中分：仅列模型名；低分：缺少多特征模型。"
            },
            {
              "sub_criteria": "概率校准（Platt scaling/Isotonic）",
              "description": "是否对分类器输出进行概率校准并报告校准曲线/期望校准误差。",
              "score": 25,
              "evaluation_focus": "统计校准",
              "scoring_hint": "高分：实现并报告ECE/Brier；中分：仅声称已校准；低分：无校准。"
            },
            {
              "sub_criteria": "时序上下文整合（HMM/半马尔科夫）",
              "description": "是否将已校准概率融入HMM并建模外显子长度与剪接位点转移。",
              "score": 15,
              "evaluation_focus": "结构建模",
              "scoring_hint": "高分：给出状态、转移与发射定义；中分：仅提HMM；低分：无上下文模型。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "嵌套交叉验证与超参数搜索",
              "description": "是否采用嵌套CV调参并避免信息泄漏（外层评估、内层搜索）。",
              "score": 35,
              "evaluation_focus": "训练规范",
              "scoring_hint": "高分：清晰给出K、网格/贝叶斯搜索；中分：单层CV；低分：无CV或泄漏。"
            },
            {
              "sub_criteria": "不平衡处理（类别权重/重采样）",
              "description": "是否在训练时使用class_weight、focal loss或重采样并报告影响。",
              "score": 25,
              "evaluation_focus": "鲁棒性",
              "scoring_hint": "高分：量化前后指标；中分：仅开启权重；低分：忽略不平衡。"
            },
            {
              "sub_criteria": "显著性与多重检验（置换p值、BH-FDR）",
              "description": "是否实现置换检验计算p值并用BH控制FDR，映射等效R/P3阈值。",
              "score": 25,
              "evaluation_focus": "统计推断",
              "scoring_hint": "高分：报告FDR与阈值曲线；中分：仅报告p值；低分：无多重校正。"
            },
            {
              "sub_criteria": "Viterbi/前向后向推断（如用HMM）",
              "description": "若采用HMM/HSMM，是否正确求解最优路径与边际概率并可重现。",
              "score": 15,
              "evaluation_focus": "算法实现",
              "scoring_hint": "高分：提供日志似然与路径；中分：仅给预测；低分：算法不明或不收敛。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "数据管线与复现（特征→训练→校准→FDR→预测）",
              "description": "是否提供端到端脚本/模块与固定随机种子、版本锁定，保证可复现。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：一键运行与README；中分：可运行但步骤分散；低分：缺少关键脚本。"
            },
            {
              "sub_criteria": "评估与可视化（ROC/PR、校准曲线）",
              "description": "是否输出ROC/PR、校准曲线、混淆矩阵与报告文件。",
              "score": 25,
              "evaluation_focus": "工程完整性",
              "scoring_hint": "高分：自动生成图表与摘要；中分：部分图表；低分：仅口头描述。"
            },
            {
              "sub_criteria": "接口与模型保存（阈值策略/模型文件/参数）",
              "description": "是否标准化保存阈值、校准器与模型（pickle/joblib）并提供预测API。",
              "score": 25,
              "evaluation_focus": "可用性",
              "scoring_hint": "高分：稳定API与版本兼容；中分：仅保存模型；低分：无法复用。"
            },
            {
              "sub_criteria": "性能与并行（置换并行、批量预测）",
              "description": "是否对置换检验与预测做并行或向量化优化并监控时间/内存。",
              "score": 20,
              "evaluation_focus": "效率优化",
              "scoring_hint": "高分：量化加速比；中分：有限优化；低分：明显低效。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "核苷酸级与外显子段级指标（精确率/召回/ROC/AUC）",
              "description": "是否分别报告碱基级与片段级指标并解释差异与权衡。",
              "score": 30,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：完整报告并分析差异来源；中分：仅单一层级；低分：无量化指标。"
            },
            {
              "sub_criteria": "阈值/操作点选择的依据与敏感性",
              "description": "是否展示F1或FPR约束下的阈值曲线，并做敏感性与置信区间分析。",
              "score": 25,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：给出阈值-性能曲线与置信区间；中分：口头说明；低分：无依据。"
            },
            {
              "sub_criteria": "显著性与FDR报告（p值分布、q值）",
              "description": "是否提供p值直方图、q值阈与通过FDR的片段列表。",
              "score": 20,
              "evaluation_focus": "统计解读",
              "scoring_hint": "高分：齐备并一致；中分：部分提供；低分：缺失或不一致。"
            },
            {
              "sub_criteria": "生物学合理性与端点误差分析",
              "description": "是否结合剪接位点PWM与长度分布分析端点误差与假阳性模式。",
              "score": 25,
              "evaluation_focus": "领域验证",
              "scoring_hint": "高分：定位典型错误并提出修正；中分：一般性讨论；低分：无生物学分析。"
            }
          ]
        }
      }
    },
    "4": {
      "subtask": "子任务 4 的目标是系统化地评估与量化基因预测流水线的性能、稳健性与不确定性，开展参数敏感性分析，提供基于频谱变化的候选突变（尤其移码/插入-删除）检测方法，并把整个验证与部署流程规范化为可复现的软件工件和报告。为此需按以下步骤实施：一是明确并实现评估指标与判据——在碱基级计算精确率、召回率和 F1；在外显子段级按“有任意重叠即命中”或按交并比（IoU）定义段级召回/精确度；报告 ROC 曲线与 AUC、精确率-召回曲线、端点定位误差的均值/中位数及分布图；二是构建数据划分与验证策略——准备带注释的数据集并划分为训练/验证/独立测试集（或采用 k‑fold 交叉验证），在每次划分上训练/校准模型并在未见数据上评估，所有实验保留随机种子以确保可重复；三是不确定性量化与显著性检验——对关键评分输出给出置信区间（例如通过自助法 bootstrap）、对窗口/片段的谱值采用置换检验（完全随机或保持一阶/二阶统计）获得经验 p 值并用 Benjamini–Hochberg 控制 FDR，将 p 值与校准后的概率同时作为置信度指标；四是系统性敏感性与稳健性分析——对关键参数（窗口长度集合 M、阈值/置信度截断、最短外显子长度、平滑核宽度、加权融合规则等）做网格搜索或局部灵敏度扫描，绘制参数-性能曲面并报告在生物学上合理参数区间内的性能波动，同时进行分层评估以考察不同物种或不同基因类型的性能差异；五是突变/移码候选检测流程——在基线频谱曲线上执行变点检测（可选算法：CUSUM、Binary Segmentation、Bayesian change-point 或专用包如 ruptures），识别显著的局部 P3 降落或上升区段，结合置换 p 值与效应大小（P3 变化比率）输出候选突变位点/区间并为每个候选提供置信度与建议后续验证（例如比对或深度测序）；六是校准与再训练策略——若跨物种或跨数据源性能差异显著，采用分层/贝叶斯收缩或按物种独立重估阈值与概率校准（Platt 或 isotonic regression），并提供自动化的增量再训练/更新流程；七是性能与资源基线、复现与部署规范——定义运行时复杂度与资源需求（核心滑动计数算法为 O(N) 每尺度、可并行化），实现模块化软件架构：高性能数值内核（C/C++/Rust）与 Python/R 的高层接口，完整的单元测试、参数配置、日志与版本化结果输出，建议使用 Docker 容器和工作流管理器（如 Snakemake 或 Nextflow）以保证环境可复现与批量并行处理；八是输出物与报告形式——为每次实验自动生成可视化报告（ROC/AUC、PR 曲线、校准曲线、参数敏感性图、端点误差直方图）、参数配置表、候选突变清单（坐标、p 值、效应量、置信度）、以及可供审计的结果数据包（原始评分、归一化曲线、训练/测试分割及随机种子）；九是工具建议——优先采用 numpy/pandas/scipy、scikit‑learn、statsmodels、ruptures 或等效变点工具、并行化库与可视化库，所有统计检验与多重检验步骤必须明确实现并记录以供审查。该子任务的完成应产生一套可重复、可审计的验证流程与软件组件，能让研究者量化方法在不同参数与不同物种下的可信度、识别可能的突变候选并将经验证的模型与阈值安全地部署到生产流水线或供后续实验验证使用。",
      "criteria": {
        "task_understanding": {
          "core_goal": "系统评估与量化基于频谱3-周期性的基因预测流水线性能与不确定性，并执行参数敏感性分析与频谱变点检测以发现候选突变。",
          "expected_output": "评估报表（碱基级/外显子段级精确率、召回、F1、ROC/AUC、PR曲线、端点误差分布与校准曲线）、参数敏感性图与性能曲面、置换检验p值与FDR报告、候选突变清单（坐标、效应量、p值、置信度）、可复现实验工件（随机种子、配置表、Docker/Snakemake工作流日志与版本化结果包）。",
          "key_inputs_constraints": "输入DNA序列与已注释标签（训练/验证/测试划分，需记录随机种子）；来自子任务2/3的窗级与碱基级谱特征（P3、R、Z-curve能量等）；参数集合（窗口长度M、阈值、平滑核、最短外显子长度、融合权重）；约束：统计检验需实现置换策略与BH-FDR；变点检测需支持CUSUM或ruptures；所有实验必须可复现（容器/工作流与固定seed）。",
          "modeling_type": "评价+拟合（校准）+检测",
          "role_in_pipeline": "作为最终验证与部署前的评价与稳定性分析环节，直接依赖子任务1/2生成的谱特征与子任务3的阈值/模型；其输出为性能度量、显著性与突变候选，供后续部署与实验验证使用。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "明确评价对象与指标（P3/R的评估）",
              "description": "是否将评估聚焦于基于P3与归一化SNR R的基因预测输出，在碱基级与外显子段级分别报告精确率、召回、F1、ROC/AUC与PR。",
              "score": 35,
              "evaluation_focus": "评价框架",
              "scoring_hint": "高分：两级指标齐全并分层报告；中分：仅单一级或缺少曲线；低分：未匹配P3/R相关指标。"
            },
            {
              "sub_criteria": "不确定性量化与显著性（置换p值与BH-FDR）",
              "description": "是否提出对窗口/片段P3或R进行置换检验生成p值，并用Benjamini–Hochberg控制FDR，将p值与概率校准并行报告。",
              "score": 25,
              "evaluation_focus": "统计检验",
              "scoring_hint": "高分：实现p值与FDR；中分：仅p值或仅FDR描述；低分：无显著性量化。"
            },
            {
              "sub_criteria": "参数敏感性与稳健性（M、阈值、平滑核）",
              "description": "是否识别窗口长度M、阈值/置信度截断、平滑核宽度等关键参数并规划敏感性扫描与性能曲面。",
              "score": 20,
              "evaluation_focus": "鲁棒性",
              "scoring_hint": "高分：明确网格或扫描范围与输出图；中分：仅描述不落地；低分：未考虑。"
            },
            {
              "sub_criteria": "突变/移码检测目标（频谱变点）",
              "description": "是否定义基于P3变化的变点检测目标与效应量（变化比率）用于候选突变定位。",
              "score": 20,
              "evaluation_focus": "检测目标",
              "scoring_hint": "高分：算法与效应量齐备；中分：仅方法名；低分：未覆盖突变检测。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "两级评价口径复述（碱基级与段级）",
              "description": "是否准确复述“有任意重叠即命中”与IoU口径的外显子段级评估，并区分碱基级指标。",
              "score": 30,
              "evaluation_focus": "规范理解",
              "scoring_hint": "高分：清楚区分并举例；中分：混用但可理解；低分：口径错误。"
            },
            {
              "sub_criteria": "数据划分与复现性（seed与容器/工作流）",
              "description": "是否阐明训练/验证/测试或k-fold划分与固定随机种子、Docker/Snakemake保障复现。",
              "score": 30,
              "evaluation_focus": "流程把握",
              "scoring_hint": "高分：列出seed与容器配置；中分：仅提固定seed；低分：未涉及复现。"
            },
            {
              "sub_criteria": "不确定性与校准并行输出",
              "description": "是否复述要同时输出校准概率、置换p值、FDR从而形成多维置信度。",
              "score": 20,
              "evaluation_focus": "需求对齐",
              "scoring_hint": "高分：三者并列；中分：两者；低分：仅单一分数。"
            },
            {
              "sub_criteria": "突变检测流程与工具",
              "description": "是否正确复述CUSUM/ruptures/Bayesian change-point可选并与P3变化联动。",
              "score": 20,
              "evaluation_focus": "工具对齐",
              "scoring_hint": "高分：方法与阈值、效应量对应；中分：仅列工具；低分：无关描述。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "数据独立性与分层假设（物种/基因类型）",
              "description": "是否对跨物种或基因类型性能差异提出分层评估与独立校准/再训练假设。",
              "score": 30,
              "evaluation_focus": "假设设计",
              "scoring_hint": "高分：提出分层与再校准策略；中分：仅提分层；低分：忽略差异。"
            },
            {
              "sub_criteria": "置换检验零假设设计",
              "description": "是否明确完全随机、保持一阶/二阶统计的置换层级选择与适用场景。",
              "score": 30,
              "evaluation_focus": "统计思维",
              "scoring_hint": "高分：三层零假设比较；中分：单一层级；低分：无零假设。"
            },
            {
              "sub_criteria": "边界与长度假设（最短外显子、边界窗D）",
              "description": "是否假设并解释最短外显子长度阈值与边界窗口有效长度D对评估的影响。",
              "score": 20,
              "evaluation_focus": "评估严谨性",
              "scoring_hint": "高分：定量阈值并敏感性分析；中分：仅口头说明；低分：未提。"
            },
            {
              "sub_criteria": "变点显著性与效应量阈值假设",
              "description": "是否为P3变化比率/幅度与p值设定操作性阈值并说明权衡。",
              "score": 20,
              "evaluation_focus": "检测假设",
              "scoring_hint": "高分：双阈值策略（效应+FDR）；中分：单阈值；低分：无阈值。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "评价与校准模型（Platt/isotonic）构建",
              "description": "是否构建并说明概率校准曲线与校准误差（如Brier/Calibration curve）。",
              "score": 30,
              "evaluation_focus": "拟合与校准",
              "scoring_hint": "高分：实现与报告曲线/指标；中分：仅方法描述；低分：缺失。"
            },
            {
              "sub_criteria": "参数敏感性实验设计（网格/局部扫描）",
              "description": "是否设计M、阈值、平滑核、融合权重的系统扫描与交互作用分析。",
              "score": 30,
              "evaluation_focus": "实验设计",
              "scoring_hint": "高分：给出范围、步进与响应面计划；中分：单参数扫描；低分：无计划。"
            },
            {
              "sub_criteria": "突变检测模型（CUSUM/ruptures配置）",
              "description": "是否给出变点检测损失函数、惩罚/段数选择、最小段长配置与多重检验控制。",
              "score": 25,
              "evaluation_focus": "检测建模",
              "scoring_hint": "高分：参数化配置与FDR结合；中分：默认配置；低分：笼统描述。"
            },
            {
              "sub_criteria": "资源与并行化评估设计",
              "description": "是否构建O(N×S)复杂度与并行策略的测量方案（CPU/GPU、内存峰值）。",
              "score": 15,
              "evaluation_focus": "性能建模",
              "scoring_hint": "高分：基准脚本与指标；中分：粗略估计；低分：未评估。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "交叉验证/独立测试实施",
              "description": "是否正确执行k-fold或独立测试并仅在未见数据上报告F1、ROC/AUC、PR。",
              "score": 30,
              "evaluation_focus": "实验执行",
              "scoring_hint": "高分：严格分割与多次重复；中分：单次划分；低分：训练集上评估。"
            },
            {
              "sub_criteria": "Bootstrap置信区间与显著性输出",
              "description": "是否对关键指标（F1、AUC、端点误差）给出bootstrap 95% CI并解释重采样策略。",
              "score": 30,
              "evaluation_focus": "不确定性",
              "scoring_hint": "高分：方法与区间齐备；中分：部分指标；低分：无CI。"
            },
            {
              "sub_criteria": "变点检测求解与候选排序",
              "description": "是否运行CUSUM/ruptures并产生按效应量×(1−FDR)排序的候选清单。",
              "score": 25,
              "evaluation_focus": "算法求解",
              "scoring_hint": "高分：排序与置信度；中分：未排序或单指标；低分：未产出候选。"
            },
            {
              "sub_criteria": "参数扫描与性能曲面生成",
              "description": "是否完成参数网格运行并输出性能热图/曲面与最佳操作点。",
              "score": 15,
              "evaluation_focus": "求解完整性",
              "scoring_hint": "高分：全面曲面；中分：局部热图；低分：缺失。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "可复现性（Docker/Snakemake/Nextflow与随机种子）",
              "description": "是否提供容器化镜像与工作流脚本，固定随机种子并版本化配置与结果包。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：一键复现实验；中分：部分脚本；低分：手工步骤不可复现。"
            },
            {
              "sub_criteria": "评估与统计模块实现（ROC/PR、BH-FDR、置换）",
              "description": "是否在代码中实现ROC/AUC、PR、置换检验与Benjamini–Hochberg步骤。",
              "score": 30,
              "evaluation_focus": "统计实现",
              "scoring_hint": "高分：单元测试覆盖；中分：实现无测试；低分：调用不当或缺失。"
            },
            {
              "sub_criteria": "变点检测实现与参数化",
              "description": "是否封装ruptures/CUSUM接口，支持损失、惩罚、最小段长等参数化配置。",
              "score": 20,
              "evaluation_focus": "算法工程",
              "scoring_hint": "高分：参数可配并记录；中分：固定参数；低分：硬编码或错误。"
            },
            {
              "sub_criteria": "性能与并行（O(N×S)、多线程/批处理）",
              "description": "是否实现并行/分块运行与资源监控，满足O(N×S)时间与可扩展性。",
              "score": 20,
              "evaluation_focus": "性能工程",
              "scoring_hint": "高分：稳定加速与监控；中分：有限加速；低分：性能瓶颈明显。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "核心指标报道（F1、ROC/AUC、PR）与分层结果",
              "description": "是否在独立测试集报告F1、AUC、PR并按物种/基因类型分层比较。",
              "score": 30,
              "evaluation_focus": "结果呈现",
              "scoring_hint": "高分：分层清晰含置信区间；中分：总体指标；低分：仅训练集。"
            },
            {
              "sub_criteria": "端点误差分布与校准曲线",
              "description": "是否给出端点定位误差均值/中位数/分布图与概率校准曲线及Brier分数。",
              "score": 25,
              "evaluation_focus": "细节洞察",
              "scoring_hint": "高分：图与指标齐全；中分：单一统计量；低分：未分析。"
            },
            {
              "sub_criteria": "参数敏感性与稳健性解读",
              "description": "是否解读性能曲面，找出生物学合理区间内的稳定最优与退化区域。",
              "score": 25,
              "evaluation_focus": "稳健性解读",
              "scoring_hint": "高分：定量峰谷与建议；中分：定性描述；低分：无结论。"
            },
            {
              "sub_criteria": "突变候选清单与验证建议",
              "description": "是否输出候选突变坐标、效应量、p值/FDR与后续验证（比对/测序）建议。",
              "score": 20,
              "evaluation_focus": "可行动性",
              "scoring_hint": "高分：优先级排序与明确建议；中分：列清单无建议；低分：缺失清单。"
            }
          ]
        }
      }
    }
  }
}