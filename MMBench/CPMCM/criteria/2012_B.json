{
  "task_id": "2012_B",
  "problem": "为描述观测卫星和空间飞行器的运动，需要建立适当的坐标系。本题基础坐标系为随地心平移的坐标系，取地球中心$O_c$为原点，地球自转轴取为$z$轴，指向北极为正向，$x$轴由指向零时刻的0经度线，再按右手系确定$y$轴，建立直角坐标系$O_c-X_cY_cZ_c$。地心$O_c$在绕日椭圆轨道上运动，所以理论上$O_c-X_cY_cZ_c$系是非惯性系。但地球公转周期远大于空间飞行器的观测弧段时长，故本题在短时间内认定该系为惯性坐标系，该基础坐标系不随地球旋转。\n\n第二个坐标系是随卫星运动的观测坐标系$O_c-X_cY_cZ_c$，见图2，原点取为卫星中心$O_s$，$X_s$轴沿$O_cO_s$连线，离开地球方向为正，$Z_s$轴与$X_s$轴垂直，$Y_s$轴按右手系确定。如此定义的观测坐标系也叫做UEN坐标系，因为三个坐标轴分别指向上（UP）、东（EAST）和北（NORTH）三个方向。\n\n根据变质量质点的动力学，空间飞行器在基础坐标系下的主动段的简化运动方程如下：\\[ \\ddot{\\vec{r}}(t) = \\vec{F}_e + \\vec{F}_T = -\\frac{G_m}{|\\vec{r}(t)|^3}\\vec{r}(t) + \\vec{v}_r(t)\\frac{\\dot{m}(t)}{m(t)} \\quad (1) \\]\n\n其中向量$\\vec{F}_e$表示飞行器所受的外力加速度之和，$\\vec{F}_T$表示火箭产生的推力加速度，$m(t)$为瞬时质量；$\\dot{m}(t)$是质量变化率；$\\vec{r}(t)$为空间飞行器在基础坐标系下的位置矢量；$\\ddot{\\vec{r}}(t)$表示$\\vec{r}(t)$对时间$t$的二阶导数，即加速度；$G_m$为地球引力常数（本题中地球引力常数取$G_m=3.986005 \\times 10^{14} m^3/s^2$），为了更明确地表示推力加速度的方向，$\\vec{v}_r(t)$取的是燃料相对于火箭尾部喷口的喷射速度的逆矢量。\n方程（1）中如果只保留右侧第一项，则可以表示观测卫星的简化运动方程：\n\\[ \\ddot{\\vec{r}}(t) = \\vec{F}_e = -\\frac{G_m}{|\\vec{r}(t)|^3}\\vec{r}(t) \\quad (2) \\]\n在给定基础坐标系下的位置和速度初值情况下，可以利用常微分方程组数值解方法计算空间飞行器的运动轨迹。不同空间飞行器的本质差异就在于$\\vec{v}_r(t)$和$m(t)$的模型不同，$m(t)$一般而言为严格单调递减的非负函数。$\\vec{v}_r(t)$的方向一般应与飞行器的速度方向接近或相同，其大小一般较为稳定。\n观测卫星对于空间飞行器的观测数据通过化简可以由观测坐标系下的两个无量纲比值确定：\n\\[ \\alpha = \\frac{y_s}{x_s}, \\quad \\beta = \\frac{z_s}{x_s} \\quad (3) \\]\n其中$x_s,y_s,z_s$为空间飞行器在观测坐标系中的坐标。\n\n观测数据不可避免地带有各种误差，观测误差包括随机误差和系统误差。本题假设随机误差为直接叠加在观测数据上的白噪声，可能产生于背景辐射干扰与信息处理等多个方面。系统误差也包括多种来源，如卫星定位误差、指向机构误差、图像校准误差、传感器安装误差等等。在本题框架内，我们假定只考虑与卫星平台相关的系统误差，即不同观测卫星的系统误差相互没有关联，同一观测卫星对于不同空间飞行器的系统误差是一样的。经由适当的简化模型，各种系统误差最终可以折合为观测坐标系的原点位置误差和三轴指向误差。根据工程经验，原点位置误差影响较小，而三轴指向误差影响较大，对三轴指向误差进行估计对于提高估计精度很有帮助，本题只考虑三轴指向误差。三轴指向误差在二维观测数据平面上表现为两个平移误差和一个旋转误差，具体可以用三个常值小量来表示，分别表示第一观测量的平移量、第二观测量的平移量以及观测量在平面内的旋转量。\n\n单个红外光学探测器不具备测距能力，但借助多颗（含两颗）观测卫星的同步观测能够进行逐点定位，再结合空间飞行器的运动模型，可以进行轨道参数估计。在单星观测条件下，利用空间飞行器轨道的特殊性，结合较强的模型约束也可得到一定精度轨道参数估计。由于受大气影响，垂直上升段的火箭尾焰不易观测，程序拐弯段的运动方程又较为复杂，所以本题重点关注重力斜飞段的后程段，本题所附仿真数据也集中于此段。\n\n本题以中低轨近圆轨道卫星为观测星座对假想的空间飞行器进行仿真观测，生成仿真观测数据，要求利用仿真观测数据，对假想空间飞行器的轨道参数进行估计。本题所附文件包括：\n\n参数文件satinfo.txt用来存储观测卫星信息，每行表示一颗卫星，包含六列，分别表示零时刻卫星在基础坐标系下的位置和速度。卫星编号从上到下递增并从0开始。\n\n仿真数据文件meadata_i_j.txt用来存储仿真观测数据信息。i、j为占位符，表示编号为i的卫星对编号为j的飞行器的仿真观测数据信息，按照时间顺序分行，每行分三列，分别是观测时刻以及对应观测数据。\n\n本题所涉及的数据与结果，均应采用国际标准单位，即：时间单位为秒、距离单位为米、速度单位为米每秒等等；所有位置和速度均指基础坐标系下的位置和速度。\n\n在仅考虑随机误差的条件下，请你们团队研究下列问题：\n\n观测卫星在任意时刻的位置计算是估计的前提，请根据satinfo.txt和观测卫星的简化运动方程（2），计算09号观测卫星在50.0s、100.0s、150.0s、200.0s、250.0s五个时刻的三维位置。结果保留6位有效数字。\n\n在本题给定的仿真数据下，06号和09号观测卫星对0号空间飞行器形成了立体交叠观测，请结合立体几何知识按照逐点交汇定位的思路，给出0号空间飞行器在公式（1）框架下的轨道估计，注意选取适当的和的表示模型。按照从50.0s到170.0s间隔10.0s进行采样，计算并列表给出0号空间飞行器在各个采样点的位置和速度，并给出估计残差。结果保留6位有效数字。同时绘制0号空间飞行器的三个位置t-x、t-y、t-z和三个速度t-vx、t-vy、t-vz曲线示意图。\n\n在同时考虑系统误差的条件下，进一步研究下列问题：\n\n3.  若06和09号两颗观测卫星均有可能带有一定的系统误差，对系统误差进行正确的估计能够有效提高精度。利用上述的逐点交汇方法能否同时对系统误差进行估计？若不能，是否还有其他的思路能够同时估计系统误差与轨道？给出你的解决方案与估计结果。在报告中除给出与第二问要求相同的结果外，还应分别给出两颗观测卫星的系统误差估计结果，共六个数值，分别是两颗卫星的。\n\n如果你们还有时间和兴趣，还可考虑下列：\n\n 对只有09号观测卫星单星观测的01号空间飞行器进行轨道估计，结果形式要求同第三问，注意参考第三问的系统误差估计结果。并进一步考虑在同时有多颗观测卫星观测多个空间飞行器的情况下能否联合进行系统误差估计？\n\n本题要求提供可计算出所提交报告中答案的计算程序，所使用的语言和工具不限，但推荐使用C\\C++、Fortran、Matlab、Mathematica、...。",
  "subtask": {
    "1": {
      "subtask": "子任务1（卫星轨道传播与本地UEN基建立）—— 范围与目标：从提供的 satinfo.txt 中读取编号为09的观测卫星在 t=0 时刻的基础坐标系初始状态（文件按行给出卫星编号从0开始，每行六列：x,y,z,vx,vy,vz；编号09对应文件第10行），以两体点质量模型 d^2r/dt^2 = −G_m r/|r|^3（取常数 G_m = 3.986005e14 m^3/s^2，单位：秒、米、米/s）在惯性地心系内向前传播该卫星状态，精确计算并输出该卫星在时刻 t = 50.0, 100.0, 150.0, 200.0, 250.0 s 的三维位置（以米为单位，结果保留6位有效数字）；同时为每一时刻构造卫星本地的UEN坐标系并输出对应的从UEN到惯性系的正交旋转矩阵。 必要步骤与方法：1) 读入 satinfo.txt，取第10行的初始位置向量 r(0) 和速度向量 v(0)；2) 采用数值或解析两体传播器将状态从 t=0 精确推进到目标时刻——首选数值方法为自适应步长的 Runge–Kutta–Dormand–Prince (RK45) 整合器，建议相对容差 reltol=1e-12、绝对容差 abstol=1e-9，并确保求解器在每个目标时刻给出状态值（直接在步长控制中结束于目标时刻或用高精度插值返回）；作为可选替代，若实现便利可使用开普勒（Kepler）解析传播（通用异常量方法）以获得更高精度和效率；3) 对每个输出时刻计算位置 r_s(t) 并记录其模长 |r_s|；4) 在每个时刻构造UEN基：定义单位向量 X_s = r_s/|r_s|（UP，指向远离地球中心为正），取地球自转轴常矢 k = (0,0,1)^T，计算 Y_s = normalize(cross(k, X_s))（EAST）；为避免极区退化，当 |cross(k,X_s)| 小于阈值（例如 1e-8）时改用备用参考向量（例如 [0,1,0]）代替 k 进行叉乘；最后 Z_s = cross(X_s, Y_s)（NORTH），并将旋转矩阵 R_s 组成为列向量 [X_s, Y_s, Z_s]（或按约定方向形成行/列），该矩阵将UEN坐标向量映射到惯性地心系；5) 格式化并输出每个时刻的 r_s(t)（三个分量，米，六位有效数字）和对应的 R_s，以及用于再现结果的器件与数值参数（所用 G_m、积分器类型与容差、文件行索引规则、单位约定、极区处理方法）。 必要的输入与输出：输入为 satinfo.txt（每行六列，编号自0），常数 G_m 与待计算的五个时间点；输出为五组（r_x,r_y,r_z）位置向量（米，6位有效数字）、每时刻的 UEN→惯性旋转矩阵 R_s、以及可选的速度向量 ṙ(t)（若积分器同时返回速度）。 可复现性提示：明确记录所用的积分器及其容差、时间步终止策略或插值方法、极区叉乘降级规则与坐标约定（单位与坐标轴方向），以保证独立实现能得到一致结果。",
      "criteria": {
        "task_understanding": {
          "core_goal": "基于两体点质量模型仿真传播09号观测卫星轨道并构建UEN基，精确计算并输出指定时刻的三维位置与UEN→惯性旋转矩阵",
          "expected_output": "五个时刻t=50,100,150,200,250 s的卫星位置向量(r_x,r_y,r_z，米，保留6位有效数字)与对应UEN到惯性系的3×3正交旋转矩阵；可选输出速度；附记录G_m与积分器及容差。",
          "key_inputs_constraints": "输入：satinfo.txt第10行初始状态r(0), v(0)；常数G_m=3.986005e14 m^3/s^2；输出时刻集合{50,100,150,200,250} s。约束：惯性地心系，模型为d^2r/dt^2=−G_m r/|r|^3；数值精度建议RK45(reltol≤1e-12, abstol≤1e-9)或开普勒解析法；UEN定义X_s=r/|r|, Y_s=norm(cross(k,X_s))，k=(0,0,1)，极区退化阈值~1e-8并采用备用向量；矩阵为UEN→惯性映射且正交单位。",
          "modeling_type": "仿真",
          "role_in_pipeline": "作为轨道传播与坐标基建立的前置环节，为后续多星交汇定位与轨道估计提供卫星姿态/位置基准；前序依赖数据读取与单位校验；后序依赖本任务输出进行观测建模与滤波/估计。",
          "assumptions": "satinfo.txt采用国际单位，行内以空白分隔且无缺失；旋转矩阵按列为UEN基向量；输出数值按四舍五入至6位有效数字。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "两体点质量模型识别",
              "description": "明确本子任务仅采用d^2r/dt^2=−G_m r/|r|^3的两体模型进行轨道传播，排除大气阻力、J2等摄动。",
              "score": 30,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：清楚限定仅两体且给出方程与单位；中分：提到两体但含糊单位或混入无关力；低分：遗漏或错误模型。"
            },
            {
              "sub_criteria": "输入索引与编号映射",
              "description": "正确识别09号对应satinfo.txt第10行，并读取x,y,z,vx,vy,vz作为t=0初值。",
              "score": 30,
              "evaluation_focus": "需求解析",
              "scoring_hint": "高分：明确0基编号→第10行；中分：提及09号但未明确行号；低分：行号错或读错列。"
            },
            {
              "sub_criteria": "UEN基与旋转矩阵目标",
              "description": "识别需构建UEN基(X_s,Y_s,Z_s)并输出UEN→惯性的正交旋转矩阵。",
              "score": 40,
              "evaluation_focus": "目标界定",
              "scoring_hint": "高分：说明列为基向量且方向为UEN→惯性；中分：只说输出矩阵未指明方向；低分：未识别或方向相反。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "输出时刻与数值精度复述",
              "description": "准确复述t=50,100,150,200,250 s并要求位置分量保留6位有效数字。",
              "score": 35,
              "evaluation_focus": "需求重述",
              "scoring_hint": "高分：列出5个时刻并说明六位有效数字；中分：时刻正确但精度表述不清；低分：时刻缺漏或精度错误。"
            },
            {
              "sub_criteria": "惯性地心系与单位约定",
              "description": "复述坐标系固定于地心、z沿自转轴、单位为秒/米/米每秒。",
              "score": 35,
              "evaluation_focus": "规范意识",
              "scoring_hint": "高分：完整说明系与单位；中分：部分说明；低分：混用ECEF或单位不明。"
            },
            {
              "sub_criteria": "UEN轴定义细节",
              "description": "复述X_s=UP=r/|r|，Y_s=EAST=normalize(cross(k,X_s))，Z_s=NORTH=cross(X_s,Y_s)，含极区降级策略。",
              "score": 30,
              "evaluation_focus": "细节把握",
              "scoring_hint": "高分：给出cross顺序与阈值/备用向量；中分：给出定义但无降级；低分：轴定义错误或混淆。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "两体近似合理性与时间尺度",
              "description": "阐明50–250 s短弧下忽略摄动的合理性与对精度影响预期。",
              "score": 35,
              "evaluation_focus": "建模假设",
              "scoring_hint": "高分：给出短弧误差量级或定性说明；中分：仅笼统说明可忽略；低分：未说明或不当假设。"
            },
            {
              "sub_criteria": "积分器与容差假设",
              "description": "假设采用RK45(reltol≈1e-12, abstol≈1e-9)或开普勒解析并说明选择理由与终止策略。",
              "score": 35,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：给出容差与对齐输出时刻方法；中分：给出方法无容差细节；低分：容差缺失或不合理。"
            },
            {
              "sub_criteria": "极区退化与备用参考向量",
              "description": "提出|cross(k,X_s)|<阈值时使用备用向量(如[0,1,0])的稳健性假设。",
              "score": 30,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：含阈值数量级与备用说明；中分：仅提有退化处理；低分：未考虑或处理错误。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "两体ODE/解析传播器构建",
              "description": "正确写出状态方程(位置速度一阶化)或通用异常量开普勒传播框架。",
              "score": 35,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：给出一阶系统并保证加速度=−μ r/r^3；中分：表达不完整；低分：方程错误。"
            },
            {
              "sub_criteria": "UEN旋转矩阵正交性与方向性",
              "description": "构造R=[X_s,Y_s,Z_s]使UEN→惯性，确保单位化与正交性。",
              "score": 35,
              "evaluation_focus": "几何构型",
              "scoring_hint": "高分：单位化每轴并验证R^T R≈I；中分：构造正确未验证；低分：非正交或方向颠倒。"
            },
            {
              "sub_criteria": "极区与数值稳定性设计",
              "description": "cross顺序、阈值、备用向量与再正交化(如Gram-Schmidt)的设计。",
              "score": 30,
              "evaluation_focus": "数值稳定",
              "scoring_hint": "高分：含再正交化/归一；中分：仅归一；低分：可能产生零向量。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "积分器实现与时刻对齐",
              "description": "RK45自适应步长或解析法精确到t=50…250 s，含插值或事件终止。",
              "score": 40,
              "evaluation_focus": "求解技术",
              "scoring_hint": "高分：严格对齐目标时刻且全程误差控制；中分：对齐但误差控制描述弱；低分：时刻偏移或误差失控。"
            },
            {
              "sub_criteria": "误差与容差验证",
              "description": "报告reltol/abstol与步数，或解析法的收敛/容差，确保高精度。",
              "score": 30,
              "evaluation_focus": "数值精度",
              "scoring_hint": "高分：提供容差与收敛迹象；中分：仅容差无验证；低分：无容差或不合理。"
            },
            {
              "sub_criteria": "结果单位化与格式化输出",
              "description": "位置以米输出并四舍五入至6位有效数字，矩阵数值规范。",
              "score": 30,
              "evaluation_focus": "规范执行",
              "scoring_hint": "高分：严格满足单位与有效数字；中分：格式轻微偏差；低分：单位或精度错误。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "数据读取与编号安全",
              "description": "稳健读取satinfo.txt第10行六列，含异常检查与单位校验。",
              "score": 25,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：含边界/格式校验；中分：能读取缺少校验；低分：硬编码或易崩溃。"
            },
            {
              "sub_criteria": "轨道传播器实现(RK45或开普勒)",
              "description": "稳定实现两体传播，含误差控制与状态输出接口。",
              "score": 35,
              "evaluation_focus": "算法实现",
              "scoring_hint": "高分：自适应步长/解析收敛稳健；中分：固定步长但能用；低分：数值发散或错误。"
            },
            {
              "sub_criteria": "UEN构建与正交校验",
              "description": "实现UEN轴计算、极区处理、单位化与R^T R≈I检查。",
              "score": 25,
              "evaluation_focus": "几何计算",
              "scoring_hint": "高分：含阈值与再正交化；中分：仅单位化；低分：无校验或偶发NaN。"
            },
            {
              "sub_criteria": "输出格式与可复现性说明",
              "description": "输出所用G_m、积分器类型与容差、时间点，便于复现。",
              "score": 15,
              "evaluation_focus": "可复现性",
              "scoring_hint": "高分：完整记录参数；中分：记录不全；低分：无说明。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "正交旋转矩阵验证",
              "description": "报告每时刻R^T R与I的偏差(如最大|.|≤1e-12)或条件数。",
              "score": 35,
              "evaluation_focus": "结果校验",
              "scoring_hint": "高分：给出数值验证；中分：口头声称；低分：未验证或明显不正交。"
            },
            {
              "sub_criteria": "轨道合理性检查",
              "description": "检查|r|量级与近圆MEO/LEO一致，连续性良好，无非物理跳变。",
              "score": 35,
              "evaluation_focus": "物理一致",
              "scoring_hint": "高分：给出|r|与地球半径关系/速度量级；中分：定性描述；低分：无检查或异常未解释。"
            },
            {
              "sub_criteria": "数值精度与稳定性说明",
              "description": "讨论容差与步长对结果的影响，必要时敏感性对比(如更严/更宽容差结果差异)。",
              "score": 30,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：提供差异量级或上界；中分：一般性说明；低分：无说明。"
            }
          ]
        }
      }
    },
    "2": {
      "subtask": "子任务2（观测模型与逐点交汇定位）：本子任务的目标是利用已由子任务1得到的两颗观测卫星（编号06与09）在每一观测时刻的惯性系位置 r_si(t) 和对应的本地UEN→惯性旋转矩阵 R_si(t)，以及两颗卫星的仿真观测文件 meadata_06_00.txt、meadata_09_00.txt 中按时刻给出的观测量 (t, α, β)，在每个同步观测时刻通过“两条射线最近点”法求取被观测飞行器（编号0）的逐时刻三维位置初估 p_est(t)、相应的几何残差，并在给定采样时刻区间（题目要求的 50.0s 到 170.0s，步长 10.0s）上由位置序列导出速度估计与观测残差；为此应按以下精确步骤实现：首先在数据准备阶段，读入两颗卫星在每个观测时刻的 r_si(t) 与 R_si(t)（若两颗卫星观测时刻不完全一致，应在保证数值精度的前提下将观测时间对齐——采用对观测量线性或高阶插值以获得共同观测时刻的 α,β，或仅采用两文件的交集时间点）；然后对每个共同时刻 t_k，从观测量构造卫星本地视向矢量 d_local = [1, α, β]^T 并将其归一化为单位向量 û_local = d_local/||d_local||（归一化有利于几何度量一致性），再通过惯性映射 D_i = R_si(t_k) * û_local_i 得到在惯性系下的单位观测方向向量 D_i (i=06,09)；接着以参数 λ, μ 定义两条射线 L_i(λ)=r_si+λ D_i 与 L_j(μ)=r_sj+μ D_j，构造并解析求解最小化 ||r_si+λ D_i - r_sj - μ D_j||^2 的线性方程组：设 w0 = r_si - r_sj，a = D_i·D_i, b = D_i·D_j, c = D_j·D_j，则解 λ,μ 满足 a λ - b μ = -D_i·w0 和 b λ - c μ = -D_j·w0（用矩阵解法求 λ,μ，注意检测行列式 |a(-c)-(-b)(b)|=a c - b^2 的数值大小以判定病态）；计算最近点 p_i = r_si + λ D_i 与 p_j = r_sj + μ D_j，取 p_est = (p_i + p_j)/2 作为该时刻的三维位置估计，并以 d_geom = ||p_i - p_j|| 作为几何残差/定位不确定性指标；同时计算两射线夹角 θ = arccos(D_i·D_j) 或用叉积模量判断观测几何质量，并对病态情形（如 θ 接近 0 或 det 接近 0 或 p_est 在任一卫星的 X_s 分量 x_s 非正或接近零）标注为不可靠或剔除。随后把 p_est 投影回每颗卫星的本地UEN系以计算测量重投影残差：v_s = R_si(t_k)^T (p_est - r_si(t_k))，得到 α_pred = v_s_y / v_s_x，β_pred = v_s_z / v_s_x（注意处理 v_s_x ≈ 0 的数值情况），观测残差为 Δα = α_obs - α_pred，Δβ = β_obs - β_pred；记录每颗卫星的 Δα, Δβ 及其二范数或加权范数作为测量残差。对速度估计，在所需的采样序列（50,60,…,170 s）上采用中心差分（内部点用 v_k = (p_{k+1}-p_{k-1})/(2Δt)，端点用一侧差分 v_0 = (p_1-p_0)/Δt 等）来计算线速度分量，并在必要时先对位置序列做低阶平滑（例如用三点滑动平均或局部二次多项式拟合）以抑制观测噪声放大差分而致的误差；所有差分与平滑应保持时间单位为秒、距离为米。最后按题目输出格式为每个采样时刻生成一行记录：时间 t、位置 p_est(x,y,z)（米，保留所需有效位数）、速度 v_est(vx,vy,vz)（米/秒）、几何残差 d_geom（米）、两颗卫星的投影残差 Δα,Δβ 以及观测几何质量指标（射线夹角 θ 或行列式值），并把时间-位置与时间-速度序列保存为可用于绘图的数据文件；实现工具建议使用具备线性代数与数值插值能力的环境（例如 MATLAB、Python+NumPy/SciPy 或等价的数值库），并在实现中加入对数值病态、时间对齐和异常样本剔除的明确判定与日志记录。",
      "criteria": {
        "task_understanding": {
          "core_goal": "基于两颗观测卫星06与09的UEN观测(α,β)与姿态矩阵R_si(t)、位置r_si(t)，在50–170 s以10 s步长进行逐点交汇定位，估计0号飞行器的位置与由位置序列导出的速度，并评估几何与重投影残差。",
          "expected_output": "按t=50,60,…,170 s输出：p_est(x,y,z)米、v_est(vx,vy,vz)米/秒、几何残差d_geom、两星重投影残差(Δα,Δβ)及观测几何指标(如夹角θ或det)；同时生成t–x/t–y/t–z与t–vx/t–vy/t–vz绘图数据文件。",
          "key_inputs_constraints": "输入：r_s06(t), R_s06(t), r_s09(t), R_s09(t)；meadata_06_00.txt与meadata_09_00.txt中的(t,α,β)。约束：时间对齐（交集或插值）；UEN→惯性矩阵正交；d_local=[1,α,β]需归一化；病态几何(θ≈0或ac−b^2≈0)判定与剔除；单位一致(秒/米/米每秒)。",
          "modeling_type": "拟合+评价",
          "role_in_pipeline": "位于轨道估计流程的观测几何反演阶段：前序依赖子任务1的两体传播与UEN基建立；后续为轨道动力学拟合/滤波与系统误差估计。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "明确逐点交汇定位目标与时段(50–170 s, 10 s)",
              "description": "是否准确界定本任务为用06/09号卫星的(α,β)与R_si、r_si在共同时刻进行“两条射线最近点”定位与速度派生。",
              "score": 35,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：清楚列出交汇定位、时间采样与速度由差分获得；中分：提到交汇但忽略采样或速度派生；低分：把任务误解为轨道动力学积分或滤波。"
            },
            {
              "sub_criteria": "识别关键输入(meadata_06_00/09_00, r_si, R_si)",
              "description": "点名并区分观测(α,β)与几何(r_si, R_si)的来源与角色。",
              "score": 25,
              "evaluation_focus": "需求澄清",
              "scoring_hint": "高分：逐一对应数据文件与矩阵含义；中分：只提文件名或只提矩阵；低分：输入不完整或混淆UEN/惯性。"
            },
            {
              "sub_criteria": "识别误差与指标(几何残差d_geom、重投影残差Δα,Δβ、夹角θ)",
              "description": "明确需计算d_geom与重投影残差及几何质量指标用于评估。",
              "score": 40,
              "evaluation_focus": "评价指标",
              "scoring_hint": "高分：三类指标齐全并解释含义；中分：只给d_geom或Δαβ；低分：无可量化指标。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "用UEN观测构造视向d_local=[1,α,β]并归一化",
              "description": "复述从(α,β)到û_local、再经R_si映射得到惯性方向D_i的流程。",
              "score": 40,
              "evaluation_focus": "表述严谨",
              "scoring_hint": "高分：包含归一化与矩阵方向(UEN→惯性)；中分：缺归一化或矩阵方向模糊；低分：错误坐标变换。"
            },
            {
              "sub_criteria": "两条射线L_i(λ)=r_si+λD_i与最近点解法",
              "description": "准确陈述a,b,c,w0与线性方程组及病态判定(ac−b^2)。",
              "score": 35,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：给出a,b,c,w0与解与判定式；中分：缺少判定或变量定义；低分：未给出解析方程。"
            },
            {
              "sub_criteria": "采样与速度差分策略",
              "description": "说明50–170 s取样与中心差分/端点差分并保持单位一致。",
              "score": 25,
              "evaluation_focus": "实现规划",
              "scoring_hint": "高分：明确Δt=10 s与端点处理；中分：只说差分；低分：无速度派生说明。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "时间对齐假设(交集或插值精度)",
              "description": "说明采用时间交集或插值(线性/高阶)并阐明对误差的影响与阈值。",
              "score": 30,
              "evaluation_focus": "假设管理",
              "scoring_hint": "高分：说明选择及误差控制(如插值残差阈值)；中分：仅说插值；低分：忽略对齐问题。"
            },
            {
              "sub_criteria": "几何病态处理(θ阈值或ac−b^2阈值)",
              "description": "设定θ_min或det_min并定义剔除/标注策略。",
              "score": 35,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：给出具体阈值(如θ>1°或det>1e−8)；中分：口头提及；低分：无处理导致发散。"
            },
            {
              "sub_criteria": "可见性与UEN前向条件(v_s_x>0)",
              "description": "假设仅当v_s_x远离零且为正时重投影有效，并定义近零容差。",
              "score": 35,
              "evaluation_focus": "数值稳健",
              "scoring_hint": "高分：提供阈值(如|v_s_x|>1e−6·||v_s||)与回退策略；中分：只提醒风险；低分：未处理导致异常比值。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "方向向量构造与旋转映射(D_i=R_si·û_local)",
              "description": "保证R_si为UEN→惯性且û_local单位化，含备用参考向量逻辑延续自子任务1。",
              "score": 30,
              "evaluation_focus": "几何建模",
              "scoring_hint": "高分：验证R正交且列为U,E,N；中分：未验证正交；低分：矩阵方向颠倒。"
            },
            {
              "sub_criteria": "最近点解析模型与p_est=(p_i+p_j)/2",
              "description": "完整构造a,b,c,w0与λ,μ解，输出p_i,p_j与d_geom。",
              "score": 40,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：含闭式解与数值稳定性讨论；中分：仅数值求解；低分：不成体系或计算错误。"
            },
            {
              "sub_criteria": "重投影残差模型(Δα,Δβ)",
              "description": "从v_s=R^T(p_est−r_s)得到α_pred,β_pred并与观测比较。",
              "score": 30,
              "evaluation_focus": "误差建模",
              "scoring_hint": "高分：含v_s_x近零保护；中分：无保护；低分：未给残差。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "稳健求解λ,μ与病态检测(ac−b^2、θ)",
              "description": "实现数值稳定的线性方程求解与阈值判定、回退或剔除策略。",
              "score": 40,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：使用条件数/阈值与替代策略；中分：仅判定不稳；低分：直接求解无检测。"
            },
            {
              "sub_criteria": "时间对齐与插值实现",
              "description": "对(α,β)与r_s,R_s进行一致时间栅格对齐，保持矩阵正交性（必要时再正交化）。",
              "score": 30,
              "evaluation_focus": "数值实现",
              "scoring_hint": "高分：插值并记录误差，矩阵SVD再正交；中分：简单线性插值；低分：错位时间使用。"
            },
            {
              "sub_criteria": "速度估计的差分与平滑",
              "description": "采用中心差分与端点差分，必要时使用三点平滑或局部二次拟合。",
              "score": 30,
              "evaluation_focus": "数值稳定",
              "scoring_hint": "高分：明确Δt=10 s、端点公式与平滑窗口；中分：仅中心差分；低分：未给速度或噪声极大。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "数据管线与时间对齐(文件IO与交集/插值)",
              "description": "稳健读取meadata与卫星状态，构造共同时刻序列并处理缺失与排序。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：健壮IO与日志；中分：基本可用；低分：时间错配或崩溃。"
            },
            {
              "sub_criteria": "线性代数与数值稳定(解λ,μ,正交校验)",
              "description": "使用数值库解方程并校验ac−b^2、R正交，必要时再正交化。",
              "score": 30,
              "evaluation_focus": "数值工程",
              "scoring_hint": "高分：容差可配置、异常处理完善；中分：硬编码阈值；低分：无校验。"
            },
            {
              "sub_criteria": "结果输出格式与单位(米/秒、六位有效数字)",
              "description": "按指定采样输出p_est、v_est、d_geom、Δα,Δβ、θ/ det，保留6位有效数字与单位一致。",
              "score": 40,
              "evaluation_focus": "可复现性",
              "scoring_hint": "高分：格式齐全并便于绘图；中分：缺少部分字段或精度不符；低分：不可解析或单位混乱."
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "几何质量评估(夹角θ或det分布)",
              "description": "分析θ随时间的变化并与d_geom关联，识别几何不良时段。",
              "score": 35,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：定量关联θ低→d_geom高；中分：定性描述；低分：未评估几何。"
            },
            {
              "sub_criteria": "重投影残差(Δα,Δβ)统计与异常点处理",
              "description": "给出均值/标准差或范数，指出异常点与剔除依据。",
              "score": 35,
              "evaluation_focus": "误差分析",
              "scoring_hint": "高分：统计量与阈值明确；中分：只列举个别点；低分：无统计或不一致。"
            },
            {
              "sub_criteria": "速度曲线合理性与平滑影响",
              "description": "检查t–vx/vy/vz是否平滑且与位置导数一致，讨论平滑窗口影响。",
              "score": 30,
              "evaluation_focus": "一致性检验",
              "scoring_hint": "高分：量化噪声降低或误差界；中分：定性说明；低分：速度明显噪声或不连贯。"
            }
          ]
        }
      }
    },
    "3": {
      "subtask": "子任务3（动力学约束的批量联合估计与系统指向误差辨识）要求以批量非线性最小二乘框架同时估计被观测飞行器的轨道初始状态与若观测卫星存在的恒定三轴指向误差（每颗卫星用三个常数参数表示：像面两方向平移 tα,tβ 及面内小角旋转 θ），其输入为：按时间序列给定的观测数据集（每条观测记录包含观测时刻 t 与测得的归一化像面比值 α,β，并需按时刻与动力学传播结果对齐）、每颗观测卫星在所有观测时刻的惯性位置 r_s(t) 与对应的本地UEN→惯性旋转矩阵 R_s(t)、以及物理常数（例如地球引力常数 G_m）；输出为待估参数向量 Θ（至少包含目标初始状态 X0=[r0;v0] 和每颗卫星的偏置向量 [tα,tβ,θ]），其最优值的协方差估计、观测残差时间序列及收敛诊断。方法步骤为：1) 明确观测算子與偏置模型——给定任意时刻 t，目标在惯性系的位置 r(t) 由从 X0 用二体动力学数值积分得到；在卫星 s 的本地坐标中 v_s = R_s(t)^T ( r(t) − r_s(t) )，记其分量为 x,y,z，则无偏观测为 α_true = y/x 和 β_true = z/x，同时用小角线性化模型将卫星偏置加入观测：α_pred = α_true + tα − θ·β_true，β_pred = β_true + tβ + θ·α_true（该线性化在 θ 很小时准确）；2) 构造残差矢量 r = stacked( m_obs − m_pred(Θ) ) 并用测量协方差构造加权二次目标函数 J(Θ)=r^T W r；3) 为高效求解，按迭代增量法（如 Levenberg–Marquardt 或 Gauss–Newton 带阻尼）线性化观测方程并在每次迭代计算雅可比矩阵 ∂r/∂Θ；其中对轨道初始状态 X0 的导数通过链式法则给出 ∂m/∂X0 = (∂m/∂r(t)) · Φ(t,t0) ，Φ(t,t0) 为从初始时刻到 t 的状态转移矩阵（需通过同时积分动力学方程与其变分方程获得）；对卫星偏置参数的偏导可直接解析给出（对 tα,tβ 的偏导为单位，对 θ 的偏导为 [−β_true; α_true]）；而 ∂m/∂r(t) 可由 α=y/x,β=z/x 的解析导数表示为 ∂α/∂r = (1/x) ∂y/∂r − (y/x^2) ∂x/∂r，且对局部坐标分量相对于惯性位置的导数等于 R_s(t)^T 的相应行。4) 形成正规方程 (J^T W J + λ diag(J^T W J)) ΔΘ = −J^T W r（LM阻尼 λ 可调整），求解增量 ΔΘ，更新 Θ ← Θ + ΔΘ，重复直到收敛（建议相对增量范数或目标函数下降小于 1e−6，或最大迭代次数 100）；数值积分建议使用高精度自适应 RK（例如 Dormand–Prince）并同时积分变分方程以获得 Φ，积分公差建议 reltol 1e−12、abstol 1e−9（可按实现调整）；5) 收敛后用近似 Hessian H = J^T W J 的逆或广义逆估计参数协方差，报告各参数的标准差和参数相关性；6) 为应对不可辨识或病态情况（例如观测几何不足导致 J^T W J 条件数过大），实现诊断与稳健化措施：计算正规方程条件数并在必要时通过增加先验（Tikhonov 正则化或给偏置施加工程先验方差）、降低待估偏置维度（固定某些偏置为零）或合并更多观测（时序更长或引入其他目标/卫星的数据）来改善可观测性；同时建议实施基于残差的异常值剔除（基于卡方检验）以提升鲁棒性。该子任务应明确记录数值设置、初始猜测（X0 可由逐点定位或轨道解析近似给出，偏置初值常置零）、权重矩阵设定、收敛准则和条件数阈值，并输出最终估计参数、观测重投影残差、参数协方差及可观测性/条件性诊断结果，以便对估计可信度与潜在退化模式进行定量评估。",
      "criteria": {
        "task_understanding": {
          "core_goal": "在二体动力学约束下，通过批量非线性最小二乘拟合联合估计0号空间飞行器初始状态X0与06/09号观测卫星三轴指向系统误差（tα,tβ,θ），并评估收敛与协方差。",
          "expected_output": "参数最优解Θ=[X0; b_06(tα,tβ,θ); b_09(tα,tβ,θ)]，参数协方差与标准差，观测残差(Δα,Δβ)时间序列，收敛诊断(LM迭代次数、目标函数J、条件数)，可选重投影曲线与异常值标注。",
          "key_inputs_constraints": "观测数据{t,α,β}（meadata_06_00.txt, meadata_09_00.txt）时间对齐；卫星惯性位置r_s(t)与UEN→惯性旋转矩阵R_s(t)（来自子任务1）；二体传播常数G_m=3.986005e14；动力学模型r¨=−G_m r/|r|^3；偏置模型α_pred=α_true+tα−θ·β_true, β_pred=β_true+tβ+θ·α_true（θ小角）；权重矩阵W或测量方差；积分精度要求reltol≤1e−12, abstol≤1e−9；时间单位秒、距离米；Φ(t,t0)状态转移矩阵可得。",
          "modeling_type": "拟合+仿真+评价",
          "role_in_pipeline": "作为多星联合估计的核心求解环节，前序依赖：子任务1（轨道传播与UEN基）、子任务2（逐点交汇用于X0初值与时间对齐）；后序输出用于报告残差、绘图与后续单星/多目标联合估计扩展。",
          "assumptions": "未给定测量噪声方差时，默认α,β独立同方差σ^2并取σ=常数；初值X0来自子任务2拟合或两体反算；θ为小角度线性化有效（|θ|<~5 mrad）。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "联合估计目标X0与(tα,tβ,θ)的识别",
              "description": "是否明确该任务是通过非线性最小二乘同时拟合0号目标的初始状态X0与06/09号卫星三轴指向误差三参数（tα,tβ,θ）。",
              "score": 30,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：清晰指出X0与两颗卫星各3个偏置共9参数；中分：只提到X0或单星偏置；低分：未识别系统误差或误将其当随机噪声。"
            },
            {
              "sub_criteria": "观测算子α=y/x, β=z/x与UEN→惯性R_s(t)的作用",
              "description": "是否指出α,β由本地UEN坐标v_s=R_s^T(r−r_s)的比值给出，并依赖子任务1提供的R_s(t)、r_s(t)。",
              "score": 25,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：写出v_s与α,β关系并强调R_s(t)来源；中分：仅口述依赖转换；低分：忽略坐标映射或将α,β当角度而非比值。"
            },
            {
              "sub_criteria": "二体动力学约束与状态转移矩阵Φ",
              "description": "是否识别r¨=−G_m r/|r|^3用于传播r(t)，并需要Φ(t,t0)以支持雅可比对X0的灵敏度。",
              "score": 25,
              "evaluation_focus": "动力学理解",
              "scoring_hint": "高分：点明变分方程或STM；中分：只说数值积分无STM；低分：无动力学约束或使用直线外推。"
            },
            {
              "sub_criteria": "权重W与收敛诊断（LM/条件数/卡方）",
              "description": "是否识别需要加权最小二乘、LM阻尼与条件数/卡方用于诊断与稳健性。",
              "score": 20,
              "evaluation_focus": "评价指标",
              "scoring_hint": "高分：说明W、λ、条件数阈值或卡方；中分：仅提及LM；低分：无任何收敛与质量评估。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "明确数据流与依赖（meadata、r_s(t)、R_s(t)、G_m）",
              "description": "用任务语言复述输入输出：两星观测{t,α,β}、r_s(t)、R_s(t)、G_m→Θ与残差序列。",
              "score": 35,
              "evaluation_focus": "沟通表达",
              "scoring_hint": "高分：逐项列清并区分来源；中分：缺1–2项；低分：混淆或遗漏关键输入。"
            },
            {
              "sub_criteria": "时间对齐与采样区间(50–170s,10s)",
              "description": "是否重述需要观测时刻对齐/插值，并覆盖题设采样区间用于结果输出与速度派生（若涉及）。",
              "score": 25,
              "evaluation_focus": "需求理解",
              "scoring_hint": "高分：给出对齐策略与区间；中分：仅提区间；低分：未涉及时间对齐。"
            },
            {
              "sub_criteria": "偏置模型线性化：α_pred, β_pred含(tα,tβ,θ)",
              "description": "准确复述α_pred=α_true+tα−θ·β_true，β_pred=β_true+tβ+θ·α_true的小角模型与适用性。",
              "score": 40,
              "evaluation_focus": "模型准确",
              "scoring_hint": "高分：给出两式并说明小θ；中分：少一项或符号错误之一；低分：与题设不符或忽略θ耦合。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "噪声与权重W假设（α,β方差与独立性）",
              "description": "陈述α,β白噪声、协方差结构（独立同方差或给定σ_α,σ_β），与W的设置依据。",
              "score": 35,
              "evaluation_focus": "统计假设",
              "scoring_hint": "高分：明确σ与W=Σ^-1；中分：仅言同方差；低分：未说明或不合理权重。"
            },
            {
              "sub_criteria": "小角线性化θ的有效范围",
              "description": "给出|θ|小（如<5 mrad）的前提与潜在偏差风险及必要时的迭代线性化或二阶修正。",
              "score": 25,
              "evaluation_focus": "模型适用",
              "scoring_hint": "高分：定量阈值与风险；中分：仅说小角；低分：无提及。"
            },
            {
              "sub_criteria": "动力学模型简化边界（二体、非球形忽略）",
              "description": "说明仅用二体模型、短弧段近似惯性、忽略J2/拖曳对残差/协方差的影响。",
              "score": 25,
              "evaluation_focus": "建模边界",
              "scoring_hint": "高分：点明影响与弧段时长；中分：泛述忽略高阶；低分：未说明。"
            },
            {
              "sub_criteria": "可观测性与病态情形（射线夹角、条件数）",
              "description": "假设存在几何退化并提出检测阈值（θ_ray、cond(J^T W J)）与稳健处理。",
              "score": 15,
              "evaluation_focus": "可观测性",
              "scoring_hint": "高分：具体阈值与措施；中分：仅提醒风险；低分：无提及。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "观测方程与残差堆叠r=stack(m_obs−m_pred(Θ))",
              "description": "完整写出v_s=R_s^T(r−r_s)、α_true=y/x、β_true=z/x与偏置后的α_pred,β_pred，并定义r与J。",
              "score": 30,
              "evaluation_focus": "公式严谨",
              "scoring_hint": "高分：公式齐全且一致；中分：缺少一环；低分：错误或不自洽。"
            },
            {
              "sub_criteria": "雅可比∂r/∂Θ推导含Φ(t,t0)",
              "description": "给出∂m/∂X0=(∂m/∂r)·Φ，∂m/∂b直导数（tα,tβ单位，θ为[−β_true;α_true]）。",
              "score": 30,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：表达清晰并区分分块；中分：只给部分；低分：未给或错误。"
            },
            {
              "sub_criteria": "目标函数与正则化J(Θ)=r^T W r+prior",
              "description": "定义加权二次目标与可选Tikhonov先验（如对偏置施加σ_prior），说明用途。",
              "score": 20,
              "evaluation_focus": "算法设计",
              "scoring_hint": "高分：给出先验形式与理由；中分：仅J= r^TWr；低分：无目标函数。"
            },
            {
              "sub_criteria": "异常值与几何质量门限（射线夹角/重投影误差）",
              "description": "构造基于射线夹角、Mahalanobis或重投影阈值的剔除/降权策略。",
              "score": 20,
              "evaluation_focus": "稳健建模",
              "scoring_hint": "高分：清晰门限与流程；中分：仅概述；低分：无处理。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "LM/高斯-牛顿实现与阻尼λ策略",
              "description": "形成正规方程(J^T W J+λdiag)ΔΘ=−J^TWr，描述λ更新与收敛准则(≤1e−6,≤100步)。",
              "score": 30,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：完整给出更新与终止条件；中分：仅提LM；低分：无细节。"
            },
            {
              "sub_criteria": "二体传播与变分方程数值积分精度",
              "description": "采用RK45(DP)自适应，reltol≤1e−12,abstol≤1e−9，并确保命中观测时刻或高精度插值。",
              "score": 30,
              "evaluation_focus": "数值稳定",
              "scoring_hint": "高分：明确容差与插值策略；中分：仅给积分器；低分：无精度控制。"
            },
            {
              "sub_criteria": "条件数与协方差评估（H=(J^T W J)^{-1})",
              "description": "计算cond(H或J^T W J)，报告参数标准差与相关性，病态时采用正则或参数冻结。",
              "score": 25,
              "evaluation_focus": "数值诊断",
              "scoring_hint": "高分：有数值并给出处理；中分：仅报告协方差；低分：无诊断。"
            },
            {
              "sub_criteria": "时间对齐/插值对求解影响与实现",
              "description": "描述对α,β与R_s(t),r_s(t)的对齐，避免外插，保持单位一致。",
              "score": 15,
              "evaluation_focus": "实现细节",
              "scoring_hint": "高分：明确策略与边界；中分：笼统说明；低分：忽视对齐。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "模块化实现（传播器、STM、观测与雅可比、LM内环）",
              "description": "代码结构清晰分层，接口传递r_s(t),R_s(t),G_m与观测，产出Θ与残差。",
              "score": 30,
              "evaluation_focus": "代码结构",
              "scoring_hint": "高分：清晰模块与单元测试；中分：基本可运行；低分：耦合混乱。"
            },
            {
              "sub_criteria": "数值健壮性（阈值处理x≈0、夹角退化、异常值）",
              "description": "实现v_s_x≈0保护、射线夹角阈值、LM失败回退与异常剔除日志。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：完整保护与日志；中分：部分保护；低分：崩溃或无保护。"
            },
            {
              "sub_criteria": "精度控制与可重复性（容差、单位、随机性）",
              "description": "固定G_m、单位SI、记录reltol/abstol、迭代阈值与版本信息，结果可复现。",
              "score": 25,
              "evaluation_focus": "工程规范",
              "scoring_hint": "高分：配置可追溯；中分：部分配置；低分：不可复现。"
            },
            {
              "sub_criteria": "性能与可扩展性（批量时序、向量化/稀疏）",
              "description": "面向长时序与多卫星扩展，利用向量化或稀疏正规方程提高效率。",
              "score": 15,
              "evaluation_focus": "效率优化",
              "scoring_hint": "高分：证明显著提速；中分：一般性能；低分：低效难扩展。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "观测重投影残差(Δα,Δβ)与几何指标（夹角）",
              "description": "报告时间序列残差统计（均值/STD/RMS）与射线夹角或行列式，解释拟合好坏。",
              "score": 30,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：有统计与几何关联；中分：仅图或表；低分：无量化分析。"
            },
            {
              "sub_criteria": "参数协方差与相关性解读",
              "description": "给出Θ各分量标准差、相关系数，识别X0与(tα,tβ,θ)耦合与不可辨识风险。",
              "score": 25,
              "evaluation_focus": "不确定性",
              "scoring_hint": "高分：定量相关性并解释；中分：仅标准差；低分：未报告。"
            },
            {
              "sub_criteria": "收敛与稳健性诊断（LM迭代、J下降、条件数）",
              "description": "展示迭代轨迹、目标函数下降、条件数变化及异常值处理影响。",
              "score": 25,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：提供曲线/表与讨论；中分：只给次数；低分：无诊断。"
            },
            {
              "sub_criteria": "物理合理性与对比（与子任务2初值/轨道一致性）",
              "description": "比较估计轨道与逐点交汇初值或两体解析的一致性，解释差异来源（偏置/模型）。",
              "score": 20,
              "evaluation_focus": "物理校验",
              "scoring_hint": "高分：定量误差与解释；中分：定性描述；低分：无对比。"
            }
          ]
        }
      }
    },
    "4": {
      "subtask": "子任务4的目标是把前述算法工程化为一套可复现、可验证并带不确定度量化的计算流程和软件模块，输入为 satinfo.txt 与相应 meadata_*.txt 文件，输出为（1）09号卫星在指定时刻的位置信息文件；（2）按采样时刻给出的目标位置-速度估计表格及重投影残差文件；（3）参数协方差/置信区间与诊断报告；（4）六张时序图（t-x,t-y,t-z,t-vx,t-vy,t-vz）和若干残差统计图；（5）完整运行日志与配置文件以保证可复现。为实现上述目标，软件应按功能模块化实现：文件I/O模块（解析 satinfo.txt 与 meadata 文件并做时间对齐/插值）；数值传播模块（两体动力学 ODE 求解器，优先选用自适应步长 RK45/Dormand–Prince，推荐初始容差 reltol=1e−12、abstol=1e−9，并提供可选的开普勒解析传播作为对照）；变分方程模块（同时积分线性化变分方程以获得状态转移矩阵 Φ，用于雅可比计算）；逐点几何定位模块（两射线最短连线解析解及几何质量判据）；批量优化模块（实现 Levenberg–Marquardt 或 Gauss–Newton + 阻尼，解析雅可比以提高效率，LM 收敛阈值建议相对参数增量或目标函数下降 <1e−6，最大迭代 100）；数值线性代数模块（支持稀疏/密集矩阵求解、SVD 与条件数估计，允许正则化或先验的注入以处理病态问题）；诊断与不确定性模块（计算近似海森矩阵 H=J^T W J 的逆以给出协方差与参数标准差，报告规范化残差直方图、卡方检验结果、正规方程条件数与奇异值谱）；蒙特卡洛模块（可选，默认 N=100 用以估计估计量稳健性并输出参数分布）；可视化模块（生成并保存时间序列图、残差图与参数相关矩阵图）；以及运行控制与日志模块（读取单独配置文件以控制积分容差、优化参数、权重矩阵、随机种子和并行度，并将运行环境版本信息与关键数值参数记录于日志以便重现）。实现建议与工具：优先使用 Python（NumPy/SciPy/pandas/matplotlib），优化器可选 SciPy.optimize 或 lmfit；若需更高性能建议 C++ 与 Eigen + Ceres + Boost.odeint；所有数值计算应统一使用 SI 单位并在输出中注明；程序应对异常数值情况（如 x_s≈0、射线几何退化、正规方程条件数过大）做自动检测并在日志中记录，同时提供稳健化选项（如添加先验正则化、固定部分偏置或降低估计维度）。验证策略必须包括：单元测试（IO、传播器与雅可比的相互一致性）、保守性检验（两体传播的能量/角动量守恒在允许误差内）、重投影一致性（观测与预测残差统计检验应匹配假定噪声谱）、以及蒙特卡洛/留一法交叉验证；所有测试结果应输出成报告并由脚本可重现。输出格式应为机器可读的 CSV/JSON（结果、残差、协方差矩阵）和高分辨率 PNG 图形，代码仓库需包含 README、示例运行脚本与配置模板、版本锁定信息与随机种子控制以确保完全可复现；此外应提供运行时间与硬件要求说明，并建议在评估参数可观测性时计算正规方程的条件数与参数相关矩阵，以决定是否需要引入先验或扩展观测集合。",
      "criteria": {
        "task_understanding": {
          "core_goal": "工程化实现并评估两体轨道传播、逐点交汇定位与批量最小二乘拟合（含系统指向误差）的可复现计算流程，输出09号卫星位置、目标位置-速度估计、协方差与诊断及可视化。",
          "expected_output": "（1）09号卫星在t=50/100/150/200/250 s的三维位置CSV；（2）50–170 s每10 s的目标位置-速度估计与重投影残差CSV；（3）参数协方差矩阵与置信区间JSON/CSV及诊断报告；（4）t-x,t-y,t-z,t-vx,t-vy,t-vz PNG曲线与残差统计图；（5）完整运行日志与配置文件；（6）README与可复现脚本。",
          "key_inputs_constraints": "输入：satinfo.txt（第10行为09号r0,v0），meadata_06_00.txt、meadata_09_00.txt（t,α,β），常数G_m=3.986005e14。约束：SI单位；两体模型；RK45/Dormand–Prince建议reltol=1e-12、abstol=1e-9；UEN基X_s=r/|r|, Y_s=normalize(cross(k,X_s)), Z_s=cross(X_s,Y_s)且极区退化需备用向量；时间对齐/插值一致；LM收敛阈值<1e-6，最大100次；输出保留6位有效数字及日志记录。",
          "modeling_type": "仿真+拟合+评价",
          "role_in_pipeline": "作为全流程工程化与验证环节，整合子任务1（卫星轨道传播与UEN）、子任务2（观测模型与逐点交汇定位）、子任务3（批量联合最小二乘与系统误差辨识），并产出可复现结果与不确定度评估，供最终报告与图表展示。前序依赖：数据I/O与时间对齐、两体传播与变分方程；后序：报告撰写与对比评测。",
          "assumptions": "若未提供具体权重矩阵W，默认观测噪声同方差白噪声；若时间戳不完全重合，采用线性插值对α,β对齐；若射线夹角θ<1°或行列式接近0则标记病态并剔除。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "明确核心输出与评估：09号位置、位置-速度估计、协方差与诊断、六张时序图",
              "description": "是否准确识别子任务4需工程化产出四类核心成果，并将其与两体传播、交汇定位、LM拟合与诊断一一对应。",
              "score": 30,
              "evaluation_focus": "需求解析",
              "scoring_hint": "高分：列全4类输出并匹配到具体模块与文件格式；中分：遗漏其一（如诊断或图）；低分：仅提到数值结果，未覆盖协方差/图/日志。"
            },
            {
              "sub_criteria": "关键输入与约束：satinfo、meadata、G_m、SI单位与容差",
              "description": "是否点明satinfo第10行、meadata_06/09_00、G_m值、SI单位、RK45容差与UEN极区处理等硬性约束。",
              "score": 30,
              "evaluation_focus": "约束识别",
              "scoring_hint": "高分：同时写明G_m=3.986005e14、reltol/abstol与极区备用向量；中分：缺少其中1–2项；低分：未指出具体数值与处理。"
            },
            {
              "sub_criteria": "流程定位：集成子任务1–3并形成可复现流水线",
              "description": "是否识别该任务是集成传播、定位、批量拟合、诊断、可视化与日志的流水线任务。",
              "score": 40,
              "evaluation_focus": "流程意识",
              "scoring_hint": "高分：清楚列出前序依赖与后续报告对接；中分：仅泛称集成；低分：当作单独算法实现，未体现流水线与复现。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "两体传播与UEN旋转矩阵（09号，t=50..250 s）",
              "description": "是否复述需在惯性地心系用RK45/Kepler传播，并输出09号位置与UEN→惯性R_s矩阵。",
              "score": 25,
              "evaluation_focus": "精确复述",
              "scoring_hint": "高分：包含五个时刻与矩阵方向（UEN→惯性）；中分：仅提位置或未指明方向；低分：忽略该环节。"
            },
            {
              "sub_criteria": "逐点交汇定位与采样（50–170 s，10 s步长）",
              "description": "是否说明用两射线最近点法估计p_est与几何残差，并按采样导出速度与重投影残差。",
              "score": 25,
              "evaluation_focus": "方法对齐",
              "scoring_hint": "高分：提到射线夹角/行列式病态判据与差分速度；中分：缺病态或速度方法；低分：未提两射线法。"
            },
            {
              "sub_criteria": "批量LM拟合与系统指向误差（tα,tβ,θ）",
              "description": "是否复述联合估计X0与每星[tα,tβ,θ]，给出协方差和诊断（条件数、残差统计）。",
              "score": 25,
              "evaluation_focus": "目标覆盖",
              "scoring_hint": "高分：明确LM/高斯-牛顿、W、收敛阈值；中分：未给收敛或W；低分：未包含偏置估计。"
            },
            {
              "sub_criteria": "可复现性与输出规范（CSV/JSON/PNG、日志、配置）",
              "description": "是否强调版本锁定、随机种子、配置文件和可重复脚本生成全部输出。",
              "score": 25,
              "evaluation_focus": "复现规范",
              "scoring_hint": "高分：列出文件格式与再现步骤；中分：只提日志或配置之一；低分：未覆盖复现要求。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "观测噪声与权重W设定（白噪声同方差或给定方差）",
              "description": "是否明确噪声模型及W的构造，或声明默认同方差并可配置。",
              "score": 30,
              "evaluation_focus": "统计假设",
              "scoring_hint": "高分：给出W=σ^{-2}I或来源；中分：仅称白噪声；低分：无任何噪声与权重设定。"
            },
            {
              "sub_criteria": "时间对齐与插值假设（α,β线性/高阶插值）",
              "description": "是否约定当时间不一致时的插值策略与精度影响说明。",
              "score": 25,
              "evaluation_focus": "数据处理假设",
              "scoring_hint": "高分：指定线性插值与误差控制；中分：泛称插值；低分：忽略对齐问题。"
            },
            {
              "sub_criteria": "UEN极区退化处理与矩阵正交性保证",
              "description": "是否假设备用参考向量与正交化（如Gram-Schmidt）以确保R_s正交。",
              "score": 25,
              "evaluation_focus": "几何假设",
              "scoring_hint": "高分：阈值如|cross|<1e-8并正交化；中分：仅提备用向量；低分：未提。"
            },
            {
              "sub_criteria": "LM线性化小角近似（θ小角）与正则化先验",
              "description": "是否声明θ小角线性化适用域与必要时加入Tikhonov先验。",
              "score": 20,
              "evaluation_focus": "估计假设",
              "scoring_hint": "高分：给出小角范围或正则参数可配；中分：只提线性化；低分：未提风险与缓解。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "两体动力学与变分方程Φ构建",
              "description": "是否给出d2r/dt2=−μr/|r|^3与同时积分变分方程以获得Φ(t,t0)。",
              "score": 25,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：说明状态与Φ联合积分维度与初值；中分：仅提Φ需计算；低分：无Φ导致无法雅可比。"
            },
            {
              "sub_criteria": "观测模型含偏置：α_pred,β_pred与雅可比",
              "description": "是否构建α=y/x,β=z/x与偏置关系：α_pred=α+tα−θβ，β_pred=β+tβ+θα，并给出偏导。",
              "score": 25,
              "evaluation_focus": "观测建模",
              "scoring_hint": "高分：列出对X0、tα,tβ,θ的偏导表达；中分：无偏导；低分：不含偏置项。"
            },
            {
              "sub_criteria": "逐点交汇定位几何模型与病态判据",
              "description": "是否建立两射线最短距离解析解、几何残差与夹角/行列式阈值。",
              "score": 25,
              "evaluation_focus": "几何建模",
              "scoring_hint": "高分：明确a,b,c,det与θ阈值；中分：仅口述最近点；低分：未成型模型。"
            },
            {
              "sub_criteria": "诊断与不确定性指标：H=J^T W J与条件数/谱",
              "description": "是否构建协方差近似Cov≈H^{-1}及条件数/奇异值谱分析方案。",
              "score": 25,
              "evaluation_focus": "不确定性",
              "scoring_hint": "高分：明确报告标准差与相关矩阵；中分：仅提H；低分：无不确定性设计。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "RK45/Dormand–Prince配置与事件输出对齐",
              "description": "是否设置reltol=1e-12、abstol=1e-9并确保在目标时刻输出（步长终止或高精插值）。",
              "score": 25,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：含误差控制与能角守恒检验阈值；中分：仅设容差；低分：无容差或错时输出。"
            },
            {
              "sub_criteria": "LM/高斯-牛顿迭代与阻尼、收敛判据",
              "description": "是否实现LM阻尼、ΔΘ或J下降<1e-6与最大100次迭代，并处理发散。",
              "score": 25,
              "evaluation_focus": "数值稳定",
              "scoring_hint": "高分：含阻尼更新与失败回退；中分：固定阻尼；低分：无阈值或不收敛未处理。"
            },
            {
              "sub_criteria": "病态与正则化：条件数阈值与先验注入",
              "description": "是否基于cond(J^T W J)触发Tikhonov或降维（固定部分偏置）。",
              "score": 25,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：设定阈值如>1e12触发；中分：仅描述；低分：忽视病态。"
            },
            {
              "sub_criteria": "速度估计与平滑：中心差分/端点处理",
              "description": "是否按10 s步长用中心差分，端点一侧差分并可选三点平滑。",
              "score": 25,
              "evaluation_focus": "数值细节",
              "scoring_hint": "高分：正确端点处理并量化平滑窗口；中分：有差分无端点策略；低分：速度缺失或错误。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "模块化与配置：I/O、传播、变分、定位、优化、诊断、可视化、日志",
              "description": "是否按功能模块实现并由配置文件控制参数与随机种子，日志记录环境版本。",
              "score": 30,
              "evaluation_focus": "工程设计",
              "scoring_hint": "高分：独立模块与统一配置/日志；中分：部分模块耦合；低分：脚本散乱无配置。"
            },
            {
              "sub_criteria": "数值线性代数与稳定实现：SVD/条件数",
              "description": "是否使用稳健解法（SVD/QR）与条件数估计，避免病态崩溃。",
              "score": 25,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：提供SVD回退与正则选项；中分：仅用正则；低分：直接求逆导致不稳定。"
            },
            {
              "sub_criteria": "单元测试与守恒检验、重投影一致性",
              "description": "是否包含IO测试、传播能量/角动量守恒、观测重投影残差统计检验。",
              "score": 25,
              "evaluation_focus": "测试保障",
              "scoring_hint": "高分：自动化测试报告；中分：手工校验说明；低分：无测试。"
            },
            {
              "sub_criteria": "输出规范与格式：CSV/JSON/PNG命名与精度",
              "description": "是否按约定输出六位有效数字、文件命名清晰、包含单位与元数据。",
              "score": 20,
              "evaluation_focus": "可复现性",
              "scoring_hint": "高分：含单位/元数据与README示例；中分：格式基本正确；低分：缺单位或精度不符。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "几何残差与射线夹角统计（质量判据）",
              "description": "是否报告d_geom分布与θ分布，标注剔除规则影响。",
              "score": 25,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：给出阈值命中率与被剔除比例；中分：仅均值/方差；低分：未统计。"
            },
            {
              "sub_criteria": "重投影残差与噪声假设一致性（直方图/正态性检验）",
              "description": "是否用直方图/Q-Q或卡方检验验证白噪声假设并量化偏差。",
              "score": 25,
              "evaluation_focus": "统计检验",
              "scoring_hint": "高分：含p值/卡方自由度；中分：仅图示；低分：无检验。"
            },
            {
              "sub_criteria": "参数协方差与相关性、条件数解读",
              "description": "是否解读标准差、相关矩阵与条件数，讨论可观测性与正则化影响。",
              "score": 25,
              "evaluation_focus": "不确定性",
              "scoring_hint": "高分：指出高度相关参数并建议先验；中分：仅列数；低分：未讨论。"
            },
            {
              "sub_criteria": "时间序列图解读（t-x,y,z与t-vx,vy,vz）",
              "description": "是否从物理一致性（轨道平滑性、速度相位）解读曲线并定位异常点。",
              "score": 25,
              "evaluation_focus": "物理一致性",
              "scoring_hint": "高分：结合守恒检查解释异常；中分：笼统描述；低分：只给图无解读。"
            }
          ]
        }
      }
    }
  }
}