{
  "task_id": "2016_C",
  "problem": "在本题中，需要解决如下四个方面的问题：\n\n1. 给定 10 组 LOS 或 NLOS 传播环境下从手持终端到基站的 TOA 测量数据和所有基站的三维坐标（对应附录中编号为 case 001\\_input.txt 到 case 010\\_input.txt 的文件），请根据这些测量数据计算出终端的三维坐标。（请给出详细的建模分析，建模过程中建议考虑测量模型、误差分析等内容。）\n\n2. 给定10组TOA测量数据和所有基站的三维坐标（对应附录中编号为case 011_input.txt到case 020_input.txt的文件），请设计算法，使用尽可能少的基站数目，实现近似最优的三维定位精度。\n\n3. 给定5组对处于移动过程中的终端采集到的TOA数据（对应附录中编号为case 021_input.txt到case 025_input.txt的文件），请设计算法计算出终端的运动轨迹。（此时，编号为case 021_input.txt到case 025_input.txt的文件中，只记录一个终端的TOA数据，并且是这一个终端在运动轨迹中多个位置上的TOA数据。）\n\n4. 在前述3问中，都是假设给定区域内终端到每一个基站的距离都是可知的，但事实上，基站的通信半径是有限的，因此，只有在基站通信半径覆盖范围内的终端才有可能测到自身到基站的距离。而一个终端只有获得它与足够数目的基站之间的距离测量值，才能完成定位。假设每个基站的通信半径为200米（超过范围虽然有测量数据，但无效）。请根据给定的5组测量信息数据集（对应附录中编号为case 026_input.txt到case 030_input.txt的文件），设计算法寻找出可以被基站定位的所有终端。进一步，回答如下问题：每一个场景中（对应着case 026_input.txt到case 030_input.txt五个文件中的一个），定义终端的平均“连接度数”$\\lambda$为\n\\[\n\\lambda = \\frac{\\text{所有可以被定位终端到基站之间的连接数}}{\\text{终端数}}\n\\]\n请建立模型分析连接度数$\\lambda$与定位精度之间的关系。\n\n\\section{数据集描述}\n\n\\subsection{基本数据}\n\n输入：\n\n\\begin{itemize}\n    \\item 每一个基站的三维（某些场景下会退化为二维，在文件中通过标识位给出）坐标，其中，第$j$个基站$A_j$的三维坐标标记为$(x_j, y_j, z_j)$。\n    \\item 矩阵$\\Phi = \\begin{bmatrix} \\cdots \\text{TOA}(u_i, A_j) \\cdots \\end{bmatrix}_{M \\times N}$。矩阵$\\Phi$中$i$行$j$列元素表示标号为$i$的终端（记为$u_i$）到标号为$j$的基站（记为$A_j$）之间的TOA测量值，记为$\\text{TOA}(u_i, A_j)$。假设网络中有$M$个终端，$N$个基站，则矩阵$\\Phi$的维度为$M \\times N$。\n\\end{itemize}\\begin{itemize}\n    \\item 输入文件的格式为 txt。\n    \\item 请特别注意输入文件的具体物理意义：第 1 行为基站个数 $N$，第 2 行为终端个数 $M$，第 3 行为标识位，（2 表示二维场景，3 表示三维场景），第 4 到第 $(N+3)$ 行为基站坐标，第 $(N+4)$ 行到第 $(N+M+3)$ 行为 TOA 矩阵 $\\Phi$。\n\\end{itemize}\n\n\\textbf{输出：}\n\n$M \\times 3$ 维矩阵，第 $i$ 行表示第 $i$ 个终端的三维坐标（部分场景下是 $M \\times 2$ 维矩阵），存放在 txt 文件中。",
  "subtask": {
    "1": {
      "subtask": "子任务 1（数据准备与测量模型建立）要求对给定的输入文件做结构化读取、物理单位转换、有效性筛选、异常标记与基础统计量估计，并输出供后续定位算法直接使用的标准化数据结构与先验参数：具体步骤为——先按题目格式严格解析文本文件（第1行为基站数 N，第2行为终端数 M，第3行为维度标识 d=2或3，第4..N+3行为基站坐标 a_j=(x_j,y_j,z_j)，第 N+4..N+M+3 行为 TOA 矩阵 Φ 的每一行对应一个终端到 N 个基站的 TOA 观测），将 TOA（秒）按常数 c = 3×10^8 m/s 转换为等效测距 r̂_{i,j} = c·TOA_{i,j}（米），并以矩阵 R̂（M×N）存储；对读入的数据执行物理有效性检查（TOA 非负且数值有穷、基站坐标与维度一致），将缺失或不合法项在 R̂ 中置为 NaN 并生成二值可观测掩码矩阵 Mask_{i,j}。如题设给定通信半径 R（例如 200 m），按几何或等效测距滤除超出覆盖的观测：若 r̂_{i,j} > R 则将 Mask_{i,j}=0（或明确标注为“覆盖外”），并记录每个终端的可见基站数 n_i = Σ_j Mask_{i,j}；对 n_i 低于事先定义的可定位阈值（如含未知时钟需至少4个非共面基站，若时钟可消除则至少3个）立即在元数据中标记该终端“暂不可定位”。在预处理阶段同时计算用于后续估计的统计量：对每条链路或每个终端-链路集合基于可用观测（同一链路跨多个记录或同一时刻下不同链路的残差）估计经验噪声方差 σ_{j}^2 或 σ_{i}^2（若无侧信息则先采用全局同方差假设），并用稳健统计量（例如中位数绝对偏差 MAD）检测与标记明显离群观测（例如超出中位数 ± k·MAD，建议 k=3~5）；对观测偏置范围提供物理尺度先验：时钟不同步引入的偏差≤200 ns（≈60 m），NLOS 可能引入额外正偏≤400 ns（≈120 m），这些值应被记录为上限用于后续模型约束。为便于下游算法初始化，生成若干可选的粗略初值与数据结构：若假定基站与终端时钟同步，则可直接用加权线性最小二乘（三边定位线性化）在每个终端的可见基站上计算初步位置 p0_i；若时钟偏置未知则构造差分 TOA（TDOA）消去偏置后通过线性化方程解出 p0_i 的候选解；所有初值计算均应返回失败标志（例如当观测数或几何退化导致病态矩阵时）而非错误结果。为便于算法实现与并行处理，应把输出以结构化格式保存：标准化测距矩阵 R̂（含 NaN）、掩码 Mask、每个观测的原始 TOA、链路噪声估计 σ、离群标记矩阵、每终端的可见基站索引列表、每终端的初始位置候选 p0_i（或空值）以及元数据（基站坐标、维度标识、使用的物理常数 c、通信半径 R 及偏差上限）。推荐使用可处理数值与科学计算的工具（例如 Python + numpy/scipy/pandas）进行实现，以便批量读取、数值稳定地计算方差与 MAD、以及将预处理结果序列化为下游可直接读取的文件（例如 npz、csv 或标准 txt），但不在本子任务中执行后续的非线性优化或轨迹滤波。",
      "criteria": {
        "task_understanding": {
          "core_goal": "构建并评估用于TOA→测距的预处理与测量模型，完成数据解析、单位转换、有效性筛选、异常标记与噪声方差估计，输出标准化数据结构与先验参数以支撑后续三维定位拟合/优化",
          "expected_output": "标准化数据包文件（如npz/csv/txt）：包含R̂矩阵（米，含NaN）、Mask矩阵、原始TOA矩阵、基站坐标与维度标识、通信半径R、物理常数c、离群标记矩阵、链路或全局噪声方差σ估计、每终端可见基站索引、每终端初始位置p0候选及失败标志、元数据日志与基础统计报表",
          "key_inputs_constraints": "输入txt文件严格格式：第1行N（基站数），第2行M（终端数），第3行d∈{2,3}（维度），第4..N+3行为基站坐标(xj,yj[,zj])，第N+4..N+M+3行为TOA矩阵Φ；TOA单位为秒；光速常数c=3e8 m/s；通信半径R可给定（如200 m）；要求TOA非负且有限；基站维度与d一致；超R观测置Mask=0；不足可定位阈值的终端需标注“暂不可定位”",
          "modeling_type": "评价+拟合",
          "role_in_pipeline": "作为定位算法前的标准化数据准备与测量模型建立环节，直接依赖原始txt输入；后续任务为定位求解（WLS/ML/SDP）、鲁棒优化与轨迹估计。输出的R̂/Mask/σ/p0将被后续非线性优化或滤波直接调用",
          "assumptions": "若无多时刻重复观测，则噪声方差先按全局同方差估计；时钟偏置上限设为200 ns，NLOS正偏上限设为400 ns；初始位置p0若几何退化或可见基站不足则返回空并记录失败标志"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "TOA→测距转换与单位一致性",
              "description": "是否明确以c=3×10^8 m/s将TOA(秒)严格转换为R̂(米)，并在全流程保持米单位一致",
              "score": 35,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：清晰给出公式r̂=c·TOA并验证单位；中分：实现转换但无单位校验；低分：遗漏或单位混用"
            },
            {
              "sub_criteria": "输入格式要点与边界条件识别",
              "description": "是否准确识别N/M/d/基站坐标/Φ的行列边界与二维(d=2)或三维(d=3)差异",
              "score": 25,
              "evaluation_focus": "需求解析",
              "scoring_hint": "高分：覆盖索引范围与d=2时忽略z或置0；中分：基本解析正确但未处理d差异；低分：解析行列错位"
            },
            {
              "sub_criteria": "通信半径R覆盖筛选与可定位阈值",
              "description": "是否识别R过滤逻辑(r̂>R置Mask=0)与最小可定位基站数阈值的必要性",
              "score": 25,
              "evaluation_focus": "约束理解",
              "scoring_hint": "高分：区分同步/异步阈值(≥3/≥4)并输出标记；中分：实现R筛选但未明确阈值；低分：未进行覆盖筛选"
            },
            {
              "sub_criteria": "NLOS与时钟偏置上限先验",
              "description": "是否识别并记录200ns时钟偏置与400ns NLOS正偏的物理上限先验",
              "score": 15,
              "evaluation_focus": "先验建模",
              "scoring_hint": "高分：上限转米并入元数据；中分：提及但未量化；低分：忽略先验"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "标准化数据结构输出复述",
              "description": "是否清晰复述需输出R̂/Mask/原始TOA/σ/离群标记/可见索引/p0/元数据的完整集合",
              "score": 35,
              "evaluation_focus": "表达准确",
              "scoring_hint": "高分：逐项列明并说明用途；中分：列出大部分；低分：仅笼统提及数据清洗"
            },
            {
              "sub_criteria": "维度与坐标一致性复述",
              "description": "是否说明d=2与d=3时基站坐标与输出矩阵形态(M×2或M×3初值)的对应关系",
              "score": 25,
              "evaluation_focus": "规范意识",
              "scoring_hint": "高分：明确二维退化处理；中分：泛化描述；低分：遗漏或混乱"
            },
            {
              "sub_criteria": "覆盖筛选与n_i统计复述",
              "description": "是否复述n_i=ΣMask以及“暂不可定位”标记与失败标志的输出要求",
              "score": 20,
              "evaluation_focus": "需求映射",
              "scoring_hint": "高分：清楚阐述并给出阈值逻辑；中分：仅提及n_i；低分：未复述"
            },
            {
              "sub_criteria": "异常与离群标记复述（MAD）",
              "description": "是否复述以中位数±k·MAD(k=3~5)检测离群并在矩阵中标记",
              "score": 20,
              "evaluation_focus": "稳健统计",
              "scoring_hint": "高分：给出k范围与处理策略；中分：仅说离群检测；低分：无此项"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "同方差/分层方差σ假设",
              "description": "在观测不足时采用全局同方差；有条件时估计链路σ_j或终端σ_i并说明依据",
              "score": 35,
              "evaluation_focus": "统计假设",
              "scoring_hint": "高分：给出计算与退化策略；中分：仅声明同方差；低分：无噪声假设"
            },
            {
              "sub_criteria": "时钟同步/未知偏置情形假设",
              "description": "明确同步情形（WLS三边）与未知偏置（TDOA差分）两套初值路径与前置条件",
              "score": 30,
              "evaluation_focus": "建模覆盖",
              "scoring_hint": "高分：区分阈值与失败返回；中分：只提一种；低分：未考虑时钟问题"
            },
            {
              "sub_criteria": "NLOS偏置为正且受限的先验",
              "description": "假设NLOS引入非负偏置并受≤400ns上限约束，记录用于后续约束",
              "score": 20,
              "evaluation_focus": "先验合理性",
              "scoring_hint": "高分：量化到米并入元数据；中分：仅文字；低分：无先验"
            },
            {
              "sub_criteria": "几何退化与病态识别假设",
              "description": "对共面/共线导致矩阵病态的识别与p0失败式返回的策略假设",
              "score": 15,
              "evaluation_focus": "鲁棒性",
              "scoring_hint": "高分：提出条件数阈值或rank检查；中分：仅说明可能失败；低分：忽略"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "测量模型定义（TOA/范围）",
              "description": "形式化r̂_ij = c·TOA_ij，说明LOS/NLOS与偏置项分解，并在R̂中以NaN表示缺失",
              "score": 30,
              "evaluation_focus": "数理建模",
              "scoring_hint": "高分：给出噪声与偏置项；中分：仅给出r̂；低分：未成体系"
            },
            {
              "sub_criteria": "覆盖与掩码模型（Mask）",
              "description": "定义Mask_ij∈{0,1}并结合r̂_ij>R、非法观测、离群标记的处理策略",
              "score": 25,
              "evaluation_focus": "规则设计",
              "scoring_hint": "高分：层级规则与优先级清晰；中分：只做R过滤；低分：无掩码"
            },
            {
              "sub_criteria": "稳健离群检测（MAD）与阈值k",
              "description": "构造以MAD为核心的离群判定，给出k=3~5建议与面向链路或终端聚合口径",
              "score": 25,
              "evaluation_focus": "稳健统计",
              "scoring_hint": "高分：口径与k可配置；中分：给出固定k；低分：未建模"
            },
            {
              "sub_criteria": "初值模型（WLS线性化/TDOA差分）",
              "description": "给出同步WLS三边与未知偏置TDOA线性化的方程构造与所需最小基站数",
              "score": 20,
              "evaluation_focus": "算法设计",
              "scoring_hint": "高分：写出线性方程形态与rank要求；中分：仅描述方法名；低分：无初值"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "σ估计实现与稳定性",
              "description": "给出σ全局/链路的计算方法（方差/MAD到σ）与数值稳定处理（NaN/小样本）",
              "score": 35,
              "evaluation_focus": "数值方法",
              "scoring_hint": "高分：含最小样本门限与NaN忽略；中分：简单方差；低分：无σ估计"
            },
            {
              "sub_criteria": "离群标记与掩码联动更新",
              "description": "将离群观测在离群矩阵标注并选择性更新Mask或保留权重信息",
              "score": 25,
              "evaluation_focus": "策略落地",
              "scoring_hint": "高分：解释不直接删除的场景；中分：一刀切删除；低分：未联动"
            },
            {
              "sub_criteria": "p0求解与失败标志",
              "description": "实现WLS/TDOA的线性解，遇到几何退化返回失败标志而不是错误坐标",
              "score": 25,
              "evaluation_focus": "鲁棒求解",
              "scoring_hint": "高分：rank/cond检查与异常捕获；中分：尝试求解但无失败标志；低分：崩溃或输出垃圾值"
            },
            {
              "sub_criteria": "n_i统计与“暂不可定位”判定",
              "description": "准确计算每终端可见基站数并根据同步/异步阈值标记不可定位",
              "score": 15,
              "evaluation_focus": "规则实现",
              "scoring_hint": "高分：情形自适应；中分：固定阈值；低分：未判定"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "严格解析txt与维度一致性校验",
              "description": "健壮读取N/M/d、基站与Φ，校验坐标维度与矩阵大小，非法置NaN并记录日志",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：完整校验与错误行定位；中分：基本读取；低分：易崩溃或错读"
            },
            {
              "sub_criteria": "NaN/Mask与类型安全处理",
              "description": "R̂用浮点含NaN，Mask用布尔/0-1一致，避免隐式类型错误与广播错误",
              "score": 25,
              "evaluation_focus": "工程规范",
              "scoring_hint": "高分：单元测试或断言；中分：可运行但无校验；低分：类型混乱"
            },
            {
              "sub_criteria": "稳健统计实现（MAD、分位数）",
              "description": "使用numpy/pandas稳健实现MAD和分位数，忽略NaN并控制小样本行为",
              "score": 25,
              "evaluation_focus": "数值实现",
              "scoring_hint": "高分：nan*函数与样本阈值；中分：自写但正确；低分：错误或忽略NaN"
            },
            {
              "sub_criteria": "结构化输出与元数据完整性",
              "description": "输出npz/csv/txt并包含c、R、d、偏置上限、时间戳、版本与失败标志",
              "score": 20,
              "evaluation_focus": "可复用性",
              "scoring_hint": "高分：可直接被下游加载；中分：部分缺失；低分：无统一格式"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "基础统计报表与可见性分布",
              "description": "输出TOA/R̂基本统计（均值/中位/MAD/缺失率）与n_i分布直方或表格",
              "score": 35,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：分组到链路/终端层级；中分：仅全局；低分：无统计"
            },
            {
              "sub_criteria": "离群率与σ合理性检查",
              "description": "报告离群比例（期望<5~10%）与σ数量级是否与物理先验一致",
              "score": 25,
              "evaluation_focus": "一致性检验",
              "scoring_hint": "高分：异常解释与复核；中分：仅给出数值；低分：无检验"
            },
            {
              "sub_criteria": "覆盖筛选影响评估",
              "description": "评估R过滤对n_i和可定位终端比例的影响，并记录不可定位原因",
              "score": 20,
              "evaluation_focus": "敏感性分析",
              "scoring_hint": "高分：前后对比；中分：定性描述；低分：无评估"
            },
            {
              "sub_criteria": "初值p0可用性与失败率",
              "description": "统计p0成功率与失败原因（几何退化/可见不足），建议下游兜底策略",
              "score": 20,
              "evaluation_focus": "可用性评估",
              "scoring_hint": "高分：量化并提出替代初始化；中分：仅给出比例；低分：未分析"
            }
          ]
        }
      }
    },
    "2": {
      "subtask": "子任务 2（静态定位的初值与非线性最小化、含鲁棒化与 NLOS 补偿）的目标是：对每个终端，基于预处理得到的等效测距矩阵 r̂（含 NaN 表示缺失/不可观测）、可视基站掩码 Mask、以及每条链路的噪声方差估计 σ_j（或全局 σ），产生稳健且数值可靠的三维位置估计 p（并在必要时同时估计时钟偏置 b），同时识别并弱化 NLOS 链路的正偏置影响，并输出估计不确定性与异常链路标记。该子任务的输入为单终端的观测向量 r̂_j（仅对 Mask_j=1 的基站）、对应基站坐标 a_j、初步噪声方差 σ_j 和可选的侧信息（如 SINR/RSS）；输出为终端位置 p̂（3维或2维）、可选偏置 b̂、每条链路残差、NLOS 判别结果（布尔或偏置 s_j）及位置协方差近似。实现步骤与方法如下：1) 初值计算：若时钟偏置未知，先构造差分 TOA（TDOA）线性方程或使用在观测子集上线性化的最小二乘（在 p0 处对 ||p−a_j|| 做一阶泰勒展开）或半闭式方法（类 Bancroft）得到收敛良好的初值 p0 和 b0；若有足够几何信息亦可用几何中心/三边定位得到 p0；当可视基站数低于最小阈值（例如含偏置时 <4，已同步时 <3）应直接返回“不可定位”。 2) 权重与损失选择：构造加权非线性最小二乘目标 L(p,b)=Σ_j w_j ρ( r̂_j − (||p−a_j|| + b) )，其中权重 w_j=1/σ_j^2（或基于 SINR 的经验权），ρ(·) 为损失函数（默认平方损失，鲁棒时用 Huber 或 Tukey）。 3) 非线性求解：以 p0,b0 为初始点，用 Levenberg–Marquardt（或 trust-region，scipy.optimize.least_squares 中的 lm/trf）求解加权最小二乘（或用 IRLS 实现 M 估计），并设置收敛判据为参数变化或目标变化低于阈值、最大迭代数或雅可比条件数恶化的保护。 4) NLOS 鲁棒化：提供三种互补策略供选择或组合——(A) 交替稀疏偏置建模：引入非负偏置向量 s≥0，最小化 Σ_j w_j [ r̂_j − ||p−a_j|| − b − s_j ]^2 + λ_reg ||s||_1，通过交替最小化求解（固定 p,b 求 s 为带非负约束的 Lasso，可用坐标下降或 ADMM；固定 s 用 LM 求 p,b），λ_reg 可用交叉验证或基于预估 NLOS 比例自适应选择；(B) M 估计/IRLS：用 Huber 损失或 Tukey 函数替代平方损失并通过 IRLS 更新权重以下调异常残差影响；(C) RANSAC 前处理：在随机基站子集上反复拟合并选取最大内点集做最终 LM，以应对高比例异常。可将 A 与 B 结合（先用 A 识别偏置，再用 B 精炼）。5) 约束与数值细节：对 s_j 强制非负并在求解中加上上界（例如对应最大物理延迟 120 m），对 b 可选择固定为零（若已同步）或自由估计；参数归一化（位置坐标中心化、尺度化）和向量化实现以改善数值稳定性；对病态雅可比采用正则化（加小量到对角线）避免数值发散；使用多起点随机重启或网格搜索以降低局部极小风险。6) 后验评估：用最终雅可比计算 Fisher 信息近似得到参数协方差估计（J^T W J）^{-1} 或用数值扰动估计不确定度，计算残差统计并依据阈值标记仍然异常的链路；若偏置 s_j 显著 (>阈值) 则标记为 NLOS。7) 输出与并行化：为每终端返回 p̂,b̂、残差向量、ŝ、NLOS 标记、协方差矩阵和诊断信息（迭代次数、收敛状态）；算法应对每终端独立并行执行以扩展到大规模数据。推荐实现工具包括 Python 的 numpy/scipy（least_squares）、用于 L1 的 sklearn/coordinate descent 或自实现 ADMM、以及用于并行的 multiprocessing 或并行框架；默认超参数建议：Huber 阈值 ≈1.3–1.5·σ，λ_reg 初值按预估 NLOS 比例设为 (σ·√(2 log N)) 的标度并用小范围调优。该子任务仅关注静态单位置定位的算法实现与数值鲁棒性，不要求处理时序轨迹或半径覆盖可达性判定等其它功能。",
      "criteria": {
        "task_understanding": {
          "core_goal": "对单终端的等效测距进行稳健拟合与优化，求解三维位置 p̂（及可选时钟偏置 b̂），并识别/补偿 NLOS 偏置以最小化加权残差",
          "expected_output": "每终端的位置估计 p̂(2D/3D) 与可选偏置 b̂；残差向量；NLOS 判别或偏置 ŝ；协方差/不确定度近似；求解诊断信息（收敛状态、迭代数）",
          "key_inputs_constraints": "输入：r̂_j（含 NaN）、基站坐标 a_j、掩码 Mask、噪声方差 σ_j 或全局 σ、初值 p0,b0（可选）、物理上界（NLOS 偏置≤120 m，时钟偏置≤60 m）。约束：观测数阈值（未知偏置≥4，可同步≥3）、s_j≥0 且上界、加权最小二乘，ρ(·) 可选 Huber/Tukey，优化需数值稳定（LM/TRF），病态几何需检测。",
          "modeling_type": "拟合+优化+评价",
          "role_in_pipeline": "作为静态定位阶段的核心参数估计模块，位于‘数据准备与测量模型建立（子任务1）’之后，输出为‘运动轨迹与多时刻滤波/场景可达性与精度评估’等后续任务的输入；直接依赖前序的标准化 r̂、Mask、σ、初值与物理先验。",
          "assumptions": "若缺失链路噪声方差则采用全局同方差；若初值缺失则用TDOA线性化或几何中心生成；若收敛失败应返回失败标志与诊断而非无效坐标。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "识别‘稳健拟合+优化’核心目标与NLOS补偿需求",
              "description": "明确该任务是对 r̂_j 与几何距离 ||p−a_j||（含 b）进行加权非线性最小二乘拟合，并需鲁棒化处理NLOS正偏与离群点。",
              "score": 35,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：同时点出加权NLLS、NLOS正偏、鲁棒损失/稀疏偏置；中分：只提最小二乘或只提NLOS而欠鲁棒方法；低分：将其误判为分类或纯几何解。"
            },
            {
              "sub_criteria": "最小观测数与几何可观测性",
              "description": "指出同步/异步（含时钟偏置 b）下的最小可视基站数阈值与非共面几何要求，并标注不可定位情形。",
              "score": 25,
              "evaluation_focus": "可观测性",
              "scoring_hint": "高分：给出b未知≥4、同步≥3且需非共面；中分：给出数量阈值但未解释几何退化；低分：未区分阈值或忽略不可定位判定。"
            },
            {
              "sub_criteria": "物理先验与约束界限的识别",
              "description": "识别并使用时钟偏置≤60 m、NLOS偏置≤120 m等物理上界约束求解与正则。",
              "score": 20,
              "evaluation_focus": "先验约束",
              "scoring_hint": "高分：明确两类上界并用于约束/初始化；中分：仅提到上界未用于模型；低分：完全忽略物理先验。"
            },
            {
              "sub_criteria": "权重与σ_j作用的定位",
              "description": "阐明权重 w_j=1/σ_j^2 或基于SINR的加权对估计的作用与必要性。",
              "score": 20,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：说明异方差与IRLS更新；中分：仅固定权重；低分：未经权重建模。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "目标函数L(p,b)的清晰表述",
              "description": "准确复述 L(p,b)=Σ w_j ρ(r̂_j − (||p−a_j||+b))，含2D/3D与b可选情况。",
              "score": 40,
              "evaluation_focus": "数理表达",
              "scoring_hint": "高分：完整含权重与ρ；中分：缺权重或ρ；低分：目标函数不清或错误。"
            },
            {
              "sub_criteria": "输入输出映射与异常返回",
              "description": "清晰列出输入(r̂,a,Mask,σ,初值)到输出(p̂,b̂,残差,ŝ,协方差,诊断)及不可定位/失败标志。",
              "score": 30,
              "evaluation_focus": "需求对齐",
              "scoring_hint": "高分：覆盖全量字段与失败返回；中分：缺少部分诊断/协方差；低分：只给p̂无其他信息。"
            },
            {
              "sub_criteria": "NLOS处理路径复述",
              "description": "概述A(非负稀疏偏置s与L1)、B(M估计/IRLS)、C(RANSAC)策略与组合流程。",
              "score": 30,
              "evaluation_focus": "方案复述",
              "scoring_hint": "高分：三法皆述并说明何时组合；中分：只述其一；低分：未提NLOS策略。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "噪声模型与权重假设（σ_j或全局σ）",
              "description": "说明测距误差近似零均值高斯（LOS）与异方差；无σ_j时采用全局同方差并可基于残差更新。",
              "score": 30,
              "evaluation_focus": "统计假设",
              "scoring_hint": "高分：给出异方差+IRLS更新；中分：同方差固定；低分：未说明噪声。"
            },
            {
              "sub_criteria": "NLOS偏置非负与上界假设",
              "description": "显式假设 s_j≥0 且≤120 m，并区分LOS零均值与NLOS正偏。",
              "score": 30,
              "evaluation_focus": "先验设定",
              "scoring_hint": "高分：非负+上界并用于正则或约束；中分：仅非负；低分：无偏置假设。"
            },
            {
              "sub_criteria": "时钟偏置b的建模假设",
              "description": "说明同步场景固定 b=0，异步需估计且|b|≤60 m，可用TDOA消除偏置作初值。",
              "score": 25,
              "evaluation_focus": "模型设定",
              "scoring_hint": "高分：明确两种情景与TDOA初值；中分：仅估计b；低分：忽略b造成系统性误差。"
            },
            {
              "sub_criteria": "几何退化与可观测性假设",
              "description": "提出非共面/非共线假设，病态条件需正则或返回不可定位。",
              "score": 15,
              "evaluation_focus": "可观测性",
              "scoring_hint": "高分：列举退化并给出处理；中分：仅提退化；低分：未考虑。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "加权鲁棒目标与损失ρ的选择（Huber/Tukey）",
              "description": "构建Σ w_j ρ(残差)并给出Huber阈值≈1.3–1.5σ或Tukey参数选择依据。",
              "score": 30,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：定量阈值与动机；中分：只提鲁棒不定参；低分：纯平方损失。"
            },
            {
              "sub_criteria": "稀疏偏置s的联合建模与正则λ_reg",
              "description": "建立s≥0的L1正则模型并给出λ_reg≈σ√(2 log N)标度及上界裁剪。",
              "score": 25,
              "evaluation_focus": "模型设计",
              "scoring_hint": "高分：含非负+上界+λ标度；中分：有L1无参数依据；低分：无s建模。"
            },
            {
              "sub_criteria": "初值构造（TDOA/线性化/Bancroft/几何中心）",
              "description": "给出b未知用TDOA或线性化最小二乘，b已知用三边定位；多起点/重启策略以防局部极小。",
              "score": 25,
              "evaluation_focus": "初始化",
              "scoring_hint": "高分：≥2种初值法与失败回退；中分：单一初值；低分：无初值或随机。"
            },
            {
              "sub_criteria": "约束与归一化数值细节",
              "description": "坐标中心化/尺度化、s_j上界、对角正则、小条件数监控与早停保护。",
              "score": 20,
              "evaluation_focus": "数值稳定",
              "scoring_hint": "高分：列出多项数值技巧；中分：只做部分；低分：未考虑。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "LM/TRF或IRLS实现与收敛判据",
              "description": "使用scipy.optimize.least_squares(lm/trf)或IRLS，设置参数/目标变化阈值、最大迭代与雅可比条件数门限。",
              "score": 35,
              "evaluation_focus": "数值求解",
              "scoring_hint": "高分：具体阈值与终止条件；中分：泛述有迭代；低分：无求解细节。"
            },
            {
              "sub_criteria": "交替最小化（p,b 与 s）的正确实现",
              "description": "固定(p,b)解s（非负Lasso/ADMM/坐标下降），固定s再LM更新(p,b)，迭代至收敛。",
              "score": 25,
              "evaluation_focus": "优化策略",
              "scoring_hint": "高分：清晰两步与收敛准则；中分：只描述思想；低分：实现缺失。"
            },
            {
              "sub_criteria": "RANSAC前处理与内点集选择",
              "description": "随机子集拟合阈值=1.5σ–2σ，选择最大内点集并用于最终LM精炼。",
              "score": 20,
              "evaluation_focus": "鲁棒性",
              "scoring_hint": "高分：给阈值与轮次数；中分：仅提RANSAC；低分：未应用。"
            },
            {
              "sub_criteria": "失败检测与重启/退火",
              "description": "收敛失败或条件数恶化时执行多起点重启或随机扰动，并安全返回失败标志。",
              "score": 20,
              "evaluation_focus": "健壮性",
              "scoring_hint": "高分：有明确判据与重启策略；中分：仅文本说明；低分：无处理。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "加权残差与雅可比正确计算",
              "description": "正确实现 r_j − (||p−a_j||+b+s_j) 与对应雅可比/权重应用，支持2D/3D与NaN掩码。",
              "score": 35,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：单元测试覆盖边界；中分：实现但无测试；低分：计算错误或不处理NaN。"
            },
            {
              "sub_criteria": "IRLS/Huber或Tukey权重更新",
              "description": "实现鲁棒权重随残差迭代更新，含阈值参数化与收敛判定。",
              "score": 25,
              "evaluation_focus": "鲁棒实现",
              "scoring_hint": "高分：收敛稳定并可复现；中分：有更新但不稳定；低分：无鲁棒更新。"
            },
            {
              "sub_criteria": "L1带非负约束的高效求解",
              "description": "实现非负Lasso（坐标下降/投影梯度/ADMM）并支持上界裁剪与λ扫描。",
              "score": 20,
              "evaluation_focus": "优化实现",
              "scoring_hint": "高分：收敛快且数值稳定；中分：可用但慢；低分：不收敛或忽略非负/上界。"
            },
            {
              "sub_criteria": "协方差近似与诊断输出",
              "description": "基于(J^T W J)^−1或数值扰动输出协方差近似，并记录迭代数、终止原因、RANSAC内点率。",
              "score": 20,
              "evaluation_focus": "工程完整性",
              "scoring_hint": "高分：提供多项诊断；中分：仅少量指标；低分：无不确定度与诊断。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "残差统计与NLOS判别效果",
              "description": "报告加权残差分布、识别的NLOS比例、ŝ大小与上界命中率，比较鲁棒化前后差异。",
              "score": 30,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：量化改进与阈值命中；中分：定性描述；低分：无分析或误读。"
            },
            {
              "sub_criteria": "位置不确定度与FIM解释",
              "description": "给出协方差主轴/标准差并讨论几何稀疏方向误差放大（J^T W J 条件数）。",
              "score": 25,
              "evaluation_focus": "误差评估",
              "scoring_hint": "高分：结合条件数与方差；中分：只给数值不解释；低分：未提供。"
            },
            {
              "sub_criteria": "可观测性与失败案例复盘",
              "description": "分析不可定位或收敛失败样例及其原因（观测数不足、共线/共面、权重失衡）。",
              "score": 25,
              "evaluation_focus": "诊断能力",
              "scoring_hint": "高分：定位具体原因与改进建议；中分：泛述原因；低分：忽略失败。"
            },
            {
              "sub_criteria": "超参数敏感性（Huber阈值、λ_reg）",
              "description": "考察阈值1.3–1.5σ与λ_reg标度对精度与NLOS识别的影响并给出推荐设置。",
              "score": 20,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：提供曲线/对比与建议；中分：仅文字说明；低分：无敏感性分析。"
            }
          ]
        }
      }
    },
    "3": {
      "subtask": "子任务 3（基站子集选择：以尽可能少的基站实现近似最优定位）要求在给定场景下针对每个待定位点或一个先验位置区域，设计并实现一个独立的、可复现的子集选择模块，其输入为：全部候选基站坐标 {a_j}_{j=1..N}、对应观测噪声方差或权重 {σ_j^2}（或等权重）、以及一个用于评估信息量的目标位置 p0（可以为先验位置、粗定位结果或一组代表性位置）；模块输出为一个尽可能小的基站索引子集 S，使得在 S 上进行定位可达到用户给定的精度要求或在给定基站数下达到近似最优精度，并同时返回所选子集的质量度量（如预期协方差近似 Cov ≈ I_S(p0)^{-1}、GDOP、det(FIM)或trace(Cov)）。具体任务边界与步骤如下：1) 目标与约束定义——明确要最小化的量（基站数 |S|）与要满足的定位性能阈值 τ（例如 trace(Cov) ≤ τ 或 GDOP ≤ τ），或反向设定固定的最大基站数 k 并以某准则（D-准则：最大化 det(I_S)，或 A-准则：最小化 trace(I_S^{-1})）为目标寻找最优子集；若定位同时含需估计的时钟偏置，则在 FIM 中包含偏置维度并据此验 rank 条件。2) 信息度量构造——对任意候选基站 j 在位置 p0 处计算方向向量 g_j = (p0 − a_j)/||p0 − a_j||（或其在二维/三维相应形式），构建 Fisher 信息增量矩阵 I_j = (1/σ_j^2) g_j g_j^T（若含偏置 b，则对应附加行列），并以 I_S = Σ_{j∈S} I_j 为子集信息矩阵；用 I_S 的行列式、条件数、迹或其逆矩阵的迹作为子集质量度量。3) 算法设计与实现策略——由于子集选择为组合性 NP-hard 问题，提供两类实用算法：精确（小规模 N）与近似（中大规模 N）。当 N≤可穷举阈值（例如 10–12）时可穷举所有子集并直接选最优；否则采用贪心递增（每步在尚未选入的基站中选择使目标增益最大者，直至达到精度阈值或到达预定基站数），贪心在许多信息增益指标下近似良好且高效；作为更精细的替代，可将问题表述为混合整数非线性/凸优化（例如最大化 logdet(I(x)) s.t. Σ x_j ≤ k, x_j ∈ {0,1}）并使用整数规划或半正定松弛（SDR）与随机化重构获得近似解（可用 cvxpy + MIP/SDP 求解器实现）。4) 数值细节与稳健性——为避免病态矩阵，计算 I_S 时对角加小常数正则项 εI；在评估 candidate 增益时可用矩阵行列式的增量公式或基于秩-1 更新加速运算；若存在已识别为高概率 NLOS 的基站或权重信息（低 SINR），应在权重中反映以降低其被选中的可能性；对于不确定或多点先验 p0，可对若干 p0 候选执行子集选择并取并集或交集策略以获得稳健子集。5) 输出与复杂度说明——模块应返回：所选基站索引列表 S、预期信息矩阵 I_S、协方差近似 Cov ≈ I_S^{-1}、质量度量值（det, trace, GDOP）、所需基站数与算法类型（贪心/穷举/SDR），并报告运行时间复杂度（贪心约 O(k·N·d^3) 主要由矩阵更新支配，穷举按子集数增长，SDR/整数规划视求解器而定）。6) 实现工具建议——数值线性代数与矩阵操作用 numpy/scipy，非线性/凸/整数求解可用 cvxpy（配合 MOSEK/Gurobi/CBC 等求解器），并用并行化（多线程或向量化）加速对多个 p0 或多个候选位置的并行评估。该子任务的完成要求代码能够在给定 p0 和噪声模型下自动返回满足精度目标的最小或近似最小基站集合，并提供可解释的数值质量报告供下游定位步骤使用。",
      "criteria": {
        "task_understanding": {
          "core_goal": "在给定候选基站与噪声方差下优化选择最小数量的基站子集以满足定位精度阈值或在固定基站数下最大化信息量（如最大化 det(FIM) 或最小化 GDOP/trace(Cov)）",
          "expected_output": "基站索引子集S；对应信息矩阵I_S与协方差近似Cov≈I_S^{-1}；质量度量（GDOP、logdet、trace）；算法类型与计算复杂度报告；若未达阈值则返回失败标志与最近似解",
          "key_inputs_constraints": "输入：a_j∈R^d（d=2或3）的全部候选基站坐标；噪声方差σ_j^2或等权重；评估位置p0（可多点）；精度阈值τ或最大基站数k；是否含时钟偏置b。约束：I_S需满秩（含b时秩≥d+1），使用正则εI避免奇异；权重应反映NLOS/SINR；若多p0需采用并集/交集策略保证鲁棒性。",
          "modeling_type": "优化+评价",
          "role_in_pipeline": "作为静态定位前的传感器/基站配置优化模块，直接依赖子任务1的数据准备与噪声估计、子任务2的初值p0或先验区域；其输出S与I_S用于子任务2的非线性最小化与不确定度评估。",
          "assumptions": "若未给定时钟偏置状态，则默认含单一偏置b并在FIM中扩展维度；噪声独立同方差时取σ_j^2=σ^2；p0若缺失，使用粗定位或候选网格点集合。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "精度阈值τ或最大基站数k的优化目标界定",
              "description": "是否明确“最小化|S|满足trace(Cov)≤τ或GDOP≤τ”与“固定k下最大化logdet(I_S)”两种目标，并选择其一为主目标。",
              "score": 30,
              "evaluation_focus": "目标设定/优化",
              "scoring_hint": "高分：清晰列出两种目标并选定一主目标含数学表达；中分：只口头描述精度与数量权衡；低分：未明确目标或将两者混用。"
            },
            {
              "sub_criteria": "输入约束识别（a_j, σ_j^2, p0, d, 偏置b）",
              "description": "是否点名需要的基站坐标、噪声方差、评估位置p0、维度d以及是否估计时钟偏置b等关键信息。",
              "score": 25,
              "evaluation_focus": "需求澄清",
              "scoring_hint": "高分：完整列出并说明缺失时的替代方案；中分：缺1项或未说明替代；低分：多项遗漏。"
            },
            {
              "sub_criteria": "可辨识性与秩条件",
              "description": "是否指出I_S需满秩（含b时秩≥d+1，不含b时秩≥d），并识别几何退化（共线/共面）。",
              "score": 25,
              "evaluation_focus": "数理判别",
              "scoring_hint": "高分：给出秩条件并示例退化几何；中分：仅提到“满秩”无细节；低分：未考虑可辨识性。"
            },
            {
              "sub_criteria": "鲁棒性需求（NLOS/SINR权重）",
              "description": "是否要求在σ_j^2/权重中反映NLOS概率或SINR，避免劣质基站被选中。",
              "score": 20,
              "evaluation_focus": "鲁棒性",
              "scoring_hint": "高分：明确权重与NLOS先验关联；中分：只提“加权”未说明来源；低分：等权且无解释。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "FIM与GDOP/trace(Cov)等质量度量复述",
              "description": "正确复述I_j=(1/σ_j^2) g_j g_j^T，I_S=Σ I_j，Cov≈I_S^{-1}，并关联GDOP/trace/logdet。",
              "score": 35,
              "evaluation_focus": "公式把握",
              "scoring_hint": "高分：写出公式且单位/维度正确；中分：概念正确但无公式；低分：度量混淆。"
            },
            {
              "sub_criteria": "优化问题形式化",
              "description": "将子集选择表述为min|S| s.t. 质量度量≤τ或max logdet(I_S) s.t. |S|≤k。",
              "score": 35,
              "evaluation_focus": "数学建模",
              "scoring_hint": "高分：给出约束与变量定义完整；中分：缺少部分约束；低分：未形式化。"
            },
            {
              "sub_criteria": "多点先验p0处理",
              "description": "复述对多个p0采用并集/交集或平均FIM策略以稳健化。",
              "score": 30,
              "evaluation_focus": "稳健设计",
              "scoring_hint": "高分：提出并集/交集并说明取舍；中分：仅提多点平均；低分：忽略多p0情形。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "噪声与独立性假设（σ_j^2）",
              "description": "说明独立高斯或等效加权假设，缺侧信息时采用同方差σ^2并可调。",
              "score": 30,
              "evaluation_focus": "统计假设",
              "scoring_hint": "高分：交代来源与敏感性；中分：仅写高斯独立；低分：无噪声假设。"
            },
            {
              "sub_criteria": "偏置b建模假设",
              "description": "明确是否含时钟偏置b并在FIM中扩展维度或采用TDOA近似消除。",
              "score": 30,
              "evaluation_focus": "模型设定",
              "scoring_hint": "高分：两种处理均说明；中分：仅选一种；低分：忽略b但声称全局适用。"
            },
            {
              "sub_criteria": "正则与数值稳定假设",
              "description": "引入εI正则避免I_S奇异，给出ε选择范围与影响。",
              "score": 20,
              "evaluation_focus": "数值稳健",
              "scoring_hint": "高分：量级建议（如ε≈1e-6·trace/ d）；中分：仅提加正则；低分：未考虑。"
            },
            {
              "sub_criteria": "几何覆盖与最小基站数",
              "description": "阐明d维无偏置最小d基站（实际≥d+1更稳健），含b时≥d+1（实际≥d+2）。",
              "score": 20,
              "evaluation_focus": "可辨识性",
              "scoring_hint": "高分：列出d=2/3具体数值；中分：口头‘至少3/4个’；低分：无下限讨论。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "方向向量g_j与I_j构造",
              "description": "正确计算g_j=(p0−a_j)/||p0−a_j||并据此构建I_j=(1/σ_j^2)g_jg_j^T（含b时扩展）。",
              "score": 30,
              "evaluation_focus": "推导实现",
              "scoring_hint": "高分：给出二维/三维及含b扩展块矩阵；中分：仅给无b情形；低分：公式错误。"
            },
            {
              "sub_criteria": "质量度量选择与理由（D/A-准则、GDOP）",
              "description": "选择logdet(I_S)、trace(I_S^{-1})或GDOP并解释适用场景与权衡。",
              "score": 25,
              "evaluation_focus": "指标选择",
              "scoring_hint": "高分：说明对尺度不变性与极值敏感性；中分：只列名称；低分：选择无依据。"
            },
            {
              "sub_criteria": "多p0聚合策略",
              "description": "定义Ī=Σ_q w_q I_S(p0_q)或鲁棒并/交集策略并说明w_q设置。",
              "score": 20,
              "evaluation_focus": "稳健建模",
              "scoring_hint": "高分：权重与区域覆盖关系清晰；中分：仅平均；低分：忽略。"
            },
            {
              "sub_criteria": "约束与惩罚（秩、条件数）",
              "description": "在目标中加入秩/条件数惩罚或筛除病态候选，保证I_S可逆且cond(I_S)受控。",
              "score": 25,
              "evaluation_focus": "约束设计",
              "scoring_hint": "高分：给阈值如cond≤1e6；中分：口头限制；低分：未控制病态矩阵。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "算法策略选择（穷举/贪心/SDR）",
              "description": "根据N与k选择穷举（N≤12）、贪心递增、或SDR/MIP并说明理由。",
              "score": 30,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：给规模阈值与时间复杂度；中分：只选一种无阐述；低分：不适配规模。"
            },
            {
              "sub_criteria": "贪心增益与秩-1更新",
              "description": "在贪心中使用logdet/trace增益与Sherman–Morrison或Cholesky增量更新。",
              "score": 25,
              "evaluation_focus": "数值效率",
              "scoring_hint": "高分：写出增量公式或实现细节；中分：仅提‘增量’；低分：每步重算导致高复杂度。"
            },
            {
              "sub_criteria": "停止条件与失败处理",
              "description": "清晰定义达到τ或用尽k/候选；未达阈值返回最优近似与告警。",
              "score": 20,
              "evaluation_focus": "工程稳健",
              "scoring_hint": "高分：包含阈值/上限与返回码；中分：有停止无失败路径；低分：可能死循环或静默失败。"
            },
            {
              "sub_criteria": "含偏置b的FIM扩展与rank检验",
              "description": "求解前后检查扩展FIM的秩并剔除退化组合。",
              "score": 25,
              "evaluation_focus": "可辨识性",
              "scoring_hint": "高分：实现rank/cond阈值筛选；中分：只口头提及；低分：忽略导致不可逆。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "数值稳定性（正则ε、条件数监控）",
              "description": "实现中对I_S加εI并在inv/logdet处用稳定分解（Cholesky/SVD）。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：使用cholesky/logdet via slogdet且ε可配置；中分：仅np.linalg.inv；低分：频繁报错或NaN。"
            },
            {
              "sub_criteria": "复杂度与向量化/增量更新",
              "description": "采用秩-1更新或缓存以达成O(k·N·d^3)级别，避免重复计算。",
              "score": 25,
              "evaluation_focus": "性能工程",
              "scoring_hint": "高分：有基准或时间统计；中分：部分向量化；低分：三重循环低效。"
            },
            {
              "sub_criteria": "接口与可复现性（输入a_j, σ_j^2, p0, τ/k）",
              "description": "清晰API，固定随机种子（如RANSAC/SDR），返回S、I_S、Cov、度量与日志。",
              "score": 25,
              "evaluation_focus": "工程规范",
              "scoring_hint": "高分：类型检查与错误信息完善；中分：基本可用；低分：参数隐式或返回不完整。"
            },
            {
              "sub_criteria": "权重与NLOS抑制实现",
              "description": "在σ_j^2/权重中接入SINR或NLOS标记，影响选择概率。",
              "score": 20,
              "evaluation_focus": "鲁棒实现",
              "scoring_hint": "高分：可插拔权重策略与单元测试；中分：硬编码因子；低分：未实现加权。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "质量度量报告（GDOP、logdet、trace(Cov)）",
              "description": "对选定S输出并解释GDOP/trace/ logdet数值与物理意义（越小/越大越好）。",
              "score": 30,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：对比未选与全选基线；中分：仅给数值；低分：无度量或解读错误。"
            },
            {
              "sub_criteria": "最小|S|或固定k下近似最优性验证",
              "description": "展示达到τ的最小基站数，或在固定k下与随机/等距基准比较提升百分比。",
              "score": 25,
              "evaluation_focus": "最优性证据",
              "scoring_hint": "高分：给出≥2个基准对比；中分：单一对比；低分：无基准。"
            },
            {
              "sub_criteria": "鲁棒性与多p0泛化",
              "description": "在多个p0或扰动下，S稳定性与度量波动分析（均值/方差）。",
              "score": 25,
              "evaluation_focus": "稳健评估",
              "scoring_hint": "高分：提供方差或箱线统计；中分：定性说明；低分：未评估。"
            },
            {
              "sub_criteria": "失败与边界情形说明",
              "description": "当未达τ或I_S病态时，报告原因、候选替代（放宽k或调整权重）。",
              "score": 20,
              "evaluation_focus": "诊断能力",
              "scoring_hint": "高分：含具体阈值与建议；中分：泛化建议；低分：静默或不一致结论。"
            }
          ]
        }
      }
    },
    "4": {
      "subtask": "子任务 4 的目标是针对运动中的终端，基于随时间采集的 TOA 观测数据和已知基站坐标（并在存在有限覆盖半径 R 的情况下），实现（A）动态位置与时钟状态的估计与平滑（轨迹重建），（B）在每个场景/时间点判定哪些终端“可被定位”，并据此计算并报告该场景的连接度 λ，及（C）建立并验证连接度 λ 与定位精度之间的定量关系。输入为按时间顺序的 TOA 测距观测矩阵（缺失值表示该基站在该时刻不可见或观测无效）、基站三维坐标、物理常数 c 以及通信半径 R（若适用）；输出为每个终端在每个时间点的估计状态序列（位置、可选速度）、对应的不确定度（协方差或置信区间）、被判定为“可定位”的终端集合、场景级连接度 λ 值以及 λ 与定位误差关系的数值化描述与拟合模型。方法上，先对观测做预处理（TOA→等效距离、按 R 掩码移除超出覆盖的观测、缺失值处理），然后采用基于状态空间的时序估计：建立离散时间非线性状态方程 x_{k+1}=F x_k+q_k（状态可包含位置 p_k、速度 v_k、时钟偏置 b_k 及其漂移 ḃ_k），测量方程为 r̂_{k,j}=||p_k−a_j||+b_k+η_{k,j}（可扩展加入每链路的非负 NLOS 偏置 s_{k,j}），并根据噪声/非线性特性选择滤波器——在近高斯噪声与中等非线性下使用扩展卡尔曼滤波（EKF）或无迹卡尔曼滤波（UKF）以实现实时递推，在强非高斯或高 NLOS 比例时采用粒子滤波（PF）或滑动窗口的批量非线性最小二乘（LM）/因子图优化并配合后端 Rauch–Tung–Striebel 平滑以提高全轨迹精度。为处理 NLOS 与异常观测，算法应支持：残差驱动的在线异常检测与自适应观测加权（Huber/IRLS）、基于稀疏正则化的偏置估计（在每个时刻或滑窗内交替估计非负偏置 s 并用 L1 促稀疏）以及必要时的 RANSAC 式内点识别；缺失观测与基站可见性随时间变化由滤波器动态接纳/忽略观测项，观测协方差应随 SINR/RSS 等侧信息自适应调整（若无侧信息则用经验或预估 σ）。关于“可被定位”的判定规则，明确采用两层标准：数量门槛（例如三维未知时钟需至少 4 个非共面可见基站，否则判为不可定位）和几何/信息充分性判定（在当前观测集合下计算 Fisher 信息矩阵 I_S，并检验其秩/条件数与预定阈值以确保可逆与数值稳定），仅对满足两者的终端计入“可定位”集合；连接度 λ 按题目定义计算为（所有可定位终端到基站间的连接数）/（终端总数），连接数统计使用掩码后的可见基站计数。为了把 λ 与定位精度联系起来，提出两步法：理论近似通过在估计点处构造 FIM 并用 CRB（Cov≈I^{-1}）导出在相同噪声水准下，平均协方差随观测数量与几何分布变化的定性关系；工程实证通过大规模蒙特卡洛仿真或对给定场景的多次随机化实验，在不同 λ 下计算均方根误差（RMSE）并拟合经验模型（例如幂律或加偏置模型 RMSE≈α λ^{-β}+γ），同时识别 λ 的临界值（低于该值大多数终端不可定位或误差急剧上升）和冗余饱和点（λ 增加带来边际收益显著下降）。实现细节与参数建议包括：状态/观测方程的雅可比矩阵用于 EKF，滑动窗口长度与粒子数应在精度与计算量之间权衡（例如窗口长度数十个时刻、PF 粒子数视复杂度从数百到数千），Huber 阈值与 L1 正则强度可通过交叉验证或初步仿真设定，数值求解可使用 Python + numpy/scipy、filterpy/pykalman（滤波）、pyro/pyro4 或自写 PF、scipy.optimize.least_squares（批量优化）、cvxpy/OSQP（带正则的凸子问题）；输出应包含时间序列估计、每时刻的协方差、“可定位”布尔标志、场景 λ 值及 RMSE-vs-λ 的曲线和拟合参数，以便对部署决策和实时定位可用性作出量化评估。",
      "criteria": {
        "task_understanding": {
          "core_goal": "基于随时间的TOA测距观测与基站坐标，在有限覆盖半径R条件下对运动终端进行动态轨迹估计与平滑、可定位判定并拟合评估连接度λ与定位精度的关系",
          "expected_output": "时间序列状态估计p_k(含可选v_k,b_k,ḃ_k)与协方差、每时刻可定位布尔标记、场景连接度λ数值、RMSE-vs-λ曲线与拟合模型参数（如α,β,γ）、诊断报表与必要图表",
          "key_inputs_constraints": "输入：按时间顺序的TOA矩阵(含缺失)、基站坐标a_j、常数c、覆盖半径R；约束：TOA需先转距离r̂=c·TOA并按R掩码；可定位判定需满足数量门槛(三维未知时钟≥4)与FIM秩/条件数阈值；状态空间模型x_{k+1}=F x_k+q_k，测量r̂_{k,j}=||p_k−a_j||+b_k+η_{k,j}（可含非负NLOS偏置s_{k,j}）；噪声方差σ或权重需给定或可估；场景可能为二维或三维",
          "modeling_type": "预测+拟合+评价",
          "role_in_pipeline": "作为动态定位与可用性评估环节：前序依赖子任务1的数据预处理与噪声/掩码、子任务2的静态求解与NLOS鲁棒策略、子任务3的基站子集选择；后序为应用部署与性能报告/可视化"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "动态轨迹估计与平滑（EKF/UKF/PF）",
              "description": "是否明确本任务为随时间的状态估计而非单次静态定位，需在TOA→r̂预处理后用状态空间方法对p_k（可含v_k,b_k）进行递推与平滑。",
              "score": 40,
              "evaluation_focus": "问题界定",
              "scoring_hint": "高分：清晰指出EKF/UKF/PF或滑窗LM并区分滤波与平滑；中分：仅描述卡尔曼滤波未涉及非线性或时钟；低分：仍停留在单时刻最小二乘"
            },
            {
              "sub_criteria": "可定位判定与连接度λ计算",
              "description": "是否识别两层判定：基站数量门槛（≥4含偏置）与信息充分性（FIM秩/条件数），并据掩码统计连接数以计算λ。",
              "score": 30,
              "evaluation_focus": "要求把握",
              "scoring_hint": "高分：同时给出数量门槛+FIM阈值并定义λ统计口径；中分：仅用数量门槛；低分：未定义可定位或误算λ"
            },
            {
              "sub_criteria": "λ与定位精度关系评估",
              "description": "是否将λ与RMSE或协方差trace/GDOP建立定量关系，并提出理论CRB与经验拟合并用。",
              "score": 30,
              "evaluation_focus": "评价目标",
              "scoring_hint": "高分：提出CRB近似+经验拟合（如RMSE≈αλ^{-β}+γ）；中分：仅口头说明正相关；低分：未建立任何关系"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "TOA→等效距离r̂与R掩码",
              "description": "是否复述并固定使用r̂=c·TOA及R半径过滤生成时间变Mask，处理缺失与无效观测。",
              "score": 35,
              "evaluation_focus": "规范复述",
              "scoring_hint": "高分：包含单位、NaN处理、覆盖外排除；中分：仅提转换未提掩码；低分：忽略转换或R"
            },
            {
              "sub_criteria": "状态与观测方程完整性",
              "description": "是否准确描述x_k=[p_k,(v_k),b_k,(ḃ_k)]与r̂_{k,j}=||p_k−a_j||+b_k+η_{k,j}(可含s_{k,j}≥0)及维度（2D/3D）。",
              "score": 35,
              "evaluation_focus": "模型表达",
              "scoring_hint": "高分：给出变量、噪声与可选NLOS偏置；中分：缺失时钟或速度；低分：方程不匹配TOA"
            },
            {
              "sub_criteria": "可定位标准细化",
              "description": "是否明确三维未知时钟≥4、二维≥3，并提出FIM条件数或最小特征值阈值。",
              "score": 30,
              "evaluation_focus": "规则明确",
              "scoring_hint": "高分：数量+信息两标准并给阈值建议；中分：仅数量；低分：无标准"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "噪声与NLOS假设（σ与s_{k,j}≥0）",
              "description": "是否假设测量噪声近高斯（给σ或权重）并对NLOS为非负偏置并稀疏，提供上界（如120 m）。",
              "score": 35,
              "evaluation_focus": "建模假设",
              "scoring_hint": "高分：σ设定+非负偏置上界与稀疏性；中分：仅高斯噪声；低分：无噪声设定"
            },
            {
              "sub_criteria": "动力学与时钟模型假设",
              "description": "是否给出常速度/白噪声加速度模型与时钟偏置/漂移随机游走，并阐明Q过程噪声。",
              "score": 35,
              "evaluation_focus": "物理先验",
              "scoring_hint": "高分：明确F,Q结构与量级；中分：仅常速度无Q；低分：无动力学"
            },
            {
              "sub_criteria": "可定位阈值与FIM阈设",
              "description": "是否假设并给出条件数或λ_min阈值范围，解释其对稳定性的意义。",
              "score": 30,
              "evaluation_focus": "阈值设定",
              "scoring_hint": "高分：提供可执行阈值（如cond≤1e6或λ_min≥ε）；中分：笼统提条件数；低分：无阈值"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "状态空间模型与雅可比/UT",
              "description": "是否构建离散模型x_{k+1}=Fx_k+q_k、r̂= h(x_k)+η并给出EKF雅可比或UKF sigma点设计。",
              "score": 30,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：完整h(x)雅可比或UT细节；中分：仅口头描述；低分：未给非线性处理"
            },
            {
              "sub_criteria": "NLOS鲁棒测量模型",
              "description": "是否在观测损失中引入Huber/Tukey或L1非负偏置s并说明约束与正则。",
              "score": 30,
              "evaluation_focus": "鲁棒建模",
              "scoring_hint": "高分：清楚给ρ与λ_reg或s上界；中分：只提鲁棒；低分：未处理NLOS"
            },
            {
              "sub_criteria": "FIM/CRB与λ的理论联系",
              "description": "是否在p_k处构造I_S=Σ(1/σ_j^2)g_j g_j^T并以Cov≈I^{-1}解释λ增加降低RMSE。",
              "score": 40,
              "evaluation_focus": "理论分析",
              "scoring_hint": "高分：推导指标（trace/Det）与几何影响；中分：粗略描述；低分：无理论联系"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "滤波与平滑实现细节（EKF/UKF/PF/RTS）",
              "description": "是否给出预测-更新方程、数值稳定措施（正定修正/正则）与RTS平滑步骤。",
              "score": 35,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：公式与数值细节齐全；中分：仅流程；低分：不成体系"
            },
            {
              "sub_criteria": "在线异常检测与权重自适应",
              "description": "是否基于残差/规范化残差进行Huber/IRLS或门限剔除并动态调整R_k。",
              "score": 30,
              "evaluation_focus": "鲁棒求解",
              "scoring_hint": "高分：给阈值如1.3–1.5σ；中分：笼统说降低权重；低分：未处理异常"
            },
            {
              "sub_criteria": "可定位判定与λ计算的求解流程",
              "description": "是否实现每时刻集合S_k的秩/条件数检查并统计连接数，最终计算场景λ。",
              "score": 35,
              "evaluation_focus": "流程严谨",
              "scoring_hint": "高分：明确rank与cond阈值和计数口径；中分：仅计数未验秩；低分：未计算λ"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "数据预处理与掩码流水线",
              "description": "实现TOA→r̂，按R掩码、NaN处理、时间步可见基站索引生成，保证与维度标识一致。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：模块化、单测或可视化检查；中分：能跑但脆弱；低分：遗漏NaN或R过滤"
            },
            {
              "sub_criteria": "滤波/平滑模块与数值稳定",
              "description": "EKF/UKF/PF与RTS实现，包含雅可比/UT、协方差对称化与Cholesky失败回退。",
              "score": 35,
              "evaluation_focus": "工程实现",
              "scoring_hint": "高分：稳健数值与异常处理；中分：基本实现；低分：易发散无保护"
            },
            {
              "sub_criteria": "FIM与λ计算及RMSE-vs-λ拟合",
              "description": "实现g_j与I_S计算、rank/cond评估、λ统计、RMSE计算与曲线拟合(α,β,γ)。",
              "score": 35,
              "evaluation_focus": "量化评估",
              "scoring_hint": "高分：拟合与置信度/残差报告；中分：仅拟合参数；低分：未实现拟合或错误统计"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "轨迹与不确定度可视化",
              "description": "展示p_k轨迹、协方差或置信椭球，标注可定位与不可定位时段。",
              "score": 30,
              "evaluation_focus": "结果呈现",
              "scoring_hint": "高分：轨迹+误差带清晰；中分：仅轨迹；低分：无可视化"
            },
            {
              "sub_criteria": "λ与RMSE关系验证与阈点识别",
              "description": "报告RMSE-vs-λ曲线、拟合优度(R^2)与临界/饱和点分析。",
              "score": 40,
              "evaluation_focus": "实证验证",
              "scoring_hint": "高分：R^2≥0.7且识别阈点；中分：仅给趋势；低分：无量化验证"
            },
            {
              "sub_criteria": "鲁棒性与失败案例诊断",
              "description": "分析NLOS比例升高、观测缺失、低GDOP情况下的性能变化与失败原因。",
              "score": 30,
              "evaluation_focus": "误差剖析",
              "scoring_hint": "高分：提供残差分布/内点率；中分：定性说明；低分：无诊断"
            }
          ]
        }
      }
    }
  }
}