{
  "task_id": "2015_D",
  "problem": "请研究以下问题：\n\n单列车节能运行优化控制问题\n\n(1) 请建立计算速度距离曲线的数学模型，计算寻找一条列车从 \\(A_6\\) 站出发到达 \\(A_7\\) 站的最节能运行的速度距离曲线，其中两车站间的运行时间为 110 秒，列车参数和线路参数详见文件“列车参数.xlsx”和“线路参数.xlsx”。\n\n(2) 请建立新的计算速度距离曲线的数学模型，计算寻找一条列车从 \\(A_6\\) 站出发到达 \\(A_8\\) 站的最节能运行的速度距离曲线，其中要求列车在 \\(A_7\\) 车站停站 45 秒，\\(A_6\\) 站和 \\(A_8\\) 站间总运行时间规定为 220 秒（不包括停站时间），列车参数和线路参数详见文件“列车参数.xlsx”和“线路参数.xlsx”。\n\n注：请将本问（1）和（2）得到的曲线数据按每秒钟一行填写到文件“数据格式.xlsx”中红色表头那几列，并将该文件和论文一并提交。（请只填写和修改数据，一定不要修改文件“数据格式.xlsx”的格式。其中计算公里标（m）是到起点的距离，计算距离（m）是到刚通过的一站的距离）\n\n\\textbf{二、多列车节能运行优化控制问题}\n\n(1) 当 100 列列车以间隔 \\(H = \\{h_1, \\ldots, h_{99}\\}\\) 从 \\(A_1\\) 站出发，追踪运行，依次经过 \\(A_2\\)，\\(A_3\\)，……到达 \\(A_{14}\\) 站，中间在各个车站停站最少 \\(D_{\\text{min}}\\) 秒，最多 \\(D_{\\text{max}}\\) 秒。间隔 \\(H\\) 各分量的变化范围是 \\(H_{\\text{min}}\\) 秒至 \\(H_{\\text{max}}\\) 秒。请建立优化模型并寻找使所有列车运行总能耗最低的间隔 \\(H\\)。要求第一列列车发车时间和最后一列列车的发车时间之间间隔为 \\(T_0 = 63900\\) 秒，且从 \\(A_1\\) 站到 \\(A_{14}\\) 站的总运行时间不变，均为 2086s（包括停站时间）。假设所有列车处于同一供电区段，各个车站间线路参数详见文件“列车参数.xlsx”和“线路参数.xlsx”。\n\n补充说明：列车追踪运行时，为保证安全，跟踪列车（后车）速度不能超过限制速度 \\(V_{\\text{limit}}\\)，以免后车无法及时制动停车，发生追尾事故。其计算方式可简化如下：\n\\[\nV_{\\text{limit}} = \\min(V_{\\text{line}}, \\sqrt{2LB_e})\n\\]\n其中 \\(V_{\\text{line}}\\) 是列车当前位置的线路限速（km/h），\\(L\\) 是当前时刻前后车之间的距离。\\begin{enumerate}\n    \\item[(2)] 接上问，如果高峰时间（早高峰 7200 秒至 12600 秒，晚高峰 43200 至 50400 秒）发车间隔不大于 2.5 分钟且不小于 2 分钟，其余时间发车间隔不小于 5 分钟，每天 240 列。请重新为它们制定运行图和相应的速度距离曲线。\n\\end{enumerate}\n\n三、列车延误后运行优化控制问题\n\n接上问，若列车 $i$ 在车站 $A_j$ 延误 $DT_j^i$（10 秒）发车，请建立控制模型，找出在确保安全的前提下，首先使所有后续列车尽快恢复正点运行，其次恢复期间耗能最少的列车运行曲线。\n\n假设 $DT_j^i$ 为随机变量，普通延误（$0 < DT_j^i < 10s$）概率为 20%，严重延误（$DT_j^i > 10s$）概率为 10%（超过 120s，接近下一班，不考虑调整），无延误（$DT_j^i = 0$）概率为 70%。若允许列车在各站到、发时间与原时间相比提前不超过 10 秒，根据上述统计数据，如何对第二问的控制方案进行调整？",
  "subtask": {
    "1": {
      "subtask": "子任务1（单列车物理建模与能耗最优控制求解）目标是：在给定的线路与列车参数下，为单列车分别求解从 A6 到 A7 （站间运行时间固定为 110 s）以及从 A6 经停 A7（停站 45 s）到 A8（A6→A8 两站间总运行时间（不含停站）为 220 s）的最节能速度—距离曲线，并按每秒一行输出满足“数据格式.xlsx”红色表头的字段；为此需完成以下工作并满足列出的模型、约束与数值实现细节。输入数据：读取“列车参数.xlsx”“线路参数.xlsx”中的列车质量 M、牵引/制动特性曲线 F_max(v), B_max(v)、阻力多项式系数 A,B,C、曲线常数 c（≈600）、各区段坡度 i（‰）、曲线半径 R、分段限速 V_line(x)、站间距离与公里标等；注意单位统一（速度在动力学中以 m/s 计算，题中阻力多项式以 km/h 表示时须换算）。物理与数学假设：单质点模型，动力学由牛顿第二定律描述 M dv/dt = F(t) − B(t) − W(v,x)，dx/dt = v；总阻力按题目给出 W = (w0(v)+w1(x))·g·M/1000，其中 w0(v)=A + B·v_km_h + C·v_km_h^2（实施时将 v 单位统一并换算系数），附加阻力 w1 由坡度 i 与曲线阻力 c/R 计算并按题中折算规则处理；牵引与制动力按 F = μ_F · F_max(v)、B = μ_B · B_max(v)，μ∈[0,1]，且任一时刻不得同时牵引与制动（以 F·B=0 或二元互斥逻辑实现）。能量目标：离散化时最小化网侧净能耗 E_grid = ∑_k [P_trac_k − P_regen_used_k]_+ · Δt，其中牵引瞬时功率 P_trac = F·v，制动阶段产生的再生能量按题目公式在时间离散上累积计算 E_reg = 0.95·(ΔE_mech − E_f)，或在瞬时近似中使用 P_regen_max ≈ η_reg·(B·v − W·v) 的非负部分并按本单列情形的可用性处理（实现中保留题设的 E_reg 计算以便与题目要求一致）；所有能量计算应考虑单位一致性并输出累积网侧能量。边界与路径约束：初末速度在起/到站点为 0，运行位移积分等于站间距离；对 A6→A8 问题在到达 A7 时强制速度为 0 并保持停站 45 s，然后从静止出发继续到达 A8，总行程（除停站）时间等于 220 s；速度在任意时刻被线路限速 V_line(x) 约束并受牵引/制动能力曲线限制；为保证乘客舒适性与数值稳定性，施加加速度/减速度上下限（由车辆规范或牵引/制动力曲线隐含），并可选设最小安全速度/距离约束。数值方法与实现细节：采用直接法时间离散（建议输出步长 dt=1 s 以匹配提交格式；为提高求解质量可在求解时用更细步长如 0.2–0.5 s 内部离散再按 1 s 采样输出），将动力学用显式或隐式欧拉/Runge‑Kutta 或多项式插值离散转为 NLP；决策变量为每时步的 v_k、x_k、F_k、B_k（或 μ_F_k、μ_B_k），并包含互斥约束、F_max(v_k)、B_max(v_k)、速度上界、位置累积与时间窗口约束（包括停站时段的速度=0）；若需精确互斥可采用二元变量转为 MIP，否则采用连续松弛并加大互斥惩罚（推荐以连续方法优先以保持可解性）。求解器与工具建议：使用 CasADi+IPOPT、KNITRO 或其他成熟 NLP 求解器实现直接积分-优化框架，调优初始值（以典型的“牵引→惰行→巡航→制动”分段剖面作为初猜）以帮助收敛；实现时注意变量标度、约束松弛策略与奇异点处理。输出要求与验算：按每秒输出时间戳、速度（km/h 或 m/s，按“数据格式.xlsx”要求）、到起点公里标（m）、到上站的计算距离（m）、控制百分比 μ_F/μ_B 或实际牵引/制动力值、瞬时牵引/制动功率、瞬时再生功率及累积网侧能耗等字段并写入“数据格式.xlsx”对应列；同时留存中间解（状态和控制序列）、单位换算细节和初始参数文件以便复现。数值鲁棒性与验证：在实现中执行单位一致性检查、能量收支监测（总机械能变化与牵引/制动/阻力做功的能量平衡），并用不同初值与更细网格检验解的稳定性；在求解器难以收敛时，采用分段优化（先粗格步长求解再局部精化）或参数扫描法寻找全局可行初解。该子任务仅负责单列车的模型建立、数值实现及两种指定运行情形的最优速度—距离曲线求解与按秒输出，不包括多列耦合、调度优化或实时延误恢复的任何内容。",
      "criteria": {
        "task_understanding": {
          "core_goal": "在已知列车与线路参数下，优化求解单列车从A6→A7（110 s）与A6→A8（含A7停站45 s，总运行220 s不含停站）的最节能速度—距离曲线并按秒输出到数据格式.xlsx",
          "expected_output": "两段最优运行工况的按秒离散数据：时间、速度、公里标、到上站距离、μ_F/μ_B或F/B、瞬时功率、再生功率、累积网侧能耗；伴随可复现实验代码与日志（单位换算与能量收支核对），并写入数据格式.xlsx对应红色表头列",
          "key_inputs_constraints": "输入：M、A/B/C、c、F_max(v)、B_max(v)、坡度i、曲线半径R、分段限速V_line(x)、站间距离与公里标，来自列车参数.xlsx与线路参数.xlsx；约束：v(0)=v(T)=0，A6→A7总时长110 s；A6→A8中v在A7到达为0并停45 s，总运行时长（不含停站）220 s；速度不超V_line(x)与牵引/制动能力曲线；互斥F·B=0；能量计算按E_reg=0.95·(ΔE_mech−E_f)；单位统一（速度m/s用于动力学，阻力公式km/h需换算）",
          "modeling_type": "优化+仿真",
          "role_in_pipeline": "作为单列车物理建模与能耗最优控制的核心子任务：前序依赖数据清洗与参数解析；后序为多车耦合优化与延误恢复提供基线曲线与能耗标定，并产出数据格式.xlsx供统一评测",
          "assumptions": "若附件未给出精确η_reg，仅按题设0.95系数计算再生能量；内部求解可用更细步长（0.2–0.5 s）后按1 s采样输出；互斥以连续惩罚替代二元变量优先保证可解性"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "优化目标与对象：最节能速度—距离曲线",
              "description": "是否明确E_grid最小化而非时间最短；对象为A6→A7（110 s）与A6→A8（经停A7、总运行220 s不含停站）两段曲线",
              "score": 30,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：清楚区分两情形与固定时长/停站约束并写出E_grid定义；中分：只说明能耗最小但未区分两情形或时间口径；低分：将目标误写为时间最短或模糊"
            },
            {
              "sub_criteria": "输入约束识别：V_line(x)、F_max(v)、B_max(v)、单位",
              "description": "是否识别限速、牵引/制动能力曲线与单位换算（km/h↔m/s）为关键硬约束与实现要点",
              "score": 25,
              "evaluation_focus": "约束识别",
              "scoring_hint": "高分：列出并量纲统一；中分：提及但未落实换算或能力曲线；低分：忽略限速或能力曲线"
            },
            {
              "sub_criteria": "物理机制识别：单质点动力学与阻力模型",
              "description": "是否准确识别M dv/dt = F − B − W(v,x)以及W=(w0+w1)·g·M/1000，w0(A,B,C, v_kmh)，w1(i+c/R)",
              "score": 25,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：写出完整形式与折算坡度说明；中分：给出W但缺少w1或系数；低分：未给出动力学或错误公式"
            },
            {
              "sub_criteria": "再生能量与网侧能耗口径",
              "description": "识别E_reg=0.95·(ΔE_mech−E_f)与E_grid累计定义，避免把制动能量当节省网能混算",
              "score": 20,
              "evaluation_focus": "能量口径",
              "scoring_hint": "高分：分清牵引功、阻力功、再生能量使用；中分：有E_reg但未扣抵网能清晰；低分：无再生口径或概念混乱"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "两情形边界与时间窗复述",
              "description": "准确复述A6→A7：T=110 s、v(0)=v(T)=0；A6→A8：A7到达v=0且停45 s，总运行时长220 s（不含停站）",
              "score": 35,
              "evaluation_focus": "需求对齐",
              "scoring_hint": "高分：逐一列清并强调不含停站口径；中分：漏掉一项；低分：混淆时间口径"
            },
            {
              "sub_criteria": "状态与控制量定义复述",
              "description": "明确v_k、x_k、μ_F/μ_B或F/B，互斥F·B=0，速度上界V_line(x)，能力上界F_max、B_max",
              "score": 25,
              "evaluation_focus": "形式化",
              "scoring_hint": "高分：变量与约束成对出现；中分：只列变量或只列约束；低分：未成体系"
            },
            {
              "sub_criteria": "能量目标函数离散表达复述",
              "description": "给出E_grid=Σ[P_trac−P_regen_used]_+·Δt，含P_trac=F·v，E_reg公式在离散中的实现口径",
              "score": 25,
              "evaluation_focus": "目标刻画",
              "scoring_hint": "高分：给出离散式并说明单位；中分：仅文字描述；低分：未说明或错误"
            },
            {
              "sub_criteria": "输出到数据格式.xlsx字段与频率",
              "description": "复述按秒输出字段列表与不改变模板格式要求",
              "score": 15,
              "evaluation_focus": "规范遵循",
              "scoring_hint": "高分：列出必填列并强调仅填数据；中分：只提按秒；低分：未提模板要求"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "单位与阻力换算假设",
              "description": "明确km/h到m/s换算，w0用v_kmh，W量纲一致性检查策略",
              "score": 30,
              "evaluation_focus": "数理严谨",
              "scoring_hint": "高分：给出换算公式与检查步骤；中分：只提需换算；低分：无说明"
            },
            {
              "sub_criteria": "互斥实现假设（连续惩罚或MIP）",
              "description": "说明采用连续松弛+惩罚或二元变量的选择及理由（可解性/效率）",
              "score": 25,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：说明惩罚项或逻辑约束细节；中分：仅口头声明；低分：未处理互斥"
            },
            {
              "sub_criteria": "再生能量使用口径假设",
              "description": "单车情形下E_used处理（可视为全部计入E_reg但不负上网），或严格按题设E_reg累计",
              "score": 25,
              "evaluation_focus": "能量口径",
              "scoring_hint": "高分：阐明单车可用性处理与对E_grid影响；中分：有E_reg无使用口径；低分：忽略再生"
            },
            {
              "sub_criteria": "数值离散与稳定性假设",
              "description": "内部步长0.2–0.5 s、外部1 s采样，选择显式/隐式欧拉或RK并说明误差控制",
              "score": 20,
              "evaluation_focus": "数值分析",
              "scoring_hint": "高分：说明步长与稳定性理由；中分：给出步长无理由；低分：未提离散策略"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "动力学与阻力NLP离散化",
              "description": "构建v,x更新方程，W(v,x)含w0(A,B,C, v_kmh)与w1(i+c/R)并可折算坡度，形成NLP约束",
              "score": 30,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：给出离散式与变量标度；中分：公式不完整；低分：缺失离散化"
            },
            {
              "sub_criteria": "能力与限速约束实现",
              "description": "F≤μ_F·F_max(v), B≤μ_B·B_max(v), 0≤μ≤1, v≤V_line(x)分段实现",
              "score": 25,
              "evaluation_focus": "约束设计",
              "scoring_hint": "高分：说明插值F_max/B_max与分段限速处理；中分：只给不等式无实现细节；低分：遗漏关键上界"
            },
            {
              "sub_criteria": "时间窗与停站约束建模",
              "description": "A6→A7总步数对应110 s；A6→A8含A7节点v=0与连续45 s v=0且总非停站时长=220 s",
              "score": 25,
              "evaluation_focus": "约束实现",
              "scoring_hint": "高分：清晰定义停站区间索引与时长；中分：仅设置v=0漏时长；低分：未实现停站"
            },
            {
              "sub_criteria": "能量目标函数与再生项落地",
              "description": "离散化E_grid与E_reg计算（ΔE_mech与E_f），或瞬时近似并保持题设口径一致",
              "score": 20,
              "evaluation_focus": "目标实现",
              "scoring_hint": "高分：两种口径择一且量纲检查；中分：只给P=Fv累计；低分：无能量模型"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "求解器与初值策略（CasADi+IPOPT等）",
              "description": "说明选用NLP求解器、变量标度、初猜（牵引→惰行→巡航→制动）助收敛",
              "score": 30,
              "evaluation_focus": "算法实现",
              "scoring_hint": "高分：给出初猜结构与标度；中分：只列求解器；低分：未说明或不当选择"
            },
            {
              "sub_criteria": "互斥与非凸性的处理",
              "description": "连续惩罚/大M或分段优化（粗到细网格）以缓解非凸，确保可行解",
              "score": 25,
              "evaluation_focus": "优化技巧",
              "scoring_hint": "高分：描述具体惩罚或分段流程；中分：泛述难收敛；低分：无措施"
            },
            {
              "sub_criteria": "可行性与边界验证",
              "description": "校验v≥0、v(0)=v(T)=0、x终值达站间距离、限速/能力不违背",
              "score": 25,
              "evaluation_focus": "约束核验",
              "scoring_hint": "高分：列出自动校验与断言；中分：人工核对；低分：无验证或违约束"
            },
            {
              "sub_criteria": "数值鲁棒性与网格敏感性",
              "description": "不同初值/更细网格复算，差异在可接受阈内（如能耗差<2%）",
              "score": 20,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：报告敏感性结果与阈值；中分：仅复算无阈值；低分：未检验"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "数据读取与单位一致性检查",
              "description": "从列车参数.xlsx/线路参数.xlsx读取并执行速度、阻力、距离的量纲校验与日志输出",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：自动断言/报错；中分：仅打印提示；低分：无检查"
            },
            {
              "sub_criteria": "NLP构建与F_max/B_max插值实现",
              "description": "平滑插值能力曲线（线性/样条），避免不可导点影响IPOPT",
              "score": 25,
              "evaluation_focus": "工程实现",
              "scoring_hint": "高分：提供可导插值与边界外延；中分：仅查表；低分：硬编码或不连续"
            },
            {
              "sub_criteria": "求解与采样输出到数据格式.xlsx",
              "description": "内部细步长仿真，按1 s采样并严格写入红色表头列，不更改模板格式",
              "score": 25,
              "evaluation_focus": "I/O规范",
              "scoring_hint": "高分：程序化校验列名/类型；中分：能写入但无校验；低分：格式被改动或列缺失"
            },
            {
              "sub_criteria": "能量收支与日志追踪",
              "description": "记录Σ牵引功、阻力功、ΔE_mech、E_reg、E_grid并核对平衡误差<5%",
              "score": 20,
              "evaluation_focus": "数值监控",
              "scoring_hint": "高分：输出误差并达阈；中分：只输出值无阈；低分：无日志或不平衡"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "可行性与约束满足报告",
              "description": "报告限速、能力约束最大违约量（应≤0），边界速度、时间窗与停站满足性",
              "score": 30,
              "evaluation_focus": "结果验证",
              "scoring_hint": "高分：逐项列数值违约≤1e-6；中分：定性说明；低分：未报告或违反"
            },
            {
              "sub_criteria": "能耗与再生能量分解",
              "description": "呈现E_trac、E_reg、E_grid，并解释再生占比与节能来源",
              "score": 25,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：量化占比与关键区段；中分：仅总量；低分：无分解"
            },
            {
              "sub_criteria": "策略形态合理性（牵引→惰行/巡航→制动）",
              "description": "速度—距离曲线与典型节能剖面一致，避免无谓加减速",
              "score": 25,
              "evaluation_focus": "物理合理",
              "scoring_hint": "高分：曲线平滑、加速度在限内；中分：有小幅锯齿；低分：频繁切换与震荡"
            },
            {
              "sub_criteria": "稳健性与网格/初值敏感性结论",
              "description": "展示不同初值/步长能耗差（如<2%），并说明收敛行为",
              "score": 20,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：提供对比表或关键数字；中分：口头声明；低分：未检验"
            }
          ]
        }
      }
    },
    "2": {
      "subtask": "子任务2的目标是构建一个用于评估与优化多列车发车间隔 H 和各站停站时间 D 的分层优化框架（仅限于发车间隔与停站时间的优化与仿真评价，不包含单列最优控制器的推导细节），其输入包括：列车动力学与牵引/制动特性、阻力多项式系数、线路分段限速、坡度与曲线半径、站间距离、运营约束（每列从 A1 到 A14 的总运行时间固定为 2086 s 含停站、单日列车总数与峰谷时段约束）、发车间隔上下界 H_min/H_max、每站停站时间范围 [D_min,D_max]、总发车跨度约束 Σ H_i = T0 等；输出为使全系统网侧总能耗最小的间隔向量 H、停站时间矩阵 D 及每列按秒的速度/位置/功率仿真结果和能耗统计。方法上采用两层架构：第一层（调度/决策层）将 H 与 D 作为连续决策变量，在满足边界与线性等式约束（含 ΣH=T0 与每分量界限、各停时界限）下进行全局或局部优化搜索；第二层（评价/仿真层）为并行化的多列仿真器，用于给定候选 H、D 时构造每列的发车时刻与各站到发时刻，并逐秒（或更细时间步）仿真所有列车的运动与功率交换，仿真器应调用或接口化单列速度剖面生成模块（作为黑盒求解器）为每列生成满足时刻约束、速度限幅与安全追踪约束（包括线路限速 V_line(x)、追踪安全速限 V_limit = min(V_line, sqrt(2·L·B_e))、最小车间距等）的可行速度—位置曲线；在仿真时刻步上计算每列牵引功率和制动再生功率，按瞬时功率匹配原则 P_used(t)=min(P_accel(t),P_regen(t)) 计算网侧即时需量 P_grid(t)，并时间积分得到候选方案的目标值（总网侧能耗）。为求解第一层的非凸高维优化问题，建议采用混合策略：对大尺度搜索使用启发式全局优化算法（遗传算法、粒子群、差分进化、或基于 pygmo 的演化方法）或基于代理的全局搜索（先用低分辨率仿真或训练的代理模型近似能耗以快速筛选候选），对局部精化使用约束连续优化（SQP、IPOPT）或带罚函数的梯度方法；约束处理可用投影/修复（确保 ΣH=T0）或罚函数方式实现。实现细节应包括：读取并校验“列车参数.docx”、“线路参数.xlsx”和初始时刻表模板，时间离散步长输出为 1 s（评价层内部可使用更细步长并于后处理中按 1 s 汇总），并行化策略为对候选 H 并行评估或对列车并行求解单列速度剖面以缩短评价时间；维度降阶选项（可选但建议）包括用簇参数化或段式参数表示 H（如在高峰/非高峰分别均匀分段）以减少搜索维数。评估指标除总能耗外还应计算各列准点率约束违例、最小安全距离违例、各站平均停站时间分布与计算收敛性（目标改进阈值、最大迭代数或时间限制作为终止条件）。推荐工具链为 Python + 并行模块（multiprocessing/mpi4py）、优化库（DEAP/pygmo 或 scipy.optimize + IPOPT/CasADi 用于局部解）、以及用于数值仿真的模块化接口（单列求解器作为可调用服务或函数），并应输出：最终 H 向量与 D 矩阵、每列按秒的速度/位置/牵引与再生功率时间序列、总体与分时段能耗统计、以及优化过程日志（迭代历史、候选评估时间、并行效率）。在实现中需明确容错与约束修复策略（对不满足安全或时刻约束的候选即时弃用或以修复策略调整），并给出计算资源估计与并行化建议以保证在可接受时间内完成全局搜索与精化。",
      "criteria": {
        "task_understanding": {
          "core_goal": "在满足 ΣH=T0、H_min≤H≤H_max 与 D_min≤D≤D_max 及安全追踪与时刻约束下，优化多列列车的发车间隔 H 与各站停站时间 D，使全系统网侧总能耗最小，并通过并行仿真评估。",
          "expected_output": "最优发车间隔向量 H、最优停站时间矩阵 D；每列按秒的速度/位置/牵引功率/再生功率时间序列；总网侧能耗与分时段统计；约束违例与准点率报表；优化日志与收敛曲线。",
          "key_inputs_constraints": "输入：列车动力学与牵引/制动特性、阻力系数A/B/C、曲线常数c、坡度i与曲线半径R、线路分段限速V_line(x)、站间距离、运营约束（每列A1→A14总运行时间2086s含停站、单日列车数与峰谷时段约束）、H_min/H_max、[D_min,D_max]、ΣH=T0=63900s。关键约束：V_limit=min(V_line, sqrt(2·L·B_e)) 安全追踪；各站停站时间界限；总发车跨度ΣH=T0；峰谷时段发车间隔规则；单列速度剖面必须可行且满足时刻表。",
          "modeling_type": "优化+仿真+评价",
          "role_in_pipeline": "作为系统级调度优化层：上承单列车速度剖面生成模块（黑盒求解器），下接运行图与能耗评估与结果输出。前序依赖参数读取与单列求解器接口；后序为方案落地与可视化、以及用于延误恢复的后续任务。",
          "assumptions": "单列车速度剖面生成模块可在给定到发时刻下返回满足限制速度与安全追踪的可行曲线；再生能量即时匹配采用P_used(t)=min(P_accel(t), P_regen(t))；评价层内部可用<1s步长并按1s汇总输出。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "优化目标与对象：网侧总能耗最小化",
              "description": "明确以总网侧能耗为唯一或主目标，而非牵引能耗；对象是多列列车的发车间隔H与停站时间D，不混淆与单列控制μ或F/B。",
              "score": 30,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：清晰写出min E_grid(H,D)并定义P_grid；中分：提到能耗但未区分网侧/牵引；低分：目标偏离或未定义。"
            },
            {
              "sub_criteria": "关键约束识别：ΣH=T0 与区间界限",
              "description": "识别总发车跨度ΣH=T0=63900s、H_min/H_max及[D_min,D_max]硬约束，并区分线性等式与不等式。",
              "score": 25,
              "evaluation_focus": "约束理解",
              "scoring_hint": "高分：罗列并分类等式/不等式；中分：遗漏其一；低分：未提ΣH=T0或界限。"
            },
            {
              "sub_criteria": "安全追踪与限速：V_limit=min(V_line, sqrt(2·L·B_e))",
              "description": "识别并纳入追踪安全速限、线路限速与最小车间距对仿真的约束作用。",
              "score": 25,
              "evaluation_focus": "安全规则",
              "scoring_hint": "高分：明确实现位置与速度耦合限速；中分：仅口头提及；低分：未考虑或错误表达。"
            },
            {
              "sub_criteria": "运营约束：每列总运行时间2086s与峰谷规则",
              "description": "识别每列A1→A14固定总时长（含停站）与高峰/非高峰发车间隔限制并区分硬性与偏好约束。",
              "score": 20,
              "evaluation_focus": "业务约束",
              "scoring_hint": "高分：两类规则均精确表述；中分：只提其中之一；低分：未体现。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "两层架构复述：调度优化层+并行仿真评价层",
              "description": "准确复述第一层优化H、D，第二层基于给定H、D进行逐秒仿真与能耗评价并返回目标值。",
              "score": 35,
              "evaluation_focus": "结构表达",
              "scoring_hint": "高分：清楚的层间接口与数据流；中分：层次模糊；低分：未分层或颠倒。"
            },
            {
              "sub_criteria": "输入输出映射：H,D→发车/到发时刻→速度曲线→P_grid",
              "description": "阐明从决策变量到时刻表、单列曲线、功率匹配和能耗积分的链路。",
              "score": 35,
              "evaluation_focus": "流程化",
              "scoring_hint": "高分：逐步映射且单位一致；中分：缺少某一步；低分：链路不连贯。"
            },
            {
              "sub_criteria": "区分单列黑盒与系统优化变量",
              "description": "复述中明确单列速度剖面生成是黑盒，优化变量仅为H与D。",
              "score": 30,
              "evaluation_focus": "边界定义",
              "scoring_hint": "高分：清楚边界；中分：偶有混淆；低分：把μ或F/B当优化变量。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "功率匹配假设：P_used(t)=min(P_accel, P_regen)",
              "description": "给出网侧即时需量计算与再生能量利用原则，说明未利用再生的处理方式。",
              "score": 30,
              "evaluation_focus": "能量机理",
              "scoring_hint": "高分：阐明未匹配部分计为回馈或浪费；中分：仅给公式；低分：无匹配假设。"
            },
            {
              "sub_criteria": "单列黑盒可行性假设与时间步长",
              "description": "假设单列模块在给定到发时刻返回可行曲线；明确内部步长<1s与1s汇总输出。",
              "score": 25,
              "evaluation_focus": "可行性",
              "scoring_hint": "高分：含步长与汇总细节；中分：只提可行；低分：无说明。"
            },
            {
              "sub_criteria": "追踪安全参数与V_limit实现假设",
              "description": "对B_e、最小车间距L的取值或来源做出合理假设并说明限速裁剪策略。",
              "score": 20,
              "evaluation_focus": "安全假设",
              "scoring_hint": "高分：数值或获取方式明确；中分：仅口述；低分：缺失导致不可仿真。"
            },
            {
              "sub_criteria": "峰谷分段参数化/维度降阶假设",
              "description": "说明将H按高峰/非高峰段均匀参数化以降维的假设与适用性。",
              "score": 25,
              "evaluation_focus": "建模取舍",
              "scoring_hint": "高分：给出段数与约束投影；中分：泛述降维；低分：未考虑。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "优化模型形式：min E_grid(H,D) with ΣH=T0 等约束",
              "description": "完整写出目标、决策变量、线性等式/不等式与峰谷时段逻辑约束（可用惩罚或投影）。",
              "score": 35,
              "evaluation_focus": "数模表达",
              "scoring_hint": "高分：数学表述清晰；中分：缺少部分约束；低分：非形式化。"
            },
            {
              "sub_criteria": "安全追踪约束嵌入仿真器：V≤V_limit",
              "description": "在评价层位置-速度更新中强制V≤min(V_line, sqrt(2·L·B_e))并记录违例。",
              "score": 25,
              "evaluation_focus": "约束实现",
              "scoring_hint": "高分：含违例计分或修复；中分：只裁剪；低分：未实现。"
            },
            {
              "sub_criteria": "能量计算与单位一致性",
              "description": "P_trac、P_regen、P_used与P_grid时间积分方法明确，单位严格统一（W、s、J/Wh）。",
              "score": 25,
              "evaluation_focus": "量纲控制",
              "scoring_hint": "高分：说明J↔kWh换算；中分：未给换算；低分：单位混乱。"
            },
            {
              "sub_criteria": "并行化与代理/降阶设计在模型中的位置",
              "description": "说明并行评价或代理模型在外层搜索与内层精化的调用策略。",
              "score": 15,
              "evaluation_focus": "架构设计",
              "scoring_hint": "高分：清楚何时用代理与何时精化；中分：泛述并行；低分：无设计。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "全局搜索策略（遗传/粒子群/差分进化或pygmo）",
              "description": "给出候选规模、代数、变异/交叉参数或停止准则，并适配高维H,D。",
              "score": 30,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：参数化且可复现；中分：仅给算法名；低分：无策略。"
            },
            {
              "sub_criteria": "局部精化（SQP/IPOPT）与约束处理（投影/罚函数）",
              "description": "描述从全局解启动的连续优化细化，并采用投影确保ΣH=T0与界限可行。",
              "score": 30,
              "evaluation_focus": "数值优化",
              "scoring_hint": "高分：含可行化步骤；中分：只提精化；低分：无可行策略。"
            },
            {
              "sub_criteria": "并行仿真与缓存复用",
              "description": "并列评估候选或列车级并行，并对重复H段或单列曲线做缓存以降时耗。",
              "score": 20,
              "evaluation_focus": "性能工程",
              "scoring_hint": "高分：度量加速比或命中率；中分：只并行不缓存；低分：串行。"
            },
            {
              "sub_criteria": "容错与修复：违例候选处理",
              "description": "对不满足安全或时刻约束的候选，给出惩罚函数或可行修复（裁剪/重分配）。",
              "score": 20,
              "evaluation_focus": "鲁棒性",
              "scoring_hint": "高分：可行修复并记录；中分：仅惩罚；低分：直接崩溃或忽略。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "数据读取与校验（列车参数.xlsx/线路参数.xlsx）",
              "description": "实现参数解析、单位检查、边界值校验与缺失值处理，失败即报错退出。",
              "score": 25,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：含单元测试或断言；中分：仅读取；低分：读错或无校验。"
            },
            {
              "sub_criteria": "仿真器接口与单列黑盒调用",
              "description": "提供统一接口：输入到发时刻与限速，输出按秒速度/位置/功率；异常处理完备。",
              "score": 25,
              "evaluation_focus": "接口设计",
              "scoring_hint": "高分：文档与类型签名清晰；中分：能用但耦合高；低分：无法复用。"
            },
            {
              "sub_criteria": "并行与资源管理（multiprocessing/mpi4py）",
              "description": "实现候选或列车级并行、随机种子控制与超时/重试，避免死锁与内存泄漏。",
              "score": 25,
              "evaluation_focus": "工程实现",
              "scoring_hint": "高分：给出CPU占用与速度提升；中分：简单并行；低分：并行不稳定。"
            },
            {
              "sub_criteria": "优化器集成与日志记录",
              "description": "集成DEAP/pygmo或scipy+IPOPT，输出迭代历史、目标改进、约束违例统计与时间花费。",
              "score": 25,
              "evaluation_focus": "可追溯性",
              "scoring_hint": "高分：结构化日志与检查点；中分：简略打印；低分：无日志。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "能耗对比与分时段统计（高峰/非高峰）",
              "description": "报告总网侧能耗、峰谷分段能耗与P_grid(t)曲线，解释再生利用率变化。",
              "score": 30,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：含量化百分比改进；中分：仅总量；低分：无对比。"
            },
            {
              "sub_criteria": "约束满足与违例审计",
              "description": "给出ΣH=T0、H/D界限、V_limit与最小车间距违例次数/持续时间并为0或可接受范围。",
              "score": 25,
              "evaluation_focus": "合规性",
              "scoring_hint": "高分：全部满足或有合理修复；中分：少量违例；低分：大量未满足。"
            },
            {
              "sub_criteria": "敏感性与鲁棒性（H_min/H_max、D范围、代理误差）",
              "description": "对关键参数做敏感性分析或不同初值/网格测试，报告解稳定性。",
              "score": 25,
              "evaluation_focus": "稳健评估",
              "scoring_hint": "高分：多情景一致；中分：有限测试；低分：无分析。"
            },
            {
              "sub_criteria": "收敛与效率评估",
              "description": "报告迭代次数、评估样本数、并行效率、时间预算内达到停止准则的情况。",
              "score": 20,
              "evaluation_focus": "效率分析",
              "scoring_hint": "高分：量化速度与终止条件；中分：粗略描述；低分：无报告。"
            }
          ]
        }
      }
    },
    "3": {
      "subtask": "子任务3（列车延误后运行优化控制）应作为一个独立的实时滚动优化模块，其目标是在保证行车安全与乘客舒适性的前提下：第一优先尽快恢复所有受影响列车的准点运行（最小化后续列车的累计/最大延误或恢复到原计划的时间窗内），第二优先在满足第一目标的可行域内最小化恢复期间的网侧能耗。该模块输入需包括：发生延误的列车标识与延误量 DT_j^i（事件时刻）、当前全网与局部列车状态（每列当前位置、速度、既定到发时刻與剩余停站）、列车动力学与牵引/制动特性（F_max(v), B_max(v)、质量 M）、线路参数（分段限速、坡度、曲线半径、站间距离）、安全参数（最小车间距 L_min、制动能级 B_e）、停站时间上下界 [D_min,D_max] 及允许的提前上限（每站至多提前 10s），并需获取延误概率分布以用于随机化处理（参考：无延误70%、普通延误20%、严重延误10%）。方法上采用事件触发的滚动时域模型预测控制（MPC）框架：以延误发生时刻为起点，构建一个覆盖“受影响列车集” 的有限时间/位置窗（建议包含延误列及其前后 K 列，K 可配置，典型取 5–10）和一个有限优化时域（例如直到这些列在若干后续站恢复或固定时间窗口内），在该窗内同时优化决策变量：每列的逐秒加速度/牵引/制动剖面（或直接牵引/制动百分比 μ），以及允许的站内到发时间微调（提前 ≤10s、压缩停站到 D_min 或在[D_min,D_max]内调整），并可包含离散决策（是否提前发车、是否压缩停站）如需则用混合整数变量建模。约束包括：动力学与位移方程、牵引/制动力受速度相关上界、速度不得超出线路限速与追踪安全限速（例如 v ≤ min(V_line, sqrt(2·L·B_e)）)、最小车间距/防撞约束、乘客舒适性加速度/减速度上下限、停站到发时间与提前不超10s限制、不可同时牵引与制动等；若严重延误（如 DT>120s 或无法在可接受窗内恢复）应触发人工调度或保守策略。为处理随机性与鲁棒性，提供两种可选做法：场景化样本平均近似（SAA）——基于延误分布生成 N 个场景（建议 50–200），在每个场景下评估并最小化期望的分层目标或 CVaR；或机会约束/鲁棒优化——对关键安全/准点性约束施加概率保证（例如保证 95% 情形下恢复到位）。数值求解策略建议采用时间离散化后求解非线性规划（NLP），优选工具链为 CasADi+IPOPT（连续变量）或在包含较多离散决策时使用混合整数求解器（如 Gurobi/CPLEX）；为满足实时性应采取局部化（仅优化受影响列与相邻列）、短时滚动窗、热启动/上次解作为初值、并行化場景计算與解算、以及必要时用近似凸化或快速启发式（优先压缩停站、然后加速/惰行调整）作为回退策略，目标是保证单次重规划在可接受的响应时间（例如 ≤30 s，具体依运营要求设定）。模块输出为：修正后的逐秒速度—位置曲线、调整后的到发时刻与停站时间、逐秒牵引/制动与估计再生/网侧能耗、恢复准点性的概率/期望指标以及可执行性/安全性标志；若优化不可行则返回可行的保守修正策略并标注需人工介入。为便于部署，应实现可配置的参数集（K、滚动窗长度、场景数、优先级权重）、解的可复现记录（初值、求解器日志）和快速诊断接口，以便在运营系统中与列车监控/调度系统对接并支持逐次滚动重规划。",
      "criteria": {
        "task_understanding": {
          "core_goal": "在延误事件触发后采用滚动MPC优化受影响列车集的到发时间与牵引/制动控制，使延误最小化优先、在可行域内次优最小化网侧能耗，并满足安全与限速等约束。",
          "expected_output": "逐秒速度—位置—功率曲线（受影响列车集）、调整后的各站到发时刻与停站时间、恢复准点性的期望/概率指标（如最大/累计延误、95%恢复率）、网侧能耗统计、可行性/安全性标志与求解日志。",
          "key_inputs_constraints": "输入：延误列车 i、站点 A_j、延误量 DT_j^i；当前各列位置/速度/剩余停站与计划时刻表；车辆参数 M、F_max(v)、B_max(v)、B_e；线路参数：分段限速 V_line(x)、坡度 i、曲线半径 R、站间距离；安全参数 L_min；停站时间范围 [D_min,D_max] 与每站可提前≤10s；延误分布（70%无、20%普通、10%严重）。约束：动力学 M dv/dt=F−B−W，dx/dt=v；v≤min(V_line, sqrt(2·L·B_e))；牵引/制动力上界与互斥；加/减速度舒适约束；站停不短于 D_min 且不长于 D_max；严重延误>120s触发保守策略；滚动窗仅覆盖延误列及前后K列。",
          "modeling_type": "优化+仿真",
          "role_in_pipeline": "作为运营期的实时滚动控制模块：上承子任务2的时刻表与单列剖面生成器，接收实时监测的延误与列车状态；下游输出修正后的时刻与控制指令供执行与能耗计量，并为后续滚动周期热启动。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "延误恢复优先级与目标层次（延误最小化→能耗最小化）",
              "description": "是否明确两级目标：首先最小化累计/最大延误或恢复到原计划时间窗，其次在该可行域内最小化网侧能耗。",
              "score": 40,
              "evaluation_focus": "目标分层",
              "scoring_hint": "高分：清晰两级目标并给出量化指标（如max延误、L1/L∞）；中分：提到两目标但未量化或未分层；低分：混合为单目标或忽略能耗/延误一项。"
            },
            {
              "sub_criteria": "滚动MPC与事件触发窗口（K列与时域）",
              "description": "是否识别为事件触发的滚动MPC问题，限定受影响列车集（含前后K列）与有限优化时窗。",
              "score": 30,
              "evaluation_focus": "范式选择",
              "scoring_hint": "高分：给出K取值范围与时窗长度依据；中分：仅笼统提MPC/滚动；低分：无滚动/全网全时优化导致不可实时。"
            },
            {
              "sub_criteria": "安全与运营硬约束识别",
              "description": "是否完整识别v≤min(V_line, sqrt(2·L·B_e))、L_min、互斥牵引/制动、停站[ D_min,D_max ]与提前≤10s等关键约束。",
              "score": 30,
              "evaluation_focus": "约束完备",
              "scoring_hint": "高分：逐条列出并解释来源；中分：遗漏1–2项次要约束；低分：缺失关键安全或时刻约束。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "输入输出边界复述（DT_j^i、状态、输出序列）",
              "description": "是否准确重述输入（延误量、状态、参数）与输出（速度位置功率序列、时刻调整、能耗与恢复指标）。",
              "score": 35,
              "evaluation_focus": "需求对齐",
              "scoring_hint": "高分：逐秒输出与概率指标齐全；中分：缺少一种指标；低分：输出笼统或不匹配。"
            },
            {
              "sub_criteria": "单位与变量层级（秒级、站级、列级）",
              "description": "是否区分秒级控制与站级时刻调整、列级窗口选择与全网接口。",
              "score": 30,
              "evaluation_focus": "层级清晰",
              "scoring_hint": "高分：清晰分层并定义接口；中分：提到多层但边界模糊；低分：混为一谈。"
            },
            {
              "sub_criteria": "随机性处理范围（SAA/机会约束）",
              "description": "是否复述需利用延误概率分布并选择SAA或机会约束的处理框架。",
              "score": 35,
              "evaluation_focus": "不确定性",
              "scoring_hint": "高分：指明样本数或置信水平；中分：仅口头提到随机；低分：忽略随机性。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "受影响列车集与滚动窗假设（K、窗长）",
              "description": "为实时性设定K（5–10）与窗长（时间或站数），并说明对可行性与最优性的影响。",
              "score": 30,
              "evaluation_focus": "可实现性",
              "scoring_hint": "高分：给出K与窗长及依据；中分：仅给区间无理由；低分：未设或全网。"
            },
            {
              "sub_criteria": "能耗模型近似与效率假设（η_reg与功率匹配）",
              "description": "说明P_trac=F·v、再生能量计算（95%机械能变换或瞬时近似）及网侧匹配规则。",
              "score": 30,
              "evaluation_focus": "物理一致",
              "scoring_hint": "高分：单位一致与非负截断说明；中分：给公式缺单位校验；低分：能量收支不闭合。"
            },
            {
              "sub_criteria": "提前发车与停站调整假设",
              "description": "明确每站最多提前10s、停站可在[ D_min,D_max ]内调整与压缩到D_min的策略界定。",
              "score": 20,
              "evaluation_focus": "运营规则",
              "scoring_hint": "高分：细化到站/发分别限制；中分：只给总提前；低分：未提提前/停站界。"
            },
            {
              "sub_criteria": "严重延误处置与回退策略",
              "description": "对DT>120s或不可行时触发保守策略或人工调度的假设。",
              "score": 20,
              "evaluation_focus": "鲁棒性",
              "scoring_hint": "高分：定义触发阈值与保守控制；中分：仅提人工介入；低分：无回退。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "滚动MPC优化变量与状态（μ、到发时刻、停站）",
              "description": "定义逐秒牵引/制动百分比μ、速度/位置状态、站内到发时间调节与离散决策（如需）。",
              "score": 25,
              "evaluation_focus": "变量设计",
              "scoring_hint": "高分：连续+可选MIP变量清晰；中分：变量不全；低分：仅给速度无控制量。"
            },
            {
              "sub_criteria": "动力学与安全约束形式化",
              "description": "给出M dv/dt=F−B−W、v≤min(V_line, sqrt(2·L·B_e))、L≥L_min、F·B=0或互斥逻辑、加减速度界。",
              "score": 30,
              "evaluation_focus": "约束建模",
              "scoring_hint": "高分：含数值可微替代或惩罚设计；中分：缺一类约束；低分：缺安全或互斥。"
            },
            {
              "sub_criteria": "分层目标函数与加权/词典序实现",
              "description": "采用词典序（先可行且最小延误，再能耗）或大M加权，避免能耗与延误冲突。",
              "score": 25,
              "evaluation_focus": "目标设计",
              "scoring_hint": "高分：实现词典序或严格权重；中分：简单加权未论证；低分：目标冲突未处理。"
            },
            {
              "sub_criteria": "随机性处理建模（SAA/机会约束/CVaR）",
              "description": "为延误不确定性建模：样本平均、机会约束或CVaR并说明关键约束的概率保证。",
              "score": 20,
              "evaluation_focus": "鲁棒建模",
              "scoring_hint": "高分：给N或置信度；中分：仅口述；低分：无。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "求解器与问题类型匹配（IPOPT/MIP）",
              "description": "连续NLP用CasADi+IPOPT；含离散决策时说明Gurobi/CPLEX与分支策略或松弛。",
              "score": 25,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：清楚工具与可微性；中分：泛指优化器；低分：与问题不匹配。"
            },
            {
              "sub_criteria": "实时性策略（热启动、短窗、并行场景）",
              "description": "描述热启动（上次解）、K与窗长控制、SAA并行、≤30s内完成的工程手段。",
              "score": 35,
              "evaluation_focus": "工程实现",
              "scoring_hint": "高分：量化时限与并行粒度；中分：仅列举技巧；低分：无实时考虑。"
            },
            {
              "sub_criteria": "数值稳定与尺度化",
              "description": "变量标度、约束松弛、互斥用惩罚/补充变量处理，避免不可微点。",
              "score": 20,
              "evaluation_focus": "数值稳健",
              "scoring_hint": "高分：具体尺度和惩罚参数；中分：原则性说明；低分：未提。"
            },
            {
              "sub_criteria": "可行性与回退求解流程",
              "description": "不可行时的分级回退（压缩停站→限速放宽不可行度→保守运行/人工）。",
              "score": 20,
              "evaluation_focus": "容错策略",
              "scoring_hint": "高分：清晰层级与触发条件；中分：只说保守；低分：无回退。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "接口与数据结构（事件输入、窗口内列车状态）",
              "description": "定义延误事件API、受影响列集合、状态与参数打包，秒级时间栈结构。",
              "score": 25,
              "evaluation_focus": "代码架构",
              "scoring_hint": "高分：清晰数据类与类型；中分：松散字典；低分：无结构。"
            },
            {
              "sub_criteria": "求解管线与热启动实现",
              "description": "CasADi模型构建、NLP/MIP求解调用、初值来源与warm-start、场景并行。",
              "score": 30,
              "evaluation_focus": "可执行性",
              "scoring_hint": "高分：给伪代码/流程；中分：口述步骤；低分：无实现细节。"
            },
            {
              "sub_criteria": "单位一致性与能量收支校验",
              "description": "实现单位转换、能量平衡检查（机械能变化≈牵引做功−阻力/再生）。",
              "score": 25,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：含断言/测试；中分：仅说明需检查；低分：忽略。"
            },
            {
              "sub_criteria": "日志与诊断（求解器日志、可行性标志）",
              "description": "输出优化日志、约束违例统计、可行/不可行标志与原因。",
              "score": 20,
              "evaluation_focus": "可运维性",
              "scoring_hint": "高分：结构化日志；中分：粗略打印；低分：无日志。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "准点恢复指标（最大/累计延误、95%恢复率）",
              "description": "报告并对比延误前后最大/累计延误，给出场景下的恢复概率/置信指标。",
              "score": 35,
              "evaluation_focus": "指标评估",
              "scoring_hint": "高分：含基线对比与置信区间；中分：给出单一指标；低分：无量化。"
            },
            {
              "sub_criteria": "能耗影响与再生匹配分析",
              "description": "比较网侧能耗变化、再生能量利用率与功率匹配（P_used=min(P_accel,P_regen)）。",
              "score": 30,
              "evaluation_focus": "能耗解释",
              "scoring_hint": "高分：分段/峰值时段分析；中分：总体数值；低分：定性描述。"
            },
            {
              "sub_criteria": "安全与约束违例审计",
              "description": "统计v≤min(V_line, sqrt(2·L·B_e))、L≥L_min、加速度界、站停界的违例率并说明修复。",
              "score": 20,
              "evaluation_focus": "合规性",
              "scoring_hint": "高分：给违例次数/比例=0或很低；中分：少量违例有解释；低分：大量违例未处理。"
            },
            {
              "sub_criteria": "敏感性与实时性验证",
              "description": "展示对K、窗长、样本数N变化的敏感性与单次重规划耗时（目标≤30s）。",
              "score": 15,
              "evaluation_focus": "稳健与时效",
              "scoring_hint": "高分：耗时达标并有敏感性图；中分：部分达标；低分：超时或无验证。"
            }
          ]
        }
      }
    },
    "4": {
      "subtask": "子任务4（验证、敏感性分析、实现细节与工程化扩展路线）应当作为独立、可重复执行的工程化工作包，其目标是对用于速度—距离曲线与能耗仿真的物理模型和数值实现进行系统校准、验证与不确定性量化，并输出可用于工程部署的经校准参数集、鲁棒性报告、软件交付物与改进建议；为此需按以下步骤严格实施：首先准备与预处理输入数据（读取并核验“列车参数.docx”、“线路参数.xlsx”、“输入数据模板.xlsx”中所有字段、单位与缺失值，统一单位制，生成基线参数文件与元数据记录），并建立自动化单元检查（单位一致性、边界值、物理可行性）；第二步进行参数标定与模型识别，采用历史运行数据（若无则采用合成高保真试验数据）对阻力多项式系数A、B、C、牵引/制动特性曲线F_max(v)/B_max(v)、列车质量M、再生效率η_reg、曲线常数c等关键参数进行估计，方法包括：非线性最小二乘拟合、扩展/无迹卡尔曼滤波用于在线辨识、以及贝叶斯校准以给出后验分布；校准过程中应进行残差分析和交叉验证以防过拟合，并保存参数置信区间；第三步执行模型验证套件：对时间步长敏感性（如0.2s、0.5s、1s）与积分方法（显式/隐式、RK2/4）进行收敛性测试；实施能量收支检验（牵引能量＋初始动能 − 阻力做功 − 制动损耗 ≈ 机械能终值，能量误差应记录并控制在可接受范围内）；比较模型预测与观测（或高精度仿真）在速度轨迹、到发时刻与网侧能耗上的误差指标（RMSE、MAE、相对误差及违约率），并生成详细验证报告；第四步开展不确定性与敏感性分析：定义关键不确定参数及其变动区间（例如η_reg 80–98%、A/B/C ±30%、F_max/B_max 曲线偏移 ±10%、M ±10%、c ±20%、变电站容量等），采用拉丁超立方采样（LHS）或Sobol序列进行蒙特卡洛模拟（建议至少数千次样本以获得稳健统计），并计算局部（单参数一阶敏感）与全局敏感性指标（Sobol总效应、Morris筛选），输出参数对目标（网侧能耗、再生利用率、最大速度/加速度、约束违规率）方差贡献排序与不确定区间，必要时构建响应面或代理模型（高斯过程、径向基或神经网络）以加速后续的高维优化评估；第五步对再生能量模型进行对比验证：并行实现并评估题目给定的“制动能量按制动时间重叠线性分配”近似与更物理的“瞬时功率匹配”模型（以及可选的等效电网模型，包括变电站容量与接触网电压约束的简化电气网络），比较两种方法下的再生利用率与网侧能耗差异，若差异显著则建议采用电网耦合模型或在原始模型中加入经验修正系数；第六步编制实施与软件工程要求：提供可复现的代码仓库（建议使用 Python，依赖：numpy/pandas, CasADi, IPOPT或KNITRO接口, scipy, pyDOE/ SALib, pygmo/DEAP），包含数据导入、单位转换、参数配置、标定脚本、验证测试套件、敏感性分析脚本及示例输入输出；要求所有随机过程设置固定种子、结果与中间产物采用可追溯命名并记录求解器版本与运行环境（推荐使用 Docker 容器化以保证可复现），并提供自动化报告生成功能（包含能耗时序图、误差统计、敏感性图表与建议参数）；第七步给出计算资源与性能建议：估算单次高精度仿真（细步长、单列NLP）与大规模蒙特卡洛所需的CPU核数与内存，推荐并行化策略（对样本并行或对列车并行），并提出代理模型在全局优化时的使用方案以降低评估成本；第八步输出交付项与工程化扩展建议：交付经校准的参数文件与置信区间、验证与敏感性报告、可执行软件包与Docker镜像、按秒格式的输出接口说明（匹配“数据格式.xlsx”列）及示例数据、以及若干优先级调整的改进路线（如在后续引入更精确的接触网功率流模型、在线参数自适应辨识模块或基于代理/机器学习的实时控制近似器）；最后要求在报告中明确列出所有假设、不适用域与可能导致偏差的条款，并建议一组可量化的接受标准（例如能量预报相对误差、约束违规率阈值、校准后残差统计），以便工程验收和后续迭代改进。",
      "criteria": {
        "task_understanding": {
          "core_goal": "在统一单位与线路约束下，建立并求解单质点列车的能耗最优控制模型，优化得到A6→A7（110s）与A6→A7停45s→A8（总运行时间220s）的最节能速度—距离曲线并按秒输出。",
          "expected_output": "两种工况的最优速度—距离—时间序列（逐秒），对应控制序列(μ_F/μ_B或F/B)、位置x与公里标、瞬时牵引/再生功率、累积网侧能耗E_grid；可执行求解代码/NLP模型文件；误差与单位校验日志；按“数据格式.xlsx”列的逐秒数据填充文件。",
          "key_inputs_constraints": "输入：M、F_max(v)、B_max(v)、A/B/C、c、坡度i(‰)、曲线半径R、V_line(x)、站距与公里标；约束：dx/dt=v，M dv/dt=F−B−W(v,x)，v≤V_line(x)，F∈[0,F_max(v)]，B∈[0,B_max(v)]，F·B=0；A6/A7/A8边界v=0与位移终值；A6→A7总时长110s；A6→A8两段总运行时长220s且A7停站45s；能量目标最小化E_grid含再生能量计算；输出步长1s（内部可更细）；单位一致性（速度m/s与km/h换算）。",
          "modeling_type": "优化+仿真+评价",
          "role_in_pipeline": "作为全流程的单列车物理建模与最优控制核心模块：前序依赖数据准备与单位统一；后序为多列仿真与调度优化提供可调用的速度剖面与能耗评估，并为验证/敏感性分析提供基线模型与输出。",
          "assumptions": "若缺少观测数据则以给定曲线与参数为真值；再生能量按题设E_reg与时间重叠法记录，但本子任务为单列情形默认E_used=E_reg（或按题设保留可配置开关）；内部积分步长取0.2–0.5s后按1s采样输出。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "识别两种运行情形与固定时间窗（110s与220s+停45s）",
              "description": "是否准确区分A6→A7与A6→A8含A7停站45s两种工况，并明确总运行时间约束（不含停站）。",
              "score": 25,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：清晰列出两情形时间与停站约束并在模型中单独施加；中分：文字说明正确但未体现在约束；低分：混淆或忽略其一。"
            },
            {
              "sub_criteria": "目标函数为网侧净能耗最小化（E_grid）",
              "description": "正确将牵引功率与再生能量（题设E_reg）纳入E_grid定义，并区分瞬时功率与能量累积。",
              "score": 25,
              "evaluation_focus": "目标识别",
              "scoring_hint": "高分：给出E_grid构成与单位，含再生项；中分：仅最小化牵引能量；低分：目标与题设不符或未定义。"
            },
            {
              "sub_criteria": "关键约束识别（V_line、F_max/B_max、F·B=0）",
              "description": "列出速度限速、牵引/制动特性、互斥牵引制动等硬约束并说明来源。",
              "score": 25,
              "evaluation_focus": "约束梳理",
              "scoring_hint": "高分：三类约束齐全且与数据字段对应；中分：缺失其一；低分：约束泛化或错误。"
            },
            {
              "sub_criteria": "单位统一与阻力模型构成（A/B/C,i,R,c）",
              "description": "识别w0(v_km/h)=A+Bv+Cv^2与w1=i+c/R，并说明m/s与km/h换算及W公式。",
              "score": 25,
              "evaluation_focus": "物理理解",
              "scoring_hint": "高分：给出换算关系与W=(w0+w1)gM/1000；中分：给出公式但无单位说明；低分：公式或单位错误。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "动态方程复述（M dv/dt=F−B−W, dx/dt=v）",
              "description": "用本任务符号完整复述单质点动力学并结合输入数据说明变量来源。",
              "score": 30,
              "evaluation_focus": "数理表达",
              "scoring_hint": "高分：两式准确并指向参数文件；中分：缺失一式或记号含混；低分：错误或缺失。"
            },
            {
              "sub_criteria": "边界条件与事件（A6/A7/A8速度为0与停站45s）",
              "description": "清晰表述站点事件与速度/时间边界如何落地到离散求解。",
              "score": 30,
              "evaluation_focus": "约束表述",
              "scoring_hint": "高分：给出事件时刻索引处理；中分：仅文字描述；低分：未体现。"
            },
            {
              "sub_criteria": "能耗定义与再生能量计算复述",
              "description": "按题设E_reg与E_used或等效瞬时法说明如何计入E_grid。",
              "score": 40,
              "evaluation_focus": "目标细化",
              "scoring_hint": "高分：明确E_reg=0.95(ΔE_mech−E_f)与积算方法；中分：只写再生概念未公式；低分：忽略再生或写反号。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "单质点与舒适性加速度界限假设",
              "description": "说明采用单质点模型及a/减速度上下限来源（曲线或规范）。",
              "score": 25,
              "evaluation_focus": "建模假设",
              "scoring_hint": "高分：定量给出a_max/dec_max并合理；中分：仅定性；低分：未提或与曲线矛盾。"
            },
            {
              "sub_criteria": "牵引/制动互斥与连续松弛或二元变量选择",
              "description": "阐明F·B=0的处理策略（惩罚或MIP）及对可解性的影响。",
              "score": 25,
              "evaluation_focus": "建模策略",
              "scoring_hint": "高分：给出具体惩罚/Big-M并讨论数值性；中分：仅口头；低分：允许同时牵引制动。"
            },
            {
              "sub_criteria": "再生利用假设（单列可用性处理）",
              "description": "说明单列情形如何处理E_used（等于E_reg或可配置），并标注局限。",
              "score": 25,
              "evaluation_focus": "假设边界",
              "scoring_hint": "高分：清楚声明并可切换方法；中分：默认等于E_reg无说明；低分：混淆或遗漏。"
            },
            {
              "sub_criteria": "时间离散与步长选择（内部细步长→1s输出）",
              "description": "假设内部积分步长与对收敛/精度的权衡并说明再采样方法。",
              "score": 25,
              "evaluation_focus": "数值假设",
              "scoring_hint": "高分：给出0.2–0.5s与线性/样条采样；中分：仅1s全程；低分：未说明。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "阻力模型离散与单位换算正确性",
              "description": "将w0(v_km/h)与w1(x)正确嵌入W并离散化到时步k，含km/h↔m/s换算。",
              "score": 20,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：写出离散表达与系数换算；中分：无换算细节；低分：错误。"
            },
            {
              "sub_criteria": "NLP/MIP变量与约束完备性",
              "description": "明确决策(v_k,x_k,μ_Fk,μ_Bk或F/B)，F_max(v_k)/B_max(v_k)、V_line(x_k)、位移与时间窗口等约束。",
              "score": 30,
              "evaluation_focus": "模型完备",
              "scoring_hint": "高分：变量与约束列表全面；中分：缺少1–2项；低分：关键缺失。"
            },
            {
              "sub_criteria": "能量目标离散化与再生项实现",
              "description": "E_grid=Σ[(F_k v_k−P_regen_used,k)]_+Δt或按题设E_reg积算的等效实现。",
              "score": 25,
              "evaluation_focus": "目标构造",
              "scoring_hint": "高分：给出可实现的离散式与符号；中分：仅连续表述；低分：未离散或符号错误。"
            },
            {
              "sub_criteria": "事件与停站建模（A7速度=0与停45s）",
              "description": "通过时序索引或阶段切换在NLP中强制v=0、x恒定与时间计数。",
              "score": 25,
              "evaluation_focus": "约束设计",
              "scoring_hint": "高分：给出k_stop区间与约束写法；中分：口述无公式；低分：未实现停站。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "求解器与初值策略（CasADi+IPOPT等）",
              "description": "选择合适NLP求解器并给出牵引→惰行→制动型初猜与标度策略。",
              "score": 30,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：明确工具链与初值构造细节；中分：仅列工具；低分：无可用求解方案。"
            },
            {
              "sub_criteria": "数值稳定与互斥处理（惩罚/MIP）",
              "description": "解释互斥约束数值实现与收敛性处理（惩罚系数、连续松弛）。",
              "score": 25,
              "evaluation_focus": "数值技巧",
              "scoring_hint": "高分：给出参数范围与收敛观测；中分：笼统描述；低分：导致频繁不可行。"
            },
            {
              "sub_criteria": "可行性与时间窗满足（110s/220s约束）",
              "description": "验证并确保终端时间与位移、站点事件全部满足。",
              "score": 25,
              "evaluation_focus": "可行解性",
              "scoring_hint": "高分：报告偏差≤1步长并闭合；中分：小幅违约无修复；低分：显著违约。"
            },
            {
              "sub_criteria": "能量与单位核对（E_grid数值健壮）",
              "description": "检查能量维度与数值范围合理（kWh或MJ），防止负值/爆值。",
              "score": 20,
              "evaluation_focus": "数值校验",
              "scoring_hint": "高分：给出单位换算与范围；中分：仅口头；低分：出现明显异常。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "数据读取与单位统一（xlsx字段映射）",
              "description": "正确解析“列车参数.xlsx/线路参数.xlsx”，完成km/h↔m/s、N/kN等换算。",
              "score": 25,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：有校验与错误提示；中分：能读但无校验；低分：字段/单位错。"
            },
            {
              "sub_criteria": "离散积分与求解框架（dt内部≤0.5s，输出1s）",
              "description": "实现显式/隐式或RK2/4积分，支持更细步长内算、1s采样输出。",
              "score": 25,
              "evaluation_focus": "实现质量",
              "scoring_hint": "高分：模块化可切换步长与方法；中分：固定方案；低分：时间步混乱。"
            },
            {
              "sub_criteria": "约束与互斥在代码中的正确落地",
              "description": "V_line、F_max/B_max与F·B=0在代码层面生效并可调参数。",
              "score": 25,
              "evaluation_focus": "正确性",
              "scoring_hint": "高分：单元测试覆盖极值；中分：基本可用；低分：经常性违规。"
            },
            {
              "sub_criteria": "数据格式.xlsx逐秒输出与字段完整性",
              "description": "按红色表头输出时间、速度、公里标、计算距离、功率、能耗，且不改格式。",
              "score": 25,
              "evaluation_focus": "交付合规",
              "scoring_hint": "高分：字段与顺序完全匹配；中分：少数缺列；低分：改动模板或错列。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "能量收支与物理一致性校验",
              "description": "报告牵引能量、再生能量、阻力做功与机械能变化的闭合误差并量化。",
              "score": 30,
              "evaluation_focus": "结果验证",
              "scoring_hint": "高分：误差≤3%；中分：3–10%；低分：未给或>10%。"
            },
            {
              "sub_criteria": "速度—距离曲线特征合理性",
              "description": "是否呈现牵引→惰行/巡航→制动的合理剖面且满足限速与站点速度0。",
              "score": 25,
              "evaluation_focus": "物理合理",
              "scoring_hint": "高分：曲线平滑无超限；中分：小幅振荡；低分：超速或终端不为0。"
            },
            {
              "sub_criteria": "两情形E_grid对比与时间约束影响解析",
              "description": "比较A6→A7与A6→A8（含停站）能耗差异并解释时间窗对能耗的影响。",
              "score": 25,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：给出数值差与机理；中分：仅定性；低分：未比较或结论相悖。"
            },
            {
              "sub_criteria": "敏感性快检（步长或初值对E_grid影响）",
              "description": "报告dt或初值变更对E_grid与可行性的影响（小规模试验即可）。",
              "score": 20,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：量化变化≤5%且解释；中分：有试验无量化；低分：未做。"
            }
          ]
        }
      }
    }
  }
}