{
  "task_id": "2018_D",
  "problem": "根据以上介绍及提供的数据文件及表格，请你们团队研究下列问题：\n\n1. 根据沿轨道的星下观测点的海面高度异常值，提取所有星下观测点各主要分潮 ($M_{2}$、$S_{2}$、$K_{1}$、$O_{1}$) 的潮汐调和常数，注意能有效提取那些分潮的潮汐调和常数取决于相应的资料长度；对提取的潮汐调和常数，应利用潮汐验潮点的调和常数给予评价或检验，并给出评价结果的分析或评价。\n\n2. 得到所有星下观测点各主要分潮 ($M_{2}$、$S_{2}$、$K_{1}$、$O_{1}$) 的潮汐调和常数，沿轨道作图后，可发现潮汐调和常数在沿轨道方向，在空间有细结构，而此细结构是内潮对正压潮的调制；请设法对沿轨道的各分潮的潮汐调和常数进行正压潮和内潮的分离。\n\n3. 设计数据插值或拟合方法给出南海的各主要分潮的同潮图，并利用潮汐验潮点的调和常数给予评价或检验，并给出评价结果的分析或评价。\n\n如果你们还有时间和兴趣，还可考虑下列：\n\n4. 如果在对沿轨道的潮汐调和常数分离、插值或拟合的过程中，利用了特定的函数进行拟合，是否能够确定出需利用的特定函数的最佳（高）次数？上述结论是否对第3问有启示或帮助。\n\n本题要求提供可计算出所提交报告中答案的计算程序，所使用的语言和工具不限，但推荐使用C/C++、Fortran、Matlab等。",
  "subtask": {
    "1": {
      "subtask": "子任务1（单点时域谐和提取）的目标是以可重复、可量化的程序从每个卫星星下观测点的海面高度异常时间序列中精确估计 M2、S2、K1、O1 四个分潮的复调和常数（振幅与相位）并给出每个估计值的协方差与质量标识；其范围仅限于数据准备、逐点建模与不确定度评估，不涉及空间插值或物理分解。为实现该目标，应按以下确定性步骤执行：一是输入与初步筛选——读取提供的 TOPEX/POSEIDON 高度计时间序列文件（TP.dat）和“调和分析方法简介”中给出的各分潮角速度、交点因子与订正角表，读取 ETOPO5 水深/陆地掩膜用于识别近岸/陆缘观测并标注潜在的陆污染点；二是数据预处理——对每条时间序列做时间基线统一（将时间转换为秒并对齐天文历算所需参考时刻）、剔除显著孤立异常值、填记缺测并记录有效样本数与时间跨度；如高度计产品未包含常规校正，则应一并应用或确认已应用轨道改正、电离层/对流层延迟校正、海面状态误差校正与潮汐自潮等（若无法校正则在质量标识中说明）；三是模型与设计矩阵构建——为每一点构造时域线性模型 y(t)=Σ_m [C_m cos(ω_m t+Δ_m(t)) + S_m sin(ω_m t+Δ_m(t))] + T(t) + ε(t)，其中 ω_m 取自题库，Δ_m(t) 包含交点因子/订正角的天文时间依赖性，T(t) 至少包含常数项与一次趋势或必要的长周期项以减少低频能量对天文频率成分的泄漏；四是最小二乘求解与数值稳定性——使用加权线性最小二乘（权重可设为观测不确定度的倒数或一律为1）并通过 QR 分解或 SVD 求解 normal 方程以保证数值稳定，同时为不服从高斯噪声的异常点提供稳健替代（如迭代重加权最小二乘或 Huber 损失选项）；五是不确定度与显著性评估——从拟合残差估计噪声方差，计算参数协方差矩阵 Cov(β)=(D^T W D)^{-1} σ^2，从 cos/sin 对应系数转换为复调和常数 H_m=A_m e^{iφ_m} 并用误差传播给出振幅 A_m 的标准误及相位 φ_m 的不确定度；六是频率可分辨性判定——对每一条记录计算频率分辨率 Δf≈1/T 并与目标分潮间的频率差比较，若 Δf 太大导致谱混叠则在输出中标注“不可分辨/需联合拟合”并记录推荐处理策略；七是质量控制与输出格式——为每个观测点输出：点位信息、时间跨度与样本数、每一分潮的振幅、相位、复常数、参数协方差矩阵、拟合残差统计（RMS、偏差）、信噪比与最终质量标识（基于样本数、记录长度、残差水平与参数显著性阈值）；并把实现细节（所用角速度表、节点因子计算公式、权重与离散化设置、SVD/QR库版本）记录为元数据以确保可复现。建议使用数值线性代数成熟的软件环境（如 MATLAB 的 backslash/SVD、Python 的 numpy/scipy.linalg、或 Fortran/C++ 调用 LAPACK），并对大批量点并行化逐点拟合以提高效率；整个子任务的验收标准为：对每个有足够记录长度的星下点均产生一套完整的谐和常数、对应不确定度与质量标识文件，且所有计算步骤和参数设置在元数据中被明确定义以便审查与复现。",
      "criteria": {
        "task_understanding": {
          "core_goal": "对每个卫星星下观测点的海面高度异常时间序列进行谐和拟合与评估，精确估计 M2、S2、K1、O1 分潮的复调和常数并量化不确定度与质量标识。",
          "expected_output": "逐点报表与机器可读文件：包含点位信息、时间跨度/样本数、M2/S2/K1/O1 的振幅、相位、复常数、参数协方差矩阵、残差RMS/偏差、信噪比、频率可分辨性判定、质量标识；附元数据（角速度表、交点因子/订正角公式、权重设定、数值解法版本）。",
          "key_inputs_constraints": "输入：TP.dat 高度计时间序列（秒级时间与海面高度异常）、分潮角速度与交点因子/订正角表、ETOPO5 地形与陆地掩膜、（可选）观测不确定度与已应用改正标记。约束：时间统一为秒并对齐参考历元；记录长度决定频率可分辨性（Δf≈1/T）；采用加权最小二乘与QR/SVD；输出协方差需由残差方差与(D^TWD)^-1给出；质量标识基于样本数、长度、残差与显著性阈值；若轨道/电离层/对流层/海面状态/自潮改正缺失需标注。",
          "modeling_type": "拟合+评价",
          "role_in_pipeline": "作为数据准备与逐点建模环节：在空间插值与正压潮/内潮分离之前提供可靠的点位复调和常数与不确定度。前序依赖：数据读取与预处理；后序任务：空间插值制图、物理分解与交叉验证。",
          "assumptions": "若TP.dat未含改正，则不补算仅在质量标识中降级；观测权重默认等权；长周期T(t)含常数与一次趋势即可抑制泄漏。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "核心目标对齐：谐和拟合与评估 M2/S2/K1/O1",
              "description": "是否明确本子任务仅做单点时域谐和拟合与不确定度评估，不涉及空间插值或内潮分离；对象为M2、S2、K1、O1复调和常数。",
              "score": 30,
              "evaluation_focus": "任务界定",
              "scoring_hint": "高分：清晰限定范围并点名4分潮与复常数+协方差；中分：提到拟合四分潮但混入空间步骤；低分：目标含混或错把任务当预测/制图。"
            },
            {
              "sub_criteria": "关键输入与约束识别（TP.dat/角速度表/ETOPO5）",
              "description": "是否点名并解释TP.dat、角速度及交点因子/订正角表、ETOPO5掩膜的用途与限制。",
              "score": 25,
              "evaluation_focus": "输入解析",
              "scoring_hint": "高分：逐一对应用途（筛岸、构造Δm(t)）；中分：仅列出文件名无用途；低分：遗漏关键输入或误解。"
            },
            {
              "sub_criteria": "频率可分辨性与记录长度Δf≈1/T",
              "description": "是否指出记录长度控制M2/S2/K1/O1可分辨性并提出判定。",
              "score": 25,
              "evaluation_focus": "约束把握",
              "scoring_hint": "高分：给出Δf≈1/T并与分潮频差比较策略；中分：笼统提时长重要；低分：未提可分辨性。"
            },
            {
              "sub_criteria": "改正项与质量标识的关系",
              "description": "是否认识轨道/电离层/对流层/海面状态/自潮改正缺失对质量标识的影响与标注需求。",
              "score": 20,
              "evaluation_focus": "风险识别",
              "scoring_hint": "高分：列出改正清单与降级策略；中分：泛提改正重要；低分：完全忽略。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "时域模型 y(t)=Σ[C cos(ωt+Δ)+S sin(ωt+Δ)]+T(t)+ε 复述",
              "description": "是否准确重述包含Δm(t)与T(t)（常数+趋势）的设计。",
              "score": 35,
              "evaluation_focus": "精确表述",
              "scoring_hint": "高分：写出各项含义与目的（抗泄漏）；中分：缺Δ或T(t)；低分：仅描述FFT等与任务不符。"
            },
            {
              "sub_criteria": "输出项与元数据复述",
              "description": "是否枚举振幅、相位、复常数、协方差、RMS、SNR、质量标识与元数据（角速度表、库版本）。",
              "score": 35,
              "evaluation_focus": "输出对齐",
              "scoring_hint": "高分：完整清单；中分：缺少协方差或元数据；低分：仅给振幅相位。"
            },
            {
              "sub_criteria": "加权最小二乘与稳健选项",
              "description": "是否说明权重（等权或不确定度倒数）与IRLS/Huber的可选稳健流程。",
              "score": 30,
              "evaluation_focus": "方法清晰",
              "scoring_hint": "高分：说明何时启用稳健与迭代准则；中分：只提加权；低分：未提数值方案。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "改正可用性与处理假设",
              "description": "明确若常规改正缺失则不补算、仅在质量标识中降级的假设。",
              "score": 25,
              "evaluation_focus": "假设清晰",
              "scoring_hint": "高分：写明影响范围与标注字段；中分：笼统提不影响结论；低分：无说明。"
            },
            {
              "sub_criteria": "噪声与权重模型假设",
              "description": "残差为近似零均值、同方差或加权情形；稳健损失用于非高斯尾部。",
              "score": 25,
              "evaluation_focus": "统计设定",
              "scoring_hint": "高分：给出σ²估计与权重来源；中分：仅称高斯；低分：无噪声假设。"
            },
            {
              "sub_criteria": "T(t) 结构与泄漏控制假设",
              "description": "T(t)至少包含常数与一次趋势，必要时可含年/半年项以抑制低频泄漏。",
              "score": 25,
              "evaluation_focus": "模型边界",
              "scoring_hint": "高分：阐明避免泄漏到天文频率的动机；中分：只写常数项；低分：无T(t)。"
            },
            {
              "sub_criteria": "频率固定与Δm(t)天文项假设",
              "description": "角速度ωm固定取表，Δm(t)来自交点因子与订正角的时间函数。",
              "score": 25,
              "evaluation_focus": "物理约束",
              "scoring_hint": "高分：明确Δm(t)随时变；中分：将Δ视为常数；低分：忽略Δ。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "设计矩阵 D 与列正交性考虑",
              "description": "正确构造含cos/sin与Δm(t)的列，并检查多重共线性（近频/短记录）。",
              "score": 30,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：说明正则或列缩放；中分：仅给形式；低分：未考虑共线性。"
            },
            {
              "sub_criteria": "权重矩阵 W 与异常点策略",
              "description": "定义W（等权或基于不确定度），并给出IRLS/Huber迭代与停止准则。",
              "score": 25,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：迭代≤10次、收敛阈值；中分：仅口述稳健；低分：无策略。"
            },
            {
              "sub_criteria": "T(t) 与长周期项设置",
              "description": "在D中包含常数、线性趋势，必要时年/半年项以减泄漏。",
              "score": 20,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：给出是否加入的准则（如AIC或残差谱）；中分：盲目加入/删除；低分：缺失T(t)。"
            },
            {
              "sub_criteria": "频率可分辨性与模型裁剪",
              "description": "依据Δf≈1/T与分潮频差决定是否估计某分潮或标记不可分辨。",
              "score": 25,
              "evaluation_focus": "约束嵌入",
              "scoring_hint": "高分：实现自动判定并从D中移除；中分：仅标注；低分：无处理导致病态。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "数值稳定性（QR/SVD）与缩放",
              "description": "采用QR或SVD解加权最小二乘，报告条件数/秩并进行列缩放。",
              "score": 30,
              "evaluation_focus": "数值计算",
              "scoring_hint": "高分：提供cond或rcond阈值与退化处理；中分：使用普通正态方程；低分：解法不当。"
            },
            {
              "sub_criteria": "协方差计算与误差传播",
              "description": "σ²由残差估计；Cov=(D^TWD)^-1 σ²；cos/sin到振幅相位误差传播正确。",
              "score": 30,
              "evaluation_focus": "不确定度",
              "scoring_hint": "高分：给出A、φ标准误公式；中分：仅给对角线；低分：未算协方差。"
            },
            {
              "sub_criteria": "稳健迭代与收敛",
              "description": "IRLS/Huber实现迭代、权重更新、收敛判据与异常点影响控制。",
              "score": 20,
              "evaluation_focus": "鲁棒性",
              "scoring_hint": "高分：残差变化<1e-6或权重稳定；中分：固定迭代次数；低分：无迭代细节。"
            },
            {
              "sub_criteria": "显著性与SNR计算",
              "description": "参数t检验/置信区间与SNR=A/σA计算，用于质量标识。",
              "score": 20,
              "evaluation_focus": "统计检验",
              "scoring_hint": "高分：设阈值如SNR≥3；中分：口头说明；低分：未检验。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "可复现性与元数据记录",
              "description": "记录角速度表版本、节点因子公式、权重设定、SVD/QR库版本、随机种子（如有）。",
              "score": 25,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：自动写入到输出元数据；中分：文档备注；低分：无记录。"
            },
            {
              "sub_criteria": "数据预处理管线",
              "description": "时间统一到秒、参考历元对齐；异常值剔除与缺测标记；ETOPO5掩膜近岸标注。",
              "score": 25,
              "evaluation_focus": "工程实现",
              "scoring_hint": "高分：提供阈值/规则与日志；中分：部分实现；低分：未预处理。"
            },
            {
              "sub_criteria": "并行逐点拟合与资源效率",
              "description": "对>4000点并行/批处理，避免内存峰值，I/O流式读取。",
              "score": 20,
              "evaluation_focus": "性能工程",
              "scoring_hint": "高分：显式并行与批大小控制；中分：串行但稳定；低分：内存溢出或超慢。"
            },
            {
              "sub_criteria": "输出格式与完整性检查",
              "description": "逐点输出复常数、协方差矩阵、RMS、SNR、质量标识与可分辨性标记；模式校验。",
              "score": 30,
              "evaluation_focus": "接口契约",
              "scoring_hint": "高分：含校验器或schema；中分：字段基本齐全；低分：缺协方差/质量标识。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "残差统计与谱诊断",
              "description": "报告残差RMS/偏差与残差谱是否存在未建模能量（年/半年、近频泄漏）。",
              "score": 30,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：展示典型点诊断与改进建议；中分：仅给RMS；低分：无分析。"
            },
            {
              "sub_criteria": "不确定度与SNR解读",
              "description": "解释各分潮A、φ的不确定度与SNR分布对质量标识的影响。",
              "score": 25,
              "evaluation_focus": "统计解读",
              "scoring_hint": "高分：分潮间对比并设阈分类；中分：零散描述；低分：未结合SNR。"
            },
            {
              "sub_criteria": "频率可分辨性标注与处理建议",
              "description": "对不可分辨情况给出标注与联合拟合/剔除建议。",
              "score": 25,
              "evaluation_focus": "方法审视",
              "scoring_hint": "高分：列举比例与地理分布；中分：仅文字说明；低分：未标注。"
            },
            {
              "sub_criteria": "质量标识与近岸影响讨论",
              "description": "讨论ETOPO5近岸/陆缘污染对拟合与质量标识的影响与筛选策略。",
              "score": 20,
              "evaluation_focus": "风险评估",
              "scoring_hint": "高分：定量比较近岸与离岸RMS/SNR；中分：定性；低分：忽略。"
            }
          ]
        }
      }
    },
    "2": {
      "subtask": "子任务 2（空间分解与正压潮/内潮初始分离）旨在把每一潮汐分潮在所有观测点的复调和常数 H_p (复数，含振幅与相位) 分解为平滑的正压潮场 B(x) 与沿轨细尺度的内潮场 I_p 的线性和，明确任务范围为以数值化、可复现的逆问题方法在给定输入数据与先验下估计 B(x) 与 I_p 及其近似不确定度，并输出用于后续插值与分析的参数化表示；所需输入为：所有观测点的地理位置 x_p（经纬须投影到局部笛卡尔网格）、每点对应的复调和常数 H_p 及其协方差矩阵或方差估计、ETOPO5 水深字段用于地形先验与产生区指示、目标分潮的角频率与节点/订正因子表。方法要点如下：模型设定为 H = Φ c + I + η，其中 Φ c 是 B(x) 在选定平滑基（可选二维薄板样条基、低阶球谐或基于高斯过程的核基，其系数为 c）上的展开，I 在观测点直接表示为沿轨带通/高频成分（按轨迹索引独立参数化以保留沿轨细结构），η 为观测残差；权重矩阵 W 由 H_p 的协方差决定（通常取 W = Cov(H)^{-1/2}）并在目标函数中用于加权。构造带正则化的加权最小二乘目标 J(c,I) = || W (Φ c + I − H) ||^2 + λ_b || L_b c ||^2 + λ_i || L_i I ||^2，其中 L_b 为鼓励 B 在空间上平滑的算子（如离散拉普拉斯或二阶导算子），L_i 对 I 作两类约束：一是沿轨带通/谱约束（鼓励 I 的空间谱集中在由地形与模态理论给出的波长范围内），二是跨轨方向平滑以抑制随机噪声；正则化参数 λ_b、λ_i 通过广义交叉验证、留一交叉验证或 L-curve 法确定。实现步骤明确为：1) 用 ETOPO5 与经验两层近似模型估计每条轨迹局地第一模相速度与对应的主波长λ1（采用 g' = g Δρ/ρ 与 c1^2 ≈ g' h1 h2/(h1+h2) 的两层近似，并对 Δρ/ρ 采用合理区间做敏感性检验），据此设定沿轨带通中心波长及带宽；2) 在每条轨上对 H 的空间分布做谱分析（FFT/Welch）以识别显著沿向波数并初始化 I 的复值初始场（例如通过沿轨带通滤波得到初值）；3) 在初始化后采用交替最小二乘迭代：固定 I 解线性正则化问题求 c（用 SVD 或带Tikhonov正则的正规方程/LSQR求解器），再固定 c 在每条轨上用带通参数化（振幅用样条或低秩基表示，复相位按累计波数积分或以直接复系数形式拟合）解 I 的正则化问题（每轨可并行化，利用频域先验约束以改善稳定性）；4) 迭代直至模型减小或系数收敛；5) 用线性逆问题理论近似后验协方差（若规模允许）或用蒙特卡洛重采样在有限次迭代上估算 B 与 I 的不确定度。数值与实现细节：所有空间运算在局部笛卡尔投影下完成，沿轨谱估计建议采用重叠窗的Welch方法以降低方差；线性代数求解采用稳健的库（例如 LAPACK/SVD、scipy.sparse+LSQR、MATLAB backslash），并行策略按轨或按点并行以提高效率；正则化算子和带通滤波器在离散化时需与观测点间距相匹配（节距建议 5–50 km 范围内调整）；最终结果应包括 Φ c 的系数、每轨 I 的参数化系数、模型残差统计与用于超参数选择的验证度量。该子任务不涉及对时间域拟合的实现细节或最终同潮图的展示，其交付物为可复现的程序/脚本与数值解：B(x)（基系数或栅格场）、沿轨 I 参数化及其不确定度估计、并附超参数选择与谱分析报告，以便独立验证与后续空间插值。",
      "criteria": {
        "task_understanding": {
          "core_goal": "以加权正则化拟合分解每个分潮的复调和常数场为平滑正压潮场B(x)与沿轨内潮场I_p，并评估不确定度",
          "expected_output": "参数化的B(x)系数或栅格、各轨I_p参数（带通/样条/频域系数）、后验或近似不确定度、残差与验证度量、超参数(λ_b,λ_i)与谱分析报告、可复现脚本与配置",
          "key_inputs_constraints": "输入：观测点位置x_p(投影到局部笛卡尔)、复调和常数H_p及方差/协方差、ETOPO5水深；先验：分潮角频率与节点/订正因子表、两层模型参数范围(Δρ/ρ、h1,h2)；约束：W=Cov(H)^{-1/2}加权，Φ为选定平滑基，I沿轨带通约束与跨轨平滑，正则化参数需通过GCV/LOOCV/L-curve选择，运算在统一网格与节距(5–50 km)匹配",
          "modeling_type": "拟合+评价",
          "role_in_pipeline": "作为空间分解阶段，位于子任务1（单点时域谐和提取）之后，为子任务3（空间插值/同潮图）提供正压潮B(x)与内潮I_p的参数化输入与不确定度；依赖子任务1输出H_p与协方差及ETOPO5；后续任务使用本任务的B(x)进行插值绘图与物理分析",
          "assumptions": "若部分点缺失协方差则以统一方差或经验RMS代替；两层模型的Δρ/ρ取0.002–0.004做敏感性检验；局部投影采用等距圆柱或UTM分带，跨轨稀疏处对I_p施加更强光滑正则"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "明确分解目标：复调和常数H_p→B(x)+I_p拟合",
              "description": "是否准确识别本任务为对每个分潮的复数H_p进行加权正则化分解，得到平滑正压潮B(x)与沿轨内潮I_p两部分，并非时间域提取或最终同潮图。",
              "score": 35,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：清晰陈述H=Φc+I+η及两项物理含义；中分：只提到平滑+细尺度但未给出线性分解式；低分：将任务表述为插值或时域谐和。"
            },
            {
              "sub_criteria": "输入与权重：使用Cov(H)构造W",
              "description": "是否指出H_p协方差用于构造权重矩阵W=Cov(H)^{-1/2}，并说明位置x_p需要投影到局部笛卡尔坐标。",
              "score": 25,
              "evaluation_focus": "问题要件",
              "scoring_hint": "高分：说明协方差到权重的具体形式并强调投影；中分：仅提及加权未说明来源；低分：忽略权重或仍用未加权拟合。"
            },
            {
              "sub_criteria": "正则化与先验：λ_b、λ_i与L_b、L_i",
              "description": "是否识别到B(x)需要平滑算子L_b，I_p需带通/跨轨平滑L_i，并需选择λ_b、λ_i。",
              "score": 25,
              "evaluation_focus": "先验设定",
              "scoring_hint": "高分：点名二阶拉普拉斯或薄板样条平滑、带通约束；中分：只提到‘正则化’无细节；低分：无正则或不当正则。"
            },
            {
              "sub_criteria": "谱与地形先验：两层模型估计λ1",
              "description": "是否指出用ETOPO5和两层模型估计相速度与主波长λ1以设定I_p带通中心与带宽。",
              "score": 15,
              "evaluation_focus": "物理约束",
              "scoring_hint": "高分：给出c1或λ1估计思路与Δρ/ρ敏感性；中分：笼统说‘依据地形’；低分：未使用任何物理先验。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "目标函数J(c,I)加权最小二乘",
              "description": "是否用任务术语准确复述J(c,I)=||W(Φc+I−H)||^2+λ_b||L_b c||^2+λ_i||L_i I||^2的结构与目的。",
              "score": 40,
              "evaluation_focus": "形式化表达",
              "scoring_hint": "高分：写出或口述该式的全部三项；中分：缺少某一正则项；低分：无目标函数或表达错误。"
            },
            {
              "sub_criteria": "流程复述：初始化→交替最小二乘→收敛",
              "description": "是否复述先沿轨谱分析/带通初始化I，再交替求解c与I直到收敛的流程。",
              "score": 25,
              "evaluation_focus": "流程把握",
              "scoring_hint": "高分：明确两阶段并提及收敛准则；中分：只说‘迭代优化’；低分：一步式或无初始化策略。"
            },
            {
              "sub_criteria": "输出与不确定度",
              "description": "是否复述需给出B(x)系数、I参数、后验协方差或蒙特卡洛不确定度、残差统计与超参数选择报告。",
              "score": 20,
              "evaluation_focus": "交付意识",
              "scoring_hint": "高分：列出至少三类输出含不确定度；中分：只给B或I；低分：仅给图或口头结论。"
            },
            {
              "sub_criteria": "坐标与节距一致性",
              "description": "是否强调局部笛卡尔投影与带通/正则离散需匹配观测点间距(5–50 km)。",
              "score": 15,
              "evaluation_focus": "实现细节",
              "scoring_hint": "高分：提出节距范围或重采样；中分：仅提到‘统一网格’；低分：忽略导致混叠。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "两层模型参数假设与敏感性",
              "description": "对Δρ/ρ、h1、h2设定合理区间并说明对λ1的敏感性检验用于I_p带通设定。",
              "score": 35,
              "evaluation_focus": "物理假设",
              "scoring_hint": "高分：给出区间与对带宽影响的判断；中分：只给固定值；低分：未声明任何参数来源。"
            },
            {
              "sub_criteria": "协方差缺失的替代假设",
              "description": "当缺少Cov(H)时是否假设统一方差或以残差RMS估计并记录入元数据。",
              "score": 25,
              "evaluation_focus": "不确定度处理",
              "scoring_hint": "高分：明确替代与对W的影响；中分：默认等权；低分：权重与噪声处理缺失。"
            },
            {
              "sub_criteria": "I_p维度与跨轨相关性的假设",
              "description": "是否说明I_p主要沿轨变化、跨轨平滑弱耦合的先验并据此设置L_i。",
              "score": 20,
              "evaluation_focus": "先验建模",
              "scoring_hint": "高分：陈述带通+跨轨平滑；中分：仅说‘细结构沿轨’；低分：I_p完全自由或过度平滑。"
            },
            {
              "sub_criteria": "边界与稀疏区域处理",
              "description": "假设并说明在稀疏/边界区域对λ_b或λ_i的自适应增强以稳健估计。",
              "score": 20,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：提出正则增大或先验锚点；中分：只提醒‘谨慎’；低分：未考虑导致过拟合/震荡。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "平滑基Φ与L_b选择",
              "description": "是否合理选择二维薄板样条/高斯核/低阶球谐作为B(x)基，并配套二阶导或拉普拉斯平滑算子L_b。",
              "score": 30,
              "evaluation_focus": "模型设计",
              "scoring_hint": "高分：给出基类型与阶次/节点间距；中分：仅说‘样条’；低分：未说明或基与平滑不匹配。"
            },
            {
              "sub_criteria": "沿轨I_p带通与L_i构造",
              "description": "构建与点间距匹配的离散带通滤波先验或频域惩罚，并设置跨轨平滑项。",
              "score": 30,
              "evaluation_focus": "谱建模",
              "scoring_hint": "高分：说明中心波长λ1与带宽，窗口/Welch参数；中分：泛指‘带通’无参数；低分：无谱约束。"
            },
            {
              "sub_criteria": "权重矩阵与联合复数处理",
              "description": "对复H采用实部/虚部拼接或复正规方程，确保W正确作用并处理共轭对称。",
              "score": 20,
              "evaluation_focus": "数理推导",
              "scoring_hint": "高分：给出拼接形式与加权；中分：只说‘加权最小二乘’；低分：错误地分离幅相直接拟合导致偏差。"
            },
            {
              "sub_criteria": "超参数选择策略",
              "description": "为λ_b、λ_i提出GCV/LOOCV/L-curve并定义验证度量（加权RMS、预测残差）。",
              "score": 20,
              "evaluation_focus": "模型选择",
              "scoring_hint": "高分：指定一种可执行方法与度量；中分：手调无标准；低分：未说明选择依据。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "交替最小二乘与收敛判据",
              "description": "实现固定I求c、固定c求I的交替最小二乘，并设定相对目标下降或参数变化阈值与上限迭代次数。",
              "score": 35,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：明确阈值(如1e-3)与上限(如50)；中分：有迭代无准则；低分：一次性解或无迭代控制。"
            },
            {
              "sub_criteria": "数值稳定性：SVD/LSQR与正则化",
              "description": "求解Φ部分用SVD/Tikhonov或LSQR处理病态，报告条件数或正则参数；I部分在频域或样条系数空间解带通约束的正规方程。",
              "score": 30,
              "evaluation_focus": "数值稳健",
              "scoring_hint": "高分：提供库/方法与条件数/停止准则；中分：只用正规方程；低分：数值发散或NaN未处理。"
            },
            {
              "sub_criteria": "权重与协方差传播",
              "description": "在解的同时计算近似后验协方差或通过线性化传播，或提出蒙特卡洛重采样方案。",
              "score": 20,
              "evaluation_focus": "不确定度",
              "scoring_hint": "高分：给出Cov≈(A^TWA+R)^−1形式或MC细节；中分：仅给残差RMS；低分：无不确定度估计。"
            },
            {
              "sub_criteria": "沿轨谱初始化与Welch实现",
              "description": "用Welch/FFT识别沿向波数，窗口、重叠与段长与点距匹配，生成I初值。",
              "score": 15,
              "evaluation_focus": "实现细节",
              "scoring_hint": "高分：给出窗型、50%重叠、段长≥4×主波长；中分：简单FFT；低分：无初始化导致不收敛。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "数据管线与投影实现",
              "description": "完成x_p投影、H_p与Cov读取、ETOPO5采样，统一节距与轨道分组，记录元数据。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：模块化IO与校验；中分：脚本可跑但缺校验；低分：坐标或协方差读错。"
            },
            {
              "sub_criteria": "线性代数与并行",
              "description": "调用稳健库(LAPACK/scipy.sparse/Matlab)实现SVD/LSQR，按轨并行求I，报告性能。",
              "score": 25,
              "evaluation_focus": "工程实现",
              "scoring_hint": "高分：稀疏实现与并行；中分：串行可运行；低分：自写不稳算法致崩溃。"
            },
            {
              "sub_criteria": "正则与带通离散一致性",
              "description": "L_b、L_i与带通滤波器离散与点距匹配，边界条件与缺测处理健壮。",
              "score": 25,
              "evaluation_focus": "数值细节",
              "scoring_hint": "高分：显式处理边界与缺测；中分：默认设置；低分：离散与数据不匹配导致伪波纹。"
            },
            {
              "sub_criteria": "再现性与配置",
              "description": "提供可复现脚本、随机种子、超参数搜索记录与版本信息。",
              "score": 20,
              "evaluation_focus": "可复现性",
              "scoring_hint": "高分：一键运行与日志；中分：需手工改路径；低分：无法复现。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "残差与加权RMS/信噪比",
              "description": "报告加权RMS、解释度、空间分布，比较不同λ_b、λ_i的残差变化与过拟合迹象。",
              "score": 30,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：定量对比并讨论偏差结构；中分：只报整体RMS；低分：无残差分析。"
            },
            {
              "sub_criteria": "B(x)平滑性与物理合理性",
              "description": "检查B(x)是否平滑并与已知近岸/陆缘特征一致，无与地形不符的震荡。",
              "score": 25,
              "evaluation_focus": "物理一致",
              "scoring_hint": "高分：结合ETOPO5解释结构；中分：主观描述；低分：明显伪影未说明。"
            },
            {
              "sub_criteria": "I_p谱一致性与波长检验",
              "description": "验证I_p沿轨主波长落在λ1±带宽，功率谱峰显著，跨轨平滑合理。",
              "score": 25,
              "evaluation_focus": "谱验证",
              "scoring_hint": "高分：谱峰与带通一致并量化显著性；中分：大致匹配；低分：偏离严重或无检验。"
            },
            {
              "sub_criteria": "不确定度与敏感性报告",
              "description": "报告后验协方差/MC区间，给出对Δρ/ρ、λ_b、λ_i的敏感性曲线或表格。",
              "score": 20,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：含至少一条敏感性曲线；中分：定性讨论；低分：无不确定度与敏感性。"
            }
          ]
        }
      }
    },
    "3": {
      "subtask": "子任务 3 的目标是从给定的点位潮汐调和常数（每个观测点的复调和常数 H_p^m 或等价的振幅/相位及其协方差）、观测点位置与地形（水深格网与陆地掩膜）、以及用于独立验算的潮位站调和常数出发，构建可发布的南海范围内每个主要分潮（M2、S2、K1、O1）的空间场（同潮图：复调和常数或振幅场与相位场）并对结果进行定量验证与不确定度量化；为此应按以下步骤实施：一是数据准备与投影：将点位坐标投影到局部笛卡尔网格，应用陆地掩膜剔除陆上点，检查并统一复值表示（优先使用复数形式 H = A e^{iφ}，或实虚部），对相位进行环绕展开以避免插值伪影并保留协方差信息用于加权；二是网格与分辨率设计：明确输出栅格（经纬或投影坐标）分辨率并确保与观测空间密度与内潮尺度相匹配，设置近岸缓冲区处理规则以避免陆地外推；三是插值/拟合方法选择：优先采用带物理先验和不确定度传递能力的协方差驱动方法（如克里金/高斯过程回归），协方差函数可设计为各向异性且与水深相关的尺度函数 L(depth)（允许沿轨方向短尺度、跨轨方向长尺度的各向异性），同时提供薄板样条与低阶基展开（球谐或多项式）作为备用或快速替代；在插值复数调和常数时可直接对复数场进行克里金或分别对实部与虚部插值并在结果处重建振幅与相位，但必须处理相位连续性问题；四是超参数标定与正则化：用留一交叉验证（LOO）、K 折或最大似然估计确定协方差超参数（方差、相关尺度、各向异性方向）及平滑/正则化强度，必要时采用留轨（按卫星轨道）和留站两类交叉验证以评估对不同采样模式的稳健性，并用 L-curve、AIC/BIC 或预测误差作为判据；五是不确定度传播：利用点位协方差矩阵在克里金框架内解析得到栅格后验协方差以生成每像元的置信区间；若点位协方差不可用或模型非线性，则采用蒙特卡洛法或自举：从每点的联合误差分布中抽样生成若干实现并分别插值以统计输出分布；六是内潮/高频残差处理与输出合成：若输入包括已分离的平滑正压场与沿轨残差，则将两部分按物理规则在栅格上合成（先插值平滑场，再按轨延拓或用模态基在跨轨方向平滑内潮残差并加回），否则在插值前对点位数据采用空间带通或协方差滤波以避免将细尺度内潮误解释为大尺度场；七是验证与诊断：在潮位站位置进行独立预测并计算评价指标（偏差 bias、均方根误差 RMSE、相位误差（度）与向量差、相关系数 R、标准化残差分布），同时做留一/留轨交叉验证报告，输出残差的空间分布图、功率谱或空间自相关以检测未建模的细结构或过度平滑；八是成果与交付物：生成每分潮的复调和常数栅格（或振幅与相位栅格）、对应的不确定度栅格、验证统计报告、残差与诊断图、以及用于再现的插值/协方差模型参数与超参数选择记录；九是建议的实现工具与数值注意事项：可采用 Python（numpy/scipy、pykrige/GSTools、scikit-learn）、R（gstat、fields）或 MATLAB（Kriging/fit functions）等成熟库并利用并行化处理大规模蒙特卡洛采样，注意对观测稀疏区与近岸区域采取保守外推策略以避免非物理插值。该子任务的交付应包含可重复的代码或脚本、明确的输入/输出格式、以及完整的超参数选择与交叉验证记录，以便独立复现和客观评价同潮图的精度与不确定性。",
      "criteria": {
        "task_understanding": {
          "core_goal": "拟合并评估南海范围内 M2、S2、K1、O1 分潮的空间同潮图（复调和常数场），并对潮位站进行独立验证与不确定度量化",
          "expected_output": "每分潮的复调和常数栅格（或振幅/相位栅格）、对应后验不确定度栅格、独立验潮站与交叉验证（留一/留轨）报表（bias/RMSE/相位误差/向量差/R）、插值模型与协方差超参数记录、可复现代码与IO规范",
          "key_inputs_constraints": "输入：H_p^m（复数或A/φ及协方差）、观测点经纬与ETOPO5水深/陆地掩膜、潮位站调和常数；约束：相位需环绕展开、陆地不外推或有近岸缓冲、输出栅格分辨率与观测密度/内潮尺度匹配、协方差驱动（克里金/GPR）优先并能传递不确定度；前置：坐标投影一致、复值表示统一、异常/内潮高频处理策略明确",
          "modeling_type": "拟合+评价",
          "role_in_pipeline": "作为空间建模与发布环节：前序依赖子任务1的点位谐和常数与协方差、（可选）子任务2的正压/内潮分离；后续为同潮图发布、情景分析与数值模型开边界构建",
          "assumptions": "如缺少完整协方差则用点位方差信息或经验噪声模型；若未提供已分离的内潮残差，则在插值前对数据做空间带通或各向异性协方差抑制细尺度"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "明确同潮图拟合对象与复调和常数 H= A e^{iφ}",
              "description": "准确指出目标为M2、S2、K1、O1四分潮的复数场拟合（或实/虚部）而非仅振幅；阐明需生成空间同潮图而不是时间域提取。",
              "score": 30,
              "evaluation_focus": "任务界定",
              "scoring_hint": "高分：明确复数场/相位展开与不确定度；中分：只提振幅或相位之一；低分：混淆时间谐和提取与空间插值"
            },
            {
              "sub_criteria": "输入与约束识别（H_p^m协方差、ETOPO5、潮位站）",
              "description": "列全关键输入并强调陆地掩膜、近岸缓冲、投影一致性与相位环绕处理。",
              "score": 30,
              "evaluation_focus": "需求解析",
              "scoring_hint": "高分：逐项列出并解释作用；中分：缺1–2项或无约束阐述；低分：输入不全或无掩膜/投影考虑"
            },
            {
              "sub_criteria": "验证与不确定度目标识别（bias/RMSE/φ误差/后验方差）",
              "description": "明确需对潮位站独立验算与交叉验证，并输出后验不确定度栅格。",
              "score": 40,
              "evaluation_focus": "评价目标",
              "scoring_hint": "高分：列出bias/RMSE/向量差/R和交叉验证类型；中分：仅RMSE；低分：无量化验证或不确定度"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "复值表示与相位环绕展开复述",
              "description": "用任务语言重述需统一H=A e^{iφ}或实/虚部，并进行相位unwrap避免插值伪影。",
              "score": 30,
              "evaluation_focus": "精确表达",
              "scoring_hint": "高分：给出unwrap策略（沿邻近或最小跳变）；中分：仅口头提及；低分：未提导致相位跳变"
            },
            {
              "sub_criteria": "网格与分辨率设计与近岸缓冲复述",
              "description": "说明输出栅格分辨率与观测密度/内潮尺度匹配，设置陆缘缓冲/不外推规则。",
              "score": 35,
              "evaluation_focus": "约束转述",
              "scoring_hint": "高分：定量建议（如10–25 km）与缓冲宽度；中分：笼统描述；低分：未提或外推至陆地"
            },
            {
              "sub_criteria": "协方差驱动插值与交叉验证复述",
              "description": "强调克里金/GPR优先、各向异性、留一/留轨与超参数标定。",
              "score": 35,
              "evaluation_focus": "方法复述",
              "scoring_hint": "高分：点名留轨与ML/LOO；中分：仅说交叉验证；低分：无验证或仅主观选参"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "观测误差与点位协方差假设",
              "description": "说明若缺联合协方差，采用方差或对角噪声并给出量级/来源；考虑空间异方差。",
              "score": 30,
              "evaluation_focus": "不确定性",
              "scoring_hint": "高分：给定可检验噪声水平或来源；中分：泛化常数噪声；低分：未说明误差模型"
            },
            {
              "sub_criteria": "各向异性与水深相关尺度 L(depth) 假设",
              "description": "提出沿轨短、跨轨长的相关尺度，并随水深/地形变化的函数形式。",
              "score": 35,
              "evaluation_focus": "物理先验",
              "scoring_hint": "高分：给出函数或分段规则；中分：仅口头各向异性；低分：各向同性且无深度依赖"
            },
            {
              "sub_criteria": "内潮/高频处理假设",
              "description": "若无分离输入，声明采用带通或协方差滤波以抑制细尺度对大尺度场的污染。",
              "score": 35,
              "evaluation_focus": "数据假设",
              "scoring_hint": "高分：说明带宽或滤波器与理由；中分：模糊提及；低分：未处理导致伪影"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "克里金/高斯过程核与各向异性建模",
              "description": "构建对复数场或实/虚部的协方差核，含方差、相关尺度、方向角、深度依赖。",
              "score": 35,
              "evaluation_focus": "模型设定",
              "scoring_hint": "高分：明确核型（Matérn等）和参数；中分：未给方向/深度细节；低分：简单RBF无说明"
            },
            {
              "sub_criteria": "相位连续性处理策略",
              "description": "在模型中说明相位unwrap或在复数域插值避免2π跳变。",
              "score": 25,
              "evaluation_focus": "数值细节",
              "scoring_hint": "高分：陈述具体unwrap与边界处理；中分：仅提需处理；低分：忽略导致相位断裂"
            },
            {
              "sub_criteria": "近岸缓冲与掩膜约束",
              "description": "在构建时明确海陆掩膜、缓冲区、保守外推规则（如距离/水深阈值）。",
              "score": 20,
              "evaluation_focus": "约束实现",
              "scoring_hint": "高分：定量阈值与执行方法；中分：口头；低分：未实现或越岸外推"
            },
            {
              "sub_criteria": "不确定度传播框架",
              "description": "定义克里金后验方差计算或蒙特卡洛/自举方案与样本量。",
              "score": 20,
              "evaluation_focus": "误差传播",
              "scoring_hint": "高分：给公式或采样规模≥200；中分：仅说明会做；低分：无不确定度输出"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "超参数标定（ML/LOO/K折、留轨）",
              "description": "采用最大似然或交叉验证选择核方差/尺度/各向异性，并含留一与留轨对比。",
              "score": 40,
              "evaluation_focus": "选参策略",
              "scoring_hint": "高分：给出最优化方法与收敛准则；中分：仅粗调；低分：手工拍脑袋"
            },
            {
              "sub_criteria": "数值稳定性与大规模求解",
              "description": "说明数值线性代数实现（Cholesky/PCG/近似GPR）与并行/分块策略。",
              "score": 30,
              "evaluation_focus": "数值算法",
              "scoring_hint": "高分：指出O(N^3)问题与近似（SKI/Nyström）；中分：仅提Cholesky；低分：忽略复杂度"
            },
            {
              "sub_criteria": "复数场插值与重建一致性",
              "description": "若分开插值实/虚部，说明重建A, φ及相位包络一致性检查。",
              "score": 30,
              "evaluation_focus": "实现正确性",
              "scoring_hint": "高分：含幅相一致性与物理范围检查；中分：仅重建；低分：产生非物理相位跳变"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "数据准备与投影/掩膜流水线",
              "description": "代码完成坐标投影、陆地掩膜、近岸缓冲、相位unwrap的可复现流程。",
              "score": 30,
              "evaluation_focus": "工程化",
              "scoring_hint": "高分：脚本化+参数化配置；中分：手工步骤；低分：缺组件或不可复现"
            },
            {
              "sub_criteria": "协方差/克里金实现与超参数记录",
              "description": "使用成熟库（pykrige/GSTools/GPy/Matlab）并保存核类型与参数到元数据。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：版本锁定与随机种子；中分：缺元数据；低分：自写不稳或无记录"
            },
            {
              "sub_criteria": "不确定度与交叉验证自动化",
              "description": "自动计算后验方差与LOO/留轨评分（RMSE/向量差）并输出报表。",
              "score": 25,
              "evaluation_focus": "可重复性",
              "scoring_hint": "高分：一键生成表图；中分：部分手工；低分：无自动验证"
            },
            {
              "sub_criteria": "输出规范与边界处理",
              "description": "导出每分潮A/φ或复数栅格与掩膜，边界NaN处理一致。",
              "score": 15,
              "evaluation_focus": "I/O规范",
              "scoring_hint": "高分：含CF风格/投影信息；中分：基本栅格；低分：坐标混乱或无掩膜"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "潮位站独立验证（bias/RMSE/相位误差/向量差/R）",
              "description": "在站点预测并量化误差，分潮分别报告并讨论差异。",
              "score": 35,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：全指标+分潮对比；中分：部分指标；低分：缺独立验证"
            },
            {
              "sub_criteria": "交叉验证（留一/留轨）稳健性评估",
              "description": "报告LOO与留轨误差并分析采样模式影响与过拟合/过平滑迹象。",
              "score": 25,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：两类CV并解释差异；中分：单一CV；低分：未做CV"
            },
            {
              "sub_criteria": "不确定度栅格与空间诊断",
              "description": "展示后验方差/置信区间与残差空间分布、空间自相关或谱诊断。",
              "score": 25,
              "evaluation_focus": "不确定性",
              "scoring_hint": "高分：方差与残差图一致且合理；中分：仅方差或残差其一；低分：无诊断"
            },
            {
              "sub_criteria": "物理一致性与近岸行为审查",
              "description": "检查与已知潮汐特征/地形关系（如大陆架放大、盆地节点）的一致性与近岸外推是否受控。",
              "score": 15,
              "evaluation_focus": "物理校验",
              "scoring_hint": "高分：列举区域性一致性与异常解释；中分：泛泛而谈；低分：明显非物理但未说明"
            }
          ]
        }
      }
    },
    "4": {
      "subtask": "子任务4（敏感性分析、稳健性检验与可扩展性改进）的目标是系统、可重复地量化并最小化模型与数据处理管线中所有关键超参数、假设和数据质量问题对最终潮汐/内潮分解与插值结果的影响，并提出明确的改进与实现建议；为此该子任务应独立完成下列工作流程：一是明确输入与可变集——接收经预处理的点位复调和常数及其协方差矩阵、观测点位置、ETOPO5 水深栅格、潮位站基准数据以及任何用于先验（如模态波速估计）的参数范围；二是列出需敏感性检验的超参数和假设清单（例如正压潮平滑强度 λ_b、内潮正则化 λ_i、沿轨带通中心波长与带宽 λ_c、平滑/基函数阶数 k、协方差尺度函数 L(depth)、时间分段长度、近岸数据筛选阈值与观测权重策略）；三是设计并实施系统化试验方案——对每个超参数做有控制的单变量扫描与多变量格点搜索，并结合留一/留轨/留站交叉验证、K 折验证、以及基于预测误差的模型选择指标（交叉验证误差、AIC/BIC、L-curve 曲线拐点），记录每组设置下的判据（振幅 RMSE、相位误差（度）、偏差、归一化残差分布、相关系数、功率谱与相干性、以及对潮位站的独立预测误差）；四是数据质量敏感性试验——系统模拟并评估近岸陆地污染、轨道定位偏差、缺测与不规则采样、不同噪声水平与非潮汐周期成分对反演结果的影响（通过在原始时间序列或点位 H 上注入合成误差或随机丢点实现），并确定对观测权重或剔除规则的定量阈值；五是合成检验与性能边界识别——用多组已知参数的合成试验（在真场中注入合成正压潮+若干幅值/波长/相位的内潮分量并加入噪声）评估方法的检出率、误检率、灵敏度阈值和定位精度，绘制 ROC 曲线或检出概率随内潮振幅/波长的变化曲线；六是比较不同方法与正则化形式——在同一数据集上并行实现并比较若干替代方案（纯空间低通/高通滤波、沿轨带通滤波+样条幅度拟合、EOF/SSA 模态分解、基于协方差的克里金/GP 以及基于物理模态先验的混合正则化），用相同验证指标量化各自优劣与适用情形；七是不确定性传播与稳健性评估——采用蒙特卡洛重采样、自举与（如计算资源允许）近似贝叶斯方法（变分贝叶斯或 MCMC 的简化实现）来量化最终场的置信区间与参数后验分布，并检验结果对随机种子、初值与迭代收敛容忍度的敏感性；八是计算实现与可扩展性要求——为大规模网格搜索、蒙特卡洛和多方法比较采用并行化策略（按点/按轨/按超参数并行），推荐使用数值库与算法如 FFT/Welch（空间谱）、SVD/QR（稳健线性解）、LSQR/CG（迭代稀疏线性求解）、以及 Python（numpy/scipy、dask）、MATLAB、或高性能 C++/Fortran + MPI 实现，并给出内存、CPU 与并行度估算及收敛判据（例如目标函数相对变化 < 1e-4 或超参数改变量低于阈值）；九是结果整理与决策规则——基于上述试验给出一套推荐的默认超参数、数据筛选规则和方法选择指南（并提供在不同数据覆盖/噪声情形下的备选方案），同时生成完整的诊断输出（超参数敏感性图、交叉验证曲面、合成实验 ROC、残差与谱图、及对潮位站的独立验证汇总），并在可复现的代码包中记录所有随机种子、版本信息与参数集合以便审查与复现。该子任务仅产出敏感性分析、稳健性结论、推荐参数与实施规范及可复现的测试和验证脚本，不产生或讨论最终的潮汐场解本身。",
      "criteria": {
        "task_understanding": {
          "core_goal": "系统评估与优化潮汐/内潮分解与插值流程的超参数与假设对结果的影响，并通过敏感性分析、稳健性检验与可扩展性优化最小化误差与不确定度。",
          "expected_output": "超参数敏感性曲面与L-curve图、交叉验证与独立潮位站误差报表（RMSE/相位误差/偏差/相关系数）、合成试验ROC/检出概率曲线、蒙特卡洛/自举的不确定度区间、推荐默认超参数与筛选规则清单、并行计算配置与收敛判据、可复现脚本与随机种子/版本记录。",
          "key_inputs_constraints": "输入：点位复调和常数H及协方差、观测位置、ETOPO5水深、潮位站基准、先验（模态波速/波长范围）。约束：记录需包含协方差或可估计噪声；超参数范围需物理合理（如λ_b、λ_i>0；带通中心波长与带宽基于两层模型）；交叉验证需含留轨/留站；并行资源受CPU/内存限制且需收敛阈值。",
          "modeling_type": "评价+优化",
          "role_in_pipeline": "作为空间分解与插值后的验证与调参环节，依赖前序子任务1（单点时域谐和提取）与子任务2（正压潮/内潮分解）及子任务3（插值设定）的中间产物；输出推荐参数与稳健性证据供最终同潮图与方法定版。",
          "assumptions": "若部分点位缺协方差则以残差方差替代；计算资源允许进行至少10^2–10^3规模的超参数组合扫描与≥200次蒙特卡洛重采样；潮位站数据可作为独立验证集。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "识别关键超参数与假设（λ_b、λ_i、带通中心波长/带宽、基函数阶数k、协方差尺度L(depth)、近岸筛选阈值、观测权重）",
              "description": "是否完整列出并定义影响潮汐/内潮分解与插值的核心超参数与数据质量假设，给出取值范围与物理依据。",
              "score": 35,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：≥7项超参数含取值域与物理理由；中分：列出4–6项且部分缺范围；低分：≤3项或无范围/理由。"
            },
            {
              "sub_criteria": "明确评价指标（RMSE、相位误差、偏差、R、谱相干、留轨/留站CV）",
              "description": "是否针对H（复数）定义向量误差与独立潮位站验证指标，并区分沿轨与跨轨评估。",
              "score": 25,
              "evaluation_focus": "指标设计",
              "scoring_hint": "高分：包含复向量误差与留轨/留站；中分：仅标量RMSE或缺独立集；低分：未定义可计算指标。"
            },
            {
              "sub_criteria": "可扩展性目标与资源约束",
              "description": "是否识别并量化并行维度（按轨/按点/按超参数）、CPU/内存需求与收敛判据。",
              "score": 20,
              "evaluation_focus": "工程意识",
              "scoring_hint": "高分：给出并行策略与资源估算；中分：仅描述并行方向；低分：未提资源与收敛。"
            },
            {
              "sub_criteria": "数据质量问题枚举（陆污染、定位偏差、缺测、非潮成分）",
              "description": "是否覆盖主要数据问题及其潜在影响路径。",
              "score": 20,
              "evaluation_focus": "风险识别",
              "scoring_hint": "高分：≥4类并说明影响；中分：2–3类；低分：1类或泛泛而谈。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "与核心目标对齐的复述（评价+优化）",
              "description": "是否将任务表述为通过系统敏感性分析优化λ_b/λ_i/带通参数等以最小化误差与不确定度。",
              "score": 30,
              "evaluation_focus": "表达精准",
              "scoring_hint": "高分：明确“评价+优化”及对象；中分：仅评价或仅优化；低分：偏离目标。"
            },
            {
              "sub_criteria": "输入输出边界清晰（H、协方差→推荐参数与报告）",
              "description": "是否准确限定输入（H及Cov、ETOPO5、潮位站）与输出（推荐参数、图表、脚本）。",
              "score": 30,
              "evaluation_focus": "需求界定",
              "scoring_hint": "高分：输入输出成对完整；中分：缺1–2项；低分：模糊不清。"
            },
            {
              "sub_criteria": "与前后序子任务接口描述",
              "description": "是否说明依赖子任务1/2/3的产物及对后续定版的支撑。",
              "score": 20,
              "evaluation_focus": "流程意识",
              "scoring_hint": "高分：点名1/2/3及产物；中分：仅泛指依赖；低分：未提接口。"
            },
            {
              "sub_criteria": "范围限定（不产生最终场解）",
              "description": "是否强调本任务只产出敏感性与推荐，不输出最终同潮图。",
              "score": 20,
              "evaluation_focus": "边界把控",
              "scoring_hint": "高分：明确声明并遵守；中分：偶有越界；低分：大量越界产出。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "物理先验与带通设定（两层模型波速→中心波长/带宽）",
              "description": "是否用两层近似（c1^2≈g' h1 h2/(h1+h2)）设定内潮带通区间并做敏感性范围。",
              "score": 35,
              "evaluation_focus": "物理建模",
              "scoring_hint": "高分：公式+参数范围+敏感性；中分：仅经验范围；低分：无依据。"
            },
            {
              "sub_criteria": "统计假设（噪声分布、独立性、协方差有效性）",
              "description": "是否声明噪声模型与当协方差缺失时的替代估计。",
              "score": 25,
              "evaluation_focus": "统计假设",
              "scoring_hint": "高分：给出检验或稳健方案；中分：口头假设；低分：未说明。"
            },
            {
              "sub_criteria": "正则化先验（λ_b平滑、λ_i谱稀疏/沿轨平滑）",
              "description": "是否明确L_b/L_i形式（拉普拉斯/二阶差分/带通约束）及可接受范围。",
              "score": 25,
              "evaluation_focus": "正则选择",
              "scoring_hint": "高分：算子与范围清晰；中分：仅名称无细节；低分：未定义。"
            },
            {
              "sub_criteria": "验证分割假设（留轨/留站独立性）",
              "description": "是否说明分割策略避免信息泄漏。",
              "score": 15,
              "evaluation_focus": "实验设计",
              "scoring_hint": "高分：明确留轨/留站理由；中分：仅K折；低分：未分割或泄漏。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "试验设计（单变量扫描+多变量格点/贝叶斯优化）",
              "description": "是否系统化探索λ_b、λ_i、带通参数、k、L(depth)等并记录网格密度与范围。",
              "score": 30,
              "evaluation_focus": "实验设计",
              "scoring_hint": "高分：单+多变量并含范围密度；中分：仅其一；低分：随意试参。"
            },
            {
              "sub_criteria": "交叉验证与模型选择（LOO/K折、留轨/留站、AIC/BIC、L-curve）",
              "description": "是否定义统一目标函数与多指标并用折中策略选优。",
              "score": 30,
              "evaluation_focus": "模型选择",
              "scoring_hint": "高分：≥2类CV+信息准则；中分：单一CV；低分：无系统准则。"
            },
            {
              "sub_criteria": "数据质量敏感性模拟（注入误差/丢点/定位偏差）",
              "description": "是否在原始时序或H上注入可控扰动并量化阈值。",
              "score": 25,
              "evaluation_focus": "鲁棒性",
              "scoring_hint": "高分：≥3类扰动+阈值建议；中分：1–2类；低分：未做。"
            },
            {
              "sub_criteria": "合成试验与ROC/检出概率",
              "description": "是否构建真场+内潮分量+噪声的合成集并产出ROC或检出-振幅/波长曲线。",
              "score": 15,
              "evaluation_focus": "仿真评测",
              "scoring_hint": "高分：ROC或曲线齐全；中分：仅定性；低分：缺失。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "稳健求解与正则化路径（SVD/QR、LSQR/CG、Tikhonov）",
              "description": "是否采用稳健线性解法并展示正则化路径或L-curve拐点。",
              "score": 35,
              "evaluation_focus": "数值稳定",
              "scoring_hint": "高分：实现+拐点判定；中分：仅调用解器；低分：病态未处理。"
            },
            {
              "sub_criteria": "并行与可扩展性（按轨/点/超参数并行）",
              "description": "是否实现并行并报告加速比、CPU/内存占用、批处理规模。",
              "score": 25,
              "evaluation_focus": "性能工程",
              "scoring_hint": "高分：量化加速与资源；中分：并行但无数据；低分：串行且缓慢。"
            },
            {
              "sub_criteria": "收敛与停止准则（目标函数相对变化<1e-4等）",
              "description": "是否给出通用收敛阈值与最大迭代、失败回退策略。",
              "score": 20,
              "evaluation_focus": "算法控制",
              "scoring_hint": "高分：阈值+回退；中分：仅阈值；低分：无限迭代或随意停止。"
            },
            {
              "sub_criteria": "不确定性传播（蒙特卡洛/自举/近似贝叶斯）",
              "description": "是否实现对最终场或指标的置信区间估计并报告样本量与稳定性。",
              "score": 20,
              "evaluation_focus": "不确定度",
              "scoring_hint": "高分：≥200次采样+稳定性检验；中分：50–200次；低分：未评估或不收敛。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "可复现性（随机种子、版本、参数清单、元数据日志）",
              "description": "是否在脚本中固化随机种子、记录库版本与全部超参数组合及结果摘要。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：一键重现与完整日志；中分：部分记录；低分：不可复现。"
            },
            {
              "sub_criteria": "模块化与并行框架（numpy/scipy+dask或MPI，FFT/SVD/LSQR调用）",
              "description": "是否模块化实现试验、求解、评估与绘图，合理调用数值库并行执行。",
              "score": 25,
              "evaluation_focus": "工程实现",
              "scoring_hint": "高分：清晰模块+并行落地；中分：模块化但串行；低分：脚本拼接混乱。"
            },
            {
              "sub_criteria": "性能与资源管理（批量、缓存、内存占用控制）",
              "description": "是否采用批处理/缓存，避免OOM，报告运行时间与资源曲线。",
              "score": 20,
              "evaluation_focus": "性能优化",
              "scoring_hint": "高分：稳定运行并量化耗时/内存；中分：可运行但不稳定；低分：频繁崩溃。"
            },
            {
              "sub_criteria": "自动化验证与单元测试（CV拆分、指标计算、绘图）",
              "description": "是否提供最小单元测试和集成检查，防止指标/分割错误。",
              "score": 25,
              "evaluation_focus": "质量保障",
              "scoring_hint": "高分：覆盖关键函数并CI式检查；中分：少量测试；低分：无测试。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "敏感性与交叉验证结果解读（误差随λ_b、λ_i、带通变化曲面）",
              "description": "是否展示并解释误差曲面与最优区间，讨论过拟合/欠拟合迹象。",
              "score": 30,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：多维曲面+明确最优带；中分：单维曲线；低分：仅口述。"
            },
            {
              "sub_criteria": "合成试验与ROC/检出阈值结论",
              "description": "是否量化检出率、误检率、最小可检内潮振幅/波长范围。",
              "score": 20,
              "evaluation_focus": "诊断量化",
              "scoring_hint": "高分：ROC+AUC或阈值数值；中分：定性描述；低分：无量化。"
            },
            {
              "sub_criteria": "独立潮位站验证与误差分解（bias/RMSE/相位误差/向量差）",
              "description": "是否报告留站预测表现并区分区域/水深段的误差来源。",
              "score": 25,
              "evaluation_focus": "外部验证",
              "scoring_hint": "高分：分区统计+多个指标；中分：总体指标；低分：无独立验证。"
            },
            {
              "sub_criteria": "推荐默认超参数与规则及适用情景",
              "description": "是否给出λ_b、λ_i、带通、k、L(depth)、筛选阈值的默认值与场景化替代方案。",
              "score": 25,
              "evaluation_focus": "决策输出",
              "scoring_hint": "高分：默认+备选+触发条件；中分：仅默认；低分：无明确建议。"
            }
          ]
        }
      }
    }
  }
}