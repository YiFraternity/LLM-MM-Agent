{
  "task_id": "2021_B",
  "problem": "请你们团队根据问题要求，基于一次预报数据及实测数据（见附件）进行空气质量预报二次数学建模，完成以下四个问题。请注意，实际工作中会遇到数据为空值或异常值的情况（见附录），故要求建立的模型具有一定的鲁棒性。\n\\textbf{问题1.} 使用附件1中的数据，按照附录中的方法计算监测点A从2020年8月25日到8月28日每天实测的AQI和首要污染物，将结果按照附录“AQI计算结果表”的格式放在正文中。\n\n\\textbf{问题2.} 在污染物排放情况不变的条件下，某一地区的气象条件有利于污染物扩散或沉降时，该地区的AQI会下降，反之会上升。使用附件1中的数据，根据对污染物浓度的影响程度，对气象条件进行合理分类，并阐述各类气象条件的特征。\n\n\\textbf{问题3.} 使用附件1、2中的数据，建立一个同时适用于A、B、C三个监测点（监测点两两间直线距离$>100\\text{km}$，忽略相互影响）的二次预报数学模型，用来预测未来三天6种常规污染物单日浓度值，要求二次预报模型预测结果中AQI预报值的最大相对误差应尽量小，且首要污染物预测准确度尽量高。并使用该模型预测监测点A、B、C在2021年7月13日至7月15日6种常规污染物的单日浓度值，计算相应的AQI和首要污染物，将结果依照附录“污染物浓度及AQI预测结果表”的格式放在论文中。\n\n\\textbf{问题4.} 相邻区域的污染物浓度往往具有一定的相关性，区域协同预报可能会提升空气质量预报的准确度。如图4，监测点A的临近区域内存在监测点A1、A2、A3，使用附件1、3中的数据，建立包含A、A1、A2、A3四个监测点的协同预报模型，要求二次模型预测结果中AQI预报值的最大相对误差应尽量小，且首要污染物预测准确度尽量高。使用该模型预测监测点A、A1、A2、A3在2021年7月13日至7月15日6种常规污染物的单日浓度值，计算相应的AQI和首要污染物，将结果依照附录“污染物浓度及AQI预测结果表”的格式放在论文中。并讨论：与问题3的模型相比，协同预报模型能否提升针对监测点A的污染物浓度预报准确度？说明原因。\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image.png}\n    \\caption{各监测站点相对位置示意图，正东方向为x轴，正北方向为y轴，单位：km}\n    \\label{fig:monitoring_sites}\n\\end{figure}\n\nA(0,0) \\quad A1(-14.4846, -1.9699) \\quad A2(-6.6716, 7.5953) \\quad A3(-3.3543, -5.0138)",
  "subtask": {
    "1": {
      "subtask": "子任务1（数据预处理、日标签构建与物理特征工程）要求将原始逐小时一次预报与实测数据清洗、校准并转换为可用于训练与验证的标准化小时级数据表和日级标签表，同时生成完整的物理启发特征字典与缺失/异常日志。具体工作范围和步骤如下：统一时序与单位——确认并统一所有时间戳到同一时区/本地小时、补齐缺失时间点的索引、去重并对变量单位做强制统一（例如 CO 以 mg/m³，所有颗粒物与气态污染物以 μg/m³），并在元数据中记录原始单元与转换公式；质控与异常值处理——对每个变量做基于移动窗口的鲁棒异常检测（如 Hampel 滤波或基于滚动中位数与 MAD 的方法，典型窗口 5–24 小时，阈值 3σ/MAD），对极端尖峰先做 winsorize（如 1st/99th 百分位截断）并保留原始值备审；短缺与长期缺失策略——对连续短缺段（≤6 小时）优先用时间线性或昼夜周期插值填补，插值时优先利用同日/相邻日同小时的统计周期性信息；对长期或复杂缺失（>6 小时或跨多变量缺失）采用模型化插补（例如 scikit‑learn 的 IterativeImputer/MICE 或 KNNImputer，回归器可选 LightGBM/RandomForest 以利用多变量相关性），对所有被插补字段同时生成二元缺失指示器以保留缺失信息；小时级派生与物理特征构造——将风速/风向转换为矢量分量 u,v（采用气象约定：u = −speed * sin(dir_rad)，v = −speed * cos(dir_rad)，dir 为来向角、单位为弧度），用边界层高度（PBL）与风速构造混合/稀释指数 M = PBL * (wind_speed + ε)（ε 为小正数以避免零），构造光化学促发指数 S = Shortwave * max(T − T_ref, 0) / (1 + RH) 及日累计短波辐射、感热/潜热比等与 O3 相关的物理量；构造降水/高湿/夜间标志（阈值可用训练期分位数确定，例如降水>0.1 mm/h、RH>90%）、昼夜与日照标志（基于短波辐射或小时编码）；时序统计特征——为每个污染物与关键气象量计算多尺度滞后与滑动统计（过去 24/48/72 小时的均值、方差、最大/最小与一阶差分）、标准化异常（滚动 z‑score），并生成逐小时周期编码（小时与日序的 sin/cos 循环编码）以保留昼夜季节周期性；空间与输送指示器（针对有邻站信息情形）——依据邻站经纬与两站方位角，结合本时刻风矢量计算方向性输送因子（如 wind_speed * cos(θ_wind − θ_bearing)）以表征从邻站到本站的可能输送量；残差/基线相关特征（仅作为数据层特征）——当小时实测与一次预报同时可得时计算并记录 obs − sim 的滞后值和统计量供后续模型特征使用；日级标签构建规则（严格、可追溯）——对于 SO2、NO2、PM10、PM2.5、CO 以当日 24 小时有效小时均值为日值，要求该日至少有 18 个有效小时（≥75%）否则该日标注为缺失；对于 O3，按规定计算自然日内所有 8 小时滑动平均并取最大值作为日值，计算每个 8 小时窗口时要求该窗口具有全部 8 小时有效数据（缺失窗口跳过），若没有任何完整窗口则日 O3 标注为缺失；基于题目表格实现 IAQI 的分段线性映射并产生 IAQI 向量、AQI（各 IAQI 的最大值）及首要污染物（若并列则并列列示）；可复现的数据质量准则与输出——输出（1）已清洗与统一的小时级数据表（含原始字段、插补/修正标志與缺失指示器）、（2）日级标签表（24h 平均或 O3 max‑8h、IAQI、AQI、首要污染物及每项是否因数据不足而标注缺失）、（3）完整特征字典（含构造公式与单位）、（4）数据质量报告与缺失/异常日志（包括每变量缺失率、填补方法与填补段位置），并建议工具链与实现细节：优先采用 pandas + numpy 进行时序对齐与基础操作，scikit‑learn 的 IterativeImputer/KNNImputer 与 SimpleImputer 做多变量插补，statsmodels 或自实现的移动窗口函数做滚动统计，保存输出为按站点分文件的压缩 parquet/CSV 与元数据 JSON，以便下游可直接加载与验证。",
      "criteria": {
        "task_understanding": {
          "core_goal": "构建并实现对一次预报与实测逐小时数据的清洗、统一与物理启发特征工程，生成标准化小时级训练数据与日级AQI/IAQI标签，并产出可追溯的数据质量与缺失日志以支持后续预测建模与评估。",
          "expected_output": "1) 站点分文件的小时级标准化数据表（含原始值、单位统一、插补/winsorize/异常标志、缺失指示器、派生物理与时序特征）；2) 日级标签表（SO2/NO2/PM10/PM2.5/CO的24h均值、O3日最大8小时、IAQI、AQI与首要污染物及缺失标识）；3) 特征字典与元数据JSON（单位、公式、参数）；4) 数据质量报告与缺失/异常日志；5) 复现脚本与配置。",
          "key_inputs_constraints": "输入：逐小时一次预报与实测数据（2019-04-16至2021-07-13），字段含污染物、气象（风速/风向/短波辐射/PBL/RH/降水/温度等）、时间戳与站点ID；约束：统一到同一时区本地小时；单位统一（CO mg/m³，其余 μg/m³）；缺失短缺≤6h优先周期/线性插值，>6h用MICE/KNN；O3标签按完整8h滑动窗口；日标签需≥18有效小时；记录转换公式与异常处理；保存为parquet/CSV与元数据JSON。",
          "modeling_type": "评价+拟合（数据清洗与特征工程）",
          "role_in_pipeline": "作为特征工程与标签构建环节，位于模型训练前；前序依赖原始一次预报与实测数据采集；后序任务为二次预报模型训练/验证、AQI预测与首要污染物评估。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "统一时序与单位（小时级、本地时区、CO mg/m³、其余 μg/m³）",
              "description": "是否明确识别到需将所有时间戳归一到本地小时并补齐索引，单位强制统一且记录转换公式与原始单位。",
              "score": 35,
              "evaluation_focus": "数据规范",
              "scoring_hint": "高分：给出具体时区、闰夏令处理、单位换算表；中分：仅口头说明或遗漏个别变量；低分：未统一或无记录。"
            },
            {
              "sub_criteria": "质控与异常检测（Hampel/MAD、winsorize）",
              "description": "是否识别到需要滚动中位数+MAD或Hampel方法与1/99分位截断处理尖峰并保留原值备审。",
              "score": 25,
              "evaluation_focus": "数据质量",
              "scoring_hint": "高分：说明窗口(5–24h)、阈值(3×MAD)与保留原值策略；中分：仅提及异常但无参数；低分：未设计异常处理。"
            },
            {
              "sub_criteria": "缺失分层策略（≤6h插值，>6h MICE/KNN）",
              "description": "是否区分短缺与长期缺失并匹配插补策略，且生成缺失指示器。",
              "score": 20,
              "evaluation_focus": "策略识别",
              "scoring_hint": "高分：明确6h阈值与周期插值细节、列出指示器；中分：仅单一插补；低分：忽略缺失类型。"
            },
            {
              "sub_criteria": "O3日最大8小时与日标签有效性规则",
              "description": "是否准确识别O3按完整8h窗口的max-8h，其他污染物24h均值且≥18有效小时的规则。",
              "score": 20,
              "evaluation_focus": "标准遵循",
              "scoring_hint": "高分：给出滑动窗口细节与有效小时门槛；中分：规则不完整；低分：误用日均或忽略有效性。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "核心目标复述（清洗+特征工程+日级AQI/IAQI标签）",
              "description": "是否用任务术语准确复述产生小时级特征表与日级AQI/IAQI标签表的目标与用途。",
              "score": 30,
              "evaluation_focus": "目标对齐",
              "scoring_hint": "高分：明确两张表及其下游用途；中分：只提一部分；低分：偏离目标。"
            },
            {
              "sub_criteria": "输入与约束复述（时区、单位、窗口阈值）",
              "description": "是否复述关键输入与约束：时区、单位、窗口与阈值、有效性门槛。",
              "score": 25,
              "evaluation_focus": "约束复盘",
              "scoring_hint": "高分：逐条复述并无冲突；中分：遗漏1–2项；低分：混淆或缺失。"
            },
            {
              "sub_criteria": "输出形态复述（parquet/CSV、元数据JSON、日志）",
              "description": "是否明确输出文件类型、分站点组织与可追溯元数据、日志内容。",
              "score": 25,
              "evaluation_focus": "交付定义",
              "scoring_hint": "高分：清晰列出并解释用途；中分：仅列类型；低分：未提文件与元数据。"
            },
            {
              "sub_criteria": "可复现性与审计需求",
              "description": "是否强调记录转换公式、参数、时间与随机种子以支持复现与审计。",
              "score": 20,
              "evaluation_focus": "复现性",
              "scoring_hint": "高分：给出种子、版本与配置；中分：泛述复现；低分：未涉及。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "时区与本地小时假设（含夏令时处理）",
              "description": "是否明确假设所有站点按统一本地时区，说明夏令时转折处理方式。",
              "score": 25,
              "evaluation_focus": "前提设定",
              "scoring_hint": "高分：给出IANA时区与DST策略；中分：仅称本地时区；低分：未说明导致对齐风险。"
            },
            {
              "sub_criteria": "插值与插补模型假设（平稳性与周期性）",
              "description": "是否说明短时线性/周期插值依赖的局部平稳与日周期存在的假设，长期用MICE/KNN利用多变量相关性假设。",
              "score": 25,
              "evaluation_focus": "建模假设",
              "scoring_hint": "高分：阐明何时失效及备选；中分：仅提相关性；低分：无假设说明。"
            },
            {
              "sub_criteria": "单位转换与传感器一致性假设",
              "description": "是否假设不同源数据的测量口径可通过单位与简单线性换算对齐并在元数据中记录。",
              "score": 25,
              "evaluation_focus": "数据假设",
              "scoring_hint": "高分：列出CO、O3、PM单位与温度压力影响说明；中分：仅写单位；低分：无记录。"
            },
            {
              "sub_criteria": "O3光化学特征公式参数假设（T_ref、阈值）",
              "description": "是否给出S指数中T_ref、RH阈值、降水阈值的设定依据（如分位数）。",
              "score": 25,
              "evaluation_focus": "参数设定",
              "scoring_hint": "高分：给出具体分位数或经验值；中分：泛化描述；低分：未设或与数据不符。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "异常检测模型（Hampel/MAD参数化）",
              "description": "是否构建基于滚动中位数与MAD的异常检测，明确窗口(5–24h)与阈值(3×)并保留原值与winsorize策略。",
              "score": 30,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：参数可配置并随变量调整；中分：固定参数；低分：缺失或不鲁棒。"
            },
            {
              "sub_criteria": "缺失插补模型（短缺插值+IterativeImputer/KNN）",
              "description": "是否分层采用线性/周期插值与MICE/KNN，含缺失指示器与多变量特征利用。",
              "score": 30,
              "evaluation_focus": "方法设计",
              "scoring_hint": "高分：说明特征集合、随机种子与约束；中分：仅单一方法；低分：简单均值填充。"
            },
            {
              "sub_criteria": "物理启发特征（u,v、M=PBL*(ws+ε)、S指数等）",
              "description": "是否正确从风向来向定义u,v，构造M与S、降水/RH/夜间标志、昼夜与季节编码。",
              "score": 25,
              "evaluation_focus": "特征工程",
              "scoring_hint": "高分：公式与单位自洽并验证边界；中分：缺少部分特征；低分：计算错误或遗漏关键量。"
            },
            {
              "sub_criteria": "时序统计与空间输送指示器",
              "description": "是否实现24/48/72h多尺度滞后、滚动统计与风向投影的方向性输送因子。",
              "score": 15,
              "evaluation_focus": "时空建模",
              "scoring_hint": "高分：窗口与对齐严谨；中分：只做部分窗口；低分：未实现或错位。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "日级标签计算（24h均值、O3 max-8h）",
              "description": "是否严格滑动计算O3 8小时并取最大，其他采用24h均值并执行≥18小时有效性判定与缺失标注。",
              "score": 40,
              "evaluation_focus": "规则执行",
              "scoring_hint": "高分：边界日与跨日窗口处理正确；中分：规则基本正确但边界有瑕疵；低分：违背规则。"
            },
            {
              "sub_criteria": "IAQI与AQI分段线性映射与首要污染物",
              "description": "是否根据表格实现IAQI映射、AQI=max(IAQI)并处理并列首要污染物与缺失传播。",
              "score": 30,
              "evaluation_focus": "标准实现",
              "scoring_hint": "高分：断点表可配置且含线性插值；中分：硬编码部分断点；低分：错误映射或忽略并列。"
            },
            {
              "sub_criteria": "残差特征计算（obs−sim滞后与统计）",
              "description": "在同小时实测与一次预报可得时，是否计算obs−sim及其滞后统计并对齐时间索引。",
              "score": 30,
              "evaluation_focus": "对齐与计算",
              "scoring_hint": "高分：对齐严谨并含多尺度统计；中分：仅当前残差；低分：遗漏或错位。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "pandas/numpy对齐与索引完整性（本地小时、重复与缺口处理）",
              "description": "是否用pandas实现时区本地化、重复去重、全时序重采样补齐并记录缺口。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：含单元测试或断言检查缺口；中分：基本实现；低分：索引错乱或静默失败。"
            },
            {
              "sub_criteria": "scikit-learn插补流水线（IterativeImputer/KNN + 指示器）",
              "description": "是否构建可复用Pipeline，包含数值标准化选择、插补器与缺失指示器生成，支持随机种子与特征选择。",
              "score": 30,
              "evaluation_focus": "工程化",
              "scoring_hint": "高分：封装良好、参数化、可持久化；中分：脚本化但可运行；低分：手写循环且脆弱。"
            },
            {
              "sub_criteria": "物理与时序特征高效实现（滚动窗口、向量化）",
              "description": "是否用rolling/expanding与向量化计算u,v、M、S和多尺度统计，避免低效for循环。",
              "score": 25,
              "evaluation_focus": "性能与正确性",
              "scoring_hint": "高分：O(N)实现且内存可控；中分：部分向量化；低分：显著低效或错误。"
            },
            {
              "sub_criteria": "输出与元数据/日志（parquet/CSV、JSON、参数记录）",
              "description": "是否按站点保存压缩parquet/CSV，生成JSON元数据与缺失/异常日志（位置、方法、参数）。",
              "score": 15,
              "evaluation_focus": "可追溯性",
              "scoring_hint": "高分：日志含时间段与方法；中分：仅总体统计；低分：无日志或不可复现。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "数据质量评估（缺失率、异常率、插补影响）",
              "description": "是否报告各变量缺失/异常率、插补覆盖与对分布的影响（如前后分位数/均值变化）。",
              "score": 35,
              "evaluation_focus": "结果解释",
              "scoring_hint": "高分：给出表格/图与量化差异；中分：定性描述；低分：无评估。"
            },
            {
              "sub_criteria": "特征合理性校验（物理一致性与相关性）",
              "description": "检查u,v方向、M与S与O3/污染物的相关性与符号是否符合物理预期。",
              "score": 25,
              "evaluation_focus": "一致性检验",
              "scoring_hint": "高分：提供相关系数/可视化；中分：定性说明；低分：未验证或明显不符。"
            },
            {
              "sub_criteria": "标签覆盖与有效性统计（≥18小时、O3窗口覆盖）",
              "description": "是否统计日标签可用比例、O3完整8h窗口比例与跨期稳定性。",
              "score": 20,
              "evaluation_focus": "标签质量",
              "scoring_hint": "高分：逐站点逐月份统计；中分：总体统计；低分：未统计。"
            },
            {
              "sub_criteria": "敏感性与稳健性（窗口/阈值变动）",
              "description": "评估窗口长度、阈值（3×MAD、降水/RH阈值）改变对数据质量与标签的影响。",
              "score": 20,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：对比两组参数并量化变化；中分：定性讨论；低分：无分析。"
            }
          ]
        }
      }
    },
    "2": {
      "subtask": "子任务2旨在以一次预报（WRF‑CMAQ 小时输出）为基线、通过学习实测与一次预报之间的残差来生成更准确的小时级污染物预测并支持日值聚合与首要污染物判定，其范围包括数据输入规范、特征构造、残差建模器设计与训练、模型选择与超参调优、封装输出与模型可解释性评估；目标是构建一个既能在单站点情形下独立运行也能通过共享参数实现多站点泛化的多任务时序残差学习模块，输出经校正的逐小时六类污染物预测并供后续按日聚合计算日均/臭氧最大8小时滑动平均等日值指标。具体方法与步骤：一是明确数据输入：逐小时一次预报的污染物与气象字段、截止可用时间点的逐小时实测污染物与可得气象观测、时间编码（小时/日/周/季节）、站点标识与经纬位置信息；二是构造特征向量：包括一次预报当前小时与未来可用时段的同变量、历史窗口（例如过去24/48/72小时）的一次预报与实测滞后统计量（均值、方差、最大/最小、差分）、物理启发派生量（如PBL×风速稀释指标、光化学促发指数、日累计短波、风向分量u/v及基于方位角的输送因子）、缺失指示位与站点嵌入；三是定义预测目标：逐小时残差 r_{t,j}=obs_{t,j}−sim_{t,j}（对每污染物 j），模型输出残差估计 r̂_{t,j} 以得到修正值 ŷ^{corr}=sim + r̂；四是模型架构与候选器：优先建立基线树式残差学习器（LightGBM 或 XGBoost，多输出或并行单输出），利用其对缺失值的天然鲁棒性与快速训练特性；并行开发深度时序模型（例如 Temporal Convolutional Network、LSTM 或轻量 Transformer）以更好捕捉长时依赖与日内周期性，架构采用共享基座加站点特异头的多任务设计以在多站点训练时共享信息；对存在显著空间耦合时可在输入中加入邻站滞后观测/预报特征或站点位置嵌入。五是损失与训练策略：采用多目标损失组合以直接服务任务关键指标，典型为小时级鲁棒损失（Huber/MAE）以降低异常值敏感性、对臭氧日值的最大8小时滑动平均添加专用惩罚项（在端到端训练中直接计算并反向传播或在微调阶段最小化该日聚合误差）、以及可选的日级AQI相对误差或首要污染物分类交叉熵/聚焦损失以提升分类准确率；训练时严格使用滚动起点（rolling origin）时序交叉验证以避免未来观测泄露，使用早停、L2正则与学习率调度防过拟合。六是超参数优化与模型选择：采用贝叶斯优化工具（如 Optuna）或网格搜索调参，选择基于验证集上小时 MAE/RMSE、日级 AQI 平均相对误差与首要污染物 F1 的综合指标进行模型排序；七是模型集成与后处理：对表现互补的模型采用加权平均或堆叠元学习器融合（例如以小型回归器学习各模型输出的融合权重），对最终小时预测施加物理约束（非负、按合理上界裁剪）并在必要时用简单后处理校准日聚合偏差；八是缺失与异常处理机制：在训练/推理中保留缺失标志，树模型直接处理缺失，深度模型对缺失字段采用掩码并在输入层或填补后训练，训练集中通过数据增强（随机遮挡）提高模型对实测缺失的鲁棒性；九是评估指标与可解释性：在验证过程中记录小时级 MAE/RMSE、日级 AQI 平均相对误差及其分位数、首要污染物准确率/召回/F1、污染天气事件检出率与误报率，并用 SHAP 或特征重要性分析解释树模型的关键驱动因子以便诊断与运营决策。实现技术栈推荐使用 pandas/numpy 做数据处理，scikit‑learn 做预处理与基线工具，LightGBM/XGBoost 做树模型，PyTorch 或 TensorFlow/Keras 实现深度时序模型，Optuna 做超参搜索，SHAP 做解释性分析；最终交付物为训练好的残差模型（可部署版本）、验证报告与经校正的逐小时输出接口。",
      "criteria": {
        "task_understanding": {
          "core_goal": "基于一次预报与实测数据的历史窗口与物理特征，预测并拟合逐小时六类污染物的残差r=obs−sim，通过残差学习校正一次预报以优化小时级预测并支持日值AQI与首要污染物判定的评估。",
          "expected_output": "经校正的逐小时六污染物预测序列（ŷ^{corr}）、训练好的残差模型文件（LightGBM/XGBoost/深度时序）、验证报告（小时MAE/RMSE、日级AQI相对误差、首要污染物F1）、特征重要性/SHAP图表、推理接口与配置（站点泛化参数）。",
          "key_inputs_constraints": "输入：逐小时一次预报(sim)污染物与气象、逐小时实测(obs)污染物与可得气象、时间编码（小时/日/周/季节）、站点ID与经纬度；约束：严格滚动起点交叉验证避免未来泄露；缺失用指示器与模型内处理；输出需物理约束（非负与合理上界）；目标包含O3最大8小时滑动平均误差与AQI相对误差的联合度量。",
          "modeling_type": "预测+拟合+评价",
          "role_in_pipeline": "作为二次建模核心训练模块，位于数据预处理与特征工程（子任务1）之后、日级聚合与AQI计算之前；前序依赖清洗与日/小时标签与特征字典，后序为日值聚合、AQI与首要污染物评估及情景预测部署。",
          "assumptions": "多站点联合训练采用共享基座+站点特异头；树模型与深度模型均可候选，至少需给出一个强基线（LightGBM）；O3日值损失采用离线微调或代理损失近似。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "明确残差r=obs−sim预测目标与小时级六污染物",
              "description": "是否准确将任务核心定义为对逐小时残差进行预测以校正一次预报，并覆盖SO2、NO2、PM10、PM2.5、O3、CO六类。",
              "score": 35,
              "evaluation_focus": "建模思维",
              "scoring_hint": "高分：清晰写出r_{t,j}=obs−sim并逐类建模；中分：提到残差但未公式化或缺少部分污染物；低分：直接预测obs而忽略残差学习。"
            },
            {
              "sub_criteria": "识别评估指标：小时MAE/RMSE与日级AQI相对误差及首要污染物F1",
              "description": "能否将训练/验证目标与业务指标对齐，包括O3最大8小时滑动平均与AQI相关指标。",
              "score": 25,
              "evaluation_focus": "评价设计",
              "scoring_hint": "高分：列出小时MAE/RMSE+日级AQI相对误差+首要污染物F1；中分：仅小时误差；低分：缺少任何可度量指标。"
            },
            {
              "sub_criteria": "时间泄露与滚动起点交叉验证约束",
              "description": "是否识别并规避未来观测泄露，采用rolling-origin或时间分块验证与早停。",
              "score": 25,
              "evaluation_focus": "数据规范",
              "scoring_hint": "高分：明确rolling-origin与禁止使用t后的obs/sim；中分：普通时间切分但无细节；低分：随机划分或泄露未控制。"
            },
            {
              "sub_criteria": "物理与数据约束（非负裁剪、缺失掩码）",
              "description": "识别输出非负/上界裁剪与缺失指示器保留的必要性。",
              "score": 15,
              "evaluation_focus": "约束意识",
              "scoring_hint": "高分：说明非负、合理上界与缺失标志；中分：只提一项；低分：未考虑。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "复述多任务时序残差学习模块目标",
              "description": "阐明单站独立与多站点共享参数泛化的双重需求与输出ŷ^{corr}=sim+r̂。",
              "score": 30,
              "evaluation_focus": "表达严谨",
              "scoring_hint": "高分：同时提到共享基座与站点特异头/嵌入；中分：仅单站或多站其一；低分：目标含糊。"
            },
            {
              "sub_criteria": "输入规范复述（sim/obs、气象、时间编码、站点经纬）",
              "description": "逐项列出必要输入及其时间戳对齐要求与可用截止点约束。",
              "score": 30,
              "evaluation_focus": "需求还原",
              "scoring_hint": "高分：包含可用截止时间与对齐；中分：缺少截止或对齐细节；低分：输入不全。"
            },
            {
              "sub_criteria": "日值与O3最大8小时滑动平均的下游需求连接",
              "description": "准确说明小时到日值聚合如何依赖本模块输出，并对O3窗口完整性有所提及。",
              "score": 20,
              "evaluation_focus": "流程衔接",
              "scoring_hint": "高分：提到8小时窗口完整性与AQI/首要污染物；中分：仅提日均；低分：未提下游。"
            },
            {
              "sub_criteria": "损失函数与业务指标对齐",
              "description": "复述使用Huber/MAE及O3日值惩罚项、AQI相对误差或首要污染物分类损失的动机。",
              "score": 20,
              "evaluation_focus": "目标对齐",
              "scoring_hint": "高分：明确多目标损失设计；中分：只提MAE；低分：无损失设计。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "站点共享与特异性假设（共享基座+站点嵌入/头）",
              "description": "给出多站点参数共享的合理性与条件（站点间>100km，弱相互影响）。",
              "score": 30,
              "evaluation_focus": "建模假设",
              "scoring_hint": "高分：提出站点嵌入或特异头；中分：笼统共享；低分：未考虑跨站泛化。"
            },
            {
              "sub_criteria": "缺失与异常处理假设（掩码、指示器、树模型缺失鲁棒）",
              "description": "明确训练/推理时如何处理缺失、winsorize后残差分布假设与鲁棒损失理由。",
              "score": 25,
              "evaluation_focus": "数据假设",
              "scoring_hint": "高分：说明指示器+Huber/MAE；中分：仅简单填补；低分：忽略缺失。"
            },
            {
              "sub_criteria": "物理约束与上界假设",
              "description": "对非负与合理上界（如参考国家标准或经验分位数）进行假设说明。",
              "score": 20,
              "evaluation_focus": "领域约束",
              "scoring_hint": "高分：给出上界策略（P99或标准）；中分：仅非负；低分：无约束。"
            },
            {
              "sub_criteria": "时序稳定性与特征可迁移假设",
              "description": "说明历史窗口统计、PBL×风速、光化学指数等对残差稳定性的假设。",
              "score": 25,
              "evaluation_focus": "可迁移性",
              "scoring_hint": "高分：结合物理特征阐述；中分：仅统计滞后；低分：未提。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "特征构造：历史窗口、物理启发、时间编码与输送因子",
              "description": "包含过去24/48/72小时统计、PBL×风速、光化学促发指数、u/v、邻站方向性输送与缺失指示器/站点嵌入。",
              "score": 30,
              "evaluation_focus": "特征工程",
              "scoring_hint": "高分：覆盖统计+物理+空间+编码；中分：缺少其一；低分：仅少量原始特征。"
            },
            {
              "sub_criteria": "残差学习器设计（LightGBM/XGBoost与深度TCN/LSTM对比）",
              "description": "给出树模型强基线与可选深度时序结构，多任务设计（共享基座+多头）。",
              "score": 25,
              "evaluation_focus": "算法选择",
              "scoring_hint": "高分：两类模型与结构清晰；中分：仅单一模型；低分：模型不匹配。"
            },
            {
              "sub_criteria": "损失函数：Huber/MAE+O3最大8小时惩罚+AQI/首要污染物项",
              "description": "联合多目标以服务业务指标，说明权重或调度策略。",
              "score": 20,
              "evaluation_focus": "目标设计",
              "scoring_hint": "高分：实现或清晰方案；中分：仅Huber/MAE；低分：未与业务对齐。"
            },
            {
              "sub_criteria": "验证方案：滚动起点CV、早停、正则与学习率调度",
              "description": "完整描述避免泄露的验证与防过拟合策略。",
              "score": 25,
              "evaluation_focus": "实验设计",
              "scoring_hint": "高分：rolling-origin+早停+L2/调度；中分：时间分割但无细节；低分：随机CV。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "超参优化（Optuna/网格）与选择依据",
              "description": "说明搜索空间（树的深度、学习率、num_leaves/迭代数等）与选择基于小时MAE/RMSE+日级AQI误差+F1的综合指标。",
              "score": 35,
              "evaluation_focus": "调参与选择",
              "scoring_hint": "高分：有明确空间与综合准则；中分：单指标或小范围；低分：无调参。"
            },
            {
              "sub_criteria": "集成与后处理（加权融合/堆叠、非负与上界裁剪）",
              "description": "对互补模型融合并施加物理裁剪，必要时日聚合偏差校准。",
              "score": 25,
              "evaluation_focus": "集成策略",
              "scoring_hint": "高分：给出融合权重学习或验证确定；中分：简单平均；低分：无融合且无后处理。"
            },
            {
              "sub_criteria": "训练稳定性与鲁棒性（随机遮挡、缺失掩码）",
              "description": "通过数据增强与掩码机制提高对实测缺失的鲁棒性。",
              "score": 20,
              "evaluation_focus": "鲁棒训练",
              "scoring_hint": "高分：实现随机遮挡/掩码；中分：仅指示器；低分：未处理。"
            },
            {
              "sub_criteria": "推理与在线约束（可用截止时间、无未来信息）",
              "description": "确保推理只使用截止时可用sim/obs与特征。",
              "score": 20,
              "evaluation_focus": "部署可行",
              "scoring_hint": "高分：显式滑动窗口与截止控制；中分：文字说明；低分：存在未来泄露。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "数据输入管道与特征流水线（pandas/numpy/高效窗口）",
              "description": "实现可复用的特征构造与滞后统计、时间编码、物理特征计算，支持多站点。",
              "score": 30,
              "evaluation_focus": "代码结构",
              "scoring_hint": "高分：模块化pipeline与单元测试；中分：脚本化但可运行；低分：零散不可复用。"
            },
            {
              "sub_criteria": "模型训练与验证脚本（LightGBM/XGBoost/深度框架）",
              "description": "包含rolling-origin CV、早停、日志记录与模型持久化。",
              "score": 30,
              "evaluation_focus": "可复现性",
              "scoring_hint": "高分：固定随机种子与版本；中分：可运行但缺日志；低分：运行依赖不完整。"
            },
            {
              "sub_criteria": "推理与后处理接口（非负裁剪、O3窗口聚合）",
              "description": "提供校正后逐小时输出与日值聚合工具，含O3最大8小时计算。",
              "score": 25,
              "evaluation_focus": "接口完整",
              "scoring_hint": "高分：一键生成小时与日值；中分：仅小时输出；低分：缺少接口。"
            },
            {
              "sub_criteria": "解释性与可视化（SHAP/重要性、误差曲线）",
              "description": "输出特征重要性/SHAP与关键指标曲线图表。",
              "score": 15,
              "evaluation_focus": "可解释性",
              "scoring_hint": "高分：稳定SHAP与案例分析；中分：仅重要性；低分：无解释。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "小时级误差改进（MAE/RMSE对比一次预报sim）",
              "description": "量化校正后ŷ^{corr}相对sim的提升并报告分位数。",
              "score": 30,
              "evaluation_focus": "结果量化",
              "scoring_hint": "高分：显著下降且给出P50/P90；中分：小幅改进；低分：无改进或未报告。"
            },
            {
              "sub_criteria": "日级AQI相对误差与首要污染物F1",
              "description": "给出平均相对误差、分位数与首要污染物准确率/召回/F1。",
              "score": 25,
              "evaluation_focus": "业务对齐",
              "scoring_hint": "高分：全面指标并优于基线；中分：部分指标；低分：缺失关键指标。"
            },
            {
              "sub_criteria": "O3最大8小时滑动平均专项评估",
              "description": "单独评估O3日值误差并分析日内周期捕捉能力。",
              "score": 20,
              "evaluation_focus": "专题诊断",
              "scoring_hint": "高分：窗口级命中率/误差；中分：仅日值误差；低分：未评估。"
            },
            {
              "sub_criteria": "可解释性分析与物理一致性检查",
              "description": "用SHAP/重要性验证PBL×风速、光化学指数等特征作用方向与物理一致。",
              "score": 25,
              "evaluation_focus": "解释与一致性",
              "scoring_hint": "高分：给出方向一致性证据；中分：仅列特征；低分：无分析或违背物理未解释。"
            }
          ]
        }
      }
    },
    "3": {
      "subtask": "子任务3（空间协同建模与多站点协同策略）的目标是构建并训练一个面向临近监测站点协同信息融合的端到端时空模型，利用站点间的地理位置、历史观测与一次预报、以及气象导向输送信息，在小时尺度上校正一次预报并输出经校正的逐小时六种污染物预报及其日值聚合（含 O3 最大8小时滑动平均）、IAQI/AQI 与首要污染物概率，从而在监测点 A（以及 B、C 等）上降低 AQI 的相对误差并提高首要污染物判别准确度。该子任务的范围与必要步骤包括：一、数据输入与时间窗口定义——输入为每个站点的逐小时一次预报（WRF‑CMAQ）污染物与气象字段、截至模型运行时可用的逐小时实测观测、站点经纬坐标与时序索引；采用固定历史窗口长度 L（建议 48–72 小时）作为模型输入，预测未来窗口覆盖至第3日末。二、图构建与边权设计——基于站点间欧氏距离 d_ij 与历史观测相关性 corr_ij 构造静态邻接基矩阵 A^0_{ij} = α exp(−d_{ij}^2/l^2) + (1−α) corr_{ij}（α 与 l 由验证集调优）；引入风向/风速导向的时间可变权重 W_{ij,t} = sigmoid(β * u_{i,t} * cos(θ_{i,t} − bearing_{ij})) 将输送方向性与风速耦合到时变邻接 A_{t} = A^0 ⊙ W_{t}，并对行或列归一化（例如 D^{-1}A）以稳定图卷积。三、特征与缺失处理——节点特征为时间序列矩阵（一次预报字段、可得实测字段的滞后统计、物理派生量如 PBL×风速、短波累积等）并包含缺失掩码；短期缺失由掩码机制和时间插值/模型内填补处理，模型输入同时附加缺失指示位以保留可用性信息。四、模型架构——采用时空分离或交替的时空网络：每个节点先由时间编码器（例如多层 TCN 或带掩码的 GRU/Transformer）将历史序列映射为节点时刻表示，再通过多层图神经网络（如 Graph Attention 或 Graph Convolution）在节点与邻接上进行融合以捕捉输送与协同效应，最后由节点特异的解码器输出未来每小时各污染物的残差预测（即学习 obs − sim），模型支持多站点多输出学习并可共享主干参数、为每站添加可学习嵌入以适配站点差异。五、损失设计与 O3 处理——训练损失为加权组合：小时级鲁棒回归损失（Huber/MAE）用于所有污染物残差，O3 额外加入对日聚合的最大8小时滑动平均误差（采用可微分的 soft‑max pooling 或在两阶段训练中以后处理计算并微调），并加入对日级 AQI 相对误差或首要污染物分类（交叉熵/ focal loss）的辅助项以直接优化题目指标；对缺失日/小时使用掩码在损失中屏蔽。六、训练策略与验证——采用滚动起点时间序列交叉验证（rolling origin）以模拟在线预报情形，批次为多个站点的时间窗样本，优化器用 Adam/AdamW，结合学习率调度、早停与 L2 正则；超参数（图构造参数 α,l,β、窗口长度 L、网络深度与隐藏维度等）采用贝叶斯优化（如 Optuna）在验证集上调优。七、缺失与稳健性机制——在邻站观测不可用时模型通过掩码与图权重自动降级对邻接依赖，训练时通过随机遮挡邻站输入增强鲁棒性；对一次预报完全缺失情形可在输入中使用最近有效一次预报并加缺失标志。八、解释性与输出——模型应导出节点注意力/边权随时间的可视化（用于判定哪些邻站与时刻对目标站贡献最大）、局部特征重要性（可用 integrated gradients 或 GAT attention weights），以及最终输出：经校正的逐小时污染物预测、日聚合浓度、IAQI 向量、AQI 值、首要污染物的概率分布和预测不确定度估计（通过模型集成或 MC dropout 获取）。九、实现工具建议——优先使用 PyTorch + PyTorch Geometric 或 DGL 实现时空 GNN，使用 pandas/numpy 进行数据预处理，Optuna 做超参优化，训练与推理在 GPU 上加速（若资源受限可将模型蒸馏为轻量版）。十、评估指标与交付物——在保留验证集上报告目标站（如 A）与整体站点的指标：日级 AQI 平均相对误差、首要污染物准确率/召回/F1、小时级 MAE/RMSE；交付物包括训练好的模型权重、推理脚本（输入截至当日07:00的历史数据输出未来三日预测）、邻接与注意力可视化文件、以及模型使用与再训练说明。",
      "criteria": {
        "task_understanding": {
          "core_goal": "构建并训练端到端时空协同模型，预测并校正逐小时六污染物以降低AQI相对误差并提高首要污染物判别准确度。",
          "expected_output": "经校正的逐小时六污染物数值序列（未来至第3日23时）、对应日值聚合（含O3最大8小时滑动平均）、IAQI/AQI与首要污染物概率分布、模型权重与推理脚本、图/边权可视化、验证报告（小时MAE/RMSE、AQI相对误差、首要污染物F1）。",
          "key_inputs_constraints": "输入：各站点逐小时一次预报与可用实测、站点经纬度与相对方位、历史窗口长度L=48–72小时、风速/风向/PBL/短波等气象；约束：仅使用当日07:00前可见数据，图邻接A^0由距离与相关性构建并叠加风导向时变权W_{t}；输出需物理合理（非负、合理上界）并屏蔽缺失小时的损失；采用rolling-origin验证避免泄露。",
          "modeling_type": "预测+分类+评价",
          "role_in_pipeline": "作为二次建模的空间协同校正核心模块，位于子任务1（标准化与特征工程）之后、子任务2（单站残差学习）的扩展与融合；其输出被下游报告与情景评估使用，并回馈特征重要性给数据层改进。",
          "assumptions": "若部分邻站缺测，使用掩码和时变图权自动降级；若O3软最大8小时不可微实现受限，则采用两阶段训练：先小时Huber/MAE，后以日级O3 max-8h微调。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "明确“逐小时污染物预测”与“日值聚合（含O3最大8小时滑动平均）”目标",
              "description": "是否清晰区分小时级校正预测与日级聚合，并将O3最大8小时滑动平均作为关键日指标纳入目标。",
              "score": 30,
              "evaluation_focus": "目标界定/指标对齐",
              "scoring_hint": "高分：同时列出小时MAE/RMSE与O3 max-8h误差；中分：仅有小时指标但提及O3；低分：未提及日聚合或O3特性。"
            },
            {
              "sub_criteria": "定位“降低AQI相对误差、提高首要污染物判别准确度”",
              "description": "是否将AQI相对误差与首要污染物分类准确率/F1作为优化与评估核心。",
              "score": 30,
              "evaluation_focus": "任务指标/评价",
              "scoring_hint": "高分：定义AQI相对误差与首要污染物F1计算；中分：仅叙述但无公式；低分：忽略AQI或首要污染物。"
            },
            {
              "sub_criteria": "识别“空间协同/风导向输送/图时变邻接”要点",
              "description": "是否将地理距离、相关性与风向风速的时变权纳入问题定义。",
              "score": 40,
              "evaluation_focus": "建模思维/要素识别",
              "scoring_hint": "高分：给出A^0与W_{t}的形式或等价描述；中分：提空间图但无时变权；低分：仅做单站建模。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "复述固定历史窗口L=48–72小时与预测至第3日末",
              "description": "是否准确描述输入时间窗与输出时域覆盖（第3日23时）。",
              "score": 30,
              "evaluation_focus": "需求对齐",
              "scoring_hint": "高分：明确L与输出跨度；中分：给出大致范围；低分：时间设定模糊或错误。"
            },
            {
              "sub_criteria": "复述数据可见性约束（07:00截断与泄露避免）",
              "description": "是否强调仅使用07:00前可用实测/一次预报，验证使用rolling-origin。",
              "score": 30,
              "evaluation_focus": "约束理解",
              "scoring_hint": "高分：同时提滚动验证与掩码损失；中分：仅提不泄露；低分：无提及或使用随机切分。"
            },
            {
              "sub_criteria": "复述输出形态（经校正小时序列、日聚合、IAQI/AQI、概率）",
              "description": "是否完整覆盖六污染物小时序列、日值、IAQI/AQI与首要污染物概率分布。",
              "score": 40,
              "evaluation_focus": "输出规范",
              "scoring_hint": "高分：逐项列出并与评估指标关联；中分：缺1项；低分：缺多项或仅文本描述。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "图构造假设（A^0=距离核+相关性融合，参数α,l）",
              "description": "明确静态邻接由高斯距离核与历史相关性加权构成，并需调参α与尺度l。",
              "score": 35,
              "evaluation_focus": "建模假设/可检验性",
              "scoring_hint": "高分：给出公式或等价函数；中分：口头描述；低分：未说明或仅用全连接。"
            },
            {
              "sub_criteria": "风导向时变权W_{t}与方向性输送假设",
              "description": "阐明W_{ij,t}=sigmoid(β*u*cos(θ−bearing))或等价并进行归一化稳定训练。",
              "score": 35,
              "evaluation_focus": "物理先验/合理性",
              "scoring_hint": "高分：含β/归一化与数值稳定性说明；中分：仅提风向作用；低分：忽略时变权。"
            },
            {
              "sub_criteria": "缺失与掩码假设（训练时随机遮挡邻站）",
              "description": "说明短缺用掩码/插值，训练做随机遮挡增强，损失对缺失样本屏蔽。",
              "score": 30,
              "evaluation_focus": "稳健性/泛化",
              "scoring_hint": "高分：含遮挡比例或策略；中分：仅提掩码；低分：未考虑缺失。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "时空网络架构（时间编码器+GNN融合+解码器残差学习obs−sim）",
              "description": "设计含TCN/GRU/Transformer时间编码、GAT/GCN图层、节点头输出六污染物残差并校正sim。",
              "score": 35,
              "evaluation_focus": "架构设计/多任务",
              "scoring_hint": "高分：清晰模块与多输出残差；中分：仅给整体思路；低分：与任务不符（直接预测obs）。"
            },
            {
              "sub_criteria": "特征与物理派生量（PBL×风速、u/v、短波累积、输送因子）",
              "description": "节点特征包含一次预报、滞后统计、物理派生与缺失指示，匹配窗口L。",
              "score": 25,
              "evaluation_focus": "特征工程/物理启发",
              "scoring_hint": "高分：列关键派生与单位；中分：部分列举；低分：仅原始变量。"
            },
            {
              "sub_criteria": "损失设计（Huber/MAE+O3日max-8h项+AQI/首要污染物辅助）",
              "description": "定义多目标损失，含O3软池化或两阶段微调，分类用交叉熵/focal。",
              "score": 25,
              "evaluation_focus": "目标对齐/可优化性",
              "scoring_hint": "高分：权重设置与屏蔽缺失；中分：只提MAE；低分：无与指标对齐。"
            },
            {
              "sub_criteria": "图邻接归一化与数值稳定性（D^{-1}A或对称归一）",
              "description": "说明对A_t做行/对称归一以稳定GNN训练，必要时加残差/dropout。",
              "score": 15,
              "evaluation_focus": "数值稳定/训练可行",
              "scoring_hint": "高分：给出具体归一方式；中分：仅提归一化；低分：无处理导致梯度不稳。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "训练与验证方案（rolling origin、早停、LR调度、L2）",
              "description": "采用滚动起点交叉验证避免泄露，结合早停与正则，批次采样跨站点时间窗。",
              "score": 35,
              "evaluation_focus": "训练策略/严谨性",
              "scoring_hint": "高分：明确折数/窗口；中分：仅描述概念；低分：随机切分。"
            },
            {
              "sub_criteria": "超参优化（Optuna调α,l,β,L、深度与隐藏维度）",
              "description": "使用贝叶斯优化并以小时MAE、日级AQI相对误差、首要污染物F1综合排序。",
              "score": 25,
              "evaluation_focus": "超参搜索/指标驱动",
              "scoring_hint": "高分：定义搜索空间与停机准则；中分：网格搜索；低分：无调参。"
            },
            {
              "sub_criteria": "鲁棒性与缺失处理（掩码损失、随机遮挡邻站、物理约束裁剪）",
              "description": "训练与推理均应用掩码，数据增强遮挡，输出非负与上界裁剪。",
              "score": 25,
              "evaluation_focus": "稳健性/约束满足",
              "scoring_hint": "高分：列出上界或策略；中分：只非负；低分：无约束致异常值。"
            },
            {
              "sub_criteria": "不确定度估计（MC dropout或集成）",
              "description": "提供小时预测置信区间或分位数用于AQI不确定度传播。",
              "score": 15,
              "evaluation_focus": "不确定性/风险",
              "scoring_hint": "高分：实现并报告覆盖率；中分：仅描述方法；低分：无。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "PyTorch(+PyG/DGL)实现时空GNN、数据管道与掩码机制",
              "description": "可复现的dataloader（多站点时间窗）、模型模块化、掩码在前向与损失生效。",
              "score": 35,
              "evaluation_focus": "代码可靠性/工程化",
              "scoring_hint": "高分：脚本可训练复现；中分：核心代码但缺管线；低分：伪代码。"
            },
            {
              "sub_criteria": "图构造与时变邻接A_t生成（A^0+W_t、归一化）",
              "description": "提供从经纬/相关性/风场到A_t的可复现实现与缓存。",
              "score": 25,
              "evaluation_focus": "算法实现/效率",
              "scoring_hint": "高分：矢量化+缓存；中分：逐时重算无缓存；低分：无实现。"
            },
            {
              "sub_criteria": "推理脚本（07:00截断、输出日聚合/IAQI/AQI/首要污染物概率）",
              "description": "一键从输入到未来三日预测与报表导出（CSV/Parquet与可视化）。",
              "score": 25,
              "evaluation_focus": "可用性/接口",
              "scoring_hint": "高分：命令行参数+日志；中分：仅notebook；低分：无可运行接口。"
            },
            {
              "sub_criteria": "训练配置与复现（随机种、设备、超参日志与Optuna存档）",
              "description": "固定随机种子，保存最佳权重与试验记录，支持GPU/CPU切换。",
              "score": 15,
              "evaluation_focus": "复现实验/管理",
              "scoring_hint": "高分：配置文件+seed；中分：部分记录；低分：不可复现。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "指标报告（小时MAE/RMSE、日级AQI平均相对误差、首要污染物F1）",
              "description": "在保留验证集分别报告A与整体站点的核心指标与分位数。",
              "score": 35,
              "evaluation_focus": "评价/量化结果",
              "scoring_hint": "高分：含分位数/置信区间；中分：仅平均；低分：无量化。"
            },
            {
              "sub_criteria": "对比单站残差模型（子任务2）与协同模型的提升与显著性",
              "description": "量化A站提升（如AQI相对误差下降%、首要污染物准确率提升）并做统计检验。",
              "score": 25,
              "evaluation_focus": "对比实验/统计",
              "scoring_hint": "高分：报告p值或Bootstrap CI；中分：仅差值；低分：无对比。"
            },
            {
              "sub_criteria": "可解释性与物理一致性（边权/注意力随时间、输送事件案例）",
              "description": "展示A_t或注意力热力图，结合风向输送案例解释关键邻站贡献。",
              "score": 25,
              "evaluation_focus": "可解释/机理一致",
              "scoring_hint": "高分：图示+事件回放；中分：文字解释；低分：无。"
            },
            {
              "sub_criteria": "错误分析与失败模式（高湿/降水/弱风情景）",
              "description": "分析在极端气象或观测缺失下误差变化并提出改进。",
              "score": 15,
              "evaluation_focus": "诊断/改进",
              "scoring_hint": "高分：分情景误差表；中分：泛谈；低分：无分析。"
            }
          ]
        }
      }
    },
    "4": {
      "subtask": "子任务4（模型验证、不确定性量化、气象情形分类、部署与维护）的目标是建立一套可重复、可监控且以决策为导向的验证与运维流程，确保生产模型在小时和日尺度上稳定、可解释并能量化不确定性；其范围包括（1）严格的时序验证协议与性能基线构建：采用滚动起点（rolling‑origin）训练/验证拆分并保留独立测试集，按小时/日分别计算并记录关键指标（小时级 MAE/RMSE，日级 AQI 平均相对误差及其分位数、首要污染物的准确率/召回/F1、污染事件（AQI>100）命中率与误报率、混淆矩阵），对 O3 特别统计最大8小时滑动均值的误差分布；（2）不确定性量化与校准方法：并行采用分位数回归（LightGBM quantile）、模型集成与蒙特卡洛 dropout（深度模型）以获得预测分布，利用置信区间覆盖率（e.g. 90% CI coverage）、连续排名概率评分（CRPS）或分位数损失评估分布性，进而用等概率校准方法（如分位数回归校准、isotonic/Platt 校准或分层校准）调整概率输出并生成超标概率与首要污染物概率分布；（3）鲁棒性与敏感性测试：通过系统化扰动实验（向输入注入噪声、模拟不同缺失模式及一次预报/邻站观测缺失）、参数敏感性分析（窗口长度、PBL阈值等）以及极端/跨季节子集评估，量化模型在输入不确定性和异常情形下的性能退化并记录降级边界；（4）气象情形分类与条件性能报告：实现可复现的气象情形划分（例如强扩散、中等扩散、静稳/不利扩散、湿沉降清除、强光化学促发），所用判据可基于PBL、风速、降水、短波辐射与相对湿度的训练期分位阈值，按类别分别统计性能指标以判别模型优势/弱点并为后续分段模型或规则提供依据；（5）可解释性与故障诊断工具：集成特征重要性与局部解释（如 SHAP、集成注意力/边权可视化），并制定系统化失败案例分析流程（识别数据缺失、输入漂移、气象异常或一次预报异常），为每类失败提出可执行缓解策略（重训练、数据回投、手动规则覆盖）；（6）上线部署与运维规范：定义推理接口与输出契约（每日07:00批处理或API请求输入截至07:00的历史数据，输出逐小时浓度预测、日聚合值、IAQI/AQI、首要污染物概率与不确定区间），实现输入校验与回退策略（当关键输入缺失时使用最近有效一次预报或历史均值并打上不确定性标签），采用容器化部署与模型注册（如 Docker+MLflow/ModelDB），记录完整运行日志与指标链（数据质量、推理时延、每日关键性能统计），并设置告警规则：当实时性能（如 AQI 相对误差或覆盖率）超出阈值或输入分布发生显著漂移（采用 PSI/KL divergence 等统计检测）时自动触发人工审查或自动重训练流程；（7）再训练与版本管理策略：定义重训练触发条件（性能退化、数据量增长或一次预报系统重大变更），并规定重训练频率与回滚机制、模型验证门槛和部署前的回测步骤；（8）交付物与工具链建议：产出可复现的验证脚本与报告、带校准的概率预测接口、性能监控仪表板与失败案例库，推荐使用 pandas/numpy/scikit‑learn 做数据处理与统计检验，LightGBM 与 PyTorch 实现模型与不确定性方法，Optuna 做超参调优，SHAP 做解释，Prometheus/Grafana 或 ELK 做运行监控，MLflow 做模型注册与版本管理；整体要求所有流程、阈值和判据须文档化并可程序化执行，以支持自动化监控、可追溯的模型更新和对外透明的性能汇报。",
      "criteria": {
        "task_understanding": {
          "core_goal": "在滚动起点验证框架下评估并校准二次预报模型，量化小时/日尺度AQI与首要污染物预测性能与不确定性，并完成部署与运维规范制定与实施。",
          "expected_output": "验证脚本与报告（小时MAE/RMSE、日级AQI相对误差分布、O3最大8小时误差）、置信区间与概率输出（覆盖率、CRPS、校准曲线）、鲁棒性与敏感性实验结果、气象情形分类与分情景性能表、SHAP与注意力可视化、告警与监控仪表板规范、推理API契约与回退策略、重训练与版本管理文档。",
          "key_inputs_constraints": "输入包括：清洗后的小时级数据与日级标签（子任务1）、经校正的逐小时预测或残差模型（子任务2/3输出）；需严格rolling-origin拆分，独立测试集保留；O3需计算最大8小时滑动平均；概率评估需输出分位数或样本集合以计算覆盖率与CRPS；部署需在每日07:00截止数据下运行并产生未来三日预测。",
          "modeling_type": "评价+预测+分类",
          "role_in_pipeline": "作为最终验证与运维环节：依赖子任务1的数据预处理与标签、子任务2/3的模型与预测输出；向上游反馈失败案例与再训练触发，向下游提供部署接口与监控。前序：子任务1/2/3；后序：生产部署与在线监控、周期性重训练。",
          "assumptions": "无外部网络限制下工具自给；评估阈值示例：AQI相对误差告警阈值20%，覆盖率目标90%±5%；气象情形阈值以训练期分位数P20/P80近似。"
        },
        "evaluation_criteria": {
          "问题识别": [
            {
              "sub_criteria": "滚动起点（rolling-origin）验证与独立测试集",
              "description": "是否明确采用rolling-origin时间序列拆分并保留独立测试集，避免未来信息泄露并匹配07:00上线情形。",
              "score": 30,
              "evaluation_focus": "评价设计",
              "scoring_hint": "高分：清晰给出窗口与步长，测试集划界前置；中分：给出时间切分但无滚动细节；低分：随机/打乱划分或未设独立测试集。"
            },
            {
              "sub_criteria": "指标对齐：小时MAE/RMSE与日级AQI相对误差",
              "description": "识别需同时评估小时误差与日级AQI平均相对误差及分位数，并覆盖O3最大8小时窗口。",
              "score": 30,
              "evaluation_focus": "指标体系",
              "scoring_hint": "高分：提供全套并区分小时时间聚合与O3 8h；中分：缺少分位数或O3特指；低分：仅给单一指标。"
            },
            {
              "sub_criteria": "不确定性量化与覆盖率/CRPS",
              "description": "提出分位数回归/集成/MC dropout并以覆盖率与CRPS评估，含校准需求。",
              "score": 25,
              "evaluation_focus": "不确定性",
              "scoring_hint": "高分：明确90%CI覆盖与CRPS计算；中分：仅给区间无评估；低分：无不确定性设计。"
            },
            {
              "sub_criteria": "气象情形分类与条件性能",
              "description": "识别需按扩散/静稳/湿沉降/强光化学等情形分报性能以定位弱点。",
              "score": 15,
              "evaluation_focus": "情景分析",
              "scoring_hint": "高分：列出PBL/风速/降水/RH/短波阈值；中分：仅粗分类；低分：无条件性能。"
            }
          ],
          "问题复述": [
            {
              "sub_criteria": "07:00业务约束与可用数据窗复述",
              "description": "准确复述每日07:00截止可用观测与一次预报范围并据此设计验证。",
              "score": 25,
              "evaluation_focus": "业务约束",
              "scoring_hint": "高分：明确T<=07:00历史、预测至D+3 23:00；中分：描述含糊；低分：忽略07:00约束。"
            },
            {
              "sub_criteria": "AQI/首要污染物判定口径一致性",
              "description": "复述IAQI分段映射、AQI取最大、并列首要污染物处理与O3 8h口径。",
              "score": 25,
              "evaluation_focus": "口径对齐",
              "scoring_hint": "高分：列出并列规则与窗口完整性；中分：缺少并列或窗口完整性；低分：未对齐标准。"
            },
            {
              "sub_criteria": "不确定性输出与校准目标复述",
              "description": "明确输出需含概率/分位数、覆盖率目标与校准方法（等概率/等距、isotonic）。",
              "score": 25,
              "evaluation_focus": "概率口径",
              "scoring_hint": "高分：提出校准前后对比；中分：仅提校准名词；低分：无校准。"
            },
            {
              "sub_criteria": "监控与告警阈值",
              "description": "复述需建立AQI相对误差、覆盖率、漂移(PSI/KL)阈值并触发审查/重训练。",
              "score": 25,
              "evaluation_focus": "运维意识",
              "scoring_hint": "高分：列阈值与动作；中分：仅描述监控；低分：未涉及监控。"
            }
          ],
          "假设建立": [
            {
              "sub_criteria": "数据完备性与缺失机制假设",
              "description": "对评估期缺失与窗口可用性假设（如O3窗口完整性、缺失掩码）并记录影响。",
              "score": 25,
              "evaluation_focus": "假设管理",
              "scoring_hint": "高分：区分短缺/长期缺失影响指标；中分：泛化陈述；低分：无假设。"
            },
            {
              "sub_criteria": "分布稳定性与漂移假设",
              "description": "假设训练/上线分布近似并设置PSI/KL阈值与再训练触发。",
              "score": 25,
              "evaluation_focus": "风险控制",
              "scoring_hint": "高分：量化阈值PSI>0.25告警；中分：仅提漂移；低分：忽略漂移。"
            },
            {
              "sub_criteria": "气象情形阈值设定假设",
              "description": "以训练期分位数(P20/P80)近似阈值并注明地域/季节可变性。",
              "score": 25,
              "evaluation_focus": "情景建模",
              "scoring_hint": "高分：给出示例阈值与可配置；中分：仅提分位数；低分：无阈值依据。"
            },
            {
              "sub_criteria": "不确定性方法可用性假设",
              "description": "假设可产出分位数或样本（集成/MC dropout）用于CRPS与覆盖率计算。",
              "score": 25,
              "evaluation_focus": "方法假设",
              "scoring_hint": "高分：匹配所选模型能力；中分：方法与模型不匹配；低分：无此假设。"
            }
          ],
          "模型构建": [
            {
              "sub_criteria": "验证协议与指标实现设计",
              "description": "设计rolling-origin切分、窗口长度、步长和指标计算（小时MAE/RMSE、日AQI相对误差、O3 max-8h）。",
              "score": 30,
              "evaluation_focus": "评价设计",
              "scoring_hint": "高分：给出伪代码/公式与边界处理；中分：仅概述；低分：缺失关键指标。"
            },
            {
              "sub_criteria": "不确定性量化与校准管线",
              "description": "构建分位数回归/集成/MC dropout输出，评估覆盖率与CRPS，并用isotonic/分层校准修正。",
              "score": 30,
              "evaluation_focus": "概率建模",
              "scoring_hint": "高分：端到端可执行流程；中分：无评估闭环；低分：仅点预测。"
            },
            {
              "sub_criteria": "鲁棒性与敏感性实验设计",
              "description": "定义噪声注入、缺失模式模拟、参数敏感性（窗口L、PBL阈值）与退化曲线输出。",
              "score": 25,
              "evaluation_focus": "实验设计",
              "scoring_hint": "高分：覆盖≥3类扰动并量化性能跌幅；中分：单一扰动；低分：无实验。"
            },
            {
              "sub_criteria": "气象情形分类器与条件评估",
              "description": "基于PBL/风速/降水/短波/RH规则构建分类并输出分情景指标与样本占比。",
              "score": 15,
              "evaluation_focus": "规则建模",
              "scoring_hint": "高分：可复现规则与阈值来源；中分：规则模糊；低分：未实现分类。"
            }
          ],
          "模型求解": [
            {
              "sub_criteria": "指标与度量的正确计算",
              "description": "正确实现小时MAE/RMSE、AQI相对误差分位数、O3最大8小时滑动平均（完整窗口）。",
              "score": 35,
              "evaluation_focus": "数值实现",
              "scoring_hint": "高分：边界/缺失处理正确并经单测验证；中分：小瑕疵；低分：计算口径错误。"
            },
            {
              "sub_criteria": "概率评估与校准效果",
              "description": "计算90%CI覆盖率、CRPS/分位数损失并展示校准前后改进。",
              "score": 30,
              "evaluation_focus": "概率评估",
              "scoring_hint": "高分：覆盖率接近目标且CRPS下降；中分：仅给覆盖率；低分：无量化或恶化。"
            },
            {
              "sub_criteria": "鲁棒性与敏感性结果复现",
              "description": "输出扰动曲线、关键参数敏感性，并报告性能退化阈值与置信区间。",
              "score": 20,
              "evaluation_focus": "稳健性",
              "scoring_hint": "高分：多扰动一致趋势与统计显著；中分：零散结果；低分：缺失。"
            },
            {
              "sub_criteria": "条件性能与事件检出",
              "description": "按气象情形与AQI>100事件统计命中率/误报率、首要污染物F1。",
              "score": 15,
              "evaluation_focus": "情景评价",
              "scoring_hint": "高分：含混淆矩阵与分情景对比；中分：仅总体；低分：无事件分析。"
            }
          ],
          "代码实现": [
            {
              "sub_criteria": "rolling-origin与O3 max-8h实现",
              "description": "提供可复用代码/函数实现滚动切分与O3最大8小时计算（窗口完整性检查）。",
              "score": 30,
              "evaluation_focus": "代码可靠性",
              "scoring_hint": "高分：模块化含单元测试；中分：可运行但耦合高；低分：无实现或错误。"
            },
            {
              "sub_criteria": "不确定性与校准代码",
              "description": "实现分位数模型/集成采样与CRPS、覆盖率、isotonic/分层校准流程。",
              "score": 30,
              "evaluation_focus": "算法实现",
              "scoring_hint": "高分：接口清晰支持批处理；中分：只覆盖部分方法；低分：仅占位。"
            },
            {
              "sub_criteria": "监控与告警原型",
              "description": "实现PSI/KL漂移检测、AQI相对误差与覆盖率监控、阈值触发与日志。",
              "score": 25,
              "evaluation_focus": "工程实现",
              "scoring_hint": "高分：可配置阈值与结构化日志；中分：脚本化无告警；低分：无原型。"
            },
            {
              "sub_criteria": "部署接口与回退策略",
              "description": "提供07:00批处理API契约、输入校验、回退到最近一次预报/历史均值并打标。",
              "score": 15,
              "evaluation_focus": "接口设计",
              "scoring_hint": "高分：JSON契约与异常处理完善；中分：接口粗糙；低分：未给接口。"
            }
          ],
          "结果分析": [
            {
              "sub_criteria": "性能基线与对比",
              "description": "与一次预报和残差基线对比：小时MAE/RMSE、日AQI相对误差、O3 8h误差分布。",
              "score": 30,
              "evaluation_focus": "对比分析",
              "scoring_hint": "高分：显著改进并给出统计检验；中分：改进有限；低分：无对比或退化。"
            },
            {
              "sub_criteria": "不确定性校准质量",
              "description": "展示可靠性曲线、PIT直方图、覆盖率接近目标且CRPS下降的证据。",
              "score": 25,
              "evaluation_focus": "概率解释",
              "scoring_hint": "高分：曲线接近对角线、PIT近均匀；中分：轻微偏差；低分：严重失配。"
            },
            {
              "sub_criteria": "气象情形条件优势/弱点",
              "description": "定位强扩散/静稳/湿沉降/强光化学等情景下的误差差异与改进建议。",
              "score": 25,
              "evaluation_focus": "情景洞察",
              "scoring_hint": "高分：提出分段规则或再训练策略；中分：仅描述现象；低分：无结论。"
            },
            {
              "sub_criteria": "可解释性与失败案例诊断",
              "description": "用SHAP/注意力解释关键驱动因子，给出失败样本的缺失/漂移/一次预报异常成因与缓解措施。",
              "score": 20,
              "evaluation_focus": "诊断能力",
              "scoring_hint": "高分：案例闭环到行动；中分：仅罗列；低分：无解释或不一致。"
            }
          ]
        }
      }
    }
  }
}