{
    "background": "有些国家会发射特殊目的的空间飞行器，如弹道式导弹、侦察卫星等。对他国发射具有敌意的空间飞行器实施监控并作出快速反应，对于维护国家安全具有重要的战略意义。发现发射和探测其轨道参数是实现监控和作出反应的第一步，没有观测，后续的判断与反应都无从谈起。卫星居高临下，是当今探测空间飞行器发射与轨道参数的重要平台。\n\n观测卫星按轨道特点，可分为高轨地球同步轨道卫星和中低轨近圆轨道卫星。其中同步轨道距地球表面约3.6万千米，轨道平面与地球赤道平面重合，理论上用3颗间隔120度分布的同步轨道卫星可覆盖地球绝大部分表面。中低轨近圆轨道距地球表面数百到几千千米不等，根据观测要求，其轨道平面与赤道平面交成一定角度，且常由若干颗卫星实现组网探测。装置于卫星上的探测器包括有源和无源两类：有源探测器采用主动方式（如雷达，激光）搜寻目标，同时具备定向和测距两种能力；无源探测器则被动接收目标辐射。采用无源探测器的观测卫星常采用红外光学探测器，只接收目标的红外辐射信息，可定向但不能测距。对于火箭尾部喷焰的高度敏感性是红外技术的长处，但易受气候影响与云层干扰则是其缺点。\n\n探测的目的是为了推断空间飞行器的轨道参数，推断是基于观测数据并通过数学模型与计算方法作出的。当观测卫星飞行一段时间，探测器测得目标相对于运动卫星的观测数据，以观测卫星和空间飞行器的运动模型和观测模型为基础，对空间飞行器的轨道参数（包括轨道位置、速度初值和其他模型参数）进行数学推断，为飞行器类别、飞行意图的判断提供信息基础。\n\n空间飞行器轨道一般可分为三段，依次为：靠火箭推进的主动段、在地球外层空间的惯性飞行段和再入大气层后的攻击段。主动段通常由多级火箭相继推进，前一级火箭完成推进后脱落，由后一级火箭接力。惯性飞行段在空气阻力极小的大气层外，靠末级火箭关机前获得的速度在椭圆轨道上作无动力惯性飞行。攻击段则根据任务需求，受控制后再入大气层，飞向目标。对于卫星而言，在其寿命结束前一直绕地飞行，故无攻击段。\n\n图1是空间飞行器的主动段示意图（未按实际比例）。主动段又可细分为若干子段：垂直上升段，程序拐弯段和重力斜飞段。按最优轨道设计，为节约燃料，箭体应尽快穿过稠密大气层，故火箭一般先垂直发射。设A点为地面发射点，AB为垂直上升段，BC弧段为程序拐弯段，CD弧段为重力斜飞段，DE弧段为椭圆轨道。程序拐弯段连接垂直上升段与重力斜飞段，在外力矩控制下使箭体转过一定角度，该段完成后外加力矩撤销，进入斜飞状态。第一级火箭通常负担“垂直段+程序拐弯段（加外力矩）+重力斜飞段的前段”的推进（视发动机的特性），重力斜飞段的后程则靠第二、第三级火箭相继完成。由于斜飞状态下地球引力与推力不在同一直线，所以箭体质心的运动轨迹为带一定弧度的光滑曲线。",
    "problem_requirement": "为描述观测卫星和空间飞行器的运动，需要建立适当的坐标系。本题基础坐标系为随地心平移的坐标系，取地球中心$O_c$为原点，地球自转轴取为$z$轴，指向北极为正向，$x$轴由指向零时刻的0经度线，再按右手系确定$y$轴，建立直角坐标系$O_c-X_cY_cZ_c$。地心$O_c$在绕日椭圆轨道上运动，所以理论上$O_c-X_cY_cZ_c$系是非惯性系。但地球公转周期远大于空间飞行器的观测弧段时长，故本题在短时间内认定该系为惯性坐标系，该基础坐标系不随地球旋转。\n\n第二个坐标系是随卫星运动的观测坐标系$O_c-X_cY_cZ_c$，见图2，原点取为卫星中心$O_s$，$X_s$轴沿$O_cO_s$连线，离开地球方向为正，$Z_s$轴与$X_s$轴垂直，$Y_s$轴按右手系确定。如此定义的观测坐标系也叫做UEN坐标系，因为三个坐标轴分别指向上（UP）、东（EAST）和北（NORTH）三个方向。\n\n根据变质量质点的动力学，空间飞行器在基础坐标系下的主动段的简化运动方程如下：\\[ \\ddot{\\vec{r}}(t) = \\vec{F}_e + \\vec{F}_T = -\\frac{G_m}{|\\vec{r}(t)|^3}\\vec{r}(t) + \\vec{v}_r(t)\\frac{\\dot{m}(t)}{m(t)} \\quad (1) \\]\n\n其中向量$\\vec{F}_e$表示飞行器所受的外力加速度之和，$\\vec{F}_T$表示火箭产生的推力加速度，$m(t)$为瞬时质量；$\\dot{m}(t)$是质量变化率；$\\vec{r}(t)$为空间飞行器在基础坐标系下的位置矢量；$\\ddot{\\vec{r}}(t)$表示$\\vec{r}(t)$对时间$t$的二阶导数，即加速度；$G_m$为地球引力常数（本题中地球引力常数取$G_m=3.986005 \\times 10^{14} m^3/s^2$），为了更明确地表示推力加速度的方向，$\\vec{v}_r(t)$取的是燃料相对于火箭尾部喷口的喷射速度的逆矢量。\n方程（1）中如果只保留右侧第一项，则可以表示观测卫星的简化运动方程：\n\\[ \\ddot{\\vec{r}}(t) = \\vec{F}_e = -\\frac{G_m}{|\\vec{r}(t)|^3}\\vec{r}(t) \\quad (2) \\]\n在给定基础坐标系下的位置和速度初值情况下，可以利用常微分方程组数值解方法计算空间飞行器的运动轨迹。不同空间飞行器的本质差异就在于$\\vec{v}_r(t)$和$m(t)$的模型不同，$m(t)$一般而言为严格单调递减的非负函数。$\\vec{v}_r(t)$的方向一般应与飞行器的速度方向接近或相同，其大小一般较为稳定。\n观测卫星对于空间飞行器的观测数据通过化简可以由观测坐标系下的两个无量纲比值确定：\n\\[ \\alpha = \\frac{y_s}{x_s}, \\quad \\beta = \\frac{z_s}{x_s} \\quad (3) \\]\n其中$x_s,y_s,z_s$为空间飞行器在观测坐标系中的坐标。\n\n观测数据不可避免地带有各种误差，观测误差包括随机误差和系统误差。本题假设随机误差为直接叠加在观测数据上的白噪声，可能产生于背景辐射干扰与信息处理等多个方面。系统误差也包括多种来源，如卫星定位误差、指向机构误差、图像校准误差、传感器安装误差等等。在本题框架内，我们假定只考虑与卫星平台相关的系统误差，即不同观测卫星的系统误差相互没有关联，同一观测卫星对于不同空间飞行器的系统误差是一样的。经由适当的简化模型，各种系统误差最终可以折合为观测坐标系的原点位置误差和三轴指向误差。根据工程经验，原点位置误差影响较小，而三轴指向误差影响较大，对三轴指向误差进行估计对于提高估计精度很有帮助，本题只考虑三轴指向误差。三轴指向误差在二维观测数据平面上表现为两个平移误差和一个旋转误差，具体可以用三个常值小量来表示，分别表示第一观测量的平移量、第二观测量的平移量以及观测量在平面内的旋转量。\n\n单个红外光学探测器不具备测距能力，但借助多颗（含两颗）观测卫星的同步观测能够进行逐点定位，再结合空间飞行器的运动模型，可以进行轨道参数估计。在单星观测条件下，利用空间飞行器轨道的特殊性，结合较强的模型约束也可得到一定精度轨道参数估计。由于受大气影响，垂直上升段的火箭尾焰不易观测，程序拐弯段的运动方程又较为复杂，所以本题重点关注重力斜飞段的后程段，本题所附仿真数据也集中于此段。\n\n本题以中低轨近圆轨道卫星为观测星座对假想的空间飞行器进行仿真观测，生成仿真观测数据，要求利用仿真观测数据，对假想空间飞行器的轨道参数进行估计。本题所附文件包括：\n\n参数文件satinfo.txt用来存储观测卫星信息，每行表示一颗卫星，包含六列，分别表示零时刻卫星在基础坐标系下的位置和速度。卫星编号从上到下递增并从0开始。\n\n仿真数据文件meadata_i_j.txt用来存储仿真观测数据信息。i、j为占位符，表示编号为i的卫星对编号为j的飞行器的仿真观测数据信息，按照时间顺序分行，每行分三列，分别是观测时刻以及对应观测数据。\n\n本题所涉及的数据与结果，均应采用国际标准单位，即：时间单位为秒、距离单位为米、速度单位为米每秒等等；所有位置和速度均指基础坐标系下的位置和速度。\n\n在仅考虑随机误差的条件下，请你们团队研究下列问题：\n\n观测卫星在任意时刻的位置计算是估计的前提，请根据satinfo.txt和观测卫星的简化运动方程（2），计算09号观测卫星在50.0s、100.0s、150.0s、200.0s、250.0s五个时刻的三维位置。结果保留6位有效数字。\n\n在本题给定的仿真数据下，06号和09号观测卫星对0号空间飞行器形成了立体交叠观测，请结合立体几何知识按照逐点交汇定位的思路，给出0号空间飞行器在公式（1）框架下的轨道估计，注意选取适当的和的表示模型。按照从50.0s到170.0s间隔10.0s进行采样，计算并列表给出0号空间飞行器在各个采样点的位置和速度，并给出估计残差。结果保留6位有效数字。同时绘制0号空间飞行器的三个位置t-x、t-y、t-z和三个速度t-vx、t-vy、t-vz曲线示意图。\n\n在同时考虑系统误差的条件下，进一步研究下列问题：\n\n3.  若06和09号两颗观测卫星均有可能带有一定的系统误差，对系统误差进行正确的估计能够有效提高精度。利用上述的逐点交汇方法能否同时对系统误差进行估计？若不能，是否还有其他的思路能够同时估计系统误差与轨道？给出你的解决方案与估计结果。在报告中除给出与第二问要求相同的结果外，还应分别给出两颗观测卫星的系统误差估计结果，共六个数值，分别是两颗卫星的。\n\n如果你们还有时间和兴趣，还可考虑下列：\n\n 对只有09号观测卫星单星观测的01号空间飞行器进行轨道估计，结果形式要求同第三问，注意参考第三问的系统误差估计结果。并进一步考虑在同时有多颗观测卫星观测多个空间飞行器的情况下能否联合进行系统误差估计？\n\n本题要求提供可计算出所提交报告中答案的计算程序，所使用的语言和工具不限，但推荐使用C\\C++、Fortran、Matlab、Mathematica、...。",
    "dataset_path": ["satinfo.txt", "meadata_06_00.txt", "meadata_09_00.txt", "meadata_09_01.txt"],
    "dataset_description": "参数文件 satinfo.txt 用来存储观测卫星信息，每行表示一颗卫星，包含六列，分别表示零时刻卫星在基础坐标系下的位置和速度。卫星编号从上到下递增并从0开始。\n\n仿真数据文件 meadata_i_j.txt 用来存储仿真观测数据信息。i、j为占位符，表示编号为i的卫星对编号为j的飞行器的仿真观测数据信息，按照时间顺序分行，每行分三列，分别是观测时刻以及对应观测数据。",
    "variable_description": [
        {"x0": "零时刻卫星在基础坐标系下的 x 坐标",
        "y0": "零时刻卫星在基础坐标系下的 y 坐标",
        "z0": "零时刻卫星在基础坐标系下的 z 坐标",
        "vx0": "零时刻卫星在基础坐标系下的 x 方向速度",
        "vy0": "零时刻卫星在基础坐标系下的 y 方向速度",
        "vz0": "零时刻卫星在基础坐标系下的 z 方向速度"},
        {"t": "观测时刻", "u": "无量纲比值 α = x/z", "v": "无量纲比值 β = y/z"},
        {"t": "观测时刻", "u": "无量纲比值 α = x/z", "v": "无量纲比值 β = y/z"},
        {"t": "观测时刻", "u": "无量纲比值 α = x/z", "v": "无量纲比值 β = y/z"}
    ],
    "addendum": "在仅考虑随机误差的条件下：\n1. 根据 satinfo.txt 和观测卫星的简化运动方程（2），计算09号观测卫星在50.0s、100.0s、150.0s、200.0s、250.0s五个时刻的三维位置。\n2. 在给定仿真数据下，06号和09号观测卫星对0号空间飞行器形成立体交叠观测，结合立体几何知识，按照逐点交汇定位的思路，给出轨道估计，并计算轨道残差，绘制t-x、t-y、t-z和t-vx、t-vy、t-vz曲线。\n\n在同时考虑系统误差的条件下：\n3. 研究能否同时估计系统误差与轨道，并给出误差估计结果，共六个数值（分别表示两颗卫星的三个指向误差参数）。\n\n扩展问题：\n4. 对只有09号观测卫星单星观测的01号空间飞行器进行轨道估计，并进一步研究在多颗观测卫星观测多个空间飞行器时能否联合估计系统误差。\n\n本题要求提交可计算报告答案的计算程序，推荐使用 C/C++、Fortran、Matlab、Mathematica 等语言和工具。"
  }
