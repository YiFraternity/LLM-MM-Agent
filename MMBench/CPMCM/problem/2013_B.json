{
  "background": "信号的功率放大是电子通信系统的关键功能之一，其实现模块称为功率放大器（PA，Power Amplifier），简称功放。功放的输出信号相对于输入信号可能产生非线性变形，这将带来无益的干扰信号，影响信信息的正确传递和接收，此现象称为非线性失真。传统电路设计上，可通过降低输出功率的方式减轻非线性失真效应。\n\n功放非线性属于有源电子器件的固有特性，研究其机理并采取措施改善，具有重要意义。目前已提出了各种技术来克服改善功放的非线性失真，其中预失真技术是被研究和应用较多的一项新技术，其最新的研究成果已经被用于实际的产品（如无线通信系统等），但在新算法、实现复杂度、计算速度、效果精度等方面仍有相当的研究价值。\n\n本题从数学建模的角度进行探索。若记输入信号 $x(t)$，输出信号为 $z(t)$，$t$ 为时间变量，则功放非线性在数学上可表示为 \n$z(t) = G(x(t))$，\n其中 $G$ 为非线性函数。预失真的基本原理是：在功放前设置一个预失真处理模块，这两个模块的合成总效果使整体输入-输出特性线性化，输出功率得到充分利用。原理框图如图1所示。\n\n其中 $x(t)$ 和 $z(t)$ 的含义如前所述，$y(t)$ 为预失真器的输出。设功放输入-输出传输特性为 $G(\\cdot)$，预失真器特性为 $F(\\cdot)$，那么预失真处理原理可表示为 \n$$z(t) = G(y(t)) = G(F(x(t))) = (G \\circ F)(x(t)) = L(x(t)) \\tag{1}$$\n$G \\circ F = L$ 表示为 $G(\\cdot)$ 和 $F(\\cdot)$ 的复合函数等于 $L(\\cdot)$。线性化则要求 \n$$z(t) = L(x(t)) = g \\cdot x(t) \\tag{2}$$\n式中常数 $g$ 是功放的理想“幅度放大倍数” ($g > 1$)。因此，若功放特性 $G(\\cdot)$ 已知，则预失真技术的核心是寻找预失真器的特性 $F(\\cdot)$，使得它们复合后能满足 \n$$(G \\circ F)(x(t)) = L(x(t)) = g \\cdot x(t). \\tag{3}$$\n如果测得功放的输入和输出信号值，就能拟合功放的特性函数 $G(\\cdot)$，然后利用 (3) 式，可以求得 $F(\\cdot)$。\n\n2.功放的非线性模型\n\n由于各类功放的固有特性不同，特性函数$G()$差异较大，即使同一功放，由于输入信号类型、环境温度等的改变，其非线性特性也会发生变化。根据函数逼近的Weierstrass定理，对解析函数$G(x)$总可以用一个次数充分大的多项式逼近到任意程度，故可采用计算简单的多项式表示非线性函数。\n\n如果某一时刻的输出仅与此时刻的输入相关，称为无记忆功放，其特性可用多项式表示为：\n$$z(t) = \\sum_{k=1}^K h_k x^k(t), \\quad t \\in [0,T] \\tag{4}$$\n式中 $K$ 表示非线性的阶数（即多项式次数），诸 $h_k$ 为各次幂的系数。在函数逼近理论中，$z(t)$ 是用函数数组 $\\{x^0, x^2, x^3, \\ldots, x^K\\}$ 生成的 $K+1$ 维空间里的这组基的线性组合表示。用函数空间的一组正交函数基 $\\{\\varphi_k(x)\\}_{k=0}^K$ 的线性组合表示则性能更佳、计算更方便，故 (4) 亦可用正交基等其它方式表示。\n\n如果对功放输入 $x(t)$ / 输出 $z(t)$ 进行离散采样后值分别为 $x(n)$ / $z(n)$（采样过程符合 Nyquist 采样定理要求），则 (4) 可用离散多项式表示如下：\n$$z(n) = \\sum_{k=1}^K h_k x^k(n) = h_1 x(n) + h_2 x^2(n) + \\cdots + h_K x^K(n), \\quad n = 0,1,2,\\ldots,N \\tag{5}$$\n\n如果功放的某一时刻输出不仅与此时刻输入有关，而且与此前某一时间段的输入有关，则称为有记忆功放。对 (5) 式增加记忆效应，可以写为：\n$$z(n) = \\sum_{k=1}^K \\sum_{m=0}^M h_{km} x^k(n-m) = h_{10}x(n) + h_{11}x(n-1) + \\cdots + h_{1M}x(n-M) \\\\ + h_{20}x^2(n) + h_{21}x^2(n-1) + \\cdots + h_{2M}x^2(n-M) \\\\ + \\cdots \\cdots \\\\ + h_{K0}x^K(n) + h_{K1}x^K(n-1) + \\cdots + h_{KM}x^K(n-M), \\quad n=0,1,2,\\ldots,N \\tag{6}$$\n\n式中 $M$ 表示记忆深度，诸 $h_{km}$ 为系数。具有记忆效应的功放模型也可以用更一般的 Volterra 级数 [1][2] 表示，由于 Volterra 级数太复杂，简化模型有 Wiener、Hammerstein 等 [3][4]。由于常用复值输入-输出信号，(6) 也可表示为便于计算的“和记忆多项式”模型：\n$$z(n) = \\sum_{k=1}^K \\sum_{m=0}^M h_{km} x(n-m) |x(n-m)|^{k-1}, \\quad n=0,1,2,\\ldots,N \\tag{7}$$\n\n3.预失真处理模型\n\n在功放的特性$G()$已知条件下，求解方程(3)是一类特殊的函数方程，求解的理论方法因具体问题而定，而工程上常采取数值计算，用最小化目标误差函数的方法，求得近似的$F()$。目标误差函数的选取和判断准则因建模方法而异，总体原则是使预失真和功放的联合模型呈线性后误差最小。\n\n本题探索中，预失真处理建模还需考虑以下2个约束条件：\n\n预失真处理的“输出幅度限制”。由于功放的输入幅度需保持在一定范围，过大的值会导致饱和溢出，因此，本题的建模中限定预失真处理的输出幅度不大于所给出的功放输入幅度最大值。\n\n预失真处理加载后，尽可能使功放的输出“功率最大化”。 为了充分发挥功放的作用，预失真处理模型的建立必需考虑尽可能使功放的信号平均输出功率最大，因此预失真处理后的输出幅度（等效为功放的输入幅度）需尽可能提高。\n4.计算结果评价\n\n以上模型的数值计算结果业界常用NMSE、EVM等参数评价其准确度，具体定义如下。\n\n采用归一化均方误差 (Normalized Mean Square Error, NMSE) 来表征计算精度，其表达式为$$NMSE = 10 \\log_{10} \\frac{\\sum_{n=1}^{N} |z(n) - \\hat{z}(n)|^2}{\\sum_{n=1}^{N} |z(n)|^2} \\tag{8}$$\n\n如果用 $z$ 表示实际信号值，$\\hat{z}$ 表示通过模型计算的信号值，NMSE 就反映了模型与物理实际模块的接近程度。功放前加载预失真处理后，也可用 NMSE 判断整体模型输出值与理想输出值的近似程度。\n\n误差矢量幅度（Error Vector Magnitude，EVM）定义为误差矢量信号平均功率的均方根和参照信号平均功率的均方根的比值，以百分数形式表示。如果用 $X$ 表示理想的信号输出值，$e$ 表示理想输出与整体模型输出信号的误差，可用 EVM 衡量整体模型对信号的幅度失真程度。\n\n$$EVM = \\frac{\\sqrt{E[|e|^2]}}{\\sqrt{E[|X|^2]}} \\times 100\\% \\tag{9}$$",
  "problem_requirement": "在上述提供的背景材料以及自行查阅相关文献资料的基础上，请你们的团队研究下列问题。要求写出计算的过程、注明所用的优化方法、解释选择中间参数的理由、并附上所用的程序（C/C++/Java/Matlab等）。为保证所用模型的工程可实现性，请考虑选用适当复杂度的模型和算法。\n\n以下各题中的数学建模鼓励创新，不局限于背景介绍的模型方法。\n\n1. 无记忆功放\n\n数据文件1给出了某功放无记忆效应的复输入-输出测试数据，其输入-输出幅度图为：\n                    \n图2  功放输入/输出幅度散点图\n\n请根据提供的数据，完成以下任务。\n\nA．建立此功放的非线性特性的数学模型，然后用NMSE评价所建模型的准确度。\n\nB．根据线性化原则以及“输出幅度限制”和“功率最大化”约束，建立预失真模型。写出目标误差函数，计算线性化后最大可能的幅度放大倍数，运用评价指标参数NMSE/EVM评价预失真补偿的结果。\n\n2. 有记忆功放\n\n数据文件2给出了某功放的有记忆效应的复输入-输出数据，请完成以下任务。\n\nA．建立此功放的非线性特性的数学模型，然后用NMSE评价所建模型的准确度。\n\nB．根据线性化原则以及“输出幅度限制”和“功率最大化”约束，以框图的方式建立预失真处理的模型实现示意图（提示：可定义基本实现单元模块和确定其之间关系，组成整体图），然后计算预失真模型相关参数。运用评价指标参数NMSE/EVM评价预失真补偿的计算结果。\n\n3． 拓展研究\n\n相邻信道功率比（Adjacent Channel Power Ratio，ACPR）是表示信道的带外失真的参数，衡量由于非线性效应所产生的新频率分量对邻道信号的影响程度。其定义为：\n$$ACPR = 10 \\log_{10} \\frac{\\int_{f_2}^{f_3} s(f)\\,df}{\\int_{f_1}^{f_2} s(f)\\,df} \\tag{10}$$\n\n其中 $s(f)$ 为信号的功率谱密度函数，$[f_1,f_2]$ 为传输信道，$[f_2,f_3]$ 为相邻信道。功率谱密度的计算可通过对信号的自相关函数进行 Fourier 变换计算，也可以通过直接法等计算（假定本题涉及的信号为时间平稳信号）。\n\n如果题2所附的数据采样频率 $F_s = 30.72 \\times 12 \\,\\text{MHz}$，传输信道按照 20MHz 来算，邻信道也是 20MHz。根据给出的数据，请计算功放预失真补偿前后的功率谱密度，并用图形的方式表示三类信号的功率谱密度（输入信号、无预失真补偿的功率放大器输出信号、采用预失真补偿的功率放大器输出信号），最后用 ACPR 对结果进行分析评价。",
  "dataset_path": [
    "pa_in_memory.txt",
    "pa_out_memory.txt",
    "pa_in_out_memory.mat",
    "pa_in_memoryless.txt",
    "pa_out_memoryless.txt",
    "pa_in_out_memoryless.mat"
  ],
  "dataset_description": {
    "pa_in_memory": "这是一个纯文本文件，存储了功放输入信号（memoryless 输入）的数据。文件内容主要由复数构成，例如：6.1519e-015-4.9215e-015i，-1.2304e-015-4.9215e-015i，...，每一行代表一个采样点的输入值，格式为 实部 ± 虚部 i。这些数据可以用来表示基带信号的时域输入样本，用于后续非线性建模或功放仿真。",
    "pa_out_memory": "这是一个纯文本文件，存储了功放输出信号（具有记忆效应）的数据。与第一个文件类似，其内容也是复数序列：-0.0037878-0.0044593i，-0.0013122-0.0041377i，...，这些数据代表了功率放大器输出的信号波形。与输入信号相比，输出信号包含非线性失真和记忆效应（时延相关），可用于对比分析功放的性能。",
    "pa_in_out_memory": "这是一个 MATLAB 数据文件，同时保存了输入信号和输出信号。相比前两个 .txt 文件逐点存储的方式，.mat 文件是结构化存储，方便直接在 MATLAB 或 Python (scipy.io.loadmat) 中读取。",
    "pa_in_memoryless": "这是一个文本文件，存储功率放大器输入信号（无记忆效应），每一行是一个复数（格式为实部 ± 虚部 i，如 6.1519e-015-4.9215e-015i），数据代表基带信号在时域上的采样点，作为功率放大器输入参考信号。",
    "pa_out_memoryless": "这是一个文本文件，保存功率放大器输出信号（无记忆效应），内容为复数序列（如 1.8456e-014-1.4765e-014i），数据代表经过功率放大器后的输出波形，可用于比较输入与输出的非线性特性。",
    "pa_in_out_memoryless": "这是一个 MATLAB 数据文件，同时包含输入信号和输出信号，以结构化数组存储，便于在 MATLAB 或 Python（如 scipy.io.loadmat）中直接加载，典型字段包括 pa_in（输入信号，复数序列，对应 pa_in_memoryless.txt 内容）、pa_out（输出信号，复数序列，对应 pa_out_memoryless.txt 内容）、Fs（采样率，部分文件包含，用于信号频域分析和建模）。"
  },
  "variable_description": [
    {},
    {},
    {
      "pa_in_memory": {
        "description": "记忆功放的输入信号（基带复信号，时域采样）",
        "dtype": "complex128",
        "shape": [
          1000,
          1
        ],
        "ndim": 2,
        "is_complex": true,
        "num_samples": 1000,
        "abs_min": 0.0,
        "abs_max": 1.0552674011147538,
        "notes": "列向量；与 pa_in_memory.txt 内容对应"
      },
      "pa_out_memory": {
        "description": "记忆功放的输出信号（包含非线性效应后的基带复信号，时域采样）",
        "dtype": "complex128",
        "shape": [
          1000,
          1
        ],
        "ndim": 2,
        "is_complex": true,
        "num_samples": 1000,
        "abs_min": 0.0,
        "abs_max": 1.9274454614619805,
        "notes": "列向量；与 pa_out_memory.txt 内容对应"
      },
      "__meta__": {
        "__header__": "MATLAB file header string (版本/平台信息)",
        "__version__": "MAT 文件版本号（例如 '1.0' 或 '1.0 MAT-file' 之类）",
        "__globals__": "[]（空列表）"
      }
    },
    {},
    {
      "pa_in_memoryless": {
        "description": "无记忆功放的输入信号（基带复信号，时域采样）",
        "dtype": "complex128",
        "shape": [
          1000,
          1
        ],
        "ndim": 2,
        "is_complex": true,
        "num_samples": 1000,
        "abs_min": 0.0,
        "abs_max": 1.0552674011147538,
        "notes": "列向量；与 pa_in_memoryless.txt 内容对应"
      },
      "pa_out_memoryless": {
        "description": "无记忆功放的输出信号（包含非线性效应后的基带复信号，时域采样）",
        "dtype": "complex128",
        "shape": [
          1000,
          1
        ],
        "ndim": 2,
        "is_complex": true,
        "num_samples": 1000,
        "abs_min": 0.0,
        "abs_max": 1.9274454614619805,
        "notes": "列向量；与 pa_out_memoryless.txt 内容对应"
      },
      "__meta__": {
        "__header__": "MATLAB file header string (版本/平台信息)",
        "__version__": "MAT 文件版本号（例如 '1.0' 或 '1.0 MAT-file' 之类）",
        "__globals__": "[]（空列表）"
      }
    }
  ],
  "addendum": "参考文献\n[1] John Tsimbinos, Identification and Compensation of Nonlinear Distortion, PhD Dissertation, School of Electronic Engineering, University Of South Australia, Adelaide, February 1995.\n[2] Tianhai Wang, et al. Volterra-Mapping-Based Behavioral Modeling of Nonlinear Circuits and Systems for High Frequencies.  IEEE Trans. Microwave Theory and Techniques, 2003,51(5):1433-1440\n[3] Raviv Raich, et al. Orthogonal Polynomials for Power Amplifier Modeling and Predistorter Design.  IEEE Trans. Vehicular technology, 2004,53(5):1468-1479\n[4]Dennis R.Morgan et al. A Generalized Memory Polynomial Model for Digital Predistortion of RF Power Amplifiers. IEEE Trans. Signal Processing , 2006,54(10):3852-3860"
}