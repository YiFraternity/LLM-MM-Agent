{
  "background": "轨道交通系统的能耗是指列车牵引、通风空调、电梯、照明、给排水、弱电等设备产生的能耗。根据统计数据，列车牵引能耗占轨道交通系统总能耗40%以上。在低碳环保、节能减排日益受到关注的情况下，针对减少列车牵引能耗的列车运行优化控制近年来成为轨道交通领域的重要研究方向。\n\n1. 列车运行过程\n\n列车在站间运行时会根据线路条件、自身列车特性、前方线路状况计算出一个限制速度。列车运行过程中不允许超过此限制速度。限制速度会周期性更新。在限制速度的约束下列车通常包含四种运行工况：牵引、巡航、惰行和制动。\n\n牵引阶段：列车加速，发动机处于耗能状态。\n\n巡航阶段：列车匀速，列车所受合力为0，列车是需要牵引还是需要制动取决于列车当时受到的总阻力。\n\n惰行阶段：列车既不牵引也不制动，列车运行状态取决于受到的列车总阻力，发动机不耗能。\n\n制动阶段：列车减速，发动机不耗能。如果列车采用再生制动技术，此时可以将动能转换为电能反馈回供电系统供其他用电设备使用，例如其他正在牵引的列车或者本列车的空调等（本列车空调的耗能较小，通常忽略不计）。\n\n如果车站间距离较短，列车一般采用“牵引-惰行-制动”的策略运行。如果站间距离较长，列车通常会采用牵引到接近限制速度后，交替使用惰行、巡航、牵引三种工况，直至接近下一车站采用制动进站停车。\n\n\n图 1 列车站间运行曲线\n\n\n列车在运行过程中，实际受力状态非常复杂。采用单质点模型是一种常见的简化方法。单质点模型将列车视为单质点，列车运动符合牛顿运动学定律。其受力可分为四类：重力$G$在轨道垂直方向上的分力与受到轨道的托力抵消，列车牵引力$F$，列车制动力$B$和列车运行总阻力$W$。\n\n\n图2 单质点列车受力分析示意图\n\n（1）列车牵引力\n\n列车牵引力 $F$ 是由动力传动装置产生的、与列车运行方向相同、驱动列车运行并可由司机根据需要调节的外力。牵引力 $F$ 在不同速度下存在不同的最大值 $F_{max} = f_F(v)$，具体数据参见附件。列车实际输出牵引力（kN）基于以下公式进行计算。\n\n\\begin{equation}\nF = \\mu F_{max}\n\\end{equation}\n\n其中，$\\mu$ 为实际输出的牵引加速度与最大加速度的百分比，$F_{max}$ 为牵引力最大值（kN）。\n\n图3 列车牵引特征曲线示意图\n\n（2）列车运行总阻力\n\n列车总阻力是指列车与外界相互作用引起与列车运行方向相反、一般是阻碍列车运行的、不能被司机控制的外力。按其形成原因可分为基本阻力和附加阻力。\n\n1）基本阻力\n\n列车的基本阻力是列车在空旷地段沿平、直轨道运行时所受到的阻力。该阻力是由于机械摩擦，空气摩擦等因素作用而产生的固有阻力。具体可分为以下五部分：1、车轴轴承间摩擦阻力；2、轮轨间滚动摩擦阻力；3、轮轨间滑动摩擦阻力；4、冲击阻力；5气动阻力。因此，基本阻力与许多因素有关，它主要取决于机车、车辆结构和技术状态、轴重、以及列车运行速度等，同时又受线路情况、气候条件影响。由于这些因素极为复杂，而且相互影响，实际应用中很难用理论公式进行准确计算，通常采用以下经验公式进行计算：\n\n\\begin{equation}\nw_0 = A + Bv + Cv^2\n\\end{equation}\n\n其中 $w_0$ 为单位基本阻力（N/kN），$A$、$B$、$C$ 为阻力多项式系数，通常取经验值，$v$ 为列车速度（km/h）。\n\n2）附加阻力\n\n列车由于在附加条件下（通过坡道、曲线、隧道）运行所增加的阻力叫做附加阻力。附加阻力主要考虑坡道附加阻力和曲线附加阻力。\n\n\\[ w_1 = w_i + w_c \\]\n\n列车的坡道附加阻力是列车上下坡时重力在列车运行方向上的一个分力。通常采用如下公式计算\n\n\\[ w_i = i \\]\n\n其中 $w_i$ 为单位坡道阻力系数（N/kN），$i$ 为线路坡度（‰）。$i$ 为正表示上坡，$i$ 为负表示下坡。\n\n列车的曲线阻力主要源自取决于轨道线路的曲率半径，列车在曲线上运行时，轮轨间纵向和横向的滑动摩擦力增加，转向架等各部分摩擦力也有所增加。通常采用如下公式计算：\n\n\\[ w_c = c / R \\]\n\n其中 $w_c$ 为单位曲线阻力系数（N/kN），$R$ 为曲率半径（m）；$c$ 为综合反映影响曲线阻力许多因素的经验常数，我国轨道交通一般取 600。\n\n有时为了计算方便，当坡道附加阻力、曲线附加阻力同时出现时，根据阻力值相等的原则，把列车通过曲线时所产生的附加阻力折算为坡道阻力，加上线路实际坡度即为加算坡度。\n\n综上，列车运行总阻力可按照如下公式计算：\n\n\\[ W = (w_0 + w_1) \\times g \\times M / 1000 \\]\n\n其中，$W$ 为线路阻力（N），$w_0$ 为单位基本阻力系数（N/kN），$w_1$ 为单位附加阻力系数（N/kN），$M$ 为列车质量（kg），$g$ 为重力加速度常数。\n\n\\section*{(3) 列车制动力 $B$}\n\n制动力 $B$ 是由制动装置引起的、与列车运行方向相反的、司机可根据需要控制其大小的外力。制动力 $B$ 存在与制动时列车速度有关的最大值，$B_{max} = f_B(v)$，当然制动力也可以小于 $B_{max}$。具体数据参见附件。列车实际输出制动力（kN）基于以下公式进行计算\n\n\\[ B = \\mu B_{max} \\]\n\n其中，$\\mu$ 为实际输出的制动加速度与最大加速度的百分比，$B_{max}$ 为制动力最大值（kN）。\n\n3. 运行时间与运行能耗的关系\n\n当列车在站间运行时，存在着多条速度距离曲线供选择。不同速度距离曲线对应不同的站间运行时间和不同的能耗。列车按照图 4 所示 4 条曲线可以走完相同的距离，但运行时间和能耗并不相同。此外，即便站间运行时间相同时，也存在多条速度距离曲线可供列车选择。此外，即便站间运行时间相同时，也存在多条速度距离曲线可供列车选择。\n\n\n图4 列车站间运行速度距离曲线\n\n一般认为，列车站间运行时间和能耗存在近似图5中的反比关系，比较准确的定量关系应根据前面的公式计算。注意，增加相同的运行时间不一定会减少等量的能耗。列车站间运行时间与能耗变化的趋势影响能耗的减少。\n\n\n图5 站间运行时间与能耗关系。\n\n\n图6 再生能量利用示意图\n\n\n\n4 再生能量利用原理\n\n随着制动技术的进步，目前城市轨道交通普遍采用再生制动。再生制动时，牵引电动机转变为发电机工况，将列车运行的动能转换为电能，发电机产生的制动力使列车减速，此时列车向接触网反馈电能，此部分能量即为再生制动能。如图6所示，列车 \\(i+1\\) 在制动时会产生能量 \\(E_{\\text{reg}}\\)，如果相邻列车 \\(i\\) 处于加速状态，其可以利用 \\(E_{\\text{reg}}\\)，从而减少从变电站获得的能量，达到节能的目的。如果列车 \\(i+1\\) 制动时，其所处供电区段内没有其他列车加速，其产生的再生能量除用于本列车空调、照明等设备外，通常被吸收电阻转化为热能消耗掉。\n\n\\textbf{假设：}\n\n\\textbf{产生的再生能量}\n\\[\nE_{\\text{reg}} = (E_{\\text{mech}} - E_{\\text{f}}) \\cdot 95\\%\n\\]\n其中 \\(E_{\\text{mech}}\\) 是制动过程中列车机械能的变化量，\\(E_{\\text{f}}\\) 是制动过程中为克服基本阻力和附加阻力所做功。\n\n被利用了的再生能量可按照以下假设的公式计算\n\\[\nE_{\\text{used}} = E_{\\text{reg}} \\cdot t_{\\text{overlap}} / t_{\\text{brake}}\n\\]\n其中 \\(t_{\\text{overlap}}\\) 是列车 \\(i+1\\) 制动的时间与列车 \\(i\\) 加速时间的重叠时间，\\(t_{\\text{brake}}\\) 是列车 \\(i+1\\) 的制动时间。即制动时所产生的再生能量与制动时间成正比。",
  "problem_requirement": "请研究以下问题：\n\n单列车节能运行优化控制问题\n\n(1) 请建立计算速度距离曲线的数学模型，计算寻找一条列车从 \\(A_6\\) 站出发到达 \\(A_7\\) 站的最节能运行的速度距离曲线，其中两车站间的运行时间为 110 秒，列车参数和线路参数详见文件“列车参数.xlsx”和“线路参数.xlsx”。\n\n(2) 请建立新的计算速度距离曲线的数学模型，计算寻找一条列车从 \\(A_6\\) 站出发到达 \\(A_8\\) 站的最节能运行的速度距离曲线，其中要求列车在 \\(A_7\\) 车站停站 45 秒，\\(A_6\\) 站和 \\(A_8\\) 站间总运行时间规定为 220 秒（不包括停站时间），列车参数和线路参数详见文件“列车参数.xlsx”和“线路参数.xlsx”。\n\n注：请将本问（1）和（2）得到的曲线数据按每秒钟一行填写到文件“数据格式.xlsx”中红色表头那几列，并将该文件和论文一并提交。（请只填写和修改数据，一定不要修改文件“数据格式.xlsx”的格式。其中计算公里标（m）是到起点的距离，计算距离（m）是到刚通过的一站的距离）\n\n\\textbf{二、多列车节能运行优化控制问题}\n\n(1) 当 100 列列车以间隔 \\(H = \\{h_1, \\ldots, h_{99}\\}\\) 从 \\(A_1\\) 站出发，追踪运行，依次经过 \\(A_2\\)，\\(A_3\\)，……到达 \\(A_{14}\\) 站，中间在各个车站停站最少 \\(D_{\\text{min}}\\) 秒，最多 \\(D_{\\text{max}}\\) 秒。间隔 \\(H\\) 各分量的变化范围是 \\(H_{\\text{min}}\\) 秒至 \\(H_{\\text{max}}\\) 秒。请建立优化模型并寻找使所有列车运行总能耗最低的间隔 \\(H\\)。要求第一列列车发车时间和最后一列列车的发车时间之间间隔为 \\(T_0 = 63900\\) 秒，且从 \\(A_1\\) 站到 \\(A_{14}\\) 站的总运行时间不变，均为 2086s（包括停站时间）。假设所有列车处于同一供电区段，各个车站间线路参数详见文件“列车参数.xlsx”和“线路参数.xlsx”。\n\n补充说明：列车追踪运行时，为保证安全，跟踪列车（后车）速度不能超过限制速度 \\(V_{\\text{limit}}\\)，以免后车无法及时制动停车，发生追尾事故。其计算方式可简化如下：\n\\[\nV_{\\text{limit}} = \\min(V_{\\text{line}}, \\sqrt{2LB_e})\n\\]\n其中 \\(V_{\\text{line}}\\) 是列车当前位置的线路限速（km/h），\\(L\\) 是当前时刻前后车之间的距离。\\begin{enumerate}\n    \\item[(2)] 接上问，如果高峰时间（早高峰 7200 秒至 12600 秒，晚高峰 43200 至 50400 秒）发车间隔不大于 2.5 分钟且不小于 2 分钟，其余时间发车间隔不小于 5 分钟，每天 240 列。请重新为它们制定运行图和相应的速度距离曲线。\n\\end{enumerate}\n\n三、列车延误后运行优化控制问题\n\n接上问，若列车 $i$ 在车站 $A_j$ 延误 $DT_j^i$（10 秒）发车，请建立控制模型，找出在确保安全的前提下，首先使所有后续列车尽快恢复正点运行，其次恢复期间耗能最少的列车运行曲线。\n\n假设 $DT_j^i$ 为随机变量，普通延误（$0 < DT_j^i < 10s$）概率为 20%，严重延误（$DT_j^i > 10s$）概率为 10%（超过 120s，接近下一班，不考虑调整），无延误（$DT_j^i = 0$）概率为 70%。若允许列车在各站到、发时间与原时间相比提前不超过 10 秒，根据上述统计数据，如何对第二问的控制方案进行调整？",
  "dataset_path": [
    "列车参数.docx",
    "线路参数.xlsx",
    "输入数据模板.xlsx"
  ],
  "dataset_description": {
    "列车参数": "列车参数.docx包含列车的基本参数和牵引/制动特性曲线，包括最大牵引力和最大制动力，这些参数对于计算列车在不同速度下的运行特性至关重要。",
    "线路参数": "线路参数.xlsx包含从A1站到A14站的线路参数，包括各车站的公里标、坡度信息、限速信息以及曲率信息。",
    "输入数据模板": "输入数据模板.xlsx包含列车从A6站到A7站和A8站的节能运行优化控制问题的数据。文件中包括列车运行的基本数据和具体数值，用于计算速度距离曲线。"
  },
  "variable_description": [
    {},
    {
      "车站名称": "车站的名称",
      "公里标(m)": "车站距离起点的公里数（单位：米）",
      "起始公里标": "坡度、限速或曲率变化的起始公里标（单位：米）",
      "坡度": "坡度值（单位：‰）",
      "终点公里标": "坡度、限速或曲率变化的终点公里标（单位：米）",
      "限速(km/h)": "限速值（单位：公里/小时）",
      "曲线半径（m）": "曲线的半径值（单位：米）"
    },
    {
      "车站名称": "列车经过的车站名称",
      "发车时刻": "列车在该站的发车时刻，格式为hh:mm:ss",
      "站间实际长度(m)": "该站与下一站间的实际距离，单位为米",
      "停站时间(s)": "列车在该站的停站时间，单位为秒",
      "站间运行时间(s)": "该站与下一站间的运行时间，单位为秒",
      "满载率(%)": "列车的满载比率",
      "时刻(hh:mm:ss)": "记录数据的时刻，格式为hh:mm:ss",
      "目标距离(m)": "距离下一个目标停车点的距离，单位为米",
      "EBI速度(cm/s)": "限制速度，单位为厘米/秒",
      "EBI速度(km/h)": "限制速度，单位为千米/小时",
      "目标速度(cm/s)": "控制器跟踪的速度，单位为厘米/秒",
      "目标速度(km/h)": "控制器跟踪的速度，单位为千米/小时",
      "实际速度(cm/s)": "信号系统测量的列车实际速度，单位为厘米/秒",
      "实际速度(km/h)": "信号系统测量的列车实际速度，单位为千米/小时",
      "计算加速度(m/s2)": "基于实际速度计算得到的实际加速度，单位为米/秒²",
      "计算距离(m)": "以前一目标点为零点走过的距离，单位为米",
      "计算公里标(m)": "以线路起点为零点走过的距离，单位为米",
      "网压(V)": "当前受流器处的电压值，单位为伏特",
      "网流(A)": "当前受流器处的电流值，单位为安培",
      "ATO输出的电流值": "ATO系统输出的电流值",
      "当前坡度(‰)": "当前坡度，单位为千分比",
      "PID控制器期望输出的加速度(％)": "ATO控制器期望输出牵引/制动力的百分比",
      "计算牵引力(N)": "当前输出的牵引力，单位为牛顿",
      "计算牵引功率(Kw)": "当前输出的电机功率，单位为千瓦",
      "辅助功率(Kw)": "辅助系统的功率，单位为千瓦"
    }
  ],
  "addendum": "参考文献：\n\n[1] P. Howllet, An Optimal Strategy for the Control of A Train, Journal of the Australian Mathematical Society. Series B. Applied Mathematics, Volume 31, Issue 04, April 1990, pp. 454-471.\n\n[2] 丁勇，毛保华，刘海东，张鑫，王铁城，列车节能运行模拟系统的研究，北京交通大学\n学报，第28卷第2期，第76-81页\n\n[3] 金炜东，靳蕃，李崇维，胡飞，苟先太，列车优化操纵速度模式曲线生成的智能计算研究，铁道学报，第20卷，第5期，第47-52页.\n\n[4] E. Khmelnitsky, On an optimal control problem of train operation, IEEE Transactions on Automatic Control, Volume 45, Issue 7, pp. 1257 – 1266.\n\n[5] Rongfang (Rachel) Liu, Lakov M. Golovitcher, Energy-efficient operation of rail vehicles, Transportation Research Part A: Policy and Practice, Volume 37, Issue 10, pp. 917-932.\n\n[6] Su S, Tang T, Li X, et al. Optimization of multitrain operations in a subway system[J]. Intelligent Transportation Systems, IEEE Transactions on, 2014, 15(2): 673-684.\n\n[7] Albrecht T, Oettich S. A new integrated approach to dynamic schedule synchronization and energy-saving train control[J]. Publication of: WIT Press, 2002."
}