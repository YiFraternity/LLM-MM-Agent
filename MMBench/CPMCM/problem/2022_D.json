{
  "background": "芯片是电子行业的基础，在当前日益复杂的国际形势下，芯片成了各个大国必争的高科技技术。本课题关注网络通信领域的交换芯片，传统的交换芯片功能固定，当出现新的网络协议时，必须重新设计芯片，而芯片从设计到使用，往往需要几年的时间，因此固定功能的交换芯片大大降低了研发效率，为了解决此问题，诞生了可编程的交换芯片。PISA（Protocol Independent Switch Architecture）是当前主流的可编程交换芯片架构之一，其有着和固定功能交换芯片相当的处理速率，同时兼具了可编程性，在未来网络中具有广阔的应用场景[1-2]。在对PISA架构作进一步说明之前我们首先澄清几个基本概念：报文：报文即网络通信中传输的数据包，在网络通信中，用户传输的数据被封装成一个个的数据包进行传输。基本块：基本块是源程序的一个程序片段，对源程序进行基本块划分会将源程序划分为一个个的基本块。至于基本块如何划分本身也是一个值得探讨的问题，但超出了本问题的范围，在此不再多加赘述。流水线：流水线为一系列处理单元串联构成，报文在流水线中按次序依次通过每个处理单元，最终完成处理。流水线各级即是指流水线中各处理单元。PISA架构如图1所示，其包括报文解析（parser）、多级的报文处理流水线（Pipeline Pocket Process）、以及报文重组（Deparser）三个组成部分。报文解析用于识别报文种类；多级的报文处理流水线用于修改报文数据，在实际的PISA架构芯片中，不同的芯片流水线的级数可能不同；报文重组用于报文重新组装。本课题只关注其中多级的报文处理流水线部分。在PISA架构编程模型中，用户使用P4语言描述报文处理行为得到P4程序，再由编译器编译P4程序，进而生成芯片上可以执行的机器码。编译器在编译P4程序时，会首先将P4程序划分为一系列的基本块，再将各基本块排布到流水线各级当中。由于各基本块均会占用一定的芯片资源，将基本块排布到流水线各级即是将各基本块的资源排布到流水线各级当中（即需要确定每个基本块排布到流水线哪一级），因此我们将基本块的排布问题称作PISA架构芯片资源排布问题。在实际的PISA架构芯片的设计中，为了减少连线的复杂度，往往对流水线各级的资源、以及流水线各级之间的资源有着多种多样的约束条件，这一系列复杂的资源约束条件使得资源排布问题尤为困难。然而，芯片的各类资源均有限，越高的资源利用率意味着能够越好的发挥芯片的能力，让芯片支持更多的业务，因此，高资源利用率的资源排布算法对于编译器设计至关重要。",
  "problem_requirement": "本课题需要建立资源排布问题的数学模型，并在此基础上处理如下两个问题。问题1：给定资源约束条件如下：（1）流水线每级的TCAM资源最大为1；（2）流水线每级的HASH资源最大为2；（3）流水线每级的ALU资源最大为56；（4）流水线每级的QUALIFY资源最大为64；（5）约定流水线第0级与第16级，第1级与第17级，...，第15级与第31级为折叠级数，折叠的两级TCAM资源加起来最大为1，HASH资源加起来最大为3。注：如果需要的流水线级数超过32级，则从第32开始的级数不考虑折叠资源限制；（6）有TCAM资源的偶数级数量不超过5；（7）每个基本块只能排布到一级。在上述资源约束条件下进行资源排布，并以占用的流水线级数尽量短为优化目标。请给出资源排布算法，输出基本块排布结果，输出的结果格式如下：问题2：考虑如图3所示的流图，基本块2和基本块3不在一条执行流程上（因为基本块1执行完后要么执行基本块2，要么执行基本块3，基本块2和基本块3不可能都执行）。准确来说，在P4程序流程图中，由一个基本块出发可以到达另一个基本块则两基本块在一条执行流程上，反之不在一条执行流程上。对于这种不在一条执行流程上的基本块，可以共享HASH资源和ALU资源，基本块2和3中任意一个的HASH资源与ALU资源均不超过每级资源限制，基本块2和3即可排布到同一级。据此，对问题1中的约束条件（2）、（3）、（5）作如下更改：（2）流水线每级中同一条执行流程上的基本块的HASH资源之和最大为2；（3）流水线每级中同一条执行流程上的基本块的ALU资源之和最大为56；（5）折叠的两级，对于TCAM资源约束不变，对于HASH资源，每级分别计算同一条执行流程上的基本块占用的HASH资源，再将两级的计算结果相加，结果不超过3。其它约束条件同问题1，更改资源约束条件后重新考虑问题1，给出排布算法，输出基本块排布结果。输出格式同问题1。",
  "dataset_path": [
    "attachment1.csv",
    "attachment2.csv",
    "attachment3.csv"
  ],
  "dataset_description": {
    "attachment1.csv": "各基本块使用的资源信息",
    "attachment2.csv": "各基本块读写的变量信息",
    "attachment3.csv": "各基本块在流程图中的邻接基本块信息"
  },
  "variable_description": [
    {
      "基本块编号": "基本块的唯一标识符",
      "TCAM资源": "基本块占用的TCAM资源数量",
      "HASH资源": "基本块占用的HASH资源数量",
      "ALU资源": "基本块占用的ALU资源数量",
      "QUALIFY资源": "基本块占用的QUALIFY资源数量",
      "读写的变量": "基本块读取和写入的变量信息",
      "邻接基本块": "与当前基本块在流程图中邻接的基本块编号"
    }
  ],
  "addendum": "为了帮助大家进一步理解本问题，在附录C中给出了一个简单的资源排布示例。附录A中详细说明了数据依赖和控制依赖的定义和示例。附录B中解释了TCAM、HASH、ALU、QUALIFY四类资源的作用。"
}