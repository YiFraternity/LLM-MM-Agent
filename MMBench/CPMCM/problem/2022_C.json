{
  "background": "汽车制造厂主要由焊装车间、涂装车间、总装车间构成，每个车间有不同的生产偏好，如：焊装车间由于车身夹具的限制偏向最小车型及配置切换生产，涂装车间由于喷漆（固定每5辆车清洗喷头、颜色切换也需清洗喷头）限制偏向颜色以5的倍数切换生产，总装车间由于人员工时（不同车型及配置人员工时不同）及硬件（零部件数量等）等限制偏向按照车型及配置按比例切换生产。\n\n由于各车间的约束不同导致生产调度无法按照同一序列连续生产，特别是涂装车间与总装车间序列差异较大，这就需要在两个车间之间建立一个具有调序功能的缓存区，即PBS（Painted Body Store，汽车制造涂装-总装缓存调序区），用来将涂装车间的出车序列调整到满足总装车间约束的进车序列。\n\n目前，一天安排上线生产的车辆数介于200-450之间，对于每天要上线生产的车辆，车型、颜色等属性均有变化，目前车型大类有2种，颜色大约有10种，各个车间的产能不定，主要根据当天生产安排调整，涂装车间及总装车间的工艺流程如下：\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image.png}\n    \\caption{涂装车间工艺流程图}\n    \\label{fig:paint_process}\n\\end{figure}\n\n\\begin{itemize}\n\n    \\item 涂装车间处理喷漆工艺，主要是将涂料涂覆于白车身表面，最终形成涂膜或者漆膜或者涂层。涂装车间的详细流程如图1所示，主要是将白车身经过前处理电泳-中涂-色漆-清漆，最终得到修饰完整的车身。\n    \\item 总装车间处理装配工艺，主要是组装剩余零部件，得到最终成品车辆。总装车间的详细流程如图 2 所示，主要由内饰线、底盘线、最终线组成，最终经过测试检验后，成品车辆下线入库。\n\\end{itemize}\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image2.png}\n    \\caption{总装车间工艺流程图}\n    \\label{fig:2}\n\\end{figure}\n\n\\section{问题描述}\n\n根据涂装车间的出车序列通过 PBS 调度调整得到总装车间的进车序列。PBS 具体信息如表 3 所示。\n\n\\begin{table}[h]\n    \\centering\n    \\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|}\n        \\hline\n        & 10 & 9 & 8 & 7 & 6 & 5 & 4 & 3 & 2 & 1 & \\\\\n        \\hline\n        进车道6 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        进车道5 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        返回道 & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & \\\\\n        \\hline\n        进车道4 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & 送车横移机 \\\\\n        \\hline\n        涂装-PBS 接车横移机 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & PBS-总装 \\\\\n        \\hline\n        进车道3 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        进车道2 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        进车道1 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n    \\end{tabular}\n    \\caption{涂装-总装缓存调序区（PBS）示意图}\n    \\label{tab:3}\n\\end{table}\n\nPBS 由涂装-PBS 出车口、接车横移机、进车道 6 条（每条进车道有 10 个停车位、FIFO 结构）、返回道 1 条（有 10 个停车位）、送车横移机及 PBS-总装接车口等7个区域组成。各车道距离等分，每车道宽度2米，两相邻车道间间隔1米。横移机运动时的速度保持一致。\n\n 数据示例：\\begin{tabular}{|c|c|c|c|}\n\\hline\n进车顺序 & 车型 & 动力 & 驱动 \\\\\n\\hline\n1 & A & 混动 & 两驱 \\\\\n\\hline\n2 & B & 混动 & 两驱 \\\\\n\\hline\n3 & A & 燃油 & 两驱 \\\\\n\\hline\n4 & B & 燃油 & 两驱 \\\\\n\\hline\n5 & A & 燃油 & 四驱 \\\\\n\\hline\n6 & B & 燃油 & 四驱 \\\\\n\\hline\n\\end{tabular}\n\nPBS接车横移机：\n1. 将车身从涂装-PBS出车口运送到合适进车道。\n2. 将车身从返回道运送到合适进车道。\n\nPBS送车横移机：\n1. 将所选择车身从进车道运送到PBS-总装接车口。\n2. 将需调序车身从进车道运送到返回道。\n\nPBS约束说明：\n1. 送车横移机不能将返回道的车身送入PBS-总装接车口。\n2. 车身在进车道和返回道的移动方向为图中标注方向，不得改变。\n3. 接车横移机和送车横移机上同一时刻分别最多有一个车身。\n4. 接车横移机和送车横移机在完成任意动作后，必须返回中间初始位置，才可以执行下一步动作。\n5. 接车横移机和送车横移机在执行任何动作过程中，均不能被打断。\n6. 当返回道10停车位有车身，同时接车横移机空闲时，优先处理返回道10停车位上的车身。\n7. 当若干进车道1停车位有车身等候，同时送车横移机空闲时，优先处理最先到达1停车位的车身。\n8. 如果任意进车道1停车位有车身，那么送车横移机不能设置为空闲状态。\n9. 进车道和返回道每个时刻最多容纳10个车身，每个停车位最多容纳1个车身。\n10. 同一车道内，多个车身在不同停车位上的移动可以不同步进行。\n11. 当某车身所在停车位的下一停车位出现空位时，车身必须立即开始向下一停车位移动。\n12. 车身在进车道和返回道不同停车位之间移动的过程中，不能被调度。\\begin{itemize}\n    \\item \\textbf{PBS相关时间数据说明：}\n    \\begin{enumerate}\n        \\item 假定车身由横移机卸载到各进车道10停车位或返回道1停车位，以及由各进车道1停车位或返回道10停车位装载到横移机上的时间均可忽略。\n        \\item 假定车身在涂装-PBS出车口处装载到接车横移机上，以及在4车道出口中间位置处，车身由送车横移机上卸载到PBS-总装接车口，时间均可忽略。\n        \\item 进车过程：任意车身到达涂装-PBS出车口时，处于最中间位置，正对进车道4，接车横移机把车身从该位置运送至不同进车道10停车位并返回至初始位置，对于1-6进车道，消耗时间分别为[18, 12, 6, 0, 12, 18]秒。\n        \\item 出车过程：送车横移机从中间初始位置出发，把各进车道1停车位的车身运送至总装-PBS接车口，处于最中间位置，正对进车道4，对于1-6进车道，消耗时间分别为[18, 12, 6, 0, 12, 18]秒。\n        \\item 车进返回道过程：在有需要时，送车横移机从中间初始位置出发，把各进车道1停车位的车身，运送至返回道1停车位，并返回至初始位置，对于1-6进车道，消耗时间分别为[24, 18, 12, 6, 12, 18]秒。\n        \\item 车出返回道过程：接车横移机从中间初始位置出发，把返回道10停车位的车身，运送至任意进车道10停车位并返回至初始位置，对于1-6进车道，消耗时间分别为[24, 18, 12, 6, 12, 18]秒。\n        \\item 车移动过程：任意车身在进车道/返回道中，从某一停车位移动至后一停车位，消耗时间为9秒。\n    \\end{enumerate}\n    \\item \\textbf{可选的调度手段：}\n    \\begin{enumerate}\n        \\item 接车横移机将当前涂装-PBS出车口队列第一个车身或者返回道10停车位的车身送入任意进车道的10停车位。\n        \\item 送车横移机将任意进车道1停车位的车送入返回道1停车位或者PBS-总装接车口。\n        \\item 接车横移机和送车横移机均可以在一段时间内被设置为空闲状态。\n    \\end{enumerate}\n    \\item \\textbf{输入输出：}\n    \\begin{enumerate}\n        \\item 输入：涂装出车序列清单，可提供多个数据清单。\n        \\item 输出：每个车身在每一秒所处的区域（涂装-PBS出车口、接车横移机、任意进车道任意停车位、返回道任意停车位、送车横移机、PBS-总装接车口），可构建二维矩阵，里面存储区域代码（如 200 辆车在第 1000 秒完成全部调度，则需提交 200*1000 的矩阵）。矩阵中每一个值为各个区域代码，总的区域代码有 74 个，区域与代码的对应关系见附件 3。车身不在上述 74 个区域时，对应矩阵值为空白。具体的输出模板文件见附件 4（模板文件只是一个示意，示意的场景是 50 个车身在第 100 秒完成全部调度，每行代表每个车身各个时间点所处区域，每列代表每个时间点各车身所处区域，其中区域代码没具体填写，具体区域代码见附件 3；具体的输出矩阵，需要根据实际数据和算法计算得到，相关数据见附件 1-3，附件 4 只是示意，不代表本题只有 50 个车身）。由于 PBS 相关时间说明第 1、第 2 两条假设，会出现同一时刻车身处于若干不同区域的情形，则在输出矩阵该车身该时刻对应格子中填入这些区域中最后一个区域的代码。例如，第 0 秒，如果涂装-PBS 出车口第一个车身（1 号车身）被装载到接车横移机上，接着被卸载到 4 进车道 10 号车位，则在 1 号车身第 0 秒格子中填入 4 进车道 10 号车位的区域代码“410”；又例如，第 75 秒，如果 5 号车身从送车横移机上被卸载到 PBS-总装接车口，则在 5 号车身第 75 秒格子中填入 PBS-总装接车口区域代码“3”。\n    \\end{enumerate}\n",
  "problem_requirement": "\\section*{优化目标：}\n1. 混动车型间隔 2 台非混动车型为优，权重系数 0.4。\n2. 四驱车型与两驱车型倾向 1:1 出车序列，权重系数 0.3。\n3. 返回道使用次数倾向于 0，权重系数 0.2。\n4. 倾向总调度时间越短越好，权重系数 0.1。\n\n注：该权重系数用于多目标得分加权，各权重系数相加等于 1。\n\n\\section*{优化目标具体量化逻辑：}\n设置每个优化目标初始分，根据下述逻辑更新得分后，再乘以相应系数，得到最终加权总分（理论最高分 100 分）。\n\n1. 优化目标 1（权重系数 0.4，初始分 100 分）：检查出车序列，找到所有混动车身，从出车序列头部按照先后顺序开始算，计算每连续两辆混动车身之间的非混动车身数，不等于 2 则扣 1 分。\n\n2. 优化目标 2（权重系数 0.3，初始分 100 分）：对出车序列进行分块，判断每一分快中的四驱车型与两驱车型之比是否满足 1:1，若不满足，则扣 1 分。对出车序列分块的依据是：如果序列以 4 开头，则根据从 2 变为 4 将序列进行分块；如果序列以 2 开头，则根据从 4 变为 2 将序列进行分块。例如：如果出车序列为 442242444224（4 代表四驱车型，2 代表两驱车型），则该序列分块结果为：4422，42，44422，4，最后两个分块 44422 和 4 都不满足 1:1，扣 2 分。\n\n3. 优化目标3（权重系数0.2，初始分100分）：统计返回道使用次数，每使用一次扣1分。\n\n4. 优化目标4（权重系数0.1，初始分为100分）：假设出车队列长度为$C$，第一辆车身进入涂装-PBS出车口时刻记为零，以最后一个车身进入PBS-总装接车口的时刻$T$为总完成时间，其理论最快完成时间为$9C+72$（全部走进车道4，出车序列与入车序列相同），其时间惩罚值设置为$0.01 \\times (T - 9C - 72)$，最后目标得分为$100 - $时间惩罚值。\n\n\\section*{请建模完成以下优化问题：}\n\n\\textbf{问题1：} 严格按照PBS约束说明及相关时间数据说明，根据涂装出车序列，考虑PBS区域调度能力及限制，建立PBS优化调度模型，使得总装进车序列尽可能满足总装生产需求。给出将你们的优化调度方案分别应用于附件1和附件2数据的得分结果，并将使用附件1和附件2两套数据的调度输出结果按照附件4格式分别存入result11.xlsx和result12.xlsx。\n\n\\textbf{问题2：} 如果去除PBS约束说明中第6、7两条约束，其余约束不变，根据涂装出车序列，考虑PBS区域调度能力及限制，建立PBS优化调度模型，使得总装进车序列尽可能满足总装生产需求。给出将你们的优化调度方案分别应用于附件1和附件2数据的得分结果，并将使用附件1和附件2两套数据的调度输出结果按照附件4格式分别存入result21.xlsx和result22.xlsx。",
  "dataset_path": [
    "附件1.xlsx",
    "附件2.xlsx",
    "附件3.xlsx",
    "附件4.xlsx"
  ],
  "dataset_description": {
    "附件1": "附件1包含了车辆进车顺序、车型、动力类型和驱动类型的信息。",
    "附件2": "附件2包含了车辆进车顺序、车型、动力类型和驱动类型的信息。",
    "附件3": "附件3包含了不同进车道和返回道的停车位信息，以及涂装-PBS出车口、接车横移机、送车横移机和PBS-总装接车口的位置代码。",
    "附件4": "附件4包含一个名为Sheet1的工作表，内容为车辆调度序列数据。"
  },
  "variable_description": [
    {
      "进车顺序": "车辆进入的顺序编号。",
      "车型": "车辆的型号，如A、B等。",
      "动力": "车辆的动力类型，如燃油、混动等。",
      "驱动": "车辆的驱动类型，如两驱、四驱等。"
    },
    {
      "进车顺序": "车辆进入顺序的编号。",
      "车型": "车辆的型号，如A、B等。",
      "动力": "车辆的动力类型，如燃油、混动等。",
      "驱动": "车辆的驱动类型，如两驱、四驱等。"
    },
    {
      "区域": "表示停车位或设备的位置描述",
      "代码": "表示停车位或设备的唯一标识代码"
    },
    {
      "Unnamed: 0": "行号，表示每行数据的序号",
      "0": "第1列车辆调度数据",
      "1": "第2列车辆调度数据",
      "2": "第3列车辆调度数据",
      "3": "第4列车辆调度数据",
      "4": "第5列车辆调度数据",
      "5": "第6列车辆调度数据",
      "6": "第7列车辆调度数据",
      "7": "第8列车辆调度数据",
      "8": "第9列车辆调度数据",
      "9": "第10列车辆调度数据",
      "10": "第11列车辆调度数据",
      "11": "第12列车辆调度数据",
      "12": "第13列车辆调度数据",
      "13": "第14列车辆调度数据",
      "14": "第15列车辆调度数据",
      "15": "第16列车辆调度数据",
      "16": "第17列车辆调度数据",
      "17": "第18列车辆调度数据",
      "18": "第19列车辆调度数据",
      "19": "第20列车辆调度数据",
      "20": "第21列车辆调度数据",
      "21": "第22列车辆调度数据",
      "22": "第23列车辆调度数据",
      "23": "第24列车辆调度数据",
      "24": "第25列车辆调度数据",
      "25": "第26列车辆调度数据",
      "26": "第27列车辆调度数据",
      "27": "第28列车辆调度数据",
      "28": "第29列车辆调度数据",
      "29": "第30列车辆调度数据",
      "30": "第31列车辆调度数据",
      "31": "第32列车辆调度数据",
      "32": "第33列车辆调度数据",
      "33": "第34列车辆调度数据",
      "34": "第35列车辆调度数据",
      "35": "第36列车辆调度数据",
      "36": "第37列车辆调度数据",
      "37": "第38列车辆调度数据",
      "38": "第39列车辆调度数据",
      "39": "第40列车辆调度数据",
      "40": "第41列车辆调度数据",
      "41": "第42列车辆调度数据",
      "42": "第43列车辆调度数据",
      "43": "第44列车辆调度数据",
      "44": "第45列车辆调度数据",
      "45": "第46列车辆调度数据",
      "46": "第47列车辆调度数据",
      "47": "第48列车辆调度数据",
      "48": "第49列车辆调度数据",
      "49": "第50列车辆调度数据",
      "50": "第51列车辆调度数据",
      "51": "第52列车辆调度数据",
      "52": "第53列车辆调度数据",
      "53": "第54列车辆调度数据",
      "54": "第55列车辆调度数据",
      "55": "第56列车辆调度数据",
      "56": "第57列车辆调度数据",
      "57": "第58列车辆调度数据",
      "58": "第59列车辆调度数据",
      "59": "第60列车辆调度数据",
      "60": "第61列车辆调度数据",
      "61": "第62列车辆调度数据",
      "62": "第63列车辆调度数据",
      "63": "第64列车辆调度数据",
      "64": "第65列车辆调度数据",
      "65": "第66列车辆调度数据",
      "66": "第67列车辆调度数据",
      "67": "第68列车辆调度数据",
      "68": "第69列车辆调度数据",
      "69": "第70列车辆调度数据",
      "70": "第71列车辆调度数据",
      "71": "第72列车辆调度数据",
      "72": "第73列车辆调度数据",
      "73": "第74列车辆调度数据",
      "74": "第75列车辆调度数据",
      "75": "第76列车辆调度数据",
      "76": "第77列车辆调度数据",
      "77": "第78列车辆调度数据",
      "78": "第79列车辆调度数据",
      "79": "第80列车辆调度数据",
      "80": "第81列车辆调度数据",
      "81": "第82列车辆调度数据",
      "82": "第83列车辆调度数据",
      "83": "第84列车辆调度数据",
      "84": "第85列车辆调度数据",
      "85": "第86列车辆调度数据",
      "86": "第87列车辆调度数据",
      "87": "第88列车辆调度数据",
      "88": "第89列车辆调度数据",
      "89": "第90列车辆调度数据",
      "90": "第91列车辆调度数据",
      "91": "第92列车辆调度数据",
      "92": "第93列车辆调度数据",
      "93": "第94列车辆调度数据",
      "94": "第95列车辆调度数据",
      "95": "第96列车辆调度数据",
      "96": "第97列车辆调度数据",
      "97": "第98列车辆调度数据",
      "98": "第99列车辆调度数据",
      "99": "第100列车辆调度数据"
    }
  ],
  "addendum": "\\textbf{参考文献：}\n\\begin{enumerate}\n    \\item Zohali H, Reformulation, linearization, and a hybrid iterated local search algorithm for economic lot-sizing and sequencing in hybrid flow shop problems. Computers \\& Operations Research, 2019, 104:127-138.\n    \\item Shen Z, Tang Q, Huang T. Dynamic Production Scheduling Modeling and Multi-objective Optimization for Automobile Mixed-Model Production. Communications in Computer and Information Science, 2018, 924:25-33.\n    \\item Jalilvand-Nejad A, Fattahi P. A mathematical model and genetic algorithm to cyclic flexible job shop scheduling problem. Journal of Intelligent Manufacturing, 2015, 26(6):1085-1098.\n\\end{enumerate}\\begin{enumerate}\n    \\item Boysen N, Zenker M. A decomposition approach for the car resequencing problem with selectivity banks. Computers \\& Operations Research, 2013, 40(1): 98-108.\n    \\item Yavuz, Mesut. Iterated beam search for the combined car sequencing and level scheduling problem. International Journal of Production Research, 2013, 51(12): 3698-3718.\n    \\item 陈正茂. 基于排序缓冲区的多车间关联排序研究[D]. 华中科技大学, 2008.\n\\end{enumerate}"
}