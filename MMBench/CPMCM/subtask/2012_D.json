{
  "tasks": [],
  "problem_str": "问题背景：\n卫星云图在掌握大气环流、中长期天气预报以及灾害性天气学的研究中有重要作用。它由地球同步卫星上的红外探测仪探测地球上空的温度数据再转换成灰度数据制作而成。附件中定标数据文件k_temp.txt给出了灰度数据与温度数据的转换关系，k_temp.txt内有1024个实型数，依次是图象灰度数据为0到1023所对应的K氏温度值，灰度值为 -1时对应的是地球以外的探测点。[注：地球是被探测温度的唯一来源，如果天空无云，探测到的温度可以看成是地球表面的温度；在有云层的地方，探测到的温度相对较低，且云层越高越厚温度就越低，探测到的温度可看成云层所在区域的温度]。红外探测仪扫描采样时，按步进角(南北方向)和行扫描角（东西方向）均为140微弧（1弧度＝1000000微弧）采样。在卫星与地球中心的连线和地球表面的交点（称为星下点）处的分辨率大约是5公里。本题提供的卫星探测数据文件都是2288×2288的灰度值矩阵，矩阵的每个元素都对应地球上或地球外的一个探测点（或称采样点）。同步卫星离地球中心的高度为42164000米, 星下点在东经86.5度, 北纬0度，星下点对应的矩阵元素位于矩阵的第1145行和第1145列相交处。\n\n为解答本题，首先要确定灰度矩阵中每个元素对应的采样点在地球上的经纬度。地球可视为理想椭球，这个理想椭球可以由地球的一个经过南北极的椭圆截面绕南北极的连线旋转而得到，椭圆截面的长半轴（赤道半径）=6378136.5m, 短半轴（极半径）=6356751.8m；据此就可以将灰度矩阵中非负元素的行列号按上北下南、左西右东的地图规则换算成地球上经纬度坐标，此结果既可用于估算各探测点之间的距离，还可用于在云图上依据海岸线经纬度坐标标出海岸线以方便看图。\n\n观测大气环流情况的一个方法是在卫星云图上标出风矢。风矢的大小和方向由云块移动的速度决定。风矢与风的速度有所不同，如某个台风中一些区域的风速可达每秒五、六十米，而台风（看作云块）中心的移动速度可能仅每小时十多公里。没有云或云块不稳定处的风矢规定为零风矢，这种用云块的移动所定义的风矢被称为云迹风。气象部门已经有一些方法根据变化的卫星云图计算云迹风，这类方法称为云导风方法。计算云迹风时通常将云块大小限定为16×16个像素，搜索范围限定为64×64个像素。\n\n本题的主要目的是希望大家充分利用卫星图像数据及其特点建立尽可能准确地描述实际风矢场的度量模型和算法。\n\n题目提供了我国风云2号卫星获得的三个灰度矩阵，IR1_2030.mat, IR1_2100.mat, IR1_2130.mat，分别表示某天的20:30, 21:00, 21:30时刻红外探测仪探测到的地球上空的温度数据对应的灰度值。又给出了海岸线经纬度坐标数据文件coastline0.txt，文件的第1列为经度(东经), 第2列是纬度(北纬), 每一行2个数据对应海岸线上一点，而特大数据（99999.99，99999.99）表示前一曲线已结束，将要开始下一曲线。\n\n问题要求：\n具体要求解决如下问题：\n\n1. 换算视场坐标。给出灰度矩阵元素行列号对应于经纬度坐标的换算公式，建立矩阵形式的经纬度坐标文本文件，这里矩阵的第i行与第j列，分别对应灰度矩阵的450+i行与450+j列，矩阵元素是（经度，纬度）这种形式的二维数组，给出结果的范围为：灰度矩阵中的第451行至550行，第451列至550列，文本文件取名为jwd.txt；而在论文中给出第500行和第500、501、502列三个交叉点处对应的经纬度。\n\n进而将卫星灰度矩阵IR1_2100.mat转化为卫星云图（参考附录中的卫星云图），并在这个卫星云图上添加海岸线。保存卫星云图为PDF或JPEG文件，取名为spic.pdf 或spic.jpg。\n\n2. 根据三个相邻时刻的卫星数据（IR1_2030.mat, IR1_2100.mat, IR1_2130.mat），用适当的方法建立21：00时刻风矢场的度量模型，给出计算方案，这里限定风矢计算中像素块匹配所选用的窗口大小为16×16个像素，搜索范围限定为64×64个像素。\n\n利用你们的方法计算21：00时刻在各个（整数）经纬度处的二维风矢。确定一个二维风矢需要4个指标：起始点的纬度、经度，风矢的方向（单位：从正北方顺时针方向量得的角度）和大小（单位：米/秒）。计算范围为：南纬40度至北纬40度，东经46度至126度。\n\n在论文中给出上面计算结果中全部非零风矢的个数，并给出在纬度26度，经度分别是52，53，54，57，58（度）处的风矢，这些风矢的表示形式可参照下面问题4中对winsh.txt要求的格式。\n\n给出你们对上述窗口大小和搜索范围的限定的理解或评价。\n\n3. 为了提高像素块匹配质量，取消问题2中窗口大小和搜索范围的限定，利用图像特征匹配等思想，设计能自适应地确定窗口大小和搜索范围的有效方法。进而建立风矢场的度量模型和算法。\n\n利用此模型和算法计算问题2中在纬度26度，经度分别是52，53，54，57，58（度）处的风矢。\n\n分析比较你们建立的这两种风矢计算方法的优劣，结论要有定量数据支撑。提出你们关于云图数据量和云导风风矢场计算研究的建议。\n\n4. 应用附件中全球温度数值预报文件temp3.mat计算问题2中非零风矢所在的等压面（用该时刻该处大气的压强值标志，物理单位为毫巴）。并在论文中给出在纬度26度，经度分别是52，53，54，57，58（度）处附近求出的风矢量所在的等压面。\n\n\\begin{table}[h] \\centering \\begin{tabular}{ccccc}\\hline纬度 & 经度 & 角度（北顺） & 速度（米/秒） & 压强（毫巴） \\\\ \\hline36.07 & 68.43 & 263.00 & 22.00 & 218.00 \\\\ -28.90 & 65.42 & 224.00 & 23.00 & 252.00 \\\\ \\hline\\end{tabular}\\end{table}\n\n最后在问题1中画出的卫星云图上添加所计算出的非零风矢量结果（参照附录中的云导风图）, 并将此标有风矢图标的卫星云图（即云导风图）保存为PDF文件或JPEG文件，取名为winsp.pdf 或winsp.jpg。图一：卫星云图图二：云导风图\n注：图二中三个风矢标记   表示风向都是正北风，风速分别为每秒0至20米，20以上至40米，40米以上。所有不同风向的风矢都可以由上述三个风矢经旋转适当角度而得到。\nAddendum: \n说明：文件temp3.mat按三维数据 (1:641,1:1280,1:36) 存放，具体存放的数据按“等压面高度”从上到下分36层，每层大气压相同。同一层是个矩阵，有641行，每行纬度相同；有1280列，每列经度相同，相邻两行(列)相差0.28125度，排列顺序是从北到南，从东到西。从上到下各层对应的等压面的压强值(单位毫巴)分别为：\n\n0.1, 0.2, 0.5, 1, 1.5, 2, 3, 4, 5, 7, 10, 20, 30, 50, 70, 100, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 850, 900, 925, 950, 975, 1000。\n\n矩阵的元素是矩阵行列所对应的经纬度坐标点在指定等压面的温度值。\n\n附录：\n图一：卫星云图\n图二：云导风图\n注：图二中三个风矢标记表示风向都是正北风，风速分别为每秒0至20米，20以上至40米，40米以上。所有不同风向的风矢都可以由上述三个风矢经旋转适当角度而得到。\nDataset Path:\n['IR1_2030.mat', 'IR1_2100.mat', 'IR1_2130.mat', 'k_temp.txt', 'coastline0.txt']\n\nData Description:\n该数据集包含三幅时序红外探测灰度图像（均为 2288×2288 的双精度矩阵），分别对应 20:30、21:00、21:30 三个观测时刻（样例中用 aa、bb、cc 表示），矩阵单元存储的是像元的灰度值（用于后续定标/转换）；配套的定标文件 k_temp 给出灰度值 0–1023 到温度的映射关系（用于将灰度矩阵转换为物理温度值），其中映射值为 -1 的灰度点表示探测点不在地球表面（无效/空值）；同时提供海岸线文件 coastline0，按行给出经度、纬度对，特殊数对 (99999.99, 99999.99) 用作前一条曲线（多段线或多边形）结束的分隔符，便于重建海岸线或做掩膜与可视化。总体上该数据集适用于时序红外影像的辐射定标、温度反演、海陆边界分析及基于像元灰度与定标表的像元有效性筛选，使用时需按定标表将灰度值转换为温度并处理 coastline0 中的分段标记以获得连续海岸线几何。",
  "problem": {
    "background": "卫星云图在掌握大气环流、中长期天气预报以及灾害性天气学的研究中有重要作用。它由地球同步卫星上的红外探测仪探测地球上空的温度数据再转换成灰度数据制作而成。附件中定标数据文件k_temp.txt给出了灰度数据与温度数据的转换关系，k_temp.txt内有1024个实型数，依次是图象灰度数据为0到1023所对应的K氏温度值，灰度值为 -1时对应的是地球以外的探测点。[注：地球是被探测温度的唯一来源，如果天空无云，探测到的温度可以看成是地球表面的温度；在有云层的地方，探测到的温度相对较低，且云层越高越厚温度就越低，探测到的温度可看成云层所在区域的温度]。红外探测仪扫描采样时，按步进角(南北方向)和行扫描角（东西方向）均为140微弧（1弧度＝1000000微弧）采样。在卫星与地球中心的连线和地球表面的交点（称为星下点）处的分辨率大约是5公里。本题提供的卫星探测数据文件都是2288×2288的灰度值矩阵，矩阵的每个元素都对应地球上或地球外的一个探测点（或称采样点）。同步卫星离地球中心的高度为42164000米, 星下点在东经86.5度, 北纬0度，星下点对应的矩阵元素位于矩阵的第1145行和第1145列相交处。\n\n为解答本题，首先要确定灰度矩阵中每个元素对应的采样点在地球上的经纬度。地球可视为理想椭球，这个理想椭球可以由地球的一个经过南北极的椭圆截面绕南北极的连线旋转而得到，椭圆截面的长半轴（赤道半径）=6378136.5m, 短半轴（极半径）=6356751.8m；据此就可以将灰度矩阵中非负元素的行列号按上北下南、左西右东的地图规则换算成地球上经纬度坐标，此结果既可用于估算各探测点之间的距离，还可用于在云图上依据海岸线经纬度坐标标出海岸线以方便看图。\n\n观测大气环流情况的一个方法是在卫星云图上标出风矢。风矢的大小和方向由云块移动的速度决定。风矢与风的速度有所不同，如某个台风中一些区域的风速可达每秒五、六十米，而台风（看作云块）中心的移动速度可能仅每小时十多公里。没有云或云块不稳定处的风矢规定为零风矢，这种用云块的移动所定义的风矢被称为云迹风。气象部门已经有一些方法根据变化的卫星云图计算云迹风，这类方法称为云导风方法。计算云迹风时通常将云块大小限定为16×16个像素，搜索范围限定为64×64个像素。\n\n本题的主要目的是希望大家充分利用卫星图像数据及其特点建立尽可能准确地描述实际风矢场的度量模型和算法。\n\n题目提供了我国风云2号卫星获得的三个灰度矩阵，IR1_2030.mat, IR1_2100.mat, IR1_2130.mat，分别表示某天的20:30, 21:00, 21:30时刻红外探测仪探测到的地球上空的温度数据对应的灰度值。又给出了海岸线经纬度坐标数据文件coastline0.txt，文件的第1列为经度(东经), 第2列是纬度(北纬), 每一行2个数据对应海岸线上一点，而特大数据（99999.99，99999.99）表示前一曲线已结束，将要开始下一曲线。",
    "problem_requirement": "具体要求解决如下问题：\n\n1. 换算视场坐标。给出灰度矩阵元素行列号对应于经纬度坐标的换算公式，建立矩阵形式的经纬度坐标文本文件，这里矩阵的第i行与第j列，分别对应灰度矩阵的450+i行与450+j列，矩阵元素是（经度，纬度）这种形式的二维数组，给出结果的范围为：灰度矩阵中的第451行至550行，第451列至550列，文本文件取名为jwd.txt；而在论文中给出第500行和第500、501、502列三个交叉点处对应的经纬度。\n\n进而将卫星灰度矩阵IR1_2100.mat转化为卫星云图（参考附录中的卫星云图），并在这个卫星云图上添加海岸线。保存卫星云图为PDF或JPEG文件，取名为spic.pdf 或spic.jpg。\n\n2. 根据三个相邻时刻的卫星数据（IR1_2030.mat, IR1_2100.mat, IR1_2130.mat），用适当的方法建立21：00时刻风矢场的度量模型，给出计算方案，这里限定风矢计算中像素块匹配所选用的窗口大小为16×16个像素，搜索范围限定为64×64个像素。\n\n利用你们的方法计算21：00时刻在各个（整数）经纬度处的二维风矢。确定一个二维风矢需要4个指标：起始点的纬度、经度，风矢的方向（单位：从正北方顺时针方向量得的角度）和大小（单位：米/秒）。计算范围为：南纬40度至北纬40度，东经46度至126度。\n\n在论文中给出上面计算结果中全部非零风矢的个数，并给出在纬度26度，经度分别是52，53，54，57，58（度）处的风矢，这些风矢的表示形式可参照下面问题4中对winsh.txt要求的格式。\n\n给出你们对上述窗口大小和搜索范围的限定的理解或评价。\n\n3. 为了提高像素块匹配质量，取消问题2中窗口大小和搜索范围的限定，利用图像特征匹配等思想，设计能自适应地确定窗口大小和搜索范围的有效方法。进而建立风矢场的度量模型和算法。\n\n利用此模型和算法计算问题2中在纬度26度，经度分别是52，53，54，57，58（度）处的风矢。\n\n分析比较你们建立的这两种风矢计算方法的优劣，结论要有定量数据支撑。提出你们关于云图数据量和云导风风矢场计算研究的建议。\n\n4. 应用附件中全球温度数值预报文件temp3.mat计算问题2中非零风矢所在的等压面（用该时刻该处大气的压强值标志，物理单位为毫巴）。并在论文中给出在纬度26度，经度分别是52，53，54，57，58（度）处附近求出的风矢量所在的等压面。\n\n\\begin{table}[h] \\centering \\begin{tabular}{ccccc}\\hline纬度 & 经度 & 角度（北顺） & 速度（米/秒） & 压强（毫巴） \\\\ \\hline36.07 & 68.43 & 263.00 & 22.00 & 218.00 \\\\ -28.90 & 65.42 & 224.00 & 23.00 & 252.00 \\\\ \\hline\\end{tabular}\\end{table}\n\n最后在问题1中画出的卫星云图上添加所计算出的非零风矢量结果（参照附录中的云导风图）, 并将此标有风矢图标的卫星云图（即云导风图）保存为PDF文件或JPEG文件，取名为winsp.pdf 或winsp.jpg。图一：卫星云图图二：云导风图\n注：图二中三个风矢标记   表示风向都是正北风，风速分别为每秒0至20米，20以上至40米，40米以上。所有不同风向的风矢都可以由上述三个风矢经旋转适当角度而得到。",
    "dataset_path": [
      "IR1_2030.mat",
      "IR1_2100.mat",
      "IR1_2130.mat",
      "k_temp.txt",
      "coastline0.txt"
    ],
    "dataset_description": {
      "IR1_2030": "三个时刻（20:30, 21:00, 21:30）的红外探测灰度矩阵，大小为2288×2288。",
      "IR1_2100": "三个时刻（20:30, 21:00, 21:30）的红外探测灰度矩阵，大小为2288×2288。",
      "IR1_2130": "三个时刻（20:30, 21:00, 21:30）的红外探测灰度矩阵，大小为2288×2288。",
      "k_temp": "定标文件，包含灰度值0~1023对应的温度值，灰度值为-1表示地球以外探测点。",
      "coastline0": "海岸线经纬度文件，每行两列（经度、纬度），特殊值(99999.99,99999.99)表示前一条曲线结束。"
    },
    "variable_description": [
      {
        "aa": "2288×2288 双精度矩阵，表示 20:30 时刻的卫星红外探测灰度数据"
      },
      {
        "bb": "2288×2288 双精度矩阵，表示 21:00 时刻的卫星红外探测灰度数据"
      },
      {
        "cc": "2288×2288 双精度矩阵，表示 21:30 时刻的卫星红外探测灰度数据"
      }
    ],
    "addendum": "说明：文件temp3.mat按三维数据 (1:641,1:1280,1:36) 存放，具体存放的数据按“等压面高度”从上到下分36层，每层大气压相同。同一层是个矩阵，有641行，每行纬度相同；有1280列，每列经度相同，相邻两行(列)相差0.28125度，排列顺序是从北到南，从东到西。从上到下各层对应的等压面的压强值(单位毫巴)分别为：\n\n0.1, 0.2, 0.5, 1, 1.5, 2, 3, 4, 5, 7, 10, 20, 30, 50, 70, 100, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 850, 900, 925, 950, 975, 1000。\n\n矩阵的元素是矩阵行列所对应的经纬度坐标点在指定等压面的温度值。\n\n附录：\n图一：卫星云图\n图二：云导风图\n注：图二中三个风矢标记表示风向都是正北风，风速分别为每秒0至20米，20以上至40米，40米以上。所有不同风向的风矢都可以由上述三个风矢经旋转适当角度而得到。",
    "data_summary": "Dataset Path:\n['IR1_2030.mat', 'IR1_2100.mat', 'IR1_2130.mat', 'k_temp.txt', 'coastline0.txt']\n\nData Description:\n该数据集包含三幅时序红外探测灰度图像（均为 2288×2288 的双精度矩阵），分别对应 20:30、21:00、21:30 三个观测时刻（样例中用 aa、bb、cc 表示），矩阵单元存储的是像元的灰度值（用于后续定标/转换）；配套的定标文件 k_temp 给出灰度值 0–1023 到温度的映射关系（用于将灰度矩阵转换为物理温度值），其中映射值为 -1 的灰度点表示探测点不在地球表面（无效/空值）；同时提供海岸线文件 coastline0，按行给出经度、纬度对，特殊数对 (99999.99, 99999.99) 用作前一条曲线（多段线或多边形）结束的分隔符，便于重建海岸线或做掩膜与可视化。总体上该数据集适用于时序红外影像的辐射定标、温度反演、海陆边界分析及基于像元灰度与定标表的像元有效性筛选，使用时需按定标表将灰度值转换为温度并处理 coastline0 中的分段标记以获得连续海岸线几何。",
    "data_description": {
      "IR1_2030": "三个时刻（20:30, 21:00, 21:30）的红外探测灰度矩阵，大小为2288×2288。",
      "IR1_2100": "三个时刻（20:30, 21:00, 21:30）的红外探测灰度矩阵，大小为2288×2288。",
      "IR1_2130": "三个时刻（20:30, 21:00, 21:30）的红外探测灰度矩阵，大小为2288×2288。",
      "k_temp": "定标文件，包含灰度值0~1023对应的温度值，灰度值为-1表示地球以外探测点。",
      "coastline0": "海岸线经纬度文件，每行两列（经度、纬度），特殊值(99999.99,99999.99)表示前一条曲线结束。"
    },
    "problem_str": "问题背景：\n卫星云图在掌握大气环流、中长期天气预报以及灾害性天气学的研究中有重要作用。它由地球同步卫星上的红外探测仪探测地球上空的温度数据再转换成灰度数据制作而成。附件中定标数据文件k_temp.txt给出了灰度数据与温度数据的转换关系，k_temp.txt内有1024个实型数，依次是图象灰度数据为0到1023所对应的K氏温度值，灰度值为 -1时对应的是地球以外的探测点。[注：地球是被探测温度的唯一来源，如果天空无云，探测到的温度可以看成是地球表面的温度；在有云层的地方，探测到的温度相对较低，且云层越高越厚温度就越低，探测到的温度可看成云层所在区域的温度]。红外探测仪扫描采样时，按步进角(南北方向)和行扫描角（东西方向）均为140微弧（1弧度＝1000000微弧）采样。在卫星与地球中心的连线和地球表面的交点（称为星下点）处的分辨率大约是5公里。本题提供的卫星探测数据文件都是2288×2288的灰度值矩阵，矩阵的每个元素都对应地球上或地球外的一个探测点（或称采样点）。同步卫星离地球中心的高度为42164000米, 星下点在东经86.5度, 北纬0度，星下点对应的矩阵元素位于矩阵的第1145行和第1145列相交处。\n\n为解答本题，首先要确定灰度矩阵中每个元素对应的采样点在地球上的经纬度。地球可视为理想椭球，这个理想椭球可以由地球的一个经过南北极的椭圆截面绕南北极的连线旋转而得到，椭圆截面的长半轴（赤道半径）=6378136.5m, 短半轴（极半径）=6356751.8m；据此就可以将灰度矩阵中非负元素的行列号按上北下南、左西右东的地图规则换算成地球上经纬度坐标，此结果既可用于估算各探测点之间的距离，还可用于在云图上依据海岸线经纬度坐标标出海岸线以方便看图。\n\n观测大气环流情况的一个方法是在卫星云图上标出风矢。风矢的大小和方向由云块移动的速度决定。风矢与风的速度有所不同，如某个台风中一些区域的风速可达每秒五、六十米，而台风（看作云块）中心的移动速度可能仅每小时十多公里。没有云或云块不稳定处的风矢规定为零风矢，这种用云块的移动所定义的风矢被称为云迹风。气象部门已经有一些方法根据变化的卫星云图计算云迹风，这类方法称为云导风方法。计算云迹风时通常将云块大小限定为16×16个像素，搜索范围限定为64×64个像素。\n\n本题的主要目的是希望大家充分利用卫星图像数据及其特点建立尽可能准确地描述实际风矢场的度量模型和算法。\n\n题目提供了我国风云2号卫星获得的三个灰度矩阵，IR1_2030.mat, IR1_2100.mat, IR1_2130.mat，分别表示某天的20:30, 21:00, 21:30时刻红外探测仪探测到的地球上空的温度数据对应的灰度值。又给出了海岸线经纬度坐标数据文件coastline0.txt，文件的第1列为经度(东经), 第2列是纬度(北纬), 每一行2个数据对应海岸线上一点，而特大数据（99999.99，99999.99）表示前一曲线已结束，将要开始下一曲线。\n\n问题要求：\n具体要求解决如下问题：\n\n1. 换算视场坐标。给出灰度矩阵元素行列号对应于经纬度坐标的换算公式，建立矩阵形式的经纬度坐标文本文件，这里矩阵的第i行与第j列，分别对应灰度矩阵的450+i行与450+j列，矩阵元素是（经度，纬度）这种形式的二维数组，给出结果的范围为：灰度矩阵中的第451行至550行，第451列至550列，文本文件取名为jwd.txt；而在论文中给出第500行和第500、501、502列三个交叉点处对应的经纬度。\n\n进而将卫星灰度矩阵IR1_2100.mat转化为卫星云图（参考附录中的卫星云图），并在这个卫星云图上添加海岸线。保存卫星云图为PDF或JPEG文件，取名为spic.pdf 或spic.jpg。\n\n2. 根据三个相邻时刻的卫星数据（IR1_2030.mat, IR1_2100.mat, IR1_2130.mat），用适当的方法建立21：00时刻风矢场的度量模型，给出计算方案，这里限定风矢计算中像素块匹配所选用的窗口大小为16×16个像素，搜索范围限定为64×64个像素。\n\n利用你们的方法计算21：00时刻在各个（整数）经纬度处的二维风矢。确定一个二维风矢需要4个指标：起始点的纬度、经度，风矢的方向（单位：从正北方顺时针方向量得的角度）和大小（单位：米/秒）。计算范围为：南纬40度至北纬40度，东经46度至126度。\n\n在论文中给出上面计算结果中全部非零风矢的个数，并给出在纬度26度，经度分别是52，53，54，57，58（度）处的风矢，这些风矢的表示形式可参照下面问题4中对winsh.txt要求的格式。\n\n给出你们对上述窗口大小和搜索范围的限定的理解或评价。\n\n3. 为了提高像素块匹配质量，取消问题2中窗口大小和搜索范围的限定，利用图像特征匹配等思想，设计能自适应地确定窗口大小和搜索范围的有效方法。进而建立风矢场的度量模型和算法。\n\n利用此模型和算法计算问题2中在纬度26度，经度分别是52，53，54，57，58（度）处的风矢。\n\n分析比较你们建立的这两种风矢计算方法的优劣，结论要有定量数据支撑。提出你们关于云图数据量和云导风风矢场计算研究的建议。\n\n4. 应用附件中全球温度数值预报文件temp3.mat计算问题2中非零风矢所在的等压面（用该时刻该处大气的压强值标志，物理单位为毫巴）。并在论文中给出在纬度26度，经度分别是52，53，54，57，58（度）处附近求出的风矢量所在的等压面。\n\n\\begin{table}[h] \\centering \\begin{tabular}{ccccc}\\hline纬度 & 经度 & 角度（北顺） & 速度（米/秒） & 压强（毫巴） \\\\ \\hline36.07 & 68.43 & 263.00 & 22.00 & 218.00 \\\\ -28.90 & 65.42 & 224.00 & 23.00 & 252.00 \\\\ \\hline\\end{tabular}\\end{table}\n\n最后在问题1中画出的卫星云图上添加所计算出的非零风矢量结果（参照附录中的云导风图）, 并将此标有风矢图标的卫星云图（即云导风图）保存为PDF文件或JPEG文件，取名为winsp.pdf 或winsp.jpg。图一：卫星云图图二：云导风图\n注：图二中三个风矢标记   表示风向都是正北风，风速分别为每秒0至20米，20以上至40米，40米以上。所有不同风向的风矢都可以由上述三个风矢经旋转适当角度而得到。\nAddendum: \n说明：文件temp3.mat按三维数据 (1:641,1:1280,1:36) 存放，具体存放的数据按“等压面高度”从上到下分36层，每层大气压相同。同一层是个矩阵，有641行，每行纬度相同；有1280列，每列经度相同，相邻两行(列)相差0.28125度，排列顺序是从北到南，从东到西。从上到下各层对应的等压面的压强值(单位毫巴)分别为：\n\n0.1, 0.2, 0.5, 1, 1.5, 2, 3, 4, 5, 7, 10, 20, 30, 50, 70, 100, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 850, 900, 925, 950, 975, 1000。\n\n矩阵的元素是矩阵行列所对应的经纬度坐标点在指定等压面的温度值。\n\n附录：\n图一：卫星云图\n图二：云导风图\n注：图二中三个风矢标记表示风向都是正北风，风速分别为每秒0至20米，20以上至40米，40米以上。所有不同风向的风矢都可以由上述三个风矢经旋转适当角度而得到。\nDataset Path:\n['IR1_2030.mat', 'IR1_2100.mat', 'IR1_2130.mat', 'k_temp.txt', 'coastline0.txt']\n\nData Description:\n该数据集包含三幅时序红外探测灰度图像（均为 2288×2288 的双精度矩阵），分别对应 20:30、21:00、21:30 三个观测时刻（样例中用 aa、bb、cc 表示），矩阵单元存储的是像元的灰度值（用于后续定标/转换）；配套的定标文件 k_temp 给出灰度值 0–1023 到温度的映射关系（用于将灰度矩阵转换为物理温度值），其中映射值为 -1 的灰度点表示探测点不在地球表面（无效/空值）；同时提供海岸线文件 coastline0，按行给出经度、纬度对，特殊数对 (99999.99, 99999.99) 用作前一条曲线（多段线或多边形）结束的分隔符，便于重建海岸线或做掩膜与可视化。总体上该数据集适用于时序红外影像的辐射定标、温度反演、海陆边界分析及基于像元灰度与定标表的像元有效性筛选，使用时需按定标表将灰度值转换为温度并处理 coastline0 中的分段标记以获得连续海岸线几何。"
  },
  "problem_background": "卫星云图在掌握大气环流、中长期天气预报以及灾害性天气学的研究中有重要作用。它由地球同步卫星上的红外探测仪探测地球上空的温度数据再转换成灰度数据制作而成。附件中定标数据文件k_temp.txt给出了灰度数据与温度数据的转换关系，k_temp.txt内有1024个实型数，依次是图象灰度数据为0到1023所对应的K氏温度值，灰度值为 -1时对应的是地球以外的探测点。[注：地球是被探测温度的唯一来源，如果天空无云，探测到的温度可以看成是地球表面的温度；在有云层的地方，探测到的温度相对较低，且云层越高越厚温度就越低，探测到的温度可看成云层所在区域的温度]。红外探测仪扫描采样时，按步进角(南北方向)和行扫描角（东西方向）均为140微弧（1弧度＝1000000微弧）采样。在卫星与地球中心的连线和地球表面的交点（称为星下点）处的分辨率大约是5公里。本题提供的卫星探测数据文件都是2288×2288的灰度值矩阵，矩阵的每个元素都对应地球上或地球外的一个探测点（或称采样点）。同步卫星离地球中心的高度为42164000米, 星下点在东经86.5度, 北纬0度，星下点对应的矩阵元素位于矩阵的第1145行和第1145列相交处。\n\n为解答本题，首先要确定灰度矩阵中每个元素对应的采样点在地球上的经纬度。地球可视为理想椭球，这个理想椭球可以由地球的一个经过南北极的椭圆截面绕南北极的连线旋转而得到，椭圆截面的长半轴（赤道半径）=6378136.5m, 短半轴（极半径）=6356751.8m；据此就可以将灰度矩阵中非负元素的行列号按上北下南、左西右东的地图规则换算成地球上经纬度坐标，此结果既可用于估算各探测点之间的距离，还可用于在云图上依据海岸线经纬度坐标标出海岸线以方便看图。\n\n观测大气环流情况的一个方法是在卫星云图上标出风矢。风矢的大小和方向由云块移动的速度决定。风矢与风的速度有所不同，如某个台风中一些区域的风速可达每秒五、六十米，而台风（看作云块）中心的移动速度可能仅每小时十多公里。没有云或云块不稳定处的风矢规定为零风矢，这种用云块的移动所定义的风矢被称为云迹风。气象部门已经有一些方法根据变化的卫星云图计算云迹风，这类方法称为云导风方法。计算云迹风时通常将云块大小限定为16×16个像素，搜索范围限定为64×64个像素。\n\n本题的主要目的是希望大家充分利用卫星图像数据及其特点建立尽可能准确地描述实际风矢场的度量模型和算法。\n\n题目提供了我国风云2号卫星获得的三个灰度矩阵，IR1_2030.mat, IR1_2100.mat, IR1_2130.mat，分别表示某天的20:30, 21:00, 21:30时刻红外探测仪探测到的地球上空的温度数据对应的灰度值。又给出了海岸线经纬度坐标数据文件coastline0.txt，文件的第1列为经度(东经), 第2列是纬度(北纬), 每一行2个数据对应海岸线上一点，而特大数据（99999.99，99999.99）表示前一曲线已结束，将要开始下一曲线。",
  "problem_requirement": "具体要求解决如下问题：\n\n1. 换算视场坐标。给出灰度矩阵元素行列号对应于经纬度坐标的换算公式，建立矩阵形式的经纬度坐标文本文件，这里矩阵的第i行与第j列，分别对应灰度矩阵的450+i行与450+j列，矩阵元素是（经度，纬度）这种形式的二维数组，给出结果的范围为：灰度矩阵中的第451行至550行，第451列至550列，文本文件取名为jwd.txt；而在论文中给出第500行和第500、501、502列三个交叉点处对应的经纬度。\n\n进而将卫星灰度矩阵IR1_2100.mat转化为卫星云图（参考附录中的卫星云图），并在这个卫星云图上添加海岸线。保存卫星云图为PDF或JPEG文件，取名为spic.pdf 或spic.jpg。\n\n2. 根据三个相邻时刻的卫星数据（IR1_2030.mat, IR1_2100.mat, IR1_2130.mat），用适当的方法建立21：00时刻风矢场的度量模型，给出计算方案，这里限定风矢计算中像素块匹配所选用的窗口大小为16×16个像素，搜索范围限定为64×64个像素。\n\n利用你们的方法计算21：00时刻在各个（整数）经纬度处的二维风矢。确定一个二维风矢需要4个指标：起始点的纬度、经度，风矢的方向（单位：从正北方顺时针方向量得的角度）和大小（单位：米/秒）。计算范围为：南纬40度至北纬40度，东经46度至126度。\n\n在论文中给出上面计算结果中全部非零风矢的个数，并给出在纬度26度，经度分别是52，53，54，57，58（度）处的风矢，这些风矢的表示形式可参照下面问题4中对winsh.txt要求的格式。\n\n给出你们对上述窗口大小和搜索范围的限定的理解或评价。\n\n3. 为了提高像素块匹配质量，取消问题2中窗口大小和搜索范围的限定，利用图像特征匹配等思想，设计能自适应地确定窗口大小和搜索范围的有效方法。进而建立风矢场的度量模型和算法。\n\n利用此模型和算法计算问题2中在纬度26度，经度分别是52，53，54，57，58（度）处的风矢。\n\n分析比较你们建立的这两种风矢计算方法的优劣，结论要有定量数据支撑。提出你们关于云图数据量和云导风风矢场计算研究的建议。\n\n4. 应用附件中全球温度数值预报文件temp3.mat计算问题2中非零风矢所在的等压面（用该时刻该处大气的压强值标志，物理单位为毫巴）。并在论文中给出在纬度26度，经度分别是52，53，54，57，58（度）处附近求出的风矢量所在的等压面。\n\n\\begin{table}[h] \\centering \\begin{tabular}{ccccc}\\hline纬度 & 经度 & 角度（北顺） & 速度（米/秒） & 压强（毫巴） \\\\ \\hline36.07 & 68.43 & 263.00 & 22.00 & 218.00 \\\\ -28.90 & 65.42 & 224.00 & 23.00 & 252.00 \\\\ \\hline\\end{tabular}\\end{table}\n\n最后在问题1中画出的卫星云图上添加所计算出的非零风矢量结果（参照附录中的云导风图）, 并将此标有风矢图标的卫星云图（即云导风图）保存为PDF文件或JPEG文件，取名为winsp.pdf 或winsp.jpg。图一：卫星云图图二：云导风图\n注：图二中三个风矢标记   表示风向都是正北风，风速分别为每秒0至20米，20以上至40米，40米以上。所有不同风向的风矢都可以由上述三个风矢经旋转适当角度而得到。",
  "problem_analysis": "这道题目围绕利用地球同步卫星红外云图通过像元灰度/温度时序求取“云迹风”——即用云块位移估计的风矢场——展开，表面上是若干具体的数据处理和算法实现任务，但从建模的系统视角看，其核心是把多源物理与观测约束（卫星几何、地球椭球几何、传感器定标、对流层温度剖面和云体辐射特性、云场的时空演化规律）以明确的数学关系联系起来，构造一个既能在观测空间上稳定估算位移又能在物理空间上解释为某一等压面风速的度量体系。把问题放回到更宏观的目标：一方面，我们要解出每个像元在地球表面或云顶的经纬位置（精确地从“像素坐标”到“地理坐标”的反演），以便把像素位移转换成地面或大气层上的物理位移；另一方面，要把像素的亮温（经由定标表 k_temp）和全球数值预报的温度场结合起来，确定云顶所属的等压面，从而将云迹移动解释为该等压面的风场。围绕这两个目标，模型设计必须同时考虑测量几何（卫星高度、视场角和逐像素扫描角）、地球椭球几何畸变、云的辐射-热力学属性（亮温对应的层位或云顶温度）以及云块自身的动力学演变（形变、成生与消失）。这些目标共同塑造了解题思路：先完成几何定位与温度反演，再在地理网格上做时序匹配以估计位移，最后用气温剖面将亮温映射到等压面并报告风矢和对应压强。\n\n在此过程中必须识别并批判性审视若干显性与隐性假设及约束，这些前提直接决定了所得风矢的物理解释与可信度。显性的几何假设包括把地球当作规则旋转的参考椭球（给出赤道与极半径），以及卫星为地球同步、位置、星下点坐标与扫描角步进已知；这些允许把传感器的视场坐标与地球表面经纬转换为可逆的映射。但是隐含的关键假设包括：像元亮温可代表“云顶温度”（即对流层或云层的热辐射主导且没有复杂的多层云叠加效应），云块在两个相邻观测时刻内主要是平移而非显著形变或融散，使得块匹配是合理的；云顶的视差（视线与地面交点因云高而偏差）可以用通过温度-高度映射来校正或在一定精度范围内忽略；以及所选窗口大小和搜索范围对于局部云结构和典型移动尺度是合适的。这些假设均有一定脆弱性：例如云的垂直结构复杂导致亮温不总等于单一云顶温度；云体在30分钟尺度上可发生显著形变和生成消失，使得简单的块匹配引入错误匹配；观测靠近视场边缘时像素地面投影面积变化和畸变会影响位移到物理速度的转换。所有这些约束会影响模型对风场的解释：若忽略视差或误判云顶高度，则把像素位移直接转换为地面速度会产生系统性的偏差；若窗口与搜索参数设定不当，会遗漏高速系统或产生错误矢量。\n\n不同组成部分之间存在密切的耦合与潜在张力，且这些耦合决定了解法的复杂度。一方面，像素到经纬的映射依赖卫星高度、像素索引与扫描角，因此必须先完成精确的几何投影（包括行列索引对应的步进角转换为视线方向、与地球椭球求解交点等），其结果又影响后续在地理坐标上对窗口的定义与距离度量；另一方面，云顶高度的估计通常需利用亮温与大气温度剖面（temp3.mat）作匹配或插值，从而将亮温映射到等压面；但该映射需要可靠的大气背景场以及对云的辐射性质（如黑体近似）假设，任一不准确都会影响等压面的判断和视差校正。由此产生的张力在于为减少几何或高度不确定性倾向于做更多的物理校正（增加复杂度与不确定性来源），而为保持算法稳健倾向于在图像空间采用更为经验的块匹配或光流法（牺牲物理可解释性）。此外，在如何将图像位移解释为“风”时存在张力：云迹代表云顶的运动，不一定是同一压面的气流或代表近地面真风；不同云种（高层卷云、对流云）所代表的动力层位差异很大，直接把云迹作为某一高度的风场需要用温度剖面确定或至少用高度定性区分。\n\n问题在空间尺度和时间尺度上也呈现复杂行为。空间上，像素地面投影的尺度随观测位置远离星下点而变大并产生几何畸变，导致在图像像素域做“固定窗口”的块匹配实际上对应变尺度的地面区域，从而影响分辨率与误差统计。时间上，题中给出的三个时刻间隔为30分钟，时间间隔太长可能出现云场演化导致匹配误差，时间间隔太短则位移小、受噪声影响大。云层高度变化、垂直风切变与云内湍流等动态因素在不同时间尺度上改变云体形态与速度分布，进而影响估计的稳定性。尤其在强对流或台风环境下，云体局部风速（例如风眼周围）与云块的整体移动速度可能差别很大，单一尺度的匹配方法无法同时捕捉局部的高频运动与大尺度的平移。因此，模型应采用多尺度、逐层或分级的处理策略以兼顾分辨率与稳健性。\n\n从方法论层面，存在多种可替代的表述与求解路径，它们会显著影响算法设计与结果解释。传统且题目限定的一种是基于固定窗口的块匹配（例如16×16像素窗口、64×64像素搜索范围，使用归一化互相关或平方差最小化），这是简单、易行并有明确参数解释的方案，但其局限在于对窗口大小、搜索范围和相似度阈值敏感，遇到低对比或快速移动时容易失败。另一类替代思路是基于光流（例如Lucas-Kanade或Farnebäck）或相位相关方法，这类方法在局部平滑或频域中直接估计连续位移场，能提供亚像素精度且更利于保持场的空间一致性，但对亮度守恒假设敏感。第三类是基于特征点的稀疏匹配（SIFT/ORB/流形匹配等），先在图像上检测稳定特征并做描述子匹配，再通过鲁棒估计推断运动场，这种方法在大尺度形变或多尺度结构上表现好，但难以覆盖没有显著纹理的区域。更综合的现代方案是利用金字塔多分辨率块匹配或光流，结合特征匹配做初始位移估计，并以局部窗口大小和搜索范围自适应地根据局部图像结构、预测位移和相关峰值宽度调整参数。不同方法在精度、覆盖度、抗噪性和计算开销之间存在权衡；因此在实际应用中常采用混合策略（例如先做粗尺度匹配确定大致位移，再在细尺度用小窗口做精确搜索，或用特征匹配约束光流解）。\n\n不确定性在整个建模过程中无处不在，主要来源包括传感器与定标误差（k_temp映射的误差和标定点的缺失）、几何定位误差（星下点位置误差、扫描角步进精度、卫星姿态微小变化）、亮温到云顶高度/等压面的映射不确定性（受辐射传输、多层云、非黑体效应影响）、时间序列匹配的不确定性（噪声、云形态演化、遮挡）、以及后续的速度转换与水平距离估算中因椭球投影导致的局部尺度差异。量化这些不确定性需要为每个风矢赋予置信度指标，例如匹配相关峰值的幅度与峰锐度、窗口内温度梯度或方差、在多尺度上匹配结果的一致性、以及与背景NWP场的偏差等。评估与验证策略应包括与独立资料比较（例如同区域的气象探空、散射计或地面雷达风探测的同时观测），以及内部一致性检查（如时间连贯性、场的平滑性和守恒约束）。\n\n在方法选择与参数设定上需要作出理性取舍并提出具体改进建议。固定窗口16×16与搜索64×64的限定有明确优点：参数简单、计算成本相对可控、对中尺度云块匹配性能通常良好，且易于与既有的气象工作流程（历史云导风经验）对接。但其局限是当实际云块尺寸远小于或大于窗口时，会丢失分辨率或引入混合像元效应；当真实位移超过搜索半径时会产生漏检；对纹理不明显区域匹配质量差。因此应采用自适应策略：在图像域先评估局部纹理/对比度（如结构张量或梯度能量），对高纹理区域采用小窗口以提高空间分辨率并进行亚像素插值；对低纹理区域使用更大窗口以稳定估计；以粗尺度匹配或从数值模式预报获得的先验场确定搜索中心和范围，从而显著减少错误匹配并提升检测最大位移能力。实现上建议采用金字塔金法（coarse-to-fine）结合相关性阈值与RANSAC类的鲁棒估计来去除孤立的错误矢量，并给每个矢量分配置信度分数。\n\n关于云顶高度与等压面映射，直接把亮温在temp3.mat垂直剖面上做“温度等值匹配”是一种可行的近似：在给定经纬点处扫描36层温度阵列，找到与观测亮温最接近的层（或在临近层之间线性插值)，并把对应层的压强作为该云顶的近似压强。但这一做法隐含云是“黑体且亮温等于其物理温度”的假设，忽略了云的发射率、透射和背景下层温度的贡献以及可能的多层云导致的亮温偏暖或偏冷。此外，不同层的温度垂直梯度（温度剖面平缓时匹配不确定）和气温场的时间误差（temp3为数值预报场，其与实际剖面存在偏差）都会引入高度估计误差。比较稳健的方案应结合辐射传输模型或至少对找不到精确匹配的点采用不确定度标注，并在统计意义上报告误差带。还应实施视差校正：已知云顶高度后，可以利用卫星与星下点几何关系将像元地理位置从地表投影点偏移回云顶的真实投影点，从而校正因云高度引起的地理位移误差，这在远离星下点（视角大）或云高较大时尤为重要。\n\n在实际实现层面需要权衡计算代价与精度。原始图像为2288×2288的高分辨率矩阵，整个区域做密集块匹配、特别是在允许较大搜索范围时，计算量非常可观。推荐采用金字塔分辨率、先做稀疏特征匹配以获得粗位移并限制稠密搜索范围，或利用GPU并行化实现互相关或FFT相位相关法来加速。还应在投影步骤上尽量先把图像重投影到规则经纬格或等距投影（如经纬网格或等距圆锥）再做匹配，这样位移到米/秒的转换统一且更物理，但重投影本身会引入插值误差，需权衡。\n\n最后，建模应被视为一个迭代且开放的过程。初步模型可以先采用题目给定的固定窗口/搜索范围块匹配做基线，并报告非零风矢的数量、在指定经纬点的风矢与对应压强及置信度。在此基础上，应实施敏感性分析：改变窗口尺寸、搜索范围、时间间隔、匹配指标和金字塔层数，观察结果的稳健性与误差行为；并用独立观测或同区其他资料评估偏差分布。在发现系统性偏差（例如在高纬或视场边缘的风速偏低或偏高）时，应回到几何定位、视差校正或温度-高度映射的假设检验中去调整模型。建议研究流程中把不确定性定量化作为常规产出，例如为每向量给出置信度区间、并在可视化时用颜色/粗细表达置信度，从而避免对个别低置信测量作过度解释。长期来看，改进方向包括：把辐射传输与云物理引入云顶高度估计；结合数值预报的背景风场做贝叶斯融合或同化以提高物理一致性；利用机器学习方法在大量历史云图与实测风场间学习更稳健的位移-风映射及不确定性；并建立一套自动化的质量控制与性能评价体系以支持运用到气象预报与灾害监测中。\n\n综上所述，这个问题的核心不只是工程性地实现像素匹配以得到风矢，而是如何在卫星观测几何、辐射物理与大气动力学三者之间建立清晰的、能量化不确定性的映射关系，设计出既能在图像域取得稳定位移估计又能在物理域提供有意义高度/压强归属的风场产品。方法选择应基于对局部云场纹理、移动尺度、计算资源与最终用途（例如实时预报还是事后气候学分析）的权衡，始终伴随不确定性评估与逐步验证—这才是一套有可解释性与可应用性的云导风建模体系。",
  "modeling_solution": "总体方案概述与基本假设。为把卫星灰度矩阵的时序信息转换为物理意义上的云迹风场，需要按三个步骤系统处理：先做几何投影把像元行列号映射为地球表面或云顶的经纬度；再在图像序列上用时空匹配算法求出像元的水平位移并将像素位移转为米/秒的风矢；最后结合全球数值预报的温度剖面把每个非零风矢归属到相应的等压面（以压强值表示）。本建模在保证物理可解释性的前提下，采用可逐步精化的混合方法：以解析几何与射线-椭球交点求解保证定位精度，采用两类图像匹配方法（基线固定窗口互相关与改进的自适应多尺度光流/特征融合）来估计位移，并用温度剖面做亮温到等压面的反演。为使问题可求解并兼顾现实，声明如下基本假设：卫星为严格地球同步，其位置相对于地心已知且位于赤道平面；传感器逐像元的视角可用固定步进角线性映射于像元索引（步进角Δ=140×10^-6 弧度）；像元亮度经定标表可视为亮温（单值），且在大多数像元处亮温近似等于云顶黑体温度（对多层云或半透明云此近似引入不确定）；云迹在相邻时刻主要以平移为主（30分钟尺度），形变与生命周期变化对大多数中尺度云块为次要效应；temp3.mat给出的等压面温度场可作为建立亮温—等压面映射的参考背景场。以上假设会在模型的置信度与不确定度评估中被量化并用于灵活选择更保守的匹配阈值。\n\n几何定位与像元到经纬的映射关系。设地球为旋转椭球，其赤道长半轴 a=6378136.5 m, 极短半轴 b=6356751.8 m, 离心率 e^2 = (a^2 - b^2)/a^2。卫星在地心坐标系下的位置向量记为 S，|S| = Hs = 42164000 m，星下点经度 λ0 = 86.5°，纬度 φ0 = 0°，因此在地心坐标系（ECEF）中可取 S = Hs [cosφ0 cosλ0, cosφ0 sinλ0, sinφ0]。像元索引(i,j)的参考中心为 (i0,j0) = (1145,1145)。定义像元的水平（东西）角偏移 α = (j - j0) Δφ，垂直（南北）角偏移 β = (i0 - i) Δθ，其中 Δφ = Δθ = 140 × 10^-6 弧度，符号约定保证北向为正。视线单位向量在卫星本地坐标系中可写为 v_s = [cosβ cosα, cosβ sinα, sinβ]（轴定义为：第一分量指向“地球中心方向在赤道面内的参考方位”，第二分量指向东向，第三分量指向北向，上式可根据具体右手坐标系作符号调整，但几何解法对符号一致性要求严格）。将 v_s 由卫星本地坐标旋转到 ECEF（通过经度 λ0 与纬度 φ0 的旋转矩阵 R_s2e），得到在地心坐标系中的射线方向 v。解线性射线方程 P(t)=S + t v 与椭球面交点，交点满足 (x(t)^2/a^2) + (y(t)^2/a^2) + (z(t)^2/b^2) = 1。代入得到关于 t 的二次方程 At^2 + Bt + C = 0，其中 A = (v_x^2 + v_y^2)/a^2 + v_z^2/b^2, B = 2[(S_x v_x + S_y v_y)/a^2 + S_z v_z/b^2], C = (S_x^2 + S_y^2)/a^2 + S_z^2/b^2 - 1。选择两个根中正且较小的那个 t*，交点 P = S + t* v 即为视线与地球椭球的交点（若判别式小于零或所有根为负，像元对应地球外，视为无效点）。把 P=(x,y,z) 转换为地理经纬（经度 λ = atan2(y,x)，准地心纬 θ = atan2(z, sqrt(x^2+y^2) )），并用标准迭代方法把准地心纬转为地理纬（地表法线修正迭代），或用现成的椭球正算算法得到地理纬 φ，使得经纬对(λ,φ)即为所求像元对应的地理坐标。对矩阵形式输出，按题目要求只需生成第451至550行与第451至550列（即以第450偏移）对应的 (经度,纬度) 二维数组并保存为文本 jwd.txt，同时在论文中给出第500行与第500、501、502列（对应全局矩阵索引）的精确经纬值。可并行化地对所有有效像元计算该变换并记录无效点。\n\n云顶高度与等压面反演。把灰度矩阵通过 k_temp.txt 映射为亮温场 T_b(i,j)。在每个有效经纬点，用 temp3.mat 中最近格点（或双线性插值）的垂直温度剖面 T_p(k) (k=1..36, 每层对应压强 p_k 给定) 做匹配，找到 k 使得 T_p(k) 在该点附近最接近 T_b，若 T_p 在 k,k+1 之间单调，则对压强做线性插值 p_c = interp(T_b; T_p(k),T_p(k+1), p_k,p_{k+1})。若 T_b 超出剖面范围则标注为边界情况并取最近端点压强。该压强 p_c 视为云顶所在的等压面压强值。此方法隐含云为不透明的黑体假设；为减小误差，建议对低相关性匹配点或亮温靠近地表/背景温度的点给出较低置信度。若需要对视差进行校正，应把云顶高度转换为几何高度并在射线-椭球交点计算时用椭球外半径 a+h_cld、b+h_cld（近似在地球法线方向上外扩）重新求交点以得到云顶真实经纬。\n\n风矢度量基线方法（题目限定：16×16窗口，64×64搜索）。在21:00时刻 (t0) 对待求网格中的每个整数经纬点（南纬40至北纬40，东经46至126，按1度步长或按题目“各个（整数）经纬处”），把其对应的图像像素位置 p0(i0,j0) 用上述定位函数求出并在 IR1_2100 图像中截取以 p0 为中心的 16×16 窗口模板。以 IR1_2030（t-Δ）和 IR1_2130（t+Δ）作为参考帧做匹配：在 t0 与 t+Δ 或 t0 与 t-Δ 之间在目标帧的 64×64 区域内用归一化互相关（NCC）或归一化互方差最小化做滑动匹配，得到最优偏移 (Δi,Δj) 对应像素位移。为兼顾鲁棒性采用三帧一致性约束：要求从 t0 到 t+Δ 的位移和从 t-Δ 到 t0 的位移在中间帧满足前向-后向一致（即反向匹配位移约为负值）并保留高 NCC 峰值与峰值比指标超过阈值的结果；对 NCC 峰周围做二次抛物线或高斯拟合以实现亚像素精度。像素位移通过地理坐标差值或更严格地把模版中心与匹配中心各自求得的经纬用大地测量公式（Vincenty 或球面 haversine 已在小距离时误差极小）转换为米：Δx_E ≈ R_east(φ) * cosφ * Δλ_rad, Δy_N ≈ R_north(φ) * Δφ_rad，其中本地曲率半径 R_north = a(1 - e^2)/(1 - e^2 sin^2 φ)^{3/2}, R_east = a/(1 - e^2 sin^2 φ)^{1/2}. 速度向量 V = (V_N,V_E) = (Δy_N, Δx_E)/Δt（Δt=1800s）。风向按题目约定“从正北顺时针方向量得的角度”为 θ = atan2(V_E, V_N) 转换为度数并规范到 [0,360)。为每个矢量记录匹配质量指标（NCC峰值、峰值比、局部温度方差、前向后向偏差），并把低质量匹配作为零风矢或标注为低置信度。整个基线方法计算量可估为每个点在 64×64 搜索窗口内对 16×16 模板逐像素做相关，复杂度高但在题目限定的经纬点稀疏网格（整数度点）可行；若密集求解需采用金字塔或FFT加速。\n\n自适应多尺度特征融合方法（取消窗口与搜索固定限定）。为提高匹配在低对比或大位移情形下的稳定性，提出一个由稀疏特征匹配引导的稠密多尺度光流融合算法。首先在较粗尺度图像（如下采样 by 8 或 4）上用相位相关或块互相关快速估计全场粗位移场，从数值模式或粗估计建立位移先验。其次在原始或中间尺度上检测稳定特征点（SIFT/ORB/Harris），对这些点做描述子匹配并用RANSAC剔除明显错误以得到稀疏可靠位移向量。用这些稀疏向量与粗场作为初始场和约束，在局部区域利用改进的光流变分模型最小化能量函数 E(u,v)=∑_x ρ_photo(I_t(x) - I_{t+Δ}(x + (u,v))) + λ ∑_x ρ_smooth(∇(u,v)), 其中ρ_photo采用对异常值更鲁棒的Huber或Lorentz函数，ρ_smooth鼓励局部平滑但允许不连续（以保留锋面结构）。局部窗口大小由结构张量的特征值决定：当局部梯度能量大（存在清晰纹理、角点），采用小窗或小正则化以提高分辨率；当纹理弱时扩大窗口并提高平滑权重以稳定估计。搜索范围由粗尺度预测与NWP先验限制，以避免大量错误匹配。该方法在多尺度上迭代更新位移并以稀疏匹配结果作强约束，可同时输出每点的不确定度估计（通过 Hessian 近似或基于残差的协方差估计）。对部分存在形变的云块，可引入局部仿射模板更新或使用描述子匹配而非亮度守恒，从而提高鲁棒性。该方法相比固定窗口能更好处理大位移（超过64像素）、尺度变化和低对比区域，同时提供质量可度量的置信度标志，但计算量与实现复杂度显著增加，推荐在关键区域或按需密集计算时采用。\n\n不确定度量化和质量控制。对每个风矢计算匹配质量指标并用误差传播得到速度不确定度：把像素位置测得误差 σ_pix（来自 NCC 峰宽与噪声水平、亚像素拟合误差）换算为水平距离误差 σ_dist≈√[(∂x/∂λ)^2 σ_λ^2 + (∂y/∂φ)^2 σ_φ^2]，速度误差 σ_v = σ_dist / Δt。对多来源不确定度（定位、定标、温度-压强映射）采用独立近似并合成。用前向-后向一致性、场内平滑性检验、与 NWP 背景场差值分布以及时间连续性检验来剔除异常矢量。统计层面给出非零风矢数量、速度分布、方向玫瑰图及按纬度带的统计量。\n\n求解实现与计算资源。几何投影与每像元交点求解为解析二次方程，可向量化并在多核CPU或GPU上并行处理。基线块匹配在稀疏经纬格上可用直接 NCC；若需对全场稠密估计，建议采用图像金字塔、FFT 相位相关（对大搜索有效）或GPU加速的互相关实现。自适应多尺度光流需要迭代求解稀疏线性系统，适合用GPU或并行化数值库（CUDA/OpenCL或MPI实现）以达到可用性能。预期精度：在星下点附近、纹理良好且云块稳定时，亚像素定位（0.1像素）和30分钟间隔对应的速度精度可达数米/秒量级；在视场边缘或纹理弱的区域不确定度显著增大。建议实施敏感性分析：改变窗口大小（8,16,32）、搜索半径（32,64,128）、时间间隔（15,30,60分钟）和光流正则化参数，统计非零向量数量、平均速度与与NWP差异来评估稳健性。\n\n验证与后续改进。验证策略包括三帧一致性检验、与 temp3 中同时间步长的风场（若可用）做局部对比、以及在有地面或雷达观测的区域与实测风场交叉验证。针对高误差区域提出改进：把辐射传输模型（考虑云发射率与多层云）纳入亮温—云顶映射，使用更精确的云顶高度反演（结合可见/微波数据或探索性同化），并基于NWP背景场做贝叶斯融合以减少孤立误匹配。长期扩展可包括学习型组件：用历史云图与真值风场训练深度网络预测位移初值或直接回归风矢，以提高在纹理稀少或复杂形变条件下的性能；引入不确定性量化框架（贝叶斯光流或蒙特卡洛扰动）以给出置信区间。此外，在可视化上把置信度以矢量颜色/粗细编码并在论文与产品中明确标注低置信区间，从而为下游气象用途提供可靠性信息。\n\n结论。上述模型在保持物理可解释性的同时兼顾图像处理的鲁棒性：解析几何保证经纬定位精度，温度剖面反演为每个云迹提供物理高度/等压面归属，基线块匹配与自适应多尺度融合方法分别提供简单可复制与高性能精确估计的方案。对题目所需输出（jwd.txt，经纬点风矢、等压面压强、并在云图上叠加风矢图）按此流程可完成，同时各步骤的置信度与敏感性评估可为结果的解释提供量化支持。随着更多观测与计算资源的投入，可进一步把辐射传输、同化与学习方法引入以持续提高风矢产品的准确性与可用性。",
  "task_descriptions": [
    "子任务1（几何定位与卫星云图制作）——目标是把给定 IR1_2100 的 2288×2288 灰度矩阵精确地从像元行列索引映射到地理经纬坐标，生成并保存指定子矩阵的经纬文本输出 jwd.txt（对应灰度矩阵第451行至第550行、第451列至第550列，即按题目约定矩阵元素(i,j) 对应原灰度矩阵第(450+i,450+j)位置），并将 IR1_2100 按 k_temp.txt 做辐射定标生成可视化卫星云图并在其上叠加 coastline0.txt 给出的海岸线后保存为 spic.pdf 或 spic.jpg；为保证可重复实现，需按以下明确步骤和技术要点完成：1) 输入与常量：读取 IR1_2100.mat（2288×2288 灰度矩阵）、k_temp.txt（灰度 0–1023 对应亮温）、coastline0.txt（经度、纬度，(99999.99,99999.99) 为段分隔符），并采用卫星与地球参数：星下点经度 λ0=86.5°、纬度 φ0=0°、中心像素 (i0,j0)=(1145,1145)、像元步进角 Δ=140×10^-6 rad、同步卫星与地心距离 Hs=42164000 m，以及地球椭球长半轴 a=6378136.5 m、短半轴 b=6356751.8 m。2) 灰度→亮温：用 k_temp.txt 做查表/插值，将 IR1_2100 的每一有效灰度值转换为亮温（K），对于灰度为 -1 或超出表的点标记为无效。3) 像元到观测射线定义：对每个像元索引 (i,j) 计算水平偏角 α = (j − j0)·Δ（东西向，东正）和垂直偏角 β = (i0 − i)·Δ（南北向，北正），在卫星本体坐标系构造视线单位向量 v_s = [cosβ·cosα, cosβ·sinα, sinβ]（按所定轴约定），并用星下点经纬构造旋转矩阵将 v_s 旋转到地心ECEF坐标得到 v；卫星位置向量取 S = Hs·[cosφ0·cosλ0, cosφ0·sinλ0, sinφ0]。4) 射线—椭球交点求解：对每条射线求解参数 t 使得 P(t)=S + t v 与椭球方程 (x^2 + y^2)/a^2 + z^2/b^2 = 1 相交，代入得到关于 t 的二次方程 At^2 + Bt + C = 0，系数按 A = (v_x^2+v_y^2)/a^2 + v_z^2/b^2, B = 2[(S_x v_x + S_y v_y)/a^2 + S_z v_z/b^2], C = (S_x^2 + S_y^2)/a^2 + S_z^2/b^2 − 1；若判别式 < tol(≈0 或小负数因数值误差) 则判定该像元不与地球相交并置无效；否则取两个根中正且较小的 t* 得到交点 P = S + t* v。5) ECEF→地理经纬转换：由 P 计算经度 λ = atan2(y,x)；采用椭球地理纬（geodetic latitude）计算方法（如迭代解法或 Bowring 公式）把 P 的坐标转换为地理纬度 φ（确保满足椭球法线定义，以精确反映经纬），并将经度纬度规范化为度数。6) 输出 jwd.txt：对要求的子矩阵（451–550 行与列）按行优先写入经度、纬度对，建议每行对应矩阵的一个行并在行内按列顺序输出每个元素为“lon,lat”或以两列并列的数值对形式，缺测/地球外点以特定标志（如 NaN,NaN 或 -9999）表示；在文稿中明确给出第500行、第500/501/502列对应的精确经纬数值。7) 云图与海岸线叠加：用亮温矩阵按合适色标（线性或分段伪彩色）生成可视化图像；为把 coastline0.txt 中经纬点叠加到图像上，将 coastline 经纬坐标映射回图像像素坐标（即在先前得到的整个或某个覆盖区域的像素→经纬数组上做最近邻或双线性逆映射/插值，或为效率先建立经纬到像素的空间查找结构如 KD-tree），忽略或分段处理 99999.99 标记以得到多段线，并以显著颜色和线宽绘制海岸线。8) 数值与实现细节：所有射线求解与坐标变换应向量化并分块并行计算以提高速度，二次方程判别的数值阈值、地理纬迭代收敛容限（例如 1e-12 rad）和无效点处理规则须在代码中固定；建议使用 MATLAB（内建 .mat 支持与矩阵运算）或 Python+NumPy/SciPy，并可用 pyproj/geographiclib 做 ECEF↔geodetic 互转以保证数值精度。9) 最终产物：保存 jwd.txt（451–550×451–550 经纬对）、保存经 k_temp 定标后的 IR1_2100 云图文件 spic.pdf 或 spic.jpg（含颜色条说明亮温尺度）并在该图中叠加海岸线，所有文件名和无效点表示方法在交付清单中注明，以便审阅与后续处理；此外在实现中应记录用于重现的常量与坐标系约定（单位、角度方向、中心像素索引、Δ 值、星下点经纬和椭球参数）。",
    "子任务 2（基线云导风估算，固定窗口与搜索范围）：在已具备将任意给定经纬点转换为 IR1_2100 图像像素坐标的映射函数（或查表）并能读取三幅时序原始灰度矩阵 IR1_2030.mat、IR1_2100.mat、IR1_2130.mat 的前提下，任务目标是在 21:00（IR1_2100）时刻对每个整数经纬格点（纬度从 −40° 到 +40°、经度从 46° 到 126°，步长 1°）按题目限定参数（模板窗口 16×16 像素、搜索窗口 64×64 像素、时间间隔 Δt = 1800 s）计算云迹风矢并输出每个非零风矢的起始点纬度/经度、方向（从正北顺时针角度，度）及大小（米/秒）；为保证结果质量，每个矢量还应伴随匹配质量指标并经前向-后向三帧一致性检验。具体操作步骤如下：对每一目标经纬点，用像素映射获得其在 IR1_2100 中的像素中心 (i0,j0)；若该中心或其周边导致的 16×16 模板或 64×64 搜索窗超出图像边界或包含无效灰度（如 k_temp 对应无效值），则该点标记为无效或输出零风矢；否则从 IR1_2100 提取以 (i0,j0) 为中心的 16×16 模板（在必要时用亚像素插值复原中心），并在 IR1_2030 与 IR1_2130 的各自以 (i0,j0) 为中心的 64×64 区域上分别以逐像素滑动、步长 1 像素执行归一化互相关（NCC）或归一化平方差最小化匹配以找出最佳匹配位置；对每个最佳峰值在其邻域做三点二次抛物线或高斯拟合以获得亚像素偏移 (Δi,Δj) 并记录对应的 NCC 峰值与峰值比（第一峰与第二峰之比）等质量指标。利用前帧（t0←t−Δ）和后帧（t0→t+Δ）的匹配结果施加三帧一致性约束——即前向位移与后向位移方向相反且幅值相近，或者前后向预测在中间帧的误差小于用户设定阈值（建议阈值可选，例如前后向误差 < 2 像素且 NCC 峰值 > 0.6），否则将该点标注为低置信或零风矢。把模板中心与匹配中心两点的像素坐标各自通过像素→经纬映射反算为地理坐标（lat,lon），并用精确测地算法（推荐使用 GeographicLib / Vincenty）计算两点间的水平距离和方位角（方位角按从正北顺时针计）；将该距离在 Δt 时间内除以 Δt 得到风速大小（m/s），取方位角作为风向（若使用方位角 α，则速度分量可写为 V_N = distance·cosα/Δt, V_E = distance·sinα/Δt，方向以 α 度给出并规约到 [0,360)）。实现细节与质量控制：为减小亮度整体偏移影响，匹配前可对模板与搜索区做零均值归一化或高通滤波；对 NCC 峰值使用峰值比和局部温度方差作为判据以剔除纹理不足或平原区域的伪匹配；记录并输出每矢量的质量字段（NCC_peak、peak_ratio、forward-backward_error、local_variance）；对计算效率建议在稀疏经纬格上串行或并行化逐点处理（可用 MATLAB、Python+NumPy/OpenCV 的 matchTemplate(TM_CCORR_NORMED) 或 FFT 互相关加速），并对所有边界与无效像元做明确跳过规则。最终输出文件应列出所有被接受的非零风矢（每行至少含：latitude, longitude, direction_deg_clockwise_from_North, speed_m_per_s）并单独统计非零矢总数；同时生成便于叠加到云图的矢量列表与与每矢量对应的质量指标，以便后续可视化与筛选。",
    "子任务3目标是设计并实现一个自适应、多尺度且可量化不确定度的云迹风矢估算法，用于替代固定窗口/固定搜索半径的方法，并将每个风矢归属到temp3.mat中给定的等压面（毫巴）并做视差校正；该子任务的输入为三时刻红外灰度图像（IR1_2030.mat、IR1_2100.mat、IR1_2130.mat）、灰度→亮温映射表k_temp.txt、全球温度剖面temp3.mat（36层及对应压强）、以及用于像素↔经纬的投影/几何映射函数（已提供或按题目几何关系可复现）；输出为每个目标经纬点的风矢（起点纬度、经度；方向：从正北顺时针度数；大小：m/s）、对应等压面压强（毫巴）及每矢量的质量指标和不确定度估计，并特别计算并报告纬度26°、经度52、53、54、57、58°处的风矢与压强。方法步骤与技术细节如下：1) 亮温与剖面匹配——先用k_temp将三幅图像转换为亮温场，针对每个经纬点在temp3.mat上用双线性插值获得垂直温度剖面，按最接近亮温做层间线性插值以求出对应压强 p_c，并用局部剖面温差作为压强不确定度估计；2) 云顶几何高度与视差校正——将压强 p_c 与所插值层的温度剖面结合用静力学近似（或标准大气积分）换算为近似几何高度 h_cld，并在射线—椭球求交时把球体外扩 h_cld 来重新计算云顶的精确经纬位置，从而校正因视角引起的地面投影偏移；3) 多尺度位移先验——构建图像金字塔（典型层数 3–5，降采样因子 2），在最粗层用相位相关或FFT块互相关快速估计大尺度位移场作为先验和搜索中心；4) 稀疏特征引导——在中/细尺度用稳健特征检测（如ORB或SIFT）提取描述子并做匹配，应用RANSAC剔除离群，得到高置信稀疏位移集合作为约束；5) 局部自适应模板与搜索策略——对欲估点或局部网格先计算结构张量（或梯度能量、局部方差），根据纹理强度自适应确定模板尺寸（例如纹理强时 8–16 像素，弱纹理时 24–48 像素）和正则化权重，搜索范围由金字塔先验位移的置信区间与局部纹理不确定度联合决定（例如搜索半径 = max(8, ceil(α·|prior_disp|) + β·(1/texture_metric))，α,β为调参常数）；6) 稠密位移求解——在中/细尺度以稀疏匹配和粗场为先验，求解带鲁棒数据项的变分光流能量（E = Σ ρ_photo(I_t(x) − I_{t+Δ}(x+u)) + λ Σ ρ_smooth(∇u)），其中ρ_photo采用Huber或Lorentz以容忍亮度变化，ρ_smooth允许边界保留（TV或Huber on gradients）；用增量/多尺度迭代求解（每层若干迭代，典型10–30次），并在每次迭代中用稀疏匹配做强约束或作为边界条件以稳定解；7) 亚像素精度与不确定度估计——对每个点的位移用高阶插值/二次拟合做亚像素精修，并基于残差、数据项二阶近似（Hessian）及前向-后向一致性计算像素误差σ_pix，进而用测地转换传播得到速度不确定度σ_v；8) 输出与质量控制——为每个风矢输出方向、速度、对应压强 p_c、NCC/残差峰值、峰值比、前向-后向误差、局部纹理指标与σ_v，应用阈值（如残差阈值、峰值比阈值、前后误差阈值）标注或剔除低置信矢量；9) 实现与工具建议——推荐使用 Python + NumPy/SciPy + OpenCV（SIFT/ORB、calcOpticalFlowFarneback 可作为参考实现）或基于CUDA的光流库以加速，多尺度与稀疏-稠密混合求解适合并行化；地理/投影转换使用pyproj或GeographicLib，矩阵插值用SciPy。参数（如金字塔层数、Huber阈值、λ范围、模板尺寸上下限、迭代次数）需通过小规模验证调整并记录。最终按指定输出格式为目标经纬点（尤其是26°与52/53/54/57/58°）提供风矢与对应等压面压强及置信度，以便后续可视化与定量比较。",
    "子任务 4（不确定度量化、质量控制、验证和产品输出）的目标是对每个计算得到的风矢及其对应等压面值提供定量的不确定度估计、统一的质量控制（QC）判据、标准化的数据与图形产品输出格式，并给出可重复的验证与敏感性测试流程；该子任务的输入为每个矢量的原始匹配信息（像素位移及其残差、NCC/相关峰值与峰值比、前向—后向匹配误差、模板局部方差/结构张量等）、像素角步进（Δ，弧度）、对应位置的经纬（φ）、图像时间间隔 Δt 以及用于亮温→等压面反演时的温度剖面数据（用于估算压强匹配残差）；实现应按以下步骤严格执行并输出规定字段：1) 像素误差到速度误差的传播——从匹配过程得到的亚像素拟合误差 σ_pix（像素单位，来自二次拟合或残差统计）先转换为角度不确定度 σ_angle = σ_pix × Δ（弧度），再用局部曲率半径将角度不确定度转换为经向/纬向米单位误差：σ_lon = R_east(φ)·cosφ·σ_angle, σ_lat = R_north(φ)·σ_angle（其中 R_north, R_east 由椭球参数计算），水平位移不确定度 σ_dist = sqrt(σ_lon^2 + σ_lat^2)，速度不确定度即 σ_v = σ_dist / Δt；2) 等压面（压强）不确定度估算——用亮温与同点温度剖面插值的残差 δT 来估计压强不确定度：在剖面邻近层以有限差分近似求 dT/dp（K/mbar），若 |dT/dp| 足够大则 σ_p ≈ δT / |dT/dp|，若梯度接近零则标为高不确定度或采用蒙特卡洛法（见下）；3) 联合不确定度与蒙特卡洛校验——当需估计联合不确定度或非线性耦合效应时，对像素位置误差（以高斯分布 N(0,σ_pix) 为模型）与亮温测量误差/剖面误差联合进行蒙特卡洛采样（典型 1000 次），将每次扰动后的位移与压强重算以得到速度与压强的经验置信区间（例如 95% 区间）；4) 质量控制判据与置信度评分——为每个矢量计算并存储关键质量指标：NCC_peak、peak_ratio（第一/第二峰比）、forward_back_error（像素或米）、local_variance、residual_RMS 与蒙特卡洛样本的 σ_v、σ_p；基于这些量构建规范化置信度分数 conf∈[0,1]（例如 conf = w1·norm(NCC_peak) + w2·norm(peak_ratio) + w3·(1 − norm(forward_back_error)) + w4·norm(local_variance) ，权重 wi 可默认设置并记录），并按阈值（示例：NCC_peak<0.5 或 peak_ratio<1.2 或 forward_back_error>2 pixels → 标记为低置信/剔除；conf<0.4 → 标记为可疑）进行自动标签；5) 场内一致性与异常剔除——执行空间一致性检测：在每个矢量的邻域（例如 3×3 或 5×5）计算速度向量的中位数和 MAD，若某矢量与邻域中位数偏差超过设定倍数（例如 3×MAD）且自身质量低，则把该点替换为缺测或用邻域加权平滑值填补；同时进行时间一致性检查（若有多时刻结果）：检验相邻时间步的速度变化是否在物理可接受范围内，异常点标注并记录。6) 统计汇总与诊断输出——计算并保存总体与分区统计量：非零矢总数、按纬带/经度带的速度均值/中位/标准差、方向玫瑰图数据、置信度分布、剔除率及剔除原因分布；同时生成诊断图表（速度直方图、置信度累计分布、空间分布的误差热图）以便快速评估产品质量。7) 规范化产品文件与可视化要求——数值输出采用逗号分隔文本或 CSV（并同时提供 GeoJSON 或 netCDF 以便 GIS/后续处理），每条非零矢记录至少包含字段： latitude_deg, longitude_deg, direction_deg_clockwise_from_North, speed_m_per_s, pressure_mbar, sigma_speed_m_per_s, sigma_pressure_mbar, NCC_peak, peak_ratio, forward_back_error_pixels, local_variance, confidence_score, qc_flag（OK/LOW_CONF/REJECT）; 同时生成可视化产品：一幅带有速度矢量叠加的卫星云图（矢量颜色或粗细按速度档分类：0–20、20–40、>40 m/s，矢量透明度或颜色饱和度按 confidence_score 显示），并保存为 PDF/JPEG，另生成单独的风矢图（winsp）及图例说明三类速度符号和置信度编码；8) 验证与敏感性测试流程——规定必须执行的验证步骤：前向—后向一致性统计、邻域平滑一致性检验、用蒙特卡洛产生的置信区间评估主要不确定来源占比，并做参数敏感性试验（改变模板大小、搜索半径、NCC 阈值与光流正则化强度等若干组合）并记录关键输出指标（非零矢数量、平均速度、剔除率与平均置信度）的变化；当存在独立参考数据（探空、雷达或同格局数值预报）时计算偏差与 RMSE、偏差分布并在报告中列出。9) 实现与工具建议——建议使用可复现且广泛可用的软件栈：Python（NumPy, SciPy, pandas）、OpenCV（计算相关峰、特征检测）、pyproj/GeographicLib（经纬与米转换）、matplotlib/Cartopy（绘图）、并行化（multiprocessing 或 GPU）以加速蒙特卡洛与批量误差传播；所有阈值、权重与配置参数应写入可版本化的配置文件并在输出元数据中记录以保证可重复性。10) 错误与缺测处理——明确缺测编码（例如 NaN 或 qc_flag=REJECT），对连续缺测区域输出掩膜并在产品元数据中说明缺测原因统计。按上述步骤完成的产品应包含：主数据表（CSV/GeoJSON/netCDF）、置信度与 QC 报告（JSON 或文本）、诊断图表包（PDF）及交互式或静态地图图像；所有输出文件在元数据中注明生成参数、时间戳和软件环境信息以便审计和复现。"
  ]
}