{
  "tasks": [],
  "problem_str": "问题背景：\n乳腺癌是目前世界上最常见，致死率较高的癌症之一。乳腺癌的发展与雌激素受体密切相关，有研究发现，雌激素受体 $\\alpha$ 亚型 (Estrogen receptors alpha, ER$\\alpha$) 在不超过 10\\% 的正常乳腺上皮细胞中表达，但大约在 50\\%-80\\% 的乳腺肿瘤细胞中表达；而对 ER$\\alpha$ 基因缺失小鼠的实验结果表明，ER$\\alpha$ 确实在乳腺发育过程中扮演了十分重要的角色。目前，抗激素治疗常用于 ER$\\alpha$ 表达的乳腺癌患者，其通过调节雌激素受体活性来控制体内雌激素水平。因此，ER$\\alpha$ 被认为是治疗乳腺癌的重要靶标，能够拮抗 ER$\\alpha$ 活性的化合物可能是治疗乳腺癌的候选药物。比如，临床治疗乳腺癌的经典药物他莫昔芬和雷诺昔芬就是 ER$\\alpha$ 拮抗剂。\n\n目前，在药物研发中，为了节约时间和成本，通常采用建立化合物活性预测模型的方法来筛选潜在活性化合物。具体做法是：针对与疾病相关的某个靶标（此处为 ER$\\alpha$），收集一系列作用于该靶标的化合物及其生物活性数据，然后以一系列分子结构描述符作为自变量，化合物的生物活性值作为因变量，构建化合物的定量结构-活性关系（Quantitative Structure-Activity Relationship, QSAR）模型，然后使用该模型预测具有更好生物活性的新化合物分子，或者指导已有活性化合物的结构优化。\n\n一个化合物想要成为候选药物，除了需要具备良好的生物活性（此处指抗乳腺癌活性）外，还需要在人体内具备良好的药代动力学性质和安全性，合称为 ADMET（Absorption 吸收、Distribution 分布、Metabolism 代谢、Excretion 排泄、Toxicity 毒性）性质。其中，ADME 主要指化合物的药代动力学性质，描述了化合物在生物体内的浓度随时间变化的规律，T 主要指化合物可能在人体内产生的毒副作用。一个化合物的活性再好，如果其 ADMET 性质不佳，比如很难被人体吸收，或者体内代谢速度太快，或者具有某种毒性，那么其仍然难以成为药物，因而还需要进行 ADMET 性质优化。为了方便建模，本试题仅考虑化合物的 5 种 ADMET 性质，分别是：1) 小肠上皮细胞渗透性 (Caco-2)，可度量化合物被人体吸收的能力；2) 细胞色素 P450 酶 (Cytochrome P450, CYP) 3A4 亚型 (CYP3A4)，这是人体内的主要代谢酶，可度量化合物的代谢稳定性；3) 化合物心脏安全性评价 (human Ether-a-go-go Related Gene, hERG)，可度量化合物的心脏毒性；4) 人体口服生物利用度 (Human Oral Bioavailability, HOB)，可度量药物进入人体后被吸收进入人体血液循环的药量比例；5) 微核试验 (Micronucleus, MN)，是检测化合物是否具有遗传毒性的一种方法。\n\n问题要求：\n 二、数据集介绍及建模目标\n\n本试题针对乳腺癌治疗靶标 ER$\\alpha$，首先提供了 1974 个化合物对 ER$\\alpha$ 的生物活性数据。这些数据包含在文件 “ER$\\alpha$_activity.xlsx” 的 training 表（训练集）中。training 表包含 3 列，第一列提供了 1974 个化合物的结构式，用一维线性表达式 SMILES （Simplified Molecular Input-Line Entry System）表示；第二列是化合物对 ER$\\alpha$ 的生物活性值（用 IC$_{50}$ 表示，为实验测定值，单位是 nM，值越小代表生物活性越大，对抑制 ER$\\alpha$ 活性越有效）；第三列是将第二列 IC$_{50}$ 值转化而得的 pIC$_{50}$（即 IC$_{50}$ 值的负对数，该值通常与生物活性具有正相关性，即 pIC$_{50}$ 值越大表明生物活性越高；实际 QSAR 建模中，一般采用 pIC$_{50}$ 来表示生物活性值）。该文件中另有一个 test 表（测试集），里面提供有 50 个化合物的 SMILES 式。\n\n其次，在文件 “Molecular_Descriptor.xlsx” 的 training 表（训练集）中，给出了上述 1974 个化合物的 729 个分子描述符信息（即自变量）。其中第一列也是化合物的 SMILES 式（编码顺序与上表一样），其后共有 729 列，每列代表化合物的一个分子描述符（即一个自变量）。化合物的分子描述符是一系列用于描述化合物的结构和性质特征的参数，包括物理化学性质（如分子量，LogP 等）、拓扑结构特征（如氢键供体数量、氢键受体数量等），等等。关于每个分子描述符的具体含义，请参见文件 “分子描述符含义解释.xlsx”。同样地，该文件也有一个 test 表，里面给出了上述 50 个测试集化合物的 729 个分子描述符。\n\n最后，在关注化合物生物活性的同时，还需要考虑其 ADMET 性质。因此，在文件 “ADMET.xlsx” 的 training 表（训练集）中，提供了上述 1974 个化合物的 5 种 ADMET 性质的数据。其中第一列也是表示化合物结构的 SMILES 式（编码顺序同上），其后 5 列分别对应每个化合物的 ADMET 性质，采用二分类法提供相应的取值。Caco-2：‘1’ 代表该化合物的小肠上皮细胞渗透性较好，‘0’ 代表该化合物的小肠上皮细胞渗透性较差；CYP3A4：‘1’ 代表该化合物能够被 CYP3A4 代谢，‘0’ 代表该化合物不能被 CYP3A4 代谢；hERG：‘1’ 代表该化合物具有心脏毒性，‘0’ 代表该化合物不具有心脏毒性；HOB：‘1’ 代表该化合物的口服生物利用度较高，‘0’ 代表该化合物的口服生物利用度较低；MN：‘1’ 代表该化合物具有遗传毒性，‘0’ 代表该化合物不具有遗传毒性。同样地，该文件也有一个 test 表，里面提供了上述 50 个化合物的 SMILES 式（编码顺序同上）。\n\n建模目标：根据提供的ER$\\alpha$拮抗剂信息（1974个化合物样本，每个样本都有729个分子描述符变量，1个生物活性数据，5个ADMET性质数据），构建化合物生物活性的定量预测模型和ADMET性质的分类预测模型，从而为同时优化化合物的生物活性和ADMET性质提供指导。\n\n\\textbf{问题1.} 根据文件“Molecular_Descriptor.xlsx”和“ER$\\alpha$_activity.xlsx”提供的数据，针对1974个化合物的729个分子描述符进行变量选择，根据变量对生物活性影响的重要性进行排序，并给出前20个对生物活性最具有显著影响的分子描述符（即变量），并请详细说明分子描述符筛选过程及其合理性。\n\n\\textbf{问题2.} 请结合问题1，选择不超过20个分子描述符变量，构建化合物对ER$\\alpha$生物活性的定量预测模型，请叙述建模过程。然后使用构建的预测模型，对文件“ER$\\alpha$_activity.xlsx”的test表中的50个化合物进行IC${}_{50}$值和对应的pIC${}_{50}$值预测，并将结果分别填入“ER$\\alpha$_activity.xlsx”的test表中的IC50_nM列及对应的pIC50列。\n\n\\textbf{问题3.} 请利用文件“Molecular_Descriptor.xlsx”提供的729个分子描述符，针对文件“ADMET.xlsx”中提供的1974个化合物的ADMET数据，分别构建化合物的Caco-2、CYP3A4、hERG、HOB、MN的分类预测模型，并简要叙述建模过程。然后使用所构建的5个分类预测模型，对文件“ADMET.xlsx”的test表中的50个化合物进行相应的预测，并将结果填入“ADMET.xlsx”的test表中对应的Caco-2、CYP3A4、hERG、HOB、MN列。\n\n\\textbf{问题4.} 寻找并阐述化合物的哪些分子描述符，以及这些分子描述符在什么取值或者处于什么取值范围时，能够使化合物对抑制ER$\\alpha$具有更好的生物活性，同时具有更好的ADMET性质（给定的五个ADMET性质中，至少三个性质较好）。\nAddendum: \n无\nDataset Path:\n['ADMET.xlsx', 'ERα_activity.xlsx', 'Molecular_Descriptor.xlsx', '分子描述符含义解释.xlsx']\n\nData Description:\n该数据集以化合物的化学结构为核心，使用SMILES字符串唯一标识每个分子，并配有与药代动力学/毒性（ADMET）相关的二元标签与分子描述符以支持分子建模与活性预测研究。ADMET类指标包括Caco-2（通过Caco-2细胞的渗透性，0=低、1=高）、CYP3A4（对CYP3A4酶的抑制，0=无、1=有）、hERG（对hERG钾通道的抑制，0=无、1=有）、HOB（血–脑屏障透过性，0=低、1=高）和MN（微核试验致突变性，0=无、1=有）；数据集中还包含针对雌激素受体α（ERα_activity）的活性字段以用于生物活性建模。分子描述符部分提供多类2D/其他类型的描述符（例如酸性基团计数、ALOGP等类别示例），并通过随附的“分子描述符含义解释.xlsx”文件对每种描述符的类型、数量、分类（Descriptor Class）及参考文献（Reference）给出详细注释和理论来源，便于理解各描述符在建模中的含义和应用；数据集中也记录了描述符的类型说明（Descriptor type）和出现次数（Number）以便统计与选择。总体而言，该数据集整合了结构信息、关键ADMET二元标签与丰富的可解释分子描述符，并提供了专门的描述符说明文档，适合用于ADMET预测、受体活性建模和描述符重要性分析等药物化学与计算毒理学研究。",
  "problem": {
    "background": "乳腺癌是目前世界上最常见，致死率较高的癌症之一。乳腺癌的发展与雌激素受体密切相关，有研究发现，雌激素受体 $\\alpha$ 亚型 (Estrogen receptors alpha, ER$\\alpha$) 在不超过 10\\% 的正常乳腺上皮细胞中表达，但大约在 50\\%-80\\% 的乳腺肿瘤细胞中表达；而对 ER$\\alpha$ 基因缺失小鼠的实验结果表明，ER$\\alpha$ 确实在乳腺发育过程中扮演了十分重要的角色。目前，抗激素治疗常用于 ER$\\alpha$ 表达的乳腺癌患者，其通过调节雌激素受体活性来控制体内雌激素水平。因此，ER$\\alpha$ 被认为是治疗乳腺癌的重要靶标，能够拮抗 ER$\\alpha$ 活性的化合物可能是治疗乳腺癌的候选药物。比如，临床治疗乳腺癌的经典药物他莫昔芬和雷诺昔芬就是 ER$\\alpha$ 拮抗剂。\n\n目前，在药物研发中，为了节约时间和成本，通常采用建立化合物活性预测模型的方法来筛选潜在活性化合物。具体做法是：针对与疾病相关的某个靶标（此处为 ER$\\alpha$），收集一系列作用于该靶标的化合物及其生物活性数据，然后以一系列分子结构描述符作为自变量，化合物的生物活性值作为因变量，构建化合物的定量结构-活性关系（Quantitative Structure-Activity Relationship, QSAR）模型，然后使用该模型预测具有更好生物活性的新化合物分子，或者指导已有活性化合物的结构优化。\n\n一个化合物想要成为候选药物，除了需要具备良好的生物活性（此处指抗乳腺癌活性）外，还需要在人体内具备良好的药代动力学性质和安全性，合称为 ADMET（Absorption 吸收、Distribution 分布、Metabolism 代谢、Excretion 排泄、Toxicity 毒性）性质。其中，ADME 主要指化合物的药代动力学性质，描述了化合物在生物体内的浓度随时间变化的规律，T 主要指化合物可能在人体内产生的毒副作用。一个化合物的活性再好，如果其 ADMET 性质不佳，比如很难被人体吸收，或者体内代谢速度太快，或者具有某种毒性，那么其仍然难以成为药物，因而还需要进行 ADMET 性质优化。为了方便建模，本试题仅考虑化合物的 5 种 ADMET 性质，分别是：1) 小肠上皮细胞渗透性 (Caco-2)，可度量化合物被人体吸收的能力；2) 细胞色素 P450 酶 (Cytochrome P450, CYP) 3A4 亚型 (CYP3A4)，这是人体内的主要代谢酶，可度量化合物的代谢稳定性；3) 化合物心脏安全性评价 (human Ether-a-go-go Related Gene, hERG)，可度量化合物的心脏毒性；4) 人体口服生物利用度 (Human Oral Bioavailability, HOB)，可度量药物进入人体后被吸收进入人体血液循环的药量比例；5) 微核试验 (Micronucleus, MN)，是检测化合物是否具有遗传毒性的一种方法。",
    "problem_requirement": " 二、数据集介绍及建模目标\n\n本试题针对乳腺癌治疗靶标 ER$\\alpha$，首先提供了 1974 个化合物对 ER$\\alpha$ 的生物活性数据。这些数据包含在文件 “ER$\\alpha$_activity.xlsx” 的 training 表（训练集）中。training 表包含 3 列，第一列提供了 1974 个化合物的结构式，用一维线性表达式 SMILES （Simplified Molecular Input-Line Entry System）表示；第二列是化合物对 ER$\\alpha$ 的生物活性值（用 IC$_{50}$ 表示，为实验测定值，单位是 nM，值越小代表生物活性越大，对抑制 ER$\\alpha$ 活性越有效）；第三列是将第二列 IC$_{50}$ 值转化而得的 pIC$_{50}$（即 IC$_{50}$ 值的负对数，该值通常与生物活性具有正相关性，即 pIC$_{50}$ 值越大表明生物活性越高；实际 QSAR 建模中，一般采用 pIC$_{50}$ 来表示生物活性值）。该文件中另有一个 test 表（测试集），里面提供有 50 个化合物的 SMILES 式。\n\n其次，在文件 “Molecular_Descriptor.xlsx” 的 training 表（训练集）中，给出了上述 1974 个化合物的 729 个分子描述符信息（即自变量）。其中第一列也是化合物的 SMILES 式（编码顺序与上表一样），其后共有 729 列，每列代表化合物的一个分子描述符（即一个自变量）。化合物的分子描述符是一系列用于描述化合物的结构和性质特征的参数，包括物理化学性质（如分子量，LogP 等）、拓扑结构特征（如氢键供体数量、氢键受体数量等），等等。关于每个分子描述符的具体含义，请参见文件 “分子描述符含义解释.xlsx”。同样地，该文件也有一个 test 表，里面给出了上述 50 个测试集化合物的 729 个分子描述符。\n\n最后，在关注化合物生物活性的同时，还需要考虑其 ADMET 性质。因此，在文件 “ADMET.xlsx” 的 training 表（训练集）中，提供了上述 1974 个化合物的 5 种 ADMET 性质的数据。其中第一列也是表示化合物结构的 SMILES 式（编码顺序同上），其后 5 列分别对应每个化合物的 ADMET 性质，采用二分类法提供相应的取值。Caco-2：‘1’ 代表该化合物的小肠上皮细胞渗透性较好，‘0’ 代表该化合物的小肠上皮细胞渗透性较差；CYP3A4：‘1’ 代表该化合物能够被 CYP3A4 代谢，‘0’ 代表该化合物不能被 CYP3A4 代谢；hERG：‘1’ 代表该化合物具有心脏毒性，‘0’ 代表该化合物不具有心脏毒性；HOB：‘1’ 代表该化合物的口服生物利用度较高，‘0’ 代表该化合物的口服生物利用度较低；MN：‘1’ 代表该化合物具有遗传毒性，‘0’ 代表该化合物不具有遗传毒性。同样地，该文件也有一个 test 表，里面提供了上述 50 个化合物的 SMILES 式（编码顺序同上）。\n\n建模目标：根据提供的ER$\\alpha$拮抗剂信息（1974个化合物样本，每个样本都有729个分子描述符变量，1个生物活性数据，5个ADMET性质数据），构建化合物生物活性的定量预测模型和ADMET性质的分类预测模型，从而为同时优化化合物的生物活性和ADMET性质提供指导。\n\n\\textbf{问题1.} 根据文件“Molecular_Descriptor.xlsx”和“ER$\\alpha$_activity.xlsx”提供的数据，针对1974个化合物的729个分子描述符进行变量选择，根据变量对生物活性影响的重要性进行排序，并给出前20个对生物活性最具有显著影响的分子描述符（即变量），并请详细说明分子描述符筛选过程及其合理性。\n\n\\textbf{问题2.} 请结合问题1，选择不超过20个分子描述符变量，构建化合物对ER$\\alpha$生物活性的定量预测模型，请叙述建模过程。然后使用构建的预测模型，对文件“ER$\\alpha$_activity.xlsx”的test表中的50个化合物进行IC${}_{50}$值和对应的pIC${}_{50}$值预测，并将结果分别填入“ER$\\alpha$_activity.xlsx”的test表中的IC50_nM列及对应的pIC50列。\n\n\\textbf{问题3.} 请利用文件“Molecular_Descriptor.xlsx”提供的729个分子描述符，针对文件“ADMET.xlsx”中提供的1974个化合物的ADMET数据，分别构建化合物的Caco-2、CYP3A4、hERG、HOB、MN的分类预测模型，并简要叙述建模过程。然后使用所构建的5个分类预测模型，对文件“ADMET.xlsx”的test表中的50个化合物进行相应的预测，并将结果填入“ADMET.xlsx”的test表中对应的Caco-2、CYP3A4、hERG、HOB、MN列。\n\n\\textbf{问题4.} 寻找并阐述化合物的哪些分子描述符，以及这些分子描述符在什么取值或者处于什么取值范围时，能够使化合物对抑制ER$\\alpha$具有更好的生物活性，同时具有更好的ADMET性质（给定的五个ADMET性质中，至少三个性质较好）。",
    "dataset_path": [
      "ADMET.xlsx",
      "ERα_activity.xlsx",
      "Molecular_Descriptor.xlsx",
      "分子描述符含义解释.xlsx"
    ],
    "dataset_description": {
      "ADMET": "",
      "ERα_activity": "",
      "Molecular_Descriptor": "",
      "分子描述符含义解释": "分子描述符含义解释.xlsx提供了分子描述符的详细解释，包括描述符的类型、数量以及参考文献，用于理解每个描述符的含义及其在分子建模中的应用。"
    },
    "variable_description": [
      {
        "SMILES": "化合物的简化分子线性输入规范（Simplified Molecular Input Line Entry Specification）表示，用于唯一标识化合物的化学结构。",
        "Caco-2": "表示化合物通过Caco-2细胞模型的渗透性，0表示低渗透性，1表示高渗透性。",
        "CYP3A4": "表示化合物对CYP3A4酶的抑制作用，0表示无抑制作用，1表示有抑制作用。",
        "hERG": "表示化合物对hERG钾通道的抑制作用，0表示无抑制作用，1表示有抑制作用。",
        "HOB": "表示化合物的血脑屏障透过性，0表示低透过性，1表示高透过性。",
        "MN": "表示化合物的微核试验结果，0表示无致突变性，1表示有致突变性。"
      },
      {},
      {},
      {
        "Descriptor type": "描述符的类型，例如酸性基团计数、ALOGP等。",
        "Number": "描述符的数量，表示该类型描述符在数据集中出现的次数。",
        "Descriptor Class": "描述符的分类，例如2D描述符。",
        "Reference": "描述符的参考文献，提供描述符的理论基础和来源。"
      }
    ],
    "addendum": "无",
    "data_summary": "Dataset Path:\n['ADMET.xlsx', 'ERα_activity.xlsx', 'Molecular_Descriptor.xlsx', '分子描述符含义解释.xlsx']\n\nData Description:\n该数据集以化合物的化学结构为核心，使用SMILES字符串唯一标识每个分子，并配有与药代动力学/毒性（ADMET）相关的二元标签与分子描述符以支持分子建模与活性预测研究。ADMET类指标包括Caco-2（通过Caco-2细胞的渗透性，0=低、1=高）、CYP3A4（对CYP3A4酶的抑制，0=无、1=有）、hERG（对hERG钾通道的抑制，0=无、1=有）、HOB（血–脑屏障透过性，0=低、1=高）和MN（微核试验致突变性，0=无、1=有）；数据集中还包含针对雌激素受体α（ERα_activity）的活性字段以用于生物活性建模。分子描述符部分提供多类2D/其他类型的描述符（例如酸性基团计数、ALOGP等类别示例），并通过随附的“分子描述符含义解释.xlsx”文件对每种描述符的类型、数量、分类（Descriptor Class）及参考文献（Reference）给出详细注释和理论来源，便于理解各描述符在建模中的含义和应用；数据集中也记录了描述符的类型说明（Descriptor type）和出现次数（Number）以便统计与选择。总体而言，该数据集整合了结构信息、关键ADMET二元标签与丰富的可解释分子描述符，并提供了专门的描述符说明文档，适合用于ADMET预测、受体活性建模和描述符重要性分析等药物化学与计算毒理学研究。",
    "data_description": {
      "ADMET": "",
      "ERα_activity": "",
      "Molecular_Descriptor": "",
      "分子描述符含义解释": "分子描述符含义解释.xlsx提供了分子描述符的详细解释，包括描述符的类型、数量以及参考文献，用于理解每个描述符的含义及其在分子建模中的应用。"
    },
    "problem_str": "问题背景：\n乳腺癌是目前世界上最常见，致死率较高的癌症之一。乳腺癌的发展与雌激素受体密切相关，有研究发现，雌激素受体 $\\alpha$ 亚型 (Estrogen receptors alpha, ER$\\alpha$) 在不超过 10\\% 的正常乳腺上皮细胞中表达，但大约在 50\\%-80\\% 的乳腺肿瘤细胞中表达；而对 ER$\\alpha$ 基因缺失小鼠的实验结果表明，ER$\\alpha$ 确实在乳腺发育过程中扮演了十分重要的角色。目前，抗激素治疗常用于 ER$\\alpha$ 表达的乳腺癌患者，其通过调节雌激素受体活性来控制体内雌激素水平。因此，ER$\\alpha$ 被认为是治疗乳腺癌的重要靶标，能够拮抗 ER$\\alpha$ 活性的化合物可能是治疗乳腺癌的候选药物。比如，临床治疗乳腺癌的经典药物他莫昔芬和雷诺昔芬就是 ER$\\alpha$ 拮抗剂。\n\n目前，在药物研发中，为了节约时间和成本，通常采用建立化合物活性预测模型的方法来筛选潜在活性化合物。具体做法是：针对与疾病相关的某个靶标（此处为 ER$\\alpha$），收集一系列作用于该靶标的化合物及其生物活性数据，然后以一系列分子结构描述符作为自变量，化合物的生物活性值作为因变量，构建化合物的定量结构-活性关系（Quantitative Structure-Activity Relationship, QSAR）模型，然后使用该模型预测具有更好生物活性的新化合物分子，或者指导已有活性化合物的结构优化。\n\n一个化合物想要成为候选药物，除了需要具备良好的生物活性（此处指抗乳腺癌活性）外，还需要在人体内具备良好的药代动力学性质和安全性，合称为 ADMET（Absorption 吸收、Distribution 分布、Metabolism 代谢、Excretion 排泄、Toxicity 毒性）性质。其中，ADME 主要指化合物的药代动力学性质，描述了化合物在生物体内的浓度随时间变化的规律，T 主要指化合物可能在人体内产生的毒副作用。一个化合物的活性再好，如果其 ADMET 性质不佳，比如很难被人体吸收，或者体内代谢速度太快，或者具有某种毒性，那么其仍然难以成为药物，因而还需要进行 ADMET 性质优化。为了方便建模，本试题仅考虑化合物的 5 种 ADMET 性质，分别是：1) 小肠上皮细胞渗透性 (Caco-2)，可度量化合物被人体吸收的能力；2) 细胞色素 P450 酶 (Cytochrome P450, CYP) 3A4 亚型 (CYP3A4)，这是人体内的主要代谢酶，可度量化合物的代谢稳定性；3) 化合物心脏安全性评价 (human Ether-a-go-go Related Gene, hERG)，可度量化合物的心脏毒性；4) 人体口服生物利用度 (Human Oral Bioavailability, HOB)，可度量药物进入人体后被吸收进入人体血液循环的药量比例；5) 微核试验 (Micronucleus, MN)，是检测化合物是否具有遗传毒性的一种方法。\n\n问题要求：\n 二、数据集介绍及建模目标\n\n本试题针对乳腺癌治疗靶标 ER$\\alpha$，首先提供了 1974 个化合物对 ER$\\alpha$ 的生物活性数据。这些数据包含在文件 “ER$\\alpha$_activity.xlsx” 的 training 表（训练集）中。training 表包含 3 列，第一列提供了 1974 个化合物的结构式，用一维线性表达式 SMILES （Simplified Molecular Input-Line Entry System）表示；第二列是化合物对 ER$\\alpha$ 的生物活性值（用 IC$_{50}$ 表示，为实验测定值，单位是 nM，值越小代表生物活性越大，对抑制 ER$\\alpha$ 活性越有效）；第三列是将第二列 IC$_{50}$ 值转化而得的 pIC$_{50}$（即 IC$_{50}$ 值的负对数，该值通常与生物活性具有正相关性，即 pIC$_{50}$ 值越大表明生物活性越高；实际 QSAR 建模中，一般采用 pIC$_{50}$ 来表示生物活性值）。该文件中另有一个 test 表（测试集），里面提供有 50 个化合物的 SMILES 式。\n\n其次，在文件 “Molecular_Descriptor.xlsx” 的 training 表（训练集）中，给出了上述 1974 个化合物的 729 个分子描述符信息（即自变量）。其中第一列也是化合物的 SMILES 式（编码顺序与上表一样），其后共有 729 列，每列代表化合物的一个分子描述符（即一个自变量）。化合物的分子描述符是一系列用于描述化合物的结构和性质特征的参数，包括物理化学性质（如分子量，LogP 等）、拓扑结构特征（如氢键供体数量、氢键受体数量等），等等。关于每个分子描述符的具体含义，请参见文件 “分子描述符含义解释.xlsx”。同样地，该文件也有一个 test 表，里面给出了上述 50 个测试集化合物的 729 个分子描述符。\n\n最后，在关注化合物生物活性的同时，还需要考虑其 ADMET 性质。因此，在文件 “ADMET.xlsx” 的 training 表（训练集）中，提供了上述 1974 个化合物的 5 种 ADMET 性质的数据。其中第一列也是表示化合物结构的 SMILES 式（编码顺序同上），其后 5 列分别对应每个化合物的 ADMET 性质，采用二分类法提供相应的取值。Caco-2：‘1’ 代表该化合物的小肠上皮细胞渗透性较好，‘0’ 代表该化合物的小肠上皮细胞渗透性较差；CYP3A4：‘1’ 代表该化合物能够被 CYP3A4 代谢，‘0’ 代表该化合物不能被 CYP3A4 代谢；hERG：‘1’ 代表该化合物具有心脏毒性，‘0’ 代表该化合物不具有心脏毒性；HOB：‘1’ 代表该化合物的口服生物利用度较高，‘0’ 代表该化合物的口服生物利用度较低；MN：‘1’ 代表该化合物具有遗传毒性，‘0’ 代表该化合物不具有遗传毒性。同样地，该文件也有一个 test 表，里面提供了上述 50 个化合物的 SMILES 式（编码顺序同上）。\n\n建模目标：根据提供的ER$\\alpha$拮抗剂信息（1974个化合物样本，每个样本都有729个分子描述符变量，1个生物活性数据，5个ADMET性质数据），构建化合物生物活性的定量预测模型和ADMET性质的分类预测模型，从而为同时优化化合物的生物活性和ADMET性质提供指导。\n\n\\textbf{问题1.} 根据文件“Molecular_Descriptor.xlsx”和“ER$\\alpha$_activity.xlsx”提供的数据，针对1974个化合物的729个分子描述符进行变量选择，根据变量对生物活性影响的重要性进行排序，并给出前20个对生物活性最具有显著影响的分子描述符（即变量），并请详细说明分子描述符筛选过程及其合理性。\n\n\\textbf{问题2.} 请结合问题1，选择不超过20个分子描述符变量，构建化合物对ER$\\alpha$生物活性的定量预测模型，请叙述建模过程。然后使用构建的预测模型，对文件“ER$\\alpha$_activity.xlsx”的test表中的50个化合物进行IC${}_{50}$值和对应的pIC${}_{50}$值预测，并将结果分别填入“ER$\\alpha$_activity.xlsx”的test表中的IC50_nM列及对应的pIC50列。\n\n\\textbf{问题3.} 请利用文件“Molecular_Descriptor.xlsx”提供的729个分子描述符，针对文件“ADMET.xlsx”中提供的1974个化合物的ADMET数据，分别构建化合物的Caco-2、CYP3A4、hERG、HOB、MN的分类预测模型，并简要叙述建模过程。然后使用所构建的5个分类预测模型，对文件“ADMET.xlsx”的test表中的50个化合物进行相应的预测，并将结果填入“ADMET.xlsx”的test表中对应的Caco-2、CYP3A4、hERG、HOB、MN列。\n\n\\textbf{问题4.} 寻找并阐述化合物的哪些分子描述符，以及这些分子描述符在什么取值或者处于什么取值范围时，能够使化合物对抑制ER$\\alpha$具有更好的生物活性，同时具有更好的ADMET性质（给定的五个ADMET性质中，至少三个性质较好）。\nAddendum: \n无\nDataset Path:\n['ADMET.xlsx', 'ERα_activity.xlsx', 'Molecular_Descriptor.xlsx', '分子描述符含义解释.xlsx']\n\nData Description:\n该数据集以化合物的化学结构为核心，使用SMILES字符串唯一标识每个分子，并配有与药代动力学/毒性（ADMET）相关的二元标签与分子描述符以支持分子建模与活性预测研究。ADMET类指标包括Caco-2（通过Caco-2细胞的渗透性，0=低、1=高）、CYP3A4（对CYP3A4酶的抑制，0=无、1=有）、hERG（对hERG钾通道的抑制，0=无、1=有）、HOB（血–脑屏障透过性，0=低、1=高）和MN（微核试验致突变性，0=无、1=有）；数据集中还包含针对雌激素受体α（ERα_activity）的活性字段以用于生物活性建模。分子描述符部分提供多类2D/其他类型的描述符（例如酸性基团计数、ALOGP等类别示例），并通过随附的“分子描述符含义解释.xlsx”文件对每种描述符的类型、数量、分类（Descriptor Class）及参考文献（Reference）给出详细注释和理论来源，便于理解各描述符在建模中的含义和应用；数据集中也记录了描述符的类型说明（Descriptor type）和出现次数（Number）以便统计与选择。总体而言，该数据集整合了结构信息、关键ADMET二元标签与丰富的可解释分子描述符，并提供了专门的描述符说明文档，适合用于ADMET预测、受体活性建模和描述符重要性分析等药物化学与计算毒理学研究。"
  },
  "problem_background": "乳腺癌是目前世界上最常见，致死率较高的癌症之一。乳腺癌的发展与雌激素受体密切相关，有研究发现，雌激素受体 $\\alpha$ 亚型 (Estrogen receptors alpha, ER$\\alpha$) 在不超过 10\\% 的正常乳腺上皮细胞中表达，但大约在 50\\%-80\\% 的乳腺肿瘤细胞中表达；而对 ER$\\alpha$ 基因缺失小鼠的实验结果表明，ER$\\alpha$ 确实在乳腺发育过程中扮演了十分重要的角色。目前，抗激素治疗常用于 ER$\\alpha$ 表达的乳腺癌患者，其通过调节雌激素受体活性来控制体内雌激素水平。因此，ER$\\alpha$ 被认为是治疗乳腺癌的重要靶标，能够拮抗 ER$\\alpha$ 活性的化合物可能是治疗乳腺癌的候选药物。比如，临床治疗乳腺癌的经典药物他莫昔芬和雷诺昔芬就是 ER$\\alpha$ 拮抗剂。\n\n目前，在药物研发中，为了节约时间和成本，通常采用建立化合物活性预测模型的方法来筛选潜在活性化合物。具体做法是：针对与疾病相关的某个靶标（此处为 ER$\\alpha$），收集一系列作用于该靶标的化合物及其生物活性数据，然后以一系列分子结构描述符作为自变量，化合物的生物活性值作为因变量，构建化合物的定量结构-活性关系（Quantitative Structure-Activity Relationship, QSAR）模型，然后使用该模型预测具有更好生物活性的新化合物分子，或者指导已有活性化合物的结构优化。\n\n一个化合物想要成为候选药物，除了需要具备良好的生物活性（此处指抗乳腺癌活性）外，还需要在人体内具备良好的药代动力学性质和安全性，合称为 ADMET（Absorption 吸收、Distribution 分布、Metabolism 代谢、Excretion 排泄、Toxicity 毒性）性质。其中，ADME 主要指化合物的药代动力学性质，描述了化合物在生物体内的浓度随时间变化的规律，T 主要指化合物可能在人体内产生的毒副作用。一个化合物的活性再好，如果其 ADMET 性质不佳，比如很难被人体吸收，或者体内代谢速度太快，或者具有某种毒性，那么其仍然难以成为药物，因而还需要进行 ADMET 性质优化。为了方便建模，本试题仅考虑化合物的 5 种 ADMET 性质，分别是：1) 小肠上皮细胞渗透性 (Caco-2)，可度量化合物被人体吸收的能力；2) 细胞色素 P450 酶 (Cytochrome P450, CYP) 3A4 亚型 (CYP3A4)，这是人体内的主要代谢酶，可度量化合物的代谢稳定性；3) 化合物心脏安全性评价 (human Ether-a-go-go Related Gene, hERG)，可度量化合物的心脏毒性；4) 人体口服生物利用度 (Human Oral Bioavailability, HOB)，可度量药物进入人体后被吸收进入人体血液循环的药量比例；5) 微核试验 (Micronucleus, MN)，是检测化合物是否具有遗传毒性的一种方法。",
  "problem_requirement": " 二、数据集介绍及建模目标\n\n本试题针对乳腺癌治疗靶标 ER$\\alpha$，首先提供了 1974 个化合物对 ER$\\alpha$ 的生物活性数据。这些数据包含在文件 “ER$\\alpha$_activity.xlsx” 的 training 表（训练集）中。training 表包含 3 列，第一列提供了 1974 个化合物的结构式，用一维线性表达式 SMILES （Simplified Molecular Input-Line Entry System）表示；第二列是化合物对 ER$\\alpha$ 的生物活性值（用 IC$_{50}$ 表示，为实验测定值，单位是 nM，值越小代表生物活性越大，对抑制 ER$\\alpha$ 活性越有效）；第三列是将第二列 IC$_{50}$ 值转化而得的 pIC$_{50}$（即 IC$_{50}$ 值的负对数，该值通常与生物活性具有正相关性，即 pIC$_{50}$ 值越大表明生物活性越高；实际 QSAR 建模中，一般采用 pIC$_{50}$ 来表示生物活性值）。该文件中另有一个 test 表（测试集），里面提供有 50 个化合物的 SMILES 式。\n\n其次，在文件 “Molecular_Descriptor.xlsx” 的 training 表（训练集）中，给出了上述 1974 个化合物的 729 个分子描述符信息（即自变量）。其中第一列也是化合物的 SMILES 式（编码顺序与上表一样），其后共有 729 列，每列代表化合物的一个分子描述符（即一个自变量）。化合物的分子描述符是一系列用于描述化合物的结构和性质特征的参数，包括物理化学性质（如分子量，LogP 等）、拓扑结构特征（如氢键供体数量、氢键受体数量等），等等。关于每个分子描述符的具体含义，请参见文件 “分子描述符含义解释.xlsx”。同样地，该文件也有一个 test 表，里面给出了上述 50 个测试集化合物的 729 个分子描述符。\n\n最后，在关注化合物生物活性的同时，还需要考虑其 ADMET 性质。因此，在文件 “ADMET.xlsx” 的 training 表（训练集）中，提供了上述 1974 个化合物的 5 种 ADMET 性质的数据。其中第一列也是表示化合物结构的 SMILES 式（编码顺序同上），其后 5 列分别对应每个化合物的 ADMET 性质，采用二分类法提供相应的取值。Caco-2：‘1’ 代表该化合物的小肠上皮细胞渗透性较好，‘0’ 代表该化合物的小肠上皮细胞渗透性较差；CYP3A4：‘1’ 代表该化合物能够被 CYP3A4 代谢，‘0’ 代表该化合物不能被 CYP3A4 代谢；hERG：‘1’ 代表该化合物具有心脏毒性，‘0’ 代表该化合物不具有心脏毒性；HOB：‘1’ 代表该化合物的口服生物利用度较高，‘0’ 代表该化合物的口服生物利用度较低；MN：‘1’ 代表该化合物具有遗传毒性，‘0’ 代表该化合物不具有遗传毒性。同样地，该文件也有一个 test 表，里面提供了上述 50 个化合物的 SMILES 式（编码顺序同上）。\n\n建模目标：根据提供的ER$\\alpha$拮抗剂信息（1974个化合物样本，每个样本都有729个分子描述符变量，1个生物活性数据，5个ADMET性质数据），构建化合物生物活性的定量预测模型和ADMET性质的分类预测模型，从而为同时优化化合物的生物活性和ADMET性质提供指导。\n\n\\textbf{问题1.} 根据文件“Molecular_Descriptor.xlsx”和“ER$\\alpha$_activity.xlsx”提供的数据，针对1974个化合物的729个分子描述符进行变量选择，根据变量对生物活性影响的重要性进行排序，并给出前20个对生物活性最具有显著影响的分子描述符（即变量），并请详细说明分子描述符筛选过程及其合理性。\n\n\\textbf{问题2.} 请结合问题1，选择不超过20个分子描述符变量，构建化合物对ER$\\alpha$生物活性的定量预测模型，请叙述建模过程。然后使用构建的预测模型，对文件“ER$\\alpha$_activity.xlsx”的test表中的50个化合物进行IC${}_{50}$值和对应的pIC${}_{50}$值预测，并将结果分别填入“ER$\\alpha$_activity.xlsx”的test表中的IC50_nM列及对应的pIC50列。\n\n\\textbf{问题3.} 请利用文件“Molecular_Descriptor.xlsx”提供的729个分子描述符，针对文件“ADMET.xlsx”中提供的1974个化合物的ADMET数据，分别构建化合物的Caco-2、CYP3A4、hERG、HOB、MN的分类预测模型，并简要叙述建模过程。然后使用所构建的5个分类预测模型，对文件“ADMET.xlsx”的test表中的50个化合物进行相应的预测，并将结果填入“ADMET.xlsx”的test表中对应的Caco-2、CYP3A4、hERG、HOB、MN列。\n\n\\textbf{问题4.} 寻找并阐述化合物的哪些分子描述符，以及这些分子描述符在什么取值或者处于什么取值范围时，能够使化合物对抑制ER$\\alpha$具有更好的生物活性，同时具有更好的ADMET性质（给定的五个ADMET性质中，至少三个性质较好）。",
  "problem_analysis": "本建模任务从药物化学与计算毒理学结合的角度出发，核心目标是用已有的分子描述符和实验测得的活性/ADMET标签构建可用于预测和优化的定量结构–活性关系（QSAR）与分类模型。宏观上看，这既是一个典型的监督学习问题，也是一个多目标药物优化问题：一方面希望准确预测化合物抑制ERα的效力（回归问题，通常以pIC50为建模目标以获得更稳定的数值分布），另一方面要预测并尽量同时满足若干ADMET二分类指标（Caco‑2、CYP3A4、hERG、HOB、MN），以保证候选分子的药代动力学/安全性可接受。模型构建的实际价值在于以较低成本筛除明显不合格的结构、引导结构改造以及为后续实验提供优先级排序；因此模型的群体外推能力、可解释性以及对不确定性的量化是评价其实用性的重要维度。\n\n在定义建模路径时必须明确并检视一系列显性与隐性假设。显性的包括：分子描述符能充分、稳定地表征影响活性与ADMET的结构特征；训练集中化合物的化学空间与未来待预测化合物的化学空间具有可比性（即存在合理的适用域）；实验测得的IC50和ADMET标签是可靠的“真值”。隐含假设包括：静态的2D/拓扑/简单物理化学描述符可替代复杂的三维构象、动力学代谢途径和体内浓度时间曲线来预测终效应；各ADMET端点间的判定阈值与体内临床意义一致。这些假设如果不成立，会直接影响模型推广到真实体内情形的解释力与可靠性。比如，ADMET标签来源于不同体外测定体系或存在实验噪声时，训练出的分类边界会带有偏差；如果测试集含有远离训练集的新的骨架，模型可能出现外推失败。\n\n针对729个描述符进行变量选择与模型建立，需要兼顾统计稳健性、可解释性与化学合理性。高维描述符常见问题包括冗余（高度相关/共线性）、低方差或含义不清、以及偶发的异常值。合理的预处理顺序通常包括：删去常数或近似常数特征、处理缺失值（若有），对数/归一化处理必要物理量以提升算法收敛性，然后用基于过滤的方法（如相关性阈值、方差阈值、单变量与分布检验）去除明显无效变量，再用嵌入式或包裹式方法进行精细筛选以判定对目标最具信息量且非冗余的特征子集。具体工具可包括主成分回归或PLS来应对高度共线性（尤其在解释性要求较低时），LASSO/Elastic Net作为能同时完成正则化和特征选择的线性嵌入式方法，随机森林或梯度提升机的特征重要性（基于置换或SHAP值）用于非线性关系识别，Boruta等稳健包裹方法用于保留与目标真正相关的变量。变量筛选应通过嵌套交叉验证（outer for performance estimation，inner for特征选择与超参优化）来避免信息泄露与过拟合，模型稳健性还应通过y‑随机化检验及外部测试集性能来评估。最终若需给出“前20个最重要的描述符”，应基于若干方法的一致性排名（例如LASSO选择频次、RF或GBM的置换重要性、SHAP累计贡献）并结合描述符物理化学语义进行化学合理性审阅；简单只用某一算法的单次重要性排序可能导致偏差。\n\n在构建不超过20个描述符的pIC50回归模型时，限额的理由既是为了提升模型的可解释性与减少过拟合，也是为了便于在后续的化学优化中指示可操作的结构特征。实际建模流程建议为：先用上述过滤步骤初筛至若干十到一百个候选特征，再通过嵌套CV内的LASSO/Elastic Net或基于SHAP值的递归特征消除（RFE）确定一个不超过20个的最终子集；随后比较几类模型（线性回归/带正则的线性模型、PLS、随机森林、梯度提升、支持向量回归与简单神经网络），使用RMSE、MAE、R^2及外部Q^2作为评估指标，并关注预测残差的系统性（偏差）与不确定度。对test集上的50个化合物，应首先判断其是否落在模型的适用域（通过化学空间距离、马氏距离或leverage值）——若超出则需标注高不确定性。模型给出pIC50预测后可转回IC50（以10^(−pIC50)并乘以单位换算）填表，但应同时提供置信区间或预测区间以反映误差扩散（回归到原始尺度时的不对称误差）。此外应做残差分析、y‑randomization与外部盲测来证明模型非偶然发现。\n\n关于ADMET五个二分类模型，考虑到它们的生物学本质与数据特点，推荐分别构建独立的分类器并适当考虑多任务学习的替代方案。独立建模的优点是易于调整每个端点的阈值和损失函数（如对hERG更关注假阴性还是假阳性），多任务学习（例如多输出GBM或多头神经网络）可以在样本共享特征表示的同时利用端点间潜在相关性来提高稀有标签端点的泛化，但其训练与解释更复杂。对分类器的选择应考虑标签不平衡问题（某些ADMET端点可能正负例分布极不均衡），常见对策包括分层采样的交叉验证、类权重、过采样（SMOTE）或阈值移动。模型评估不能只看准确率，应关注ROC‑AUC、PR‑AUC、灵敏度（召回）、特异度与F1以衡量不同错误代价。特征选择原则与回归类似，可用基于信息增益的过滤器、L1正则化的嵌入式方法或基于树模型的置换重要性来得到相对稳定的变量子集。完成模型训练后，对50个test集分子逐一预测并同样评估其适用域，当模型对某些分子给出高不确定性或位于训练分布边界时应标注该信息以便后续决策。\n\n建模过程中需要深入考虑活性与ADMET之间的矛盾与权衡：例如，提高脂溶性常常有利于穿膜与细胞渗透性（提升Caco‑2和HOB），但也可能增加hERG抑制和代谢稳定性问题（或增加CYP3A4代谢/相互作用风险），因此“单一最优”概念在药物发现中往往不可行。对此可采用多目标优化框架来指导化合物优选：定义活性与若干ADMET端点的加权或多目标评分（如构建Pareto前沿并寻找在前沿上的化合物），或采用约束优化（例如在保持pIC50不低于某阈值的前提下最大化ADMET可接受性），并采用可解释模型（或局部解释工具，如SHAP或部分依赖曲线）来提示可行的结构修改方向。更进一步，可用贝叶斯优化或基于生成模型的策略在化学空间中搜索满足多目标约束的候选结构。\n\n关于时间尺度与动态性，必须承认本数据集和多数QSAR方法基于静态结构描述符来预测终端读数，而很多ADMET性质本质上是时序过程（吸收率、代谢速率、血浆暴露、毒性随时间积累等）。因此若要获得更接近体内现实的评估，应结合药代动力学（PK）和毒理动力学（TD）模型，或在有动力学测定数据时引入描述符反映代谢易位（如代谢位点预测）、可逆/不可逆抑制机制及代谢产生物的潜在毒性。在模型部署时需警惕外部扰动（例如pH变化、蛋白结合、溶解度限制）对预测结果的影响，并在重要决策点（候选化合物进入生物测定）保留实验验证以修正模型。\n\n最后，应强调建模是一个迭代且开放的过程：初期模型用于快速筛选与假设生成，后续通过小规模验证实验将反馈用于更新模型（诸如在线学习或周期性重训练），逐步扩大适用域并减少偏差。模型选择应在准确性、可解释性与可维护性间取得平衡；在高风险判断（如潜在hERG毒性）时宜采取更保守的阈值并配合体外验证。对于结果的不确定性、适用域限制及潜在实验偏差，应在报告与实际应用中明确说明，以便决策者理解模型预测的置信度与局限性。总体目标不是依赖单一模型给出绝对结论，而是构建一套可验证、可更新且对化学家具有可操作建议性的预测体系，以支持抑制ERα化合物的筛选与多目标优化。",
  "modeling_solution": "本回答提出一个综合的数学与数据驱动建模框架，旨在回答题目所述的四类任务：从高维分子描述符中筛选影响ERα活性的关键变量，构建精确且可解释的pIC50回归模型，构建五个ADMET二分类模型，并给出在生物活性与ADMET之间实现共同优化的可操作判据。总体策略是将经典统计建模与现代机器学习、稳健的特征选择、适用域评估与不确定性定量相结合，辅以多目标优化与可解释性工具（如部分依赖与SHAP），以便既能提供可靠预测，又能为化学优化提供明确、可执行的结构-性质指导。以下按模型构建逻辑依次给出假设、变量定义、关键方程、数值求解与验证策略、模型更新与敏感性分析，以及如何从模型中导出“对活性和至少三个ADMET端点同时有利的描述符和取值范围”。\n\n模型假设与数据预处理。为使问题可操作且兼顾现实性，假设一：给定的729个分子描述符在表示分子结构—性质关系方面具有足够信息量，且大部分ADMET与活性可由这些静态描述符预测；假设二：训练集1974个样本与待预测50个样本来自可比较的化学空间，允许模型进行有限外推；假设三：实验测得的IC50（和转换后的pIC50）与ADMET二分类标签具有可接受的信噪比；假设四：若存在观测误差或噪声，其影响可通过正则化、集成与不确定性评估加以控制。基于这些假设，预处理步骤包括：删除常量或近零方差特征；对缺失值进行审查并用合理策略插补（若缺失极少用中位数或模型预测替换，若缺失多则考虑剔除该描述符）；对数或标准化连续变量使其尺度一致；对高度相关的描述符对做初步合并或保留单一代表（用相关系数阈值，如|r|>0.95）；计算每个描述符的方差和单变量与pIC50的相关系数以做初步筛选。\n\n变量选择与重要性排序的数学表述。设训练数据为矩阵 X ∈ R^{n×p}（n=1974，p≈729）与目标向量 y ∈ R^{n}（pIC50）。首先采用过滤器方法剔除不具信息量的特征，保留p0个候选特征。随后使用多方法综合排序以降低单一算法偏差。在线性正则化框架下，LASSO 与 Elastic Net 的目标函数分别为 min_{β} (1/2n)‖y − Xβ‖^2_2 + λ‖β‖_1 与 min_{β} (1/2n)‖y − Xβ‖^2_2 + λ1‖β‖_1 + (λ2/2)‖β‖^2_2，其中λ或(λ1,λ2)通过内层交叉验证选择。变量出现频率可通过稳定性选择得到，即对多次（例如 B=100）自助采样或子样本分别运行LASSO并统计被选中的频次；高频次变量视为“稳健重要”。并行地，训练随机森林（RF）和梯度提升树（XGBoost）以获得基于置换或分裂的特征重要性 I_j。为了更严格地衡量变量的因果或近因贡献，可对RF或GBM使用置换重要性：I_j = E_loss − E_loss^{perm(j)}。最后，用SHAP（Shapley Additive exPlanations）为每个变量计算平均绝对SHAP值 S_j，这在非线性模型中能提供一致的局部到全局重要性度量。将上述三类重要性（稳定LASSO频次、树模型重要性、SHAP）进行秩和或加权合并，得到最终的变量重要性排序，并选取前20个作为问题1的答案。此过程的合理性基于多种模型视角的共识与稳定性选择可显著减小偶发现象与过拟合带来的错误排序。\n\npIC50回归模型构建与数学细节。回归模型可以分为基线可解释模型与性能导向模型两类。基线模型采用线性回归与偏最小二乘（PLS）以处理共线性，形式为 y = Xβ + ε，其中ε~N(0,σ^2)。PLS以最大化X与y协方差的线性组合为目标，适用于p>n或高度共线情形。性能导向模型采用非线性集成算法如随机森林、XGBoost或支持向量回归（SVR）其目标函数在SVR为 min_{w,b} (1/2)‖w‖^2 + C Σ ξ_i with ε-insensitive loss。模型训练遵循嵌套交叉验证：外层用于估计泛化误差（例如5×重抽样），内层用于变量选择与超参优化（例如网格搜索或贝叶斯优化）。若限制最终变量数≤20，则在内层以递归特征消除（RFE）或稳定LASSO频次为先导获得候选子集，再用内层CV比对模型性能指标RMSE、MAE、R^2与Q^2（外部）。为量化不确定性，采用以下方法计算预测区间：对线性模型使用σ与t分布构造置信/预测区间；对树集成使用分位回归森林或蒙特卡洛子模型集合的预测分布；采用交叉验证残差校准的 conformal prediction 为任意模型提供有效的预测区间，保证在给定置信度下的覆盖率。对测试集50个样本，在预测前先评估其适用域（AD）：对每个测试样本计算leverage h = x_new^T (X^T X)^{-1} x_new（或使用马氏距离基于训练集样本的协方差），当h > h_*（常用阈值 3(p+1)/n）或马氏距离超出95%分位时标注为“外推，高不确定”。最后将预测的pIC50反转换为IC50_nM via IC50 = 10^{−pIC50}·10^9（若pIC50以−log10(M)定义注意单位换算），并将预测值与预测区间一起报告。\n\nADMET五个二分类模型的数学框架。对每一个端点（Caco-2, CYP3A4, hERG, HOB, MN），设标签 vector z ∈ {0,1}^n。采用逻辑回归带正则化作为可解释基线，目标为最大化对数似然或最小化交叉熵损失 L(β) = −(1/n)Σ [z_i log σ(x_i^T β) + (1−z_i) log(1−σ(x_i^T β))] + penalty(β)。为捕捉非线性关系与交互项，同时训练树模型（XGBoost、随机森林）和多层感知器（MLP, 可用于多任务学习）。若标签不平衡，采用类权重、阈值调整或生成少数类样本（如SMOTE）避免偏向多数类，并以AUC-ROC、PR-AUC、灵敏度和特异度为主要评估指标。使用嵌套CV进行特征选择与超参调优，并用置换测试评估模型显著性。若ADMET端点间存在共性（例如某些描述符同时影响Caco-2与HOB），可尝试多任务学习（MTL）模型如共享底层特征提取器的多输出神经网络或多输出GBM，它们通过共享参数提升低样本端点的泛化能力。模型解释同样用SHAP或局部可解释模型-局部线性逼近（LIME），以识别在判定“有毒/有代谢”时关键的描述符方向。\n\n多目标优化与从模型到化学启发的准则。为找出既具高抑制ERα活性又满足至少三个ADMET端点良好（定义为模型预测概率≥θ，例如θ=0.8或按特定灵敏度/特异度 trade-off 调整）的小分子描述符取值范围，建立如下多目标评分S(m)对每个分子m：S(m) = w_act·f_act(pIC50_pred(m)) + Σ_{k} w_k · g_k(P_k(m)), 其中f_act为将pIC50映射到归一化效用（例如sigmoid或线性归一化到[0,1]），P_k(m)为第k个ADMET预测为1的概率，g_k为该概率的效用函数（例如恒等或更重视高概率的凸函数），w_act与w_k为相对权重。化合物优选可通过求解最大化S(m)的离散集合或通过贝叶斯优化在连续化学描述符空间上搜索局部最优，贝叶斯方法可利用联合高斯过程或多输出GP来处理不确定性并用期望改进（EI）或多目标EI作为采集函数，从而同时考虑预测均值与不确定性。也可构建Pareto前沿：将pIC50_pred作为一个目标，将ADMET满足数目或综合得分作为其他目标，通过多目标演化算法（如NSGA-II）在候选化合物集合上找到不可支配解集。用部分依赖图 (PDP) 与每个重要描述符的SHAP依赖图确定“有利的取值区间”：例如若某描述符d的PDP显示在区间[a,b]时pIC50显著上升且对应ADMET模型对有利端点的概率也增加，则可将[a,b]视为有利区间。为提供可操作的阈值，定义同时满足pIC50_pred ≥ τ_act 且至少三项ADMET P_k(m) ≥ τ_admet 的规则筛选器，其中 τ_act 和 τ_admet 由项目风险偏好决定（典型可取 τ_act 对应实验IC50<100 nM，τ_admet=0.8）。从训练集中分析满足这些条件的化合物并统计其关键描述符分布，可以进一步提取统计显著的取值范围（例如用两样本t检验或非参数检验比较正样本和负样本在某描述符上的分布，结合置信区间给出阈值建议）。\n\n数值求解、计算资源与稳定性检验。LASSO/Elastic Net的求解可用坐标下降（glmnet风格），PLS用NIPALS算法，树模型用XGBoost的并行化C++实现，贝叶斯优化用Gaussian Process或TPE（Tree-structured Parzen Estimator）。数据规模（约2000×729）对现代台式机已足够；若进行大量超参数优化或贝叶斯优化并行化，使用多核CPU或小型计算集群将明显加速。为避免过拟合，所有模型调参与特征选择均放入内层CV，外层CV用于性能估计。用y‑randomization检验模型显著性（多次随机打乱y并重复训练，若原模型显著好于随机情况则通过测试）；用学习曲线判断是否有更多数据能显著提高性能。不确定性估计采用分位回归森林、conformal prediction或深度模型的MC Dropout实现。\n\n模型的更新、敏感性分析与验证。当新实验数据到来，优先采用贝叶斯更新或增量学习（在线随机梯度或浅层增量树）更新模型参数以保留既有信息并迅速适应新趋势。用于敏感性分析的方法包括全局方差分解（Sobol指标）与局部梯度法（对模型输出相对于输入变量的偏导数），并用Sobol结果验证SHAP排序的一致性。外部实验证据（小规模In vitro测试）用于闭环验证模型的预测能力，按阶段选择高S(m)得分与不确定性高的候选物分别实验验证以同时提升发现与模型可靠性。\n\n扩展与未来改进。为提升模型对真实体内情况的映射精度，可纳入更富信息的3D描述符、分子动力学/构象自由能估计、代谢位点预测与蛋白结合能估计。此外，引入更严格的不确定性量化（贝叶斯神经网络、蒙特卡洛法）和成本敏感的多目标优化（考虑实验成本与合成可行性）将提高实用性。长期而言，可将本框架与分子生成器（如条件变分自编码器或强化学习生成器）结合，以在可行化学空间内自动生成高S(m)的候选。通过上述步骤，模型既能输出问题1所需的变量重要性排序与稳定性证据，也能在问题2和问题3中提供精确的pIC50回归与五个ADMET分类预测，并在问题4中给出可操作的描述符取值范围和多目标筛选策略，最终为化学家提供既可靠又可解释的优化方向。",
  "task_descriptions": [
    "子任务1（特征筛选与重要性排序）旨在从“Molecular_Descriptor.xlsx”训练表中对齐“ERα_activity.xlsx”训练表的1974个样本（以SMILES对应）与729个数值分子描述符，系统化地筛除无信息或冗余的描述符并输出对pIC50影响最显著且稳定的前20个描述符及其可信度指标；该子任务的范围仅限数据清洗、单变量与多变量过滤、冗余削减、稳健的重要性评估与排序，不涉及后续回归或分类建模。具体步骤和方法如下：1) 数据准备与对齐：读取两表，用训练集的1974条记录（SMILES）做主键对齐描述符与pIC50标签；记录并保存描述符含义文档以便最终报告。2) 缺失值与异常值处理：剔除缺失率超过预置阈值（例如20%）的描述符；对剩余缺失值采用按描述符中位数插补或基于k‑NN插补（k≈5）；对极端异常值可采用winsorization（例如1st/99th分位截断）或对数变换以降低影响，所有处理步骤须记录并固定随机种子以保证可复现性。3) 去除低方差与非数值特征：删除恒定或近似恒定（VarianceThreshold，如<1e‑5或经验阈值）的列，确保剩余特征为可用于统计/机器学习的数值变量。4) 初步冗余过滤（过滤器/分簇法）：计算描述符间的两类相关性矩阵（Pearson与Spearman），基于层次聚类对高度相关组（|r|>0.95，可调整）进行合并，在每一高度相关簇中保留与pIC50单变量关联度（|corr|最大）或方差最大的代表项；此步显著降低共线性并控制后续计算规模。5) 单变量筛选：对每个剩余描述符计算与pIC50的Pearson与Spearman相关系数及对应p值，并可计算单变量解释度（R^2），保留一定数量的候选（例如前200按绝对相关度排序）以进入多变量评估，明确该阈值应通过内层交叉验证确定以避免过度剪裁。6) 多方法稳定性与重要性评估（嵌套/自助抽样保证非泄露）：在候选子集上并行使用（A）正则化线性模型稳定选择（Stability Selection）：多次子抽样或自助采样（例如B=100次，每次抽取50%样本），在每次内以交叉验证选取LASSO/Elastic Net的正则化参数并记录被选变量的频次；（B）基于树的模型（随机森林与XGBoost）：用分层k折交叉验证训练并计算每折的置换重要性（变量置换后性能下降的均值）與基于分裂的原生重要度；（C）模型解释方法SHAP：在训练好的XGBoost或RF上计算每个变量的平均绝对SHAP值以反映非线性交互下的全局贡献。所有方法都应在交叉验证或自助重抽样框架内重复以评估稳定性并输出平均重要性与标准差。7) 重要性指标归一化与合并排序：将上述多种重要性衡量（LASSO选择频次、树模型置换重要性、平均绝对SHAP）归一化为可比分值或秩，并采用加权平均或秩和法生成综合重要性分数；优先保留在多种度量中均表现良好的描述符以降低单一方法偏差。8) 稳健性检验与阈定输出：通过在若干随机种子/重抽样下计算变量排名的一致性指标（例如Kendall’s tau或选中频率），并设定最終入选规则（例如综合排名前20且稳定性频次>50%），输出最终前20变量名单。9) 交付物与记录：生成并保存（CSV/表格）排序结果包含：描述符名、描述符语义（来自“分子描述符含义解释.xlsx”）、单变量相关系数、LASSO选择频次、树置换重要性均值与标准差、SHAP均值、综合排序分数与稳定性指标；同时记录所有预处理参数、相关性阈值、重抽样次数、随机种子和所用软件库（建议工具：Python 的 pandas/numpy/scipy/scikit‑learn/xgboost/shap 或 R 的 data.table/glmnet/randomForest/xgboost/SHAPforxgboost）以保证方法可复现与审计。该子任务的成功判定标准是能提供一份可复现、经稳健性检验的、含可信度指标的前20重要描述符排序表，且每一步预处理与选择策略均有明确记录供审查。",
    "子任务2（pIC50 回归建模与对 50 个测试样本的预测）旨在以不超过 20 个分子描述符为输入，建立一个稳健、可复现且可解释的定量 QSAR 回归模型来预测化合物对 ERα 的 pIC50，并将预测结果转换为 IC50（nM）后填入 test 表；该子任务的输入为：已对齐且清洗后的训练集特征矩阵 X_train (n=1974 行 × 729 初始列) 与目标向量 y_train (pIC50)，以及经过相同预处理的 X_test (50 行)；输出为：最终模型文件、选定的 ≤20 个描述符名与含义、训练与验证性能指标（外层 CV 的 RMSE、MAE、R^2 与 Q^2）、对 50 个测试分子的 pIC50 预测值、对应的 IC50_nM（IC50_nM = 10^{−pIC50} × 1e9）、每个预测的预测区间/置信度以及适用域（AD）标识与不确定性说明。执行步骤与方法须包括：1) 明确预处理链并固定随机种子——删除缺失率 >20% 的描述符，对剩余缺失值用描述符中位数或 k‑NN（k≈5）插补；删除方差接近零的列；对数或 Box‑Cox 变换严重偏态特征（如有），并对所有候选特征应用标准化（z‑score）或鲁棒缩放以保证可比尺度；2) 初筛与降维：计算描述符间相关矩阵并对高度共线（|r|>0.95）簇内只保留与 pIC50 单变量相关性最大的代表，进而用单变量过滤（按绝对相关系数或单变量 R^2）将特征数缩减到若干百以便后续计算；3) 嵌套交叉验证框架保证性能估计不泄露——采用外层 5 折（可重复）用于泛化误差估计，内层 5 折用于特征选择与超参数优化；所有特征选择步骤必须置于内层循环内；4) 特征选择策略：在内层结合稳定选择（Stability Selection，B≈100 次子抽样记录 LASSO/ElasticNet 被选频次）、递归特征消除（RFE）以及基于树模型（RF/XGBoost）的置换重要性或平均绝对 SHAP 值，按稳定性与性能折衷最终确定不超过 20 个描述符；5) 模型候选与超参数调优：比较可解释线性模型（OLS、LASSO、ElasticNet、PLS）与非线性模型（SVR、随机森林、XGBoost），如有必要构建模型集合/堆叠（stacking）；在内层对各模型做网格或贝叶斯超参数搜索并以 RMSE/MAE 为优化目标，同时优先选择在外层 CV 上表现稳定且较易解释的模型；6) 不确定性与预测区间：为最终模型提供预测区间，线性模型可基于残差估计与 t 分布构建，非线性模型可使用分位回归森林、蒙特卡洛子模型集合或 conformal prediction 来生成可靠的区间估计，并报告区间覆盖率；7) 适用域评估：对每个测试样本计算杠杆值（h = x_new^T (X^T X)^{-1} x_new）并以阈值 h* = 3(p+1)/n 或基于训练集协方差的马氏距离与 χ^2( p ) 95% 分位数比较，超出阈值需标注“外推/高不确定性”；8) 诊断与稳健性检验：对最终模型执行残差分析（包括偏差、异方差性检验如 Breusch‑Pagan）、y‑随机化（例如 30–50 次打乱 y 的重训练）以验证非偶然性，以及绘制学习曲线判断是否存在欠拟合或过拟合并记录结果；9) 可解释性与报告：提供最终 20 个描述符的回归系数或相对重要性、部分依赖图或 SHAP 影响方向以便化学可操作解释；10) 可复现性交付物：保存用于训练的预处理脚本、特征选择逻辑与参数、最终模型对象、用于生成 test 预测的脚本及一个 CSV 表（或直接填回 ERα_activity.xlsx）包含 test SMILES、选定描述符值、pIC50_pred、IC50_nM_pred、预测区间下限/上限、AD 标志与不确定性注记；建议实现工具链为 Python（pandas/numpy/scikit‑learn/xgboost/lightgbm/shap/ mapie 或 conformalPrediction 库）或等效 R 包，并在运行说明中固定随机种子与软件版本以保证完全可复现。",
    "子任务3 的目标是利用提供的 1974 个样本的 729 个分子描述符（来自 Molecular_Descriptor.xlsx 的 training）和对应的五项二分类 ADMET 标签（来自 ADMET.xlsx 的 training），为每一个端点（Caco-2、CYP3A4、hERG、HOB、MN）独立构建、验证并选出最优的二分类预测模型，最终对给定的 50 个测试分子（Molecular_Descriptor.xlsx / ADMET.xlsx 的 test）输出每端点的预测类别与预测概率并写回 ADMET.xlsx 的相应列；该子任务的范围仅限于数据预处理、端点逐一的特征工程、模型训练与选择、概率校准、性能评估、模型解释与对测试集的批量预测与存档，不涉及回归建模或多目标优化。具体步骤和方法包括：1) 数据准备与一致性预处理——以 SMILES 键对齐训练/测试样本，统一缺失值处理策略（如训练集中位数或基于 k‑NN 的插补，并将同样规则应用于测试集），删除恒定/近零方差特征并记录所做变换；2) 特征降维与候选集合构建——先用过滤器方法（如方差阈值、与标签的单变量互信息或排序的相关性）去掉明显无关特征，再在每个端点上用嵌入式方法（L1 正则化逻辑回归 / Elastic Net 的稳定选择）或基于树的置换重要性筛选出一个较小的候选特征子集（可为几十至百个），所有特征选择步骤必须置于交叉验证的内层以避免信息泄露；3) 不平衡样本处理——若某端点标签不平衡，采用分层交叉验证、类权重调整或受控过采样（如 SMOTE）/欠采样策略（在内层 CV 中执行），并优先使用对不平衡稳健的评估指标；4) 模型候选与超参数优化——针对每个端点并行训练多种模型候选（可解释基线：带 L1/L2 的逻辑回归；性能导向：随机森林、XGBoost/LightGBM；必要时浅层神经网络 MLP 或多输出/多任务架构作为备选），在内层进行网格或贝叶斯超参搜索并用嵌套（nested）分层 CV 的外层估计泛化性能；5) 性能度量与模型选择准则——综合使用 ROC‑AUC、PR‑AUC（对不平衡尤重）、灵敏度/召回、特异度、F1 分数与校准误差（Brier score），并根据端点的项目偏好（例如对 hERG 更重视召回）调整决策阈值；6) 概率校准与不确定性——对最终模型做概率校准（Platt/Isotonic）以便输出可解释的预测概率，并对测试样本提供置信/不确定性度量（例如基于交叉验证的概率置信区间或模型集合投票概率）；7) 适用域检测——对每个测试样本计算描述符空间的适用域指标（如基于训练集的马氏距离或 leverage），当样本超出阈值时在输出中标注“外推/高不确定性”；8) 解释性分析——对最终每端点模型使用全局与局部解释工具（如基于置换的重要性、平均绝对 SHAP 值与必要时部分依赖图）识别关键描述符及其效应方向，结果用于输出可读的变量重要性表；9) 输出与可复现性交付物——为每一端点保存最终模型文件、预处理流水线、超参、校准器、选择的特征列表、交叉验证性能报告及稳定性指标，并用该模型批量对 50 个测试分子预测类别与概率（并在 ADMET.xlsx 的 test 表中填入对应列，同时附上每条预测的概率、校准后的概率、是否超出适用域的标注及随机种子/软件版本信息以保证可复现）。建议实现工具链：Python（pandas、scikit‑learn、xgboost/lightgbm、imbalanced‑learn、shap、calibration/Mapie 或等效库），或等效 R 包；并要求所有模型训练与选择均采用分层嵌套 CV、记录随机种子以避免信息泄露并保证结果可审计。",
    "子任务4（多目标优化与可操作描述符区间提取、敏感性分析与模型维护流程）的目标是：基于已有的每个分子的一组数值分子描述符及其对应的预测输出（回归模型给出的pIC50预测值与其不确定度估计，以及五个ADMET端点的预测概率及其不确定度），系统化地识别在同时提高ERα抑制活性与至少三个ADMET端点良好（由用户设定概率阈值）的条件下可操作的描述符改造方向和具体取值区间，并给出可复现的优化与维护流程；其输入为：待优化候选集（由训练集、测试集或虚拟库中每个分子的描述符向量）、对应的pIC50_pred与其预测区间、五个ADMET概率预测P_k及其不确定度估计，以及原始训练数据用于适用域判断与统计检验；输出为：一组遵循可解释准则的“候选分子优先级列表/帕累托前沿”、对优良候选的具体描述符取值区间（以统计置信区间和分位数表示）、全局与局部敏感性排序、可执行的合成导向建议、适用域与不确定性标注、以及模型维护/更新触发规则。执行步骤和方法（按顺序实施）：(1) 定义多目标准则——明确活性与ADMET的目标函数或约束（例如目标为最大化pIC50_pred，约束为至少三项ADMET P_k ≥ τ_admet，或定义综合分数 S(m)=w_act·norm(pIC50_pred)+Σ_k w_k·norm(P_k) 并明确归一化函数与权重w）；(2) 初步筛选候选集——在候选分子集合上应用适用域检测（基于训练集的马氏距离或leverage）剔除高外推风险分子并记录其不确定性标记；(3) 多目标优化与帕累托分析——在离散候选集合上计算S(m)并识别帕累托不可支配解集；对于需要在连续描述符空间搜索的新结构，使用多目标优化算法（推荐使用 NSGA‑II 或基于 pymoo/DEAP 的进化算法进行无约束/有约束多目标搜索，或用贝叶斯优化框架（如多目标 GP 或基于 TPE 的采集函数）在高不确定性区域进行样本高效探索）；(4) 可解释性与取值区间提取——对被选为优良（满足阈值或位于帕累托前沿）的分子集合，利用全局解释方法（SHAP 平均绝对值、变量重要性、Sobol 全局灵敏度分析）识别关键描述符，并用部分依赖图（PDP）、单变量/双变量 SHAP 依赖图、条件 PDP（或 ALE）分析每一关键描述符对 pIC50 与各 ADMET 概率的方向性与非线性效应；(5) 统计确定操作区间——对优良集合与非优良集合在每个关键描述符上的分布做统计比较（采用 t 检验或 Mann‑Whitney U 检验，根据分布选择无母数检验），并以优良集合的中位数±IQR 或 5%–95% 分位区间作为建议的“可操作取值区间”，同时计算该区间内样本的成功率与置信区间以量化建议的可靠性；(6) 局部敏感性与稳健性检验——对候选代表分子做一阶一元扰动（单变量±Δ）和局部多变量扰动模拟，观察模型输出的变化并计算局部弹性系数，识别对结果敏感且易于合成调整的描述符；(7) 验证与回溯模拟——在训练或独立验证集中用所提取的阈值筛选分子并计算正/负预测值（PPV/NPV）、召回率等指标以评估规则的上下文适用性；(8) 可执行建议与输出格式——生成易读报告与机器可读文件：帕累托前沿分子清单（含S(m)、pIC50_pred、每项ADMET概率、适用域标志）、关键描述符清单及其“推荐区间+置信度”、局部合成建议（哪些原子团/理化属性需增减以移动描述符至目标区间）、以及示例合成优先级序列；(9) 不确定性管理与决策阈定——为每一条建议提供不确定性标注（基于预测区间或模型集合方差），并建议决策策略（例如高置信度优先合成，高不确定性但帕累托优解可先做小规模验证实验）；(10) 维护与重训练触发规则——定义明确的监控指标与触发条件（例如当新增实验标注数超过 N_new 或模型在新验证样本上的性能下降超过预设阈值 Δ性能时触发重训练/增量学习），要求版本控制（模型与数据版本）、日志记录与可重复的重现脚本；(11) 推荐工具与实现细节——建议使用 Python 工具链（pandas/numpy/scikit‑learn/xgboost/lightgbm/pymoo 或 DEAP、GP 或 scikit‑optimize / gpflow、SHAP、SALib 用于 Sobol 分析、statsmodels/scipy 用于统计检验、Mapie/ConformalPrediction 用于不确定度区间），并保证所有分析在固定随机种子、记录软件版本的条件下可复现。该子任务限定不进行新的实验测定或引入额外的外部描述符集，所有结论应建立在给定的描述符与预测输出之上，并以可复现的脚本、明确阈值与置信度指标交付，便于化学家据此制定合成与验证优先级。"
  ]
}