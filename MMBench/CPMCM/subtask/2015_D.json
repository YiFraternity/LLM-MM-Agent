{
  "tasks": [],
  "problem_str": "问题背景：\n轨道交通系统的能耗是指列车牵引、通风空调、电梯、照明、给排水、弱电等设备产生的能耗。根据统计数据，列车牵引能耗占轨道交通系统总能耗40%以上。在低碳环保、节能减排日益受到关注的情况下，针对减少列车牵引能耗的列车运行优化控制近年来成为轨道交通领域的重要研究方向。\n\n1. 列车运行过程\n\n列车在站间运行时会根据线路条件、自身列车特性、前方线路状况计算出一个限制速度。列车运行过程中不允许超过此限制速度。限制速度会周期性更新。在限制速度的约束下列车通常包含四种运行工况：牵引、巡航、惰行和制动。\n\n牵引阶段：列车加速，发动机处于耗能状态。\n\n巡航阶段：列车匀速，列车所受合力为0，列车是需要牵引还是需要制动取决于列车当时受到的总阻力。\n\n惰行阶段：列车既不牵引也不制动，列车运行状态取决于受到的列车总阻力，发动机不耗能。\n\n制动阶段：列车减速，发动机不耗能。如果列车采用再生制动技术，此时可以将动能转换为电能反馈回供电系统供其他用电设备使用，例如其他正在牵引的列车或者本列车的空调等（本列车空调的耗能较小，通常忽略不计）。\n\n如果车站间距离较短，列车一般采用“牵引-惰行-制动”的策略运行。如果站间距离较长，列车通常会采用牵引到接近限制速度后，交替使用惰行、巡航、牵引三种工况，直至接近下一车站采用制动进站停车。\n\n\n图 1 列车站间运行曲线\n\n\n列车在运行过程中，实际受力状态非常复杂。采用单质点模型是一种常见的简化方法。单质点模型将列车视为单质点，列车运动符合牛顿运动学定律。其受力可分为四类：重力$G$在轨道垂直方向上的分力与受到轨道的托力抵消，列车牵引力$F$，列车制动力$B$和列车运行总阻力$W$。\n\n\n图2 单质点列车受力分析示意图\n\n（1）列车牵引力\n\n列车牵引力 $F$ 是由动力传动装置产生的、与列车运行方向相同、驱动列车运行并可由司机根据需要调节的外力。牵引力 $F$ 在不同速度下存在不同的最大值 $F_{max} = f_F(v)$，具体数据参见附件。列车实际输出牵引力（kN）基于以下公式进行计算。\n\n\\begin{equation}\nF = \\mu F_{max}\n\\end{equation}\n\n其中，$\\mu$ 为实际输出的牵引加速度与最大加速度的百分比，$F_{max}$ 为牵引力最大值（kN）。\n\n图3 列车牵引特征曲线示意图\n\n（2）列车运行总阻力\n\n列车总阻力是指列车与外界相互作用引起与列车运行方向相反、一般是阻碍列车运行的、不能被司机控制的外力。按其形成原因可分为基本阻力和附加阻力。\n\n1）基本阻力\n\n列车的基本阻力是列车在空旷地段沿平、直轨道运行时所受到的阻力。该阻力是由于机械摩擦，空气摩擦等因素作用而产生的固有阻力。具体可分为以下五部分：1、车轴轴承间摩擦阻力；2、轮轨间滚动摩擦阻力；3、轮轨间滑动摩擦阻力；4、冲击阻力；5气动阻力。因此，基本阻力与许多因素有关，它主要取决于机车、车辆结构和技术状态、轴重、以及列车运行速度等，同时又受线路情况、气候条件影响。由于这些因素极为复杂，而且相互影响，实际应用中很难用理论公式进行准确计算，通常采用以下经验公式进行计算：\n\n\\begin{equation}\nw_0 = A + Bv + Cv^2\n\\end{equation}\n\n其中 $w_0$ 为单位基本阻力（N/kN），$A$、$B$、$C$ 为阻力多项式系数，通常取经验值，$v$ 为列车速度（km/h）。\n\n2）附加阻力\n\n列车由于在附加条件下（通过坡道、曲线、隧道）运行所增加的阻力叫做附加阻力。附加阻力主要考虑坡道附加阻力和曲线附加阻力。\n\n\\[ w_1 = w_i + w_c \\]\n\n列车的坡道附加阻力是列车上下坡时重力在列车运行方向上的一个分力。通常采用如下公式计算\n\n\\[ w_i = i \\]\n\n其中 $w_i$ 为单位坡道阻力系数（N/kN），$i$ 为线路坡度（‰）。$i$ 为正表示上坡，$i$ 为负表示下坡。\n\n列车的曲线阻力主要源自取决于轨道线路的曲率半径，列车在曲线上运行时，轮轨间纵向和横向的滑动摩擦力增加，转向架等各部分摩擦力也有所增加。通常采用如下公式计算：\n\n\\[ w_c = c / R \\]\n\n其中 $w_c$ 为单位曲线阻力系数（N/kN），$R$ 为曲率半径（m）；$c$ 为综合反映影响曲线阻力许多因素的经验常数，我国轨道交通一般取 600。\n\n有时为了计算方便，当坡道附加阻力、曲线附加阻力同时出现时，根据阻力值相等的原则，把列车通过曲线时所产生的附加阻力折算为坡道阻力，加上线路实际坡度即为加算坡度。\n\n综上，列车运行总阻力可按照如下公式计算：\n\n\\[ W = (w_0 + w_1) \\times g \\times M / 1000 \\]\n\n其中，$W$ 为线路阻力（N），$w_0$ 为单位基本阻力系数（N/kN），$w_1$ 为单位附加阻力系数（N/kN），$M$ 为列车质量（kg），$g$ 为重力加速度常数。\n\n\\section*{(3) 列车制动力 $B$}\n\n制动力 $B$ 是由制动装置引起的、与列车运行方向相反的、司机可根据需要控制其大小的外力。制动力 $B$ 存在与制动时列车速度有关的最大值，$B_{max} = f_B(v)$，当然制动力也可以小于 $B_{max}$。具体数据参见附件。列车实际输出制动力（kN）基于以下公式进行计算\n\n\\[ B = \\mu B_{max} \\]\n\n其中，$\\mu$ 为实际输出的制动加速度与最大加速度的百分比，$B_{max}$ 为制动力最大值（kN）。\n\n3. 运行时间与运行能耗的关系\n\n当列车在站间运行时，存在着多条速度距离曲线供选择。不同速度距离曲线对应不同的站间运行时间和不同的能耗。列车按照图 4 所示 4 条曲线可以走完相同的距离，但运行时间和能耗并不相同。此外，即便站间运行时间相同时，也存在多条速度距离曲线可供列车选择。此外，即便站间运行时间相同时，也存在多条速度距离曲线可供列车选择。\n\n\n图4 列车站间运行速度距离曲线\n\n一般认为，列车站间运行时间和能耗存在近似图5中的反比关系，比较准确的定量关系应根据前面的公式计算。注意，增加相同的运行时间不一定会减少等量的能耗。列车站间运行时间与能耗变化的趋势影响能耗的减少。\n\n\n图5 站间运行时间与能耗关系。\n\n\n图6 再生能量利用示意图\n\n\n\n4 再生能量利用原理\n\n随着制动技术的进步，目前城市轨道交通普遍采用再生制动。再生制动时，牵引电动机转变为发电机工况，将列车运行的动能转换为电能，发电机产生的制动力使列车减速，此时列车向接触网反馈电能，此部分能量即为再生制动能。如图6所示，列车 \\(i+1\\) 在制动时会产生能量 \\(E_{\\text{reg}}\\)，如果相邻列车 \\(i\\) 处于加速状态，其可以利用 \\(E_{\\text{reg}}\\)，从而减少从变电站获得的能量，达到节能的目的。如果列车 \\(i+1\\) 制动时，其所处供电区段内没有其他列车加速，其产生的再生能量除用于本列车空调、照明等设备外，通常被吸收电阻转化为热能消耗掉。\n\n\\textbf{假设：}\n\n\\textbf{产生的再生能量}\n\\[\nE_{\\text{reg}} = (E_{\\text{mech}} - E_{\\text{f}}) \\cdot 95\\%\n\\]\n其中 \\(E_{\\text{mech}}\\) 是制动过程中列车机械能的变化量，\\(E_{\\text{f}}\\) 是制动过程中为克服基本阻力和附加阻力所做功。\n\n被利用了的再生能量可按照以下假设的公式计算\n\\[\nE_{\\text{used}} = E_{\\text{reg}} \\cdot t_{\\text{overlap}} / t_{\\text{brake}}\n\\]\n其中 \\(t_{\\text{overlap}}\\) 是列车 \\(i+1\\) 制动的时间与列车 \\(i\\) 加速时间的重叠时间，\\(t_{\\text{brake}}\\) 是列车 \\(i+1\\) 的制动时间。即制动时所产生的再生能量与制动时间成正比。\n\n问题要求：\n请研究以下问题：\n\n单列车节能运行优化控制问题\n\n(1) 请建立计算速度距离曲线的数学模型，计算寻找一条列车从 \\(A_6\\) 站出发到达 \\(A_7\\) 站的最节能运行的速度距离曲线，其中两车站间的运行时间为 110 秒，列车参数和线路参数详见文件“列车参数.xlsx”和“线路参数.xlsx”。\n\n(2) 请建立新的计算速度距离曲线的数学模型，计算寻找一条列车从 \\(A_6\\) 站出发到达 \\(A_8\\) 站的最节能运行的速度距离曲线，其中要求列车在 \\(A_7\\) 车站停站 45 秒，\\(A_6\\) 站和 \\(A_8\\) 站间总运行时间规定为 220 秒（不包括停站时间），列车参数和线路参数详见文件“列车参数.xlsx”和“线路参数.xlsx”。\n\n注：请将本问（1）和（2）得到的曲线数据按每秒钟一行填写到文件“数据格式.xlsx”中红色表头那几列，并将该文件和论文一并提交。（请只填写和修改数据，一定不要修改文件“数据格式.xlsx”的格式。其中计算公里标（m）是到起点的距离，计算距离（m）是到刚通过的一站的距离）\n\n\\textbf{二、多列车节能运行优化控制问题}\n\n(1) 当 100 列列车以间隔 \\(H = \\{h_1, \\ldots, h_{99}\\}\\) 从 \\(A_1\\) 站出发，追踪运行，依次经过 \\(A_2\\)，\\(A_3\\)，……到达 \\(A_{14}\\) 站，中间在各个车站停站最少 \\(D_{\\text{min}}\\) 秒，最多 \\(D_{\\text{max}}\\) 秒。间隔 \\(H\\) 各分量的变化范围是 \\(H_{\\text{min}}\\) 秒至 \\(H_{\\text{max}}\\) 秒。请建立优化模型并寻找使所有列车运行总能耗最低的间隔 \\(H\\)。要求第一列列车发车时间和最后一列列车的发车时间之间间隔为 \\(T_0 = 63900\\) 秒，且从 \\(A_1\\) 站到 \\(A_{14}\\) 站的总运行时间不变，均为 2086s（包括停站时间）。假设所有列车处于同一供电区段，各个车站间线路参数详见文件“列车参数.xlsx”和“线路参数.xlsx”。\n\n补充说明：列车追踪运行时，为保证安全，跟踪列车（后车）速度不能超过限制速度 \\(V_{\\text{limit}}\\)，以免后车无法及时制动停车，发生追尾事故。其计算方式可简化如下：\n\\[\nV_{\\text{limit}} = \\min(V_{\\text{line}}, \\sqrt{2LB_e})\n\\]\n其中 \\(V_{\\text{line}}\\) 是列车当前位置的线路限速（km/h），\\(L\\) 是当前时刻前后车之间的距离。\\begin{enumerate}\n    \\item[(2)] 接上问，如果高峰时间（早高峰 7200 秒至 12600 秒，晚高峰 43200 至 50400 秒）发车间隔不大于 2.5 分钟且不小于 2 分钟，其余时间发车间隔不小于 5 分钟，每天 240 列。请重新为它们制定运行图和相应的速度距离曲线。\n\\end{enumerate}\n\n三、列车延误后运行优化控制问题\n\n接上问，若列车 $i$ 在车站 $A_j$ 延误 $DT_j^i$（10 秒）发车，请建立控制模型，找出在确保安全的前提下，首先使所有后续列车尽快恢复正点运行，其次恢复期间耗能最少的列车运行曲线。\n\n假设 $DT_j^i$ 为随机变量，普通延误（$0 < DT_j^i < 10s$）概率为 20%，严重延误（$DT_j^i > 10s$）概率为 10%（超过 120s，接近下一班，不考虑调整），无延误（$DT_j^i = 0$）概率为 70%。若允许列车在各站到、发时间与原时间相比提前不超过 10 秒，根据上述统计数据，如何对第二问的控制方案进行调整？\nAddendum: \n参考文献：\n\n[1] P. Howllet, An Optimal Strategy for the Control of A Train, Journal of the Australian Mathematical Society. Series B. Applied Mathematics, Volume 31, Issue 04, April 1990, pp. 454-471.\n\n[2] 丁勇，毛保华，刘海东，张鑫，王铁城，列车节能运行模拟系统的研究，北京交通大学\n学报，第28卷第2期，第76-81页\n\n[3] 金炜东，靳蕃，李崇维，胡飞，苟先太，列车优化操纵速度模式曲线生成的智能计算研究，铁道学报，第20卷，第5期，第47-52页.\n\n[4] E. Khmelnitsky, On an optimal control problem of train operation, IEEE Transactions on Automatic Control, Volume 45, Issue 7, pp. 1257 – 1266.\n\n[5] Rongfang (Rachel) Liu, Lakov M. Golovitcher, Energy-efficient operation of rail vehicles, Transportation Research Part A: Policy and Practice, Volume 37, Issue 10, pp. 917-932.\n\n[6] Su S, Tang T, Li X, et al. Optimization of multitrain operations in a subway system[J]. Intelligent Transportation Systems, IEEE Transactions on, 2014, 15(2): 673-684.\n\n[7] Albrecht T, Oettich S. A new integrated approach to dynamic schedule synchronization and energy-saving train control[J]. Publication of: WIT Press, 2002.\nDataset Path:\n['列车参数.docx', '线路参数.xlsx', '输入数据模板.xlsx']\n\nData Description:\n该数据集由三部分文件组成：列车参数.docx、线路参数.xlsx和输入数据模板.xlsx，整体用于列车节能运行优化与速度—距离曲线计算。列车参数文件包含列车的基本物理参数及牵引/制动特性曲线（包括最大牵引力与最大制动力等关键性能指标），用于在不同速度下计算牵引力、制动力与功率输出；线路参数表覆盖从A1站到A14站的线路要素，按区段给出公里标（单位m）、起止公里标、坡度（‰）、分段限速（km/h）与曲线半径（m）等地形与约束信息；输入数据模板聚焦于A6至A7及A8区间的节能运行优化问题，包含列车运行的基础输入与数值样本，便于生成和验证速度—距离曲线与运行仿真。数据字段包括车站名称、发车时刻与时刻记录（hh:mm:ss）、站间实际长度（m）、停站时间与运行时间（s）、满载率（%）、目标距离与计算距离/公里标（m）、目标速度/实际速度与EBI限制速度（以cm/s和km/h两种单位）、基于速度的计算加速度（m/s²）、网压（V）和网流（A）、ATO与PID相关输出（如ATO输出电流、PID期望输出加速度百分比）、以及由控制输出推导的计算牵引力（N）、牵引功率和辅助功率（kW）等。总体上该数据集提供了涵盖线路约束、列车动力学特性与详细运行/控制量测的完整信息集合，适用于能耗评估、运行时刻与速度曲线优化、ATO控制策略验证以及列车动力学与能量仿真分析，所有数值字段均标注了物理单位以保证可直接用于建模与计算。",
  "problem": {
    "background": "轨道交通系统的能耗是指列车牵引、通风空调、电梯、照明、给排水、弱电等设备产生的能耗。根据统计数据，列车牵引能耗占轨道交通系统总能耗40%以上。在低碳环保、节能减排日益受到关注的情况下，针对减少列车牵引能耗的列车运行优化控制近年来成为轨道交通领域的重要研究方向。\n\n1. 列车运行过程\n\n列车在站间运行时会根据线路条件、自身列车特性、前方线路状况计算出一个限制速度。列车运行过程中不允许超过此限制速度。限制速度会周期性更新。在限制速度的约束下列车通常包含四种运行工况：牵引、巡航、惰行和制动。\n\n牵引阶段：列车加速，发动机处于耗能状态。\n\n巡航阶段：列车匀速，列车所受合力为0，列车是需要牵引还是需要制动取决于列车当时受到的总阻力。\n\n惰行阶段：列车既不牵引也不制动，列车运行状态取决于受到的列车总阻力，发动机不耗能。\n\n制动阶段：列车减速，发动机不耗能。如果列车采用再生制动技术，此时可以将动能转换为电能反馈回供电系统供其他用电设备使用，例如其他正在牵引的列车或者本列车的空调等（本列车空调的耗能较小，通常忽略不计）。\n\n如果车站间距离较短，列车一般采用“牵引-惰行-制动”的策略运行。如果站间距离较长，列车通常会采用牵引到接近限制速度后，交替使用惰行、巡航、牵引三种工况，直至接近下一车站采用制动进站停车。\n\n\n图 1 列车站间运行曲线\n\n\n列车在运行过程中，实际受力状态非常复杂。采用单质点模型是一种常见的简化方法。单质点模型将列车视为单质点，列车运动符合牛顿运动学定律。其受力可分为四类：重力$G$在轨道垂直方向上的分力与受到轨道的托力抵消，列车牵引力$F$，列车制动力$B$和列车运行总阻力$W$。\n\n\n图2 单质点列车受力分析示意图\n\n（1）列车牵引力\n\n列车牵引力 $F$ 是由动力传动装置产生的、与列车运行方向相同、驱动列车运行并可由司机根据需要调节的外力。牵引力 $F$ 在不同速度下存在不同的最大值 $F_{max} = f_F(v)$，具体数据参见附件。列车实际输出牵引力（kN）基于以下公式进行计算。\n\n\\begin{equation}\nF = \\mu F_{max}\n\\end{equation}\n\n其中，$\\mu$ 为实际输出的牵引加速度与最大加速度的百分比，$F_{max}$ 为牵引力最大值（kN）。\n\n图3 列车牵引特征曲线示意图\n\n（2）列车运行总阻力\n\n列车总阻力是指列车与外界相互作用引起与列车运行方向相反、一般是阻碍列车运行的、不能被司机控制的外力。按其形成原因可分为基本阻力和附加阻力。\n\n1）基本阻力\n\n列车的基本阻力是列车在空旷地段沿平、直轨道运行时所受到的阻力。该阻力是由于机械摩擦，空气摩擦等因素作用而产生的固有阻力。具体可分为以下五部分：1、车轴轴承间摩擦阻力；2、轮轨间滚动摩擦阻力；3、轮轨间滑动摩擦阻力；4、冲击阻力；5气动阻力。因此，基本阻力与许多因素有关，它主要取决于机车、车辆结构和技术状态、轴重、以及列车运行速度等，同时又受线路情况、气候条件影响。由于这些因素极为复杂，而且相互影响，实际应用中很难用理论公式进行准确计算，通常采用以下经验公式进行计算：\n\n\\begin{equation}\nw_0 = A + Bv + Cv^2\n\\end{equation}\n\n其中 $w_0$ 为单位基本阻力（N/kN），$A$、$B$、$C$ 为阻力多项式系数，通常取经验值，$v$ 为列车速度（km/h）。\n\n2）附加阻力\n\n列车由于在附加条件下（通过坡道、曲线、隧道）运行所增加的阻力叫做附加阻力。附加阻力主要考虑坡道附加阻力和曲线附加阻力。\n\n\\[ w_1 = w_i + w_c \\]\n\n列车的坡道附加阻力是列车上下坡时重力在列车运行方向上的一个分力。通常采用如下公式计算\n\n\\[ w_i = i \\]\n\n其中 $w_i$ 为单位坡道阻力系数（N/kN），$i$ 为线路坡度（‰）。$i$ 为正表示上坡，$i$ 为负表示下坡。\n\n列车的曲线阻力主要源自取决于轨道线路的曲率半径，列车在曲线上运行时，轮轨间纵向和横向的滑动摩擦力增加，转向架等各部分摩擦力也有所增加。通常采用如下公式计算：\n\n\\[ w_c = c / R \\]\n\n其中 $w_c$ 为单位曲线阻力系数（N/kN），$R$ 为曲率半径（m）；$c$ 为综合反映影响曲线阻力许多因素的经验常数，我国轨道交通一般取 600。\n\n有时为了计算方便，当坡道附加阻力、曲线附加阻力同时出现时，根据阻力值相等的原则，把列车通过曲线时所产生的附加阻力折算为坡道阻力，加上线路实际坡度即为加算坡度。\n\n综上，列车运行总阻力可按照如下公式计算：\n\n\\[ W = (w_0 + w_1) \\times g \\times M / 1000 \\]\n\n其中，$W$ 为线路阻力（N），$w_0$ 为单位基本阻力系数（N/kN），$w_1$ 为单位附加阻力系数（N/kN），$M$ 为列车质量（kg），$g$ 为重力加速度常数。\n\n\\section*{(3) 列车制动力 $B$}\n\n制动力 $B$ 是由制动装置引起的、与列车运行方向相反的、司机可根据需要控制其大小的外力。制动力 $B$ 存在与制动时列车速度有关的最大值，$B_{max} = f_B(v)$，当然制动力也可以小于 $B_{max}$。具体数据参见附件。列车实际输出制动力（kN）基于以下公式进行计算\n\n\\[ B = \\mu B_{max} \\]\n\n其中，$\\mu$ 为实际输出的制动加速度与最大加速度的百分比，$B_{max}$ 为制动力最大值（kN）。\n\n3. 运行时间与运行能耗的关系\n\n当列车在站间运行时，存在着多条速度距离曲线供选择。不同速度距离曲线对应不同的站间运行时间和不同的能耗。列车按照图 4 所示 4 条曲线可以走完相同的距离，但运行时间和能耗并不相同。此外，即便站间运行时间相同时，也存在多条速度距离曲线可供列车选择。此外，即便站间运行时间相同时，也存在多条速度距离曲线可供列车选择。\n\n\n图4 列车站间运行速度距离曲线\n\n一般认为，列车站间运行时间和能耗存在近似图5中的反比关系，比较准确的定量关系应根据前面的公式计算。注意，增加相同的运行时间不一定会减少等量的能耗。列车站间运行时间与能耗变化的趋势影响能耗的减少。\n\n\n图5 站间运行时间与能耗关系。\n\n\n图6 再生能量利用示意图\n\n\n\n4 再生能量利用原理\n\n随着制动技术的进步，目前城市轨道交通普遍采用再生制动。再生制动时，牵引电动机转变为发电机工况，将列车运行的动能转换为电能，发电机产生的制动力使列车减速，此时列车向接触网反馈电能，此部分能量即为再生制动能。如图6所示，列车 \\(i+1\\) 在制动时会产生能量 \\(E_{\\text{reg}}\\)，如果相邻列车 \\(i\\) 处于加速状态，其可以利用 \\(E_{\\text{reg}}\\)，从而减少从变电站获得的能量，达到节能的目的。如果列车 \\(i+1\\) 制动时，其所处供电区段内没有其他列车加速，其产生的再生能量除用于本列车空调、照明等设备外，通常被吸收电阻转化为热能消耗掉。\n\n\\textbf{假设：}\n\n\\textbf{产生的再生能量}\n\\[\nE_{\\text{reg}} = (E_{\\text{mech}} - E_{\\text{f}}) \\cdot 95\\%\n\\]\n其中 \\(E_{\\text{mech}}\\) 是制动过程中列车机械能的变化量，\\(E_{\\text{f}}\\) 是制动过程中为克服基本阻力和附加阻力所做功。\n\n被利用了的再生能量可按照以下假设的公式计算\n\\[\nE_{\\text{used}} = E_{\\text{reg}} \\cdot t_{\\text{overlap}} / t_{\\text{brake}}\n\\]\n其中 \\(t_{\\text{overlap}}\\) 是列车 \\(i+1\\) 制动的时间与列车 \\(i\\) 加速时间的重叠时间，\\(t_{\\text{brake}}\\) 是列车 \\(i+1\\) 的制动时间。即制动时所产生的再生能量与制动时间成正比。",
    "problem_requirement": "请研究以下问题：\n\n单列车节能运行优化控制问题\n\n(1) 请建立计算速度距离曲线的数学模型，计算寻找一条列车从 \\(A_6\\) 站出发到达 \\(A_7\\) 站的最节能运行的速度距离曲线，其中两车站间的运行时间为 110 秒，列车参数和线路参数详见文件“列车参数.xlsx”和“线路参数.xlsx”。\n\n(2) 请建立新的计算速度距离曲线的数学模型，计算寻找一条列车从 \\(A_6\\) 站出发到达 \\(A_8\\) 站的最节能运行的速度距离曲线，其中要求列车在 \\(A_7\\) 车站停站 45 秒，\\(A_6\\) 站和 \\(A_8\\) 站间总运行时间规定为 220 秒（不包括停站时间），列车参数和线路参数详见文件“列车参数.xlsx”和“线路参数.xlsx”。\n\n注：请将本问（1）和（2）得到的曲线数据按每秒钟一行填写到文件“数据格式.xlsx”中红色表头那几列，并将该文件和论文一并提交。（请只填写和修改数据，一定不要修改文件“数据格式.xlsx”的格式。其中计算公里标（m）是到起点的距离，计算距离（m）是到刚通过的一站的距离）\n\n\\textbf{二、多列车节能运行优化控制问题}\n\n(1) 当 100 列列车以间隔 \\(H = \\{h_1, \\ldots, h_{99}\\}\\) 从 \\(A_1\\) 站出发，追踪运行，依次经过 \\(A_2\\)，\\(A_3\\)，……到达 \\(A_{14}\\) 站，中间在各个车站停站最少 \\(D_{\\text{min}}\\) 秒，最多 \\(D_{\\text{max}}\\) 秒。间隔 \\(H\\) 各分量的变化范围是 \\(H_{\\text{min}}\\) 秒至 \\(H_{\\text{max}}\\) 秒。请建立优化模型并寻找使所有列车运行总能耗最低的间隔 \\(H\\)。要求第一列列车发车时间和最后一列列车的发车时间之间间隔为 \\(T_0 = 63900\\) 秒，且从 \\(A_1\\) 站到 \\(A_{14}\\) 站的总运行时间不变，均为 2086s（包括停站时间）。假设所有列车处于同一供电区段，各个车站间线路参数详见文件“列车参数.xlsx”和“线路参数.xlsx”。\n\n补充说明：列车追踪运行时，为保证安全，跟踪列车（后车）速度不能超过限制速度 \\(V_{\\text{limit}}\\)，以免后车无法及时制动停车，发生追尾事故。其计算方式可简化如下：\n\\[\nV_{\\text{limit}} = \\min(V_{\\text{line}}, \\sqrt{2LB_e})\n\\]\n其中 \\(V_{\\text{line}}\\) 是列车当前位置的线路限速（km/h），\\(L\\) 是当前时刻前后车之间的距离。\\begin{enumerate}\n    \\item[(2)] 接上问，如果高峰时间（早高峰 7200 秒至 12600 秒，晚高峰 43200 至 50400 秒）发车间隔不大于 2.5 分钟且不小于 2 分钟，其余时间发车间隔不小于 5 分钟，每天 240 列。请重新为它们制定运行图和相应的速度距离曲线。\n\\end{enumerate}\n\n三、列车延误后运行优化控制问题\n\n接上问，若列车 $i$ 在车站 $A_j$ 延误 $DT_j^i$（10 秒）发车，请建立控制模型，找出在确保安全的前提下，首先使所有后续列车尽快恢复正点运行，其次恢复期间耗能最少的列车运行曲线。\n\n假设 $DT_j^i$ 为随机变量，普通延误（$0 < DT_j^i < 10s$）概率为 20%，严重延误（$DT_j^i > 10s$）概率为 10%（超过 120s，接近下一班，不考虑调整），无延误（$DT_j^i = 0$）概率为 70%。若允许列车在各站到、发时间与原时间相比提前不超过 10 秒，根据上述统计数据，如何对第二问的控制方案进行调整？",
    "dataset_path": [
      "列车参数.docx",
      "线路参数.xlsx",
      "输入数据模板.xlsx"
    ],
    "dataset_description": {
      "列车参数": "列车参数.docx包含列车的基本参数和牵引/制动特性曲线，包括最大牵引力和最大制动力，这些参数对于计算列车在不同速度下的运行特性至关重要。",
      "线路参数": "线路参数.xlsx包含从A1站到A14站的线路参数，包括各车站的公里标、坡度信息、限速信息以及曲率信息。",
      "输入数据模板": "输入数据模板.xlsx包含列车从A6站到A7站和A8站的节能运行优化控制问题的数据。文件中包括列车运行的基本数据和具体数值，用于计算速度距离曲线。"
    },
    "variable_description": [
      {},
      {
        "车站名称": "车站的名称",
        "公里标(m)": "车站距离起点的公里数（单位：米）",
        "起始公里标": "坡度、限速或曲率变化的起始公里标（单位：米）",
        "坡度": "坡度值（单位：‰）",
        "终点公里标": "坡度、限速或曲率变化的终点公里标（单位：米）",
        "限速(km/h)": "限速值（单位：公里/小时）",
        "曲线半径（m）": "曲线的半径值（单位：米）"
      },
      {
        "车站名称": "列车经过的车站名称",
        "发车时刻": "列车在该站的发车时刻，格式为hh:mm:ss",
        "站间实际长度(m)": "该站与下一站间的实际距离，单位为米",
        "停站时间(s)": "列车在该站的停站时间，单位为秒",
        "站间运行时间(s)": "该站与下一站间的运行时间，单位为秒",
        "满载率(%)": "列车的满载比率",
        "时刻(hh:mm:ss)": "记录数据的时刻，格式为hh:mm:ss",
        "目标距离(m)": "距离下一个目标停车点的距离，单位为米",
        "EBI速度(cm/s)": "限制速度，单位为厘米/秒",
        "EBI速度(km/h)": "限制速度，单位为千米/小时",
        "目标速度(cm/s)": "控制器跟踪的速度，单位为厘米/秒",
        "目标速度(km/h)": "控制器跟踪的速度，单位为千米/小时",
        "实际速度(cm/s)": "信号系统测量的列车实际速度，单位为厘米/秒",
        "实际速度(km/h)": "信号系统测量的列车实际速度，单位为千米/小时",
        "计算加速度(m/s2)": "基于实际速度计算得到的实际加速度，单位为米/秒²",
        "计算距离(m)": "以前一目标点为零点走过的距离，单位为米",
        "计算公里标(m)": "以线路起点为零点走过的距离，单位为米",
        "网压(V)": "当前受流器处的电压值，单位为伏特",
        "网流(A)": "当前受流器处的电流值，单位为安培",
        "ATO输出的电流值": "ATO系统输出的电流值",
        "当前坡度(‰)": "当前坡度，单位为千分比",
        "PID控制器期望输出的加速度(％)": "ATO控制器期望输出牵引/制动力的百分比",
        "计算牵引力(N)": "当前输出的牵引力，单位为牛顿",
        "计算牵引功率(Kw)": "当前输出的电机功率，单位为千瓦",
        "辅助功率(Kw)": "辅助系统的功率，单位为千瓦"
      }
    ],
    "addendum": "参考文献：\n\n[1] P. Howllet, An Optimal Strategy for the Control of A Train, Journal of the Australian Mathematical Society. Series B. Applied Mathematics, Volume 31, Issue 04, April 1990, pp. 454-471.\n\n[2] 丁勇，毛保华，刘海东，张鑫，王铁城，列车节能运行模拟系统的研究，北京交通大学\n学报，第28卷第2期，第76-81页\n\n[3] 金炜东，靳蕃，李崇维，胡飞，苟先太，列车优化操纵速度模式曲线生成的智能计算研究，铁道学报，第20卷，第5期，第47-52页.\n\n[4] E. Khmelnitsky, On an optimal control problem of train operation, IEEE Transactions on Automatic Control, Volume 45, Issue 7, pp. 1257 – 1266.\n\n[5] Rongfang (Rachel) Liu, Lakov M. Golovitcher, Energy-efficient operation of rail vehicles, Transportation Research Part A: Policy and Practice, Volume 37, Issue 10, pp. 917-932.\n\n[6] Su S, Tang T, Li X, et al. Optimization of multitrain operations in a subway system[J]. Intelligent Transportation Systems, IEEE Transactions on, 2014, 15(2): 673-684.\n\n[7] Albrecht T, Oettich S. A new integrated approach to dynamic schedule synchronization and energy-saving train control[J]. Publication of: WIT Press, 2002.",
    "data_summary": "Dataset Path:\n['列车参数.docx', '线路参数.xlsx', '输入数据模板.xlsx']\n\nData Description:\n该数据集由三部分文件组成：列车参数.docx、线路参数.xlsx和输入数据模板.xlsx，整体用于列车节能运行优化与速度—距离曲线计算。列车参数文件包含列车的基本物理参数及牵引/制动特性曲线（包括最大牵引力与最大制动力等关键性能指标），用于在不同速度下计算牵引力、制动力与功率输出；线路参数表覆盖从A1站到A14站的线路要素，按区段给出公里标（单位m）、起止公里标、坡度（‰）、分段限速（km/h）与曲线半径（m）等地形与约束信息；输入数据模板聚焦于A6至A7及A8区间的节能运行优化问题，包含列车运行的基础输入与数值样本，便于生成和验证速度—距离曲线与运行仿真。数据字段包括车站名称、发车时刻与时刻记录（hh:mm:ss）、站间实际长度（m）、停站时间与运行时间（s）、满载率（%）、目标距离与计算距离/公里标（m）、目标速度/实际速度与EBI限制速度（以cm/s和km/h两种单位）、基于速度的计算加速度（m/s²）、网压（V）和网流（A）、ATO与PID相关输出（如ATO输出电流、PID期望输出加速度百分比）、以及由控制输出推导的计算牵引力（N）、牵引功率和辅助功率（kW）等。总体上该数据集提供了涵盖线路约束、列车动力学特性与详细运行/控制量测的完整信息集合，适用于能耗评估、运行时刻与速度曲线优化、ATO控制策略验证以及列车动力学与能量仿真分析，所有数值字段均标注了物理单位以保证可直接用于建模与计算。",
    "data_description": {
      "列车参数": "列车参数.docx包含列车的基本参数和牵引/制动特性曲线，包括最大牵引力和最大制动力，这些参数对于计算列车在不同速度下的运行特性至关重要。",
      "线路参数": "线路参数.xlsx包含从A1站到A14站的线路参数，包括各车站的公里标、坡度信息、限速信息以及曲率信息。",
      "输入数据模板": "输入数据模板.xlsx包含列车从A6站到A7站和A8站的节能运行优化控制问题的数据。文件中包括列车运行的基本数据和具体数值，用于计算速度距离曲线。"
    },
    "problem_str": "问题背景：\n轨道交通系统的能耗是指列车牵引、通风空调、电梯、照明、给排水、弱电等设备产生的能耗。根据统计数据，列车牵引能耗占轨道交通系统总能耗40%以上。在低碳环保、节能减排日益受到关注的情况下，针对减少列车牵引能耗的列车运行优化控制近年来成为轨道交通领域的重要研究方向。\n\n1. 列车运行过程\n\n列车在站间运行时会根据线路条件、自身列车特性、前方线路状况计算出一个限制速度。列车运行过程中不允许超过此限制速度。限制速度会周期性更新。在限制速度的约束下列车通常包含四种运行工况：牵引、巡航、惰行和制动。\n\n牵引阶段：列车加速，发动机处于耗能状态。\n\n巡航阶段：列车匀速，列车所受合力为0，列车是需要牵引还是需要制动取决于列车当时受到的总阻力。\n\n惰行阶段：列车既不牵引也不制动，列车运行状态取决于受到的列车总阻力，发动机不耗能。\n\n制动阶段：列车减速，发动机不耗能。如果列车采用再生制动技术，此时可以将动能转换为电能反馈回供电系统供其他用电设备使用，例如其他正在牵引的列车或者本列车的空调等（本列车空调的耗能较小，通常忽略不计）。\n\n如果车站间距离较短，列车一般采用“牵引-惰行-制动”的策略运行。如果站间距离较长，列车通常会采用牵引到接近限制速度后，交替使用惰行、巡航、牵引三种工况，直至接近下一车站采用制动进站停车。\n\n\n图 1 列车站间运行曲线\n\n\n列车在运行过程中，实际受力状态非常复杂。采用单质点模型是一种常见的简化方法。单质点模型将列车视为单质点，列车运动符合牛顿运动学定律。其受力可分为四类：重力$G$在轨道垂直方向上的分力与受到轨道的托力抵消，列车牵引力$F$，列车制动力$B$和列车运行总阻力$W$。\n\n\n图2 单质点列车受力分析示意图\n\n（1）列车牵引力\n\n列车牵引力 $F$ 是由动力传动装置产生的、与列车运行方向相同、驱动列车运行并可由司机根据需要调节的外力。牵引力 $F$ 在不同速度下存在不同的最大值 $F_{max} = f_F(v)$，具体数据参见附件。列车实际输出牵引力（kN）基于以下公式进行计算。\n\n\\begin{equation}\nF = \\mu F_{max}\n\\end{equation}\n\n其中，$\\mu$ 为实际输出的牵引加速度与最大加速度的百分比，$F_{max}$ 为牵引力最大值（kN）。\n\n图3 列车牵引特征曲线示意图\n\n（2）列车运行总阻力\n\n列车总阻力是指列车与外界相互作用引起与列车运行方向相反、一般是阻碍列车运行的、不能被司机控制的外力。按其形成原因可分为基本阻力和附加阻力。\n\n1）基本阻力\n\n列车的基本阻力是列车在空旷地段沿平、直轨道运行时所受到的阻力。该阻力是由于机械摩擦，空气摩擦等因素作用而产生的固有阻力。具体可分为以下五部分：1、车轴轴承间摩擦阻力；2、轮轨间滚动摩擦阻力；3、轮轨间滑动摩擦阻力；4、冲击阻力；5气动阻力。因此，基本阻力与许多因素有关，它主要取决于机车、车辆结构和技术状态、轴重、以及列车运行速度等，同时又受线路情况、气候条件影响。由于这些因素极为复杂，而且相互影响，实际应用中很难用理论公式进行准确计算，通常采用以下经验公式进行计算：\n\n\\begin{equation}\nw_0 = A + Bv + Cv^2\n\\end{equation}\n\n其中 $w_0$ 为单位基本阻力（N/kN），$A$、$B$、$C$ 为阻力多项式系数，通常取经验值，$v$ 为列车速度（km/h）。\n\n2）附加阻力\n\n列车由于在附加条件下（通过坡道、曲线、隧道）运行所增加的阻力叫做附加阻力。附加阻力主要考虑坡道附加阻力和曲线附加阻力。\n\n\\[ w_1 = w_i + w_c \\]\n\n列车的坡道附加阻力是列车上下坡时重力在列车运行方向上的一个分力。通常采用如下公式计算\n\n\\[ w_i = i \\]\n\n其中 $w_i$ 为单位坡道阻力系数（N/kN），$i$ 为线路坡度（‰）。$i$ 为正表示上坡，$i$ 为负表示下坡。\n\n列车的曲线阻力主要源自取决于轨道线路的曲率半径，列车在曲线上运行时，轮轨间纵向和横向的滑动摩擦力增加，转向架等各部分摩擦力也有所增加。通常采用如下公式计算：\n\n\\[ w_c = c / R \\]\n\n其中 $w_c$ 为单位曲线阻力系数（N/kN），$R$ 为曲率半径（m）；$c$ 为综合反映影响曲线阻力许多因素的经验常数，我国轨道交通一般取 600。\n\n有时为了计算方便，当坡道附加阻力、曲线附加阻力同时出现时，根据阻力值相等的原则，把列车通过曲线时所产生的附加阻力折算为坡道阻力，加上线路实际坡度即为加算坡度。\n\n综上，列车运行总阻力可按照如下公式计算：\n\n\\[ W = (w_0 + w_1) \\times g \\times M / 1000 \\]\n\n其中，$W$ 为线路阻力（N），$w_0$ 为单位基本阻力系数（N/kN），$w_1$ 为单位附加阻力系数（N/kN），$M$ 为列车质量（kg），$g$ 为重力加速度常数。\n\n\\section*{(3) 列车制动力 $B$}\n\n制动力 $B$ 是由制动装置引起的、与列车运行方向相反的、司机可根据需要控制其大小的外力。制动力 $B$ 存在与制动时列车速度有关的最大值，$B_{max} = f_B(v)$，当然制动力也可以小于 $B_{max}$。具体数据参见附件。列车实际输出制动力（kN）基于以下公式进行计算\n\n\\[ B = \\mu B_{max} \\]\n\n其中，$\\mu$ 为实际输出的制动加速度与最大加速度的百分比，$B_{max}$ 为制动力最大值（kN）。\n\n3. 运行时间与运行能耗的关系\n\n当列车在站间运行时，存在着多条速度距离曲线供选择。不同速度距离曲线对应不同的站间运行时间和不同的能耗。列车按照图 4 所示 4 条曲线可以走完相同的距离，但运行时间和能耗并不相同。此外，即便站间运行时间相同时，也存在多条速度距离曲线可供列车选择。此外，即便站间运行时间相同时，也存在多条速度距离曲线可供列车选择。\n\n\n图4 列车站间运行速度距离曲线\n\n一般认为，列车站间运行时间和能耗存在近似图5中的反比关系，比较准确的定量关系应根据前面的公式计算。注意，增加相同的运行时间不一定会减少等量的能耗。列车站间运行时间与能耗变化的趋势影响能耗的减少。\n\n\n图5 站间运行时间与能耗关系。\n\n\n图6 再生能量利用示意图\n\n\n\n4 再生能量利用原理\n\n随着制动技术的进步，目前城市轨道交通普遍采用再生制动。再生制动时，牵引电动机转变为发电机工况，将列车运行的动能转换为电能，发电机产生的制动力使列车减速，此时列车向接触网反馈电能，此部分能量即为再生制动能。如图6所示，列车 \\(i+1\\) 在制动时会产生能量 \\(E_{\\text{reg}}\\)，如果相邻列车 \\(i\\) 处于加速状态，其可以利用 \\(E_{\\text{reg}}\\)，从而减少从变电站获得的能量，达到节能的目的。如果列车 \\(i+1\\) 制动时，其所处供电区段内没有其他列车加速，其产生的再生能量除用于本列车空调、照明等设备外，通常被吸收电阻转化为热能消耗掉。\n\n\\textbf{假设：}\n\n\\textbf{产生的再生能量}\n\\[\nE_{\\text{reg}} = (E_{\\text{mech}} - E_{\\text{f}}) \\cdot 95\\%\n\\]\n其中 \\(E_{\\text{mech}}\\) 是制动过程中列车机械能的变化量，\\(E_{\\text{f}}\\) 是制动过程中为克服基本阻力和附加阻力所做功。\n\n被利用了的再生能量可按照以下假设的公式计算\n\\[\nE_{\\text{used}} = E_{\\text{reg}} \\cdot t_{\\text{overlap}} / t_{\\text{brake}}\n\\]\n其中 \\(t_{\\text{overlap}}\\) 是列车 \\(i+1\\) 制动的时间与列车 \\(i\\) 加速时间的重叠时间，\\(t_{\\text{brake}}\\) 是列车 \\(i+1\\) 的制动时间。即制动时所产生的再生能量与制动时间成正比。\n\n问题要求：\n请研究以下问题：\n\n单列车节能运行优化控制问题\n\n(1) 请建立计算速度距离曲线的数学模型，计算寻找一条列车从 \\(A_6\\) 站出发到达 \\(A_7\\) 站的最节能运行的速度距离曲线，其中两车站间的运行时间为 110 秒，列车参数和线路参数详见文件“列车参数.xlsx”和“线路参数.xlsx”。\n\n(2) 请建立新的计算速度距离曲线的数学模型，计算寻找一条列车从 \\(A_6\\) 站出发到达 \\(A_8\\) 站的最节能运行的速度距离曲线，其中要求列车在 \\(A_7\\) 车站停站 45 秒，\\(A_6\\) 站和 \\(A_8\\) 站间总运行时间规定为 220 秒（不包括停站时间），列车参数和线路参数详见文件“列车参数.xlsx”和“线路参数.xlsx”。\n\n注：请将本问（1）和（2）得到的曲线数据按每秒钟一行填写到文件“数据格式.xlsx”中红色表头那几列，并将该文件和论文一并提交。（请只填写和修改数据，一定不要修改文件“数据格式.xlsx”的格式。其中计算公里标（m）是到起点的距离，计算距离（m）是到刚通过的一站的距离）\n\n\\textbf{二、多列车节能运行优化控制问题}\n\n(1) 当 100 列列车以间隔 \\(H = \\{h_1, \\ldots, h_{99}\\}\\) 从 \\(A_1\\) 站出发，追踪运行，依次经过 \\(A_2\\)，\\(A_3\\)，……到达 \\(A_{14}\\) 站，中间在各个车站停站最少 \\(D_{\\text{min}}\\) 秒，最多 \\(D_{\\text{max}}\\) 秒。间隔 \\(H\\) 各分量的变化范围是 \\(H_{\\text{min}}\\) 秒至 \\(H_{\\text{max}}\\) 秒。请建立优化模型并寻找使所有列车运行总能耗最低的间隔 \\(H\\)。要求第一列列车发车时间和最后一列列车的发车时间之间间隔为 \\(T_0 = 63900\\) 秒，且从 \\(A_1\\) 站到 \\(A_{14}\\) 站的总运行时间不变，均为 2086s（包括停站时间）。假设所有列车处于同一供电区段，各个车站间线路参数详见文件“列车参数.xlsx”和“线路参数.xlsx”。\n\n补充说明：列车追踪运行时，为保证安全，跟踪列车（后车）速度不能超过限制速度 \\(V_{\\text{limit}}\\)，以免后车无法及时制动停车，发生追尾事故。其计算方式可简化如下：\n\\[\nV_{\\text{limit}} = \\min(V_{\\text{line}}, \\sqrt{2LB_e})\n\\]\n其中 \\(V_{\\text{line}}\\) 是列车当前位置的线路限速（km/h），\\(L\\) 是当前时刻前后车之间的距离。\\begin{enumerate}\n    \\item[(2)] 接上问，如果高峰时间（早高峰 7200 秒至 12600 秒，晚高峰 43200 至 50400 秒）发车间隔不大于 2.5 分钟且不小于 2 分钟，其余时间发车间隔不小于 5 分钟，每天 240 列。请重新为它们制定运行图和相应的速度距离曲线。\n\\end{enumerate}\n\n三、列车延误后运行优化控制问题\n\n接上问，若列车 $i$ 在车站 $A_j$ 延误 $DT_j^i$（10 秒）发车，请建立控制模型，找出在确保安全的前提下，首先使所有后续列车尽快恢复正点运行，其次恢复期间耗能最少的列车运行曲线。\n\n假设 $DT_j^i$ 为随机变量，普通延误（$0 < DT_j^i < 10s$）概率为 20%，严重延误（$DT_j^i > 10s$）概率为 10%（超过 120s，接近下一班，不考虑调整），无延误（$DT_j^i = 0$）概率为 70%。若允许列车在各站到、发时间与原时间相比提前不超过 10 秒，根据上述统计数据，如何对第二问的控制方案进行调整？\nAddendum: \n参考文献：\n\n[1] P. Howllet, An Optimal Strategy for the Control of A Train, Journal of the Australian Mathematical Society. Series B. Applied Mathematics, Volume 31, Issue 04, April 1990, pp. 454-471.\n\n[2] 丁勇，毛保华，刘海东，张鑫，王铁城，列车节能运行模拟系统的研究，北京交通大学\n学报，第28卷第2期，第76-81页\n\n[3] 金炜东，靳蕃，李崇维，胡飞，苟先太，列车优化操纵速度模式曲线生成的智能计算研究，铁道学报，第20卷，第5期，第47-52页.\n\n[4] E. Khmelnitsky, On an optimal control problem of train operation, IEEE Transactions on Automatic Control, Volume 45, Issue 7, pp. 1257 – 1266.\n\n[5] Rongfang (Rachel) Liu, Lakov M. Golovitcher, Energy-efficient operation of rail vehicles, Transportation Research Part A: Policy and Practice, Volume 37, Issue 10, pp. 917-932.\n\n[6] Su S, Tang T, Li X, et al. Optimization of multitrain operations in a subway system[J]. Intelligent Transportation Systems, IEEE Transactions on, 2014, 15(2): 673-684.\n\n[7] Albrecht T, Oettich S. A new integrated approach to dynamic schedule synchronization and energy-saving train control[J]. Publication of: WIT Press, 2002.\nDataset Path:\n['列车参数.docx', '线路参数.xlsx', '输入数据模板.xlsx']\n\nData Description:\n该数据集由三部分文件组成：列车参数.docx、线路参数.xlsx和输入数据模板.xlsx，整体用于列车节能运行优化与速度—距离曲线计算。列车参数文件包含列车的基本物理参数及牵引/制动特性曲线（包括最大牵引力与最大制动力等关键性能指标），用于在不同速度下计算牵引力、制动力与功率输出；线路参数表覆盖从A1站到A14站的线路要素，按区段给出公里标（单位m）、起止公里标、坡度（‰）、分段限速（km/h）与曲线半径（m）等地形与约束信息；输入数据模板聚焦于A6至A7及A8区间的节能运行优化问题，包含列车运行的基础输入与数值样本，便于生成和验证速度—距离曲线与运行仿真。数据字段包括车站名称、发车时刻与时刻记录（hh:mm:ss）、站间实际长度（m）、停站时间与运行时间（s）、满载率（%）、目标距离与计算距离/公里标（m）、目标速度/实际速度与EBI限制速度（以cm/s和km/h两种单位）、基于速度的计算加速度（m/s²）、网压（V）和网流（A）、ATO与PID相关输出（如ATO输出电流、PID期望输出加速度百分比）、以及由控制输出推导的计算牵引力（N）、牵引功率和辅助功率（kW）等。总体上该数据集提供了涵盖线路约束、列车动力学特性与详细运行/控制量测的完整信息集合，适用于能耗评估、运行时刻与速度曲线优化、ATO控制策略验证以及列车动力学与能量仿真分析，所有数值字段均标注了物理单位以保证可直接用于建模与计算。"
  },
  "problem_background": "轨道交通系统的能耗是指列车牵引、通风空调、电梯、照明、给排水、弱电等设备产生的能耗。根据统计数据，列车牵引能耗占轨道交通系统总能耗40%以上。在低碳环保、节能减排日益受到关注的情况下，针对减少列车牵引能耗的列车运行优化控制近年来成为轨道交通领域的重要研究方向。\n\n1. 列车运行过程\n\n列车在站间运行时会根据线路条件、自身列车特性、前方线路状况计算出一个限制速度。列车运行过程中不允许超过此限制速度。限制速度会周期性更新。在限制速度的约束下列车通常包含四种运行工况：牵引、巡航、惰行和制动。\n\n牵引阶段：列车加速，发动机处于耗能状态。\n\n巡航阶段：列车匀速，列车所受合力为0，列车是需要牵引还是需要制动取决于列车当时受到的总阻力。\n\n惰行阶段：列车既不牵引也不制动，列车运行状态取决于受到的列车总阻力，发动机不耗能。\n\n制动阶段：列车减速，发动机不耗能。如果列车采用再生制动技术，此时可以将动能转换为电能反馈回供电系统供其他用电设备使用，例如其他正在牵引的列车或者本列车的空调等（本列车空调的耗能较小，通常忽略不计）。\n\n如果车站间距离较短，列车一般采用“牵引-惰行-制动”的策略运行。如果站间距离较长，列车通常会采用牵引到接近限制速度后，交替使用惰行、巡航、牵引三种工况，直至接近下一车站采用制动进站停车。\n\n\n图 1 列车站间运行曲线\n\n\n列车在运行过程中，实际受力状态非常复杂。采用单质点模型是一种常见的简化方法。单质点模型将列车视为单质点，列车运动符合牛顿运动学定律。其受力可分为四类：重力$G$在轨道垂直方向上的分力与受到轨道的托力抵消，列车牵引力$F$，列车制动力$B$和列车运行总阻力$W$。\n\n\n图2 单质点列车受力分析示意图\n\n（1）列车牵引力\n\n列车牵引力 $F$ 是由动力传动装置产生的、与列车运行方向相同、驱动列车运行并可由司机根据需要调节的外力。牵引力 $F$ 在不同速度下存在不同的最大值 $F_{max} = f_F(v)$，具体数据参见附件。列车实际输出牵引力（kN）基于以下公式进行计算。\n\n\\begin{equation}\nF = \\mu F_{max}\n\\end{equation}\n\n其中，$\\mu$ 为实际输出的牵引加速度与最大加速度的百分比，$F_{max}$ 为牵引力最大值（kN）。\n\n图3 列车牵引特征曲线示意图\n\n（2）列车运行总阻力\n\n列车总阻力是指列车与外界相互作用引起与列车运行方向相反、一般是阻碍列车运行的、不能被司机控制的外力。按其形成原因可分为基本阻力和附加阻力。\n\n1）基本阻力\n\n列车的基本阻力是列车在空旷地段沿平、直轨道运行时所受到的阻力。该阻力是由于机械摩擦，空气摩擦等因素作用而产生的固有阻力。具体可分为以下五部分：1、车轴轴承间摩擦阻力；2、轮轨间滚动摩擦阻力；3、轮轨间滑动摩擦阻力；4、冲击阻力；5气动阻力。因此，基本阻力与许多因素有关，它主要取决于机车、车辆结构和技术状态、轴重、以及列车运行速度等，同时又受线路情况、气候条件影响。由于这些因素极为复杂，而且相互影响，实际应用中很难用理论公式进行准确计算，通常采用以下经验公式进行计算：\n\n\\begin{equation}\nw_0 = A + Bv + Cv^2\n\\end{equation}\n\n其中 $w_0$ 为单位基本阻力（N/kN），$A$、$B$、$C$ 为阻力多项式系数，通常取经验值，$v$ 为列车速度（km/h）。\n\n2）附加阻力\n\n列车由于在附加条件下（通过坡道、曲线、隧道）运行所增加的阻力叫做附加阻力。附加阻力主要考虑坡道附加阻力和曲线附加阻力。\n\n\\[ w_1 = w_i + w_c \\]\n\n列车的坡道附加阻力是列车上下坡时重力在列车运行方向上的一个分力。通常采用如下公式计算\n\n\\[ w_i = i \\]\n\n其中 $w_i$ 为单位坡道阻力系数（N/kN），$i$ 为线路坡度（‰）。$i$ 为正表示上坡，$i$ 为负表示下坡。\n\n列车的曲线阻力主要源自取决于轨道线路的曲率半径，列车在曲线上运行时，轮轨间纵向和横向的滑动摩擦力增加，转向架等各部分摩擦力也有所增加。通常采用如下公式计算：\n\n\\[ w_c = c / R \\]\n\n其中 $w_c$ 为单位曲线阻力系数（N/kN），$R$ 为曲率半径（m）；$c$ 为综合反映影响曲线阻力许多因素的经验常数，我国轨道交通一般取 600。\n\n有时为了计算方便，当坡道附加阻力、曲线附加阻力同时出现时，根据阻力值相等的原则，把列车通过曲线时所产生的附加阻力折算为坡道阻力，加上线路实际坡度即为加算坡度。\n\n综上，列车运行总阻力可按照如下公式计算：\n\n\\[ W = (w_0 + w_1) \\times g \\times M / 1000 \\]\n\n其中，$W$ 为线路阻力（N），$w_0$ 为单位基本阻力系数（N/kN），$w_1$ 为单位附加阻力系数（N/kN），$M$ 为列车质量（kg），$g$ 为重力加速度常数。\n\n\\section*{(3) 列车制动力 $B$}\n\n制动力 $B$ 是由制动装置引起的、与列车运行方向相反的、司机可根据需要控制其大小的外力。制动力 $B$ 存在与制动时列车速度有关的最大值，$B_{max} = f_B(v)$，当然制动力也可以小于 $B_{max}$。具体数据参见附件。列车实际输出制动力（kN）基于以下公式进行计算\n\n\\[ B = \\mu B_{max} \\]\n\n其中，$\\mu$ 为实际输出的制动加速度与最大加速度的百分比，$B_{max}$ 为制动力最大值（kN）。\n\n3. 运行时间与运行能耗的关系\n\n当列车在站间运行时，存在着多条速度距离曲线供选择。不同速度距离曲线对应不同的站间运行时间和不同的能耗。列车按照图 4 所示 4 条曲线可以走完相同的距离，但运行时间和能耗并不相同。此外，即便站间运行时间相同时，也存在多条速度距离曲线可供列车选择。此外，即便站间运行时间相同时，也存在多条速度距离曲线可供列车选择。\n\n\n图4 列车站间运行速度距离曲线\n\n一般认为，列车站间运行时间和能耗存在近似图5中的反比关系，比较准确的定量关系应根据前面的公式计算。注意，增加相同的运行时间不一定会减少等量的能耗。列车站间运行时间与能耗变化的趋势影响能耗的减少。\n\n\n图5 站间运行时间与能耗关系。\n\n\n图6 再生能量利用示意图\n\n\n\n4 再生能量利用原理\n\n随着制动技术的进步，目前城市轨道交通普遍采用再生制动。再生制动时，牵引电动机转变为发电机工况，将列车运行的动能转换为电能，发电机产生的制动力使列车减速，此时列车向接触网反馈电能，此部分能量即为再生制动能。如图6所示，列车 \\(i+1\\) 在制动时会产生能量 \\(E_{\\text{reg}}\\)，如果相邻列车 \\(i\\) 处于加速状态，其可以利用 \\(E_{\\text{reg}}\\)，从而减少从变电站获得的能量，达到节能的目的。如果列车 \\(i+1\\) 制动时，其所处供电区段内没有其他列车加速，其产生的再生能量除用于本列车空调、照明等设备外，通常被吸收电阻转化为热能消耗掉。\n\n\\textbf{假设：}\n\n\\textbf{产生的再生能量}\n\\[\nE_{\\text{reg}} = (E_{\\text{mech}} - E_{\\text{f}}) \\cdot 95\\%\n\\]\n其中 \\(E_{\\text{mech}}\\) 是制动过程中列车机械能的变化量，\\(E_{\\text{f}}\\) 是制动过程中为克服基本阻力和附加阻力所做功。\n\n被利用了的再生能量可按照以下假设的公式计算\n\\[\nE_{\\text{used}} = E_{\\text{reg}} \\cdot t_{\\text{overlap}} / t_{\\text{brake}}\n\\]\n其中 \\(t_{\\text{overlap}}\\) 是列车 \\(i+1\\) 制动的时间与列车 \\(i\\) 加速时间的重叠时间，\\(t_{\\text{brake}}\\) 是列车 \\(i+1\\) 的制动时间。即制动时所产生的再生能量与制动时间成正比。",
  "problem_requirement": "请研究以下问题：\n\n单列车节能运行优化控制问题\n\n(1) 请建立计算速度距离曲线的数学模型，计算寻找一条列车从 \\(A_6\\) 站出发到达 \\(A_7\\) 站的最节能运行的速度距离曲线，其中两车站间的运行时间为 110 秒，列车参数和线路参数详见文件“列车参数.xlsx”和“线路参数.xlsx”。\n\n(2) 请建立新的计算速度距离曲线的数学模型，计算寻找一条列车从 \\(A_6\\) 站出发到达 \\(A_8\\) 站的最节能运行的速度距离曲线，其中要求列车在 \\(A_7\\) 车站停站 45 秒，\\(A_6\\) 站和 \\(A_8\\) 站间总运行时间规定为 220 秒（不包括停站时间），列车参数和线路参数详见文件“列车参数.xlsx”和“线路参数.xlsx”。\n\n注：请将本问（1）和（2）得到的曲线数据按每秒钟一行填写到文件“数据格式.xlsx”中红色表头那几列，并将该文件和论文一并提交。（请只填写和修改数据，一定不要修改文件“数据格式.xlsx”的格式。其中计算公里标（m）是到起点的距离，计算距离（m）是到刚通过的一站的距离）\n\n\\textbf{二、多列车节能运行优化控制问题}\n\n(1) 当 100 列列车以间隔 \\(H = \\{h_1, \\ldots, h_{99}\\}\\) 从 \\(A_1\\) 站出发，追踪运行，依次经过 \\(A_2\\)，\\(A_3\\)，……到达 \\(A_{14}\\) 站，中间在各个车站停站最少 \\(D_{\\text{min}}\\) 秒，最多 \\(D_{\\text{max}}\\) 秒。间隔 \\(H\\) 各分量的变化范围是 \\(H_{\\text{min}}\\) 秒至 \\(H_{\\text{max}}\\) 秒。请建立优化模型并寻找使所有列车运行总能耗最低的间隔 \\(H\\)。要求第一列列车发车时间和最后一列列车的发车时间之间间隔为 \\(T_0 = 63900\\) 秒，且从 \\(A_1\\) 站到 \\(A_{14}\\) 站的总运行时间不变，均为 2086s（包括停站时间）。假设所有列车处于同一供电区段，各个车站间线路参数详见文件“列车参数.xlsx”和“线路参数.xlsx”。\n\n补充说明：列车追踪运行时，为保证安全，跟踪列车（后车）速度不能超过限制速度 \\(V_{\\text{limit}}\\)，以免后车无法及时制动停车，发生追尾事故。其计算方式可简化如下：\n\\[\nV_{\\text{limit}} = \\min(V_{\\text{line}}, \\sqrt{2LB_e})\n\\]\n其中 \\(V_{\\text{line}}\\) 是列车当前位置的线路限速（km/h），\\(L\\) 是当前时刻前后车之间的距离。\\begin{enumerate}\n    \\item[(2)] 接上问，如果高峰时间（早高峰 7200 秒至 12600 秒，晚高峰 43200 至 50400 秒）发车间隔不大于 2.5 分钟且不小于 2 分钟，其余时间发车间隔不小于 5 分钟，每天 240 列。请重新为它们制定运行图和相应的速度距离曲线。\n\\end{enumerate}\n\n三、列车延误后运行优化控制问题\n\n接上问，若列车 $i$ 在车站 $A_j$ 延误 $DT_j^i$（10 秒）发车，请建立控制模型，找出在确保安全的前提下，首先使所有后续列车尽快恢复正点运行，其次恢复期间耗能最少的列车运行曲线。\n\n假设 $DT_j^i$ 为随机变量，普通延误（$0 < DT_j^i < 10s$）概率为 20%，严重延误（$DT_j^i > 10s$）概率为 10%（超过 120s，接近下一班，不考虑调整），无延误（$DT_j^i = 0$）概率为 70%。若允许列车在各站到、发时间与原时间相比提前不超过 10 秒，根据上述统计数据，如何对第二问的控制方案进行调整？",
  "problem_analysis": "总体上，这类轨道列车节能运行优化问题属于受约束的非线性最优控制与大规模调度优化的交叉问题，其核心目标可以分为两个层面：运动学／动力学层面的能耗最小化（给定单列车的起止条件与时间约束，寻找速度—距离曲线或控制策略使得净供电能量最小）以及调度层面的能耗最小化（通过调整列车发车间隔、站停时刻和速度策略，在多列列车同时分享同一供电区段时最大化再生能量利用并降低总体网侧能量）。这两个目标共同塑造了建模思路：必须把列车的动力学方程（质点模型；状态变量至少为位置和速度）、牵引与制动控制输入（受速度相关的最大牵引/制动力限制约束）、速度限幅（线路分段限速与追踪安全限速）、阻力模型（基本阻力 w0 = A + B v + C v^2、曲线与坡道附加阻力转换规则）以及能量流（牵引功率消耗、再生能量产生与被利用比例）耦合起来，形成一个既有动力约束又有时间/调度约束的非线性规划或最优控制问题。问题描述中已有的多条显性假设（单质点、阻力用经验多项式、牵引/制动力按速度给出最大值并可用百分比调节、再生能量按制动机械能与阻力损耗差的95%计算且按重叠时间线性分配）直接决定了能量目标函数与约束形式，但同时这些假设也限定了模型的适用范围与解释力：例如单质点假设忽略了列车内部多体动力学、车厢间粘滞、转向架动态等，阻力多项式系数 A,B,C 与附加阻力常数 c 来自经验，容易受车辆状态、环境、载重和气候的影响；再生能量线性按重叠时间分配的简化忽略了电网阻抗、接触网电压变化、变流器效率与饱和限制以及分段电气分隔的现实，这些都会影响再生能量的实际可用性。因此在建模和结果解释时必须明示这些不确定性边界，并在实用化前做离线或现场标定与敏感性分析。\n\n在单列车最优运行问题的更细化逻辑中，关键的相互依赖是动力学方程（列车质量 M，速度 v，作用力为牵引 F 减去制动 B 减去阻力 W(v,pos)）与能量消耗表达式之间的耦合。给定固定运行时间的约束后，速度剖面的可行集由初末速度（通常站停时为零）、速度限幅以及牵引/制动能力界定，优化目标为净供电能量最小化：这通常等价于最小化牵引阶段从变电站吸取的能量（牵引功率的时间积分）减去可被其他列车或网侧吸收的再生能量。数学上可用带时间等式约束（轨迹积分给定总位移等于站间距离、给定总时间）的一类最优控制问题来刻画；解析上这类问题常表现为“推—巡—惰—制”若干阶段的切换（bang-bang 或分段常值控制的结构），在固定时间限制下最优解往往包含牵引到某速度然后惰行/巡航交替以满足能耗与时间配比，或者在时间紧张时出现较长的巡航或高速牵引以满足时间约束但增加能耗。求解策略可以分两类：间接法（如庞特里亚金最小值原理求解共轭系统并判断切换结构）与直接法（时域离散化转为非线性规划，变量为每个时间步的速度和控制输入，使用 IPOPT/KNITRO 等求解器），由于存在对控件的非光滑限制（最大牵引/制动曲线）和再生能量的非线性表达，直接法结合合适的初始猜测（基于启发式控制剖面）通常更稳健。离散化时要注意题目要求按每秒输出速度—距离曲线，这暗示基本时间步长选 1 s（或更细以提高精度再在后处理中每秒采样）。能量计算中牵引功率取 F*v，当制动为机械制动时不计能量回收；在再生制动时按题设 E_reg = 0.95*(机械能变化 - 抵抗作功) 计算但仅按重叠时间比例被邻列或网吸收，若无吸收则视为热耗散，这使得多列运行时的时序非常重要——通过调整出发间隔或速度曲线以增加制动与加速阶段的时间重叠是多列节能优化的核心机理之一，但这一机理同时受到安全约束（以最小制动距离或题中给出的安全限速 V_limit = min(V_line, sqrt(2 L B_e)) 为代理）和电气分区、变电站承受能力、并网电压稳定性的限制。\n\n在多列车问题中，变量规模和耦合程度急剧增加。调度变量（发车间隔向量 H、各站停站时间在 [D_min,D_max] 范围内）通过改变列车到发时间直接影响速度剖面能否实现再生/牵引重叠，从而影响网侧净能量。约束还要求第一列与最后一列的发车时间总跨度固定 T0、每列总耗时固定 2086 s（含停站），以及安全追踪约束限制后车速度。这实际上是一个大规模约束优化问题，带有离散（若将停站时间或间隔离散化）或连续变量、非线性动力学和非凸目标（因为再生能量利用为非线性且与时序重叠有关）。可行的解决思路包括分解策略和启发式或混合全局局部方法：先设计一个满足安全与全局时序约束的基线时刻表（例如均匀时距并留足电能交换窗口），然后以该时刻表为初值用梯度或SQP进行局部改进；或者将问题转化为较粗粒度的混合整数非线性编程（MINLP）并用元启发式算法（遗传算法、粒子群、模拟退火）搜索头数分配与停站策略，再用连续最优控制器在各列内部生成速度曲线。重要的是在目标函数中准确表达电网层面的能量耦合：对任意时刻将所有列牵引功率之和与再生功率之和叠加计算网侧即时净功率，积分得到网侧能量消耗；这样可以直接反映再生能量被邻列消耗或被电阻吸收的效果，但要注意并网能力的上限与能量的时间尺度（瞬时功率平衡比单纯按时间重叠比例更物理）。计算复杂性与可扩展性要求在算法设计中做出权衡：若精确建模电力流并求解全网瞬时功率平衡代价巨大，可采用题中给定的线性重叠近似作为代理，但必须在报告中说明这一近似的局限并对结果做敏感性分析。\n\n关于延误与随机扰动，问题引入了概率性的延误模型（无延误 70%、普通延误 <10s 20%、严重延误 >10s 10%），并允许各站提前不超过 10s 的弹性。这里的优化目标在保证安全的前提下首要恢复实时正点（即最小化后续列的滞后时间或最大滞后值），其次在恢复过程中尽量减少能耗。这自然导向分层或序贯决策框架：第一层采用以迟延恢复为目标的调度调整（例如最小化加权延误、最大化时刻表可行性），第二层在新的时刻约束下求解能量最优速度剖面。在线实时控制上，模型预测控制（MPC）或滚动时域优化是合适的工具：以受扰动列车为触发器，向后影响若干列车，建立一个包含安全间隔和速度限制的短时窗口优化问题，目标先约束延误恢复（例如优先限制滞后时间或惩罚最大延误），在满足该目标的可行域内再最小化网侧能耗或牵引能耗的期望值。对于随机性，可采用情景化稳健优化或机会约束，亦即用样本或分布模拟多种延误场景并优化期望目标或置信下界（如 CVaR），从而在概率意义上保证服务水准与能耗表现。需要强调的是，允许列车提前最多 10s 为一种资源，可被用来吸收后续的普通延误；在控制策略上应优先考虑通过改变速度曲线（更多惰行与减小牵引）来调整到发时间而非通过加大道站内加速以牺牲能效换取时间。\n\n在建模选择与不确定性权衡方面，需明确若干关键点：首先牵引/制动力曲线、阻力系数、再生效率、列车质量与满载率等参数的误差会直接影响能耗估计与最优控制结构，因此必须进行参数标定并做敏感性分析；其次电气网络的简化（以重叠时间比率代理再生利用）虽然计算简单但可能高估再生收益，特别是在长列车队列、分区隔离或变电站饱和情况下，建议对典型运行工况用更精细的电气模型做后验验证；再次乘客舒适性（加速度、减速度限制）与站间时间的业务约束需要被硬性纳入约束集合，否则最优解可能在现实中不可接受。方法论上应当采用迭代式开发：先以简化模型（单列、固定参数）开发和验证数值求解器与基线策略，再逐步加入多列耦合、电网功率约束与随机扰动，最后用历史运行数据或现场试验数据调整模型并评估实际节能潜力与服务影响。\n\n在可操作的技术路线层面，建议步骤为：一、建立时间离散的动力学约束（位置与速度状态方程，时间步长 1s 或更细），牵引/制动输入受速度依赖的 Fmax(v), Bmax(v) 约束，阻力由 w0(v) 与 w1(pos) 组成；二、定义能量目标为网侧净能量（牵引正功率积分减去可吸收的再生功率），在单列问题中把再生利用率按题设重叠公式简化；三、对单列问题采用直接离散化转 NLP 求解或用基于动态规划的离散最优控制（若状态空间较小）；四、对多列问题采用两阶段解法——先解时刻表与停车策略的中粗粒度优化（混合启发式或连续优化），再对每列做局部速度剖面优化；并在多列耦合时用简单的电能平衡近似或更精确的瞬时功率叠加法计算再生利用；五、对于延误恢复问题，采用滚动 MPC 搭配优先级（首先恢复准点率，再在余地内最小化能耗），并用场景化或机会约束方法处理随机延误。计算实现上优先使用成熟的非线性优化器（IPOPT, KNITRO），并对大规模多列问题采用并行化或启发式搜索以保证可行的运行时。\n\n最后要强调模型与结论的不确定性与可拓展性：本题给定的公式与参数允许在学术或技术竞赛中得到清晰且可比较的数值结果，但实际工程应用需对牵引系统的实际电气特性、接触网/变电站容量、列车间电磁耦合、环境依赖的阻力变化以及乘客流量引起的载重波动做更精细建模，并应把能源节约目标与旅客服务指标（旅程时间、舒适度、准点率）放在一个多目标框架中权衡。建模过程应保持迭代性：随着现场数据获取与对电网耦合影响的更好理解，及时修正能量利用模型与控制策略，以保证理论最优在现实中具有可实现性与可持续性。",
  "modeling_solution": "总体建模思路与基本假设。为兼顾物理准确性与可解性，本方案将列车视作单质点、以时间离散的最优控制/调度框架建模，时间步长建议取1 s以满足题目输出精度（并可在数值求解时按更细步长运行随后每秒采样）。主要物理关系采用题目给定的阻力、多项式模型和牵引/制动特性曲线，并在电能回收上使用更接近瞬时能量平衡的近似：在任一时刻，制动产生的再生功率可被同时处于牵引（加速）状态的列车即时吸收，吸收量为两者功率之最小值，其余再生功率视为热耗（或被电阻吸收）。为使问题可计算且仍保留关键耦合特性，做如下明确化与简化假设：重力在纵向的坡道分量、阻力模型与题目给定公式完全采用；牵引/制动能量按力乘速度计算（P = F · v），牵引力与制动力受速度相关最大值约束 F ≤ Fmax(v), B ≤ Bmax(v)；不同时刻不允许同时施加牵引与制动（可以用二元开关或在连续松弛中强加互斥约束）；再生效率用题目给出 95% 的比例对机械能与阻力做差后计算，但在多车情况下以瞬时功率匹配原则替代题目中的全程重叠线性分配，以更真实反映能量的瞬时交换；轨道供电区段被视为单一电网（题中设定），瞬时网侧能量等于所有牵引功率之和减去被同时消纳的再生功率之和（若为负则视为被电阻吸收，不返回电网）。速度限幅由线路限速与安全追踪限速共同决定，后者用题中近似表达 V_limit = min(V_line, sqrt(2 L B_e))，并以该限速约束后车即时速度。乘客舒适性通过对加速度、减速度的上下限约束体现（加速与制动采样于牵引/制动百分比 μ 范围并转换为加速度），站内到发时间允许提前最多 10 s 作为缓冲量（在延误恢复问题中使用）。所有参数（牵引/制动曲线、A/B/C 阻力系数、列车质量、线段坡度与曲线半径等）来自给定文件并在模型初始化时读取与校准。\n\n状态变量、控制变量与主要方程。状态变量为列车位置 x(t)（到网络起点的公里标）、站间距离到上一个站的局部距离 s(t) 以及速度 v(t)。动力学主方程为牛顿第二定律，连续形式写作 M dv/dt = F(t) - B(t) - W(v,x)，dx/dt = v。总阻力 W(v,x) 按题目给出 W = (w0(v) + w1(x)) · g · M / 1000，其中 w0(v) = A + B_v v + C v^2（注意题目 v 的单位为 km/h，求解时统一单位换算为 m/s 或对多项式系数适当调整），坡道和曲线附加阻力 w1 根据线路坡度 i（‰）和曲线半径 R 计算：w_i = i，w_c = c/R（c≈600），两者按“等值”规则折算为加算坡道。牵引力与制动力按 F = μ_F Fmax(v), B = μ_B Bmax(v)，其中 μ_F, μ_B ∈ [0,1] 且μ_F · μ_B = 0（互斥）。瞬时牵引功率 P_trac(t) = max(F(t),0) · v(t)，瞬时制动产生的机械制动功率 P_brake_mech(t) = max(B(t),0) · v(t)。制动过程中产生的理论可回收功率应来源于机械能减去在制动过程中克服阻力所做的功，按题中假设其能量表达为 E_reg = 0.95 · (ΔE_mech - E_f)（离散化为时间积分形式）；在离散的每一时刻更为直接且物理一致的表述为：即时制动发电功率 P_regen_max(t) = η_reg · B(t) · v(t)（η_reg≈0.95，且仅在制动时存在），同时必须减去在制动阶段为克服阻力所做功率比例（即不能全部转换为可用再生电能）；为简化实现可用以下等价近似：将 P_regen_max(t) 替换为 η_reg · (B(t) · v(t) - W(v,x) · v(t)·I_down) 的非负部分，其中 I_down 指制动时机械能净释放项的指示（仅当整体机械能在减少时取1），或在时间积分上使用题中 E_reg 公式。多车能量耦合采用瞬时耦合原则：在时刻 t，所有列车的加速牵引功率总和 P_accel(t) = Σ_i max(F_i(t)·v_i(t),0)，所有列车的制动可提供功率总和 P_regen(t) = Σ_i max(η_reg·B_i(t)·v_i(t) - loss,0)；实际被吸收的再生功率 P_used(t) = min(P_accel(t), P_regen(t))。网侧即时需量 P_grid(t) = P_accel(t) - P_used(t)，网侧能耗为时间积分 ∫ P_grid(t) dt（负值按零或按热耗处理）。安全追踪约束由位置差 L_ij(t) = x_{i-1}(t) - x_i(t) 决定，后车速度受限 v_i(t) ≤ V_limit_ij(t) = min(V_line(x_i), sqrt(2 L_ij(t) B_e))，并强制不发生碰撞： L_ij(t) ≥ L_min（可选的最小距离）。站内到发约束、边界条件（在站停时速度为0）以相应时间窗实施，单列问题的初末速度均为0，站间位移积分等于线路区段长度，且总时间等于给定运行时间（A6-A7 110 s，A6-A8 两段合计 220 s 减去 A7 停站 45 s 的约束方式详述于问题二）。\n\n优化目标与分层目标设计。对于单列车最节能运行问题（A6→A7，指定运行时间 110 s），目标是最小化网侧供电能 E_grid = ∫ max(P_trac(t) - P_regen_used(t), 0) dt。在单列情形若周围无加速列车，P_regen_used ≈ 0，目标等价于最小化牵引能量 ∫ P_trac dt，但应同时考虑再生能量回收项（若允许将部分再生返回变电站或被列车自身用作辅助负荷，则可按题目给 E_reg 表达计算并从目标中减少）。为数值可解性，采用直接法将时间区间离散为 N 步（N = T / dt），决策变量为每步的 μ_F_k, μ_B_k 或直接为 F_k, B_k 以及速度 v_k 和位置 x_k，目标为离散和 Σ_k P_grid_k · dt。对 A6→A8 含中途停站问题，速度轨迹需在到达 A7 时满足停车并停站 45 s，然后在规定总运行时间 220 s（不含停站）内到达 A8。因此在单次优化中要包含中途停站模块化的时间段划分或把整个 A6→A8 过程看作两段联立的优化问题并加以耦合（第一段 A6→A7 结束后有一段不运动的停站约束，再从停站开始优化第二段 A7→A8），总体目标仍为总网侧能耗最小化。\n\n数值求解策略。针对单列问题，推荐采用直接转化为非线性规划（NLP）的方式（直接法/时域离散化）：用欧拉或二阶精度的 RK 方法离散动力学方程，变量包括 v_k, x_k, F_k, B_k（可用 μ 代替），并加入控制互斥约束、速度上界、牵引/制动力界限以及边界条件。该 NLP 可用 CasADi + IPOPT、KNITRO 等求解器高效求解；若要捕捉分段 bang-bang 结构，可给出启发式初值（例如“牵引到某速度→惰行→巡航→制动”）以加速收敛。为处理互斥（牵引与制动不能同时为正）既可采用混合整数编程转化（每步一个二元变量），也可在连续松弛中强加大权重惩罚项逼近互斥，或采用 complementarity 约束并通过内点求解器处理。离散步长取1 s 满足输出要求，但在解算阶段可采用更细步长（如0.2 s）提高精度并在后处理时按每秒采样。\n\n大规模多列车联合优化与发车间隔问题的求解结构。由于多列耦合后问题规模与非凸性显著增加，不建议一刀切地将所有列车的连续控制变量同时并入单个 NLP。更可行且高效的策略是分层与迭代：第一层为时刻表/间隔优化，决策变量为发车间隔向量 H = {h1,...,h99} 及在各站的停站时间 D_{ij} ∈ [D_min,D_max]，目标为网侧能耗总和（由第二层仿真器计算）。第二层为基于给定时刻表的列车控制仿真器：在固定出发时刻与到发时刻约束条件下为每列生成能量近优的速度曲线（同上单列 NLP，但可并行对各列或小组列求解），并在仿真器中以逐秒步长计算即时牵引/制动功率、再生功率以及瞬时 P_used(t) = min(P_accel(t), P_regen(t))。整套框架中，第一层可用启发式全局搜索算法（遗传算法、粒子群、差分进化）或连续的约束优化器（若将 H 连续化且目标平滑）搜索间隔向量；每个候选 H 由第二层并行仿真器评估总能耗并返回目标值。该分层策略保有物理准确性且便于并行计算：第二层的并行化能够显著降低评价成本。若需要更快的评估可针对列车速度曲线应用降维表示（例如用若干关键点描述速度—距离曲线，或用基函数系数表示），并训练代理模型（如高斯过程或神经网络）近似能耗函数以在优化初期快速筛选候选时刻表，最终再对优选候选用精细仿真器验证与微调。安全约束在仿真器级别强制实施：任一时刻后车速度 v_i ≤ V_limit_{i}（计算时采用当前时刻的前车位置以估算 L），且位置差不得低于最小安全距离。\n\n应对高峰时段与全天 240 列车运力布置问题的具体方式。在题目第二部分的情形（高峰内发车间隔 2–2.5 min，其余时间≥5 min，总计 240 列），可以首先用规则化的分段时刻表作为初始解（高峰段使用均匀间隔），然后在分层框架中对允许的小幅调整（例如在高峰内对间隔做细粒度调整，同时满足第一列与最后一列发车总跨度 T0 约束）进行优化以增加加速/制动的时间重叠，从而提高再生利用。该优化同样通过第一层调整间隔并由第二层仿真器计算净能耗来实现。在高峰内由于列车密集，瞬时的再生吸收能力通常较大，因而优化收益更明显。由于列车数多、约束复杂，可采用混合方法：对整体时刻表做粗粒度连续优化以满足宏观约束，再对每一高峰段的列车簇采用局部微调（小范围的发车提前或延后）以最大化局部的能量匹配。\n\n延误恢复问题与随机性处理。对于单列或多列发生延误（题中延误分布：无延误 70%，普通延误（0,10s) 20%，严重延误 >10s 10%），采用滚动时域模型预测控制（MPC）或场景化优化：当列车 i 在站 A_j 延误 DT_j^i 时，建立一个以该列车为触发中心、向后影响若干列车（或向前若列车提前）的短期优化问题。目标分层为先保证准点恢复，即最小化受影响列车的累计时刻偏差或最大偏差（以确保旅客满意度和列车安全），其次在满足第一层软约束下最小化网侧能耗。允许列车在每站到发时间比原计划提前最多 10 s，作为恢复资源。如果问题具有随机性，可以采用情景化方法：用题中统计分布生成若干延误场景，对应的 M IP 或非线性优化在保证概率性服务水准（例如 95% 的情形下恢复在允许提前限额内）下优化期望或 CVaR 能耗/延误指标。实际在线实现时建议采用快速启发式策略作为候选（例如允许受影响的后续列车在保证安全与乘客舒适度前提下适当缩短站停时间或略微提前出发），并在后台用 MPC 每分钟重解决方案以细化速度曲线，从而在短时间内恢复列车准点性同时兼顾能耗。对于严重延误（特别是接近下一班或超120 s 的极端情况），建议采取更为保守的调度策略或直接按人工干预流程处理。\n\n数值实现细节与计算资源估计。单列 NLP 在单台普通工作站（8–16 核, 32–64 GB）上用 IPOPT/CasADi 通常能在秒到分钟级别得到高质量解（取决于离散步长与初值质量）。多列的分层全局搜索结合并行仿真评估每个候选时刻表是可扩展的：若仿真器对每列的单次速度优化可并行化（例如对 100 列分配多核或多节点），则整个候选评估时间主要受最长单列优化时间所限。为加速全局搜索，建议首先用较粗时间步长或用代理模型筛选优候选，再用精细仿真器精化。对大规模问题，亦可用基于开关点参数化的速度剖面表示（例如牵引时间、牵引到的峰速、惰行长度）把每列的控制变量维度显著降低，从而把调度问题转化为较小维度的连续优化问题。若需实时在线运行（延误恢复时），采用滚动窗口 MPC 并限制优化列数（例如只对受影响的前后5–10 列做全优化）以保证可在数十秒内给出可执行方案。\n\n敏感性分析与模型验证。在交付与论证阶段应对关键参数进行敏感性分析：牵引/制动曲线微调、阻力多项式系数 A/B/C、再生效率 η_reg（从 80% 到 98%）、线路坡度与曲线常数 c 的波动、列车质量与满载率变动都会影响最优策略的临界结构（例如是否以惰行为主或维持巡航）。建议用蒙特卡洛抽样对这些参数进行多场景仿真，量化能耗、旅程时间与准点性的分布，并识别对能耗贡献最大的参数以便现场标定。模型验证可用历史列车运行数据（若有）对阻力系数与牵引曲线做卡尔曼或最小二乘拟合，然后用独立的运行片段验证能耗预测误差和速度轨迹拟合质量。对再生能量利用的验证需结合电气测量（接触网电压与瞬时网流）以判断瞬时匹配近似的精度，并在可能条件下对瞬时功率匹配模型与题目给出的重叠时间比例模型做比较，若两者偏差显著则建议采用更精细的电网模型（例如包含变电站容量与线路阻抗的等效网络模型）作为后验校正。\n\n输出与接口要求。按照题目要求的“数据格式.xlsx”输出，每秒一行给出时刻、速度、到起点公里标（x）、到刚通过的一站的距离（s）、牵引力/制动力百分比 μ、网侧功率/电能消耗累积值等字段。为符合题目中“计算公里标是到起点距离，计算距离是到刚通过一站的距离”的要求，在仿真中维护两个位置变量并在输出中分别写入。并提供可复现的脚本与参数文件以便评审复现。\n\n模型的扩展方向与长期改进。为提高适用性与现实工程价值，下一步可把电气系统的瞬时功率匹配由简单的“min(accel, regen)” 替换为包含接触网电压与变电站网络模型的功率流模拟，从而考虑电压降、变电站容量限制及逆送限制。对在线控制，可探索基于强化学习（RL）的近似控制器：先用上述物理仿真器生成大量最优轨迹作为专家数据，再训练策略网络以在实时场景下快速给出接近最优的速度—距离曲线或加速度剖面。对于多目标权衡（能耗、准点性、舒适性），建议采用多目标优化或权重可调的层级目标，以满足不同运营策略的需要。最后，建议在部署前通过试验段的实车试验或与历史数据的对比逐步校准再生效率与阻力模型，并在系统投入运营后用在线辨识不断自适应更新模型参数（例如阻力多项式和牵引曲线），从而保持模型与控制策略的长期有效性。\n\n总结性实施路线。先完成单列 A6→A7 与 A6→A8 的直接法数值求解（时间步长 1 s 输出），在单列级别验证动力学一致性与能耗计算；随后构建并行仿真器并实现多列分层优化框架，用启发式全局搜索求解发车间隔向量 H 并在高峰/全天场景下得到能耗最小的时刻表；最终实现延误恢复模块基于 MPC/场景化优化以最小化延误并兼顾能耗。整个过程中保持参数的可配置与可校准性，输出满足题目“每秒一行”的数据格式，并提供敏感性与不确定性分析结果以便结果解释和工程部署决策。以上模型既包含题目所需的物理关系与约束，也在多列耦合与随机延误情形下提出了切实可行的求解策略与工程实现路径。",
  "task_descriptions": [
    "子任务1（单列车物理建模与能耗最优控制求解）目标是：在给定的线路与列车参数下，为单列车分别求解从 A6 到 A7 （站间运行时间固定为 110 s）以及从 A6 经停 A7（停站 45 s）到 A8（A6→A8 两站间总运行时间（不含停站）为 220 s）的最节能速度—距离曲线，并按每秒一行输出满足“数据格式.xlsx”红色表头的字段；为此需完成以下工作并满足列出的模型、约束与数值实现细节。输入数据：读取“列车参数.xlsx”“线路参数.xlsx”中的列车质量 M、牵引/制动特性曲线 F_max(v), B_max(v)、阻力多项式系数 A,B,C、曲线常数 c（≈600）、各区段坡度 i（‰）、曲线半径 R、分段限速 V_line(x)、站间距离与公里标等；注意单位统一（速度在动力学中以 m/s 计算，题中阻力多项式以 km/h 表示时须换算）。物理与数学假设：单质点模型，动力学由牛顿第二定律描述 M dv/dt = F(t) − B(t) − W(v,x)，dx/dt = v；总阻力按题目给出 W = (w0(v)+w1(x))·g·M/1000，其中 w0(v)=A + B·v_km_h + C·v_km_h^2（实施时将 v 单位统一并换算系数），附加阻力 w1 由坡度 i 与曲线阻力 c/R 计算并按题中折算规则处理；牵引与制动力按 F = μ_F · F_max(v)、B = μ_B · B_max(v)，μ∈[0,1]，且任一时刻不得同时牵引与制动（以 F·B=0 或二元互斥逻辑实现）。能量目标：离散化时最小化网侧净能耗 E_grid = ∑_k [P_trac_k − P_regen_used_k]_+ · Δt，其中牵引瞬时功率 P_trac = F·v，制动阶段产生的再生能量按题目公式在时间离散上累积计算 E_reg = 0.95·(ΔE_mech − E_f)，或在瞬时近似中使用 P_regen_max ≈ η_reg·(B·v − W·v) 的非负部分并按本单列情形的可用性处理（实现中保留题设的 E_reg 计算以便与题目要求一致）；所有能量计算应考虑单位一致性并输出累积网侧能量。边界与路径约束：初末速度在起/到站点为 0，运行位移积分等于站间距离；对 A6→A8 问题在到达 A7 时强制速度为 0 并保持停站 45 s，然后从静止出发继续到达 A8，总行程（除停站）时间等于 220 s；速度在任意时刻被线路限速 V_line(x) 约束并受牵引/制动能力曲线限制；为保证乘客舒适性与数值稳定性，施加加速度/减速度上下限（由车辆规范或牵引/制动力曲线隐含），并可选设最小安全速度/距离约束。数值方法与实现细节：采用直接法时间离散（建议输出步长 dt=1 s 以匹配提交格式；为提高求解质量可在求解时用更细步长如 0.2–0.5 s 内部离散再按 1 s 采样输出），将动力学用显式或隐式欧拉/Runge‑Kutta 或多项式插值离散转为 NLP；决策变量为每时步的 v_k、x_k、F_k、B_k（或 μ_F_k、μ_B_k），并包含互斥约束、F_max(v_k)、B_max(v_k)、速度上界、位置累积与时间窗口约束（包括停站时段的速度=0）；若需精确互斥可采用二元变量转为 MIP，否则采用连续松弛并加大互斥惩罚（推荐以连续方法优先以保持可解性）。求解器与工具建议：使用 CasADi+IPOPT、KNITRO 或其他成熟 NLP 求解器实现直接积分-优化框架，调优初始值（以典型的“牵引→惰行→巡航→制动”分段剖面作为初猜）以帮助收敛；实现时注意变量标度、约束松弛策略与奇异点处理。输出要求与验算：按每秒输出时间戳、速度（km/h 或 m/s，按“数据格式.xlsx”要求）、到起点公里标（m）、到上站的计算距离（m）、控制百分比 μ_F/μ_B 或实际牵引/制动力值、瞬时牵引/制动功率、瞬时再生功率及累积网侧能耗等字段并写入“数据格式.xlsx”对应列；同时留存中间解（状态和控制序列）、单位换算细节和初始参数文件以便复现。数值鲁棒性与验证：在实现中执行单位一致性检查、能量收支监测（总机械能变化与牵引/制动/阻力做功的能量平衡），并用不同初值与更细网格检验解的稳定性；在求解器难以收敛时，采用分段优化（先粗格步长求解再局部精化）或参数扫描法寻找全局可行初解。该子任务仅负责单列车的模型建立、数值实现及两种指定运行情形的最优速度—距离曲线求解与按秒输出，不包括多列耦合、调度优化或实时延误恢复的任何内容。",
    "子任务2的目标是构建一个用于评估与优化多列车发车间隔 H 和各站停站时间 D 的分层优化框架（仅限于发车间隔与停站时间的优化与仿真评价，不包含单列最优控制器的推导细节），其输入包括：列车动力学与牵引/制动特性、阻力多项式系数、线路分段限速、坡度与曲线半径、站间距离、运营约束（每列从 A1 到 A14 的总运行时间固定为 2086 s 含停站、单日列车总数与峰谷时段约束）、发车间隔上下界 H_min/H_max、每站停站时间范围 [D_min,D_max]、总发车跨度约束 Σ H_i = T0 等；输出为使全系统网侧总能耗最小的间隔向量 H、停站时间矩阵 D 及每列按秒的速度/位置/功率仿真结果和能耗统计。方法上采用两层架构：第一层（调度/决策层）将 H 与 D 作为连续决策变量，在满足边界与线性等式约束（含 ΣH=T0 与每分量界限、各停时界限）下进行全局或局部优化搜索；第二层（评价/仿真层）为并行化的多列仿真器，用于给定候选 H、D 时构造每列的发车时刻与各站到发时刻，并逐秒（或更细时间步）仿真所有列车的运动与功率交换，仿真器应调用或接口化单列速度剖面生成模块（作为黑盒求解器）为每列生成满足时刻约束、速度限幅与安全追踪约束（包括线路限速 V_line(x)、追踪安全速限 V_limit = min(V_line, sqrt(2·L·B_e))、最小车间距等）的可行速度—位置曲线；在仿真时刻步上计算每列牵引功率和制动再生功率，按瞬时功率匹配原则 P_used(t)=min(P_accel(t),P_regen(t)) 计算网侧即时需量 P_grid(t)，并时间积分得到候选方案的目标值（总网侧能耗）。为求解第一层的非凸高维优化问题，建议采用混合策略：对大尺度搜索使用启发式全局优化算法（遗传算法、粒子群、差分进化、或基于 pygmo 的演化方法）或基于代理的全局搜索（先用低分辨率仿真或训练的代理模型近似能耗以快速筛选候选），对局部精化使用约束连续优化（SQP、IPOPT）或带罚函数的梯度方法；约束处理可用投影/修复（确保 ΣH=T0）或罚函数方式实现。实现细节应包括：读取并校验“列车参数.docx”、“线路参数.xlsx”和初始时刻表模板，时间离散步长输出为 1 s（评价层内部可使用更细步长并于后处理中按 1 s 汇总），并行化策略为对候选 H 并行评估或对列车并行求解单列速度剖面以缩短评价时间；维度降阶选项（可选但建议）包括用簇参数化或段式参数表示 H（如在高峰/非高峰分别均匀分段）以减少搜索维数。评估指标除总能耗外还应计算各列准点率约束违例、最小安全距离违例、各站平均停站时间分布与计算收敛性（目标改进阈值、最大迭代数或时间限制作为终止条件）。推荐工具链为 Python + 并行模块（multiprocessing/mpi4py）、优化库（DEAP/pygmo 或 scipy.optimize + IPOPT/CasADi 用于局部解）、以及用于数值仿真的模块化接口（单列求解器作为可调用服务或函数），并应输出：最终 H 向量与 D 矩阵、每列按秒的速度/位置/牵引与再生功率时间序列、总体与分时段能耗统计、以及优化过程日志（迭代历史、候选评估时间、并行效率）。在实现中需明确容错与约束修复策略（对不满足安全或时刻约束的候选即时弃用或以修复策略调整），并给出计算资源估计与并行化建议以保证在可接受时间内完成全局搜索与精化。",
    "子任务3（列车延误后运行优化控制）应作为一个独立的实时滚动优化模块，其目标是在保证行车安全与乘客舒适性的前提下：第一优先尽快恢复所有受影响列车的准点运行（最小化后续列车的累计/最大延误或恢复到原计划的时间窗内），第二优先在满足第一目标的可行域内最小化恢复期间的网侧能耗。该模块输入需包括：发生延误的列车标识与延误量 DT_j^i（事件时刻）、当前全网与局部列车状态（每列当前位置、速度、既定到发时刻與剩余停站）、列车动力学与牵引/制动特性（F_max(v), B_max(v)、质量 M）、线路参数（分段限速、坡度、曲线半径、站间距离）、安全参数（最小车间距 L_min、制动能级 B_e）、停站时间上下界 [D_min,D_max] 及允许的提前上限（每站至多提前 10s），并需获取延误概率分布以用于随机化处理（参考：无延误70%、普通延误20%、严重延误10%）。方法上采用事件触发的滚动时域模型预测控制（MPC）框架：以延误发生时刻为起点，构建一个覆盖“受影响列车集” 的有限时间/位置窗（建议包含延误列及其前后 K 列，K 可配置，典型取 5–10）和一个有限优化时域（例如直到这些列在若干后续站恢复或固定时间窗口内），在该窗内同时优化决策变量：每列的逐秒加速度/牵引/制动剖面（或直接牵引/制动百分比 μ），以及允许的站内到发时间微调（提前 ≤10s、压缩停站到 D_min 或在[D_min,D_max]内调整），并可包含离散决策（是否提前发车、是否压缩停站）如需则用混合整数变量建模。约束包括：动力学与位移方程、牵引/制动力受速度相关上界、速度不得超出线路限速与追踪安全限速（例如 v ≤ min(V_line, sqrt(2·L·B_e)）)、最小车间距/防撞约束、乘客舒适性加速度/减速度上下限、停站到发时间与提前不超10s限制、不可同时牵引与制动等；若严重延误（如 DT>120s 或无法在可接受窗内恢复）应触发人工调度或保守策略。为处理随机性与鲁棒性，提供两种可选做法：场景化样本平均近似（SAA）——基于延误分布生成 N 个场景（建议 50–200），在每个场景下评估并最小化期望的分层目标或 CVaR；或机会约束/鲁棒优化——对关键安全/准点性约束施加概率保证（例如保证 95% 情形下恢复到位）。数值求解策略建议采用时间离散化后求解非线性规划（NLP），优选工具链为 CasADi+IPOPT（连续变量）或在包含较多离散决策时使用混合整数求解器（如 Gurobi/CPLEX）；为满足实时性应采取局部化（仅优化受影响列与相邻列）、短时滚动窗、热启动/上次解作为初值、并行化場景计算與解算、以及必要时用近似凸化或快速启发式（优先压缩停站、然后加速/惰行调整）作为回退策略，目标是保证单次重规划在可接受的响应时间（例如 ≤30 s，具体依运营要求设定）。模块输出为：修正后的逐秒速度—位置曲线、调整后的到发时刻与停站时间、逐秒牵引/制动与估计再生/网侧能耗、恢复准点性的概率/期望指标以及可执行性/安全性标志；若优化不可行则返回可行的保守修正策略并标注需人工介入。为便于部署，应实现可配置的参数集（K、滚动窗长度、场景数、优先级权重）、解的可复现记录（初值、求解器日志）和快速诊断接口，以便在运营系统中与列车监控/调度系统对接并支持逐次滚动重规划。",
    "子任务4（验证、敏感性分析、实现细节与工程化扩展路线）应当作为独立、可重复执行的工程化工作包，其目标是对用于速度—距离曲线与能耗仿真的物理模型和数值实现进行系统校准、验证与不确定性量化，并输出可用于工程部署的经校准参数集、鲁棒性报告、软件交付物与改进建议；为此需按以下步骤严格实施：首先准备与预处理输入数据（读取并核验“列车参数.docx”、“线路参数.xlsx”、“输入数据模板.xlsx”中所有字段、单位与缺失值，统一单位制，生成基线参数文件与元数据记录），并建立自动化单元检查（单位一致性、边界值、物理可行性）；第二步进行参数标定与模型识别，采用历史运行数据（若无则采用合成高保真试验数据）对阻力多项式系数A、B、C、牵引/制动特性曲线F_max(v)/B_max(v)、列车质量M、再生效率η_reg、曲线常数c等关键参数进行估计，方法包括：非线性最小二乘拟合、扩展/无迹卡尔曼滤波用于在线辨识、以及贝叶斯校准以给出后验分布；校准过程中应进行残差分析和交叉验证以防过拟合，并保存参数置信区间；第三步执行模型验证套件：对时间步长敏感性（如0.2s、0.5s、1s）与积分方法（显式/隐式、RK2/4）进行收敛性测试；实施能量收支检验（牵引能量＋初始动能 − 阻力做功 − 制动损耗 ≈ 机械能终值，能量误差应记录并控制在可接受范围内）；比较模型预测与观测（或高精度仿真）在速度轨迹、到发时刻与网侧能耗上的误差指标（RMSE、MAE、相对误差及违约率），并生成详细验证报告；第四步开展不确定性与敏感性分析：定义关键不确定参数及其变动区间（例如η_reg 80–98%、A/B/C ±30%、F_max/B_max 曲线偏移 ±10%、M ±10%、c ±20%、变电站容量等），采用拉丁超立方采样（LHS）或Sobol序列进行蒙特卡洛模拟（建议至少数千次样本以获得稳健统计），并计算局部（单参数一阶敏感）与全局敏感性指标（Sobol总效应、Morris筛选），输出参数对目标（网侧能耗、再生利用率、最大速度/加速度、约束违规率）方差贡献排序与不确定区间，必要时构建响应面或代理模型（高斯过程、径向基或神经网络）以加速后续的高维优化评估；第五步对再生能量模型进行对比验证：并行实现并评估题目给定的“制动能量按制动时间重叠线性分配”近似与更物理的“瞬时功率匹配”模型（以及可选的等效电网模型，包括变电站容量与接触网电压约束的简化电气网络），比较两种方法下的再生利用率与网侧能耗差异，若差异显著则建议采用电网耦合模型或在原始模型中加入经验修正系数；第六步编制实施与软件工程要求：提供可复现的代码仓库（建议使用 Python，依赖：numpy/pandas, CasADi, IPOPT或KNITRO接口, scipy, pyDOE/ SALib, pygmo/DEAP），包含数据导入、单位转换、参数配置、标定脚本、验证测试套件、敏感性分析脚本及示例输入输出；要求所有随机过程设置固定种子、结果与中间产物采用可追溯命名并记录求解器版本与运行环境（推荐使用 Docker 容器化以保证可复现），并提供自动化报告生成功能（包含能耗时序图、误差统计、敏感性图表与建议参数）；第七步给出计算资源与性能建议：估算单次高精度仿真（细步长、单列NLP）与大规模蒙特卡洛所需的CPU核数与内存，推荐并行化策略（对样本并行或对列车并行），并提出代理模型在全局优化时的使用方案以降低评估成本；第八步输出交付项与工程化扩展建议：交付经校准的参数文件与置信区间、验证与敏感性报告、可执行软件包与Docker镜像、按秒格式的输出接口说明（匹配“数据格式.xlsx”列）及示例数据、以及若干优先级调整的改进路线（如在后续引入更精确的接触网功率流模型、在线参数自适应辨识模块或基于代理/机器学习的实时控制近似器）；最后要求在报告中明确列出所有假设、不适用域与可能导致偏差的条款，并建议一组可量化的接受标准（例如能量预报相对误差、约束违规率阈值、校准后残差统计），以便工程验收和后续迭代改进。"
  ]
}