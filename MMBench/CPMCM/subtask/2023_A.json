{
  "tasks": [],
  "problem_str": "问题背景：\n\\section*{WLAN网络信道接入机制建模}\n\n\\subsection*{1. 背景}\n\n无线局域网（WLAN, wireless local area network）也即Wi-Fi广泛使用，提供低成本、高吞吐和便利的无线通信服务。基本服务集（BSS, basic service set）是WLAN的基本组成部分。处于某一特定覆盖区域内的站点（STA, station）与一个专职管理BSS的无线接入点（AP, access point）组成一个BSS，称STA关联到AP。常见的AP有无线路由器、WiFi热点等，手机、笔记本、物联设备等是STA。AP给STA发送数据叫作下行方向，反之是上行方向，本文将AP和STA统称为节点，每个节点的发送和接收不能同时发生。各节点共享信道，通过载波侦听多址接入/退避（CSMA/CA, carrier sense multi-access and collision avoidance）的机制避免冲突，称为分布式协调功能（DCF, distributed coordination function）。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=0.5\\textwidth]{wlan_network.png}\n    \\caption{1.1 WLAN网络}\n\\end{figure}\n\n\\subsection*{1.1 分布式信道接入和二进制指数退避}\n\nDCF机制提供了一种分布式、基于竞争的信道接入功能。可将每个节点接入信道进行数据传输的过程分为3个阶段，信道可用评估（CCA, clear channel assessment）、随机回退、数据传输。\n\n\\begin{enumerate}\n    \\item \\textbf{CCA：} 当一个节点打算发送时，首先进行一个固定时长的载波侦听，这个固定时长被称为DCF帧间距（DIFS, DCF inter-frame space），43μs。如果DIFS时段内接收到的信号能量强度（RSSI, received signal strength indication）低于CCA门限（-82dBm），判断信道为空闲，否则，判断信道为繁忙。\n    \\item \\textbf{随机回退：} 信道空闲时，可能有多个节点准备好了数据，为避免碰撞，节点从[0, CW-1]的均匀分布选取一个随机数作为回退数，等待该回退数个时隙长度slotTime（9μs），随机回退时段时长为回退数乘以slotTime。CW被称为竞争窗口（contention window）。如果信道在随机回退时段保持空闲，则节点开始一次数据传输。在随机回退时段节点持续监听信道，如果期间信道变繁忙，则节点将回退暂停，直到信道在一个DIFS时长重新变为空闲，再继续前面没有回退完的时间。\n    \\item \\textbf{数据传输：} 回退到0的节点发送一个数据帧，接收节点成功接收到数据之后等待短帧帧间距（SIFS, Short inter-frame space）16μs后，回复ACK确认帧（32μs）。如果发送节点收到ACK，则数据发送成功。如果发送数据帧没有被接收节点成功接收，或者ACK发送失败，或者ACK没有被发送节点收到，则数据传输失败，发送节点需要在等待超时后重传数据。等待超时时间ACKTimeout为65μs。\n\\end{enumerate}\n\n随机回退采用二进制指数退避算法确定回退时间。CW的初始值为$CW_{\\text{min}}$，每次数据传输失败后重传数据帧时，CW翻倍。如果CW达到了$CW_{\\text{max}}$，则保持此值，直到被重置为止。每次数据传输成功时CW重置，开始下一个数据帧的回退。若传输连续失败，重传次数达到r后，数据帧被丢弃，CW重置传输下一个数据帧。可见，重传r次时，无论成功还是失败，CW都会重置。\n\\subsection{基于Markov chain的DCF机制建模和系统性能分析}\n\n对于单BSS，$N$个STA给AP发送上行数据，Bianchi（1998）最早基于Markov chain建模。Bianchi模型假设理想信道，不因信道质量差而丢包。当2个及以上节点同时回退到0发送数据时，由于碰撞而丢包。那么信道可能处于三种状态：空闲、成功传输、碰撞，如图1.2所示。将每个状态看作一个虚拟时隙，那么信道在三种虚拟时隙中转化。将退避器所处的阶数和随机回退数用二维Markov chain表示，推导节点在每个虚拟时隙的发送概率$\\tau$和发生碰撞的条件概率$p$，从而评估BSS的吞吐[1]。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{channel_states.png}\n    \\caption{信道状态}\n    \\label{fig:channel_states}\n\\end{figure}\n\nBianchi模型获得了很高的精确度，很多工作在此基础上扩展，Chatzimisios（2002）研究了有最大重传次数限制的媒体接入控制（MAC，medium access control）层性能情况[2]。Huang和Ivan Marsic（2010）介绍了隐藏节点下网络模型和性能分析[3]。Chen（2007）分析了多速率MAC协议的性能[4]。基于Markov链求解$\\tau$和$p$的推导见附录和参考文献。\n\n吞吐是单位时间内发送数据有效载荷的比特数，单位bps。吞吐$S$可以由信道的利用率与物理层速率（单位bps）的乘积表示，\n\n\\begin{equation}\nS = \\frac{\\text{E[一个时隙内传输的有效载荷发送时长]}}{\\text{E[一个时隙长度]}} * \\text{物理层速率}\n\\tag{1}\n\\end{equation}\n\n信道处于三种虚拟时隙的概率可由$\\tau$和$p$表示，空闲时隙的长度$T_e$是slotTime。成功传输和碰撞的传输时长$T_s$和$T_c$分别表示为\n\n\\begin{align}\nT_s &= H + E[P] + SIFS + ACK + DIFS \\\\\nT_c &= H + E*[P] + DIFS + ACKTimeout\n\\tag{2}\n\\end{align}\n\n$H$为数据帧头，包括MAC层头和物理（PHY，physical）层头，E[P]为数据帧的有效载荷传输时长，E*[P]为发生冲突时较长数据帧的有效载荷传输时长，假设所有节点的数据帧长度一样，则E[P]与E*[P]相等。PHY头时长固定，MAC头和有效载荷的发送时长由其字节长度除以物理层速率得到。\n\n问题要求：\n\\section{WLAN组网中的多BSS建模问题}\n\n节点发送数据后，电磁波信号在自由空间中传播，随着距离的增加，能量衰减越严重。周围节点收到该信号后，根据RSSI是否高于CCA门限，判断信道为忙或闲。一个节点发出信号的RSSI高于CCA门限的区域叫作通信区域，位于该通信区域内的节点与该发送节点互听。随着设备数量、应用类型、网络流量的飞速增长，AP部署日趋高密，如企业办公、工厂、教育场景。如图2.2（a）所示，将信道号为36、44、52、60、149、157的六个信道分配给区域内12个BSS，由于可用信道数有限，不同的BSS复用同一个信道。同频AP（使用相同信道号的AP）之间通信区域存在重叠时，存在相互干扰问题，叫作同频干扰。同频干扰是WLAN组网最显著的干扰问题，本题不考虑异频干扰的情况。家庭或宿舍等单BSS场景中，STA距离AP较近，RSSI较强，互听，假设理想信道，不会因信道质量差而丢包，只有在2个及以上STA同时发送数据时导致碰撞而丢包。而在教学区等场景，同频多BSS场景的情况更复杂。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{ap_deployment.png}\n    \\caption{(a) AP密集部署 (b) 两同频BSS场景 (c) 三同频BSS场景}\n    \\label{fig:ap_deployment}\n\\end{figure}\n首先，并不是所有的节点之间都能互听。假定 AP 和 STA 的发射功率相同，由于节点间距离不同，信号衰减不同，因此 RSSI 不同。节点在 DIFS 时长侦听信号的 RSSI > CCA 门限时，节点才认为信道繁忙，否则认为信道空闲，启动随机回退，发送数据。其次，当有多个 BSS 的节点同时发送数据（叫作并发传输）时，其成功与否与信干比（SIR，signal to interference ratio）有关，若 SIR 足够高，则信号能被成功解调，若 SIR 很低，则信号解调失败。信干比是信号强度与干扰强度的比值，单位是 dB，RSSI 的单位是 dBm，则 SIR 可以用信号 RSSI 与干扰信号 RSSI 的差值表示，本文中不考虑环境噪声。\n\n发送节点间能否互听，并发传输时是否成功，是进行系统建模需要考虑的两个先决条件，前者决定了退避计数器能否回退，后者决定了一次并发传输是成功还是失败，从而直接影响成功、失败和空闲三种状态之间的转换。\n\n\\subsection*{2.1 两 BSS 互听}\n\n考虑 2 个 BSS 互听的场景，仅下行，即两个 AP 分别向各自关联的 STA 发送数据，如图 2.2（b）所示。以 AP1 -> STA1 方向的数据传输为例，其会受到相邻 BSS2 的干扰，对于 STA1 来说，AP1 -> STA1 是信号，AP2 -> STA1 是干扰。对于 AP2 -> STA2 情况类似。假设 ACK 一定能发送成功。根据节点之间的 RSSI 估算两个 AP 并发时的 SIR，考虑不同的情景进行建模。\n\n\\subsubsection*{问题 1：}\n\n假设 AP 发送包的载荷长度为 1500 Bytes（1 Byte = 8 bits），PHY 头时长为 13.6 μs，MAC 头为 30 Bytes，MAC 头和有效载荷采用物理层速率 455.8 Mbps 发送。AP 之间的 RSSI 为 -70 dBm。大部分时候只有一个 AP 能够接入信道，数据传输一定成功。当两个 AP 同时回退到 0 而同时发送数据时，存在同频干扰。假设并发时的 SIR 较低，导致两个 AP 的数据传输都失败。请对该 2BSS 系统进行建模，用数值分析方法求解，评估系统的吞吐。（参数参考附录 4，可编写仿真器验证模型精确度）\n\n\\subsubsection*{问题 2}\n\n假设两个 AP 采用物理层速率 275.3 Mbps 发送数据，并发时两个终端接收到数据的 SIR 较高，两个 AP 的数据传输都能成功。其他条件同问题 1。请对该 2BSS 系统进行建模，用数值分析方法求解，评估系统的吞吐。（参数参考附录 4，可编写仿真器验证模型精确度）\n\n\\subsection*{2.2 两 BSS 不互听}\n\n在 AP 密集部署时，同频 AP 之间的距离远，AP 间 RSSI 低于 CCA 门限，不互听。AP 认为信道空闲，因此总是在退避和发送数据。这是 Wi-Fi 里常见的隐藏节点问题，详见附录。可以预见的是，有很大概率出现二者同时或先后开始发送数据的情况。接收机解调信号时，PHY 头的前面部分码元用于 Wi-Fi 信号识别、频率纠错、定时等功能，叫作前导（Preamble）。如图 2.3 所示，当信号包先到时，接收机先解信号包的 Preamble 并锁定，干扰包被视为干扰，信号包是否接收成功由 SIR 决定；当干扰包先到时，接收机先锁定到干扰包的 Preamble，错过信号包的 Preamble，导致信号包无法解调。小信号屏蔽算法能有效解决这个问题，因为信号包 RSSI 一般大于邻小区的干扰包，接收机在信号包到达时转为锁定 RSSI 更大的信号包，此时信号包能否接收成功同样也由 SIR 决定。由此可以得知，在 SIR 比较小的情况下，如果信号包和干扰包在时间上有如图 2.3 的交叠时，一定会导致本次传输的失败。\\begin{table}\n\\centering\n\\begin{tabular}{c c c c c c c}\n\\hline\n信号 & PHY hdr & MAC hdr & Payload & 信号 & PHY hdr & MAC hdr & Payload \\\\\n\\hline\nPreamble & & & & Preamble & & & \\\\\n\\hline\n干扰 & PHY hdr & MAC hdr & Payload & 干扰 & PHY hdr & MAC hdr & Payload \\\\\n\\hline\n\\end{tabular}\n\\caption{图2.3 并发传输交叠示意图}\n\\end{table}\n\n\\section*{问题3}\n\n假设AP间RSSI为-90dBm，AP发送包的载荷长度为1500Bytes，PHY头时长为13.6，MAC头为30Bytes，MAC头和载荷采用物理层速率455.8Mbps发送。Bianchi模型假设理想信道，实际上，无线传输环境是复杂多变的，当有遮挡物或者人走动时，无线信道都可能会快速发生比较大的变化。实测发现，当仅有一个AP发送数据时，即便不存在邻BSS干扰，也会有10%以内不同程度的丢包。假设因信道质量导致的丢包率$P_e=10\\%$。当两个AP发包在时间上有交叠时，假设SIR比较小，会导致两个AP的发包均失败。请对该2BSS系统进行建模，尽量用数值分析方法求解，评估系统的吞吐。（参数参考附录4和6，可编写仿真器验证模型精确度）\n\n\\section*{2.3 三BSS}\n\n\\section*{问题4}\n\n考虑3BSS场景，如图2.2(c)所示，其中AP1与AP2之间，AP2与AP3之间RSSI均为-70dBm，AP1与AP3之间RSSI为-96dBm。该场景中，AP1与AP3不互听，AP2与两者都互听，可以预见的是，AP2的发送机会被AP1和AP3挤占。AP1与AP3由于不互听可能同时或先后发送数据。假设三个AP发送包的载荷长度为1500Bytes，PHY头时长为13.6$\\mu s$，MAC头为30Bytes，MAC头和载荷采用物理层速率455.8Mbps发送。假设AP1和AP3发包时间交叠时，SIR较大，两者发送均成功。请对该3BSS系统进行建模，尽量用数值分析方法求解，评估系统的吞吐。（参数参考附录4和6，可编写仿真器验证模型精确度）\n\n\\section*{缩略语}\n\n\\begin{itemize}\n    \\item AP: access point (无线接入点)\n    \\item ACK: Acknowledgement (确认)\n    \\item ACK Timeout: 确认超时\n    \\item BSS: basic service set (基本服务集)\n    \\item CCA: clear channel assessment (信道可用评估)\n    \\item CSMA/CA: carrier sense multi-access and collision avoidance (载波监听多址接入/退避)\n    \\item CW: contention window (竞争窗口)\n    \\item DCF: distributed coordination function (分布式协调功能)\n    \\item DIFS: DCF inter-frame space (DCF帧间距)\n    \\item MAC: medium access control (媒体控制)\n    \\item PHY: physical (物理层)\n    \\item RSSI: received signal strength indication (接收信号能量强度)\n    \\item SIFS: short inter-frame space (短帧间距)\n    \\item SIR: signal to interference ratio (信干比)\n    \\item STA: station (站点)\n    \\item WLAN: wireless local area network (无线局域网)\n\\end{itemize}\\section*{缩略语}\n\n\\begin{tabular}{|c|c|c|}\n\\hline\nAP & access point & 无线接入点 \\\\\n\\hline\nACK & Acknowledgement & 确认 \\\\\n\\hline\nACKTimeout &  & 确认超时 \\\\\n\\hline\nBSS & basic service set & 基本服务集 \\\\\n\\hline\nCCA & clear channel assessment & 信道可用性评估 \\\\\n\\hline\nCSMA/CA & carrier sense multi-access and collision avoidance & 载波监听多址接入退避 \\\\\n\\hline\nCW & contention window & 竞争窗口 \\\\\n\\hline\nDCF & distributed coordination function & 分布式协调功能 \\\\\n\\hline\nDIFS & DCF inter-frame space & DCF 帧间距 \\\\\n\\hline\nMAC & medium access control & 媒体控制 \\\\\n\\hline\nPHY & physical & 物理层 \\\\\n\\hline\nRSSI & received signal strength indication & 接收信号能量强度 \\\\\n\\hline\nSIFS & short inter-frame space & 短帧间距 \\\\\n\\hline\nSIR & signal to interference ratio & 信干比 \\\\\n\\hline\nSTA & station & 站点 \\\\\n\\hline\nWLAN & wireless local area network & 无线局域网 \\\\\n\\hline\n\\end{tabular}\nAddendum: \n\\section{随机回退}\n\n随机回退采用二进制指数退避算法确定回退时间。CW 的初始值为 $CW_{\\text{min}}$，每次数据传输失败后进行重传时，CW 翻倍。如果 CW 达到了 $CW_{\\text{max}}$，则保持此值，直到被重置为止。每次数据传输成功时 CW 重置，开始下一个数据帧的回退。若传输连续失败，重传次数达到 $r$ 后，数据帧被丢弃，CW 重置传输下一个数据帧。可见，重传 $r$ 次时，无论成功还是失败，CW 都会重置。\n\n图 3.1 以三个节点为例说明。图中 CW 表示当前阶竞争窗口大小，BO 表示随机回退过程时退避计数器从 $[0, CW-1]$ 随机选取的初始值。三个节点的 $CW_{\\text{min}}$ 分别是 8、16、32。开始时，Station c 在发送数据，信道繁忙，数据发送完成后，退避计数器重置。Station a、b 和 c 持续侦听信道 DIFS 时长，信道被检测为空闲，三者分别开始随机回退，都处于第 0 阶，竞争窗为 $[0, CW_{\\text{min}}-1]$。Station a 从 $[0, 7]$ 选择了一个随机数 7，需要回退 7 个 slotTime；Station b 则从 $[0, 15]$ 选择了随机数 12 回退；Station c 从 $[0, 31]$ 选择了随机数 16 回退；显然，Station a 最先回退到 0，抢占到信道，开始一次数据发送，此时，Station b 和 c 在其回退过程中由于侦听到信道繁忙，随机回退暂停。当 Station a 发送成功后，其竞争窗口重置，信道持续 DIFS 时长空闲后，Station a 重新从 $[0, 7]$ 选择随机数 5 回退，Station b 和 c 接着暂停前的回退数继续回退。本次 Station a 和 b 同时回退到 0，同时发送数据，由于冲突导致发送失败，接收节点将不会回复 ACK，Station a 和 b 在等待 ACKTimeout 后判断数据发送失败，进行重传，将竞争窗翻倍，再次侦听信道 DIFS 时长判断信道空闲后，Station a 从 $[0, 15]$ 选择随机数 11 回退，Station b 则从 $[0, 31]$ 选择随机数 9 回退。需要注意的是，图 3.1 中的一次传输 (Tx, transmission) 包含了发送一个数据包和接收一个 ACK，一次 collision 包含了发送一个数据包和等待 ACKTimeout 时长。帧序列如图 3.2 所示，一个数据帧包括 PHY 头、MAC 头和有效载荷 payload。\n\n\\begin{figure}[h]\n\\centering\n\\includegraphics[width=\\textwidth]{image1.png}\n\\caption{二进制指数退避过程}\n\\end{figure}\n\n\\begin{figure}[h]\n\\centering\n\\includegraphics[width=\\textwidth]{image2.png}\n\\caption{帧序列}\n\\end{figure}\n\n\\section{2 Bianchi 模型}\n\n令 $b(t)$ 和 $s(t)$ 代表 $t$ 时刻一个节点退避随机过程的退避计数和退避阶数，这里的 $t$ 是一个离散的虚拟时隙的开始时刻。用 $i$ 表示一个数据的发送次数，也叫作阶数，$r$ 为最大重传次数，$m$ 是最大退避阶数，则 CW 可用下式表示：\n\\begin{equation}\n\\begin{cases}\nW_i = 2^i W_0 & 0 \\leq i \\leq m \\\\\nW_i = 2^m W_0 & m \\leq i \\leq r\n\\end{cases}\n\\tag{3}\n\\end{equation}\n\n二维 $\\{b(t), s(t)\\}$ 随机过程可以用二维 Markov chain 表示，如图 3.3 所示。$b_{i,k} = \\lim_{t \\to \\infty} P\\{s(t) = i, b(t) = k\\}$ 代表二维 Markov chain 的稳态解，$i \\in [0, m]$, $k \\in [0, W_i - 1]$。\n\n\\begin{figure}[h]\n\\centering\n\\includegraphics[width=\\textwidth]{markov_chain_diagram.png}\n\\caption{DCF 的 Markov 链模型}\n\\end{figure}\n\n$p$ 为某个时隙发生碰撞的概率，Markov chain 一步状态转移概率为：\n\\begin{equation}\n\\begin{aligned}\nP\\{i, k | i, k+1\\} &= 1 & k \\in [0, W_i - 2] & i \\in [0, r] \\\\\nP\\{0, k | i, 0\\} &= (1-p)/W_0 & k \\in [0, W_0 - 1] & i \\in [0, r] \\\\\nP\\{i, k | i-1, 0\\} &= p/W_i & k \\in [0, W_i - 1] & i \\in [1, r] \\\\\nP\\{0, k | r, 0\\} &= 1/W_0 & k \\in [0, W_0 - 1] &\n\\end{aligned}\n\\tag{4}\n\\end{equation}\n\n式 (4) 中每个式子分别代表一定的物理含义。第一个等式代表，未达到重传上限时，退避计数器在每个空闲时隙的开始时刻减 1 的概率是 1。第二个等式代表，未达到重传上限时，当一个数据成功传输后，新到达的数据在 $[0, W_0 - 1]$ 中等概率选一个随机数进行回退。第三个等式代表，未达到重传上限时，当一个数据第 $i-1$ 次传输过程发生碰撞，节点进入第 $i$ 阶回退过程，并在 $[0, W_i - 1]$ 中等概率选一个随机数进行回退。最后一个等式代表，当节点到达最大的传输次数以后，无论成功还是失败，CW 都会重置。\n\n该 Markov chain 的任意状态之间可达，是不可约的。任意状态到另一状态的步长不存在周期。从任何状态出发，都能到达另一状态，具有常返性。因此该二进制退避过程的非周期不可约 Markov chain 具有稳态解，且所有稳态的概率之和为 1。\n令 \\( b_{i,k} = \\lim_{t \\to \\infty} P\\{s(t) = i, b(t) = k\\}, i \\in (0, m), k \\in (0, W_i - 1) \\) 表示 Markov chain 的稳态解，从图 3.3 中可以看出，对于一次发送失败的情况，状态 \\( b_{i-1,0} \\) 到状态 \\( b_{i,0} \\) 的步长包括， \\( b_{i-1,0} \\to b_{i,0} \\), \\( b_{i-1,0} \\to b_{i,1} \\to b_{i,0} \\), …… \\( b_{i-1,0} \\to b_{i,W_i-1} \\to \\cdots \\to b_{i,1} \\to b_{i,0} \\)，共 \\( W_i \\) 种，求和可得，\n\n\\[\nb_{i,0} = b_{i-1,0} * (p * 1/W_i + p * 1/W_i * 1 + \\ldots + p * 1/W_i * 1^{W_i-1}) = p * b_{i-1,0},\n\\]\n\n\\[\nb_{i,0} = p * b_{i-1,0} \\quad 0 < i \\leq r \\quad \\Rightarrow \\quad b_{i,0} = p^i * b_{0,0} \\quad 0 < i \\leq r\n\\]\n\n同理，对于任一状态 \\( b_{i,k} \\)，若 \\( 0 < i < r \\)，则是从一次发送失败的状态，通过竞争窗口加倍之后转移过来的。若 \\( i = 0 \\)，则是从任一阶发送成功，或达到重传次数限制后转移过来的。因此有，\n\n\\[\nb_{i,k} =\n\\begin{cases}\nb_{i-1,0} * p * \\frac{W_i - k}{W_i} & 0 < i < r \\\\\n(1 - p) * \\frac{W_i - k}{W_i} * \\sum_{j=0}^r b_{j,0} & i = 0\n\\end{cases}\n\\]\n\n将式 (5) 代入式 (6)，可得，\n\n\\[\nb_{i,k} = \\frac{W_i - k}{W_i} * b_{i,0} \\quad 0 \\leq i \\leq r, 0 \\leq k \\leq W_i - 1\n\\]\n\n根据 Markov chain 的性质，所有稳态的概率之和为 1，因此有，\n\n\\[\n1 = \\sum_{k=0}^{W_i-1} \\sum_{i=0}^r b_{i,k} = \\sum_{i=0}^r b_{i,0} \\sum_{k=0}^{W_i-1} \\frac{W_i - k}{W_i} = \\sum_{i=0}^r b_{i,0} \\frac{W_i + 1}{2}\n\\]\n\n根据式 (3) 和 (8)，可以求得：\n\n\\[\nb_{00} =\n\\begin{cases}\n\\frac{2(1-p)(1-2p)}{(1-2p)(1-p^{r+1}) + W_0(1-p)(1-(2p)^{r+1})} & r \\leq m \\\\\n\\frac{2(1-p)(1-2p)}{W_0(1-(2p)^{m+1})(1-p) + (1-2p)(1-p^{r+1}) + W_0 2^m p^{m+1} (1-p^{r-m})(1-2p)} & m < r\n\\end{cases}\n\\]\n\n节点随机回退到 0 时发送数据，因此节点在一个时隙发送数据帧的概率为\n\n\\[\n\\tau = \\sum_0^r b_{i,0} = b_{0,0} * \\frac{1-p^{r+1}}{1-p}\n\\]\n\n传输数据发生冲突时，至少有另外一个节点也传输数据，共有 \\( N \\) 个节点，因此条件碰撞概率 \\( p \\) 可表示为\n\n\\[\np = 1 - (1 - \\tau)^{N-1}\n\\]\n\n式 (10) 和 (11) 是关于 \\( p \\) 和 \\( \\tau \\) 的二元非线性方程，联立可求解。\n\n\\section{隐藏节点问题}\n\n隐藏节点是指在目的接收节点的通信区域内，而在其他发送节点的通信区域外的节点，这样由于和其他的发送节点互相听不到，会导致意外的同时传输而冲突的情况。如图 3.4 (a) 所示，单 BSS 场景中，STA1 和 STA2 分别能够与 AP 互听，而 STA1 和 STA2 相距较远。STA1 给 AP 发送上行数据时，随着距离的增加，信号衰减严重，STA2 接收到该信号的 RSSI 低于信道监听 CCA 门限，STA2 不在 STA1 的通信范围内，STA2 将无法感知到对方在给 AP 发送数据，判断信道为闲，因此，二者可能会同时或相继给 AP 发送数据，在接收节点 AP 处，来自STA1和STA2的电磁波信号混叠，AP无法正确解码，导致数据发送失败。隐藏节点问题是由CSMA/CA机制所引起的。图3.4（b）是两BSS场景，同理，由于AP1和AP2相距较远，分别不在对方的通信区域，因此可能会同时或相继给各自关联的STA发送数据。与单BSS不同的是，接收节点有两个，接收成功与否，与SIR有关。因为，当信号包先到时，接收机锁定Preamble，干扰包被视为干扰，SIR高则接收成功，否则失败；当干扰包先到时，接收机先锁定干扰包的Preamble，导致错过信号包的Preamble，则一定接收失败。\\section{通用参数列表}\\begin{table}\n\\centering\n\\begin{tabular}{|c|c|}\n\\hline\n参数名称 & 值 \\\\\n\\hline\nACK时长 & 32$\\mu$s \\\\\n\\hline\nSIFS时长 & 16$\\mu$s \\\\\n\\hline\nDIFS时长 & 43$\\mu$s \\\\\n\\hline\nSLOT时长 & 9$\\mu$s \\\\\n\\hline\nACK Timeout时长 & 65$\\mu$s \\\\\n\\hline\nCW min & 16 \\\\\n\\hline\nCW max & 1024 \\\\\n\\hline\n最大重传次数 & 32 \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n\\section{发包时长计算公式}\n\n\\begin{equation}\nt = t_{phy} + t_{mac\\ header} + t_{payload} = t_{phy} + \\frac{L_{mac\\ header} + payload}{rate}\n\\end{equation}\n\n\\section{问题3和4参数}\n\n\\begin{table}\n\\centering\n\\begin{tabular}{|c|c|c|c|c|c|}\n\\hline\nCW\\_min & 16 & 32 & 16 & 16 & 32 \\\\\n\\hline\nCW\\_max & 1024 & 1024 & 1024 & 1024 & 1024 \\\\\n\\hline\n最大重传次数 & 6 & 5 & 32 & 6 & 32 \\\\\n\\hline\n物理层速率 & 286.8Mbps & 286.8Mbps & 286.8Mbps & 158.4Mbps & 158.4Mbps \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n参考文献\n\n[1] Bianchi Gi$\\mu s$eppe. IEEE 802.11-Saturation Throughput Analysis [J]. IEEE Communications Letters, 1998, 2(12):318-320.\n\n[2] P. Chatzimisios, V. Vitsas and A. C. Boucouvalas, \"Throughput and delay analysis of IEEE 802.11 protocol,\" Proceedings 3rd IEEE International Workshop on System-on-Chip for Real-Time Applications, 2002, pp. 168-174, doi: 10.1109/IWNA.2002.1241355.\n\n[3] Hung, Fu-Yi, and Ivan Marsic. \"Performance analysis of the IEEE 802.11 DCF in the presence of the hidden stations.\" Computer Networks 54.15 (2010): 2674-2687.\n\n[4] D. R. Chen and Y. J. Zhang, \"Is Dynamic Backoff Effective for Multi-Rate WLANs?\" in IEEE Communications Letters, vol. 11, no. 8, pp. 647-649, Aug$\\mu s$t 2007",
  "problem": {
    "background": "\\section*{WLAN网络信道接入机制建模}\n\n\\subsection*{1. 背景}\n\n无线局域网（WLAN, wireless local area network）也即Wi-Fi广泛使用，提供低成本、高吞吐和便利的无线通信服务。基本服务集（BSS, basic service set）是WLAN的基本组成部分。处于某一特定覆盖区域内的站点（STA, station）与一个专职管理BSS的无线接入点（AP, access point）组成一个BSS，称STA关联到AP。常见的AP有无线路由器、WiFi热点等，手机、笔记本、物联设备等是STA。AP给STA发送数据叫作下行方向，反之是上行方向，本文将AP和STA统称为节点，每个节点的发送和接收不能同时发生。各节点共享信道，通过载波侦听多址接入/退避（CSMA/CA, carrier sense multi-access and collision avoidance）的机制避免冲突，称为分布式协调功能（DCF, distributed coordination function）。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=0.5\\textwidth]{wlan_network.png}\n    \\caption{1.1 WLAN网络}\n\\end{figure}\n\n\\subsection*{1.1 分布式信道接入和二进制指数退避}\n\nDCF机制提供了一种分布式、基于竞争的信道接入功能。可将每个节点接入信道进行数据传输的过程分为3个阶段，信道可用评估（CCA, clear channel assessment）、随机回退、数据传输。\n\n\\begin{enumerate}\n    \\item \\textbf{CCA：} 当一个节点打算发送时，首先进行一个固定时长的载波侦听，这个固定时长被称为DCF帧间距（DIFS, DCF inter-frame space），43μs。如果DIFS时段内接收到的信号能量强度（RSSI, received signal strength indication）低于CCA门限（-82dBm），判断信道为空闲，否则，判断信道为繁忙。\n    \\item \\textbf{随机回退：} 信道空闲时，可能有多个节点准备好了数据，为避免碰撞，节点从[0, CW-1]的均匀分布选取一个随机数作为回退数，等待该回退数个时隙长度slotTime（9μs），随机回退时段时长为回退数乘以slotTime。CW被称为竞争窗口（contention window）。如果信道在随机回退时段保持空闲，则节点开始一次数据传输。在随机回退时段节点持续监听信道，如果期间信道变繁忙，则节点将回退暂停，直到信道在一个DIFS时长重新变为空闲，再继续前面没有回退完的时间。\n    \\item \\textbf{数据传输：} 回退到0的节点发送一个数据帧，接收节点成功接收到数据之后等待短帧帧间距（SIFS, Short inter-frame space）16μs后，回复ACK确认帧（32μs）。如果发送节点收到ACK，则数据发送成功。如果发送数据帧没有被接收节点成功接收，或者ACK发送失败，或者ACK没有被发送节点收到，则数据传输失败，发送节点需要在等待超时后重传数据。等待超时时间ACKTimeout为65μs。\n\\end{enumerate}\n\n随机回退采用二进制指数退避算法确定回退时间。CW的初始值为$CW_{\\text{min}}$，每次数据传输失败后重传数据帧时，CW翻倍。如果CW达到了$CW_{\\text{max}}$，则保持此值，直到被重置为止。每次数据传输成功时CW重置，开始下一个数据帧的回退。若传输连续失败，重传次数达到r后，数据帧被丢弃，CW重置传输下一个数据帧。可见，重传r次时，无论成功还是失败，CW都会重置。\n\\subsection{基于Markov chain的DCF机制建模和系统性能分析}\n\n对于单BSS，$N$个STA给AP发送上行数据，Bianchi（1998）最早基于Markov chain建模。Bianchi模型假设理想信道，不因信道质量差而丢包。当2个及以上节点同时回退到0发送数据时，由于碰撞而丢包。那么信道可能处于三种状态：空闲、成功传输、碰撞，如图1.2所示。将每个状态看作一个虚拟时隙，那么信道在三种虚拟时隙中转化。将退避器所处的阶数和随机回退数用二维Markov chain表示，推导节点在每个虚拟时隙的发送概率$\\tau$和发生碰撞的条件概率$p$，从而评估BSS的吞吐[1]。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{channel_states.png}\n    \\caption{信道状态}\n    \\label{fig:channel_states}\n\\end{figure}\n\nBianchi模型获得了很高的精确度，很多工作在此基础上扩展，Chatzimisios（2002）研究了有最大重传次数限制的媒体接入控制（MAC，medium access control）层性能情况[2]。Huang和Ivan Marsic（2010）介绍了隐藏节点下网络模型和性能分析[3]。Chen（2007）分析了多速率MAC协议的性能[4]。基于Markov链求解$\\tau$和$p$的推导见附录和参考文献。\n\n吞吐是单位时间内发送数据有效载荷的比特数，单位bps。吞吐$S$可以由信道的利用率与物理层速率（单位bps）的乘积表示，\n\n\\begin{equation}\nS = \\frac{\\text{E[一个时隙内传输的有效载荷发送时长]}}{\\text{E[一个时隙长度]}} * \\text{物理层速率}\n\\tag{1}\n\\end{equation}\n\n信道处于三种虚拟时隙的概率可由$\\tau$和$p$表示，空闲时隙的长度$T_e$是slotTime。成功传输和碰撞的传输时长$T_s$和$T_c$分别表示为\n\n\\begin{align}\nT_s &= H + E[P] + SIFS + ACK + DIFS \\\\\nT_c &= H + E*[P] + DIFS + ACKTimeout\n\\tag{2}\n\\end{align}\n\n$H$为数据帧头，包括MAC层头和物理（PHY，physical）层头，E[P]为数据帧的有效载荷传输时长，E*[P]为发生冲突时较长数据帧的有效载荷传输时长，假设所有节点的数据帧长度一样，则E[P]与E*[P]相等。PHY头时长固定，MAC头和有效载荷的发送时长由其字节长度除以物理层速率得到。",
    "problem_requirement": "\\section{WLAN组网中的多BSS建模问题}\n\n节点发送数据后，电磁波信号在自由空间中传播，随着距离的增加，能量衰减越严重。周围节点收到该信号后，根据RSSI是否高于CCA门限，判断信道为忙或闲。一个节点发出信号的RSSI高于CCA门限的区域叫作通信区域，位于该通信区域内的节点与该发送节点互听。随着设备数量、应用类型、网络流量的飞速增长，AP部署日趋高密，如企业办公、工厂、教育场景。如图2.2（a）所示，将信道号为36、44、52、60、149、157的六个信道分配给区域内12个BSS，由于可用信道数有限，不同的BSS复用同一个信道。同频AP（使用相同信道号的AP）之间通信区域存在重叠时，存在相互干扰问题，叫作同频干扰。同频干扰是WLAN组网最显著的干扰问题，本题不考虑异频干扰的情况。家庭或宿舍等单BSS场景中，STA距离AP较近，RSSI较强，互听，假设理想信道，不会因信道质量差而丢包，只有在2个及以上STA同时发送数据时导致碰撞而丢包。而在教学区等场景，同频多BSS场景的情况更复杂。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{ap_deployment.png}\n    \\caption{(a) AP密集部署 (b) 两同频BSS场景 (c) 三同频BSS场景}\n    \\label{fig:ap_deployment}\n\\end{figure}\n首先，并不是所有的节点之间都能互听。假定 AP 和 STA 的发射功率相同，由于节点间距离不同，信号衰减不同，因此 RSSI 不同。节点在 DIFS 时长侦听信号的 RSSI > CCA 门限时，节点才认为信道繁忙，否则认为信道空闲，启动随机回退，发送数据。其次，当有多个 BSS 的节点同时发送数据（叫作并发传输）时，其成功与否与信干比（SIR，signal to interference ratio）有关，若 SIR 足够高，则信号能被成功解调，若 SIR 很低，则信号解调失败。信干比是信号强度与干扰强度的比值，单位是 dB，RSSI 的单位是 dBm，则 SIR 可以用信号 RSSI 与干扰信号 RSSI 的差值表示，本文中不考虑环境噪声。\n\n发送节点间能否互听，并发传输时是否成功，是进行系统建模需要考虑的两个先决条件，前者决定了退避计数器能否回退，后者决定了一次并发传输是成功还是失败，从而直接影响成功、失败和空闲三种状态之间的转换。\n\n\\subsection*{2.1 两 BSS 互听}\n\n考虑 2 个 BSS 互听的场景，仅下行，即两个 AP 分别向各自关联的 STA 发送数据，如图 2.2（b）所示。以 AP1 -> STA1 方向的数据传输为例，其会受到相邻 BSS2 的干扰，对于 STA1 来说，AP1 -> STA1 是信号，AP2 -> STA1 是干扰。对于 AP2 -> STA2 情况类似。假设 ACK 一定能发送成功。根据节点之间的 RSSI 估算两个 AP 并发时的 SIR，考虑不同的情景进行建模。\n\n\\subsubsection*{问题 1：}\n\n假设 AP 发送包的载荷长度为 1500 Bytes（1 Byte = 8 bits），PHY 头时长为 13.6 μs，MAC 头为 30 Bytes，MAC 头和有效载荷采用物理层速率 455.8 Mbps 发送。AP 之间的 RSSI 为 -70 dBm。大部分时候只有一个 AP 能够接入信道，数据传输一定成功。当两个 AP 同时回退到 0 而同时发送数据时，存在同频干扰。假设并发时的 SIR 较低，导致两个 AP 的数据传输都失败。请对该 2BSS 系统进行建模，用数值分析方法求解，评估系统的吞吐。（参数参考附录 4，可编写仿真器验证模型精确度）\n\n\\subsubsection*{问题 2}\n\n假设两个 AP 采用物理层速率 275.3 Mbps 发送数据，并发时两个终端接收到数据的 SIR 较高，两个 AP 的数据传输都能成功。其他条件同问题 1。请对该 2BSS 系统进行建模，用数值分析方法求解，评估系统的吞吐。（参数参考附录 4，可编写仿真器验证模型精确度）\n\n\\subsection*{2.2 两 BSS 不互听}\n\n在 AP 密集部署时，同频 AP 之间的距离远，AP 间 RSSI 低于 CCA 门限，不互听。AP 认为信道空闲，因此总是在退避和发送数据。这是 Wi-Fi 里常见的隐藏节点问题，详见附录。可以预见的是，有很大概率出现二者同时或先后开始发送数据的情况。接收机解调信号时，PHY 头的前面部分码元用于 Wi-Fi 信号识别、频率纠错、定时等功能，叫作前导（Preamble）。如图 2.3 所示，当信号包先到时，接收机先解信号包的 Preamble 并锁定，干扰包被视为干扰，信号包是否接收成功由 SIR 决定；当干扰包先到时，接收机先锁定到干扰包的 Preamble，错过信号包的 Preamble，导致信号包无法解调。小信号屏蔽算法能有效解决这个问题，因为信号包 RSSI 一般大于邻小区的干扰包，接收机在信号包到达时转为锁定 RSSI 更大的信号包，此时信号包能否接收成功同样也由 SIR 决定。由此可以得知，在 SIR 比较小的情况下，如果信号包和干扰包在时间上有如图 2.3 的交叠时，一定会导致本次传输的失败。\\begin{table}\n\\centering\n\\begin{tabular}{c c c c c c c}\n\\hline\n信号 & PHY hdr & MAC hdr & Payload & 信号 & PHY hdr & MAC hdr & Payload \\\\\n\\hline\nPreamble & & & & Preamble & & & \\\\\n\\hline\n干扰 & PHY hdr & MAC hdr & Payload & 干扰 & PHY hdr & MAC hdr & Payload \\\\\n\\hline\n\\end{tabular}\n\\caption{图2.3 并发传输交叠示意图}\n\\end{table}\n\n\\section*{问题3}\n\n假设AP间RSSI为-90dBm，AP发送包的载荷长度为1500Bytes，PHY头时长为13.6，MAC头为30Bytes，MAC头和载荷采用物理层速率455.8Mbps发送。Bianchi模型假设理想信道，实际上，无线传输环境是复杂多变的，当有遮挡物或者人走动时，无线信道都可能会快速发生比较大的变化。实测发现，当仅有一个AP发送数据时，即便不存在邻BSS干扰，也会有10%以内不同程度的丢包。假设因信道质量导致的丢包率$P_e=10\\%$。当两个AP发包在时间上有交叠时，假设SIR比较小，会导致两个AP的发包均失败。请对该2BSS系统进行建模，尽量用数值分析方法求解，评估系统的吞吐。（参数参考附录4和6，可编写仿真器验证模型精确度）\n\n\\section*{2.3 三BSS}\n\n\\section*{问题4}\n\n考虑3BSS场景，如图2.2(c)所示，其中AP1与AP2之间，AP2与AP3之间RSSI均为-70dBm，AP1与AP3之间RSSI为-96dBm。该场景中，AP1与AP3不互听，AP2与两者都互听，可以预见的是，AP2的发送机会被AP1和AP3挤占。AP1与AP3由于不互听可能同时或先后发送数据。假设三个AP发送包的载荷长度为1500Bytes，PHY头时长为13.6$\\mu s$，MAC头为30Bytes，MAC头和载荷采用物理层速率455.8Mbps发送。假设AP1和AP3发包时间交叠时，SIR较大，两者发送均成功。请对该3BSS系统进行建模，尽量用数值分析方法求解，评估系统的吞吐。（参数参考附录4和6，可编写仿真器验证模型精确度）\n\n\\section*{缩略语}\n\n\\begin{itemize}\n    \\item AP: access point (无线接入点)\n    \\item ACK: Acknowledgement (确认)\n    \\item ACK Timeout: 确认超时\n    \\item BSS: basic service set (基本服务集)\n    \\item CCA: clear channel assessment (信道可用评估)\n    \\item CSMA/CA: carrier sense multi-access and collision avoidance (载波监听多址接入/退避)\n    \\item CW: contention window (竞争窗口)\n    \\item DCF: distributed coordination function (分布式协调功能)\n    \\item DIFS: DCF inter-frame space (DCF帧间距)\n    \\item MAC: medium access control (媒体控制)\n    \\item PHY: physical (物理层)\n    \\item RSSI: received signal strength indication (接收信号能量强度)\n    \\item SIFS: short inter-frame space (短帧间距)\n    \\item SIR: signal to interference ratio (信干比)\n    \\item STA: station (站点)\n    \\item WLAN: wireless local area network (无线局域网)\n\\end{itemize}\\section*{缩略语}\n\n\\begin{tabular}{|c|c|c|}\n\\hline\nAP & access point & 无线接入点 \\\\\n\\hline\nACK & Acknowledgement & 确认 \\\\\n\\hline\nACKTimeout &  & 确认超时 \\\\\n\\hline\nBSS & basic service set & 基本服务集 \\\\\n\\hline\nCCA & clear channel assessment & 信道可用性评估 \\\\\n\\hline\nCSMA/CA & carrier sense multi-access and collision avoidance & 载波监听多址接入退避 \\\\\n\\hline\nCW & contention window & 竞争窗口 \\\\\n\\hline\nDCF & distributed coordination function & 分布式协调功能 \\\\\n\\hline\nDIFS & DCF inter-frame space & DCF 帧间距 \\\\\n\\hline\nMAC & medium access control & 媒体控制 \\\\\n\\hline\nPHY & physical & 物理层 \\\\\n\\hline\nRSSI & received signal strength indication & 接收信号能量强度 \\\\\n\\hline\nSIFS & short inter-frame space & 短帧间距 \\\\\n\\hline\nSIR & signal to interference ratio & 信干比 \\\\\n\\hline\nSTA & station & 站点 \\\\\n\\hline\nWLAN & wireless local area network & 无线局域网 \\\\\n\\hline\n\\end{tabular}",
    "dataset_path": [],
    "dataset_description": {},
    "variable_description": [],
    "addendum": "\\section{随机回退}\n\n随机回退采用二进制指数退避算法确定回退时间。CW 的初始值为 $CW_{\\text{min}}$，每次数据传输失败后进行重传时，CW 翻倍。如果 CW 达到了 $CW_{\\text{max}}$，则保持此值，直到被重置为止。每次数据传输成功时 CW 重置，开始下一个数据帧的回退。若传输连续失败，重传次数达到 $r$ 后，数据帧被丢弃，CW 重置传输下一个数据帧。可见，重传 $r$ 次时，无论成功还是失败，CW 都会重置。\n\n图 3.1 以三个节点为例说明。图中 CW 表示当前阶竞争窗口大小，BO 表示随机回退过程时退避计数器从 $[0, CW-1]$ 随机选取的初始值。三个节点的 $CW_{\\text{min}}$ 分别是 8、16、32。开始时，Station c 在发送数据，信道繁忙，数据发送完成后，退避计数器重置。Station a、b 和 c 持续侦听信道 DIFS 时长，信道被检测为空闲，三者分别开始随机回退，都处于第 0 阶，竞争窗为 $[0, CW_{\\text{min}}-1]$。Station a 从 $[0, 7]$ 选择了一个随机数 7，需要回退 7 个 slotTime；Station b 则从 $[0, 15]$ 选择了随机数 12 回退；Station c 从 $[0, 31]$ 选择了随机数 16 回退；显然，Station a 最先回退到 0，抢占到信道，开始一次数据发送，此时，Station b 和 c 在其回退过程中由于侦听到信道繁忙，随机回退暂停。当 Station a 发送成功后，其竞争窗口重置，信道持续 DIFS 时长空闲后，Station a 重新从 $[0, 7]$ 选择随机数 5 回退，Station b 和 c 接着暂停前的回退数继续回退。本次 Station a 和 b 同时回退到 0，同时发送数据，由于冲突导致发送失败，接收节点将不会回复 ACK，Station a 和 b 在等待 ACKTimeout 后判断数据发送失败，进行重传，将竞争窗翻倍，再次侦听信道 DIFS 时长判断信道空闲后，Station a 从 $[0, 15]$ 选择随机数 11 回退，Station b 则从 $[0, 31]$ 选择随机数 9 回退。需要注意的是，图 3.1 中的一次传输 (Tx, transmission) 包含了发送一个数据包和接收一个 ACK，一次 collision 包含了发送一个数据包和等待 ACKTimeout 时长。帧序列如图 3.2 所示，一个数据帧包括 PHY 头、MAC 头和有效载荷 payload。\n\n\\begin{figure}[h]\n\\centering\n\\includegraphics[width=\\textwidth]{image1.png}\n\\caption{二进制指数退避过程}\n\\end{figure}\n\n\\begin{figure}[h]\n\\centering\n\\includegraphics[width=\\textwidth]{image2.png}\n\\caption{帧序列}\n\\end{figure}\n\n\\section{2 Bianchi 模型}\n\n令 $b(t)$ 和 $s(t)$ 代表 $t$ 时刻一个节点退避随机过程的退避计数和退避阶数，这里的 $t$ 是一个离散的虚拟时隙的开始时刻。用 $i$ 表示一个数据的发送次数，也叫作阶数，$r$ 为最大重传次数，$m$ 是最大退避阶数，则 CW 可用下式表示：\n\\begin{equation}\n\\begin{cases}\nW_i = 2^i W_0 & 0 \\leq i \\leq m \\\\\nW_i = 2^m W_0 & m \\leq i \\leq r\n\\end{cases}\n\\tag{3}\n\\end{equation}\n\n二维 $\\{b(t), s(t)\\}$ 随机过程可以用二维 Markov chain 表示，如图 3.3 所示。$b_{i,k} = \\lim_{t \\to \\infty} P\\{s(t) = i, b(t) = k\\}$ 代表二维 Markov chain 的稳态解，$i \\in [0, m]$, $k \\in [0, W_i - 1]$。\n\n\\begin{figure}[h]\n\\centering\n\\includegraphics[width=\\textwidth]{markov_chain_diagram.png}\n\\caption{DCF 的 Markov 链模型}\n\\end{figure}\n\n$p$ 为某个时隙发生碰撞的概率，Markov chain 一步状态转移概率为：\n\\begin{equation}\n\\begin{aligned}\nP\\{i, k | i, k+1\\} &= 1 & k \\in [0, W_i - 2] & i \\in [0, r] \\\\\nP\\{0, k | i, 0\\} &= (1-p)/W_0 & k \\in [0, W_0 - 1] & i \\in [0, r] \\\\\nP\\{i, k | i-1, 0\\} &= p/W_i & k \\in [0, W_i - 1] & i \\in [1, r] \\\\\nP\\{0, k | r, 0\\} &= 1/W_0 & k \\in [0, W_0 - 1] &\n\\end{aligned}\n\\tag{4}\n\\end{equation}\n\n式 (4) 中每个式子分别代表一定的物理含义。第一个等式代表，未达到重传上限时，退避计数器在每个空闲时隙的开始时刻减 1 的概率是 1。第二个等式代表，未达到重传上限时，当一个数据成功传输后，新到达的数据在 $[0, W_0 - 1]$ 中等概率选一个随机数进行回退。第三个等式代表，未达到重传上限时，当一个数据第 $i-1$ 次传输过程发生碰撞，节点进入第 $i$ 阶回退过程，并在 $[0, W_i - 1]$ 中等概率选一个随机数进行回退。最后一个等式代表，当节点到达最大的传输次数以后，无论成功还是失败，CW 都会重置。\n\n该 Markov chain 的任意状态之间可达，是不可约的。任意状态到另一状态的步长不存在周期。从任何状态出发，都能到达另一状态，具有常返性。因此该二进制退避过程的非周期不可约 Markov chain 具有稳态解，且所有稳态的概率之和为 1。\n令 \\( b_{i,k} = \\lim_{t \\to \\infty} P\\{s(t) = i, b(t) = k\\}, i \\in (0, m), k \\in (0, W_i - 1) \\) 表示 Markov chain 的稳态解，从图 3.3 中可以看出，对于一次发送失败的情况，状态 \\( b_{i-1,0} \\) 到状态 \\( b_{i,0} \\) 的步长包括， \\( b_{i-1,0} \\to b_{i,0} \\), \\( b_{i-1,0} \\to b_{i,1} \\to b_{i,0} \\), …… \\( b_{i-1,0} \\to b_{i,W_i-1} \\to \\cdots \\to b_{i,1} \\to b_{i,0} \\)，共 \\( W_i \\) 种，求和可得，\n\n\\[\nb_{i,0} = b_{i-1,0} * (p * 1/W_i + p * 1/W_i * 1 + \\ldots + p * 1/W_i * 1^{W_i-1}) = p * b_{i-1,0},\n\\]\n\n\\[\nb_{i,0} = p * b_{i-1,0} \\quad 0 < i \\leq r \\quad \\Rightarrow \\quad b_{i,0} = p^i * b_{0,0} \\quad 0 < i \\leq r\n\\]\n\n同理，对于任一状态 \\( b_{i,k} \\)，若 \\( 0 < i < r \\)，则是从一次发送失败的状态，通过竞争窗口加倍之后转移过来的。若 \\( i = 0 \\)，则是从任一阶发送成功，或达到重传次数限制后转移过来的。因此有，\n\n\\[\nb_{i,k} =\n\\begin{cases}\nb_{i-1,0} * p * \\frac{W_i - k}{W_i} & 0 < i < r \\\\\n(1 - p) * \\frac{W_i - k}{W_i} * \\sum_{j=0}^r b_{j,0} & i = 0\n\\end{cases}\n\\]\n\n将式 (5) 代入式 (6)，可得，\n\n\\[\nb_{i,k} = \\frac{W_i - k}{W_i} * b_{i,0} \\quad 0 \\leq i \\leq r, 0 \\leq k \\leq W_i - 1\n\\]\n\n根据 Markov chain 的性质，所有稳态的概率之和为 1，因此有，\n\n\\[\n1 = \\sum_{k=0}^{W_i-1} \\sum_{i=0}^r b_{i,k} = \\sum_{i=0}^r b_{i,0} \\sum_{k=0}^{W_i-1} \\frac{W_i - k}{W_i} = \\sum_{i=0}^r b_{i,0} \\frac{W_i + 1}{2}\n\\]\n\n根据式 (3) 和 (8)，可以求得：\n\n\\[\nb_{00} =\n\\begin{cases}\n\\frac{2(1-p)(1-2p)}{(1-2p)(1-p^{r+1}) + W_0(1-p)(1-(2p)^{r+1})} & r \\leq m \\\\\n\\frac{2(1-p)(1-2p)}{W_0(1-(2p)^{m+1})(1-p) + (1-2p)(1-p^{r+1}) + W_0 2^m p^{m+1} (1-p^{r-m})(1-2p)} & m < r\n\\end{cases}\n\\]\n\n节点随机回退到 0 时发送数据，因此节点在一个时隙发送数据帧的概率为\n\n\\[\n\\tau = \\sum_0^r b_{i,0} = b_{0,0} * \\frac{1-p^{r+1}}{1-p}\n\\]\n\n传输数据发生冲突时，至少有另外一个节点也传输数据，共有 \\( N \\) 个节点，因此条件碰撞概率 \\( p \\) 可表示为\n\n\\[\np = 1 - (1 - \\tau)^{N-1}\n\\]\n\n式 (10) 和 (11) 是关于 \\( p \\) 和 \\( \\tau \\) 的二元非线性方程，联立可求解。\n\n\\section{隐藏节点问题}\n\n隐藏节点是指在目的接收节点的通信区域内，而在其他发送节点的通信区域外的节点，这样由于和其他的发送节点互相听不到，会导致意外的同时传输而冲突的情况。如图 3.4 (a) 所示，单 BSS 场景中，STA1 和 STA2 分别能够与 AP 互听，而 STA1 和 STA2 相距较远。STA1 给 AP 发送上行数据时，随着距离的增加，信号衰减严重，STA2 接收到该信号的 RSSI 低于信道监听 CCA 门限，STA2 不在 STA1 的通信范围内，STA2 将无法感知到对方在给 AP 发送数据，判断信道为闲，因此，二者可能会同时或相继给 AP 发送数据，在接收节点 AP 处，来自STA1和STA2的电磁波信号混叠，AP无法正确解码，导致数据发送失败。隐藏节点问题是由CSMA/CA机制所引起的。图3.4（b）是两BSS场景，同理，由于AP1和AP2相距较远，分别不在对方的通信区域，因此可能会同时或相继给各自关联的STA发送数据。与单BSS不同的是，接收节点有两个，接收成功与否，与SIR有关。因为，当信号包先到时，接收机锁定Preamble，干扰包被视为干扰，SIR高则接收成功，否则失败；当干扰包先到时，接收机先锁定干扰包的Preamble，导致错过信号包的Preamble，则一定接收失败。\\section{通用参数列表}\\begin{table}\n\\centering\n\\begin{tabular}{|c|c|}\n\\hline\n参数名称 & 值 \\\\\n\\hline\nACK时长 & 32$\\mu$s \\\\\n\\hline\nSIFS时长 & 16$\\mu$s \\\\\n\\hline\nDIFS时长 & 43$\\mu$s \\\\\n\\hline\nSLOT时长 & 9$\\mu$s \\\\\n\\hline\nACK Timeout时长 & 65$\\mu$s \\\\\n\\hline\nCW min & 16 \\\\\n\\hline\nCW max & 1024 \\\\\n\\hline\n最大重传次数 & 32 \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n\\section{发包时长计算公式}\n\n\\begin{equation}\nt = t_{phy} + t_{mac\\ header} + t_{payload} = t_{phy} + \\frac{L_{mac\\ header} + payload}{rate}\n\\end{equation}\n\n\\section{问题3和4参数}\n\n\\begin{table}\n\\centering\n\\begin{tabular}{|c|c|c|c|c|c|}\n\\hline\nCW\\_min & 16 & 32 & 16 & 16 & 32 \\\\\n\\hline\nCW\\_max & 1024 & 1024 & 1024 & 1024 & 1024 \\\\\n\\hline\n最大重传次数 & 6 & 5 & 32 & 6 & 32 \\\\\n\\hline\n物理层速率 & 286.8Mbps & 286.8Mbps & 286.8Mbps & 158.4Mbps & 158.4Mbps \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n参考文献\n\n[1] Bianchi Gi$\\mu s$eppe. IEEE 802.11-Saturation Throughput Analysis [J]. IEEE Communications Letters, 1998, 2(12):318-320.\n\n[2] P. Chatzimisios, V. Vitsas and A. C. Boucouvalas, \"Throughput and delay analysis of IEEE 802.11 protocol,\" Proceedings 3rd IEEE International Workshop on System-on-Chip for Real-Time Applications, 2002, pp. 168-174, doi: 10.1109/IWNA.2002.1241355.\n\n[3] Hung, Fu-Yi, and Ivan Marsic. \"Performance analysis of the IEEE 802.11 DCF in the presence of the hidden stations.\" Computer Networks 54.15 (2010): 2674-2687.\n\n[4] D. R. Chen and Y. J. Zhang, \"Is Dynamic Backoff Effective for Multi-Rate WLANs?\" in IEEE Communications Letters, vol. 11, no. 8, pp. 647-649, Aug$\\mu s$t 2007",
    "data_summary": "",
    "data_description": {},
    "problem_str": "问题背景：\n\\section*{WLAN网络信道接入机制建模}\n\n\\subsection*{1. 背景}\n\n无线局域网（WLAN, wireless local area network）也即Wi-Fi广泛使用，提供低成本、高吞吐和便利的无线通信服务。基本服务集（BSS, basic service set）是WLAN的基本组成部分。处于某一特定覆盖区域内的站点（STA, station）与一个专职管理BSS的无线接入点（AP, access point）组成一个BSS，称STA关联到AP。常见的AP有无线路由器、WiFi热点等，手机、笔记本、物联设备等是STA。AP给STA发送数据叫作下行方向，反之是上行方向，本文将AP和STA统称为节点，每个节点的发送和接收不能同时发生。各节点共享信道，通过载波侦听多址接入/退避（CSMA/CA, carrier sense multi-access and collision avoidance）的机制避免冲突，称为分布式协调功能（DCF, distributed coordination function）。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=0.5\\textwidth]{wlan_network.png}\n    \\caption{1.1 WLAN网络}\n\\end{figure}\n\n\\subsection*{1.1 分布式信道接入和二进制指数退避}\n\nDCF机制提供了一种分布式、基于竞争的信道接入功能。可将每个节点接入信道进行数据传输的过程分为3个阶段，信道可用评估（CCA, clear channel assessment）、随机回退、数据传输。\n\n\\begin{enumerate}\n    \\item \\textbf{CCA：} 当一个节点打算发送时，首先进行一个固定时长的载波侦听，这个固定时长被称为DCF帧间距（DIFS, DCF inter-frame space），43μs。如果DIFS时段内接收到的信号能量强度（RSSI, received signal strength indication）低于CCA门限（-82dBm），判断信道为空闲，否则，判断信道为繁忙。\n    \\item \\textbf{随机回退：} 信道空闲时，可能有多个节点准备好了数据，为避免碰撞，节点从[0, CW-1]的均匀分布选取一个随机数作为回退数，等待该回退数个时隙长度slotTime（9μs），随机回退时段时长为回退数乘以slotTime。CW被称为竞争窗口（contention window）。如果信道在随机回退时段保持空闲，则节点开始一次数据传输。在随机回退时段节点持续监听信道，如果期间信道变繁忙，则节点将回退暂停，直到信道在一个DIFS时长重新变为空闲，再继续前面没有回退完的时间。\n    \\item \\textbf{数据传输：} 回退到0的节点发送一个数据帧，接收节点成功接收到数据之后等待短帧帧间距（SIFS, Short inter-frame space）16μs后，回复ACK确认帧（32μs）。如果发送节点收到ACK，则数据发送成功。如果发送数据帧没有被接收节点成功接收，或者ACK发送失败，或者ACK没有被发送节点收到，则数据传输失败，发送节点需要在等待超时后重传数据。等待超时时间ACKTimeout为65μs。\n\\end{enumerate}\n\n随机回退采用二进制指数退避算法确定回退时间。CW的初始值为$CW_{\\text{min}}$，每次数据传输失败后重传数据帧时，CW翻倍。如果CW达到了$CW_{\\text{max}}$，则保持此值，直到被重置为止。每次数据传输成功时CW重置，开始下一个数据帧的回退。若传输连续失败，重传次数达到r后，数据帧被丢弃，CW重置传输下一个数据帧。可见，重传r次时，无论成功还是失败，CW都会重置。\n\\subsection{基于Markov chain的DCF机制建模和系统性能分析}\n\n对于单BSS，$N$个STA给AP发送上行数据，Bianchi（1998）最早基于Markov chain建模。Bianchi模型假设理想信道，不因信道质量差而丢包。当2个及以上节点同时回退到0发送数据时，由于碰撞而丢包。那么信道可能处于三种状态：空闲、成功传输、碰撞，如图1.2所示。将每个状态看作一个虚拟时隙，那么信道在三种虚拟时隙中转化。将退避器所处的阶数和随机回退数用二维Markov chain表示，推导节点在每个虚拟时隙的发送概率$\\tau$和发生碰撞的条件概率$p$，从而评估BSS的吞吐[1]。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{channel_states.png}\n    \\caption{信道状态}\n    \\label{fig:channel_states}\n\\end{figure}\n\nBianchi模型获得了很高的精确度，很多工作在此基础上扩展，Chatzimisios（2002）研究了有最大重传次数限制的媒体接入控制（MAC，medium access control）层性能情况[2]。Huang和Ivan Marsic（2010）介绍了隐藏节点下网络模型和性能分析[3]。Chen（2007）分析了多速率MAC协议的性能[4]。基于Markov链求解$\\tau$和$p$的推导见附录和参考文献。\n\n吞吐是单位时间内发送数据有效载荷的比特数，单位bps。吞吐$S$可以由信道的利用率与物理层速率（单位bps）的乘积表示，\n\n\\begin{equation}\nS = \\frac{\\text{E[一个时隙内传输的有效载荷发送时长]}}{\\text{E[一个时隙长度]}} * \\text{物理层速率}\n\\tag{1}\n\\end{equation}\n\n信道处于三种虚拟时隙的概率可由$\\tau$和$p$表示，空闲时隙的长度$T_e$是slotTime。成功传输和碰撞的传输时长$T_s$和$T_c$分别表示为\n\n\\begin{align}\nT_s &= H + E[P] + SIFS + ACK + DIFS \\\\\nT_c &= H + E*[P] + DIFS + ACKTimeout\n\\tag{2}\n\\end{align}\n\n$H$为数据帧头，包括MAC层头和物理（PHY，physical）层头，E[P]为数据帧的有效载荷传输时长，E*[P]为发生冲突时较长数据帧的有效载荷传输时长，假设所有节点的数据帧长度一样，则E[P]与E*[P]相等。PHY头时长固定，MAC头和有效载荷的发送时长由其字节长度除以物理层速率得到。\n\n问题要求：\n\\section{WLAN组网中的多BSS建模问题}\n\n节点发送数据后，电磁波信号在自由空间中传播，随着距离的增加，能量衰减越严重。周围节点收到该信号后，根据RSSI是否高于CCA门限，判断信道为忙或闲。一个节点发出信号的RSSI高于CCA门限的区域叫作通信区域，位于该通信区域内的节点与该发送节点互听。随着设备数量、应用类型、网络流量的飞速增长，AP部署日趋高密，如企业办公、工厂、教育场景。如图2.2（a）所示，将信道号为36、44、52、60、149、157的六个信道分配给区域内12个BSS，由于可用信道数有限，不同的BSS复用同一个信道。同频AP（使用相同信道号的AP）之间通信区域存在重叠时，存在相互干扰问题，叫作同频干扰。同频干扰是WLAN组网最显著的干扰问题，本题不考虑异频干扰的情况。家庭或宿舍等单BSS场景中，STA距离AP较近，RSSI较强，互听，假设理想信道，不会因信道质量差而丢包，只有在2个及以上STA同时发送数据时导致碰撞而丢包。而在教学区等场景，同频多BSS场景的情况更复杂。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{ap_deployment.png}\n    \\caption{(a) AP密集部署 (b) 两同频BSS场景 (c) 三同频BSS场景}\n    \\label{fig:ap_deployment}\n\\end{figure}\n首先，并不是所有的节点之间都能互听。假定 AP 和 STA 的发射功率相同，由于节点间距离不同，信号衰减不同，因此 RSSI 不同。节点在 DIFS 时长侦听信号的 RSSI > CCA 门限时，节点才认为信道繁忙，否则认为信道空闲，启动随机回退，发送数据。其次，当有多个 BSS 的节点同时发送数据（叫作并发传输）时，其成功与否与信干比（SIR，signal to interference ratio）有关，若 SIR 足够高，则信号能被成功解调，若 SIR 很低，则信号解调失败。信干比是信号强度与干扰强度的比值，单位是 dB，RSSI 的单位是 dBm，则 SIR 可以用信号 RSSI 与干扰信号 RSSI 的差值表示，本文中不考虑环境噪声。\n\n发送节点间能否互听，并发传输时是否成功，是进行系统建模需要考虑的两个先决条件，前者决定了退避计数器能否回退，后者决定了一次并发传输是成功还是失败，从而直接影响成功、失败和空闲三种状态之间的转换。\n\n\\subsection*{2.1 两 BSS 互听}\n\n考虑 2 个 BSS 互听的场景，仅下行，即两个 AP 分别向各自关联的 STA 发送数据，如图 2.2（b）所示。以 AP1 -> STA1 方向的数据传输为例，其会受到相邻 BSS2 的干扰，对于 STA1 来说，AP1 -> STA1 是信号，AP2 -> STA1 是干扰。对于 AP2 -> STA2 情况类似。假设 ACK 一定能发送成功。根据节点之间的 RSSI 估算两个 AP 并发时的 SIR，考虑不同的情景进行建模。\n\n\\subsubsection*{问题 1：}\n\n假设 AP 发送包的载荷长度为 1500 Bytes（1 Byte = 8 bits），PHY 头时长为 13.6 μs，MAC 头为 30 Bytes，MAC 头和有效载荷采用物理层速率 455.8 Mbps 发送。AP 之间的 RSSI 为 -70 dBm。大部分时候只有一个 AP 能够接入信道，数据传输一定成功。当两个 AP 同时回退到 0 而同时发送数据时，存在同频干扰。假设并发时的 SIR 较低，导致两个 AP 的数据传输都失败。请对该 2BSS 系统进行建模，用数值分析方法求解，评估系统的吞吐。（参数参考附录 4，可编写仿真器验证模型精确度）\n\n\\subsubsection*{问题 2}\n\n假设两个 AP 采用物理层速率 275.3 Mbps 发送数据，并发时两个终端接收到数据的 SIR 较高，两个 AP 的数据传输都能成功。其他条件同问题 1。请对该 2BSS 系统进行建模，用数值分析方法求解，评估系统的吞吐。（参数参考附录 4，可编写仿真器验证模型精确度）\n\n\\subsection*{2.2 两 BSS 不互听}\n\n在 AP 密集部署时，同频 AP 之间的距离远，AP 间 RSSI 低于 CCA 门限，不互听。AP 认为信道空闲，因此总是在退避和发送数据。这是 Wi-Fi 里常见的隐藏节点问题，详见附录。可以预见的是，有很大概率出现二者同时或先后开始发送数据的情况。接收机解调信号时，PHY 头的前面部分码元用于 Wi-Fi 信号识别、频率纠错、定时等功能，叫作前导（Preamble）。如图 2.3 所示，当信号包先到时，接收机先解信号包的 Preamble 并锁定，干扰包被视为干扰，信号包是否接收成功由 SIR 决定；当干扰包先到时，接收机先锁定到干扰包的 Preamble，错过信号包的 Preamble，导致信号包无法解调。小信号屏蔽算法能有效解决这个问题，因为信号包 RSSI 一般大于邻小区的干扰包，接收机在信号包到达时转为锁定 RSSI 更大的信号包，此时信号包能否接收成功同样也由 SIR 决定。由此可以得知，在 SIR 比较小的情况下，如果信号包和干扰包在时间上有如图 2.3 的交叠时，一定会导致本次传输的失败。\\begin{table}\n\\centering\n\\begin{tabular}{c c c c c c c}\n\\hline\n信号 & PHY hdr & MAC hdr & Payload & 信号 & PHY hdr & MAC hdr & Payload \\\\\n\\hline\nPreamble & & & & Preamble & & & \\\\\n\\hline\n干扰 & PHY hdr & MAC hdr & Payload & 干扰 & PHY hdr & MAC hdr & Payload \\\\\n\\hline\n\\end{tabular}\n\\caption{图2.3 并发传输交叠示意图}\n\\end{table}\n\n\\section*{问题3}\n\n假设AP间RSSI为-90dBm，AP发送包的载荷长度为1500Bytes，PHY头时长为13.6，MAC头为30Bytes，MAC头和载荷采用物理层速率455.8Mbps发送。Bianchi模型假设理想信道，实际上，无线传输环境是复杂多变的，当有遮挡物或者人走动时，无线信道都可能会快速发生比较大的变化。实测发现，当仅有一个AP发送数据时，即便不存在邻BSS干扰，也会有10%以内不同程度的丢包。假设因信道质量导致的丢包率$P_e=10\\%$。当两个AP发包在时间上有交叠时，假设SIR比较小，会导致两个AP的发包均失败。请对该2BSS系统进行建模，尽量用数值分析方法求解，评估系统的吞吐。（参数参考附录4和6，可编写仿真器验证模型精确度）\n\n\\section*{2.3 三BSS}\n\n\\section*{问题4}\n\n考虑3BSS场景，如图2.2(c)所示，其中AP1与AP2之间，AP2与AP3之间RSSI均为-70dBm，AP1与AP3之间RSSI为-96dBm。该场景中，AP1与AP3不互听，AP2与两者都互听，可以预见的是，AP2的发送机会被AP1和AP3挤占。AP1与AP3由于不互听可能同时或先后发送数据。假设三个AP发送包的载荷长度为1500Bytes，PHY头时长为13.6$\\mu s$，MAC头为30Bytes，MAC头和载荷采用物理层速率455.8Mbps发送。假设AP1和AP3发包时间交叠时，SIR较大，两者发送均成功。请对该3BSS系统进行建模，尽量用数值分析方法求解，评估系统的吞吐。（参数参考附录4和6，可编写仿真器验证模型精确度）\n\n\\section*{缩略语}\n\n\\begin{itemize}\n    \\item AP: access point (无线接入点)\n    \\item ACK: Acknowledgement (确认)\n    \\item ACK Timeout: 确认超时\n    \\item BSS: basic service set (基本服务集)\n    \\item CCA: clear channel assessment (信道可用评估)\n    \\item CSMA/CA: carrier sense multi-access and collision avoidance (载波监听多址接入/退避)\n    \\item CW: contention window (竞争窗口)\n    \\item DCF: distributed coordination function (分布式协调功能)\n    \\item DIFS: DCF inter-frame space (DCF帧间距)\n    \\item MAC: medium access control (媒体控制)\n    \\item PHY: physical (物理层)\n    \\item RSSI: received signal strength indication (接收信号能量强度)\n    \\item SIFS: short inter-frame space (短帧间距)\n    \\item SIR: signal to interference ratio (信干比)\n    \\item STA: station (站点)\n    \\item WLAN: wireless local area network (无线局域网)\n\\end{itemize}\\section*{缩略语}\n\n\\begin{tabular}{|c|c|c|}\n\\hline\nAP & access point & 无线接入点 \\\\\n\\hline\nACK & Acknowledgement & 确认 \\\\\n\\hline\nACKTimeout &  & 确认超时 \\\\\n\\hline\nBSS & basic service set & 基本服务集 \\\\\n\\hline\nCCA & clear channel assessment & 信道可用性评估 \\\\\n\\hline\nCSMA/CA & carrier sense multi-access and collision avoidance & 载波监听多址接入退避 \\\\\n\\hline\nCW & contention window & 竞争窗口 \\\\\n\\hline\nDCF & distributed coordination function & 分布式协调功能 \\\\\n\\hline\nDIFS & DCF inter-frame space & DCF 帧间距 \\\\\n\\hline\nMAC & medium access control & 媒体控制 \\\\\n\\hline\nPHY & physical & 物理层 \\\\\n\\hline\nRSSI & received signal strength indication & 接收信号能量强度 \\\\\n\\hline\nSIFS & short inter-frame space & 短帧间距 \\\\\n\\hline\nSIR & signal to interference ratio & 信干比 \\\\\n\\hline\nSTA & station & 站点 \\\\\n\\hline\nWLAN & wireless local area network & 无线局域网 \\\\\n\\hline\n\\end{tabular}\nAddendum: \n\\section{随机回退}\n\n随机回退采用二进制指数退避算法确定回退时间。CW 的初始值为 $CW_{\\text{min}}$，每次数据传输失败后进行重传时，CW 翻倍。如果 CW 达到了 $CW_{\\text{max}}$，则保持此值，直到被重置为止。每次数据传输成功时 CW 重置，开始下一个数据帧的回退。若传输连续失败，重传次数达到 $r$ 后，数据帧被丢弃，CW 重置传输下一个数据帧。可见，重传 $r$ 次时，无论成功还是失败，CW 都会重置。\n\n图 3.1 以三个节点为例说明。图中 CW 表示当前阶竞争窗口大小，BO 表示随机回退过程时退避计数器从 $[0, CW-1]$ 随机选取的初始值。三个节点的 $CW_{\\text{min}}$ 分别是 8、16、32。开始时，Station c 在发送数据，信道繁忙，数据发送完成后，退避计数器重置。Station a、b 和 c 持续侦听信道 DIFS 时长，信道被检测为空闲，三者分别开始随机回退，都处于第 0 阶，竞争窗为 $[0, CW_{\\text{min}}-1]$。Station a 从 $[0, 7]$ 选择了一个随机数 7，需要回退 7 个 slotTime；Station b 则从 $[0, 15]$ 选择了随机数 12 回退；Station c 从 $[0, 31]$ 选择了随机数 16 回退；显然，Station a 最先回退到 0，抢占到信道，开始一次数据发送，此时，Station b 和 c 在其回退过程中由于侦听到信道繁忙，随机回退暂停。当 Station a 发送成功后，其竞争窗口重置，信道持续 DIFS 时长空闲后，Station a 重新从 $[0, 7]$ 选择随机数 5 回退，Station b 和 c 接着暂停前的回退数继续回退。本次 Station a 和 b 同时回退到 0，同时发送数据，由于冲突导致发送失败，接收节点将不会回复 ACK，Station a 和 b 在等待 ACKTimeout 后判断数据发送失败，进行重传，将竞争窗翻倍，再次侦听信道 DIFS 时长判断信道空闲后，Station a 从 $[0, 15]$ 选择随机数 11 回退，Station b 则从 $[0, 31]$ 选择随机数 9 回退。需要注意的是，图 3.1 中的一次传输 (Tx, transmission) 包含了发送一个数据包和接收一个 ACK，一次 collision 包含了发送一个数据包和等待 ACKTimeout 时长。帧序列如图 3.2 所示，一个数据帧包括 PHY 头、MAC 头和有效载荷 payload。\n\n\\begin{figure}[h]\n\\centering\n\\includegraphics[width=\\textwidth]{image1.png}\n\\caption{二进制指数退避过程}\n\\end{figure}\n\n\\begin{figure}[h]\n\\centering\n\\includegraphics[width=\\textwidth]{image2.png}\n\\caption{帧序列}\n\\end{figure}\n\n\\section{2 Bianchi 模型}\n\n令 $b(t)$ 和 $s(t)$ 代表 $t$ 时刻一个节点退避随机过程的退避计数和退避阶数，这里的 $t$ 是一个离散的虚拟时隙的开始时刻。用 $i$ 表示一个数据的发送次数，也叫作阶数，$r$ 为最大重传次数，$m$ 是最大退避阶数，则 CW 可用下式表示：\n\\begin{equation}\n\\begin{cases}\nW_i = 2^i W_0 & 0 \\leq i \\leq m \\\\\nW_i = 2^m W_0 & m \\leq i \\leq r\n\\end{cases}\n\\tag{3}\n\\end{equation}\n\n二维 $\\{b(t), s(t)\\}$ 随机过程可以用二维 Markov chain 表示，如图 3.3 所示。$b_{i,k} = \\lim_{t \\to \\infty} P\\{s(t) = i, b(t) = k\\}$ 代表二维 Markov chain 的稳态解，$i \\in [0, m]$, $k \\in [0, W_i - 1]$。\n\n\\begin{figure}[h]\n\\centering\n\\includegraphics[width=\\textwidth]{markov_chain_diagram.png}\n\\caption{DCF 的 Markov 链模型}\n\\end{figure}\n\n$p$ 为某个时隙发生碰撞的概率，Markov chain 一步状态转移概率为：\n\\begin{equation}\n\\begin{aligned}\nP\\{i, k | i, k+1\\} &= 1 & k \\in [0, W_i - 2] & i \\in [0, r] \\\\\nP\\{0, k | i, 0\\} &= (1-p)/W_0 & k \\in [0, W_0 - 1] & i \\in [0, r] \\\\\nP\\{i, k | i-1, 0\\} &= p/W_i & k \\in [0, W_i - 1] & i \\in [1, r] \\\\\nP\\{0, k | r, 0\\} &= 1/W_0 & k \\in [0, W_0 - 1] &\n\\end{aligned}\n\\tag{4}\n\\end{equation}\n\n式 (4) 中每个式子分别代表一定的物理含义。第一个等式代表，未达到重传上限时，退避计数器在每个空闲时隙的开始时刻减 1 的概率是 1。第二个等式代表，未达到重传上限时，当一个数据成功传输后，新到达的数据在 $[0, W_0 - 1]$ 中等概率选一个随机数进行回退。第三个等式代表，未达到重传上限时，当一个数据第 $i-1$ 次传输过程发生碰撞，节点进入第 $i$ 阶回退过程，并在 $[0, W_i - 1]$ 中等概率选一个随机数进行回退。最后一个等式代表，当节点到达最大的传输次数以后，无论成功还是失败，CW 都会重置。\n\n该 Markov chain 的任意状态之间可达，是不可约的。任意状态到另一状态的步长不存在周期。从任何状态出发，都能到达另一状态，具有常返性。因此该二进制退避过程的非周期不可约 Markov chain 具有稳态解，且所有稳态的概率之和为 1。\n令 \\( b_{i,k} = \\lim_{t \\to \\infty} P\\{s(t) = i, b(t) = k\\}, i \\in (0, m), k \\in (0, W_i - 1) \\) 表示 Markov chain 的稳态解，从图 3.3 中可以看出，对于一次发送失败的情况，状态 \\( b_{i-1,0} \\) 到状态 \\( b_{i,0} \\) 的步长包括， \\( b_{i-1,0} \\to b_{i,0} \\), \\( b_{i-1,0} \\to b_{i,1} \\to b_{i,0} \\), …… \\( b_{i-1,0} \\to b_{i,W_i-1} \\to \\cdots \\to b_{i,1} \\to b_{i,0} \\)，共 \\( W_i \\) 种，求和可得，\n\n\\[\nb_{i,0} = b_{i-1,0} * (p * 1/W_i + p * 1/W_i * 1 + \\ldots + p * 1/W_i * 1^{W_i-1}) = p * b_{i-1,0},\n\\]\n\n\\[\nb_{i,0} = p * b_{i-1,0} \\quad 0 < i \\leq r \\quad \\Rightarrow \\quad b_{i,0} = p^i * b_{0,0} \\quad 0 < i \\leq r\n\\]\n\n同理，对于任一状态 \\( b_{i,k} \\)，若 \\( 0 < i < r \\)，则是从一次发送失败的状态，通过竞争窗口加倍之后转移过来的。若 \\( i = 0 \\)，则是从任一阶发送成功，或达到重传次数限制后转移过来的。因此有，\n\n\\[\nb_{i,k} =\n\\begin{cases}\nb_{i-1,0} * p * \\frac{W_i - k}{W_i} & 0 < i < r \\\\\n(1 - p) * \\frac{W_i - k}{W_i} * \\sum_{j=0}^r b_{j,0} & i = 0\n\\end{cases}\n\\]\n\n将式 (5) 代入式 (6)，可得，\n\n\\[\nb_{i,k} = \\frac{W_i - k}{W_i} * b_{i,0} \\quad 0 \\leq i \\leq r, 0 \\leq k \\leq W_i - 1\n\\]\n\n根据 Markov chain 的性质，所有稳态的概率之和为 1，因此有，\n\n\\[\n1 = \\sum_{k=0}^{W_i-1} \\sum_{i=0}^r b_{i,k} = \\sum_{i=0}^r b_{i,0} \\sum_{k=0}^{W_i-1} \\frac{W_i - k}{W_i} = \\sum_{i=0}^r b_{i,0} \\frac{W_i + 1}{2}\n\\]\n\n根据式 (3) 和 (8)，可以求得：\n\n\\[\nb_{00} =\n\\begin{cases}\n\\frac{2(1-p)(1-2p)}{(1-2p)(1-p^{r+1}) + W_0(1-p)(1-(2p)^{r+1})} & r \\leq m \\\\\n\\frac{2(1-p)(1-2p)}{W_0(1-(2p)^{m+1})(1-p) + (1-2p)(1-p^{r+1}) + W_0 2^m p^{m+1} (1-p^{r-m})(1-2p)} & m < r\n\\end{cases}\n\\]\n\n节点随机回退到 0 时发送数据，因此节点在一个时隙发送数据帧的概率为\n\n\\[\n\\tau = \\sum_0^r b_{i,0} = b_{0,0} * \\frac{1-p^{r+1}}{1-p}\n\\]\n\n传输数据发生冲突时，至少有另外一个节点也传输数据，共有 \\( N \\) 个节点，因此条件碰撞概率 \\( p \\) 可表示为\n\n\\[\np = 1 - (1 - \\tau)^{N-1}\n\\]\n\n式 (10) 和 (11) 是关于 \\( p \\) 和 \\( \\tau \\) 的二元非线性方程，联立可求解。\n\n\\section{隐藏节点问题}\n\n隐藏节点是指在目的接收节点的通信区域内，而在其他发送节点的通信区域外的节点，这样由于和其他的发送节点互相听不到，会导致意外的同时传输而冲突的情况。如图 3.4 (a) 所示，单 BSS 场景中，STA1 和 STA2 分别能够与 AP 互听，而 STA1 和 STA2 相距较远。STA1 给 AP 发送上行数据时，随着距离的增加，信号衰减严重，STA2 接收到该信号的 RSSI 低于信道监听 CCA 门限，STA2 不在 STA1 的通信范围内，STA2 将无法感知到对方在给 AP 发送数据，判断信道为闲，因此，二者可能会同时或相继给 AP 发送数据，在接收节点 AP 处，来自STA1和STA2的电磁波信号混叠，AP无法正确解码，导致数据发送失败。隐藏节点问题是由CSMA/CA机制所引起的。图3.4（b）是两BSS场景，同理，由于AP1和AP2相距较远，分别不在对方的通信区域，因此可能会同时或相继给各自关联的STA发送数据。与单BSS不同的是，接收节点有两个，接收成功与否，与SIR有关。因为，当信号包先到时，接收机锁定Preamble，干扰包被视为干扰，SIR高则接收成功，否则失败；当干扰包先到时，接收机先锁定干扰包的Preamble，导致错过信号包的Preamble，则一定接收失败。\\section{通用参数列表}\\begin{table}\n\\centering\n\\begin{tabular}{|c|c|}\n\\hline\n参数名称 & 值 \\\\\n\\hline\nACK时长 & 32$\\mu$s \\\\\n\\hline\nSIFS时长 & 16$\\mu$s \\\\\n\\hline\nDIFS时长 & 43$\\mu$s \\\\\n\\hline\nSLOT时长 & 9$\\mu$s \\\\\n\\hline\nACK Timeout时长 & 65$\\mu$s \\\\\n\\hline\nCW min & 16 \\\\\n\\hline\nCW max & 1024 \\\\\n\\hline\n最大重传次数 & 32 \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n\\section{发包时长计算公式}\n\n\\begin{equation}\nt = t_{phy} + t_{mac\\ header} + t_{payload} = t_{phy} + \\frac{L_{mac\\ header} + payload}{rate}\n\\end{equation}\n\n\\section{问题3和4参数}\n\n\\begin{table}\n\\centering\n\\begin{tabular}{|c|c|c|c|c|c|}\n\\hline\nCW\\_min & 16 & 32 & 16 & 16 & 32 \\\\\n\\hline\nCW\\_max & 1024 & 1024 & 1024 & 1024 & 1024 \\\\\n\\hline\n最大重传次数 & 6 & 5 & 32 & 6 & 32 \\\\\n\\hline\n物理层速率 & 286.8Mbps & 286.8Mbps & 286.8Mbps & 158.4Mbps & 158.4Mbps \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n参考文献\n\n[1] Bianchi Gi$\\mu s$eppe. IEEE 802.11-Saturation Throughput Analysis [J]. IEEE Communications Letters, 1998, 2(12):318-320.\n\n[2] P. Chatzimisios, V. Vitsas and A. C. Boucouvalas, \"Throughput and delay analysis of IEEE 802.11 protocol,\" Proceedings 3rd IEEE International Workshop on System-on-Chip for Real-Time Applications, 2002, pp. 168-174, doi: 10.1109/IWNA.2002.1241355.\n\n[3] Hung, Fu-Yi, and Ivan Marsic. \"Performance analysis of the IEEE 802.11 DCF in the presence of the hidden stations.\" Computer Networks 54.15 (2010): 2674-2687.\n\n[4] D. R. Chen and Y. J. Zhang, \"Is Dynamic Backoff Effective for Multi-Rate WLANs?\" in IEEE Communications Letters, vol. 11, no. 8, pp. 647-649, Aug$\\mu s$t 2007"
  },
  "problem_background": "\\section*{WLAN网络信道接入机制建模}\n\n\\subsection*{1. 背景}\n\n无线局域网（WLAN, wireless local area network）也即Wi-Fi广泛使用，提供低成本、高吞吐和便利的无线通信服务。基本服务集（BSS, basic service set）是WLAN的基本组成部分。处于某一特定覆盖区域内的站点（STA, station）与一个专职管理BSS的无线接入点（AP, access point）组成一个BSS，称STA关联到AP。常见的AP有无线路由器、WiFi热点等，手机、笔记本、物联设备等是STA。AP给STA发送数据叫作下行方向，反之是上行方向，本文将AP和STA统称为节点，每个节点的发送和接收不能同时发生。各节点共享信道，通过载波侦听多址接入/退避（CSMA/CA, carrier sense multi-access and collision avoidance）的机制避免冲突，称为分布式协调功能（DCF, distributed coordination function）。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=0.5\\textwidth]{wlan_network.png}\n    \\caption{1.1 WLAN网络}\n\\end{figure}\n\n\\subsection*{1.1 分布式信道接入和二进制指数退避}\n\nDCF机制提供了一种分布式、基于竞争的信道接入功能。可将每个节点接入信道进行数据传输的过程分为3个阶段，信道可用评估（CCA, clear channel assessment）、随机回退、数据传输。\n\n\\begin{enumerate}\n    \\item \\textbf{CCA：} 当一个节点打算发送时，首先进行一个固定时长的载波侦听，这个固定时长被称为DCF帧间距（DIFS, DCF inter-frame space），43μs。如果DIFS时段内接收到的信号能量强度（RSSI, received signal strength indication）低于CCA门限（-82dBm），判断信道为空闲，否则，判断信道为繁忙。\n    \\item \\textbf{随机回退：} 信道空闲时，可能有多个节点准备好了数据，为避免碰撞，节点从[0, CW-1]的均匀分布选取一个随机数作为回退数，等待该回退数个时隙长度slotTime（9μs），随机回退时段时长为回退数乘以slotTime。CW被称为竞争窗口（contention window）。如果信道在随机回退时段保持空闲，则节点开始一次数据传输。在随机回退时段节点持续监听信道，如果期间信道变繁忙，则节点将回退暂停，直到信道在一个DIFS时长重新变为空闲，再继续前面没有回退完的时间。\n    \\item \\textbf{数据传输：} 回退到0的节点发送一个数据帧，接收节点成功接收到数据之后等待短帧帧间距（SIFS, Short inter-frame space）16μs后，回复ACK确认帧（32μs）。如果发送节点收到ACK，则数据发送成功。如果发送数据帧没有被接收节点成功接收，或者ACK发送失败，或者ACK没有被发送节点收到，则数据传输失败，发送节点需要在等待超时后重传数据。等待超时时间ACKTimeout为65μs。\n\\end{enumerate}\n\n随机回退采用二进制指数退避算法确定回退时间。CW的初始值为$CW_{\\text{min}}$，每次数据传输失败后重传数据帧时，CW翻倍。如果CW达到了$CW_{\\text{max}}$，则保持此值，直到被重置为止。每次数据传输成功时CW重置，开始下一个数据帧的回退。若传输连续失败，重传次数达到r后，数据帧被丢弃，CW重置传输下一个数据帧。可见，重传r次时，无论成功还是失败，CW都会重置。\n\\subsection{基于Markov chain的DCF机制建模和系统性能分析}\n\n对于单BSS，$N$个STA给AP发送上行数据，Bianchi（1998）最早基于Markov chain建模。Bianchi模型假设理想信道，不因信道质量差而丢包。当2个及以上节点同时回退到0发送数据时，由于碰撞而丢包。那么信道可能处于三种状态：空闲、成功传输、碰撞，如图1.2所示。将每个状态看作一个虚拟时隙，那么信道在三种虚拟时隙中转化。将退避器所处的阶数和随机回退数用二维Markov chain表示，推导节点在每个虚拟时隙的发送概率$\\tau$和发生碰撞的条件概率$p$，从而评估BSS的吞吐[1]。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{channel_states.png}\n    \\caption{信道状态}\n    \\label{fig:channel_states}\n\\end{figure}\n\nBianchi模型获得了很高的精确度，很多工作在此基础上扩展，Chatzimisios（2002）研究了有最大重传次数限制的媒体接入控制（MAC，medium access control）层性能情况[2]。Huang和Ivan Marsic（2010）介绍了隐藏节点下网络模型和性能分析[3]。Chen（2007）分析了多速率MAC协议的性能[4]。基于Markov链求解$\\tau$和$p$的推导见附录和参考文献。\n\n吞吐是单位时间内发送数据有效载荷的比特数，单位bps。吞吐$S$可以由信道的利用率与物理层速率（单位bps）的乘积表示，\n\n\\begin{equation}\nS = \\frac{\\text{E[一个时隙内传输的有效载荷发送时长]}}{\\text{E[一个时隙长度]}} * \\text{物理层速率}\n\\tag{1}\n\\end{equation}\n\n信道处于三种虚拟时隙的概率可由$\\tau$和$p$表示，空闲时隙的长度$T_e$是slotTime。成功传输和碰撞的传输时长$T_s$和$T_c$分别表示为\n\n\\begin{align}\nT_s &= H + E[P] + SIFS + ACK + DIFS \\\\\nT_c &= H + E*[P] + DIFS + ACKTimeout\n\\tag{2}\n\\end{align}\n\n$H$为数据帧头，包括MAC层头和物理（PHY，physical）层头，E[P]为数据帧的有效载荷传输时长，E*[P]为发生冲突时较长数据帧的有效载荷传输时长，假设所有节点的数据帧长度一样，则E[P]与E*[P]相等。PHY头时长固定，MAC头和有效载荷的发送时长由其字节长度除以物理层速率得到。",
  "problem_requirement": "\\section{WLAN组网中的多BSS建模问题}\n\n节点发送数据后，电磁波信号在自由空间中传播，随着距离的增加，能量衰减越严重。周围节点收到该信号后，根据RSSI是否高于CCA门限，判断信道为忙或闲。一个节点发出信号的RSSI高于CCA门限的区域叫作通信区域，位于该通信区域内的节点与该发送节点互听。随着设备数量、应用类型、网络流量的飞速增长，AP部署日趋高密，如企业办公、工厂、教育场景。如图2.2（a）所示，将信道号为36、44、52、60、149、157的六个信道分配给区域内12个BSS，由于可用信道数有限，不同的BSS复用同一个信道。同频AP（使用相同信道号的AP）之间通信区域存在重叠时，存在相互干扰问题，叫作同频干扰。同频干扰是WLAN组网最显著的干扰问题，本题不考虑异频干扰的情况。家庭或宿舍等单BSS场景中，STA距离AP较近，RSSI较强，互听，假设理想信道，不会因信道质量差而丢包，只有在2个及以上STA同时发送数据时导致碰撞而丢包。而在教学区等场景，同频多BSS场景的情况更复杂。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{ap_deployment.png}\n    \\caption{(a) AP密集部署 (b) 两同频BSS场景 (c) 三同频BSS场景}\n    \\label{fig:ap_deployment}\n\\end{figure}\n首先，并不是所有的节点之间都能互听。假定 AP 和 STA 的发射功率相同，由于节点间距离不同，信号衰减不同，因此 RSSI 不同。节点在 DIFS 时长侦听信号的 RSSI > CCA 门限时，节点才认为信道繁忙，否则认为信道空闲，启动随机回退，发送数据。其次，当有多个 BSS 的节点同时发送数据（叫作并发传输）时，其成功与否与信干比（SIR，signal to interference ratio）有关，若 SIR 足够高，则信号能被成功解调，若 SIR 很低，则信号解调失败。信干比是信号强度与干扰强度的比值，单位是 dB，RSSI 的单位是 dBm，则 SIR 可以用信号 RSSI 与干扰信号 RSSI 的差值表示，本文中不考虑环境噪声。\n\n发送节点间能否互听，并发传输时是否成功，是进行系统建模需要考虑的两个先决条件，前者决定了退避计数器能否回退，后者决定了一次并发传输是成功还是失败，从而直接影响成功、失败和空闲三种状态之间的转换。\n\n\\subsection*{2.1 两 BSS 互听}\n\n考虑 2 个 BSS 互听的场景，仅下行，即两个 AP 分别向各自关联的 STA 发送数据，如图 2.2（b）所示。以 AP1 -> STA1 方向的数据传输为例，其会受到相邻 BSS2 的干扰，对于 STA1 来说，AP1 -> STA1 是信号，AP2 -> STA1 是干扰。对于 AP2 -> STA2 情况类似。假设 ACK 一定能发送成功。根据节点之间的 RSSI 估算两个 AP 并发时的 SIR，考虑不同的情景进行建模。\n\n\\subsubsection*{问题 1：}\n\n假设 AP 发送包的载荷长度为 1500 Bytes（1 Byte = 8 bits），PHY 头时长为 13.6 μs，MAC 头为 30 Bytes，MAC 头和有效载荷采用物理层速率 455.8 Mbps 发送。AP 之间的 RSSI 为 -70 dBm。大部分时候只有一个 AP 能够接入信道，数据传输一定成功。当两个 AP 同时回退到 0 而同时发送数据时，存在同频干扰。假设并发时的 SIR 较低，导致两个 AP 的数据传输都失败。请对该 2BSS 系统进行建模，用数值分析方法求解，评估系统的吞吐。（参数参考附录 4，可编写仿真器验证模型精确度）\n\n\\subsubsection*{问题 2}\n\n假设两个 AP 采用物理层速率 275.3 Mbps 发送数据，并发时两个终端接收到数据的 SIR 较高，两个 AP 的数据传输都能成功。其他条件同问题 1。请对该 2BSS 系统进行建模，用数值分析方法求解，评估系统的吞吐。（参数参考附录 4，可编写仿真器验证模型精确度）\n\n\\subsection*{2.2 两 BSS 不互听}\n\n在 AP 密集部署时，同频 AP 之间的距离远，AP 间 RSSI 低于 CCA 门限，不互听。AP 认为信道空闲，因此总是在退避和发送数据。这是 Wi-Fi 里常见的隐藏节点问题，详见附录。可以预见的是，有很大概率出现二者同时或先后开始发送数据的情况。接收机解调信号时，PHY 头的前面部分码元用于 Wi-Fi 信号识别、频率纠错、定时等功能，叫作前导（Preamble）。如图 2.3 所示，当信号包先到时，接收机先解信号包的 Preamble 并锁定，干扰包被视为干扰，信号包是否接收成功由 SIR 决定；当干扰包先到时，接收机先锁定到干扰包的 Preamble，错过信号包的 Preamble，导致信号包无法解调。小信号屏蔽算法能有效解决这个问题，因为信号包 RSSI 一般大于邻小区的干扰包，接收机在信号包到达时转为锁定 RSSI 更大的信号包，此时信号包能否接收成功同样也由 SIR 决定。由此可以得知，在 SIR 比较小的情况下，如果信号包和干扰包在时间上有如图 2.3 的交叠时，一定会导致本次传输的失败。\\begin{table}\n\\centering\n\\begin{tabular}{c c c c c c c}\n\\hline\n信号 & PHY hdr & MAC hdr & Payload & 信号 & PHY hdr & MAC hdr & Payload \\\\\n\\hline\nPreamble & & & & Preamble & & & \\\\\n\\hline\n干扰 & PHY hdr & MAC hdr & Payload & 干扰 & PHY hdr & MAC hdr & Payload \\\\\n\\hline\n\\end{tabular}\n\\caption{图2.3 并发传输交叠示意图}\n\\end{table}\n\n\\section*{问题3}\n\n假设AP间RSSI为-90dBm，AP发送包的载荷长度为1500Bytes，PHY头时长为13.6，MAC头为30Bytes，MAC头和载荷采用物理层速率455.8Mbps发送。Bianchi模型假设理想信道，实际上，无线传输环境是复杂多变的，当有遮挡物或者人走动时，无线信道都可能会快速发生比较大的变化。实测发现，当仅有一个AP发送数据时，即便不存在邻BSS干扰，也会有10%以内不同程度的丢包。假设因信道质量导致的丢包率$P_e=10\\%$。当两个AP发包在时间上有交叠时，假设SIR比较小，会导致两个AP的发包均失败。请对该2BSS系统进行建模，尽量用数值分析方法求解，评估系统的吞吐。（参数参考附录4和6，可编写仿真器验证模型精确度）\n\n\\section*{2.3 三BSS}\n\n\\section*{问题4}\n\n考虑3BSS场景，如图2.2(c)所示，其中AP1与AP2之间，AP2与AP3之间RSSI均为-70dBm，AP1与AP3之间RSSI为-96dBm。该场景中，AP1与AP3不互听，AP2与两者都互听，可以预见的是，AP2的发送机会被AP1和AP3挤占。AP1与AP3由于不互听可能同时或先后发送数据。假设三个AP发送包的载荷长度为1500Bytes，PHY头时长为13.6$\\mu s$，MAC头为30Bytes，MAC头和载荷采用物理层速率455.8Mbps发送。假设AP1和AP3发包时间交叠时，SIR较大，两者发送均成功。请对该3BSS系统进行建模，尽量用数值分析方法求解，评估系统的吞吐。（参数参考附录4和6，可编写仿真器验证模型精确度）\n\n\\section*{缩略语}\n\n\\begin{itemize}\n    \\item AP: access point (无线接入点)\n    \\item ACK: Acknowledgement (确认)\n    \\item ACK Timeout: 确认超时\n    \\item BSS: basic service set (基本服务集)\n    \\item CCA: clear channel assessment (信道可用评估)\n    \\item CSMA/CA: carrier sense multi-access and collision avoidance (载波监听多址接入/退避)\n    \\item CW: contention window (竞争窗口)\n    \\item DCF: distributed coordination function (分布式协调功能)\n    \\item DIFS: DCF inter-frame space (DCF帧间距)\n    \\item MAC: medium access control (媒体控制)\n    \\item PHY: physical (物理层)\n    \\item RSSI: received signal strength indication (接收信号能量强度)\n    \\item SIFS: short inter-frame space (短帧间距)\n    \\item SIR: signal to interference ratio (信干比)\n    \\item STA: station (站点)\n    \\item WLAN: wireless local area network (无线局域网)\n\\end{itemize}\\section*{缩略语}\n\n\\begin{tabular}{|c|c|c|}\n\\hline\nAP & access point & 无线接入点 \\\\\n\\hline\nACK & Acknowledgement & 确认 \\\\\n\\hline\nACKTimeout &  & 确认超时 \\\\\n\\hline\nBSS & basic service set & 基本服务集 \\\\\n\\hline\nCCA & clear channel assessment & 信道可用性评估 \\\\\n\\hline\nCSMA/CA & carrier sense multi-access and collision avoidance & 载波监听多址接入退避 \\\\\n\\hline\nCW & contention window & 竞争窗口 \\\\\n\\hline\nDCF & distributed coordination function & 分布式协调功能 \\\\\n\\hline\nDIFS & DCF inter-frame space & DCF 帧间距 \\\\\n\\hline\nMAC & medium access control & 媒体控制 \\\\\n\\hline\nPHY & physical & 物理层 \\\\\n\\hline\nRSSI & received signal strength indication & 接收信号能量强度 \\\\\n\\hline\nSIFS & short inter-frame space & 短帧间距 \\\\\n\\hline\nSIR & signal to interference ratio & 信干比 \\\\\n\\hline\nSTA & station & 站点 \\\\\n\\hline\nWLAN & wireless local area network & 无线局域网 \\\\\n\\hline\n\\end{tabular}",
  "problem_analysis": "总体来看，这一套题目属于在物理层信号衰减与介质访问协议（IEEE 802.11 DCF）交互下对多 BSS（basic service set）网络性能（以吞吐为主要度量）的定量化建模与分析问题。其核心目标是把现实世界中由空间位置、发射功率与传播损耗决定的接收强度（RSSI）对载波感知（CCA）与并发传输成功概率（通过 SIR 或信号捕获决定）的影响，映射到介质接入层的随机退避行为与虚拟时隙状态转移上，从而用数值方法（解析固定点方程或数值求解、必要时辅以仿真校验）计算出每个 BSS 乃至整个系统的平均吞吐。这个目标决定了解题路径：以 Bianchi 的二维马尔可夫退避模型作为起点（因其在单一互听群体下对饱和流量下的行为给出了可求解的τ—p 固定点关系），并针对多 BSS 引入“信道感知图/冲突图”（谁能互听、谁是隐藏节点）和物理层的成功判据（基于固定 RSSI 和 SIR 阈值或概率的链路失包率）来修正碰撞概率的定义与状态持续时间（成功传输时长 T_s、碰撞时长 T_c）。在此框架下，分析思路是：首先用互听关系决定哪些节点的退避计数会因某一节点发送而暂停（从而影响竞争窗口退避过程和 τ 的计算），其次用并发发生时的物理判据（SIR 比较或捕获/前导时序规则）决定并发时的成功/失败组合概率，这两部分合成之后用 Renewal/占用率公式（公式(1)）或时隙模型估算链路吞吐。\n\n该问题描述同时隐含与显性地用了多项关键假设，这些假设既使问题在数学上可解也限制了解释的外推性，需要在模型构建和结果解释时加以明确并检验。首先常用的 Bianchi 假设（饱和流量、节点行为独立、恒定的条件碰撞概率 p、不考虑信道噪声而仅用其他节点活动导致冲突）在多 BSS、存在隐藏节点和异步捕获效应时会失效：隐藏节点会引入退避计数之间的时间相关性（因为两个互不感知的发送者的回退过程不再受对方停止而同步），捕获效应和时间重叠则使“至少另一个节点发送即为碰撞并失败”这一二元碰撞模型不成立；题目在不同问题里按需返回了两个极端简化：并发必然双失败与并发必然双成功，这实际上是把物理层判据替换为两个特定的 SIR 条件（或隐含阈值模型），这对解析很有帮助但须在结论中明确这些是特殊情形而不是普遍规律。此外，问题若引入了信道质量引起的独立丢包率 Pe（问题3），则又把物理随机性引入，即便单独发送也存在非零错误概率，意味着用于得到 τ 的成功概率要把链路层的信道丢包与 MAC 层碰撞共同考虑（复合失效概率），从而影响退避阶段的状态转移概率。其他可导致偏差的假设还包括 RSSI 的确定性（忽略快速衰落、阴影与人体移动），ACK 总是成功（在某些子题中假设这一点以简化分析），以及不同节点使用相同速率与包长、相同的 CW 初始与最大值等对称假设；这些都影响到解的可解释性，尤其是在要把结论应用到真实部署（有速率自适应、非饱和流量、多径衰落）时必须谨慎。\n\n在要把互听与干扰的空间关系纳入到 MAC 层马尔可夫模型时，最关键的建模元素是两张图：一张是载波感知图（carrier-sense graph），表征在听 DIFS 时若邻节点发送则会使退避暂停；另一张是干扰/解码成功图（interference graph 或物理 SINR 判据），表征当一组节点同时发送时，接收端能否在给定的接收功率差和到达时间次序下正确解码。两张图往往不同，前者决定竞争集（谁会相互影响 τ），后者决定在并发事件下的成功状态集合（进而决定 p 对应的失败概率与时隙内的有效负载长度）。这就引出潜在复杂性和张力：例如在三 BSS 场景（问题4）中，AP2 与两侧都互听而两侧互相不听到对方，AP2 的退避机会被两侧挤占，这种不均衡会导致显著的不公平性与吞吐分配扭曲；数学上要表达这种不均衡，必须放弃单一 τ、p 的同质假设，转而采用每节点 τ_i、p_i 的向量固定点方程，且 p_i 的表达要基于对“在节点 i 视角下同时发送的那些不会被其感知到（或会被感知但解码失败）的节点集合”的联合发送概率的精确或近似计算，这通常需要做条件独立性的近似（decoupling approximation）。如果网络规模较小（如题目中的 2–3 BSS），可以构造全局状态的 CTMC 或枚举并发模式来精确计算稳态概率并据此求吞吐，但状态空间随节点数呈指数增长，难以扩展；因此选择尺度适宜的方法是一项权衡：对小规模场景优先用精确枚举或带时间轴的仿真验证模型，对中等规模可用向量固定点迭代与近似（例如把隐藏节点的行为视为独立泊松流或用条件发送概率的乘积近似），对大规模场景则建议引入随机几何或统计均值场近似来获得可解释的全局指标。\n\n方法论上，解决这些子问题的可行数值路径有几类互补手段。第一类是解析/半解析的固定点方法：为每个节点写出基于其 CW 策略和条件碰撞概率的 τ_i 表达式（类似 Bianchi 的 b00 推导但对每个节点单独化），再把 p_i 写成关于其它节点 τ_j 的函数（注意 p_i 必须考虑哪些节点能被 i 感知以及并发发送时的物理成功概率），最后对 τ 向量与 p 向量做迭代求解这组非线性方程（常用不动点迭代、牛顿或混合方法）。第二类是精确的有限状态马尔可夫/排队模型：对少数节点枚举所有退避计数与发送/非发送状态，求稳态分布并计算吞吐，这是最为保守且可作基准的数值方法但计算量大。第三类是事件驱动仿真：实现 DCF 的细节（DIFS、SIFS、slot、ACKTimeout、前导时序与捕获规则、物理层速率）并在给定 RSSI 与噪声模型下直接测量吞吐，仿真可以验证假设并用来估计那些难以解析的捕获与时间依赖效应。实际建模建议是先用解析固定点/近似法获得快速可解释的结果，然后用仿真对关键场景（如问题 3 中引入 Pe 或问题 4 的不对称互听）进行验证并调整模型参数。\n\n关于时间动态性与长期效应，需要注意几点。首先 Bianchi 式的稳态分析假定饱和长流量与时间平稳，但现实网络中流量可能突发、用户移动会改变 RSSI、环境变化会改变 Pe，长时间尺度上的这些变化会导致模型参数（τ、p、成功时间占比）随时间漂移，因此稳态吞吐只是瞬时或平均的指标；若关心瞬时性能或延迟分布，需要用时变模型或仿真采样。其次退避机制的自适应（CW 指数增长与重置）在长时间中会引发周期性或近似 Markov 性的序列相关，尤其在隐藏节点诱发的多次碰撞序列中，CW 的膨胀/重置会引起短期内节点接入机会不均等，进而产生短期饥饿或长期公平性问题；这些效应在解析中通常被平均化而被掩盖。再次捕获效应与前导时序使得“先到先得”成为可能，从而打破对称性并放大空间上的不平等（强信号链路在并发中更容易胜出），这又提示在模型中必须明确是否采用二元碰撞模型或引入捕获概率函数。对模型的鲁棒性来说，强烈建议做灵敏度分析：对 RSSI、CCA 阈值、Pe 与 SIR 判决阈值做参数扫描，分析吞吐对这些输入的不确定性敏感度，从而识别哪些参数的测量或建模误差最会影响结论。\n\n从方法与视角多样性角度出发，可以考虑若干替代性表述：把问题从“给定若干固定节点算吞吐”转为“在随机部署下求平均吞吐”会引导至随机几何与均值场模型；把饱和假设改为随机到达的队列模型（例如 M/G/1 或离散时间队列耦合）会使得模型能预测延迟与丢包概率而非仅吞吐；把物理层从确定性 RSSI 改为包含随机衰落（瑞利/莱斯）与慢变阴影模型会使得并发成功概率需要通过积分或蒙特卡洛估计而非简单阈值判定。不同表述会影响所需数据（比如是否需要用户位置分布、阴影标准差、速率自适应算法的细节）以及解法的复杂度与可解释性。模型选择的权衡主要在于可解释性与精确性之间的取舍：简单的冲突图＋Bianchi 延伸易于解析且适合工程级估计，但在包含捕获、前导竞争与随机信道失真时容易误导；物理 SINR 模型结合时间轴精确仿真能够给出高度可信的预测但在参数估计与分析解释上代价高昂。\n\n最后要强调建模作为一种迭代过程的本质：初始应从最简单且可解析的扩展 Bianchi 模型入手（将每节点的 p_i 通过其不可感知节点的联合发送概率来修正），用数值不动点法求解并对关键场景给出定量结论；随后用事件驱动仿真在少数代表性场景（例如题中 2BSS 的三类假设与 3BSS 的非对称互听）进行验证，并把仿真结果用于校正模型中的捕获概率或并发成功概率的近似表达。对外推结论应附带不确定性度量（如参数敏感性、置信区间或在不同 Pe、RSSI 分布情形下的最坏/最好情形分析），并在可能时将模型预测与实测数据校准。只有通过这种解析—仿真—实测的循环，才能既保持数学上的可解性，又提升模型对现实部署的适用性与解释力。",
  "modeling_solution": "总体建模思路与目标。为把物理层的空间衰减与并发解调成功条件（RSSI → CCA 判断、SIR/capture → 并发成功概率、以及因信道质量引起的独立丢包）系统化地嵌入到 MAC 层的二进制指数退避（Bianchi）框架中，我提出一个可参数化的“物理—感知—MAC”耦合模型。该模型在保留 Bianchi 对退避过程解析优点的同时，放宽其同质互听与“任何并发即视为碰撞” 的强假设，通过明确区分“载波感知邻居”（carrier-sense neighbors）与“物理干扰集合/解码判据”（interferer set and decoding rule），并以集合枚举或概率近似来计算节点专属的发送概率 τ_i 与条件失败概率 p_i，从而可以用于精确枚举小规模（N ≤ 3~5）场景的吞吐，也可通过近似/均值场方法扩展到中等规模。模型保留饱和流量假设为基线（可后续放松到非饱和队列模型），并允许引入独立信道错误率 Pe、捕获效应与前导时序（preamble）导致的时间优先效应。\n\n关键假设（为解析可行而做的必要简化，且在结论处标注其影响与可替代扩展）。所有节点处于饱和发送状态（总有数据要发）。每个节点的 PHY 发射功率固定并已知，节点间大尺度路径损耗（及给定场景下每对发射—接收的 RSSI）可被视为确定值（可在更精细模型中替换为随机衰落）。载波感知门限 CCA 与 SIR 判决阈值（或捕获差值阈值）已知，用它们来决定感知与并发能否成功。退避过程仍按 Bianchi 的离散时隙视图，每个节点 i 的退避与回退计数遵守相同的 CW 算法，但允许每节点拥有不同的“视角”失败概率 p_i。节点在 DIFS 时段若检测到 RSSI > CCA 则暂停回退（载波感知）；若检测不到则继续。并发传输的成功判据在模型中以函数 Φ_i(T) 表示：当节点 i 在某时隙发包且其它同时发包的集合为 T 时，接收端能否成功解码 i 的包（0 或 1，或在更一般的随机化版本为 [0,1] 的成功概率）由该函数决定，Φ_i(T) 可基于 SIR、到达时间先后（preamble 抢占）与小信号屏蔽算法等物理规则来计算或估计。对时隙长度和信道占用时间采用“事件持续直到所有并发发射中最晚完成为止”的近似，即某一时隙若由一组 U 同时发起传输，则该时隙长度 T(U) = max_{j∈U} T_event_j，其中 T_event_j = T_sj（若 j 在其接收端被成功解码）或 T_cj（若 j 失败并经历 ACKTimeout）。该近似与实际中节点依赖感知导致的暂停/重启机制在小规模场景中足够精确，也能保留 Bianchi 的 renewal 思路去计算吞吐。\n\n变量与参数明确定义（模型构建的基本符号表）。 N 为节点总数（本问题以 N=2 或 N=3 为主），节点索引为 i ∈ {1,...,N}。τ_i 表示节点 i 在任意虚拟时隙开始时刻发送数据帧（即其回退计数为 0）的稳态概率。p_i 表示给定 i 在本时隙发包的条件下，i 的数据传输失败（即在接收端未收到 ACK）的概率。W_0 为初始竞争窗口 CW_min，W_i 为第 i 次重传时的窗口，按二进制指数退避规则给出。r 为最大重传次数，m 为到达 CW_max 的阶数（见 Bianchi 公式）。t_phy 为固定 PHY 头时长，L_mac 为 MAC 头字节数（或其发送时长 t_mac = L_mac / rate），payload（字节）与 rate（bps）决定 payload 时长。Slot 为 slotTime，DIFS、SIFS、ACK、ACKTimeout 等为给定常数。RSSI_{a→b} 表示发射方 a 在接收方 b 处的接收强度（dBm）；CCA_threshold 为载波感知门限（dBm）；SIR_threshold 或 capture_delta 定义物理层的成功判决（可为二元阈值或概率函 数）。Φ_i(T) 为当 i 发送且其他同时发送集合为 T 时的成功指示/概率（依赖 RSSI 与到达先后次序/捕获）。T_sj 与 T_cj 为 j 的成功与失败时隙持续时间（包含 DIFS/SIFS/ACK 等）。\n\n核心方程与耦合关系（将物理判据与 Bianchi 马尔可夫模型耦合）。 对任意节点 i，Bianchi 类推导可给出其 b_{i,0} 与 τ_i 的关系（当 p_i 为已知数时），具体可用标准公式（见 Bianchi 原式）写成 τ_i = f_Bianchi(p_i; W_0, m, r)。在本模型中我们允许每个节点有自己的 p_i，所以仍然可以写出节点专属的不动点表达。更具体地，τ_i = b_{i,0} * (1 - p_i^{r+1})/(1 - p_i)，其中 b_{i,0} 的闭式表达（依 p_i 与退避参数）可直接采用 Bianchi 给出的情况（r ≤ m 或 r > m 两种情形的表达式）。 物理—并发成功耦合通过条件成功函数 Φ_i(T) 进入 p_i 的表达。采用 decoupling（独立性近似）来写 p_i 为： p_i = 1 - ∑_{T ⊆ N\\{i}} [ Π_{j∈T} τ_j · Π_{k∈N\\{i} \\T} (1 - τ_k) · Φ_i(T) ] . 这里的求和把所有可能的“其它节点同时发包集合”枚举出来，基于假设“其他节点在该时隙是否发包相互独立且以其 τ_j 给定”的近似。等价的写法是 p_i = 1 - E_T[Φ_i(T)]，E_T 在其他节点的独立伯努利分布下取期望。 节点 i 在任意时隙发生“既发包又成功”的概率为 P_i^succ = τ_i · ∑_{T ⊆ N\\{i}} [ Π_{j∈T} τ_j · Π_{k∈N\\{i} \\T} (1 - τ_k) · Φ_i(T) ] 。整个系统的吞吐（单位 bps）可用 renewal 视角写为 S_total = ( ∑_{i} P_i^succ · L_payload_bits ) / E[slot_duration] ，其中 L_payload_bits = payload_bytes · 8。E[slot_duration] 可由所有可能同时发起集合 U 的概率与其对应的时隙持续时间 T(U) 加权得出： E[slot_duration] = P_idle · T_e + ∑_{U ⊆ N, U≠∅} P(U) · T(U) ，其中 P_idle = Π_{i}(1 - τ_i)，P(U) = Π_{j∈U} τ_j · Π_{k∉U} (1 - τ_k)，以及 T(U) = max_{j∈U} T_event_j，且 T_event_j = T_sj if Φ_j(U \\ {j}) = 1 else T_cj（在随机化 Φ 的情形，T(U) 取相应的期望）。该式在 N 小时可通过 2^N 枚举精确计算。\n\n物理层判据的具体形式（Φ_i(T) 的建模细节）。在最一般情形，Φ_i(T) 由两个因素决定：载波捕获/前导时序引起的“先到优先”效应与 SIR 判据。令 P_arrival_offset(j,i) 表示在两个几乎同时开始的发包中 j 的前导到达 i 的接收端先于 i 的概率（这可由启动时间分布/退避零时刻分布和包长决定；在独立时隙同步假设下可用离散时刻偏移枚举或用连续均匀近似计算）。若在接收端先到的信号被锁定，则后到的包即便信号更强也可能因错过前导而失败，除非小信号屏蔽机制允许切换到更强的信号（此时 compare RSSI 并按 capture_delta 决定是否切换）。基于这些物理规则， Φ_i(T) 可用如下算法化规则计算：先检查每个干扰源 j∈T 在接收端相对于 i 的到达次序，若存在某 j 先到且解调成功（以其对总干扰的 SIR 判断），则 i 肯定失败（Φ_i(T)=0）；否则如果 i 先到或系统允许切换到 i（capture），则令 Φ_i(T)=1 iff SIR_i = RSSI_{i→recv} - 10·log10(∑_{j∈T} 10^{RSSI_{j→recv}/10}) ≥ SIR_threshold (或满足 capture 规则)。在工程计算中常把该判据离散化为几类简单情形：完全捕获（若 i 的 RSSI 比所有干扰强 delta_dB，则成功）、完全无法捕获（任一并发即失败）或 SIR 阈值判定。对题中各子问题，可直接把 Φ_i(T) 固定为题设的情形（例如问题1 并发时双方必然失败，故 Φ_i({j})=0；问题2 并发时双方均成功，Φ_i({j})=1；问题3 单独发送仍有 Pe 丢包，则 Φ_i(∅)=1−Pe，Φ_i({j})=0；问题4 两侧 AP 并发且 SIR 较大则两者成功但 AP2 受挤占，Φ_i 可据题意赋值）。\n\n求解策略（数值不动点迭代与枚举或蒙特卡洛补充验证）。对给定的小规模场景（如 N=2 或 N=3），建议采用完全枚举法：初始化所有 τ_i 为某共同值（如 Bianchi 的同质解或 1/W_0），然后按以下步骤迭代直到收敛：第一步，用当前 τ 向量枚举所有子集 T，计算每个节点 i 的 p_i = 1 - ∑_T Prob(T | others) · Φ_i(T)（Prob(T | others) = Π_{j≠i} τ_j^{1_{j∈T}} (1-τ_j)^{1_{j∉T}}）。第二步，将所得 p_i 代入 Bianchi 的节点专属公式 τ_i = f_Bianchi(p_i; W_0,m,r)（可直接使用 b_{00} 闭式表达），得到新的 τ 向量。重复上述两步直到 ||τ^{(k+1)} − τ^{(k)}|| < ε（例如 ε = 1e−6）。收敛后，用最终 τ 向量计算 P_i^succ、E[slot_duration] 以及 S_total。该固定点迭代在小规模场景通常稳定；当出现震荡或多重不动点时可采用松弛因子（τ_new ← α τ_new + (1−α) τ_old，α∈(0,1)）或牛顿/混合方法加速。若场景中 Φ_i(T) 包含随机化（例如 Rayleigh 衰落或随机到达偏移），则在每次迭代内用蒙特卡洛评估 Φ_i 的期望或用数值积分（在参数已知下）直接计算 E_T[Φ_i(T)]。当 N 增长使 2^N 枚举不可行时，可以采用近似的“局部冲突集”方法：对每个节点 i 仅考虑对其影响显著的 K 个邻居（按 RSSI 阈值裁剪），并对远端节点采用平均活动概率来近似合并干扰，或使用均值场近似使 τ 的更新仅依赖于某些统计量（例如平均发送负载）。并行化实现非常直接：枚举各子集的概率及 T(U) 的计算可在并行线程中独立完成。\n\n特定场景的快速处理与对题目子问题的处理说明。 对问题1（两 BSS、455.8 Mbps、AP间 RSSI = −70 dBm、并发时双方均失败）：按两节点对称模型，用 N=2 的固定点方程简化为单个 τ，因为 τ_1 = τ_2，且 Φ_i(∅)=1，Φ_i({j})=0，p = 1 − (1 − τ)^{1} = τ，从 Bianchi 的闭式解求 τ，再计算吞吐 S = (2 · τ(1−τ) · L_payload_bits) / E[slot] ，其中 P_idle = (1−τ)^2，P(single transmission) = 2 τ(1−τ)，P(both) = τ^2，T_s 已知，T_c 取 collision 时长，E[slot] = P_idle · T_e + 2 τ(1−τ) · T_s + τ^2 · T_c。 对问题2（两 BSS、275.3 Mbps、并发时双方均成功）：同样对称，但 Φ_i({j})=1，因此 p = probability that at least one other node transmits and causes failure = 0 for N=2, p = 0 yields τ 从 Bianchi 的成功分支（CW 重置）计算，吞吐 S = (2 · τ · Π_{j≠i} (1−τ_j)?? 实际上若 Φ_i({j})=1，则当两个同时传输时两者都能成功，所以 P_i^succ = τ · [ (1−τ) + τ ] = τ，这意味着每个时隙若 i 发包则不一定阻止他人也成功；E[slot] 则需要按集合 U 考虑 T(U) = max(T_s_i, T_s_j)，即若同时成功时时隙被更长的传输占用。 对问题3（AP间 RSSI = −90 dBm，不互听，单独发送存在 Pe=10% 丢包，并发交叠导致双方均失败）：这里载波感知链路为独立回退（两节点退避不相互暂停），因此 decoupling 仍成立但载波感知集为空导致更高并发概率。Φ_i(∅)=1−Pe，Φ_i({j})=0。按照枚举方法计算 τ_i 等，注意 p_i 现在由物理丢包与并发叠加导致的失败共同构成；在表达上 p_i = 1 − [ (1−τ_j) · (1−Pe) + τ_j · 0 ] = 1 − (1−τ_j)(1−Pe) for N=2。 对问题4（三 BSS，AP1↔AP2 与 AP2↔AP3 RSSI=−70dBm，AP1↔AP3 RSSI=−96dBm，AP1、AP3 互不听但与 AP2 均互听；若 AP1 与 AP3 并发则两者可成功）：这是典型不对称感知/隐藏节点情形。用 N=3 的枚举解法但注意感知集影响 T(U) 与暂停行为：在 τ—p 的固定点中仍按独立发送近似计算其他节点发包分布，同时 Φ 函数应反映 AP1 与 AP3 的并发可共存（Φ_1({3}) = 1, Φ_3({1}) = 1），而 AP2 在与任一侧并发时将失败（或依题意由 SIR 决定）。其结果将显示 AP2 的有效发送机会被左右两侧的活动压缩（吞吐不均），在求解时需要精确枚举所有 2^3=8 子集来得到 E[slot] 与 P_i^succ。\n\n数值实现建议与计算资源估计。 对 N ≤ 10 可直接采用枚举 2^N 子集，若每次迭代需要 O(2^N · N) 操作，则 N=3、N=2 的计算量极低，在普通桌面上瞬时完成。若枚举内还进行蒙特卡洛评估（用于包含随机衰落/时间偏移），可用 10^4–10^6 次样本获得较低方差估计，计算可以在多核上并行。固定点迭代通常在几十到几百步内收敛。数值精度建议 τ 的收敛阈值 1e−6，吞吐值相对误差目标 1% 至 5% 取决于仿真采样量。对于扩展到中等规模（N≈20–100），应使用局部邻居裁剪或均值场近似以避免指数爆炸；在那种情况下可用并行 Monte Carlo 或重要性采样评估 Φ 的统计量。\n\n灵敏度分析、模型校准与验证策略。 因为模型关键依赖 RSSI、CCA 阈值、SIR/capture 阈值与 Pe 的输入，强烈建议对这类参数做敏感度扫描：逐一把 RSSI 在 ±6–10 dB 范围、Pe 在 0–0.2、CW_min 与 r 在合理区间内变化，观察对 τ、p 与总吞吐 S 的影响，识别系统“相变”点（例如从互听到不互听或从捕获主导到碰撞主导的分界）。对模型校准，应用事件驱动仿真器（实现直观的 DCF 时序、preamble 处理与捕获规则）在相同参数下做蒙特卡洛试验，验证固定点解的偏差。进一步的实测验证可通过在受控环境（固定位置的若干 AP 与 STA）下测量 RSSI、丢包率、吞吐与碰撞率，利用最小二乘或似然方法估计模型中不确定参数（例如 capture_delta 或有效 Pe）以校准 Φ 函数。\n\n动态演化与模型自适应。 现实中 RSSI 与 Pe 随时间变化（人群移动、遮挡等），因此模型应支持在线重标定：在运行时以滑动窗口统计观测到的 ACK 丢失率、退避分布与测量 RSSI，将这些量定期输入模型以更新 τ_i 与 p_i 的预测，或用卡尔曼/粒子滤波器估计慢变参数。对于非饱和流量或随机到达场景，可将饱和 τ_i 替换为基于队列的发送概率来构建排队耦合模型（耦合 M/G/1 或离散时间队列与 Bianchi 风格的退避链），并用流量强度 λ_i 与平均服务率 μ_i 求解稳定性与时延分布。\n\n可扩展方向与改进建议。 将 RSSI 的确定性替换为包含慢变阴影（对数正态）与快变衰落（瑞利/莱斯）后，可把 Φ_i(T) 通过积分或蒙特卡洛方式评估，使模型更适用于室内复杂衰落场景。引入队列模型可评估延迟与丢包而非仅吞吐，允许研究不饱和负载下的公平性问题。对大规模网络，可用随机几何与均值场近似（例如把邻居数视作泊松分布）推导平均吞吐或分布式不动点解。若需要更高精度的捕获/前导顺序模型，可把发包起始时刻视作连续随机变量并在 Φ 的评估中精确积分前导长度和到达偏移。最后，可将本模型与数据驱动方法结合：用仿真或测量数据训练轻量级回归/神经代理模型（surrogate model）以用在实时控制/优化（如信道分配、功率控制或动态 CW 调整）中，从而在保证响应速度的同时保留物理可解释性。\n\n小结（如何用该模型回答题中每个子题并得出数值结果）。 使用上述模型与解法，对每一问按题设的 Φ_i(T)、RSSI 与物理层速率直接填写参数：对题中两节点/三节点的小情形用枚举固定点迭代法求稳态 τ、p 与 E[slot]，再按吞吐公式 S_total = (∑_i P_i^succ · L_payload_bits) / E[slot] 计算吞吐。若需要验证精确度，可实现一个事件驱动仿真器（模拟 DIFS/SLOT/SIFS/ACKTimeout、退避暂停/恢复、preamble 抢占与捕获）并在多个随机种子下统计吞吐与丢包率，比对解析模型的预测，必要时用仿真结果微调 Φ_i(T) 中的捕获参数或时间顺序概率。该方法既能回答题中的特定情形（并给出数值吞吐），又具备拓展到更复杂/随机化场景的能力，且在保持解析可解释性的同时允许通过仿真和数据驱动技术提高现实贴合度。",
  "task_descriptions": [
    "子任务1 的目标是把物理层的接收强度与载波感知行为以及并发解调成功判据，形式化为可计算的“载波感知图（carrier‑sense graph）”与“并发成功函数 Φ_i(T)”两个明确接口，并输出一套规范化的数据结构和参数表供后续 MAC 层建模使用。具体工作步骤与要求如下：一) 输入数据与单位：接受或计算节点间接收功率矩阵 RSSI_{a→b}（dBm 或 mW）、CCA 门限（dBm）、物理层速率 rate（bps）、PHY 头时长 t_phy（μs）、MAC 头长度 L_mac（Bytes）、payload 大小（Bytes）、SIFS/DIFS/slot/ACK/ACKTimeout（μs）、发射功率（dBm）、路径损耗模型参数（若需由位置计算 RSSI）、SIR 判决阈值或 capture_delta（dB）、是否存在独立信道丢包率 Pe、ACK 成功假设、以及退避参数 CW_min/CW_max/m/r；所有量须注明单位并以一致制式输入（例如 JSON/CSV）。二) 载波感知图构造：对每一对发射方 a 与监听方 b 比较 RSSI_{a→b} 与 CCA 门限，若 RSSI ≥ CCA_threshold 则在载波感知图中添加有向或无向边（按是否对称），最终输出二进制邻接矩阵 CS[i,j]（i 可检测到 j 的发送）；同时输出每个节点的“感知邻居集合” CS_neighbors(i)。三) 干扰／解调判据定义（Φ 函数规范）：为每个接收端（或每个发送—接收对）定义一个可调用函数 Φ_i(T)（T 为同时发送的其它节点集合），其值为当 i 发送且集合 T 同时发起时在 i 的接收端“能否成功解码”的二值指示或[0,1]概率；明确 Φ 的计算逻辑：（1）到达时序处理：规定若存在“先到优先”的前导（preamble）效应，需输入或假定包起始时间偏移模型（例如同一时隙内的均匀偏移或离散偏移），并定义当某 j∈T 的前导先到且被成功解码时，后到的 i 必然失败的规则；（2）捕获与 SIR 判定：若未被前导抢占，则计算接收端的线性功率（将 dBm 转为 mW 并求和），SIR_i = P_i(mW) / Σ_{j∈T} P_j(mW) 或以 dB 差表示，比较 SIR_i 与给定阈值或比较 P_i 与 max_j P_j 加上 capture_delta 来决定成功；（3）小信号屏蔽/切换规则：若允许接收机在前导后切换到更强信号，规定相应条件（RSSI 优势阈值与时间窗）并在 Φ 中实现；（4）信道质量独立丢包：若存在 Pe，则在单发情形 Φ_i(∅)=1−Pe（或把 Pe 作为乘法因子应用于所有成功事件）；（5）特殊/简化情形接口：允许直接指定简化策略（并发必败、并发必胜或基于 SIR 的阈值）以便按题设快速应用。四) 时隙/时长输出：基于上述判定规范，为每个可能的并发集合 U 定义并输出所需的事件时长 T(U) = max_{j∈U} T_event_j，其中 T_event_j = t_phy + (L_mac + payload)/rate + SIFS + ACK（成功）或 = t_phy + (L_mac + payload)/rate + DIFS + ACKTimeout（失败），并说明在 Φ 概率化时如何取期望时长。五) 可选的随机化扩展说明：规定若需考虑随机衰落或到达偏移，则 Φ_i(T) 应返回基于指定分布的成功概率（通过解析积分或 Monte‑Carlo 估计），并明确输入随机分布参数（阴影标准差、瑞利/Rician 参数、起始时间分布）。六) 输出格式与工具建议：要求把 CS 邻接矩阵、每个节点的 interferer set、对所有子集 T 的 Φ 值或可调用函数句柄、以及 T(U) 表格以机器可读格式（JSON/CSV/NumPy arrays）导出，并建议使用 Python（numpy, scipy）、或 MATLAB 做数值实现与验证，文档化所有参数和单位以便复现。最终交付物应包含（i）参数清单与输入样本文件、（ii）载波感知邻接矩阵与每节点感知集合、（iii）对任意并发集合可评估的 Φ_i(T) 实现（或离散化概率表）、（iv）并发时隙持续时间表 T(U)、以及（v）一页说明文档，明确每一项计算规则、假设与可替换的简化策略，确保后续 MAC 层建模可以直接调用这些接口而无需对物理判据作二次解释。",
    "子任务2的目标是把物理层并发成功判据 Φ_i(T) 与 Bianchi 风格的二维退避马尔可夫关系严格耦合，形成一组关于每个节点在任意虚拟时隙发送概率 τ_i 和条件失败概率 p_i 的闭合非线性方程，并给出基于该解的系统吞吐 S_total 的精确定义与计算公式；为实现这一目标须完成下列工作并明确所需输入/输出：首先明确符号和输入参数集——节点集合 N，载荷长度 payload（Bytes），PHY 头时长 t_phy，MAC 头长度 L_mac，物理层速率 rate（bps），时序常数 Slot、DIFS、SIFS、ACK 时长、ACKTimeout，CCA 门限与 RSSI 矩阵，SIR 或 capture 阈值/capture_delta，退避参数 W0 (CW_min)、W_max、最大阶 m、最大重传次数 r，以及可选的独立信道错误率 Pe；并假定外部已提供或可计算的并发成功函数 Φ_i(T)（对任意同时发送的其它节点集合 T，Φ_i(T) 返回在 i 的接收端该发送成功的指示 0/1 或成功概率 ∈[0,1]，若 Φ_i(T) 随机则在下述公式中用其数学期望值）。然后给出节点层的耦合方程：对每一节点 i，用 Bianchi 的稳态闭式关系把 τ_i 表示为 τ_i = f_Bianchi(p_i; W0, m, r)（即 τ_i = b_{0,0}(p_i)·(1−p_i^{r+1})/(1−p_i)，其中 b_{0,0} 采用 Bianchi 的闭式表达），将 p_i 用其它节点独立发送的近似写为 p_i = 1 − ∑_{T ⊆ N\\{i}} [ (∏_{j∈T} τ_j) (∏_{k∈N\\{i}\\T} (1−τ_k)) · Φ_i(T) ]，该式等价于 p_i = 1 − E_{T}[Φ_i(T)] 在其它节点以 τ_j 作为独立伯努利发送概率時的期望表达；同时定义单节点成功事件概率 P_i^succ = τ_i · ∑_{T ⊆ N\\{i}} (∏_{j∈T} τ_j ∏_{k∈N\\{i}\\T} (1−τ_k) · Φ_i(T) )。为计算时隙平均时长须定义并发集合 U 的概率 P(U) = ∏_{j∈U} τ_j ∏_{k∉U} (1−τ_k)（U=∅ 表示空闲时隙），并对每个 U 给出其事件持续时间 T(U) = E[T(U)] = 若 Φ 含随机性则按 Φ 的分布取期望，否则为 deterministic：T(U) = max_{j∈U} T_event_j，其中对任意节点 j 的事件时长 T_event_j = T_sj 当 j 在集合 U 中被判定成功（Φ_j(U\\{j})=1）否则为 T_cj；并且以题目所给物理时序计算 T_sj = t_phy + (L_mac + payload)/rate + SIFS + ACK + DIFS（或按题目精确定义的头部与时序和）与 T_cj = t_phy + (L_mac + payload)/rate + DIFS + ACKTimeout（或相应失败时长）作为成功/失败持续时间。在以上定义下系统总吞吐量以 renewal 观点精确定义为 S_total = (∑_{i∈N} P_i^succ · L_payload_bits) / E[slot_duration]，其中 L_payload_bits = payload·8，且 E[slot_duration] = P_idle·T_e + ∑_{U≠∅} P(U)·E[T(U)]，P_idle = ∏_{i∈N}(1−τ_i)。本子任务的交付物为：①以数学形式给出的 N 个 τ_i—p_i 耦合方程组（含对 Φ 的明确调用接口）；②关于每个并发集合 U 的概率 P(U) 与期望时隙时长 E[T(U)] 的公式与计算规则（含当 Φ 为概率函数时如何取期望）；③ 用于计算每节点成功概率 P_i^succ、空闲概率 P_idle 及最终吞吐 S_total 的封闭表达式；以及④一份清单列出计算这些量所需的全部输入参数与单位（RSSI 矩阵、CCA、SIR阈值、PHY/MAC 时序、退避参数等）并明确假定的“其他节点独立发送”（decoupling）前提和 Φ_i(T) 的接口规范，使得在给定外部的 Φ 函数与输入参数后，该方程组可直接用于数值求解或用于下一步的数值求解器调用。",
    "子任务3（数值求解、算法实现与计算策略）旨在把子任务2中得到的 N 个节点耦合非线性方程（τ_i = f_Bianchi(p_i)，p_i = 1 − E_T[Φ_i(T)]）可靠、可重复地数值求解并给出工程级实现细节与扩展策略：输入为节点数 N、每节点的退避参数（W0/CW_min、m、r、CW_max）、时序常数（slot、DIFS、SIFS、ACK、ACKTimeout、t_phy）、payload 与 rate、RSSI 矩阵、CCA 与 SIR/capture 阈值、以及可调用的并发成功判据函数 Φ_i(T)（对每个 i 和任意并发集合 T 返回成功指示或成功概率，若含随机量则按概率输出或供蒙特卡洛评估）；输出为收敛的 τ 向量、对应的 p 向量、每节点成功概率 P_i^succ、期望时隙时长 E[slot] 及系统吞吐 S_total。实现方法（小规模精确枚举）：当 N 可枚举（通常 N ≤ 10，题中 N = 2 或 3）采用不动点迭代：初始化 τ^(0)（例如 1/W0 或 Bianchi 同质解），对 k=0,1,... 重复两步直到收敛或达到最大迭代次数（例如 max_iter=1000）：A）用当前 τ^(k) 枚举所有子集 T（2^(N−1) 个对每个 i）计算 p_i^(k) = 1 − ∑_{T⊆N\\{i}} [Π_{j∈T} τ_j^(k) Π_{k∉T}(1−τ_k^(k)) · E[Φ_i(T)] ]（若 Φ deterministic 则直接取值，若随机则在该迭代内用数值积分或蒙特卡洛估计 E[Φ_i(T)]）；B）将 p_i^(k) 代入 Bianchi 节点闭式公式得到 τ_i_temp，并用松弛/阻尼更新 τ_i^(k+1) = α τ_i_temp + (1−α) τ_i^(k)（推荐 α 取 0.3–0.8，遇到震荡可减小 α 或采用 Anderson 加速或混合牛顿法；收敛判据建议 ∥τ^(k+1)−τ^(k)∥_∞ < 1e−6 或相对误差阈值）。数值细节与稳定性：在概率乘积计算中使用对数手法避免下溢，采用双精度浮点，针对极小或极大 τ 值做截断保护；若采用 Newton/准牛顿 加速，数值估计雅可比矩阵时优先用有限差分并限制步长以防发散。对于含随机 Φ 的情形，建议在每次迭代对每个需评估的子集复用相同的随机种子（共用随机数）以实现方差减少；单次蒙特卡洛样本量视目标精度而定，通常 1e4–1e6 次样本可在并行环境下把估计标准误缩至 ≲1%（可按 CLT 评估所需样本数），并行化 Monte‑Carlo（按子集或按样本分片）以缩短时延。计算复杂度与扩展策略：每次迭代精确枚举成本为 O(2^N · N)（N=3 极小，N>15 不可行），因此当 N 增大推荐两类近似：1) 局部邻居裁剪：对每个 i 仅枚举其 K 个最强干扰邻居（按 RSSI 截断，K 通常 4–10），把远端节点以平均活动率 aggregated τ_agg 近似合并（用泊松或伯努利近似）；2) 均值场/统计近似：用总体平均发送率 τ_bar 替代个体 τ_j，使 p_i 的计算从指数级降为 O(N) 或 O(K)；同时记录近似引入的误差界（通过对若干代表性小规模精确解对比评估）。实现与性能工程建议：优先用 Python + numpy/scipy 实现原型，关键瓶颈使用 numba/Cython 或 C++ 并行化，利用 multiprocessing 或 GPU 并行化子集枚举或 Monte‑Carlo 样本；对于逐子集并行，按节点或按子集分片分布任务并汇总结果；使用向量化概率表与位掩码表示子集以加速计算；记录中间诊断量（τ^k 序列、p^k、残差、每次迭代的 E[slot] 与吞吐）并保存以便追踪收敛行为。仿真验证接口（用于数值解校验）：同时提供可选的事件驱动仿真器（实现 DIFS/SLOT/SIFS/ACKTimeout、退避暂停/恢复、preamble 抢占与 capture 规则）作为基准，仿真配置应包含热身期（warm‑up）后采样期、多个随机种子（建议≥30 次独立跑以估计置信区间），记录的统计量包括估计 τ（回退为0概率）、碰撞率、每节点吞吐与丢包率及其置信区间；对含随机 Φ 的场景，数值解中的 Monte‑Carlo 误差与仿真结果应一致且在容忍范围内。最后，给出推荐默认参数（收敛阈值 1e−6、max_iter=1000、松弛 α=0.5、Monte‑Carlo 样本 1e5、并行 worker 数等），并要求实现应输出可复现的日志（随机种子、迭代轨迹、运行时间、并行配置）以便审计与调优。",
    "子任务4（验证、敏感性分析与场景化应用与扩展）的目标是将数值模型在题目给定的具体多BSS场景上进行系统性验证与校准，评价模型对关键输入不确定性的敏感性，并形成可重复的场景化分析和扩展建议；为此请按下列明确步骤执行并交付可复现结果与工件：首先准备标准化输入清单（每个场景的节点集合、RSSI矩阵、CCA阈值、SIR/capture阈值或 capture_delta、独立信道丢包率 Pe、PHY/MAC 时序常数：t_phy、L_mac、payload、rate、SIFS、DIFS、slot、ACK、ACKTimeout，以及退避参数 W0、CW_max、m、r），以机器可读配置文件（JSON/CSV）保存；第二步针对每个题目场景（例如题中四个场景）用数值求解器按给定 Φ_i(T) 接口解出稳态变量（τ 向量、p 向量）並记录理论输出量（每节点成功概率 P_i^succ、每节点与系统吞吐、空闲/碰撞/成功时隙概率与期望时隙长度），收敛判据建议采用 ∥τ^(k+1)−τ^(k)∥_∞<1e−6 或最多 1000 次迭代；第三步实现或配置事件驱动基准仿真器（可选工具：Python+simpy 或 ns‑3），精确模拟 DCF 时序、退避暂停/恢复、preamble 抢占与 capture 规则，仿真策略为每个场景做多次独立运行（建议种子数 ≥30）并在仿真中统计与解析模型相同的指标；第四步进行模型验证与校准：用仿真结果作为基准计算误差指标（如每节点吞吐与总体吞吐的相对误差、碰撞率误差），若差异显著，定义参数化的 Φ 或 capture 参数向量并以最小二乘或最大似然准则进行标定（优化器可用 Nelder‑Mead、BFGS 或全局搜索），记录标定前后误差与参数变化；第五步开展敏感性与不确定性分析：先用廉价筛选（Morris 法）识别最敏感参数，再对这些参数做细粒度扫描或方差贡献度分析（Sobol 或一维扫参）——建议扫描范围例如 RSSI ±10 dB、Pe ∈ [0,0.2]、capture_delta ∈ [0,15] dB、CW_min 在题目附近±50% 等；对每个参数点计算吞吐与公平性指标，并用弹性/梯度和临界阈值表述系統行為的“相变”边界（例如从互听到隐藏节点主导的转折）；第六步在统计上报告不确定性：对随机化 Φ 或含蒙特卡洛估计的量，确保样本量使估计的 95% 置信区间宽度低于目标相对误差（例如 ≤5%），常用样本量为 1e4 次 Monte‑Carlo 评估或按 CLT 动态调整样本数；第七步并行化与工程实践建议：并行化子集枚举/蒙特卡洛采样以缩短运行时间，保存全部随机种子与配置以保证复现，记录运行日志与收敛轨迹；最后交付物包括：每个场景的数值解与仿真结果表（τ、p、每节点与总吞吐、碰撞/丢包率、置信区间）、校准后参数与校准误差、敏感性分析图表与临界阈值报告、用于重现的配置文件和脚本（数值求解器与仿真器）、以及一页操作说明（如何复现实验、如何在新场景上运行校准与敏感性分析）；整个子任务只关注验证/校准/敏感性/场景化工作流的实现与交付，不包含对模型设计原理的重新推导或超出上述输入的额外假定。"
  ]
}