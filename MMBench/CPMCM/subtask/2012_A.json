{
  "tasks": [],
  "problem_str": "问题背景：\n基因识别问题及其算法实现\n\n一、背景介绍\n\nDNA是生物遗传信息的载体，其化学名称为脱氧核糖核酸（Deoxyribonucleic acid，缩写为DNA）。DNA分子是一种长链聚合物，DNA序列由腺嘌呤（Adenine, A），鸟嘌呤（Guanine, G），胞嘧啶（Cytosine, C），胸腺嘧啶（Thymine, T）这四种核苷酸（nucleotide）符号按一定的顺序连接而成。其中带有遗传讯息的DNA片段称为基因（Gene）（见图1第一行）。其他的DNA序列片段，有些直接以自身构造发挥作用，有些则参与调控遗传讯息的表现。\n\n在真核生物的DNA序列中，基因通常被划分为许多间隔的片段（见图1第二行），其中编码蛋白质的部分，即编码序列（Coding Sequence）片段，称为外显子（Exon），不编码的部分称为内含子（Intron）。外显子在DNA序列剪接（Splicing）后仍然会被保存下来，并可在蛋白质合成过程中被转录（transcription）、复制（replication）而合成为蛋白质（见图2）。DNA序列通过遗传编码来储存信息，指导蛋白质的合成，把遗传信息准确无误地传递到蛋白质（protein）上去并实现各种生命功能。\n\n对大量、复杂的基因序列的分析，传统生物学解决问题的方式是基于分子实验的方法，其代价高昂。诺贝尔奖获得者W.吉尔伯特（Walter Gilbert，1932—；【美】，第一个制备出混合脱氧核糖核酸的科学家）1991年曾经指出：“现在，基于全部基因序列都将知晓，并以电子可操作的方式驻留在数据库中，新的生物学研究模式的出发点应是理论的。一个科学家将从理论推测出发，然后再回到实验中去，追踪或验证这些理论假设。” 随着世界人类基因组工程计划的顺利完成，通过物理或数学的方法从大量的DNA序列中获取丰富的生物信息，对生物学、医学、药学等诸多方面都具有重要的理论意义和实际价值，也是目前生物信息学领域的一个研究热点。\n\n问题要求：\n二、数字序列映射与频谱3-周期性：\n\n对给定的DNA序列，怎么去识别出其中的编码序列（即外显子），也称为基因预测，是一个尚未完全解决的问题，也是当前生物信息学的一个最基础、最首要的问题。\n\n基因预测问题的一类方法是基于统计学的[1]。很多国际生物数据网站上也有“基因识别”的算法。比如知名的数据网站http://genes.mit.edu/GENSCAN.html提供的基因识别软件GENSCAN（由斯坦福大学研究人员研发的、可免费使用的基因预测软件）,主要就是基于隐马尔科夫链（HMM）方法。但是，它预测人的基因组中有45000个基因，相当于现在普遍认可数目的两倍。另外，统计预测方法通常需要将编码序列信息已知的DNA序列作为训练数据集来确定模型中的参数，从而提高模型的预测水平。但在对基因信息了解不多的情况下，基因识别的准确率会明显下降。\n\n因此在目前基因预测研究中，采用信号处理与分析方法来发现基因编码序列也受到广泛重视 [4]。1. 数字序列映射\n\n在 DNA 序列研究中，首先需要把 $A, T, G, C$ 四种核苷酸的符号序列，根据一定的规则映射成相应的数值序列，以便于对其作数字处理。令 $I = \\{A, T, G, C\\}$，长度（即核苷酸符号个数，又称碱基对 (Base-Pair) 长度，单位记为 $bp$）为 $N$ 的任意 DNA 序列，可表达为\\[ S = \\{ S[n] \\mid S[n] \\in I, \\; n=0,1,2,\\cdots,N-1 \\} \\]即 $A, T, G, C$ 的符号序列 $S$：$S[0], S[1], \\cdots, S[N-1]$。  现对于任意确定的 $b \\in I$，令\\[ u_b[n] = \\begin{cases} 1, & S[n] = b \\\\ 0, & S[n] eq b \\end{cases}, \\quad n=0,1,2,\\cdots,N-1 \\]称之为 Voss 映射，于是生成相应的 0-1 序列（即二进制序列）$\\{u_b[n]\\}$：$u_b[0], u_b[1], \\cdots, u_b[N-1]$（$b \\in I$）。例如，假设给定的一段 DNA 序列片段为 $S = ATCGTACTG$，则所生成的四个 0-1 序列分别为：\\[ \\{u_A[n]\\} : \\{1,0,0,0,0,1,0,0\\}; \\quad \\{u_G[n]\\} : \\{0,0,0,1,0,0,0,1\\}; \\]\\[ \\{u_C[n]\\} : \\{0,0,1,0,0,0,1,0\\}; \\quad \\{u_T[n]\\} : \\{0,1,0,0,1,0,0,0\\}. \\]这样产生的四个数字序列又称为 DNA 序列的指示序列 (indicator sequence)。为研究 DNA 编码序列（外显子）的特性，对指示序列分别做离散 Fourier 变换 (DFT)：\\[ U_b[k] = \\sum_{n=0}^{N-1} u_b[n] e^{-j \\frac{2\\pi nk}{N}}, \\quad k = 0,1,\\cdots,N-1 \\tag{1} \\]以此可得到四个长度均为 $N$ 的复数序列 $\\{U_b[k]\\},\\; b \\in I$。  计算每个复序列 $\\{U_b[k]\\}$ 的平方功率谱，并相加则得到整个 DNA 序列 $S$ 的功率谱序列 $\\{P[k]\\}$：\\[ P[k] = |U_A[k]|^2 + |U_T[k]|^2 + |U_G[k]|^2 + |U_C[k]|^2, \\quad k = 0,1,\\cdots,N-1 \\tag{2} \\]对于同一段 DNA 序列，其外显子与内含子序列片段的功率谱通常表现出不同的特性。\\vspace{0.3cm}\\textbf{图3：} 编号为 BK006948.2 的酵母基因 DNA 序列的功率谱  （\\textbf{因为对称性，实际这里只给出了功率谱图的一半}）。  \\(a)：上图是基因上一段外显子（区间为 [81787, 82920]，长 1134bp）对应的指示序列映射的功率谱，它具有 3-周期性；  \\(b)：下图是基因上一段内含子（区间为 [96361, 97551]，长 1191bp）的指示序列的功率谱，它不具有 3-周期性。\\vspace{0.3cm}可以看到：外显子序列的功率谱曲线在频率 $k = \\frac{N}{3}$ 处，具有较大的频谱峰值 (Peak Value)，而内含子则没有类似的峰值。这种统计现象被称为碱基的 3-周期 (3-base Periodicity)。记 DNA 序列 $S$ 的总功率谱的平均值为：\\[ \\bar{E} = \\frac{1}{N} \\sum_{k=0}^{N-1} P[k] \\tag{3} \\] 而将 DNA 序列在特定位置，即 $k = \\frac{N}{3}$ 处的功率谱值，与整个序列 $S$ 的总功率谱的平均值的比率称为 DNA 序列的 “信噪比” (Signal-Noise Ratio, SNR)，即\\[ R = \\frac{P\\left[\\frac{N}{3}\\right]}{\\bar{E}} \\tag{4} \\]DNA 序列的信噪比值的大小，既表示频谱峰值 (Peak-Value) 的相对高度，也反映编码或非编码序列 3-周期性的强弱。信噪比 R 大于某个适当选定的阈值 $R_0$ (比如 $R_0=2$)，是 DNA 序列上编码序列片段（外显子）通常满足的特性；而内含子则一般不具有该性质。在 DNA 序列 $\\{S[n], \\; n=0,1,2,\\cdots,N-1\\}$ 中，若 N 为 3 的倍数，将核苷酸符号 $b \\in I=\\{A,T,G,C\\}$ 出现在该序列的 0,3,6,…,N-3 与 1,4,7,…,N-2 以及 2,5,8,…,N-1 等位置上的频数分别记为 $x_b, y_b, z_b$，则 $N/3$ 处的总功率谱值即为：\\[ P\\left[\\frac{N}{3}\\right] = \\sum_{b \\in I} \\left| U_b\\left[\\frac{N}{3}\\right] \\right|^2  = \\sum_{b \\in I} \\left| \\sum_{n=0}^{N-1} u_b[n] e^{-j \\frac{2\\pi n}{3}} \\right|^2 \\]\\[ = \\sum_{b \\in I} \\left| x_b + y_b e^{-j \\frac{2\\pi}{3}} + z_b e^{j \\frac{2\\pi}{3}} \\right|^2 = \\sum_{b \\in I} \\left( x_b^2 + y_b^2 + z_b^2 - x_b y_b - x_b z_b - y_b z_b \\right) \\]易见，当四种核苷酸符号 $b \\in I$ 在序列的上述第一、第二、第三个子序列上出现的频数 $x_b,y_b,z_b$ 越接近相等时，$N/3$ 处的谱值也就越接近于零。所以，基因外显子序列的功率谱曲线，在 $N/3$ 频率处具有较大的频谱峰值 (Peak-Value)，反映了在基因外显子片段上，四种核苷酸符号在序列的三个子序列上分布的 “非均衡性”。通常认为这种现象源于编码基因序列 “密码子” (codon) 使用的偏向性 (bias)。虽然目前对此现象产生的 “机理” 还不是十分地清楚，但是频谱的 3-周期性被普遍认为是可用于识别基因编码序列（外显子）的一个重要的特征信息。\\begin{figure}[h]\\centering\\includegraphics[width=0.9\\textwidth]{流程图示意}\\caption{基于序列频谱 3-周期性的基因预测方法流程图}\\end{figure}已经有一些研究者提出了识别基因的算法（如参见文献[6]及其后的文献）。目前利用信噪比的基因识别算法通常有两种：一种是固定长度窗口滑动法[2][3]，另一是移动信噪比曲线识别方法[6]。\\subsection*{基于固定长度滑动窗口上频谱曲线的基因识别方法}对一个 DNA 序列 $S$ 和它的指示序列 $\\{u_b[n]\\}, \\; b \\in I, \\; n=0,1,2,\\cdots,N-1$。取长度 $M$（通常取为 3 的倍数，例如 $M=99,129,255,513$ 等）作为固定窗口长度。对任意 $n (0 \\leq n \\leq N-1)$，在以 $n$ 为中心的长度为 $M$ 的序列片段 $\\left[n-\\frac{M-1}{2}, \\; n+\\frac{M-1}{2}\\right]$ 上（当 $n$ 接近序列的两端时，窗口实际有效长度可能会小于 $M$），作四个指示序列的离散 Fourier 变换 (DFT)：\\[ U_b[k] = \\sum_{i=n-\\frac{M-1}{2}}^{n+\\frac{M-1}{2}} u_b[i] e^{-j \\frac{2\\pi i k}{M}}, \\quad k=0,1,\\cdots,M-1 \\]并求出在 $\\frac{M}{3}$ 处总频谱 $p(n; \\frac{M}{3})$，即\\[ P\\left[\\frac{M}{3}\\right] = |U_A[\\tfrac{M}{3}]|^2 + |U_T[\\tfrac{M}{3}]|^2 + |U_G[\\tfrac{M}{3}]|^2 + |U_C[\\tfrac{M}{3}]|^2 \\triangleq p\\left(n;\\tfrac{M}{3}\\right) \\]把这样得到的谱值 $p(n;\\tfrac{M}{3}), \\; n=0,1,2,\\cdots,N-1$，经过标准化处理（即除以最大谱值 $\\max\\limits_{0 \\leq n \\leq N-1}\\{p(n;\\tfrac{M}{3})\\}$），并画出其频谱曲线。三、请研究的几个问题：\\textbf{1. 功率谱与信噪比的快速算法}对很多长的 DNA 序列，在计算其功率谱或信噪比时，离散 Fourier 变换 (DFT) 的总体计算量仍然很大，会影响到所设计的基因识别算法的效率。大家能否对 Voss 映射，探求功率谱与信噪比的某种快速计算方法？在基因识别研究中，为了通过引入更好的数值映射而获取 DNA 序列更多的信息，除了上面介绍的 Voss 映射外，实际上人们还研究过许多不同的数值映射方法。例如，著名的 Z-curve 映射（参见[5]或者附件1）。试探讨 Z-curve 映射的频谱与信噪比和 Voss 映射下的频谱与信噪比之间的关系；此外，能否对实数映射，如：$A \\rightarrow 0, \\; C \\rightarrow 1, \\; G \\rightarrow 2, \\; T \\rightarrow 3$，也给出功率谱与信噪比的快速计算公式？\\vspace{0.3cm}\\textbf{2. 对不同物种类型基因的阈值确定}对特定的基因类型的 DNA 序列，将其信噪比 $R$ 的判别阈值取为 $R_0=2$，带有一定的主观性、经验性。对不同的基因类型，所选取的判别阈值也许应该是不同的。附件中给出了若干著名的生物数据库网站：\\url{http://www.ncbi.nlm.nih.gov/guide/} 的几个基因序列数据，另外也给出了带有编码外显子信息的 100 个人人和鼠类的，以及 200 个哺乳动物类的基因序列的样本数据集合。大家还可以从生物数据库下载更多的数据，找你们认为具有代表性的基因序列，并对每类基因研究其阈值确定方法和阈值结果。此外，对按照频谱或信噪比特征将编码与非编码区间分类的有效性，以及分类识别时所产生的分类错误作适当分析。\\vspace{0.3cm}\\textbf{3. 基因识别算法的实现}我们的目的是要预测、预报尚未被注释的、完整的 DNA 序列的所有基因编码序列（外显子）。目前基因识别方面的多数算法结果还不是很充分。例如前面所列举的某些基因识别算法，由于 DNA 序列随机噪声的影响等原因，还很难 “精确地” 确定基因外显子区间的两端点。对比，你的建模团队有没有更好的解决方法？请对你们所设计的基因识别算法的准确率做出适当评估，并将算法用于对附件中给出的 6 个未被注释的 DNA 序列（gene6）的编码区域的预测。\n\n4. 延展性研究\n\n在基因识别研究中，还有很多问题有待深入探讨。比如\n\n（1）采用频谱或信噪比这样单一的判别特征，也许是影响、限制基因识别正确率的一个重要原因。人们发现，对某些DNA序列而言，其部分编码序列（外显子），尤其是短的（长度小于100bp）的编码序列，就可能不具有频谱或者信噪比显著性。你们团队能否总结，甚至独自提出一些识别基因编码序列的其它特征指数，并对此做相关的分析？\n\n（2）“基因突变”是生物医学等方面的一个关注热点。基因突变包括DNA序列中单个核苷酸的替换，删除或者插入等。那么，能否利用频谱或信噪比方法去发现基因编码序列可能存在的突变呢？\n\n上面提出的基于频谱3-周期性的基因预测四个方面问题中，“快速算法”与“阈值确定”是为设计基因预测算法做准备的。此外，在最后的延展性研究中，各队也可以对你们自己认为有价值的其它相关问题展开探讨。\nAddendum: \n参考文献：\n【1】Burge, C., Karlin, S., 1997. Prediction of complete gene structures in human genomic DNA. J. Mol. Biol. 268, 78–94.\n【2】Anastassiou, D., 2000. Frequency-domain analysis of biomolecular sequences. Bioinformatics 16, 1073–1081.\n【3】Kotlar, D., Lavner, Y., 2003. Gene prediction by spectral rotation measure: a new method for identifying protein-coding regions. Genome Res. 13, 1930–1937.\n【4】Berryman, M. J., Allison, A., 2005. Review of signal processing in genetics. Fluctuation and Noise Letters. 5(4), 13-35.\n【5】Sharma, S. D., Shakya，K., Sharma，S. N., 2011. Evaluation of DNA Mapping Schemes for Exon Detection. International Conference on Computer, Communication and Electrical Technology– ICCCET. 2011, 18th & 19th.\n【6】Yin, C., Yau, S.S.-T. 2007. Prediction of protein coding regions by the 3-base periodicity analysis of a DNA sequence. Journal of Theoretical Biology. 247, 687–694.\nDataset Path:\n['参考文献', '基因数据', '文本附件']\n\nData Description:\n本数据集由三部分附件组成：附件1 提供与Z-curve映射相关的背景知识，附件2 包含序列样本（记录为来源于人类与鼠类的100个样本以及200个其他哺乳动物基因序列样本，用于比较与统计分析），附件3 则收录了6 个未注释的 DNA 序列（标记为 gene6）以便作为注释或预测方法的测试集；总体数据既包含原始的 DNA 序列 S，也包含基于 Voss 映射得到的指示序列 u_b[n]（b∈{A,T,G,C}）及其离散傅里叶变换结果 U_b[k]，进一步导出功率谱 P[k]、功率谱均值 E 和用于区分外显子/内含子的信噪比 SNR 等频域特征。该数据集适合用于基因序列的频谱分析、外显子识别、比较基因组学、信号处理方法验证和机器学习建模（包括有标注样本的训练与未注释序列的预测验证），并支持研究周期性信号（如三周期性）在不同物种和样本间的表现、特征提取与统计评估。数据组织上同时提供原始序列和派生的时域/频域特征，便于复现谱分析流程、构建基于功率谱与 SNR 的判别准则，以及开展跨物种或跨样本的系统性比较。",
  "problem": {
    "background": "基因识别问题及其算法实现\n\n一、背景介绍\n\nDNA是生物遗传信息的载体，其化学名称为脱氧核糖核酸（Deoxyribonucleic acid，缩写为DNA）。DNA分子是一种长链聚合物，DNA序列由腺嘌呤（Adenine, A），鸟嘌呤（Guanine, G），胞嘧啶（Cytosine, C），胸腺嘧啶（Thymine, T）这四种核苷酸（nucleotide）符号按一定的顺序连接而成。其中带有遗传讯息的DNA片段称为基因（Gene）（见图1第一行）。其他的DNA序列片段，有些直接以自身构造发挥作用，有些则参与调控遗传讯息的表现。\n\n在真核生物的DNA序列中，基因通常被划分为许多间隔的片段（见图1第二行），其中编码蛋白质的部分，即编码序列（Coding Sequence）片段，称为外显子（Exon），不编码的部分称为内含子（Intron）。外显子在DNA序列剪接（Splicing）后仍然会被保存下来，并可在蛋白质合成过程中被转录（transcription）、复制（replication）而合成为蛋白质（见图2）。DNA序列通过遗传编码来储存信息，指导蛋白质的合成，把遗传信息准确无误地传递到蛋白质（protein）上去并实现各种生命功能。\n\n对大量、复杂的基因序列的分析，传统生物学解决问题的方式是基于分子实验的方法，其代价高昂。诺贝尔奖获得者W.吉尔伯特（Walter Gilbert，1932—；【美】，第一个制备出混合脱氧核糖核酸的科学家）1991年曾经指出：“现在，基于全部基因序列都将知晓，并以电子可操作的方式驻留在数据库中，新的生物学研究模式的出发点应是理论的。一个科学家将从理论推测出发，然后再回到实验中去，追踪或验证这些理论假设。” 随着世界人类基因组工程计划的顺利完成，通过物理或数学的方法从大量的DNA序列中获取丰富的生物信息，对生物学、医学、药学等诸多方面都具有重要的理论意义和实际价值，也是目前生物信息学领域的一个研究热点。",
    "problem_requirement": "二、数字序列映射与频谱3-周期性：\n\n对给定的DNA序列，怎么去识别出其中的编码序列（即外显子），也称为基因预测，是一个尚未完全解决的问题，也是当前生物信息学的一个最基础、最首要的问题。\n\n基因预测问题的一类方法是基于统计学的[1]。很多国际生物数据网站上也有“基因识别”的算法。比如知名的数据网站http://genes.mit.edu/GENSCAN.html提供的基因识别软件GENSCAN（由斯坦福大学研究人员研发的、可免费使用的基因预测软件）,主要就是基于隐马尔科夫链（HMM）方法。但是，它预测人的基因组中有45000个基因，相当于现在普遍认可数目的两倍。另外，统计预测方法通常需要将编码序列信息已知的DNA序列作为训练数据集来确定模型中的参数，从而提高模型的预测水平。但在对基因信息了解不多的情况下，基因识别的准确率会明显下降。\n\n因此在目前基因预测研究中，采用信号处理与分析方法来发现基因编码序列也受到广泛重视 [4]。1. 数字序列映射\n\n在 DNA 序列研究中，首先需要把 $A, T, G, C$ 四种核苷酸的符号序列，根据一定的规则映射成相应的数值序列，以便于对其作数字处理。令 $I = \\{A, T, G, C\\}$，长度（即核苷酸符号个数，又称碱基对 (Base-Pair) 长度，单位记为 $bp$）为 $N$ 的任意 DNA 序列，可表达为\\[ S = \\{ S[n] \\mid S[n] \\in I, \\; n=0,1,2,\\cdots,N-1 \\} \\]即 $A, T, G, C$ 的符号序列 $S$：$S[0], S[1], \\cdots, S[N-1]$。  现对于任意确定的 $b \\in I$，令\\[ u_b[n] = \\begin{cases} 1, & S[n] = b \\\\ 0, & S[n] eq b \\end{cases}, \\quad n=0,1,2,\\cdots,N-1 \\]称之为 Voss 映射，于是生成相应的 0-1 序列（即二进制序列）$\\{u_b[n]\\}$：$u_b[0], u_b[1], \\cdots, u_b[N-1]$（$b \\in I$）。例如，假设给定的一段 DNA 序列片段为 $S = ATCGTACTG$，则所生成的四个 0-1 序列分别为：\\[ \\{u_A[n]\\} : \\{1,0,0,0,0,1,0,0\\}; \\quad \\{u_G[n]\\} : \\{0,0,0,1,0,0,0,1\\}; \\]\\[ \\{u_C[n]\\} : \\{0,0,1,0,0,0,1,0\\}; \\quad \\{u_T[n]\\} : \\{0,1,0,0,1,0,0,0\\}. \\]这样产生的四个数字序列又称为 DNA 序列的指示序列 (indicator sequence)。为研究 DNA 编码序列（外显子）的特性，对指示序列分别做离散 Fourier 变换 (DFT)：\\[ U_b[k] = \\sum_{n=0}^{N-1} u_b[n] e^{-j \\frac{2\\pi nk}{N}}, \\quad k = 0,1,\\cdots,N-1 \\tag{1} \\]以此可得到四个长度均为 $N$ 的复数序列 $\\{U_b[k]\\},\\; b \\in I$。  计算每个复序列 $\\{U_b[k]\\}$ 的平方功率谱，并相加则得到整个 DNA 序列 $S$ 的功率谱序列 $\\{P[k]\\}$：\\[ P[k] = |U_A[k]|^2 + |U_T[k]|^2 + |U_G[k]|^2 + |U_C[k]|^2, \\quad k = 0,1,\\cdots,N-1 \\tag{2} \\]对于同一段 DNA 序列，其外显子与内含子序列片段的功率谱通常表现出不同的特性。\\vspace{0.3cm}\\textbf{图3：} 编号为 BK006948.2 的酵母基因 DNA 序列的功率谱  （\\textbf{因为对称性，实际这里只给出了功率谱图的一半}）。  \\(a)：上图是基因上一段外显子（区间为 [81787, 82920]，长 1134bp）对应的指示序列映射的功率谱，它具有 3-周期性；  \\(b)：下图是基因上一段内含子（区间为 [96361, 97551]，长 1191bp）的指示序列的功率谱，它不具有 3-周期性。\\vspace{0.3cm}可以看到：外显子序列的功率谱曲线在频率 $k = \\frac{N}{3}$ 处，具有较大的频谱峰值 (Peak Value)，而内含子则没有类似的峰值。这种统计现象被称为碱基的 3-周期 (3-base Periodicity)。记 DNA 序列 $S$ 的总功率谱的平均值为：\\[ \\bar{E} = \\frac{1}{N} \\sum_{k=0}^{N-1} P[k] \\tag{3} \\] 而将 DNA 序列在特定位置，即 $k = \\frac{N}{3}$ 处的功率谱值，与整个序列 $S$ 的总功率谱的平均值的比率称为 DNA 序列的 “信噪比” (Signal-Noise Ratio, SNR)，即\\[ R = \\frac{P\\left[\\frac{N}{3}\\right]}{\\bar{E}} \\tag{4} \\]DNA 序列的信噪比值的大小，既表示频谱峰值 (Peak-Value) 的相对高度，也反映编码或非编码序列 3-周期性的强弱。信噪比 R 大于某个适当选定的阈值 $R_0$ (比如 $R_0=2$)，是 DNA 序列上编码序列片段（外显子）通常满足的特性；而内含子则一般不具有该性质。在 DNA 序列 $\\{S[n], \\; n=0,1,2,\\cdots,N-1\\}$ 中，若 N 为 3 的倍数，将核苷酸符号 $b \\in I=\\{A,T,G,C\\}$ 出现在该序列的 0,3,6,…,N-3 与 1,4,7,…,N-2 以及 2,5,8,…,N-1 等位置上的频数分别记为 $x_b, y_b, z_b$，则 $N/3$ 处的总功率谱值即为：\\[ P\\left[\\frac{N}{3}\\right] = \\sum_{b \\in I} \\left| U_b\\left[\\frac{N}{3}\\right] \\right|^2  = \\sum_{b \\in I} \\left| \\sum_{n=0}^{N-1} u_b[n] e^{-j \\frac{2\\pi n}{3}} \\right|^2 \\]\\[ = \\sum_{b \\in I} \\left| x_b + y_b e^{-j \\frac{2\\pi}{3}} + z_b e^{j \\frac{2\\pi}{3}} \\right|^2 = \\sum_{b \\in I} \\left( x_b^2 + y_b^2 + z_b^2 - x_b y_b - x_b z_b - y_b z_b \\right) \\]易见，当四种核苷酸符号 $b \\in I$ 在序列的上述第一、第二、第三个子序列上出现的频数 $x_b,y_b,z_b$ 越接近相等时，$N/3$ 处的谱值也就越接近于零。所以，基因外显子序列的功率谱曲线，在 $N/3$ 频率处具有较大的频谱峰值 (Peak-Value)，反映了在基因外显子片段上，四种核苷酸符号在序列的三个子序列上分布的 “非均衡性”。通常认为这种现象源于编码基因序列 “密码子” (codon) 使用的偏向性 (bias)。虽然目前对此现象产生的 “机理” 还不是十分地清楚，但是频谱的 3-周期性被普遍认为是可用于识别基因编码序列（外显子）的一个重要的特征信息。\\begin{figure}[h]\\centering\\includegraphics[width=0.9\\textwidth]{流程图示意}\\caption{基于序列频谱 3-周期性的基因预测方法流程图}\\end{figure}已经有一些研究者提出了识别基因的算法（如参见文献[6]及其后的文献）。目前利用信噪比的基因识别算法通常有两种：一种是固定长度窗口滑动法[2][3]，另一是移动信噪比曲线识别方法[6]。\\subsection*{基于固定长度滑动窗口上频谱曲线的基因识别方法}对一个 DNA 序列 $S$ 和它的指示序列 $\\{u_b[n]\\}, \\; b \\in I, \\; n=0,1,2,\\cdots,N-1$。取长度 $M$（通常取为 3 的倍数，例如 $M=99,129,255,513$ 等）作为固定窗口长度。对任意 $n (0 \\leq n \\leq N-1)$，在以 $n$ 为中心的长度为 $M$ 的序列片段 $\\left[n-\\frac{M-1}{2}, \\; n+\\frac{M-1}{2}\\right]$ 上（当 $n$ 接近序列的两端时，窗口实际有效长度可能会小于 $M$），作四个指示序列的离散 Fourier 变换 (DFT)：\\[ U_b[k] = \\sum_{i=n-\\frac{M-1}{2}}^{n+\\frac{M-1}{2}} u_b[i] e^{-j \\frac{2\\pi i k}{M}}, \\quad k=0,1,\\cdots,M-1 \\]并求出在 $\\frac{M}{3}$ 处总频谱 $p(n; \\frac{M}{3})$，即\\[ P\\left[\\frac{M}{3}\\right] = |U_A[\\tfrac{M}{3}]|^2 + |U_T[\\tfrac{M}{3}]|^2 + |U_G[\\tfrac{M}{3}]|^2 + |U_C[\\tfrac{M}{3}]|^2 \\triangleq p\\left(n;\\tfrac{M}{3}\\right) \\]把这样得到的谱值 $p(n;\\tfrac{M}{3}), \\; n=0,1,2,\\cdots,N-1$，经过标准化处理（即除以最大谱值 $\\max\\limits_{0 \\leq n \\leq N-1}\\{p(n;\\tfrac{M}{3})\\}$），并画出其频谱曲线。三、请研究的几个问题：\\textbf{1. 功率谱与信噪比的快速算法}对很多长的 DNA 序列，在计算其功率谱或信噪比时，离散 Fourier 变换 (DFT) 的总体计算量仍然很大，会影响到所设计的基因识别算法的效率。大家能否对 Voss 映射，探求功率谱与信噪比的某种快速计算方法？在基因识别研究中，为了通过引入更好的数值映射而获取 DNA 序列更多的信息，除了上面介绍的 Voss 映射外，实际上人们还研究过许多不同的数值映射方法。例如，著名的 Z-curve 映射（参见[5]或者附件1）。试探讨 Z-curve 映射的频谱与信噪比和 Voss 映射下的频谱与信噪比之间的关系；此外，能否对实数映射，如：$A \\rightarrow 0, \\; C \\rightarrow 1, \\; G \\rightarrow 2, \\; T \\rightarrow 3$，也给出功率谱与信噪比的快速计算公式？\\vspace{0.3cm}\\textbf{2. 对不同物种类型基因的阈值确定}对特定的基因类型的 DNA 序列，将其信噪比 $R$ 的判别阈值取为 $R_0=2$，带有一定的主观性、经验性。对不同的基因类型，所选取的判别阈值也许应该是不同的。附件中给出了若干著名的生物数据库网站：\\url{http://www.ncbi.nlm.nih.gov/guide/} 的几个基因序列数据，另外也给出了带有编码外显子信息的 100 个人人和鼠类的，以及 200 个哺乳动物类的基因序列的样本数据集合。大家还可以从生物数据库下载更多的数据，找你们认为具有代表性的基因序列，并对每类基因研究其阈值确定方法和阈值结果。此外，对按照频谱或信噪比特征将编码与非编码区间分类的有效性，以及分类识别时所产生的分类错误作适当分析。\\vspace{0.3cm}\\textbf{3. 基因识别算法的实现}我们的目的是要预测、预报尚未被注释的、完整的 DNA 序列的所有基因编码序列（外显子）。目前基因识别方面的多数算法结果还不是很充分。例如前面所列举的某些基因识别算法，由于 DNA 序列随机噪声的影响等原因，还很难 “精确地” 确定基因外显子区间的两端点。对比，你的建模团队有没有更好的解决方法？请对你们所设计的基因识别算法的准确率做出适当评估，并将算法用于对附件中给出的 6 个未被注释的 DNA 序列（gene6）的编码区域的预测。\n\n4. 延展性研究\n\n在基因识别研究中，还有很多问题有待深入探讨。比如\n\n（1）采用频谱或信噪比这样单一的判别特征，也许是影响、限制基因识别正确率的一个重要原因。人们发现，对某些DNA序列而言，其部分编码序列（外显子），尤其是短的（长度小于100bp）的编码序列，就可能不具有频谱或者信噪比显著性。你们团队能否总结，甚至独自提出一些识别基因编码序列的其它特征指数，并对此做相关的分析？\n\n（2）“基因突变”是生物医学等方面的一个关注热点。基因突变包括DNA序列中单个核苷酸的替换，删除或者插入等。那么，能否利用频谱或信噪比方法去发现基因编码序列可能存在的突变呢？\n\n上面提出的基于频谱3-周期性的基因预测四个方面问题中，“快速算法”与“阈值确定”是为设计基因预测算法做准备的。此外，在最后的延展性研究中，各队也可以对你们自己认为有价值的其它相关问题展开探讨。",
    "dataset_path": [
      "参考文献",
      "基因数据",
      "文本附件"
    ],
    "dataset_description": {
      "参考文献": "附件1 提供Z-curve映射的背景知识；",
      "基因数据": "附件2 提供100个人和鼠类、200个哺乳动物类基因序列样本数据；",
      "文本附件": "附件3 提供6个未注释DNA序列（gene6）。"
    },
    "variable_description": [
      {
        "S": "DNA序列"
      },
      {
        "u_b[n]": "Voss映射下的指示序列，b ∈ {A,T,G,C}"
      },
      {
        "U_b[k]": "指示序列的DFT结果"
      },
      {
        "P[k]": "DNA序列的功率谱"
      },
      {
        "E": "功率谱的平均值"
      },
      {
        "SNR": "信噪比，用于区分外显子与内含子"
      }
    ],
    "addendum": "参考文献：\n【1】Burge, C., Karlin, S., 1997. Prediction of complete gene structures in human genomic DNA. J. Mol. Biol. 268, 78–94.\n【2】Anastassiou, D., 2000. Frequency-domain analysis of biomolecular sequences. Bioinformatics 16, 1073–1081.\n【3】Kotlar, D., Lavner, Y., 2003. Gene prediction by spectral rotation measure: a new method for identifying protein-coding regions. Genome Res. 13, 1930–1937.\n【4】Berryman, M. J., Allison, A., 2005. Review of signal processing in genetics. Fluctuation and Noise Letters. 5(4), 13-35.\n【5】Sharma, S. D., Shakya，K., Sharma，S. N., 2011. Evaluation of DNA Mapping Schemes for Exon Detection. International Conference on Computer, Communication and Electrical Technology– ICCCET. 2011, 18th & 19th.\n【6】Yin, C., Yau, S.S.-T. 2007. Prediction of protein coding regions by the 3-base periodicity analysis of a DNA sequence. Journal of Theoretical Biology. 247, 687–694.",
    "data_summary": "Dataset Path:\n['参考文献', '基因数据', '文本附件']\n\nData Description:\n本数据集由三部分附件组成：附件1 提供与Z-curve映射相关的背景知识，附件2 包含序列样本（记录为来源于人类与鼠类的100个样本以及200个其他哺乳动物基因序列样本，用于比较与统计分析），附件3 则收录了6 个未注释的 DNA 序列（标记为 gene6）以便作为注释或预测方法的测试集；总体数据既包含原始的 DNA 序列 S，也包含基于 Voss 映射得到的指示序列 u_b[n]（b∈{A,T,G,C}）及其离散傅里叶变换结果 U_b[k]，进一步导出功率谱 P[k]、功率谱均值 E 和用于区分外显子/内含子的信噪比 SNR 等频域特征。该数据集适合用于基因序列的频谱分析、外显子识别、比较基因组学、信号处理方法验证和机器学习建模（包括有标注样本的训练与未注释序列的预测验证），并支持研究周期性信号（如三周期性）在不同物种和样本间的表现、特征提取与统计评估。数据组织上同时提供原始序列和派生的时域/频域特征，便于复现谱分析流程、构建基于功率谱与 SNR 的判别准则，以及开展跨物种或跨样本的系统性比较。",
    "data_description": {
      "参考文献": "附件1 提供Z-curve映射的背景知识；",
      "基因数据": "附件2 提供100个人和鼠类、200个哺乳动物类基因序列样本数据；",
      "文本附件": "附件3 提供6个未注释DNA序列（gene6）。"
    },
    "problem_str": "问题背景：\n基因识别问题及其算法实现\n\n一、背景介绍\n\nDNA是生物遗传信息的载体，其化学名称为脱氧核糖核酸（Deoxyribonucleic acid，缩写为DNA）。DNA分子是一种长链聚合物，DNA序列由腺嘌呤（Adenine, A），鸟嘌呤（Guanine, G），胞嘧啶（Cytosine, C），胸腺嘧啶（Thymine, T）这四种核苷酸（nucleotide）符号按一定的顺序连接而成。其中带有遗传讯息的DNA片段称为基因（Gene）（见图1第一行）。其他的DNA序列片段，有些直接以自身构造发挥作用，有些则参与调控遗传讯息的表现。\n\n在真核生物的DNA序列中，基因通常被划分为许多间隔的片段（见图1第二行），其中编码蛋白质的部分，即编码序列（Coding Sequence）片段，称为外显子（Exon），不编码的部分称为内含子（Intron）。外显子在DNA序列剪接（Splicing）后仍然会被保存下来，并可在蛋白质合成过程中被转录（transcription）、复制（replication）而合成为蛋白质（见图2）。DNA序列通过遗传编码来储存信息，指导蛋白质的合成，把遗传信息准确无误地传递到蛋白质（protein）上去并实现各种生命功能。\n\n对大量、复杂的基因序列的分析，传统生物学解决问题的方式是基于分子实验的方法，其代价高昂。诺贝尔奖获得者W.吉尔伯特（Walter Gilbert，1932—；【美】，第一个制备出混合脱氧核糖核酸的科学家）1991年曾经指出：“现在，基于全部基因序列都将知晓，并以电子可操作的方式驻留在数据库中，新的生物学研究模式的出发点应是理论的。一个科学家将从理论推测出发，然后再回到实验中去，追踪或验证这些理论假设。” 随着世界人类基因组工程计划的顺利完成，通过物理或数学的方法从大量的DNA序列中获取丰富的生物信息，对生物学、医学、药学等诸多方面都具有重要的理论意义和实际价值，也是目前生物信息学领域的一个研究热点。\n\n问题要求：\n二、数字序列映射与频谱3-周期性：\n\n对给定的DNA序列，怎么去识别出其中的编码序列（即外显子），也称为基因预测，是一个尚未完全解决的问题，也是当前生物信息学的一个最基础、最首要的问题。\n\n基因预测问题的一类方法是基于统计学的[1]。很多国际生物数据网站上也有“基因识别”的算法。比如知名的数据网站http://genes.mit.edu/GENSCAN.html提供的基因识别软件GENSCAN（由斯坦福大学研究人员研发的、可免费使用的基因预测软件）,主要就是基于隐马尔科夫链（HMM）方法。但是，它预测人的基因组中有45000个基因，相当于现在普遍认可数目的两倍。另外，统计预测方法通常需要将编码序列信息已知的DNA序列作为训练数据集来确定模型中的参数，从而提高模型的预测水平。但在对基因信息了解不多的情况下，基因识别的准确率会明显下降。\n\n因此在目前基因预测研究中，采用信号处理与分析方法来发现基因编码序列也受到广泛重视 [4]。1. 数字序列映射\n\n在 DNA 序列研究中，首先需要把 $A, T, G, C$ 四种核苷酸的符号序列，根据一定的规则映射成相应的数值序列，以便于对其作数字处理。令 $I = \\{A, T, G, C\\}$，长度（即核苷酸符号个数，又称碱基对 (Base-Pair) 长度，单位记为 $bp$）为 $N$ 的任意 DNA 序列，可表达为\\[ S = \\{ S[n] \\mid S[n] \\in I, \\; n=0,1,2,\\cdots,N-1 \\} \\]即 $A, T, G, C$ 的符号序列 $S$：$S[0], S[1], \\cdots, S[N-1]$。  现对于任意确定的 $b \\in I$，令\\[ u_b[n] = \\begin{cases} 1, & S[n] = b \\\\ 0, & S[n] eq b \\end{cases}, \\quad n=0,1,2,\\cdots,N-1 \\]称之为 Voss 映射，于是生成相应的 0-1 序列（即二进制序列）$\\{u_b[n]\\}$：$u_b[0], u_b[1], \\cdots, u_b[N-1]$（$b \\in I$）。例如，假设给定的一段 DNA 序列片段为 $S = ATCGTACTG$，则所生成的四个 0-1 序列分别为：\\[ \\{u_A[n]\\} : \\{1,0,0,0,0,1,0,0\\}; \\quad \\{u_G[n]\\} : \\{0,0,0,1,0,0,0,1\\}; \\]\\[ \\{u_C[n]\\} : \\{0,0,1,0,0,0,1,0\\}; \\quad \\{u_T[n]\\} : \\{0,1,0,0,1,0,0,0\\}. \\]这样产生的四个数字序列又称为 DNA 序列的指示序列 (indicator sequence)。为研究 DNA 编码序列（外显子）的特性，对指示序列分别做离散 Fourier 变换 (DFT)：\\[ U_b[k] = \\sum_{n=0}^{N-1} u_b[n] e^{-j \\frac{2\\pi nk}{N}}, \\quad k = 0,1,\\cdots,N-1 \\tag{1} \\]以此可得到四个长度均为 $N$ 的复数序列 $\\{U_b[k]\\},\\; b \\in I$。  计算每个复序列 $\\{U_b[k]\\}$ 的平方功率谱，并相加则得到整个 DNA 序列 $S$ 的功率谱序列 $\\{P[k]\\}$：\\[ P[k] = |U_A[k]|^2 + |U_T[k]|^2 + |U_G[k]|^2 + |U_C[k]|^2, \\quad k = 0,1,\\cdots,N-1 \\tag{2} \\]对于同一段 DNA 序列，其外显子与内含子序列片段的功率谱通常表现出不同的特性。\\vspace{0.3cm}\\textbf{图3：} 编号为 BK006948.2 的酵母基因 DNA 序列的功率谱  （\\textbf{因为对称性，实际这里只给出了功率谱图的一半}）。  \\(a)：上图是基因上一段外显子（区间为 [81787, 82920]，长 1134bp）对应的指示序列映射的功率谱，它具有 3-周期性；  \\(b)：下图是基因上一段内含子（区间为 [96361, 97551]，长 1191bp）的指示序列的功率谱，它不具有 3-周期性。\\vspace{0.3cm}可以看到：外显子序列的功率谱曲线在频率 $k = \\frac{N}{3}$ 处，具有较大的频谱峰值 (Peak Value)，而内含子则没有类似的峰值。这种统计现象被称为碱基的 3-周期 (3-base Periodicity)。记 DNA 序列 $S$ 的总功率谱的平均值为：\\[ \\bar{E} = \\frac{1}{N} \\sum_{k=0}^{N-1} P[k] \\tag{3} \\] 而将 DNA 序列在特定位置，即 $k = \\frac{N}{3}$ 处的功率谱值，与整个序列 $S$ 的总功率谱的平均值的比率称为 DNA 序列的 “信噪比” (Signal-Noise Ratio, SNR)，即\\[ R = \\frac{P\\left[\\frac{N}{3}\\right]}{\\bar{E}} \\tag{4} \\]DNA 序列的信噪比值的大小，既表示频谱峰值 (Peak-Value) 的相对高度，也反映编码或非编码序列 3-周期性的强弱。信噪比 R 大于某个适当选定的阈值 $R_0$ (比如 $R_0=2$)，是 DNA 序列上编码序列片段（外显子）通常满足的特性；而内含子则一般不具有该性质。在 DNA 序列 $\\{S[n], \\; n=0,1,2,\\cdots,N-1\\}$ 中，若 N 为 3 的倍数，将核苷酸符号 $b \\in I=\\{A,T,G,C\\}$ 出现在该序列的 0,3,6,…,N-3 与 1,4,7,…,N-2 以及 2,5,8,…,N-1 等位置上的频数分别记为 $x_b, y_b, z_b$，则 $N/3$ 处的总功率谱值即为：\\[ P\\left[\\frac{N}{3}\\right] = \\sum_{b \\in I} \\left| U_b\\left[\\frac{N}{3}\\right] \\right|^2  = \\sum_{b \\in I} \\left| \\sum_{n=0}^{N-1} u_b[n] e^{-j \\frac{2\\pi n}{3}} \\right|^2 \\]\\[ = \\sum_{b \\in I} \\left| x_b + y_b e^{-j \\frac{2\\pi}{3}} + z_b e^{j \\frac{2\\pi}{3}} \\right|^2 = \\sum_{b \\in I} \\left( x_b^2 + y_b^2 + z_b^2 - x_b y_b - x_b z_b - y_b z_b \\right) \\]易见，当四种核苷酸符号 $b \\in I$ 在序列的上述第一、第二、第三个子序列上出现的频数 $x_b,y_b,z_b$ 越接近相等时，$N/3$ 处的谱值也就越接近于零。所以，基因外显子序列的功率谱曲线，在 $N/3$ 频率处具有较大的频谱峰值 (Peak-Value)，反映了在基因外显子片段上，四种核苷酸符号在序列的三个子序列上分布的 “非均衡性”。通常认为这种现象源于编码基因序列 “密码子” (codon) 使用的偏向性 (bias)。虽然目前对此现象产生的 “机理” 还不是十分地清楚，但是频谱的 3-周期性被普遍认为是可用于识别基因编码序列（外显子）的一个重要的特征信息。\\begin{figure}[h]\\centering\\includegraphics[width=0.9\\textwidth]{流程图示意}\\caption{基于序列频谱 3-周期性的基因预测方法流程图}\\end{figure}已经有一些研究者提出了识别基因的算法（如参见文献[6]及其后的文献）。目前利用信噪比的基因识别算法通常有两种：一种是固定长度窗口滑动法[2][3]，另一是移动信噪比曲线识别方法[6]。\\subsection*{基于固定长度滑动窗口上频谱曲线的基因识别方法}对一个 DNA 序列 $S$ 和它的指示序列 $\\{u_b[n]\\}, \\; b \\in I, \\; n=0,1,2,\\cdots,N-1$。取长度 $M$（通常取为 3 的倍数，例如 $M=99,129,255,513$ 等）作为固定窗口长度。对任意 $n (0 \\leq n \\leq N-1)$，在以 $n$ 为中心的长度为 $M$ 的序列片段 $\\left[n-\\frac{M-1}{2}, \\; n+\\frac{M-1}{2}\\right]$ 上（当 $n$ 接近序列的两端时，窗口实际有效长度可能会小于 $M$），作四个指示序列的离散 Fourier 变换 (DFT)：\\[ U_b[k] = \\sum_{i=n-\\frac{M-1}{2}}^{n+\\frac{M-1}{2}} u_b[i] e^{-j \\frac{2\\pi i k}{M}}, \\quad k=0,1,\\cdots,M-1 \\]并求出在 $\\frac{M}{3}$ 处总频谱 $p(n; \\frac{M}{3})$，即\\[ P\\left[\\frac{M}{3}\\right] = |U_A[\\tfrac{M}{3}]|^2 + |U_T[\\tfrac{M}{3}]|^2 + |U_G[\\tfrac{M}{3}]|^2 + |U_C[\\tfrac{M}{3}]|^2 \\triangleq p\\left(n;\\tfrac{M}{3}\\right) \\]把这样得到的谱值 $p(n;\\tfrac{M}{3}), \\; n=0,1,2,\\cdots,N-1$，经过标准化处理（即除以最大谱值 $\\max\\limits_{0 \\leq n \\leq N-1}\\{p(n;\\tfrac{M}{3})\\}$），并画出其频谱曲线。三、请研究的几个问题：\\textbf{1. 功率谱与信噪比的快速算法}对很多长的 DNA 序列，在计算其功率谱或信噪比时，离散 Fourier 变换 (DFT) 的总体计算量仍然很大，会影响到所设计的基因识别算法的效率。大家能否对 Voss 映射，探求功率谱与信噪比的某种快速计算方法？在基因识别研究中，为了通过引入更好的数值映射而获取 DNA 序列更多的信息，除了上面介绍的 Voss 映射外，实际上人们还研究过许多不同的数值映射方法。例如，著名的 Z-curve 映射（参见[5]或者附件1）。试探讨 Z-curve 映射的频谱与信噪比和 Voss 映射下的频谱与信噪比之间的关系；此外，能否对实数映射，如：$A \\rightarrow 0, \\; C \\rightarrow 1, \\; G \\rightarrow 2, \\; T \\rightarrow 3$，也给出功率谱与信噪比的快速计算公式？\\vspace{0.3cm}\\textbf{2. 对不同物种类型基因的阈值确定}对特定的基因类型的 DNA 序列，将其信噪比 $R$ 的判别阈值取为 $R_0=2$，带有一定的主观性、经验性。对不同的基因类型，所选取的判别阈值也许应该是不同的。附件中给出了若干著名的生物数据库网站：\\url{http://www.ncbi.nlm.nih.gov/guide/} 的几个基因序列数据，另外也给出了带有编码外显子信息的 100 个人人和鼠类的，以及 200 个哺乳动物类的基因序列的样本数据集合。大家还可以从生物数据库下载更多的数据，找你们认为具有代表性的基因序列，并对每类基因研究其阈值确定方法和阈值结果。此外，对按照频谱或信噪比特征将编码与非编码区间分类的有效性，以及分类识别时所产生的分类错误作适当分析。\\vspace{0.3cm}\\textbf{3. 基因识别算法的实现}我们的目的是要预测、预报尚未被注释的、完整的 DNA 序列的所有基因编码序列（外显子）。目前基因识别方面的多数算法结果还不是很充分。例如前面所列举的某些基因识别算法，由于 DNA 序列随机噪声的影响等原因，还很难 “精确地” 确定基因外显子区间的两端点。对比，你的建模团队有没有更好的解决方法？请对你们所设计的基因识别算法的准确率做出适当评估，并将算法用于对附件中给出的 6 个未被注释的 DNA 序列（gene6）的编码区域的预测。\n\n4. 延展性研究\n\n在基因识别研究中，还有很多问题有待深入探讨。比如\n\n（1）采用频谱或信噪比这样单一的判别特征，也许是影响、限制基因识别正确率的一个重要原因。人们发现，对某些DNA序列而言，其部分编码序列（外显子），尤其是短的（长度小于100bp）的编码序列，就可能不具有频谱或者信噪比显著性。你们团队能否总结，甚至独自提出一些识别基因编码序列的其它特征指数，并对此做相关的分析？\n\n（2）“基因突变”是生物医学等方面的一个关注热点。基因突变包括DNA序列中单个核苷酸的替换，删除或者插入等。那么，能否利用频谱或信噪比方法去发现基因编码序列可能存在的突变呢？\n\n上面提出的基于频谱3-周期性的基因预测四个方面问题中，“快速算法”与“阈值确定”是为设计基因预测算法做准备的。此外，在最后的延展性研究中，各队也可以对你们自己认为有价值的其它相关问题展开探讨。\nAddendum: \n参考文献：\n【1】Burge, C., Karlin, S., 1997. Prediction of complete gene structures in human genomic DNA. J. Mol. Biol. 268, 78–94.\n【2】Anastassiou, D., 2000. Frequency-domain analysis of biomolecular sequences. Bioinformatics 16, 1073–1081.\n【3】Kotlar, D., Lavner, Y., 2003. Gene prediction by spectral rotation measure: a new method for identifying protein-coding regions. Genome Res. 13, 1930–1937.\n【4】Berryman, M. J., Allison, A., 2005. Review of signal processing in genetics. Fluctuation and Noise Letters. 5(4), 13-35.\n【5】Sharma, S. D., Shakya，K., Sharma，S. N., 2011. Evaluation of DNA Mapping Schemes for Exon Detection. International Conference on Computer, Communication and Electrical Technology– ICCCET. 2011, 18th & 19th.\n【6】Yin, C., Yau, S.S.-T. 2007. Prediction of protein coding regions by the 3-base periodicity analysis of a DNA sequence. Journal of Theoretical Biology. 247, 687–694.\nDataset Path:\n['参考文献', '基因数据', '文本附件']\n\nData Description:\n本数据集由三部分附件组成：附件1 提供与Z-curve映射相关的背景知识，附件2 包含序列样本（记录为来源于人类与鼠类的100个样本以及200个其他哺乳动物基因序列样本，用于比较与统计分析），附件3 则收录了6 个未注释的 DNA 序列（标记为 gene6）以便作为注释或预测方法的测试集；总体数据既包含原始的 DNA 序列 S，也包含基于 Voss 映射得到的指示序列 u_b[n]（b∈{A,T,G,C}）及其离散傅里叶变换结果 U_b[k]，进一步导出功率谱 P[k]、功率谱均值 E 和用于区分外显子/内含子的信噪比 SNR 等频域特征。该数据集适合用于基因序列的频谱分析、外显子识别、比较基因组学、信号处理方法验证和机器学习建模（包括有标注样本的训练与未注释序列的预测验证），并支持研究周期性信号（如三周期性）在不同物种和样本间的表现、特征提取与统计评估。数据组织上同时提供原始序列和派生的时域/频域特征，便于复现谱分析流程、构建基于功率谱与 SNR 的判别准则，以及开展跨物种或跨样本的系统性比较。"
  },
  "problem_background": "基因识别问题及其算法实现\n\n一、背景介绍\n\nDNA是生物遗传信息的载体，其化学名称为脱氧核糖核酸（Deoxyribonucleic acid，缩写为DNA）。DNA分子是一种长链聚合物，DNA序列由腺嘌呤（Adenine, A），鸟嘌呤（Guanine, G），胞嘧啶（Cytosine, C），胸腺嘧啶（Thymine, T）这四种核苷酸（nucleotide）符号按一定的顺序连接而成。其中带有遗传讯息的DNA片段称为基因（Gene）（见图1第一行）。其他的DNA序列片段，有些直接以自身构造发挥作用，有些则参与调控遗传讯息的表现。\n\n在真核生物的DNA序列中，基因通常被划分为许多间隔的片段（见图1第二行），其中编码蛋白质的部分，即编码序列（Coding Sequence）片段，称为外显子（Exon），不编码的部分称为内含子（Intron）。外显子在DNA序列剪接（Splicing）后仍然会被保存下来，并可在蛋白质合成过程中被转录（transcription）、复制（replication）而合成为蛋白质（见图2）。DNA序列通过遗传编码来储存信息，指导蛋白质的合成，把遗传信息准确无误地传递到蛋白质（protein）上去并实现各种生命功能。\n\n对大量、复杂的基因序列的分析，传统生物学解决问题的方式是基于分子实验的方法，其代价高昂。诺贝尔奖获得者W.吉尔伯特（Walter Gilbert，1932—；【美】，第一个制备出混合脱氧核糖核酸的科学家）1991年曾经指出：“现在，基于全部基因序列都将知晓，并以电子可操作的方式驻留在数据库中，新的生物学研究模式的出发点应是理论的。一个科学家将从理论推测出发，然后再回到实验中去，追踪或验证这些理论假设。” 随着世界人类基因组工程计划的顺利完成，通过物理或数学的方法从大量的DNA序列中获取丰富的生物信息，对生物学、医学、药学等诸多方面都具有重要的理论意义和实际价值，也是目前生物信息学领域的一个研究热点。",
  "problem_requirement": "二、数字序列映射与频谱3-周期性：\n\n对给定的DNA序列，怎么去识别出其中的编码序列（即外显子），也称为基因预测，是一个尚未完全解决的问题，也是当前生物信息学的一个最基础、最首要的问题。\n\n基因预测问题的一类方法是基于统计学的[1]。很多国际生物数据网站上也有“基因识别”的算法。比如知名的数据网站http://genes.mit.edu/GENSCAN.html提供的基因识别软件GENSCAN（由斯坦福大学研究人员研发的、可免费使用的基因预测软件）,主要就是基于隐马尔科夫链（HMM）方法。但是，它预测人的基因组中有45000个基因，相当于现在普遍认可数目的两倍。另外，统计预测方法通常需要将编码序列信息已知的DNA序列作为训练数据集来确定模型中的参数，从而提高模型的预测水平。但在对基因信息了解不多的情况下，基因识别的准确率会明显下降。\n\n因此在目前基因预测研究中，采用信号处理与分析方法来发现基因编码序列也受到广泛重视 [4]。1. 数字序列映射\n\n在 DNA 序列研究中，首先需要把 $A, T, G, C$ 四种核苷酸的符号序列，根据一定的规则映射成相应的数值序列，以便于对其作数字处理。令 $I = \\{A, T, G, C\\}$，长度（即核苷酸符号个数，又称碱基对 (Base-Pair) 长度，单位记为 $bp$）为 $N$ 的任意 DNA 序列，可表达为\\[ S = \\{ S[n] \\mid S[n] \\in I, \\; n=0,1,2,\\cdots,N-1 \\} \\]即 $A, T, G, C$ 的符号序列 $S$：$S[0], S[1], \\cdots, S[N-1]$。  现对于任意确定的 $b \\in I$，令\\[ u_b[n] = \\begin{cases} 1, & S[n] = b \\\\ 0, & S[n] eq b \\end{cases}, \\quad n=0,1,2,\\cdots,N-1 \\]称之为 Voss 映射，于是生成相应的 0-1 序列（即二进制序列）$\\{u_b[n]\\}$：$u_b[0], u_b[1], \\cdots, u_b[N-1]$（$b \\in I$）。例如，假设给定的一段 DNA 序列片段为 $S = ATCGTACTG$，则所生成的四个 0-1 序列分别为：\\[ \\{u_A[n]\\} : \\{1,0,0,0,0,1,0,0\\}; \\quad \\{u_G[n]\\} : \\{0,0,0,1,0,0,0,1\\}; \\]\\[ \\{u_C[n]\\} : \\{0,0,1,0,0,0,1,0\\}; \\quad \\{u_T[n]\\} : \\{0,1,0,0,1,0,0,0\\}. \\]这样产生的四个数字序列又称为 DNA 序列的指示序列 (indicator sequence)。为研究 DNA 编码序列（外显子）的特性，对指示序列分别做离散 Fourier 变换 (DFT)：\\[ U_b[k] = \\sum_{n=0}^{N-1} u_b[n] e^{-j \\frac{2\\pi nk}{N}}, \\quad k = 0,1,\\cdots,N-1 \\tag{1} \\]以此可得到四个长度均为 $N$ 的复数序列 $\\{U_b[k]\\},\\; b \\in I$。  计算每个复序列 $\\{U_b[k]\\}$ 的平方功率谱，并相加则得到整个 DNA 序列 $S$ 的功率谱序列 $\\{P[k]\\}$：\\[ P[k] = |U_A[k]|^2 + |U_T[k]|^2 + |U_G[k]|^2 + |U_C[k]|^2, \\quad k = 0,1,\\cdots,N-1 \\tag{2} \\]对于同一段 DNA 序列，其外显子与内含子序列片段的功率谱通常表现出不同的特性。\\vspace{0.3cm}\\textbf{图3：} 编号为 BK006948.2 的酵母基因 DNA 序列的功率谱  （\\textbf{因为对称性，实际这里只给出了功率谱图的一半}）。  \\(a)：上图是基因上一段外显子（区间为 [81787, 82920]，长 1134bp）对应的指示序列映射的功率谱，它具有 3-周期性；  \\(b)：下图是基因上一段内含子（区间为 [96361, 97551]，长 1191bp）的指示序列的功率谱，它不具有 3-周期性。\\vspace{0.3cm}可以看到：外显子序列的功率谱曲线在频率 $k = \\frac{N}{3}$ 处，具有较大的频谱峰值 (Peak Value)，而内含子则没有类似的峰值。这种统计现象被称为碱基的 3-周期 (3-base Periodicity)。记 DNA 序列 $S$ 的总功率谱的平均值为：\\[ \\bar{E} = \\frac{1}{N} \\sum_{k=0}^{N-1} P[k] \\tag{3} \\] 而将 DNA 序列在特定位置，即 $k = \\frac{N}{3}$ 处的功率谱值，与整个序列 $S$ 的总功率谱的平均值的比率称为 DNA 序列的 “信噪比” (Signal-Noise Ratio, SNR)，即\\[ R = \\frac{P\\left[\\frac{N}{3}\\right]}{\\bar{E}} \\tag{4} \\]DNA 序列的信噪比值的大小，既表示频谱峰值 (Peak-Value) 的相对高度，也反映编码或非编码序列 3-周期性的强弱。信噪比 R 大于某个适当选定的阈值 $R_0$ (比如 $R_0=2$)，是 DNA 序列上编码序列片段（外显子）通常满足的特性；而内含子则一般不具有该性质。在 DNA 序列 $\\{S[n], \\; n=0,1,2,\\cdots,N-1\\}$ 中，若 N 为 3 的倍数，将核苷酸符号 $b \\in I=\\{A,T,G,C\\}$ 出现在该序列的 0,3,6,…,N-3 与 1,4,7,…,N-2 以及 2,5,8,…,N-1 等位置上的频数分别记为 $x_b, y_b, z_b$，则 $N/3$ 处的总功率谱值即为：\\[ P\\left[\\frac{N}{3}\\right] = \\sum_{b \\in I} \\left| U_b\\left[\\frac{N}{3}\\right] \\right|^2  = \\sum_{b \\in I} \\left| \\sum_{n=0}^{N-1} u_b[n] e^{-j \\frac{2\\pi n}{3}} \\right|^2 \\]\\[ = \\sum_{b \\in I} \\left| x_b + y_b e^{-j \\frac{2\\pi}{3}} + z_b e^{j \\frac{2\\pi}{3}} \\right|^2 = \\sum_{b \\in I} \\left( x_b^2 + y_b^2 + z_b^2 - x_b y_b - x_b z_b - y_b z_b \\right) \\]易见，当四种核苷酸符号 $b \\in I$ 在序列的上述第一、第二、第三个子序列上出现的频数 $x_b,y_b,z_b$ 越接近相等时，$N/3$ 处的谱值也就越接近于零。所以，基因外显子序列的功率谱曲线，在 $N/3$ 频率处具有较大的频谱峰值 (Peak-Value)，反映了在基因外显子片段上，四种核苷酸符号在序列的三个子序列上分布的 “非均衡性”。通常认为这种现象源于编码基因序列 “密码子” (codon) 使用的偏向性 (bias)。虽然目前对此现象产生的 “机理” 还不是十分地清楚，但是频谱的 3-周期性被普遍认为是可用于识别基因编码序列（外显子）的一个重要的特征信息。\\begin{figure}[h]\\centering\\includegraphics[width=0.9\\textwidth]{流程图示意}\\caption{基于序列频谱 3-周期性的基因预测方法流程图}\\end{figure}已经有一些研究者提出了识别基因的算法（如参见文献[6]及其后的文献）。目前利用信噪比的基因识别算法通常有两种：一种是固定长度窗口滑动法[2][3]，另一是移动信噪比曲线识别方法[6]。\\subsection*{基于固定长度滑动窗口上频谱曲线的基因识别方法}对一个 DNA 序列 $S$ 和它的指示序列 $\\{u_b[n]\\}, \\; b \\in I, \\; n=0,1,2,\\cdots,N-1$。取长度 $M$（通常取为 3 的倍数，例如 $M=99,129,255,513$ 等）作为固定窗口长度。对任意 $n (0 \\leq n \\leq N-1)$，在以 $n$ 为中心的长度为 $M$ 的序列片段 $\\left[n-\\frac{M-1}{2}, \\; n+\\frac{M-1}{2}\\right]$ 上（当 $n$ 接近序列的两端时，窗口实际有效长度可能会小于 $M$），作四个指示序列的离散 Fourier 变换 (DFT)：\\[ U_b[k] = \\sum_{i=n-\\frac{M-1}{2}}^{n+\\frac{M-1}{2}} u_b[i] e^{-j \\frac{2\\pi i k}{M}}, \\quad k=0,1,\\cdots,M-1 \\]并求出在 $\\frac{M}{3}$ 处总频谱 $p(n; \\frac{M}{3})$，即\\[ P\\left[\\frac{M}{3}\\right] = |U_A[\\tfrac{M}{3}]|^2 + |U_T[\\tfrac{M}{3}]|^2 + |U_G[\\tfrac{M}{3}]|^2 + |U_C[\\tfrac{M}{3}]|^2 \\triangleq p\\left(n;\\tfrac{M}{3}\\right) \\]把这样得到的谱值 $p(n;\\tfrac{M}{3}), \\; n=0,1,2,\\cdots,N-1$，经过标准化处理（即除以最大谱值 $\\max\\limits_{0 \\leq n \\leq N-1}\\{p(n;\\tfrac{M}{3})\\}$），并画出其频谱曲线。三、请研究的几个问题：\\textbf{1. 功率谱与信噪比的快速算法}对很多长的 DNA 序列，在计算其功率谱或信噪比时，离散 Fourier 变换 (DFT) 的总体计算量仍然很大，会影响到所设计的基因识别算法的效率。大家能否对 Voss 映射，探求功率谱与信噪比的某种快速计算方法？在基因识别研究中，为了通过引入更好的数值映射而获取 DNA 序列更多的信息，除了上面介绍的 Voss 映射外，实际上人们还研究过许多不同的数值映射方法。例如，著名的 Z-curve 映射（参见[5]或者附件1）。试探讨 Z-curve 映射的频谱与信噪比和 Voss 映射下的频谱与信噪比之间的关系；此外，能否对实数映射，如：$A \\rightarrow 0, \\; C \\rightarrow 1, \\; G \\rightarrow 2, \\; T \\rightarrow 3$，也给出功率谱与信噪比的快速计算公式？\\vspace{0.3cm}\\textbf{2. 对不同物种类型基因的阈值确定}对特定的基因类型的 DNA 序列，将其信噪比 $R$ 的判别阈值取为 $R_0=2$，带有一定的主观性、经验性。对不同的基因类型，所选取的判别阈值也许应该是不同的。附件中给出了若干著名的生物数据库网站：\\url{http://www.ncbi.nlm.nih.gov/guide/} 的几个基因序列数据，另外也给出了带有编码外显子信息的 100 个人人和鼠类的，以及 200 个哺乳动物类的基因序列的样本数据集合。大家还可以从生物数据库下载更多的数据，找你们认为具有代表性的基因序列，并对每类基因研究其阈值确定方法和阈值结果。此外，对按照频谱或信噪比特征将编码与非编码区间分类的有效性，以及分类识别时所产生的分类错误作适当分析。\\vspace{0.3cm}\\textbf{3. 基因识别算法的实现}我们的目的是要预测、预报尚未被注释的、完整的 DNA 序列的所有基因编码序列（外显子）。目前基因识别方面的多数算法结果还不是很充分。例如前面所列举的某些基因识别算法，由于 DNA 序列随机噪声的影响等原因，还很难 “精确地” 确定基因外显子区间的两端点。对比，你的建模团队有没有更好的解决方法？请对你们所设计的基因识别算法的准确率做出适当评估，并将算法用于对附件中给出的 6 个未被注释的 DNA 序列（gene6）的编码区域的预测。\n\n4. 延展性研究\n\n在基因识别研究中，还有很多问题有待深入探讨。比如\n\n（1）采用频谱或信噪比这样单一的判别特征，也许是影响、限制基因识别正确率的一个重要原因。人们发现，对某些DNA序列而言，其部分编码序列（外显子），尤其是短的（长度小于100bp）的编码序列，就可能不具有频谱或者信噪比显著性。你们团队能否总结，甚至独自提出一些识别基因编码序列的其它特征指数，并对此做相关的分析？\n\n（2）“基因突变”是生物医学等方面的一个关注热点。基因突变包括DNA序列中单个核苷酸的替换，删除或者插入等。那么，能否利用频谱或信噪比方法去发现基因编码序列可能存在的突变呢？\n\n上面提出的基于频谱3-周期性的基因预测四个方面问题中，“快速算法”与“阈值确定”是为设计基因预测算法做准备的。此外，在最后的延展性研究中，各队也可以对你们自己认为有价值的其它相关问题展开探讨。",
  "problem_analysis": "本问题立足于把基因识别这一生物学核心问题，用信号处理与统计建模的语言加以刻画与求解：目标并不是简单地对单一序列作描述性分析，而是在海量、异质的 DNA 序列中自动、鲁棒地识别出编码区（外显子）——这既是一个信号检测问题也是一个分类问题。宏观上，模型的主要目标可以分为若干层次：首先，在数值映射意义上把离散的碱基符号序列转为可做频域分析的数值序列（如 Voss 映射、Z-curve、其它实映射），从而能利用傅里叶谱及其三周期性特征区分编码/非编码区；其次，在计算层面要既保证频谱特征量（尤其是 k = N/3 或窗口 M/3 频点处的功率谱与 SNR）的准确性，又要尽可能高效（时间与空间可接受），以便在全基因组尺度上应用；再次，在判别层面需要设计并校准阈值或统计决策规则，使得在不同物种或不同序列类型上能达到可接受的假阳性/假阴性折中；最后，在预测层面需要用可组合的后处理（窗口合并、最小长度约束、剪接位点信息或 HMM/机器学习融合）来尽可能精确地定位外显子边界并评价结果。上述目标直接塑造了解题路径：从映射选择→快速计算谱量→阈值/分类器训练→后处理与评价，逐层推进并迭代改进。\n\n在整个建模过程中存在一系列显性和隐性假设，应当明确识别并批判性地审视。明显的假设包括：外显子普遍表现出三碱基周期性（3-周期）使得在频域 k = N/3 处有显著峰值；用固定长度或中心滑动窗口能局部近似平稳，从而频谱特征具有可比较性；Voss 指示序列或其它映射保留了区分编码与非编码所需的信息；以及阈值 R0（如 2）在不同情形下可直接适用或至少能通过校准适配不同物种。这些假设在实践中并非总是成立：短外显子（例如 <100 bp）和含有低复杂性序列或重复序列的区域可能不显著呈现 3-周期；不同物种（或同一物种不同基因家族）存在显著的密码子使用偏好差异，导致 SNR 分布不同；映射方法会引入或丢失信息（例如简单的实数映射可能把不同碱基合并成可混淆的数值），使得某些判别依据失真；窗口边缘效应和窗长选择会影响频谱估计的偏差与方差。因此，任何直接依赖单一假设的模型都会在某些真实场景下表现不佳，必须通过统计校准、组合特征和生物先验（如最小外显子长度、剪接位点模型）来缓解。\n\n各要素之间的相互依赖与潜在复杂性集中体现在映射→频谱计算→判别三个环节的耦合。映射选择决定了频谱形式和统计性质：Voss 映射给出四个 0-1 指示序列，各自的 DFT 相互独立地表达碱基在不同位置的周期性；Z-curve 映射给出基于累积差分的三维实向量，这三维向量本质上是 Voss 指示序列通过线性变换得到的组合，因此其频谱是 Voss 谱的线性组合，并包含跨基因型的相关信息；简单实数映射（如 A→0,C→1,G→2,T→3）则把四种指示序列按权重叠加，导致频谱中出现交叉项并可能引入伪周期或者掩盖真正的 3-周期。频谱的快速计算依赖于是否只需某些频点（通常是 M/3）或全谱；若只需 M/3，则可从基数统计直接计算而无需完整 FFT，从而促成线性时间算法并大幅提升效率；判别阈值与后续的合并/过滤规则又依赖窗口长度、序列长度、物种特性和预期的错误代价（例如更看重召回还是精确率）。这些耦合关系意味着在模型设计时不能孤立优化某一环节：例如把窗长设得过短虽然提高分辨率但会降低频谱的统计显著性；把映射改为简单实数能简化计算但会降低对某些基因类型的识别能力。需要通过协同调整（映射、窗长、平滑与判别准则）并利用交叉验证确定最佳组合。\n\n从复杂性随尺度与时间的演化角度看，模型的稳定性和适用性受多种动态因素影响。进化时间尺度上，密码子使用偏好和基因结构会变化，导致同一方法在不同物种或不同进化簇间的表现差异；个体层面的突变（替换、插入、删除）会改变局部的周期性特征，尤其插入/删除会造成移码且破坏原有三周期结构，从而降低检测灵敏度。算法在面对输入扰动时可能出现临界转变：例如若序列含大量短外显子或边界附近的混合序列，简单阈值判断会产生许多碎片化预测，需要后处理合并策略；含有高 GC 或低复杂度区域时，背景功率谱会偏高或偏低，使得基于全局平均能量的 SNR 归一化失效。因此模型需要具备动态自适应能力：如对不同物种独立估计背景功率分布、使用局部标准化或建立基于置换检验的显著性阈值、结合剪接位点预测与最小/最大长度约束做后处理以提高边界识别的鲁棒性。\n\n问题也可从多种替代视角重构，从而导出不同的建模策略与权衡。最直接的替代是把三周期性视为多种特征之一，构建一个多特征、机器学习分类器：输入既有 Voss SNR、Z-curve 各分量的谱能量、k-mer 频率、局部复杂度、剪接位点打分，也可加入同源比对与表达数据（RNA-seq）等证据并以随机森林、SVM 或深度学习模型做判别；这种做法往往提高灵敏度和精确率，但代价是需要标注数据、较差的可解释性与更高的计算/数据需求。另一种视角是把问题建成 HMM 或条件随机场，外显子与内含子的状态转换整合了频谱特征作为发射概率，这样更自然地表达序列的分段概率结构并能把剪接位点的先验信息纳入；这类方法通常更易解释且能直观地处理状态转移和最小长度约束。第三种视角是把频谱检验转为显著性检测问题：通过对原序列做置换或保留二联体统计的随机化产生背景分布，然后对观测到的 M/3 处功率做 p 值检验并以多重检验校正控制错误发现率；这种方法更强调统计显著性而非经验阈值，适合在样本间可比性差异较大时使用。不同视角的取舍反映了对可解释性、泛化能力、数据需求与计算效率的不同偏好。\n\n在算法与理论细节上有多项可行的快速计算与严格关系可利用，从而减轻 DFT 在基因组尺度上的计算负担。针对 Voss 指示序列及固定长度窗口 M（通常取为 3 的倍数），在整窗长度为 M 且以三帧分组时，式中所述的 P[M/3] 能够用各碱基在三帧（模 3 的位置组）中的频数 x_b, y_b, z_b 的二次型直接计算，即 P[M/3] = sum_{b in {A,T,G,C}} (x_b^2 + y_b^2 + z_b^2 - x_b y_b - x_b z_b - y_b z_b)。这一代数表达式的直接意义是：只要知道窗内每一帧上四种碱基的计数，就可以不经 FFT 直接得到目标频点的总功率。基于这一点可以构造线性时间的滑动窗口算法：预先对原序列按位置模 3 构建累积分布或维护三个帧的计数向量，窗口每向右移动一步时仅涉及常数个碱基从窗口左端剔除并在右端加入，因此三帧计数可在 O(1) 时间内更新，进而 P 值在 O(1) 时间内计算。整体复杂度为 O(N)（加上偶尔的边界处理），远优于对每个窗口做 FFT 的 O(N M log M) 或 O(N M) 的代价。对于 Z-curve 映射，可注意到 Z-curve是基于累积差分的线性组合（例如 x_n、y_n、z_n 分量分别对应某些碱基差计数），因此它的频谱是 Voss 指示 DFT 的线性组合；从代数上讲，Z-curve 中任一实分量的 DFT可以写成若干 U_b[k] 的加权和，Z-curve 在 k = M/3 处的功率与 Voss 的总功率存在确定的线性/二次关系，可通过矩阵变换显式计算并比较二者的 SNR（通常 Z-curve 各分量的信息是 Voss 的重表达，不会提供完全独立的新谱信息，但在某些数据噪声下能提高可分性）。对简单实数映射 s[n] = sum_b c_b u_b[n]（例如 c_A=0,c_C=1,c_G=2,c_T=3）同理 S[k] = sum_b c_b U_b[k]，其功率 |S[k]|^2 = sum_b |c_b|^2 |U_b[k]|^2 + cross terms，其中交叉项混合了不同碱基的频谱，可能导致伪峰或掩盖真正信号，因此用单一实数映射去替代 Voss 往往会降低检测的稳健性。综上，快速算法的核心思路是用帧内计数替代完整的 DFT，并借助累积和滑动更新实现 O(N) 的总体复杂度，同时通过线性代数显式写出不同映射之间的谱关系以指导映射选择或进行多映射融合。\n\n阈值确定与分类性能评估需要以统计学为基础并适应物种差异。经验阈值如 R0=2 在某些人类数据上或许有效，但其主观性明显，需要通过样本驱动的方法加以替代：可以在带注释的训练集上计算每类序列（外显子、内含子）在候选特征（如 P[M/3]、SNR、Z-curve 分量能量等）上的经验分布，利用 ROC 曲线与 AUC 衡量单特征判别能力，并根据期望的错分代价选择操作点（如最大 F1、给定精确率下的最大召回或给定召回下的最大精确率）。更严谨的方法是估计背景功率的分布（可用置换、保持一阶或二阶序列统计的随机化来构造零分布），基于 p 值进行多重检验校正并控制假发现率（FDR），从而得到可解释的显著性阈值。对于不同物种，应独立估计背景并据此调整阈值；若训练数据不足，可以借助贝叶斯先验（例如对物种已知的密码子偏好）进行收缩估计以稳定阈值。评估指标应在核苷酸级与外显子段级同时考察：核苷酸级的灵敏度/特异度衡量覆盖度，外显子级的精确率/召回衡量边界定位的成功率，同时给出边界误差（如端点误差分布）和错识率分类矩阵以便生物解读。要注意，多数单一频谱方法在短外显子检测上表现欠佳，因此阈值优化应与最小外显子长度、最小间隔和剪接位点置信度等约束结合，避免碎片化预测导致的高假阳性。\n\n延展性研究方向与潜在新特征的提出值得重视且具有实际意义。除三周期谱特征之外，还可以引入基于位置的 k-mer 频率矩阵与其帧特异性分布（例如三个读码框架上 k-mer 的不平衡性）、转录本表达证据（RNA-seq 覆盖度与比对分叉点）、保守性信息（跨物种比对得到的保守片段更可能是编码区）、以及序列的复杂度/重复性度量和局部熵。另一个有力的特征源于剪接位点：外显子两端附近常有保守的短序列信号（GT-AG 等），将这些信号的 PWM 打分与频谱 SNR 联合使用能显著提升边界定位精度。在机器学习框架中，可以把这些特征作为输入训练分类器，从而克服单一 SNR 特征的局限性。关于突变检测，频谱方法能在某些情形下提示可能存在插入/删除或替换（例如显著的 SNR 下降或局部范式破坏），但其灵敏度与特异度受到限制：替换型突变可能仅微弱地改变帧内计数，插入/删除尤其是移码事件会显著破坏三周期但难以定位突变点的精确类型。更可靠的突变检测通常需要比对、局部拼接或深度测序证据；频谱方法可以作为初筛或变异影响评估的一部分，但不能独立给出确证。\n\n模型构建过程中的不确定性与潜在风险值得严肃对待。主要不确定性来源于样本偏差（注释数据库中存在错误或偏向某些基因家族）、物种间变异、短外显子的不可检测性以及映射/窗长选择的敏感性。潜在风险包括：过度信赖单一特征导致高假阳性率、在临床或下游功能注释中误用未验证的预测结果而导致错误结论、以及在模型迭代中忽视数据漂移（例如新测序技术或新物种数据与训练集差异）造成性能退化。应对策略包括严格的交叉验证、使用独立验证集（最好是实验验证过的外显子）、用多特征融合与保守的后处理规则减少误报、并在发布预测结果时附带置信度和适用范围说明。\n\n最后，建模应被视为一个迭代与开放的过程。初期可从简单、可解释的管线入手：用 Voss 映射与滑动窗口帧计数法实现快速 P[M/3] 计算，基于训练集生成 ROC 并选择初始阈值，结合剪接位点打分与长度约束做后处理，然后在 gene6 等未注释序列上测试并与人工/数据库注释比较。后续应根据错误类型分析（例如哪些外显子被漏检、哪些假阳性经常发生在哪类区域）来引入新特征或改进映射与窗长策略；必要时将频谱特征作为一组输入与其它序列特征一起放入监督学习模型，并利用置换检验或贝叶斯方法来估计显著性和不确定度。对于算法实现，应优先采用基于帧计数的 O(N) 滑动方法以满足规模化需求，并把完整 FFT 仅限于需要分析全谱或验证的片段。研究团队应保持方法的可解释性、注重跨物种校准，并持续用新数据（包括实验验证数据）来检验与修正模型。通过这样的迭代式、证据驱动的研究流程，可以在保持生物学合理性的同时不断提升基因识别系统的准确率与普适性。",
  "modeling_solution": "总体目标与方法概述：本建模方案以“基于频谱3-周期性”的信号处理思想为核心，提出一套从数值映射、快速频谱量计算、统计判别与后处理融合到机器学习与概率模型整合的端到端策略，目标是在尺度可扩展、计算高效并能适应物种差异的前提下尽可能准确地识别 DNA 序列中的外显子区域。核心思想是利用 Voss 映射得到的四个指示序列在窗内的帧（frame，按位置模3划分）计数直接导出目标频点 k = M/3 处的功率谱闭式表达，从而用滑动窗口以 O(N) 时间复杂度（每步 O(1) 更新）计算窗中心处的谱峰与归一化信噪比（SNR），并在此基础上通过统计建模确定阈值、用后处理规则合并片段，同时可将谱特征与其它序列特征一同输入 HMM 或监督学习模型以提高短外显子与边界定位的准确度。\n\n基本假设（模型基础）：(1) 大多数编码区表现出 3-碱基周期性，使得在适当长度的窗口（M 为 3 的倍数）上 k = M/3 处的谱值显著高于背景；(2) 窗内序列可局部近似平稳，即在窗口尺度上用频域统计量区分编码/非编码；(3) Voss 映射保留了用于检测 3-周期的信息且比单一实数映射更稳健；(4) 外显子长度通常有较低界限（例如 > 50–100 bp），可作为后处理约束；(5) 不同物种或基因家族的背景谱能量分布不同，需要用样本驱动方法进行阈值校准或局部标准化。以上假设是用于减少问题复杂度和保证可实现性的近似，但在建模中通过多尺度分析、统计显著性检验与多特征融合来缓解这些近似的局限性。\n\n符号与变量定义（主要量）：序列长度 N，索引 n = 0,...,N-1；碱基集合 I = {A,T,G,C}。Voss 指示序列 u_b[n] = 1_{S[n]=b}。固定滑动窗口长度 M（取 3 的倍数），在以位置 t 为中心的窗口上统计三个帧（模 3）上的各碱基频数：对 b ∈ I 记为 x_b (位置集合 ≡ frame 0)、y_b (frame 1)、z_b (frame 2)。窗内每一帧总计数 x = sum_b x_b 等于 M/3（在无边界截断时）。D 用以表示窗的有效长度（当靠近端点时 D ≤ M）。指示序列的窗内 DFT 为 U_b[k]，总功率谱为 P[k] = sum_b |U_b[k]|^2。窗口处的平均功率 Ebar = (1/M) sum_{k=0}^{M-1} P[k]（在满窗情形下 Ebar = M，见下文）。定义窗中心处的目标频点谱值 P3(t) ≡ P_t[M/3] 以及归一化 SNR R(t) ≡ P3(t) / Ebar.\n\n快速计算公式与滑动窗口算法（核心技术）：对一个整窗（M 为 3 的倍数且无端点截断），在 k = M/3 处有 U_b[M/3] = x_b + y_b e^{-j2π/3} + z_b e^{j2π/3}. 将其代入总功率并化简可得窗内总谱在该频点处的闭式表达为\nP3 = sum_{b∈I} (x_b^2 + y_b^2 + z_b^2 − x_b y_b − x_b z_b − y_b z_b).\n等价且常用的对称形式为\nP3 = (1/2) * sum_{b∈I} [ (x_b − y_b)^2 + (x_b − z_b)^2 + (y_b − z_b)^2 ].\n该表达清晰地表明：P3 与三个帧上每种碱基计数的不均衡性（帧间差异）成正比。利用该闭式表达可避免对窗内四个指示序列求完整 FFT，从而大幅度降低计算量。窗口平均功率可由 Parseval 恒等式直接得到 sum_{k} |U_b[k]|^2 = M * sum_n u_b[n]^2 = M * N_b，故在满窗时 sum_k P[k] = M * sum_b N_b = M^2，进而 Ebar = (1/M) sum_k P[k] = M。因此在满窗条件下 SNR 简化为 R = P3 / M，阈值 R0（例如文献中常用的 2）对应的等价条件为 P3 ≥ R0 * M。靠近序列端点时用有效窗长 D 替换 M（此时 Ebar = D），并按 D 归一化。\n\n滑动更新策略：对整个序列从左到右维护三个帧上对四种碱基的计数矩阵 C[f,b]（f∈{0,1,2}, b∈I）。初始填充中心窗口的 C。窗口每右移一步时只需对被移出的碱基 b_left 和进入的碱基 b_right 更新相应帧计数（若使用中心定位，帧编号随位置改变，实际实现可采用两种常见模式：以窗口左端为基准或采用固定帧编号并跟随窗口移动；实现细节可通过循环对齐处理），然后按闭式式子计算新的 P3，接着用 D（有效窗长）求 R。该更新为 O(1) 操作，整个序列扫描为 O(N)。在实现中应特别注意边界窗的 D 处理和当 D 非 3 的倍数时的修正。\n\n映射间的代数关系（Voss、Z-curve、实数映射）：任何实数/向量映射 s[n] = sum_{b} c_b u_b[n]（c_b 为常数或复数系数），其 DFT S[k] = sum_b c_b U_b[k]，其功率 |S[k]|^2 = sum_b |c_b|^2 |U_b[k]|^2 + sum_{b≠b'} c_b conj(c_{b'}) U_b[k] conj(U_{b'}[k])。因此单一实数映射（例如 A→0,C→1,G→2,T→3）会引入碱基间的交叉项，可能产生伪峰或掩盖真实的 3-周期信息；从稳健性角度优先采用 Voss 四指示序列及其线性组合。Z-curve映射给出三维累积差分向量（通常记为 X[n], Y[n], Z[n]），它本质上是 Voss 指示序列的线性变换（即每个分量为某些 c_b 的线性组合的累积和），因此其频谱能写为 U_Z[k] = A * U_A[k] + B * U_C[k] + …，在 k=M/3 处功率可通过已知系数与 U_b[M/3] 的线性组合得到二次型表达。结论：Z-curve 的频谱信息是 Voss 的线性组合，不会增加独立维度但在有噪声或某些碱基偏好情形下可能有更好的判别性，因而建议把 Z-curve 的分量谱能量作为额外特征而非替代 Voss。\n\n阈值确定与统计判别策略：在带注释的训练样本上分别计算编码（外显子）与非编码（内含子）窗的 R 值分布。以 ROC 曲线与 AUC 衡量单特征（R）的判别能力，并根据任务需求选择阈值：最大化 F1、指定假阳性率（FPR）下最大召回或由生物学约束决定（例如偏向低假阳性以减少后续实验成本）。为了获得统计上可解释的显著性，建议构造 null 分布：对序列进行置换随机化（可以是完全随机打乱或保持单碱基频率/二联体频率等更保守的随机化）并计算重排后的 P3，从而得到 P3 在无 3-周期时的经验分布，计算 p 值并用 FDR 多重检验校正以在全基因组尺度控制假发现率。对于不同物种，应独立估计背景分布并据此调整阈值；如果标注样本数有限，可采用贝叶斯层次模型用先验对阈值做收缩估计。\n\n基因预测流程（从谱到基因区段）：对目标序列按步长 1 用长度为一或多种 M 的滑动窗口计算 R(t) 或 P3(t)，得到连续的基于窗中心的得分曲线。将得分标准化（除以窗口长度）并转换为基于位置的“碱基级别得分”：对每个碱基累加所有覆盖该位点的窗口得分或对覆盖的 R 值取加权平均（权重可按与中心距的高斯窗衰减），得到更平滑的分值曲线 S_base[n]。然后按所选阈值将 S_base 二值化，产生初步外显子区间集合。对初步区间做后处理：剔除短于 L_min 的片段（以减少短外显子伪阳性），合并相距小于 G_max 的片段（以修复小内含子或窗分割造成的碎片化），并在每个候选片段两端评估剪接位点信号（GT-AG 等）或使用 PWM 评分以提高端点准确性。若需要更精确的端点定位，可在候选片段附近用局部最大化 P3 或寻找剪接位点分数的峰值来微调端点。\n\n将频谱特征融入概率模型或监督学习：为提高对短外显子和边界定位的识别精度，可把频谱特征（P3, 周围频段能量比、Z-curve 分量能量、GC 含量、frame-specific k-mer 频率、局部复杂度、splice-site PWM 分数等）组合成特征向量并训练分类器（例如 logistic 回归、随机森林、XGBoost 或轻量神经网络）。另一个替代是把谱特征作为发射概率输入到带时长建模的隐马尔科夫模型（semi-Markov HMM 或 HMM + 经验长度分布），HMM 状态至少包含 exon/intron，状态转移可融合剪接位点先验。对于需要高可解释性的场景建议首选 HMM；对标注数据充足且追求高灵敏度可采用监督学习并在后处理阶段强制长度和剪接位点约束。训练时用交叉验证与独立验证集评估并用 ROC、AUC、核苷酸级及外显子段级的灵敏度与精确率、端点误差分布来综合衡量性能。\n\n突变检测的频谱方法扩展：基于频谱的突变检测可作为初筛工具。替换（单个碱基替换）对帧内计数的影响较小但累积替换可导致 P3 变化；插入/删除尤其移码事件会导致所在位置及下游序列的三周期性突变或消失。因此可用下列方式检测潜在突变：在全序列上计算局部 P3(t) 并用滑动窗口检测显著下降或上升的变点（change-point detection），或在参考序列/样本间比较 P3 曲线的差异，结合置换检验得到显著性。变点定位后应结合比对或深度测序证据以确认突变类型（替换 vs 插入/删除）；频谱方法更适合发现可能导致移码的事件或大范围突变。\n\n敏感性分析、模型适应性与重新校准：关键参数包括窗口长度 M、阈值 R0、最小外显子长度 L_min、加权窗形、以及用于归一化的背景模型。建议做系统性敏感性分析：在标注样本上网格搜索 M（例如 99,129,255,513 等取值），对比 ROC 与端点误差，评估短外显子检出率随 M 的变化。经验结果通常显示：较大的 M 对长外显子提供更稳健的谱估计但降低短外显子灵敏度；因此推荐多尺度融合策略（并行计算若干 M 的 P3 并合成得分，例如取最大或加权平均），以兼顾不同长度外显子的检测。此外在跨物种应用时须重新估计 null 分布和阈值并可用贝叶斯收缩或层次模型在物种间共享信息以稳定估计。模型应支持增量更新：当新标注或实验验证数据可得时用在线学习或每隔一段时间重新训练阈值/分类器以纠偏数据漂移。\n\n计算复杂度与实现细节：核心滑动窗口谱量用帧计数更新实现 O(N) 时间和 O(1) 额外空间（不含存储序列本身），多尺度实现将线性增加系数但仍可并行化。若需对候选片段做完整的频谱分析或验证，可对有限数目的候选段运行 FFT（成本可控）。训练监督模型的计算复杂度取决于样本数与特征维度，随机森林或 XGBoost 在中等规模数据上可在单机上完成。建议实现细节包括：用整数计数代替浮点运算以加速；在窗口中心计算时按模块运算管理帧编号以避免冗余；边界处用镜像或有效窗长 D 明确归一化以保持统计一致性。\n\n验证、评估指标与使用数据：用附件中提供的带注释的人、鼠类 100 个样本及 200 个哺乳动物样本分别训练/验证阈值与分类器，采用交叉验证评估泛化性能。性能度量应同时包含碱基级的灵敏度 (sensitivity, recall) 与精确率 (precision)，外显子段级的召回率（一个注释外显子被任意重合即算命中）与精确率，以及端点定位误差的分布（如端点平均偏差和中位误差）。另外报告 ROC 曲线与 AUC。将最终方法用于附件的 6 个未注释序列（gene6）时输出每个预测片段的置信度（基于 p 值或分类器概率），并附带说明该预测基于何种窗长与映射以及适用的物种先验。\n\n不确定性量化与置信度表达：对每个候选外显子提供 p 值（基于置换或保序随机化的 null 分布）和/或后验概率（若用贝叶斯分类器或 HMM），并进行多重检验校正以控制 FDR。在没有置换计算能力时可估计通过训练样本得到的评分的经验置信区间。对关键参数做灵敏度区间并把结果以置信区间呈现，提示用户哪些预测为高置信区（例如 p < 0.01 且概率 > 0.9）以便下游实验优先验证。\n\n扩展与未来改进方向：建议将频谱特征与更多证据源融合，包括 RNA-seq 覆盖与拼接跨接点证据、跨物种保守性（多序列比对）、frame-specific k-mer 偏向、以及深度学习方法（如以 one-hot 编码输入的 CNN）以在大量标注数据可用时进一步提高性能。对于变异检测，可以将频谱变化与比对结果结合，形成候选变异集供短读长测序验证。进一步可在 HMM 中引入可变长度分布和基于元学习的阈值自适应机制以在新物种或新平台数据上快速自我校准。最后，建议将方法实现为模块化软件：高速 C/C++/Rust 的核心数值模块（滑动计数与 P3 计算），Python/R 的高层接口用于训练/可视化/阈值选择，方便模型在大规模基因组上并行运行并定期用新注释进行再训练。\n\n总结性陈述：本模型以 Voss 指示序列的帧计数闭式表示为基础，提供了一个可扩展且计算高效的 O(N) 算法来评估窗口级别的 3-周期谱能量并计算归一化 SNR。通过统计阈值学、置换检验、多尺度融合、后处理规则和与 HMM/监督学习的集成，可在不同物种间自适应地识别外显子并给出置信度。该方案兼顾可解释性与可扩展性，易于用附件提供的数据进行训练与验证，并且为短外显子检测、突变初筛和跨证据融合提供了自然的扩展路线。",
  "task_descriptions": [
    "子任务 1（数值映射与频谱特征定义）的目标是把原始碱基符号序列 S[0..N-1] 明确定义为一组可用于局部频谱分析的数值表示，并为每个预定滑动窗口输出一组统一、可重复计算的谱特征向量，以便下游检测算法使用；该子任务仅包含数据映射、窗级统计量和谱量的精确定义与计算步骤，不涉及判别或后处理策略。 具体工作内容和步骤如下：输入为原始 DNA 序列 S（字符集 I={A,T,G,C}）以及待考察的窗口长度集合 M（通常取 3 的倍数，可包含若干尺度），以及窗口对齐策略（中心/左对齐）和边界处理规则；首先对序列做 Voss 映射：为每个碱基 b∈I 生成指示序列 u_b[n]=1_{S[n]=b}, n=0..N−1；对于给定窗口（长度为 M，在靠近端点时以有效长度 D 表示），按位置模 3 将窗口内位置分为三帧（frame 0,1,2），并对每个碱基在三帧上的出现次数计数为 x_b,y_b,z_b（当窗口被截断时以实际覆盖计数替代）；利用计数直接计算目标频点 k=M/3 处的总功率 P3（无需完整 DFT）按闭式公式 P3 = Σ_{b∈I} (x_b^2 + y_b^2 + z_b^2 − x_b y_b − x_b z_b − y_b z_b)（等价写法为 ½ Σ_b[(x_b−y_b)^2+(x_b−z_b)^2+(y_b−z_b)^2]），并将窗口平均功率取为 Ē = D（满窗时 Ē=M）以得到归一化信噪比 R = P3 / Ē；若需要完整功率谱或其它频点，可按定义 U_b[k] = Σ u_b[n] e^{−j2πnk/M} 和 P[k]=Σ_b |U_b[k]|^2 计算（用 FFT 库如 FFTW/numpy.fft），但仅当必须分析全谱时才使用完整变换。 另外明确不同映射之间的代数关系以便一致输出：任何实数映射 s[n]=Σ_b c_b u_b[n] 的频谱在 k 处为 S[k]=Σ_b c_b U_b[k]，其功率包含碱基间的交叉项；Z-curve 各分量可表示为 Voss 指示序列的线性组合或其累积差分，因此其在 k=M/3 处的谱能通过已知系数与 U_b[M/3] 或等价的帧计数 x_b,y_b,z_b 的线性/二次变换直接得到（即可在不做额外逐点 DFT 的情况下计算 Z-curve 在目标频点的能量）。 规定在每个窗口必须输出的标准特征字段：窗口起止位置与有效长度 D、三帧计数向量 {x_b,y_b,z_b}_{b∈I}、P3、Ē 和 R；可选但应标准化的扩展特征包括：目标频点邻近频带能量比（例如 P[k±Δ]/Ē）、Z-curve 各分量在 k=M/3 处的能量、窗口内 GC 含量、每帧的 k-mer（例如三核苷酸）频率向量及窗口序列的香农熵。 实现说明：推荐采用滑动窗口的增量计数实现（维护三帧×四碱基的整型计数表并在窗口移动时以 O(1) 更新）以高效计算每窗的 x_b,y_b,z_b 和 P3；当需要跨尺度计算时对每个 M 并行或串行执行相同流程并输出多尺度特征集合；所需输入仅为原始序列 S、待用 M 列表及可选的实数映射系数 c_b 或 Z-curve系数；常用工具包括 Python+NumPy（快速原型）和 C/C++ 或 Rust（高性能实现），FFT 库仅用于需要全谱时调用。 该子任务的输出是按窗口（及可选择的尺度）排列的、格式化的特征表（位置、D、x_b,y_b,z_b、P3,Ē,R 以及选填扩展特征），这些特征必须以一致的数值/单位定义保存以便其他模块直接使用。",
    "子任务2 的目标是设计与实现一个面向一维 DNA 碱基序列的高效滑动窗口谱能量计算引擎，要求在不对每个窗口执行完整 FFT 的前提下，以 O(1) 的摊销成本更新并输出每个窗口在目标频点 k = M/3 处的总功率 P3 以及归一化信噪比 R（其中 M 通常取为 3 的倍数），并支持多尺度并行计算、基于窗口得分到碱基级平滑得分的转换、边界窗口的有效长度处理与可扩展的实现细节；具体而言，本子任务包括以下内容并必须完整实现：输入为原始碱基序列 S[0..N-1]（字符集 {A,C,G,T}）、一个或多个窗口长度集合 {M_i}（优先选择 M_i 为 3 的倍数）、窗口步长（通常为 1）、窗口对齐策略（建议左对齐或中心对齐并在实现中明确任选一种），以及可选的多尺度融合权重与平滑核参数；算法核心基于在窗口上按位置模 3 分为三个帧并维护每个帧对四种碱基的整型计数矩阵 C[f∈{0,1,2}, b∈{A,C,G,T}]，对初始窗口一次性统计得到 C 并用闭式公式 P3 = Σ_b (x_b^2 + y_b^2 + z_b^2 − x_b y_b − x_b z_b − y_b z_b)（等价于 ½ Σ_b[(x_b−y_b)^2+(x_b−z_b)^2+(y_b−z_b)^2]）计算目标频点功率，窗口的平均功率 Ē 在满窗时等于 M（边界或截断窗用有效长度 D 代替），因此 R = P3 / Ē；随后窗口右移一位时只需识别被移出的碱基与新加入的碱基、确定它们在三个帧中的模 3 索引并在相应 C 元素上做常数次（O(1)）的加减更新，随后用整数计数代入闭式表达式重算 P3（建议用 64-bit 整数累加以防溢出并在最终计算 R 时转换为浮点），整个序列扫描对每个尺度的时间复杂度为 O(N) 且内存额外开销仅为每尺度 3×4 个计数与输出缓冲区；实现细节包括：为简化帧索引建议采用左对齐窗口（帧索引为全局位置 mod 3，避免中心对齐时帧随窗口移动的复杂映射），或若采用中心对齐则维护一个循环缓冲区记录窗口中每个位置的碱基与其帧编号以便快速移入移出；边界处理明确采用“有效窗长 D”策略（窗被截断时按实际覆盖长度计算 C 与 Ē），并可提供镜像填充或零填充作为可选策略（但须记录 D 以用于归一化）；多尺度支持要求为每个尺度并行维护各自的 C 矩阵并在同一次序列遍历中同时更新以减少内存访问与提高缓存效率，也可将不同尺度任务并行分配到线程/进程；基于窗口得分转为碱基级得分的步骤为：为每个窗口的中心或覆盖区累加其 R（或 P3）到覆盖的碱基位置上，并可按与窗口中心距离的高斯/三角权重进行加权累加，最终对每个碱基做归一化以得到平滑的 S_base[n]，该转换用于后续定位与分段；在某些情形下若需要完整频谱或 M 非 3 的倍数、或需分析邻域频带，则保留对候选段或少量窗口调用 FFT（推荐使用高性能库如 FFTW 或 numpy.fft），但不得对所有窗口频繁调用 FFT；实现时应优先使用低层高效语言（C/C++/Rust）实现滑动计数与 P3 更新内核，提供 Python/R 的高层封装用于参数配置、I/O 与可视化，使用 64-bit 整数计数和浮点归一化以保证数值稳定性，优化点包括：预计算碱基到索引的查表、避免分支的模 3 运算（用循环增量替代模运算以加速）、对多尺度并行更新做向量化或多线程分配，以及在大序列上分块处理以控制内存占用；输出格式应为按窗口记录的字段（窗口起止、有效长度 D、三帧计数向量、P3、Ē、R）与按碱基记录的 S_base 序列，并应提供可配置的参数（M 列表、对齐方式、权重、平滑核），最后明确时间复杂度为 O(N × S)（S 为尺度数）、附加内存为 O(S)（计数矩阵）加输出缓冲，且该模块应可独立运行、并能被上层模块调用用于候选段筛选或作为进一步统计/机器学习处理的特征输入。",
    "子任务 3（统计校准、判别规则与模型融合）的目标是把滑动窗口或片段级的频谱得分（如 P3、归一化 SNR 及可选的多尺度谱与 Z-curve 等衍生特征）转换为经过统计校准的判决与置信度，并将这些谱特征以可训练的方式融入概率模型或监督分类器以实现稳健的外显子/内含子分类；为此应按如下有序步骤精确实现：一、输入与准备——接收已注释的训练集（按碱基或按窗/片段标注的外显子/内含子标签）、每窗/片段的谱特征向量（P3、R、邻域频带能量、Z-curve 分量能量、GC 含量等）、以及可选的剪接位点 PWM 评分与物种先验；对训练集做清洗与平衡处理（记录类别不均衡并准备加权或重采样策略）；二、经验分布估计与单特征可区分性评估——在训练集上分别估计外显子与内含子在关键谱量（P3、R）上的经验分布，绘制并量化 ROC 曲线与 AUC，以判断单一谱特征的判别能力并据此决定是否需要多特征融合；三、统计显著性检验与多重检验校正——为获得可解释的阈值，基于保守与非保守的零假设构造 null 分布（例如完全随机打乱、保留单核苷酸频率或保留二联体频率的置换），对观测的 P3 计算经验 p 值，采用 Benjamini–Hochberg 等方法控制 FDR 并将 p 值门限映射回等效的 R/P3 阈值；四、阈值选择策略——根据应用需求在训练集上用交叉验证确定操作点：可选准则包括最大化 F1、在给定假阳性率(FPR)下最大召回、或在保证最小精确率下最大化召回；同时记录所选阈值在不同物种或不同基因类型上的性能差异以支持后续适配；五、多特征监督学习与概率校准——将谱特征与其它有用特征（Z-curve 能量、多尺度 P3、frame-specific k-mer 频率、splice-site 分数、局部熵等）构建特征矩阵并训练可解释或高性能分类器（如带正则化的逻辑回归、随机森林、XGBoost 或轻量神经网络），在训练过程中用嵌套交叉验证进行超参数搜索并采用类别权重或重采样处理不平衡；训练后对分类器输出的置信分数进行概率校准（Platt scaling 或 isotonic regression）以便输出可比较的后验概率；六、时序上下文整合（可选 HMM/semi‑Markov）——若需要利用序列上下文和长度约束，将经校准的谱特征作为发射概率融入 HMM 或半马尔科夫模型（显式建模外显子长度分布与剪接位点转移先验）并用 Viterbi 解码得到最优状态序列，或把监督分类器的局部概率作为 HMM 的输入以实现两步融合；七、后处理与置信度输出——对分类结果应用生物学约束（剔除短于 L_min 的片段、合并间距小于 G_max 的片段、基于局部 P3 峰或 splice-site PWM 评分微调端点），并为每个候选外显子输出综合置信度指标（校准后的后验概率、置换 p 值与 FDR 校正后的显著性、以及端点不确定性的置信区间）；八、评估与重校准流程——在独立验证集上报告核苷酸级与外显子段级的精确率/召回、ROC/AUC、端点误差分布与混淆矩阵，并据此迭代调整阈值与模型（必要时对不同物种或基因类型做分层/层次贝叶斯校准以应对样本量不足）；九、实施细节与工具建议——建议使用成熟机器学习与统计库（scikit-learn、XGBoost、statsmodels、pomegranate 或 hmmlearn 等 HMM 实现）、用置换检验实现经验 p 值（并行化置换以加速）、用 Benjamini–Hochberg 控制 FDR、采用嵌套交叉验证和训练集/验证集划分以避免过拟合，并保存训练好的模型与阈值以便在新数据上复用与增量重校准。该子任务的最终产出应包含：训练好的（并校准的）判别模型或阈值策略、可复现的显著性检验流程、统一的后处理规则以及对每个预测片段提供的概率化置信度和多重检验调整后的显著性指标。",
    "子任务 4 的目标是系统化地评估与量化基因预测流水线的性能、稳健性与不确定性，开展参数敏感性分析，提供基于频谱变化的候选突变（尤其移码/插入-删除）检测方法，并把整个验证与部署流程规范化为可复现的软件工件和报告。为此需按以下步骤实施：一是明确并实现评估指标与判据——在碱基级计算精确率、召回率和 F1；在外显子段级按“有任意重叠即命中”或按交并比（IoU）定义段级召回/精确度；报告 ROC 曲线与 AUC、精确率-召回曲线、端点定位误差的均值/中位数及分布图；二是构建数据划分与验证策略——准备带注释的数据集并划分为训练/验证/独立测试集（或采用 k‑fold 交叉验证），在每次划分上训练/校准模型并在未见数据上评估，所有实验保留随机种子以确保可重复；三是不确定性量化与显著性检验——对关键评分输出给出置信区间（例如通过自助法 bootstrap）、对窗口/片段的谱值采用置换检验（完全随机或保持一阶/二阶统计）获得经验 p 值并用 Benjamini–Hochberg 控制 FDR，将 p 值与校准后的概率同时作为置信度指标；四是系统性敏感性与稳健性分析——对关键参数（窗口长度集合 M、阈值/置信度截断、最短外显子长度、平滑核宽度、加权融合规则等）做网格搜索或局部灵敏度扫描，绘制参数-性能曲面并报告在生物学上合理参数区间内的性能波动，同时进行分层评估以考察不同物种或不同基因类型的性能差异；五是突变/移码候选检测流程——在基线频谱曲线上执行变点检测（可选算法：CUSUM、Binary Segmentation、Bayesian change-point 或专用包如 ruptures），识别显著的局部 P3 降落或上升区段，结合置换 p 值与效应大小（P3 变化比率）输出候选突变位点/区间并为每个候选提供置信度与建议后续验证（例如比对或深度测序）；六是校准与再训练策略——若跨物种或跨数据源性能差异显著，采用分层/贝叶斯收缩或按物种独立重估阈值与概率校准（Platt 或 isotonic regression），并提供自动化的增量再训练/更新流程；七是性能与资源基线、复现与部署规范——定义运行时复杂度与资源需求（核心滑动计数算法为 O(N) 每尺度、可并行化），实现模块化软件架构：高性能数值内核（C/C++/Rust）与 Python/R 的高层接口，完整的单元测试、参数配置、日志与版本化结果输出，建议使用 Docker 容器和工作流管理器（如 Snakemake 或 Nextflow）以保证环境可复现与批量并行处理；八是输出物与报告形式——为每次实验自动生成可视化报告（ROC/AUC、PR 曲线、校准曲线、参数敏感性图、端点误差直方图）、参数配置表、候选突变清单（坐标、p 值、效应量、置信度）、以及可供审计的结果数据包（原始评分、归一化曲线、训练/测试分割及随机种子）；九是工具建议——优先采用 numpy/pandas/scipy、scikit‑learn、statsmodels、ruptures 或等效变点工具、并行化库与可视化库，所有统计检验与多重检验步骤必须明确实现并记录以供审查。该子任务的完成应产生一套可重复、可审计的验证流程与软件组件，能让研究者量化方法在不同参数与不同物种下的可信度、识别可能的突变候选并将经验证的模型与阈值安全地部署到生产流水线或供后续实验验证使用。"
  ]
}