{
  "tasks": [],
  "problem_str": "问题背景：\n近年来，随着移动通信的发展，对系统容量的要求越来越高，频谱资源越来越紧缺。微蜂窝、微微蜂窝系统由于采用频谱复用技术缓解这个矛盾而得到广泛应用，这些系统的小区半径小于一千米，造成微蜂窝之间原来的统计相似关系丢失，这给运营商在网络初期规划带来了困难。因为实际情况经常不满足电磁场模型的条件，并且一般无法求解。若没有良好的传播预测模型，划分小区、选择基站位置和高度的唯一方法就是通过实际测量、反复测试。显然这需要投入大量的人力、时间，费用也会很高。而传播模型则根据对无线传输信道的模拟和仿真，预测接收信号，可以为指导网络规划提供较为准确的理论依据，链路预算小区半径，计算电波传播及干扰，当然希望越精确越好。\n\n目前，比较有代表性的就是射线跟踪模型。射线跟踪是一种被广泛用于移动通信和个人通信环境(街道微蜂窝和室内微微蜂窝)中的预测无线电波传播特性的技术，由于移动通信中使用的超高频微波和光同属电磁波，有一定近似性（当然还有差别），按光学方法辨认出多路径信道中收、发射机间所有主要的传播路径。一旦这些传播路径被辨认后，就可根据电波传播理论来计算每条传播路径信号的幅度、相位、延迟和极化，然后结合天线方向图和系统带宽就可得到到达接收点的所有传播路径的相干合成结果。\n\n城市环境下的微蜂窝主要指高楼密集区，覆盖范围大大缩小(半径仅为几百米甚至几十米)，基站天线(发射机)低于周围建筑物的高度，电波是在建筑物的“峡谷”当中传播。因此，电波经过屋顶绕射后再到达地面接收点的射线路径数量非常少，而且其场强与经过建筑物多次反射和绕射的路径相比，往往可以忽略，地面的反射也不考虑。这些特点构成了微小区中电波传播的主要特点。因此，可以假设微蜂窝环境下建筑物的高度高于基站天线的高度，从而将三维问题近似地简化成二维问题，只考虑两种传播机制：反射和绕射。这种简化大大地提高了射线跟踪模型的预测效率，同时能够得到可以接受的预测精度。\n\n对于城市微蜂窝的二维模型，建筑群可被划分为一定的“块”，建筑物(即图1中带有灰色阴影的多边形)则被定义为“多边形”，多边形的“边”代表建筑物的表面，多边形的“顶点”则代表了建筑物的拐角。这种简化了的市区平面图大致反映出城市的主体结构，利用它进行射线跟踪，可以得到较为准确的路径损耗。图1所示二维视图的所有数据详见文件“城市微小区地图对应的数据.txt”。该数据的说明如图2所示，每个红框内的数据对应一个建筑物。例如，第一行的00001表示建筑物的序列号，buildings 表示存储的是建筑的信息，00005表示该建筑物共有5个顶点(其中第一个点和最后一个点为同一个点，构成一个闭合的多边形，这样才能完整地表述一个建筑物)。以下各行分别是每个顶点的二维坐标值(单位是米)，直到第六行结束。每行数据的第一列和第二列分别对应着x坐标值和y坐标值（计算时无须取这么多有效数字）。\n\n在多边形的顶点上仅能产生绕射，而在多边形的边上仅能产生反射，这些多次的反射、绕射及其组合便是收、发射机间的传播路径。二维射线跟踪模型可以通过以下两种规律分别确定反射传播路径和绕射传播路径：\n\n反射传播路径，如图3(a)所示，产生反射时入射角θi等于反射角θr;\n\n绕射传播路径，如图3(b)所示，不论入射线以任意角度入射到建筑物顶点上，绕射射线都会以任意出射角向没有建筑物覆盖的区域传播。\n\n图3 两种传播机制的传播规律示意图\n\n为了简化所要解决问题（与反射和绕射相关），降低计算难度，假设图1中所有建筑物为理想电介质，下面给出与反射和绕射相关的详细说明：\n\n(1) 电磁波在不同介质交接处，会发生反射。如果电磁波传播到理想电介质表面，则80%的能量按照如图3(a)所示的反射传播规律被反射出来，其余能量进入新介质继续传播（在理想导体表面将发生能量全反射，反射波Er和入射波Ei的强度相等）。\n\n(2) 绕射是指在电磁波传播路径上，当电波被尺寸较大(与波长相比)的障碍物遮挡时，电磁波改变传播方向的现象。为了解决类似于如图3(b)中建筑物顶点(可称为劈)上的绕射问题，需要计算绕射系数，该系数体现出了绕射后绕射波强度Ed的衰减程度，即。图4为发生在劈的绕射示意图，下面是绕射系数的计算方法。\n\n计算方法：\n\n$$D_n = \\frac{e^{-j\\pi/4}}{2n\\sqrt{2\\pi kLa}} \\{ [ \\cot(\\tfrac{\\pi+\\beta}{2}) - \\cot(\\tfrac{\\pi-\\beta}{2}) ] F(kLa\\cos\\tfrac{\\pi+\\beta}{2}) + [ \\cot(\\tfrac{\\pi+\\beta}{2}) + \\cot(\\tfrac{\\pi-\\beta}{2}) ] F(kLa\\cos\\tfrac{\\pi-\\beta}{2}) \\} \\tag{1}$$\n\n其中 $k = 2\\pi/\\lambda$，$L$ 为绕射点到场点距离，$n = -\\alpha_3/(2\\pi)$，$F(x)$ 为过渡函数：\n\n$$F(x) = 2 e^{-jx^2} \\int_x^{+\\infty} e^{j\\tau^2} d\\tau \\tag{2}$$\n\n(1) $0\\le x <0.001$: $$F(x) \\approx \\tfrac{2}{3}\\pi jx e^{-j\\pi/4} - je^{j\\pi/4}x^2 - je^{j\\pi/4}x^4 \\tag{3}$$\n\n(2) $x>10$: $$F(x) \\approx 1 + \\tfrac{j}{2x} - \\tfrac{1}{4x^2} - \\tfrac{j}{8x^3} + \\tfrac{1}{16x^4} \\tag{4}$$\n\n(3) $0.001 \\le x \\le 10$: 直接计算积分 (2)，借助：\n$$\\int_{-\\infty}^{\\infty} e^{-au^2+bu} du = \\sqrt{\\tfrac{\\pi}{a}} e^{b^2/(4a)} \\tag{5}$$\n得到：\n$$F(x) = 2 e^{-jx^2} \\int_0^{\\infty} e^{j\\tau^2} d\\tau = 2 e^{-jx^2} \\int_0^{\\infty} e^{j\\pi\\tau^2/2} d\\tau \\tag{6}$$\n\n再定义：$$\\alpha^\\pm = \\beta \\pm (\\alpha_2-\\alpha_1)/2, \\quad N^\\pm = \\text{最接近 } 2n\\pi \\pm \\beta - \\pi \\text{ 的整数} \\tag{7,8,9}$$\n\n仅考虑路径：反射≤7次，绕射≤2次，一次绕射+1–4次反射，两次绕射+一次反射。\n\n视距传播场强：$$E_{LOS} = \\tfrac{E_0}{r_0} e^{jkr_0} \\tag{10}$$\n\n式中，k为波数， 为发射电场强度，为直射波的传播路径长。\n\n若是非视距传播的路径，则从发射天线出发，先利用公式(10)计算出天线在第一结点处的辐射场 ，然后沿着射线路径推进计算，直至到达接收点，求得此条射线路径在接收点处对总场强的贡献。\n\n问题要求：\n请研究下列问题：\n一、基本问题\n(1)  电波从发射天线出发，向空间各个方向均匀发射。为了能够进行数值计算，我们需要将总的发射能量均匀地分配到若干条射线上，这个过程称之为发射角量化过程。显然，规定的射线条数越多，量化就越精细，计算量也就越大。因此请根据实际情况，首先选择定量化的精细程度，然后跟踪确定发射机Tx (坐标为(500, 200))和接收机Rx (坐标为(250, 350))间的主要传播路径，并可视化展示在图1中。\n(2) 如图1所示，在路径AB（两点坐标分别为(300, 350)和(500, 350)）上以50m为间隔取5个位置准备放置发射机；在路径CD（两点分别为(450, 300)和(450, 200)）上以25m为间隔取5个位置准备放置接收机；这样有25种发射机-接收机组合。请问哪一个组合收发机间的传播路径最多，哪一个组合最少？\n(3) 将(2)中所有发射机-接收机组合的传播路径进行比对，请寻找尽可能多的规律。\n二、宽带问题\n(4) 两个或两个以上的波相遇时，在一定情况下会相互影响，这种现象叫干涉现象。声波、光波和其他电磁波等都有此现象。考虑如下的多波干涉问题：对于(2)中提到的CD路径上的所有接收点，从发射机出发的电波都有多个传播途径(可能是多次反射传播、多次绕射传播或是反射与绕射的任意组合传播)到达这些点，这些频率相同、振动方向相同、初相位相同的简谐波（即正弦波）在各个接收点相遇叠加，出现某些接收点振动始终加强、而在另一些接收点振动始终减弱的现象，这种现象称为多波干涉现象。 \n上述接收点处，多波干涉形成的接收信号可以描述为\n$$f(\\omega, t) = \\sum_{i=1}^{Q} A_i e^{j(\\omega t + k r_i)}$$\n上式中，Q为到达某接收点的传播途径总数；和分别为到达接收点的第i条传播路径的信号电场强度和长度；为长度为的传播路径上的相位积累；(c为光速，值为)。\n请针对上述25种情况, 对这种多波干涉的振幅$|f(w,t)|$进行统计学分析，包括：一、二阶矩特性，不同路径到达信号的相关性及概率密度分布函数；\n(5) 继续考虑图1，从发射机同时发射一组功率相同的电波，频率从2000Mhz到2100Mhz，间隔近似1Mhz，这样我们总共要同时发射101个单频信号。每个单频信号都会形成(4)中提到多波干涉问题，多个单频信号会形成宽带多波干涉现象，请对这种宽带多波干涉现象进行数学建模，并分析合成波的包络统计特性，如同一频率、不同路径信号之间，同一路径、不同频率信号之间的相关性等。\nAddendum: \n参考文献\n\n [1] R G. Kouyoumjian, P H Pathak, “A uniform geometrical theory of diffraction for an edge in a perfectly conducting surface”, IEEE Proceedings, vol. 62, No. 11, pp. 1448-1461, Jun. 1974\n\n[2] M. F. Catedra, J. Perez, F. Saez De Adana, and O. Gutierrez, \"Efficient Ray-tracing Techniques for Three-dimensional Analyses of Propagation in Mobile Communications: Application to Picocell and Microcell Scenarios,\" IEEE Antennas Propag. Mag., vol. 40, no. 2, pp. 15-28, Apr. 1998.\n\n[3] Georgia E. Athanasiadou, Andrew R. Nix, and Joseph. McGeehan. “A Microcellular Ray-Tracing Propagation Model and Evaluation of its Narrow-Band and Wide-Band Predictions,” IEEE Journal on Selected Areas in Communications, vol.18, no. 3, pp. 322-334, Mar. 2000\n\n[4] C. E Yang, B. C. Wu, “A Ray-Tracing Method for Modeling Indoor Wave Propagation and Penetration,” IEEE Trans. On A. and P., Vol. 46, No. 6，PP. 907-919, June 1998.\n\n[5] 顾晓龙. “利用可见性概念改进基于镜像原理的射线追踪法”, 电波科学学报，Vol. 16, No, 4, pp. 16-19, 2001\n\n[6] George Liang, Henry L. Bertoni, ”A New Approach to 3D Ray Tracing for Site Specific Propagation Modeling,” IEEE VT. C., PP. 1l13-1117, 1997.\n\n[7] D. N. Schettino, F. J. S. Moreira and C. G. Rego, “Efficient Ray Tracing for Radio Channel Characterization of Urban Scenarios,” IEEE Trans. Magn., vol. 43, no. 4, pp. 1305-1308, Apr. 2007.\n\n[8] 廖斌, 赵昵丽, 朱守正,”基于虚拟源树的射线跟踪算法的研究,” 华东师范大学学报,  2008:103-108\n\n[9] Chiya Saeidi, Farrokh Hodjatkashani, and Azim Fard, “New Tube-Based Shooting and Bouncing Ray Tracing Method,” 2009 International Conference on Advanced Technologies for Communications, pp.269-273\n\n[10]袁正午，移动通信系统终端射线跟踪定位理论与方法，2007，北京：电子工业出版社\nDataset Path:\n['1974_a_uniform_geometrical_theory_of_diffraction_for_an_edge_in_a_perfectly_conductiong_surface.pdf', '00683539.pdf', '00686774.pdf', '00686780.pdf', '00840192.pdf', '04137803.pdf', '05349441.pdf', '基于虚拟源树的射线跟踪算法的研究.pdf', '利用可见性概念改进基于镜像原理的射线追踪法.pdf', '绕射系数.tex']\n\nData Description:\n该数据集由一组以文件名或内部标识符为键的条目构成，条目主要涉及电磁/声学散射与射线跟踪领域的经典理论与算法研究，包含英文经典文献标题（如 1974 年关于在理想导电面上边缘的统一几何绕射理论）以及若干以数字编码命名的条目和中文论文题目（如“基于虚拟源树的射线跟踪算法的研究”“利用可见性概念改进基于镜像原理的射线追踪法”），还包括一个名为“绕射系数”的 TeX 源文件。当前数据集中的各项值均为占位符或空对象（'{}'），说明元数据尚未填充或以外部文件形式存在，唯一的实质性文件提示是一个 TeX 文档指向绕射系数的数学描述或实现。总体上该集合适合用于建立围绕几何理论绕射（GTD/UTD）、基于镜像的射线追踪、虚拟源方法、可见性分析及绕射系数计算等主题的文献汇编、教学资料库或算法实现参考；但在直接使用前需要补全或关联完整元数据（作者、年份、期刊/会议、摘要、PDF/源码）、标准标识符（DOI、ISBN 等）和版权信息。推荐的整理与处理步骤包括：解析并索引 TeX 源以提取公式与定义，批量检索和映射数字标识到正式文献记录，补充条目的结构化元数据，统一命名规范并为每条目附加原文或可访问的副本；此外应注意版权合规与引用规范。对研究者而言，该数据集是构建专业文献库、比对数值散射模型、实现或验证射线跟踪与绕射系数计算算法的有价值起点，但需要额外的数据清洗与补充工作以达到可重复实验和发布共享的标准。",
  "problem": {
    "background": "近年来，随着移动通信的发展，对系统容量的要求越来越高，频谱资源越来越紧缺。微蜂窝、微微蜂窝系统由于采用频谱复用技术缓解这个矛盾而得到广泛应用，这些系统的小区半径小于一千米，造成微蜂窝之间原来的统计相似关系丢失，这给运营商在网络初期规划带来了困难。因为实际情况经常不满足电磁场模型的条件，并且一般无法求解。若没有良好的传播预测模型，划分小区、选择基站位置和高度的唯一方法就是通过实际测量、反复测试。显然这需要投入大量的人力、时间，费用也会很高。而传播模型则根据对无线传输信道的模拟和仿真，预测接收信号，可以为指导网络规划提供较为准确的理论依据，链路预算小区半径，计算电波传播及干扰，当然希望越精确越好。\n\n目前，比较有代表性的就是射线跟踪模型。射线跟踪是一种被广泛用于移动通信和个人通信环境(街道微蜂窝和室内微微蜂窝)中的预测无线电波传播特性的技术，由于移动通信中使用的超高频微波和光同属电磁波，有一定近似性（当然还有差别），按光学方法辨认出多路径信道中收、发射机间所有主要的传播路径。一旦这些传播路径被辨认后，就可根据电波传播理论来计算每条传播路径信号的幅度、相位、延迟和极化，然后结合天线方向图和系统带宽就可得到到达接收点的所有传播路径的相干合成结果。\n\n城市环境下的微蜂窝主要指高楼密集区，覆盖范围大大缩小(半径仅为几百米甚至几十米)，基站天线(发射机)低于周围建筑物的高度，电波是在建筑物的“峡谷”当中传播。因此，电波经过屋顶绕射后再到达地面接收点的射线路径数量非常少，而且其场强与经过建筑物多次反射和绕射的路径相比，往往可以忽略，地面的反射也不考虑。这些特点构成了微小区中电波传播的主要特点。因此，可以假设微蜂窝环境下建筑物的高度高于基站天线的高度，从而将三维问题近似地简化成二维问题，只考虑两种传播机制：反射和绕射。这种简化大大地提高了射线跟踪模型的预测效率，同时能够得到可以接受的预测精度。\n\n对于城市微蜂窝的二维模型，建筑群可被划分为一定的“块”，建筑物(即图1中带有灰色阴影的多边形)则被定义为“多边形”，多边形的“边”代表建筑物的表面，多边形的“顶点”则代表了建筑物的拐角。这种简化了的市区平面图大致反映出城市的主体结构，利用它进行射线跟踪，可以得到较为准确的路径损耗。图1所示二维视图的所有数据详见文件“城市微小区地图对应的数据.txt”。该数据的说明如图2所示，每个红框内的数据对应一个建筑物。例如，第一行的00001表示建筑物的序列号，buildings 表示存储的是建筑的信息，00005表示该建筑物共有5个顶点(其中第一个点和最后一个点为同一个点，构成一个闭合的多边形，这样才能完整地表述一个建筑物)。以下各行分别是每个顶点的二维坐标值(单位是米)，直到第六行结束。每行数据的第一列和第二列分别对应着x坐标值和y坐标值（计算时无须取这么多有效数字）。\n\n在多边形的顶点上仅能产生绕射，而在多边形的边上仅能产生反射，这些多次的反射、绕射及其组合便是收、发射机间的传播路径。二维射线跟踪模型可以通过以下两种规律分别确定反射传播路径和绕射传播路径：\n\n反射传播路径，如图3(a)所示，产生反射时入射角θi等于反射角θr;\n\n绕射传播路径，如图3(b)所示，不论入射线以任意角度入射到建筑物顶点上，绕射射线都会以任意出射角向没有建筑物覆盖的区域传播。\n\n图3 两种传播机制的传播规律示意图\n\n为了简化所要解决问题（与反射和绕射相关），降低计算难度，假设图1中所有建筑物为理想电介质，下面给出与反射和绕射相关的详细说明：\n\n(1) 电磁波在不同介质交接处，会发生反射。如果电磁波传播到理想电介质表面，则80%的能量按照如图3(a)所示的反射传播规律被反射出来，其余能量进入新介质继续传播（在理想导体表面将发生能量全反射，反射波Er和入射波Ei的强度相等）。\n\n(2) 绕射是指在电磁波传播路径上，当电波被尺寸较大(与波长相比)的障碍物遮挡时，电磁波改变传播方向的现象。为了解决类似于如图3(b)中建筑物顶点(可称为劈)上的绕射问题，需要计算绕射系数，该系数体现出了绕射后绕射波强度Ed的衰减程度，即。图4为发生在劈的绕射示意图，下面是绕射系数的计算方法。\n\n计算方法：\n\n$$D_n = \\frac{e^{-j\\pi/4}}{2n\\sqrt{2\\pi kLa}} \\{ [ \\cot(\\tfrac{\\pi+\\beta}{2}) - \\cot(\\tfrac{\\pi-\\beta}{2}) ] F(kLa\\cos\\tfrac{\\pi+\\beta}{2}) + [ \\cot(\\tfrac{\\pi+\\beta}{2}) + \\cot(\\tfrac{\\pi-\\beta}{2}) ] F(kLa\\cos\\tfrac{\\pi-\\beta}{2}) \\} \\tag{1}$$\n\n其中 $k = 2\\pi/\\lambda$，$L$ 为绕射点到场点距离，$n = -\\alpha_3/(2\\pi)$，$F(x)$ 为过渡函数：\n\n$$F(x) = 2 e^{-jx^2} \\int_x^{+\\infty} e^{j\\tau^2} d\\tau \\tag{2}$$\n\n(1) $0\\le x <0.001$: $$F(x) \\approx \\tfrac{2}{3}\\pi jx e^{-j\\pi/4} - je^{j\\pi/4}x^2 - je^{j\\pi/4}x^4 \\tag{3}$$\n\n(2) $x>10$: $$F(x) \\approx 1 + \\tfrac{j}{2x} - \\tfrac{1}{4x^2} - \\tfrac{j}{8x^3} + \\tfrac{1}{16x^4} \\tag{4}$$\n\n(3) $0.001 \\le x \\le 10$: 直接计算积分 (2)，借助：\n$$\\int_{-\\infty}^{\\infty} e^{-au^2+bu} du = \\sqrt{\\tfrac{\\pi}{a}} e^{b^2/(4a)} \\tag{5}$$\n得到：\n$$F(x) = 2 e^{-jx^2} \\int_0^{\\infty} e^{j\\tau^2} d\\tau = 2 e^{-jx^2} \\int_0^{\\infty} e^{j\\pi\\tau^2/2} d\\tau \\tag{6}$$\n\n再定义：$$\\alpha^\\pm = \\beta \\pm (\\alpha_2-\\alpha_1)/2, \\quad N^\\pm = \\text{最接近 } 2n\\pi \\pm \\beta - \\pi \\text{ 的整数} \\tag{7,8,9}$$\n\n仅考虑路径：反射≤7次，绕射≤2次，一次绕射+1–4次反射，两次绕射+一次反射。\n\n视距传播场强：$$E_{LOS} = \\tfrac{E_0}{r_0} e^{jkr_0} \\tag{10}$$\n\n式中，k为波数， 为发射电场强度，为直射波的传播路径长。\n\n若是非视距传播的路径，则从发射天线出发，先利用公式(10)计算出天线在第一结点处的辐射场 ，然后沿着射线路径推进计算，直至到达接收点，求得此条射线路径在接收点处对总场强的贡献。",
    "problem_requirement": "请研究下列问题：\n一、基本问题\n(1)  电波从发射天线出发，向空间各个方向均匀发射。为了能够进行数值计算，我们需要将总的发射能量均匀地分配到若干条射线上，这个过程称之为发射角量化过程。显然，规定的射线条数越多，量化就越精细，计算量也就越大。因此请根据实际情况，首先选择定量化的精细程度，然后跟踪确定发射机Tx (坐标为(500, 200))和接收机Rx (坐标为(250, 350))间的主要传播路径，并可视化展示在图1中。\n(2) 如图1所示，在路径AB（两点坐标分别为(300, 350)和(500, 350)）上以50m为间隔取5个位置准备放置发射机；在路径CD（两点分别为(450, 300)和(450, 200)）上以25m为间隔取5个位置准备放置接收机；这样有25种发射机-接收机组合。请问哪一个组合收发机间的传播路径最多，哪一个组合最少？\n(3) 将(2)中所有发射机-接收机组合的传播路径进行比对，请寻找尽可能多的规律。\n二、宽带问题\n(4) 两个或两个以上的波相遇时，在一定情况下会相互影响，这种现象叫干涉现象。声波、光波和其他电磁波等都有此现象。考虑如下的多波干涉问题：对于(2)中提到的CD路径上的所有接收点，从发射机出发的电波都有多个传播途径(可能是多次反射传播、多次绕射传播或是反射与绕射的任意组合传播)到达这些点，这些频率相同、振动方向相同、初相位相同的简谐波（即正弦波）在各个接收点相遇叠加，出现某些接收点振动始终加强、而在另一些接收点振动始终减弱的现象，这种现象称为多波干涉现象。 \n上述接收点处，多波干涉形成的接收信号可以描述为\n$$f(\\omega, t) = \\sum_{i=1}^{Q} A_i e^{j(\\omega t + k r_i)}$$\n上式中，Q为到达某接收点的传播途径总数；和分别为到达接收点的第i条传播路径的信号电场强度和长度；为长度为的传播路径上的相位积累；(c为光速，值为)。\n请针对上述25种情况, 对这种多波干涉的振幅$|f(w,t)|$进行统计学分析，包括：一、二阶矩特性，不同路径到达信号的相关性及概率密度分布函数；\n(5) 继续考虑图1，从发射机同时发射一组功率相同的电波，频率从2000Mhz到2100Mhz，间隔近似1Mhz，这样我们总共要同时发射101个单频信号。每个单频信号都会形成(4)中提到多波干涉问题，多个单频信号会形成宽带多波干涉现象，请对这种宽带多波干涉现象进行数学建模，并分析合成波的包络统计特性，如同一频率、不同路径信号之间，同一路径、不同频率信号之间的相关性等。",
    "dataset_path": [
      "1974_a_uniform_geometrical_theory_of_diffraction_for_an_edge_in_a_perfectly_conductiong_surface.pdf",
      "00683539.pdf",
      "00686774.pdf",
      "00686780.pdf",
      "00840192.pdf",
      "04137803.pdf",
      "05349441.pdf",
      "基于虚拟源树的射线跟踪算法的研究.pdf",
      "利用可见性概念改进基于镜像原理的射线追踪法.pdf",
      "绕射系数.tex"
    ],
    "dataset_description": {
      "1974_a_uniform_geometrical_theory_of_diffraction_for_an_edge_in_a_perfectly_conductiong_surface": "{}",
      "00683539": "{}",
      "00686774": "{}",
      "00686780": "{}",
      "00840192": "{}",
      "04137803": "{}",
      "05349441": "{}",
      "基于虚拟源树的射线跟踪算法的研究": "{}",
      "利用可见性概念改进基于镜像原理的射线追踪法": "{}",
      "绕射系数": ".tex"
    },
    "variable_description": [],
    "addendum": "参考文献\n\n [1] R G. Kouyoumjian, P H Pathak, “A uniform geometrical theory of diffraction for an edge in a perfectly conducting surface”, IEEE Proceedings, vol. 62, No. 11, pp. 1448-1461, Jun. 1974\n\n[2] M. F. Catedra, J. Perez, F. Saez De Adana, and O. Gutierrez, \"Efficient Ray-tracing Techniques for Three-dimensional Analyses of Propagation in Mobile Communications: Application to Picocell and Microcell Scenarios,\" IEEE Antennas Propag. Mag., vol. 40, no. 2, pp. 15-28, Apr. 1998.\n\n[3] Georgia E. Athanasiadou, Andrew R. Nix, and Joseph. McGeehan. “A Microcellular Ray-Tracing Propagation Model and Evaluation of its Narrow-Band and Wide-Band Predictions,” IEEE Journal on Selected Areas in Communications, vol.18, no. 3, pp. 322-334, Mar. 2000\n\n[4] C. E Yang, B. C. Wu, “A Ray-Tracing Method for Modeling Indoor Wave Propagation and Penetration,” IEEE Trans. On A. and P., Vol. 46, No. 6，PP. 907-919, June 1998.\n\n[5] 顾晓龙. “利用可见性概念改进基于镜像原理的射线追踪法”, 电波科学学报，Vol. 16, No, 4, pp. 16-19, 2001\n\n[6] George Liang, Henry L. Bertoni, ”A New Approach to 3D Ray Tracing for Site Specific Propagation Modeling,” IEEE VT. C., PP. 1l13-1117, 1997.\n\n[7] D. N. Schettino, F. J. S. Moreira and C. G. Rego, “Efficient Ray Tracing for Radio Channel Characterization of Urban Scenarios,” IEEE Trans. Magn., vol. 43, no. 4, pp. 1305-1308, Apr. 2007.\n\n[8] 廖斌, 赵昵丽, 朱守正,”基于虚拟源树的射线跟踪算法的研究,” 华东师范大学学报,  2008:103-108\n\n[9] Chiya Saeidi, Farrokh Hodjatkashani, and Azim Fard, “New Tube-Based Shooting and Bouncing Ray Tracing Method,” 2009 International Conference on Advanced Technologies for Communications, pp.269-273\n\n[10]袁正午，移动通信系统终端射线跟踪定位理论与方法，2007，北京：电子工业出版社",
    "data_summary": "Dataset Path:\n['1974_a_uniform_geometrical_theory_of_diffraction_for_an_edge_in_a_perfectly_conductiong_surface.pdf', '00683539.pdf', '00686774.pdf', '00686780.pdf', '00840192.pdf', '04137803.pdf', '05349441.pdf', '基于虚拟源树的射线跟踪算法的研究.pdf', '利用可见性概念改进基于镜像原理的射线追踪法.pdf', '绕射系数.tex']\n\nData Description:\n该数据集由一组以文件名或内部标识符为键的条目构成，条目主要涉及电磁/声学散射与射线跟踪领域的经典理论与算法研究，包含英文经典文献标题（如 1974 年关于在理想导电面上边缘的统一几何绕射理论）以及若干以数字编码命名的条目和中文论文题目（如“基于虚拟源树的射线跟踪算法的研究”“利用可见性概念改进基于镜像原理的射线追踪法”），还包括一个名为“绕射系数”的 TeX 源文件。当前数据集中的各项值均为占位符或空对象（'{}'），说明元数据尚未填充或以外部文件形式存在，唯一的实质性文件提示是一个 TeX 文档指向绕射系数的数学描述或实现。总体上该集合适合用于建立围绕几何理论绕射（GTD/UTD）、基于镜像的射线追踪、虚拟源方法、可见性分析及绕射系数计算等主题的文献汇编、教学资料库或算法实现参考；但在直接使用前需要补全或关联完整元数据（作者、年份、期刊/会议、摘要、PDF/源码）、标准标识符（DOI、ISBN 等）和版权信息。推荐的整理与处理步骤包括：解析并索引 TeX 源以提取公式与定义，批量检索和映射数字标识到正式文献记录，补充条目的结构化元数据，统一命名规范并为每条目附加原文或可访问的副本；此外应注意版权合规与引用规范。对研究者而言，该数据集是构建专业文献库、比对数值散射模型、实现或验证射线跟踪与绕射系数计算算法的有价值起点，但需要额外的数据清洗与补充工作以达到可重复实验和发布共享的标准。",
    "data_description": {
      "1974_a_uniform_geometrical_theory_of_diffraction_for_an_edge_in_a_perfectly_conductiong_surface": "{}",
      "00683539": "{}",
      "00686774": "{}",
      "00686780": "{}",
      "00840192": "{}",
      "04137803": "{}",
      "05349441": "{}",
      "基于虚拟源树的射线跟踪算法的研究": "{}",
      "利用可见性概念改进基于镜像原理的射线追踪法": "{}",
      "绕射系数": ".tex"
    },
    "problem_str": "问题背景：\n近年来，随着移动通信的发展，对系统容量的要求越来越高，频谱资源越来越紧缺。微蜂窝、微微蜂窝系统由于采用频谱复用技术缓解这个矛盾而得到广泛应用，这些系统的小区半径小于一千米，造成微蜂窝之间原来的统计相似关系丢失，这给运营商在网络初期规划带来了困难。因为实际情况经常不满足电磁场模型的条件，并且一般无法求解。若没有良好的传播预测模型，划分小区、选择基站位置和高度的唯一方法就是通过实际测量、反复测试。显然这需要投入大量的人力、时间，费用也会很高。而传播模型则根据对无线传输信道的模拟和仿真，预测接收信号，可以为指导网络规划提供较为准确的理论依据，链路预算小区半径，计算电波传播及干扰，当然希望越精确越好。\n\n目前，比较有代表性的就是射线跟踪模型。射线跟踪是一种被广泛用于移动通信和个人通信环境(街道微蜂窝和室内微微蜂窝)中的预测无线电波传播特性的技术，由于移动通信中使用的超高频微波和光同属电磁波，有一定近似性（当然还有差别），按光学方法辨认出多路径信道中收、发射机间所有主要的传播路径。一旦这些传播路径被辨认后，就可根据电波传播理论来计算每条传播路径信号的幅度、相位、延迟和极化，然后结合天线方向图和系统带宽就可得到到达接收点的所有传播路径的相干合成结果。\n\n城市环境下的微蜂窝主要指高楼密集区，覆盖范围大大缩小(半径仅为几百米甚至几十米)，基站天线(发射机)低于周围建筑物的高度，电波是在建筑物的“峡谷”当中传播。因此，电波经过屋顶绕射后再到达地面接收点的射线路径数量非常少，而且其场强与经过建筑物多次反射和绕射的路径相比，往往可以忽略，地面的反射也不考虑。这些特点构成了微小区中电波传播的主要特点。因此，可以假设微蜂窝环境下建筑物的高度高于基站天线的高度，从而将三维问题近似地简化成二维问题，只考虑两种传播机制：反射和绕射。这种简化大大地提高了射线跟踪模型的预测效率，同时能够得到可以接受的预测精度。\n\n对于城市微蜂窝的二维模型，建筑群可被划分为一定的“块”，建筑物(即图1中带有灰色阴影的多边形)则被定义为“多边形”，多边形的“边”代表建筑物的表面，多边形的“顶点”则代表了建筑物的拐角。这种简化了的市区平面图大致反映出城市的主体结构，利用它进行射线跟踪，可以得到较为准确的路径损耗。图1所示二维视图的所有数据详见文件“城市微小区地图对应的数据.txt”。该数据的说明如图2所示，每个红框内的数据对应一个建筑物。例如，第一行的00001表示建筑物的序列号，buildings 表示存储的是建筑的信息，00005表示该建筑物共有5个顶点(其中第一个点和最后一个点为同一个点，构成一个闭合的多边形，这样才能完整地表述一个建筑物)。以下各行分别是每个顶点的二维坐标值(单位是米)，直到第六行结束。每行数据的第一列和第二列分别对应着x坐标值和y坐标值（计算时无须取这么多有效数字）。\n\n在多边形的顶点上仅能产生绕射，而在多边形的边上仅能产生反射，这些多次的反射、绕射及其组合便是收、发射机间的传播路径。二维射线跟踪模型可以通过以下两种规律分别确定反射传播路径和绕射传播路径：\n\n反射传播路径，如图3(a)所示，产生反射时入射角θi等于反射角θr;\n\n绕射传播路径，如图3(b)所示，不论入射线以任意角度入射到建筑物顶点上，绕射射线都会以任意出射角向没有建筑物覆盖的区域传播。\n\n图3 两种传播机制的传播规律示意图\n\n为了简化所要解决问题（与反射和绕射相关），降低计算难度，假设图1中所有建筑物为理想电介质，下面给出与反射和绕射相关的详细说明：\n\n(1) 电磁波在不同介质交接处，会发生反射。如果电磁波传播到理想电介质表面，则80%的能量按照如图3(a)所示的反射传播规律被反射出来，其余能量进入新介质继续传播（在理想导体表面将发生能量全反射，反射波Er和入射波Ei的强度相等）。\n\n(2) 绕射是指在电磁波传播路径上，当电波被尺寸较大(与波长相比)的障碍物遮挡时，电磁波改变传播方向的现象。为了解决类似于如图3(b)中建筑物顶点(可称为劈)上的绕射问题，需要计算绕射系数，该系数体现出了绕射后绕射波强度Ed的衰减程度，即。图4为发生在劈的绕射示意图，下面是绕射系数的计算方法。\n\n计算方法：\n\n$$D_n = \\frac{e^{-j\\pi/4}}{2n\\sqrt{2\\pi kLa}} \\{ [ \\cot(\\tfrac{\\pi+\\beta}{2}) - \\cot(\\tfrac{\\pi-\\beta}{2}) ] F(kLa\\cos\\tfrac{\\pi+\\beta}{2}) + [ \\cot(\\tfrac{\\pi+\\beta}{2}) + \\cot(\\tfrac{\\pi-\\beta}{2}) ] F(kLa\\cos\\tfrac{\\pi-\\beta}{2}) \\} \\tag{1}$$\n\n其中 $k = 2\\pi/\\lambda$，$L$ 为绕射点到场点距离，$n = -\\alpha_3/(2\\pi)$，$F(x)$ 为过渡函数：\n\n$$F(x) = 2 e^{-jx^2} \\int_x^{+\\infty} e^{j\\tau^2} d\\tau \\tag{2}$$\n\n(1) $0\\le x <0.001$: $$F(x) \\approx \\tfrac{2}{3}\\pi jx e^{-j\\pi/4} - je^{j\\pi/4}x^2 - je^{j\\pi/4}x^4 \\tag{3}$$\n\n(2) $x>10$: $$F(x) \\approx 1 + \\tfrac{j}{2x} - \\tfrac{1}{4x^2} - \\tfrac{j}{8x^3} + \\tfrac{1}{16x^4} \\tag{4}$$\n\n(3) $0.001 \\le x \\le 10$: 直接计算积分 (2)，借助：\n$$\\int_{-\\infty}^{\\infty} e^{-au^2+bu} du = \\sqrt{\\tfrac{\\pi}{a}} e^{b^2/(4a)} \\tag{5}$$\n得到：\n$$F(x) = 2 e^{-jx^2} \\int_0^{\\infty} e^{j\\tau^2} d\\tau = 2 e^{-jx^2} \\int_0^{\\infty} e^{j\\pi\\tau^2/2} d\\tau \\tag{6}$$\n\n再定义：$$\\alpha^\\pm = \\beta \\pm (\\alpha_2-\\alpha_1)/2, \\quad N^\\pm = \\text{最接近 } 2n\\pi \\pm \\beta - \\pi \\text{ 的整数} \\tag{7,8,9}$$\n\n仅考虑路径：反射≤7次，绕射≤2次，一次绕射+1–4次反射，两次绕射+一次反射。\n\n视距传播场强：$$E_{LOS} = \\tfrac{E_0}{r_0} e^{jkr_0} \\tag{10}$$\n\n式中，k为波数， 为发射电场强度，为直射波的传播路径长。\n\n若是非视距传播的路径，则从发射天线出发，先利用公式(10)计算出天线在第一结点处的辐射场 ，然后沿着射线路径推进计算，直至到达接收点，求得此条射线路径在接收点处对总场强的贡献。\n\n问题要求：\n请研究下列问题：\n一、基本问题\n(1)  电波从发射天线出发，向空间各个方向均匀发射。为了能够进行数值计算，我们需要将总的发射能量均匀地分配到若干条射线上，这个过程称之为发射角量化过程。显然，规定的射线条数越多，量化就越精细，计算量也就越大。因此请根据实际情况，首先选择定量化的精细程度，然后跟踪确定发射机Tx (坐标为(500, 200))和接收机Rx (坐标为(250, 350))间的主要传播路径，并可视化展示在图1中。\n(2) 如图1所示，在路径AB（两点坐标分别为(300, 350)和(500, 350)）上以50m为间隔取5个位置准备放置发射机；在路径CD（两点分别为(450, 300)和(450, 200)）上以25m为间隔取5个位置准备放置接收机；这样有25种发射机-接收机组合。请问哪一个组合收发机间的传播路径最多，哪一个组合最少？\n(3) 将(2)中所有发射机-接收机组合的传播路径进行比对，请寻找尽可能多的规律。\n二、宽带问题\n(4) 两个或两个以上的波相遇时，在一定情况下会相互影响，这种现象叫干涉现象。声波、光波和其他电磁波等都有此现象。考虑如下的多波干涉问题：对于(2)中提到的CD路径上的所有接收点，从发射机出发的电波都有多个传播途径(可能是多次反射传播、多次绕射传播或是反射与绕射的任意组合传播)到达这些点，这些频率相同、振动方向相同、初相位相同的简谐波（即正弦波）在各个接收点相遇叠加，出现某些接收点振动始终加强、而在另一些接收点振动始终减弱的现象，这种现象称为多波干涉现象。 \n上述接收点处，多波干涉形成的接收信号可以描述为\n$$f(\\omega, t) = \\sum_{i=1}^{Q} A_i e^{j(\\omega t + k r_i)}$$\n上式中，Q为到达某接收点的传播途径总数；和分别为到达接收点的第i条传播路径的信号电场强度和长度；为长度为的传播路径上的相位积累；(c为光速，值为)。\n请针对上述25种情况, 对这种多波干涉的振幅$|f(w,t)|$进行统计学分析，包括：一、二阶矩特性，不同路径到达信号的相关性及概率密度分布函数；\n(5) 继续考虑图1，从发射机同时发射一组功率相同的电波，频率从2000Mhz到2100Mhz，间隔近似1Mhz，这样我们总共要同时发射101个单频信号。每个单频信号都会形成(4)中提到多波干涉问题，多个单频信号会形成宽带多波干涉现象，请对这种宽带多波干涉现象进行数学建模，并分析合成波的包络统计特性，如同一频率、不同路径信号之间，同一路径、不同频率信号之间的相关性等。\nAddendum: \n参考文献\n\n [1] R G. Kouyoumjian, P H Pathak, “A uniform geometrical theory of diffraction for an edge in a perfectly conducting surface”, IEEE Proceedings, vol. 62, No. 11, pp. 1448-1461, Jun. 1974\n\n[2] M. F. Catedra, J. Perez, F. Saez De Adana, and O. Gutierrez, \"Efficient Ray-tracing Techniques for Three-dimensional Analyses of Propagation in Mobile Communications: Application to Picocell and Microcell Scenarios,\" IEEE Antennas Propag. Mag., vol. 40, no. 2, pp. 15-28, Apr. 1998.\n\n[3] Georgia E. Athanasiadou, Andrew R. Nix, and Joseph. McGeehan. “A Microcellular Ray-Tracing Propagation Model and Evaluation of its Narrow-Band and Wide-Band Predictions,” IEEE Journal on Selected Areas in Communications, vol.18, no. 3, pp. 322-334, Mar. 2000\n\n[4] C. E Yang, B. C. Wu, “A Ray-Tracing Method for Modeling Indoor Wave Propagation and Penetration,” IEEE Trans. On A. and P., Vol. 46, No. 6，PP. 907-919, June 1998.\n\n[5] 顾晓龙. “利用可见性概念改进基于镜像原理的射线追踪法”, 电波科学学报，Vol. 16, No, 4, pp. 16-19, 2001\n\n[6] George Liang, Henry L. Bertoni, ”A New Approach to 3D Ray Tracing for Site Specific Propagation Modeling,” IEEE VT. C., PP. 1l13-1117, 1997.\n\n[7] D. N. Schettino, F. J. S. Moreira and C. G. Rego, “Efficient Ray Tracing for Radio Channel Characterization of Urban Scenarios,” IEEE Trans. Magn., vol. 43, no. 4, pp. 1305-1308, Apr. 2007.\n\n[8] 廖斌, 赵昵丽, 朱守正,”基于虚拟源树的射线跟踪算法的研究,” 华东师范大学学报,  2008:103-108\n\n[9] Chiya Saeidi, Farrokh Hodjatkashani, and Azim Fard, “New Tube-Based Shooting and Bouncing Ray Tracing Method,” 2009 International Conference on Advanced Technologies for Communications, pp.269-273\n\n[10]袁正午，移动通信系统终端射线跟踪定位理论与方法，2007，北京：电子工业出版社\nDataset Path:\n['1974_a_uniform_geometrical_theory_of_diffraction_for_an_edge_in_a_perfectly_conductiong_surface.pdf', '00683539.pdf', '00686774.pdf', '00686780.pdf', '00840192.pdf', '04137803.pdf', '05349441.pdf', '基于虚拟源树的射线跟踪算法的研究.pdf', '利用可见性概念改进基于镜像原理的射线追踪法.pdf', '绕射系数.tex']\n\nData Description:\n该数据集由一组以文件名或内部标识符为键的条目构成，条目主要涉及电磁/声学散射与射线跟踪领域的经典理论与算法研究，包含英文经典文献标题（如 1974 年关于在理想导电面上边缘的统一几何绕射理论）以及若干以数字编码命名的条目和中文论文题目（如“基于虚拟源树的射线跟踪算法的研究”“利用可见性概念改进基于镜像原理的射线追踪法”），还包括一个名为“绕射系数”的 TeX 源文件。当前数据集中的各项值均为占位符或空对象（'{}'），说明元数据尚未填充或以外部文件形式存在，唯一的实质性文件提示是一个 TeX 文档指向绕射系数的数学描述或实现。总体上该集合适合用于建立围绕几何理论绕射（GTD/UTD）、基于镜像的射线追踪、虚拟源方法、可见性分析及绕射系数计算等主题的文献汇编、教学资料库或算法实现参考；但在直接使用前需要补全或关联完整元数据（作者、年份、期刊/会议、摘要、PDF/源码）、标准标识符（DOI、ISBN 等）和版权信息。推荐的整理与处理步骤包括：解析并索引 TeX 源以提取公式与定义，批量检索和映射数字标识到正式文献记录，补充条目的结构化元数据，统一命名规范并为每条目附加原文或可访问的副本；此外应注意版权合规与引用规范。对研究者而言，该数据集是构建专业文献库、比对数值散射模型、实现或验证射线跟踪与绕射系数计算算法的有价值起点，但需要额外的数据清洗与补充工作以达到可重复实验和发布共享的标准。"
  },
  "problem_background": "近年来，随着移动通信的发展，对系统容量的要求越来越高，频谱资源越来越紧缺。微蜂窝、微微蜂窝系统由于采用频谱复用技术缓解这个矛盾而得到广泛应用，这些系统的小区半径小于一千米，造成微蜂窝之间原来的统计相似关系丢失，这给运营商在网络初期规划带来了困难。因为实际情况经常不满足电磁场模型的条件，并且一般无法求解。若没有良好的传播预测模型，划分小区、选择基站位置和高度的唯一方法就是通过实际测量、反复测试。显然这需要投入大量的人力、时间，费用也会很高。而传播模型则根据对无线传输信道的模拟和仿真，预测接收信号，可以为指导网络规划提供较为准确的理论依据，链路预算小区半径，计算电波传播及干扰，当然希望越精确越好。\n\n目前，比较有代表性的就是射线跟踪模型。射线跟踪是一种被广泛用于移动通信和个人通信环境(街道微蜂窝和室内微微蜂窝)中的预测无线电波传播特性的技术，由于移动通信中使用的超高频微波和光同属电磁波，有一定近似性（当然还有差别），按光学方法辨认出多路径信道中收、发射机间所有主要的传播路径。一旦这些传播路径被辨认后，就可根据电波传播理论来计算每条传播路径信号的幅度、相位、延迟和极化，然后结合天线方向图和系统带宽就可得到到达接收点的所有传播路径的相干合成结果。\n\n城市环境下的微蜂窝主要指高楼密集区，覆盖范围大大缩小(半径仅为几百米甚至几十米)，基站天线(发射机)低于周围建筑物的高度，电波是在建筑物的“峡谷”当中传播。因此，电波经过屋顶绕射后再到达地面接收点的射线路径数量非常少，而且其场强与经过建筑物多次反射和绕射的路径相比，往往可以忽略，地面的反射也不考虑。这些特点构成了微小区中电波传播的主要特点。因此，可以假设微蜂窝环境下建筑物的高度高于基站天线的高度，从而将三维问题近似地简化成二维问题，只考虑两种传播机制：反射和绕射。这种简化大大地提高了射线跟踪模型的预测效率，同时能够得到可以接受的预测精度。\n\n对于城市微蜂窝的二维模型，建筑群可被划分为一定的“块”，建筑物(即图1中带有灰色阴影的多边形)则被定义为“多边形”，多边形的“边”代表建筑物的表面，多边形的“顶点”则代表了建筑物的拐角。这种简化了的市区平面图大致反映出城市的主体结构，利用它进行射线跟踪，可以得到较为准确的路径损耗。图1所示二维视图的所有数据详见文件“城市微小区地图对应的数据.txt”。该数据的说明如图2所示，每个红框内的数据对应一个建筑物。例如，第一行的00001表示建筑物的序列号，buildings 表示存储的是建筑的信息，00005表示该建筑物共有5个顶点(其中第一个点和最后一个点为同一个点，构成一个闭合的多边形，这样才能完整地表述一个建筑物)。以下各行分别是每个顶点的二维坐标值(单位是米)，直到第六行结束。每行数据的第一列和第二列分别对应着x坐标值和y坐标值（计算时无须取这么多有效数字）。\n\n在多边形的顶点上仅能产生绕射，而在多边形的边上仅能产生反射，这些多次的反射、绕射及其组合便是收、发射机间的传播路径。二维射线跟踪模型可以通过以下两种规律分别确定反射传播路径和绕射传播路径：\n\n反射传播路径，如图3(a)所示，产生反射时入射角θi等于反射角θr;\n\n绕射传播路径，如图3(b)所示，不论入射线以任意角度入射到建筑物顶点上，绕射射线都会以任意出射角向没有建筑物覆盖的区域传播。\n\n图3 两种传播机制的传播规律示意图\n\n为了简化所要解决问题（与反射和绕射相关），降低计算难度，假设图1中所有建筑物为理想电介质，下面给出与反射和绕射相关的详细说明：\n\n(1) 电磁波在不同介质交接处，会发生反射。如果电磁波传播到理想电介质表面，则80%的能量按照如图3(a)所示的反射传播规律被反射出来，其余能量进入新介质继续传播（在理想导体表面将发生能量全反射，反射波Er和入射波Ei的强度相等）。\n\n(2) 绕射是指在电磁波传播路径上，当电波被尺寸较大(与波长相比)的障碍物遮挡时，电磁波改变传播方向的现象。为了解决类似于如图3(b)中建筑物顶点(可称为劈)上的绕射问题，需要计算绕射系数，该系数体现出了绕射后绕射波强度Ed的衰减程度，即。图4为发生在劈的绕射示意图，下面是绕射系数的计算方法。\n\n计算方法：\n\n$$D_n = \\frac{e^{-j\\pi/4}}{2n\\sqrt{2\\pi kLa}} \\{ [ \\cot(\\tfrac{\\pi+\\beta}{2}) - \\cot(\\tfrac{\\pi-\\beta}{2}) ] F(kLa\\cos\\tfrac{\\pi+\\beta}{2}) + [ \\cot(\\tfrac{\\pi+\\beta}{2}) + \\cot(\\tfrac{\\pi-\\beta}{2}) ] F(kLa\\cos\\tfrac{\\pi-\\beta}{2}) \\} \\tag{1}$$\n\n其中 $k = 2\\pi/\\lambda$，$L$ 为绕射点到场点距离，$n = -\\alpha_3/(2\\pi)$，$F(x)$ 为过渡函数：\n\n$$F(x) = 2 e^{-jx^2} \\int_x^{+\\infty} e^{j\\tau^2} d\\tau \\tag{2}$$\n\n(1) $0\\le x <0.001$: $$F(x) \\approx \\tfrac{2}{3}\\pi jx e^{-j\\pi/4} - je^{j\\pi/4}x^2 - je^{j\\pi/4}x^4 \\tag{3}$$\n\n(2) $x>10$: $$F(x) \\approx 1 + \\tfrac{j}{2x} - \\tfrac{1}{4x^2} - \\tfrac{j}{8x^3} + \\tfrac{1}{16x^4} \\tag{4}$$\n\n(3) $0.001 \\le x \\le 10$: 直接计算积分 (2)，借助：\n$$\\int_{-\\infty}^{\\infty} e^{-au^2+bu} du = \\sqrt{\\tfrac{\\pi}{a}} e^{b^2/(4a)} \\tag{5}$$\n得到：\n$$F(x) = 2 e^{-jx^2} \\int_0^{\\infty} e^{j\\tau^2} d\\tau = 2 e^{-jx^2} \\int_0^{\\infty} e^{j\\pi\\tau^2/2} d\\tau \\tag{6}$$\n\n再定义：$$\\alpha^\\pm = \\beta \\pm (\\alpha_2-\\alpha_1)/2, \\quad N^\\pm = \\text{最接近 } 2n\\pi \\pm \\beta - \\pi \\text{ 的整数} \\tag{7,8,9}$$\n\n仅考虑路径：反射≤7次，绕射≤2次，一次绕射+1–4次反射，两次绕射+一次反射。\n\n视距传播场强：$$E_{LOS} = \\tfrac{E_0}{r_0} e^{jkr_0} \\tag{10}$$\n\n式中，k为波数， 为发射电场强度，为直射波的传播路径长。\n\n若是非视距传播的路径，则从发射天线出发，先利用公式(10)计算出天线在第一结点处的辐射场 ，然后沿着射线路径推进计算，直至到达接收点，求得此条射线路径在接收点处对总场强的贡献。",
  "problem_requirement": "请研究下列问题：\n一、基本问题\n(1)  电波从发射天线出发，向空间各个方向均匀发射。为了能够进行数值计算，我们需要将总的发射能量均匀地分配到若干条射线上，这个过程称之为发射角量化过程。显然，规定的射线条数越多，量化就越精细，计算量也就越大。因此请根据实际情况，首先选择定量化的精细程度，然后跟踪确定发射机Tx (坐标为(500, 200))和接收机Rx (坐标为(250, 350))间的主要传播路径，并可视化展示在图1中。\n(2) 如图1所示，在路径AB（两点坐标分别为(300, 350)和(500, 350)）上以50m为间隔取5个位置准备放置发射机；在路径CD（两点分别为(450, 300)和(450, 200)）上以25m为间隔取5个位置准备放置接收机；这样有25种发射机-接收机组合。请问哪一个组合收发机间的传播路径最多，哪一个组合最少？\n(3) 将(2)中所有发射机-接收机组合的传播路径进行比对，请寻找尽可能多的规律。\n二、宽带问题\n(4) 两个或两个以上的波相遇时，在一定情况下会相互影响，这种现象叫干涉现象。声波、光波和其他电磁波等都有此现象。考虑如下的多波干涉问题：对于(2)中提到的CD路径上的所有接收点，从发射机出发的电波都有多个传播途径(可能是多次反射传播、多次绕射传播或是反射与绕射的任意组合传播)到达这些点，这些频率相同、振动方向相同、初相位相同的简谐波（即正弦波）在各个接收点相遇叠加，出现某些接收点振动始终加强、而在另一些接收点振动始终减弱的现象，这种现象称为多波干涉现象。 \n上述接收点处，多波干涉形成的接收信号可以描述为\n$$f(\\omega, t) = \\sum_{i=1}^{Q} A_i e^{j(\\omega t + k r_i)}$$\n上式中，Q为到达某接收点的传播途径总数；和分别为到达接收点的第i条传播路径的信号电场强度和长度；为长度为的传播路径上的相位积累；(c为光速，值为)。\n请针对上述25种情况, 对这种多波干涉的振幅$|f(w,t)|$进行统计学分析，包括：一、二阶矩特性，不同路径到达信号的相关性及概率密度分布函数；\n(5) 继续考虑图1，从发射机同时发射一组功率相同的电波，频率从2000Mhz到2100Mhz，间隔近似1Mhz，这样我们总共要同时发射101个单频信号。每个单频信号都会形成(4)中提到多波干涉问题，多个单频信号会形成宽带多波干涉现象，请对这种宽带多波干涉现象进行数学建模，并分析合成波的包络统计特性，如同一频率、不同路径信号之间，同一路径、不同频率信号之间的相关性等。",
  "problem_analysis": "这组数学建模题本质上是一个面向城市微蜂窝环境的确定性射线跟踪与统计干涉建模的复合问题，目标既包含在给定二维城市平面图和传播机制假定下精确识别并可视化发射机与接收机之间的“主要传播路径”（包括多次反射与绕射的组合），又包含在此确定性路径集合上进行窄带与宽带多波干涉的统计分析与频率相关性研究。把问题放在更宏观的背景中看，模型的主要目标是以物理可解释的方式把几何形状（多边形建筑的边与顶点）、边界散射机制（镜面反射、劈角绕射）、以及频率-相位累积规律结合起来，去重构到达接收点的复场分量集合，进而从这组复量和的行为推导出振幅分布、二阶矩特征、相关性与频域/时域上的包络统计特性。这个目标直接塑造了解题思路：一方面需要精细的几何可视性与路径搜索算法（以保证在反射次数和绕射次数受限时枚举尽可能多的有效路径且能判定每条路径的可行性）；另一方面需要在已枚举路径上进行严格的相位与幅值计算（包括反射能量分配、绕射系数的复值计算、每段自由空间传播的相位因子e^{jkr}以及能量衰减），最终把这些物理量在单频和多频条件下复合求和以得到干涉统计量和相关函数。上述目标明确地把问题置于“工程可计算且物理可解释”的范畴，因而促成若干建模选择与权衡：例如限制反射次数≤7、绕射≤2并限制某些组合，是为避免组合爆炸而引入的工程近似；将三维情形近似为二维并假定建筑高度高于天线以忽略地面/屋顶的复杂三维散射，则是为了把问题限定在边与顶点两类散射事件上，从而显著降低几何复杂性。\n\n在对问题表述所依赖的显性与隐性假设进行批判性识别时，应当清晰看到这些假设会如何影响模型的解释力与适用范围。显性的有：二维平面近似（建筑在平面上由闭合多边形描述）、在边上或顶点上仅发生镜面反射或劈角绕射、理想电介质反射80%能量（理想导体全反射）、忽略地面反射和屋顶绕射、限定反射/绕射次数、以及入射能量到离散射线的均匀量化分配等。隐含的假设包括：材料属性在频带内近似不变（反射率、绕射系数的频率依赖被简化）、多径之间独立无外部相位扰动（非多普勒静态场景）、建筑边与顶点可视性判断具有精确的几何信息（坐标无误差）、以及场幅按几何光学与统一几何绕射理论（UTD）给出的线性叠加规则适用于所关心的频率与电波尺寸范围。每一项假设都有其影响：二维化消除了高程相关路径（屋顶散射、绕射向上/向下），这在城市峡谷中若天线与建筑高度相近或地形起伏明显时会引入系统性误差；把建筑当作理想电介质或导体会掩盖真实材料的吸收和相位延迟特性，从而影响路径幅度估计与相位累积；限制路径次数与不考虑某些类型的散射是为计算可行性做出的权衡，但可能导致对远多次反射弱贡献的系统偏差，特别在多径稠密或可传播回路较多时；而忽略运动物体、植被、天气、家具及街道小物体带来的时变或随机散射，则使模型更适用于静态、小区初期规划、或作为测量引导工具，而非精确的覆盖预测器。认识并记录这些假设对于后续结果解释非常重要：模型输出应被限定为“在假设成立条件下的预测”，并在给出结论时注明潜在的偏差来源与可能的修正方案。\n\n从内部结构与相互依赖性的角度，问题包含若干相互耦合的模块：几何可见性判定与路径枚举模块决定了“哪些路径存在”；每条路径的物理计算模块（自由空间传播相位与衰减、反射能量分配与相位、绕射系数的复值计算）决定了每条路径的复幅；路径组合与干涉模块把这些复幅线性叠加以生成观测场，随后统计分析模块评估幅值的瞬时与统计特性、分布拟合与相关性。这些模块之间存在明显的前后依赖关系：几何枚举不充分会直接导致统计分析缺失关键分量而偏差很大；而反过来，为高效枚举需要基于物理量级剪枝（例如忽略那些传播损耗太大的路径），这又需要对反射系数和绕射系数的粗估，这两者形成一种张力——越早的粗估有利于快速剪枝但可能丢掉对整体干涉有非平凡贡献的“弱路径”。此外，绕射系数的计算本身具有数值挑战（UTD给出的绕射系数公式包含过渡函数F(x)的积分项，需要在不同x区间采用渐近展开或数值积分；当参数接近奇异点时数值不稳定），因此路径可行性的判定与幅值精度也受限于数值实现的鲁棒性。对这些内在联系的妥善处理通常需要在算法设计时采用分层策略：先用粗粒度的角量化或SBR/镜像法快速发现可能“强路径”，对这些路径用高精度UTD计算；对其余路径采用能量阈值剪枝或近似模型。\n\n对问题在不同尺度与时间维度上的复杂性演化应特别关注。空间尺度上，微蜂窝的半径仅数百米甚至几十米，路径长度差异较小，导致相位敏感且小的几何位置变动会引起显著的干涉模式变化（即空间渐变非常剧烈）。因此，接收点沿CD路径的25个位置之间的相关性会高度依赖路径集合的相对相位差；当存在明显LOS分量时，振幅分布可能呈Ricean，而在稀疏多径且无显著主波时则可能偏离经典Rayleigh分布，表现为少量确定性分量与若干低幅度分量的混合。时间维度上，如果存在移动（用户或车辆），多普勒会使频率成分随时间漂移，短时统计特性（如瞬时包络）会随时间变化；在宽带问题中，频率维度带来的幅相变化会产生频域相关性与时域的脉冲响应（通过对101个频点的逆傅里叶可得多径时延谱），进而定义延时扩展与相干带宽。对模型的稳定性而言，参数的扰动（例如建筑坐标小误差、材料反射率的偏差、角量化细化程度变化）可能引起高灵敏度的输出变化，尤其是在干涉结构复杂且路径数较少的情况下；因此需要进行系统的敏感性分析与不确定性量化（UQ），比如对关键参数进行蒙特卡洛采样、计算输出分布或导数灵敏度，进而识别哪些参数必须通过测量标定，哪些参数可以用通用近似值。\n\n在方法选择与替代表述方面，问题允许多种建模策略：一种是以镜像源与可见性判定为核心的确定性UTD/镜像法，适合枚举少量反射序列并能给出物理可解释的每条路径；另一种是发射角量化后采用射线发射与弹回（Shooting and Bouncing Rays, SBR）或管束/光束追踪（beam-tracing）的方法，优势是容易扩展到大量入射角并适合并行化，但需要后处理合并相近路径与权重归一；第三种是统计-测量驱动的混合方法，在城市尺度用经验或统计衰落模型（如路损模型、克服复杂多径的Nakagami或Rice分布）来快速估计覆盖，而在关键位置用射线跟踪做局部精校准。不同视角会改变计算资源分配、结果可解释性与精度：镜像法可精确给出具体路径和对应UTD绕射分量，便于理解哪些建筑面或拐角贡献最大；SBR适合做快速可视化与全场能量分布估计；统计模型适合做大量场景的快速仿真与系统级性能估计。权衡上，若研究目的是理解和可视化“主要传播路径”和其物理来源，采取镜像法与有选择的高精度角采样并结合UTD计算是合理的；若目的是对许多发射/接收位置做批量评估并估计覆盖概率，则应结合SBR或混合统计方法以提高效率。\n\n就实现细节与数值难点而言，应当注意若干关键点：角量化（发射线数量）的选择既决定了路径枚举的完整性也决定了计算量。一个实用的策略是自适应角量化：先用较稀疏的角度网格发射若干射线以发现可能的强路径集，然后在那些方向的局部进行细化采样直至路径参数（幅度、相位）收敛到给定容差；另一策略是以“目标导向”发射，即优先向几何上可见的边、顶点与接收方向发射更多射线（importance sampling），这在城市矩形街区结构中特别有效。多次反射路径的构造可用镜像原理：对每次反射将发射点关于反射边镜像，再连线并检查可见性，以系统化生成候选反射序列；对绕射则需要在建筑顶点处生成绕射源并用UTD绕射系数将路径幅值连接起来；但组合爆炸需要通过能量阈值、最大传输损耗阈值或其他剪枝规则裁减不重要的路径。UTD中F(x)函数的数值实现需要分段处理：对x很小或很大使用给定渐近式（题中已给），对中间区间采用稳健的数值积分或已知Fresnel积分近似实现，注意相位因子与分支选择以避免数值不连续；β、n等几何参数在某些极端几何构型下可能使cot等项接近奇异，因此在数值实现中应加入正则化或以极限形式处理。\n\n在窄带的多波干涉分析方面，数学上需要把每条到达路径视为复数振幅A_i e^{j k r_i}，Q通常较小且路径幅值差异显著时总场的振幅并不满足中心极限定理，因此常见的Rayleigh假设不一定成立。统计学分析应包括对瞬时振幅的第一、二阶矩（均值、方差）、包络的概率密度估计以及与经典分布（Rayleigh、Rice、Nakagami-m、K分布）的拟合优度检验；此外要计算路径间的相关性矩阵——不同路径的相位是由路径长度决定的确定性量（在单一频率下是完全关联的，因为相位=kr_i），但在空间上由于接收点位置改变r_i而引入相关性结构。因此，应计算不同接收点间的场互相关函数与互谱密度，以及不同路径间在给定位置上的复相关系数。对25种发射/接收组合的比较可以用路径数目、总接收功率、主导路径的能量占比、延迟/相位差分布、包络分布的形状参数（例如Nakagami m 或 Rice K）来量化。经验上，路径数越多且幅度相近，包络越趋向于Rayleigh；存在强主导分量时呈Ricean；路径稀少且幅度结构分层时，分布可能要求用混合模型或确定性-随机模型来描述。\n\n在宽带（2000–2100 MHz, 101点）问题中，建模应从频域到时域的转换角度来构建：在每个频率点上按窄带方法计算各路径的复幅（其中每路径的相位依赖于频率k(f)=2πf/c，因此在频率上呈线性相位旋转），然后把这101个频点的复频率响应视为对一个等频采样的频率采样序列，对其做逆傅里叶变换可得到时延分辨力为约1/(总带宽)的离散时域冲激响应（Channel Impulse Response, CIR），从而能计算功率时延谱（PDP）与RMS时延扩展。宽带干涉的包络统计特性由频率内各窄带分量的相位漂移与幅度一致性共同决定：同一路径在不同频率上的幅度通常高度相关（除非材料的吸收或绕射系数在带宽内显著变化），但相位会随频率线性变化，导致跨频率的相位相关衰减，进而使得分布在频域上更“平滑”。关键量是相干带宽B_c，与时延扩展σ_τ成反比，若带宽≫B_c则频率上不同点近似独立，宽带合成能利用频率选择性来抵抗窄带深衰落（频域分集）。从统计角度，应计算频域相关函数、频域互相关、以及通过CIR导出的时域包络统计量（例如瞬时包络的分布随时间或不同频段平均后的方差），可以用蒙特卡洛在频率与接收位置上采样以估计分布并拟合参数。还应分析“同一频率不同路径之间的相关性”（由几何和物理机制决定，通常在单频下高度确定）与“同一路径不同频率之间的相关性”（主要由频率敏感的相位旋转和材料频率响应决定），两者结合决定了宽带信号的合成行为。\n\n关于实现与验证策略，需要强调若干工程建议：首先，采用分层（粗到细）路径搜寻与自适应角量化以在可承受计算量下捕获主要路径；其次，对UTD绕射系数与F(x)函数实现进行严格的数值测试，并对边界情况做特殊处理；第三，在路径枚举时使用能量阈值或贡献评估来剪枝（例如如果某条路径在某次反射后能量已降低到总体能量的极小比率则终止扩展）；第四，进行敏感性分析与不确定性量化（对建筑坐标误差、反射率、角量化粗糙度、频率采样间隔等进行扰动试验），并用现场测量数据或高精度模拟（若可得到）来校准关键参数（如实际反射损耗、绕射的经验修正因子、表面粗糙度造成的散射）。在对25种发射/接收组合的比较中，可把组合按是否存在LOS、直射路径长度、可访问边/角的数目、主导反射面的几何角度等特征进行聚类，通常几何上更开放、可见表面更多的组合会产生更多可行路径；反之在被建筑群包围或仅有少数可见边/角的几何位置则路径数量最少。这些几何量化特征也可作为先验用于发射角自适应采样。\n\n最后，强调模型构建过程应保持迭代性与开放性。最初的粗模型可用于识别“哪些路径最重要、哪些参数最敏感、哪些数值实现需重点验证”，随后通过局部精化、参数标定与最后的统计验证来不断改进模型。对于高可信度的工程结论（例如网络规划中基站位置、高度与小区划分的建议），应在模型层面逐步放宽或修改关键假设（例如恢复三维效应、引入非理想材料频率依赖、考虑地面/屋顶反射与场景时变），并用测量数据做最终校验。总体而言，这个问题集合把几何光学、UTD绕射理论、数值计算与统计信号分析综合在一起，既提出了可计算的工程近似，也留给建模者丰富的选择空间与验证步骤；良好的实践应当在清楚记录假设与不确定性的前提下采用分层、自适应与校准的建模流程，以便在效率与精度之间取得合理平衡并为后续实测或更高维模型的扩展铺平道路。",
  "modeling_solution": "总体思路与建模目标。为解决题目中关于城市微蜂窝二维射线跟踪和窄带/宽带多波干涉的复合问题，我提出一个分层混合模型（Hybrid Deterministic–Statistical Ray/UTD Model），该模型在几何光学的确定性路径枚举（使用镜像源法与边-顶点可视性判定）与统一几何绕射理论（UTD）精确计算局部绕射系数之间耦合，并在统计分析层用蒙特卡洛与参数化分布（Rice/Nakagami）对窄带与宽带包络特性做推断与置信度估计。模型核心目标是：在给定二维建筑多边形场景下枚举并计算到达接收点的“主要”传播路径（包括多次镜面反射和劈角绕射及其组合），对每条路径给出复场贡献 E_i，进而对单频和多频合成场进行精确叠加并统计其幅值分布、相关性与时延特性。模型在物理上尽量保留UTD绕射的复系数与反射能量分配的相位关系，在工程上通过自适应角量化与能量剪枝控制计算复杂度。\n\n基本假设（模型基础的显性与必要简化）。场景为二维平面，所有建筑以闭合多边形描述（顶点为绕射点，边为反射面）；基站(发射机)与终端(接收机)位于平面内且建筑高度高于天线，故可忽略地面/屋顶三维效应，反射仅发生于边上、绕射仅发生于顶点；在理想电介质边界，反射能量为80%（即反射功率系数 |R|^2 = 0.8，导体取全反射），我们在数值实现中用幅值 |R| = sqrt(0.8) 并允许一个可调整的相位因子 phi_R（缺省可取0或依据校准）；绕射系数按题中所给 UTD 表达式 D_n 计算（公式(1)–(3)），其中过渡函数 F(x) 在小/大/中区间分别用渐近展开或数值积分（或Faddeeva/费涅尔函数）计算；自由空间传播场在二维情形按题目给出的“视距传播场强”采用 E_LOS = E0/r * exp(j k r) 。（注：这里遵循题目给出的衰减律 1/r，而非线源或面源的其它衰减律。）路径枚举限制：最多反射次数 R_max = 7，最多绕射次数 D_max = 2，允许组合为（一次绕射 + 1–4次反射）和（两次绕射 + 一次反射）；在枚举中弱贡献路径（相对主路径功率低于阈值 T_dB, 例如 -40 dB）将被剪枝以控制复杂度。所有材料系数在2000–2100 MHz带宽内近似不频率敏感，若需要可用频率依赖模型替换。\n\n符号与变量定义（影响全部公式的基本量）。用 Cartesian 坐标 (x,y) 表示平面位置，Tx 为发射机位置，Rx 为接收机位置。λ 为波长，k = 2π/λ 为波数，E0 为发射参考电场幅度（发射功率经天线方向图和耦合后的初始幅值）；对第 i 条路径，路径节点顺序为 (Tx -> P1 -> P2 -> ... -> Rx)，其总几何长度 r_i = sum segment lengths; 对每次反射 j 用复反射系数 R_j (一般 |R_j| = sqrt(0.8) 并可含相位 phi_Rj)，对每次绕射 m 用 UTD 复绕射系数 D_m (按公式(1)求得复数值)。路径在传播中的自由空间衰减采用 1/r_segment 或累积 1/r_i（按照题目设定采用整体 1/r_i 因子），传播相位为 exp(j k r_i)；最终到达接收点的每条路径复场贡献记为 E_i = E0 * G_i * (1/r_i) * exp(j k r_i) ，其中 G_i = (Π_j R_j) * (Π_m D_m) * A_ant 封装了反射/绕射的复增益与天线方向图因子 A_ant（天线方向性在发射角量化阶段用于权重分配）。\n\n确定性路径生成（几何枚举与可视性）。为保证枚举完备而高效，采用混合镜像源法与顶点扩展法：对纯反射序列，应用逐级镜像：一阶镜像在每个可反射边取发射点关于该直线的镜像点；二阶镜像为对一阶镜像在另一边再镜像，以此类推直至 R_max；候选路径由镜像点与接收点连线在物理空间上映射回与边的入射点，需进行可视性检查：每段线段（Tx到第一个接触点、接触点到下一接触点、直至到Rx）必须不穿过建筑内部（以多边形相交判断），并且每次镜面反射满足入射角 = 反射角（镜像构造保证几何关系，但仍需检验接触点位于边的线段范围内而非延长线上）。绕射的枚举：以建筑顶点作为绕射源，生成从 Tx 到顶点到 Rx 的单绕射候选；对于组合（反射+绕射或多绕射+反射），将镜像法与顶点插入结合——即在反射序列中允许某一步替换为“到顶点的到达”，并用 UT D 将顶点作为二次源向后传播，必须检验绕射方向是否到达一个开放空间区（无建筑遮挡）并进行可视性测试。为避免组合爆炸，首先用粗网格角量化或快速射线发射（SBR）识别可能命中 Rx 或重要边/顶点的方向，然后对这些方向应用镜像/顶点精确求解。\n\n发射角量化与自适应射线追踪策略。初始用均匀角网发射 N0 条射线（建议 N0 = 360 即分辨 1°；若需更高精度可用 N0 = 720 等），对每条射线记录与场景的第一个交点（边或顶点）。对这些初步射线，检查哪些命中接收点附近或经反射/绕射可达接收点（可用逆向射线从 Rx 发射作为对偶以提高命中效率）；在发现到 Rx 的候选方向后对该方向周围角段进行局部细化（二分细化，不断将角分辨率翻倍），直至路径参数（到达功率/相位）收敛于容差 ε（例如幅值变化 < 0.5 dB 或相位变化 < 5°），或细化层数达到上限。此自适应方案兼顾了计算代价与路径完整性，能保证主要路径被捕获而不会对全角域做不必要的超细采样。\n\n路径功率与相位计算（每条候选路径的物理量）。对于每条通过可视性检查的路径，计算其复场贡献 E_i = E0 * A_ant(θ_tx, θ_rx) * (Π reflections R_j) * (Π diffractions D_m) * (1/r_i) * exp(j k r_i + j Φ_R) 。其中 A_ant 为发射/接收天线方向图增益（若题中假设各向同性则取 1；若有方向性信息则代入），R_j 为复反射系数（建议模型化为 R_j = sqrt(0.8) * exp(j φ_Rj)；φ_Rj 的默认值可取 0，导体场景 φ_Rj = π，可由实测校准），D_m 由 UTD 给出，具体计算按照题中式(1)与 F(x) 的分段近似：当 x < 0.001 用给定多项式展开(3)，当 x > 10 用渐近展开(4)，当 0.001 ≤ x ≤ 10 用数值评估定义中的 Fresnel 型积分（等价地可用标准的复费涅尔积分或 Faddeeva 函数实现以得到高精度稳定值）。若路径包含多个段，自由传播因子取整体 1/r_i 或分段乘积 1/∏ r_seg，二者差别可被视为模型可调参数；为与题目公式一致采用 1/r_i。当计算含绕射的路径时必须计算几何参数：劈角 β、绕射角度 α1, α2 等与题中定义一致，并计算 n = -α3/(2π) 等并代入式(1)。对于反射，若需要更物理真实的处理可用频率-角度相关的 Fresnel 反射系数代替常数 0.894，但这将增加复合计算量。\n\n路径筛选与贡献度剪枝。所有候选路径按接收功率 |E_i|^2 排序，设最大路径功率 P_max，对任一路径若 10 log10(|E_i|^2 / P_max) < T_dB（例如 T_dB = -40 dB），则断定该路径对合成场贡献可忽略并从进一步的统计与宽带计算中去除；此外当累积路径数超过一个上限 N_max（例如数百）时对低贡献路径统一剪枝。这种剪枝策略确保枚举次数上限的同时保留对接收幅值统计有显著影响的路径。\n\n窄带多波干涉的数学表达与统计量。对单一频率 ω（即单一 k）在某接收点处，合成场为 f(ω,t) = Σ_{i=1}^Q A_i e^{j(ω t + k r_i + φ_i0)}，常将时间因子 e^{j ω t} 视为公共因子，感兴趣的复包络为 F = Σ_i A_i e^{j k r_i'}，其中 r_i' 含路径内额外相位偏移（例如由反射相位、绕射系数相位产生）。其一阶矩（复均值）为 μ = E[F]（如果把几何参数视为确定量则 μ = F 本身；若把小的几何不确定性或接收点位置作为随机变量，需对其做期望），其二阶矩为 E[|F|^2] = Σ_i |A_i|^2 + Σ_{i≠j} A_i A_j^* e^{j k (r_i - r_j)}。因此瞬时功率等于各路径功率的和加上互相关项，这些互相关项通过路径间的相位差 k (r_i - r_j) 决定干涉加强或减弱。为统计化处理可考虑两类随机化机制：（a）在接收点空间上引入小尺度位置扰动 Δx ~ Uniform(−δ, δ) 以模拟用户移动或位置不确定性，从而使相位变为随机变量并能通过积分得到分布；（b）在路径幅值/相位上加入测量不确定性或表面粗糙度导致的随机相位。基于这些随机化，能用蒙特卡洛样本生成 f 的经验分布，并对包络 |f| 做参数估计：若 Q 大且相位近似独立，依据中心极限定理复场近似正态，从而包络趋向 Rayleigh；若存在强主导分量（如 LOS 或强反射），包络接近 Rice 分布，其 K 因子可由 K = |dominant|^2 / Σ_{others} |Ai|^2 估计；若路径数少且幅值呈层次分布，可拟合 Nakagami-m 分布，m 由一二阶矩关系估计 m = (E[R^2])^2 / (Var(R^2) - (E[R^2])^2) 等标准方法。还应计算路径之间的互相关系数 ρ_{ij} = E[ A_i e^{j k r_i} (A_j e^{j k r_j})^* ] / ( sqrt(E|A_i|^2) sqrt(E|A_j|^2) )，在单频且几何确定时互相关可看作确定相位因子 e^{j k (r_i - r_j)}，在统计化处理下对位置或频率集成后可得到减弱的相关性数值。\n\n对题中25个发射/接收组合的比较方法与规律发现。在批量求解时先对整个场景做一次全局几何预处理：构建建筑边/顶点的空间索引（如 R-tree）以加速交点/可视性查询，并预计算每条边的法向。对每个 Tx-Rx 组合重复镜像/顶点枚举（并行化处理所有组合），统计每对的路径数量 Q, 总接收功率 Σ |E_i|^2, 最大路径功率 P_max 及主导路径类型（LOS、首跳反射、绕射等），计算包络分布拟合参数（Rice K，Nakagami m）与延迟扩展（若给出时延可计算）。通常可以观察到：位于开阔街口或无遮挡线的组合 LOS 存在且 Q 较小；被“峡谷”或建筑群环绕的组合 Q 较大且多为多次反射；某些几何对称位置会产生路径结构相近的组合；路径数与建筑群局部拓扑（可见边数、顶点数、边的角度分布）高度相关。对“哪一组合最多/最少路径”的判定由统计结果给出：通过排序 Q 值挑出极值组合，并解释极值的几何原因（例如：最少路径通常为被遮挡且周围无遮挡面的接收点，最多路径则为Rx位于建筑群中心且Tx有多条反射链路连通处）。\n\n宽带建模（2000–2100 MHz, 101 个频点）的处理与包络统计。对每个频点 f_n (n=0..100)，先按窄带方法计算各路径复幅 A_i(f_n) e^{ -j k(f_n) r_i }（注意 k(f_n) = 2π f_n / c，反射与绕射系数若频率敏感则随 f 变化）。得到频域传输函数 H(f_n) = Σ_i A_i(f_n) e^{ -j k(f_n) r_i }。对频域样本做 IFFT（适当填零窗以获得更精细的时域分辨率）即可得到离散时域冲激响应 h(τ_m)（CIR），由此得到功率时延谱 P(τ) = |h(τ)|^2，进而计算一阶时延（mean delay）τ_mean = Σ τ P(τ) / Σ P(τ) 与 RMS 时延扩展 σ_τ 的常规定义；相关的相干带宽 B_c 可由 B_c ≈ 1/(5 σ_τ)（或按 0.5 相关阈值定义）估计。跨频相关性方面，计算频域相关矩阵 C(f_p, f_q) = E[ H(f_p) H(f_q)^* ]（在确定性几何下为确定值，统计化时对微扰求期望），此外还可计算相邻频点间的相关系数与谱卷积宽度来评估频率分集增益。由于同一路径在不同频率上的幅度通常高度相关而相位呈线性频率依赖，宽带合成往往能减弱单频的深衰落（频域分集效应），在统计上表现为频域平均的包络方差降低并向更高阶分布过渡。建议在实现时对每条路径保存其几何长度 r_i 与复增益谱 A_i(f) 的参数化表示，以便快速跨频点计算（例如将 A_i(f) 近似为平缓函数或常数然后只更新相位分量）。\n\n数值实现策略、算法复杂度与并行化。求解分为三个并行化层次：场景层（建筑索引、边/顶点预计算）对所有组合共享；组合层（25 或更多 Tx-Rx 对并行）；频率层（101 个频点并行）。路径枚举（镜像与绕射插入）为计算热点，建议用边界索引与缓存已计算的镜像序列的可视性结果，设置能量阈值用于早期剪枝。UTD 中 F(x) 的数值实现建议调用高质量复费涅尔函数库（例如 Faddeeva），在极端小/大的 x 值使用题中给出的渐近式以避免数值不稳定。总体复杂度受反射秩 R_max 的组合爆炸影响；在实际工程上结合能量阈值及自适应角细化后预计每个 Tx-Rx 对的有效路径数 Q 通常不超过数十，因而计算可在数十到数百核 CPU 或 GPU 上在分钟级完成。为高效批量计算建议：先用快速 SBR/镜像粗探测潜在强路径（在粗角分辨下），对这些候选路径做精确 UTD 计算；复用频率独立的几何长度 r_i 结果在跨频计算中节省成本。\n\n灵敏度分析、校准与验证。建议开展系统化灵敏度分析：对建筑坐标增加小幅高斯扰动（例如标准差 0.1–1 m）来评估位置不确定性对路径数、主导路径功率与包络分布参数的影响；对反射幅值 |R| 在 ±10% 范围内扰动以评估材料参数敏感性；对绕射函数中 n、β 等几何角度参数做极限分析以检验数值稳定性。模型验证以三层策略进行：单元测试（验证 UTD D_n 的数值实现在已知极限与文献案例下的一致性）；合成场景对比（用已发表案例或仿真工具如射线跟踪软件验证路径数与延迟谱）；最终与实测数据对比（若有城市测量数据，用最小二乘或贝叶斯方法标定 φ_R、反射幅值及绕射修正因子，使模型输出在统计意义上匹配观测的功率分布与时延谱）。对统计量的置信区间通过蒙特卡洛重复试验估计。\n\n可扩展性与进一步改进方向。模型的模块化设计允许逐步扩展到更复杂情形：一是从二维扩展到三维以纳入楼顶、地面反射与高度信息（需引入面反射的三维几何镜像与顶面绕射）；二是引入频率依赖的材料参数与表面粗糙度模型以改善高精度宽带预测；三是在统计层结合数据驱动模型（例如用机器学习回归器或神经网络学习从局部几何特征到路径数/K 因子/σ_τ 等的映射），该代理模型可显著降低大规模网络规划时的在线计算负担；四是对时变场景引入移动目标与多普朗克效应以得到时间相关的包络统计并估计多普朗克谱。为量化不确定性还可以引入贝叶斯框架对关键参数做后验分布估计，并据此给出预测的不确定区间而非单点估计。\n\n输出与可视化建议。对题目第一小问（Tx=(500,200) 与 Rx=(250,350) 的主要路径）用本模型首先用自适应角量化找到若干主路径（列出每条路径的类型：LOS/反射序列/绕射节点、总长度 r_i、贡献功率比、相位），并在二维地图上绘制路径线段（用颜色或线型标识反射与绕射节点）以及路径功率谱条形图。对第(2)与(3)对 25 组组合给出表格化结果（路径数 Q、总接收功率、K 因子、τ_rms）并用聚类（例如层次聚类）展示组合间的规律性。对窄带与宽带统计给出拟合分布（Rice/Nakagami）的参数估计与拟合优度（KS 检验 p 值）以及频域相关矩阵的热图与时域 PDP 曲线。\n\n总结性回顾。本模型在保留物理真实感（UTD 绕射的复系数、反射的能量守恒简化）与工程可计算性（自适应角量化、镜像+顶点混合枚举、能量剪枝）之间寻找平衡，既能枚举并量化主要传播路径以满足问题关于路径可视化与分类的需求，又能在窄带和宽带层面对多波干涉和包络统计给出可验证的预测。通过并行实现、代理模型与数据标定，模型可扩展到大规模批量评估与实际网络规划应用；通过灵敏度分析与贝叶斯校准，模型的预测不确定性也可量化，从而为实际工程决策提供可操作的置信信息。",
  "task_descriptions": [
    "子任务一（场景建模与数据预处理）要求把题目提供的二维城市平面图原始文本数据规范化为一个可用于后续射线跟踪与数值计算的、结构化且经校验的几何数据库；其具体目标是读取并验证“城市微小区地图对应的数据.txt”中每个多边形建筑记录（以米为单位的顶点坐标序列），将其转换为标准化的几何对象（保证闭合、顶点顺序一致性与非自交），并为每个几何对象和其构成的边与顶点生成必需的几何与拓扑属性以支持高效空间查询与后续物理建模。为完成该任务应按下列步骤和技术实现：一、输入解析与格式校验——实现稳健的文本解析器（建议使用 Python + pandas/regex 或等价工具）逐条读取建筑编号与顶点坐标，去除多余精度与空白行，检查每个多边形第一个点与最后一点是否相同（若非闭合则自动闭合或报错），检测并报告重叠点、重复边或自交多边形，并在可能时自动修复（例如按常见容差合并几乎重合的顶点）；二、几何构建与单位/坐标一致性——用成熟几何库（如 Shapely/GEOS 或 CGAL）将坐标构建为多边形对象，统一单位（米）和坐标系，计算并存储每个多边形的边列表（有序线段）、边长、边中点、边向量与法向（法向须与多边形方向一致以便定义“外侧”与“内侧”）；三、顶点属性与分类——为每个顶点计算内角/外角、判断凹凸性（便于后续绕射劈角 β 的计算），为顶点分配唯一 ID 并记录其相邻边索引、邻接多边形（若两建筑共享顶点/边则记录拓扑关系），同时标注可能的几何奇异情况（内角接近 0 或 180°）；四、空间索引与加速结构——为所有边线段与多边形构建空间加速索引（如 R-tree 或 KD-tree）以支持高效的线段相交测试、点在多边形内判定与最近邻查询，并实现高性能的线段-多边形交叉检测与可视性初步筛查接口；五、参数与配置文件生成——在场景数据库中写入并版本化一组全局参数（例如长度单位、默认反射功率比与相位约定（题中默认反射功率 80% 对应幅值 sqrt(0.8)）、默认角量化分辨率 N0 的建议值、频带描述 2000–2100 MHz 与采样点数 101、路径次数上限与贡献阈值 T_dB 的初始值等），并把这些配置与几何数据以可交换格式导出（GeoJSON/WKT + JSON/YAML 元数据）以便复现与后续处理；六、质量控制与可视化输出——实现自动化校验报告（包括多边形计数、孤立顶点、极短边、最小/最大内角分布、总覆盖范围/bounding box）和基础可视化（二维地图预览、边与顶点标注、编号与法向箭头），以便人工核查；七、接口与错误处理规范——为后续模块定义清晰的 API（函数或文件格式），包括按 ID 访问边/顶点、查询相邻关系、执行线段相交与点内检测，并保证在发现未修复的几何异常时返回可解释的错误信息与修复建议。整个子任务应以可重复、可审计的数据管线实现，保留原始输入、清洗日志与最终几何数据库的版本信息，便于后续路径枚举、物理系数计算与统计分析模块直接调用。",
    "子任务二的目标是为每一对发射机–接收机（Tx–Rx）系统地、可重复且高效地枚举出所有满足题目限制的物理可行传播路径（仅允许在多边形边上发生镜面反射、仅允许在多边形顶点发生绕射），并为后续幅相计算输出每条候选路径的完整几何拓扑信息与可视性判据；其范围明确包括：纯反射序列（反射阶数 ≤ R_max，题目默认 R_max=7）、纯绕射序列（绕射阶数 ≤ D_max，题目默认 D_max=2）以及规定的组合模式（一次绕射 + 1–4 次反射；两次绕射 + 一次反射），并且需将重复等价路径、不可见或物理不可能的路径剔除。为实现该目标应按以下步骤和技术实现：一）输入与预处理——以结构化几何数据库为输入（闭合多边形列表、每条边的端点索引与法向、每个顶点的局部内外角信息、Tx/Rx 坐标），并构建空间加速结构（R-tree 或 KD-tree）以支持快速线段相交与点内判定；二）纯反射路径生成（镜像法）——递归应用镜像源法：对反射阶数从 1 到 R_max 逐级生成发射点关于候选反射边的镜像点，连接镜像点与接收点得到在物理空间中对应的入射/反射点，要求每个反射点必须位于对应边的线段范围内且满足入射/反射几何（镜像构造保证角度关系，但应再次检验边界处点落在边段上）；对于得到的每条反射链上的每一段，执行严格的可视性检测（线段与所有建筑多边形求交，禁止穿越建筑内部或与非该反射边的边不当相交），并记录每段的入射角/反射角、接触点坐标与段长；三）绕射路径生成（顶点插入法）——将每个建筑顶点视为潜在绕射源，生成 Tx→顶点→Rx 的单绕射候选，并在允许的组合结构中将顶点插入到反射序列中（例如在某一反射链的任一步替换为“到顶点”的到达并从顶点继续反射或绕射），对每个绕射步骤进行可视性检验以确保证明向外传播方向没有被建筑遮挡，并计算建立绕射需要的几何量（顶点的劈角、绕射入出角关系）供后续 UTD 计算使用；四）角量化与自适应发射/逆射策略——为避免盲目全空间细采样，采用混合策略：先以粗角分辨率 N0（例如 360 或 720）进行正向或逆向（从 Rx 发射）Shooting-and-Bouncing-Rays（SBR）快速探测命中边/顶点的方向，识别可能到达 Rx 的角区段后对这些角段实行二分细化直至路径几何或估算的接收幅度/相位收敛到预定容差（例如幅度变化 <0.5 dB 或相位变化 <5°）或达到最大细化层数；逆向发射（Rx→场景）与正向发射复用结果以提高命中概率并减小计算冗余；五）数值与几何鲁棒性措施——在所有几何判定中使用容限（epsilon）处理“在边上/顶点上”的判断，避免因浮点误差错判；对近乎掠射入射角情形设定阈值以防止数值奇异；在顶点绕射可见性判定中明确区分“顶点暴露”与“被夹遮”情况并剔除不可达顶点；六）剪枝、去重与缓存策略——对候选路径采用早期剪枝规则：在构造过程中实时估算该路径的最大可能接收功率（基于段长 1/r 粒度估计与每次反射的默认幅值衰减）并在预设阈值下（例如相对主路径低于 T_dB，如 −40 dB）终止该分支；对生成的候选路径做拓扑去重（长度、节点序列与接触点在容差范围内视为同一路径）并缓存镜像序列与可视性查询结果以便并行重用；七）输出规范——对每一对 Tx–Rx 输出经验证的候选路径集合，且每条路径须包含：节点序列（Tx, 接触点或顶点索引, …, Rx）、每段的端点坐标、段长与总长度 r_i、每次反射的入射角/法向、每次绕射的几何参数（劈角 β、入出角 α 等）、路径类型标签（纯反射/单绕射/组合）、可视性布尔标志、用于后续物理计算所需的预估能量衰减因子与唯一标识符；八）实现工具建议与并行化——建议使用成熟几何库（如 Shapely/GEOS 或 CGAL）做精确几何运算、使用 R-tree 做索引、用高性能语言或并行框架（Python + C++ 扩展、并行线程或分布式任务队列）并在镜像/可视性查询上启用并行化以加速对 25 个组合与多频点的批处理；最后，任务应在实现中包含详尽的日志与可视化验证接口以展示每条路径的几何构造过程（用于后续人工审查与单元测试），且严格限定本子任务不执行物理幅相叠加或统计分析，仅输出可供后续模块精确计算物理量的、经过可视性与物理可行性校验的路径列表。",
    "子任务 3 — 路径物理量计算与窄带多波干涉统计分析（单频）：给定经可视性/拓扑检验得到的候选路径集合作为唯一输入（每条路径包含节点序列、每段端点坐标、边/顶点索引及段长），本子任务的目标是为每条路径精确计算其复场贡献并在单一频率下对接收复包络的统计特性做系统性量化和拟合检验，输出规整化的路径物理量表与统计指标。具体步骤与方法如下：一）物理量计算——对每条路径 i 计算总几何长度 r_i（段长之和）和时延 τ_i = r_i / c；规定发射参考场强 E0 和天线方向因子 A_ant(θ_tx,θ_rx)（若无方向性则取 1）；每次镜面反射赋予复反射系数 R_j（默认幅值 |R_j| = sqrt(0.8)，相位 φ_Rj 可设为 0 或作为可调参数），每次绕射用题中 UTD 表达式计算复绕射系数 D_m（式(1)），其中过渡函数 F(x) 在 x<0.001、x>10 分别用给定渐近展开式（式(3),(4)）计算，在 0.001 ≤ x ≤ 10 区间用高精度复费涅尔/ Faddeeva 实现或数值积分评估；数值判据采用容差 ε_geom（例如 1e-9）避免奇异并在 cot 等函数接近奇点时使用极限或正则化。每条路径的复场按统一表达式 E_i = E0 * A_ant * (∏_j R_j) * (∏_m D_m) * (1 / r_i) * exp(j k r_i + j Φ_R_sum)，其中 Φ_R_sum 为反射/绕射累计相位项；记录并输出每条路径的复幅 E_i（幅值与相位）、功率 |E_i|^2、r_i、τ_i、路径类型标签。二）路径筛选与归一化——按照接收功率对路径排序并按相对功率阈值 T_dB（默认 −40 dB）剪去极小贡献路径；保存 Q 有效路径和总接收功率 P_tot = Σ_i |E_i|^2。三）解析性矩与互相关——给出合成复包络 F = Σ_{i=1}^Q E_i（公共时间因子 e^{jωt 忽略）），直接计算确定性一阶矩 μ = F（在几何无随机化时）及二阶矩展式 E[|F|^2] = Σ_i |E_i|^2 + Σ_{i≠j} E_i E_j^*，并为后续统计化定义路径间复协方差矩阵 C_path with entries C_{ij} = E[ E_i E_j^* ]（在无不确定性情形下等于 E_i E_j^*）；计算路径对互相关系数/互相干度 γ_{ij} = |C_{ij}| / sqrt(C_{ii} C_{jj}) 并输出矩阵。四）统计化蒙特卡洛扰动与经验分布估计——为模拟小尺度位置误差与物理不确定性引入参数化扰动并进行蒙特卡洛（默认 N_MC = 2000）：常用扰动包括接收位置微位移 Δx drawn Uniform(−δ,δ)×Uniform(−δ,δ)（建议 δ = min(λ/4, 0.5 m) 或由用户设定）以随机化相位／路径长度，及可选的反射相位/幅值微扰（正态分布 σ_φ、σ_amp）；每一 MC 样本重算 E_i^s 并得到样本合成 F^s = Σ_i E_i^s，收集幅度 R^s = |F^s| 与功率 P^s = |F^s|^2 的样本集合。五）概率分布拟合与检验——基于样本 {R^s} 用方法矩估计与最大似然分别拟合常用包络模型：Rayleigh、Rice（估计 K 因子 K = |dominant|^2 / Σ_{others} |E_i|^2 或用 ML）、Nakagami‑m（用矩法估计 m 和 Ω），并用 Kolmogorov–Smirnov (KS) 检验、Anderson–Darling 或似然比检验报告每种模型的 p 值/拟合优度；同时用核密度估计（KDE）或直方图给出经验 PDF 与模型曲线比较。六）二阶与高阶统计量与不确定性量化——计算样本均值、方差、偏度、峰度及其置信区间（例如通过自助法 bootstrap），输出包络均值 E[|F|]、RMS、信噪比估计、以及因主导路径存在所估的 Rice K 与 Nakagami m 值及其不确定度。七）输出规范——为每一接收点/Tx-Rx 对产生结构化报告：路径列表（带 E_i、|E_i|^2、phase、r_i、τ_i、类型）、Q、P_tot、P_max、主导路径 ID、路径相关矩阵 γ_{ij}、蒙特卡洛样本摘要（N_MC、δ、扰动类型）、经验分布（直方图数据或 KDE 样本）、拟合模型参数与检验 p 值、一阶/二阶矩与置信区间；所有数值按可机器读取格式导出（CSV/JSON），并保存用于可视化的路径几何与显著路径标识。八）数值实现与工具建议——推荐使用高精度数值库（Python: numpy, scipy, mpmath 或 Faddeeva for complex Fresnel integrals），统计拟合与检验采用 scipy.stats / statsmodels 或专门的 ML 优化器，蒙特卡洛并行化可用 multiprocessing 或并行计算框架以提高效率；对关键数值步骤（UTD F(x) 在分界处、cot 接近奇点）应加入容差处理与对数/相位分支一致性检查以保证鲁棒性。该子任务不负责生成几何候选路径（仅以其为输入）且输出应足够完整以直接支持后续宽带合成或可视化模块。",
    "子任务4（宽带频率合成、时域冲激响应与相关性分析及数值实现与验证/灵敏度策略）的目标是：以已列出的确定性路径集合（每条路径至少含有总长度 r_i 和复增益谱参数化 A_i(f) 或其近似常数幅值）为输入，在频率轴上将这些路径的窄带复贡献快速合成为离散频率响应 H(f_n)（f_n = 2000,2001,…,2100 MHz，Δf = 1 MHz，总点数 N_f = 101），并通过数值逆傅里叶变换得到时域冲激响应 h(τ) 与功率时延谱 P(τ)=|h(τ)|^2，进而计算并输出关键宽带指标（平均时延 τ_mean、RMS 时延扩展 σ_τ、多普勒无关情形下的相干带宽 B_c 的若干定义值例如基于 0.5 自相关阈值的 B_c(0.5) 与基于经验关系 B_c≈1/(5σ_τ)），同时给出频域与路径层面的相关性量化：频率互相关矩阵 C(f_p,f_q)=E[H(f_p)H(f_q)^*] 的估计（在确定性场景下直接计算，在引入参数扰动时用蒙特卡洛估计）、每条路径跨频率的相关系数以及同一频率下不同路径之间的互相关系数，从而明确“同一路径不同频率之间的相关性”和“同一频率不同路径之间的相关性”；为实现上述目标应按下列精确步骤与数值约定执行：1) 输入准备：读取并缓存所有路径的几何长度 r_i 和复增益参数 A_i(f) 的表示（若幅值近似不变则仅缓存常数幅值和相位偏移），并确定常数 c 与 k(f)=2π f / c 的计算精度；2) 频域合成：对每一频点向量化计算 H(f_n)=Σ_i A_i(f_n) exp(−j k(f_n) r_i)，采用复杂指数的数值稳定实现并统一相位分支（避免数值折叠），若路径数或频点数大则以块（chunk）或矩阵化方式向量运算并并行化；3) 频->时域转换：为获得时域分辨率 Δτ=1/B（B=100 MHz）与良好旁瓣特性，对 H(f_n) 先按用户选定的窗（例如 Hanning）加窗并进行适当的零填充至下一个功率二的长度 N_fft（以提高时延分辨率与降低环绕），然后调用高效 FFT 库（如 FFTW 或 numpy.fft）做 IFFT 得到离散 h(τ_m)，保证能量守恒并进行 Parseval 校验（频域平均功率与时域功率积分一致）；4) 指标计算：从 P(τ) 计算 τ_mean、σ_τ，并按两种或多种标准计算相干带宽（例如 B_c(0.5) 由互相关函数在 0.5 欄位处的频差判定，另一常用值由 B_c≈1/(5σ_τ) 给出），同时计算频域相关矩阵 C(f_p,f_q)（若需统计化，则对每一蒙特卡洛样本计算 H^s(f) 并累积样本均值与协方差）；5) 数值实现细节：UTD 或其他频率依赖项的评估（如 A_i(f) 含绕射系数）应使用高精度复费涅尔/ Faddeeva 实现或在 x 极端区间调用题中给定的渐近式，以避免积分/渐近不连续；对相位与幅度运算应统一数据类型（双精度复数），对大量路径与频点的计算应采用向量化与并行化（频点层与路径层并行、并可对多个 Tx–Rx 并行），并使用缓存策略重复利用 r_i 与中间矩阵以减少重复计算；6) 资源与数值稳定性管理：为控制内存与运算量，允许按能量阈值剪枝极低贡献路径、按频段分块计算并在内存允许范围内做 IFFT；在 IFFT 前应处理相位展开/去卷绕以避免跳变导致时域伪影；7) 验证与一致性检查：实现单元测试验证频域-时域一致性（Parseval 定律）、在已知合成例子上比对解析结果（例如单路径应产生时延脉冲位置与幅度正确），对 UTD/F(x) 的数值实现进行极限（x→0 与 x→∞）一致性测试；8) 校准与灵敏度分析：为评估不确定性与稳健性，定义并执行蒙特卡洛试验（建议 N_MC = 1000–2000，可调整）对关键输入参数（建筑坐标扰动标准差例如 0.1–1.0 m、反射系数幅值±10%、角量化分辨等）做随机化，并对每一试验计算 H(f), h(τ), τ_mean, σ_τ, B_c 以获得统计分布与置信区间，输出敏感度量表（例如参数扰动对 τ_mean 与 B_c 的标准差比）；9) 输出格式与可视化对象：生成并保存机器可读结果文件（频域 H(f_n) 列表、时域 h(τ_m) 序列、P(τ) 向量、τ_mean、σ_τ、B_c、频率相关矩阵 C 及其特征值/谱图、蒙特卡洛样本统计摘要与置信区间），并提供可选的图像（PDP、CIR、频域相关热图、B_c 随扰动的置信区间曲线）；10) 工具与库建议：推荐使用 Python + numpy/scipy（或 MATLAB）做向量化运算与 FFT，调用 Faddeeva / mpmath 或专用 C 库做复费涅尔积分，采用 FFTW 或 MKL 加速 IFFT，使用 multiprocessing / joblib / MPI 做并行化，并以 HDF5/NetCDF 保存大规模结果以便后续分析。整个子任务的成品应包括清晰的输入/输出接口定义、可复现的数值实现、自动一致性检验与可配置的灵敏度试验参数，使得在给定路径集合和一组配置参数下可一次性产出完整的宽带传输函数、时域冲激响应、时延统计与频域/路径相关性分析结果并伴随不确定性度量。"
  ]
}