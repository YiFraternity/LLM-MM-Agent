{
  "tasks": [],
  "problem_str": "问题背景：\n大脑是人体中高级神经活动的中枢，拥有着数以亿计的神经元，并通过相互连接来传递和处理人体信息。脑电信号按其产生的方式可分为诱发脑电信号和自发脑电信号。诱发脑电信号是通过某种外界刺激使大脑产生电位变化从而形成的脑电活动；自发脑电信号是指在没有外界特殊刺激下，大脑自发产生的脑电活动。\n\n在日常生活中，人的大脑控制着感知、思维、运动及语言等功能，且以外围神经为媒介向身体各部分发出指令。因此，当外围神经受损或肌肉受损时，大脑发出指令的传输通路便会受阻，人体将无法正常完成大脑指令的输出，也就失去了与外界交流和控制的能力。研究发现，在外围神经失去作用的情况下，人的大脑依旧可以正常运行，而且其发出指令的部分信息可以通过一些路径表征出来。脑-机接口技术旨在不依赖正常的由外围神经或肌肉组织组成的输出通路的通讯系统，实现大脑与外部辅助设备之间的交流沟通。\n\nP300事件相关电位是诱发脑电信号的一种，在小概率刺激发生后300毫秒范围左右出现的一个正向波峰（相对基线来说呈现向上趋势的波）。由于个体间的差异性，P300的发生时间也有所不同，图1表示的是在刺激发生后450毫秒左右的P300波形。P300电位作为一种内源性成分，它不受刺激物理特性影响，与知觉或认知心理活动有关，与注意、记忆、智能等加工过程密切相关。基于P300的脑-机接口优点是使用者无需通过复杂训练就可以获得较高的识别准确率，具有稳定的锁时性和高时间精度特性。\n\n睡眠是身体休整积蓄能量的重要环节，睡眠质量对人的身心状态也有着重大影响。如何提高睡眠质量，减少睡眠相关疾病对健康的影响，日益受到广泛关注。睡眠过程中采集的脑电信号，属于自发型的脑电信号。自发型的睡眠脑电信号能够反映身体状态的自身变化，也是用来诊断和治疗相关疾病的重要依据。\n\n睡眠过程是一个动态变化的复杂过程。在国际睡眠分期的判读标准R\\&K中，对睡眠过程中的不同状态给出了划分：除去清醒期以外，睡眠周期是由两种睡眠状态交替循环，分别是非快速眼动期和快速眼动期；在非快速眼动期中，根据睡眠状态由浅入深的逐步变化，又进一步分为睡眠Ⅰ期，睡眠Ⅱ期，睡眠Ⅲ期和睡眠Ⅳ期；睡眠Ⅲ期和睡眠Ⅳ期又可合并为深睡眠期。图2给出了不同睡眠分期对应的脑电信号时序列，自上而下依次为清醒期、睡眠Ⅰ期、睡眠Ⅱ期、深睡眠和快速眼动期。从图2中可以观察到，脑电信号在不同睡眠分期所呈现的特点有所不同。基于脑电信号进行自动分期，能够减轻专家医师的人工负担，也是评估睡眠质量、诊断和治疗睡眠相关疾病的重要辅助工具。\n\n问题要求：\n本赛题包含2个附件（数据文件），四个课题任务。具体说明如下：\n\n附件1：P300脑机接口实验数据\n\n提供了5个健康成年被试（S1-S5）的P300脑机接口实验数据，平均年龄为20岁。在实验的过程中，要求每一位被试（被测试者）集中注意力。P300脑机接口实验的设计如下：每位被试能够观察到一个由36个字符组成的字符矩阵，如图3所示，字符矩阵以行或列为单位（共6行6列）。每轮实验的设计流程：首先，提示被试注视“目标字符”，例如在图3的字符矩阵上方，出现的灰色字符“A”；其次，进入字符矩阵的闪烁模式，每次以随机的顺序闪烁字符矩阵的一行或一列，闪烁时长为80毫秒，间隔为80毫秒；最后，当所有行和列均闪烁一次后，则结束一轮实验。在被试注视“目标字符”的过程中，当目标字符所在行或列闪烁时，脑电信号中会出现P300电位；而当其他行和列闪烁时，则不会出现P300电位。上述实验流程为1轮，共重复5轮。\n\n每位被试的P300脑电数据包含有4个文件，具体说明如下：\n\n- \\texttt{train\\_data}: 训练用数据；\n- \\texttt{train\\_event}: 训练数据的事件标签；\n- \\texttt{test\\_data}: 测试用数据；\n- \\texttt{test\\_event}: 测试数据的事件标签。\n\n训练用数据包括12个已知目标字符的数据（char01~char12），测试用数据包括10个待识别目标字符的数据（char13~char22）。每个字符矩阵闪烁实验中，脑电数据表格包含有 $20$ 列（每列表示 $1$ 个记录通道，记录通道依次进行编号，表1为记录通道的标识符，图5对应了记录通道的位置），脑电数据表格的行表示样本点数据，采样频率为 $250Hz$。信号采集设备设置了参考电极和接地电极，即记录通道的信号为作用电极与参考电极之间的差值。\n\n\\begin{table}[H]\n\\centering\n\\caption{采集通道的标识符}\n\\begin{tabular}{|c|c|c|c|}\n\\hline\n标识符 & 通道名称 & 标识符 & 通道名称 \\\\\n\\hline\n1 & Fz & 11 & CP6 \\\\\n2 & F3 & 12 & O1 \\\\\n3 & F4 & 13 & O2 \\\\\n4 & C3 & 14 & P7 \\\\\n5 & Cz & 15 & P8 \\\\\n6 & C4 & 16 & T7 \\\\\n7 & P3 & 17 & T8 \\\\\n8 & Pz & 18 & CP3 \\\\\n9 & P4 & 19 & CP4 \\\\\n10 & CP5 & 20 & Oz \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=0.6\\textwidth]{brain_channel.png}\n\\caption{脑电信号采集通道图}\n\\end{figure}\n\n训练数据中的标签文件同样是以子表形式与实验数据相对应，子表的名称为 “charXX(Y)”，$XX$ 对应相应字符的序列号，$Y$ 表示实际的目标字符。子表的内容包含了两列，第一列表示标签，第二列为采样点序号。每轮实验的起始标签为目标字符对应的标识符（字符矩阵中 $36$ 个字符的标识符详见表2，如“101”表示“A”），接下来为闪烁的行或列的标识符（详见图6，如“2”表示第2行，“9”表示第3列），一轮实验的结束标签为“100”。在训练数据的事件标签文件中，第一行给出了目标字符的标识符和对应的采样点序号，接下来是随机闪烁的行和列的标识符和对应的采样点序号，每轮实验以“100”标识符结束，共重复5次。\n\n测试数据中的标签文件同样是以子表形式与实验数据相对应，子表的名称为 “charXX”，$XX$ 对应相应字符的序列号。在测试数据的事件标签文件中，第一行给出了待识别目标字符的标识符，统一表示为“666”，需要通过对脑电信号进行分析，得到出现P300电位的行和列，并判断得到目标字符的识别结果。\\begin{table}[H]\n\\centering\n\\caption{字符矩阵的标识符}\n\\begin{tabular}{|c|c|c|c|c|c|}\n\\hline\nA & 101 & B & 102 & C & 103 \\\\\n\\hline\nD & 104 & E & 105 & F & 106 \\\\\n\\hline\nG & 107 & H & 108 & I & 109 \\\\\n\\hline\nJ & 110 & K & 111 & L & 112 \\\\\n\\hline\nM & 113 & N & 114 & O & 115 \\\\\n\\hline\nP & 116 & Q & 117 & R & 118 \\\\\n\\hline\nS & 119 & T & 120 & U & 121 \\\\\n\\hline\nV & 122 & W & 123 & X & 124 \\\\\n\\hline\nY & 125 & Z & 126 & 1 & 127 \\\\\n\\hline\n2 & 128 & 3 & 129 & 4 & 130 \\\\\n\\hline\n5 & 131 & 6 & 132 & 7 & 133 \\\\\n\\hline\n8 & 134 & 9 & 135 & 0 & 136 \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=0.8\\textwidth]{row_col_identifier.png}\n\\caption{行/列的标识符}\n\\end{figure}\n\n附件2：睡眠脑电数据\n\n提供3000个睡眠脑电特征样本及其标签，取自不同的健康成年人整夜睡眠过程。第一列为“已知标签”，用数字形式来表示不同的睡眠分期：清醒期（6），快速眼动期（5），睡眠Ⅰ期（4），睡眠Ⅱ期（3），深睡眠期（2）；第二至五列为从原始时序列中计算得到的特征参数，依次包括“Alpha”，“Beta”，“Theta”，“Delta”，分别对应了脑电信号在“8-13Hz”，“14-25Hz”，“4-7Hz”和“0.5-4Hz”频率范围内的能量占比，特征参数单位为百分比。\n\n根据以上附件所给出的数据来源和实验数据，请研究以下问题：\n\n问题一：在脑-机接口系统中既要考虑目标的分类准确率，同时又要保证一定的信息传输速率。请根据附件1所给数据，设计或采用一个方法，在尽可能使用较少轮次（要求轮次数小于等于5）的测试数据的情况下，找出附件1中5个被试测试集中的10个待识别目标，并给出具体的分类识别过程，可与几种方法进行对比，来说明设计方法的合理性。\n\n问题二：由于采集的原始脑电数据量较大，这样的信号势必包含较多的冗余信息。根据图5和表1，在20个脑电信号采集通道中，无关或冗余的通道数据不仅会增加系统的复杂度，且影响分类识别的准确率和性能。请分析附件1所给数据，并设计一个通道选择算法，给出针对每个被试的、更有利于分类的通道名称。称组合（要求通道组合的数量小于20大于等于10，每个被试所选的通道可以不相同，具体的通道名称见图5和表1）。基于通道选择的结果，进一步分析对于所有被试都较适用的一组最优通道名称组合，并给出具体分析过程。为了方便参赛者对最优通道组合进行选择，赛题给出了测试数据（char13-char17）的结果，它们的字符分别是：M、F、5、2、I。\n\n问题三：在P300脑-机接口系统中，往往需要花费很长时间获取有标签样本来训练模型。为了减少训练时间，请根据附件1所给数据，选择适量的样本作为有标签样本，其余训练样本作为无标签样本，在问题二所得一组最优通道组合的基础上，设计一种学习的方法，并利用问题二的测试数据（char13-char17）检验方法的有效性，同时利用所设计的学习方法找出测试集中的其余待识别目标（char18-char22）。\n\n问题四：根据附件2中所给出的特征样本，请设计一个睡眠分期预测模型，在尽可能少的训练样本的基础上，得到相对较高的预测准确率，给出训练数据和测试数据的选取方式和分配比例，说明具体的分类识别过程，并结合分类性能指标对预测的效果进行分析。\n\n注意：在研究问题一时，不能将问题二提供的5个测试数据的结果作为已知条件，若使用该条件，则被判为作弊处理。\nAddendum: \n注意：在研究问题一时，不能将问题二提供的5个测试数据的结果作为已知条件，若使用该条件，则被判为作弊处理。\nDataset Path:\n['2020年中国研究生数学建模竞赛C题补充说明.md', 'S1', 'S2', 'S3', 'S4', 'S5', '附件2-睡眠脑电数据.xlsx']\n\nData Description:\n该数据集主要包含两部分：一是用于P300脑机接口实验的多被试脑电数据集，包含5位健康成人被试S1–S5的训练和测试数据及其对应的事件标签文件（每位被试通常提供四个文件，格式如S1_train_data.xlsx、S1_train_event.xlsx、S1_test_data.xlsx、S1_test_event.xlsx），实验采用36字符矩阵按行或列闪烁以诱发P300电位，目标是通过检测P300识别被试注视的字符；事件标签文件用于标注每次刺激的类型和时序以便提取事后事件相关电位。数据集中对个别被试有说明性修正：S2_test_event.xlsx缺少char22的event信息，S3_test_data.xlsx缺少char22的原始数据，因此对S2和S3的处理要求将待识别目标范围限定为char01–char21（即仅考虑前21个字符），而对S1、S4、S5的待识别目标仍为char13–char22共10个目标；此外S4的实验细节中明确每轮共进行5轮、每次闪烁时长80毫秒、间隔80毫秒。二是附件形式的睡眠/清醒期脑电数据表（附件2-睡眠脑电数据.xlsx），记录了清醒期样本的频带比率信息，包括Alpha（8–13Hz）、Beta（14–25Hz）、Theta（4–7Hz）、Delta（0.5–4Hz）各频段的百分比以及一个“已知标签”列（数值6表示清醒期），表中还存在若干重复或空列（如Unnamed:5及重复的频段描述列）无实际测量意义。总体上该数据集可用于P300目标识别模型训练与测试、事件相关电位分析以及基于频带百分比的清醒/睡眠态识别研究，但使用时需注意S2与S3的缺失和修正说明，以及个别冗余或空列的清理。",
  "problem": {
    "background": "大脑是人体中高级神经活动的中枢，拥有着数以亿计的神经元，并通过相互连接来传递和处理人体信息。脑电信号按其产生的方式可分为诱发脑电信号和自发脑电信号。诱发脑电信号是通过某种外界刺激使大脑产生电位变化从而形成的脑电活动；自发脑电信号是指在没有外界特殊刺激下，大脑自发产生的脑电活动。\n\n在日常生活中，人的大脑控制着感知、思维、运动及语言等功能，且以外围神经为媒介向身体各部分发出指令。因此，当外围神经受损或肌肉受损时，大脑发出指令的传输通路便会受阻，人体将无法正常完成大脑指令的输出，也就失去了与外界交流和控制的能力。研究发现，在外围神经失去作用的情况下，人的大脑依旧可以正常运行，而且其发出指令的部分信息可以通过一些路径表征出来。脑-机接口技术旨在不依赖正常的由外围神经或肌肉组织组成的输出通路的通讯系统，实现大脑与外部辅助设备之间的交流沟通。\n\nP300事件相关电位是诱发脑电信号的一种，在小概率刺激发生后300毫秒范围左右出现的一个正向波峰（相对基线来说呈现向上趋势的波）。由于个体间的差异性，P300的发生时间也有所不同，图1表示的是在刺激发生后450毫秒左右的P300波形。P300电位作为一种内源性成分，它不受刺激物理特性影响，与知觉或认知心理活动有关，与注意、记忆、智能等加工过程密切相关。基于P300的脑-机接口优点是使用者无需通过复杂训练就可以获得较高的识别准确率，具有稳定的锁时性和高时间精度特性。\n\n睡眠是身体休整积蓄能量的重要环节，睡眠质量对人的身心状态也有着重大影响。如何提高睡眠质量，减少睡眠相关疾病对健康的影响，日益受到广泛关注。睡眠过程中采集的脑电信号，属于自发型的脑电信号。自发型的睡眠脑电信号能够反映身体状态的自身变化，也是用来诊断和治疗相关疾病的重要依据。\n\n睡眠过程是一个动态变化的复杂过程。在国际睡眠分期的判读标准R\\&K中，对睡眠过程中的不同状态给出了划分：除去清醒期以外，睡眠周期是由两种睡眠状态交替循环，分别是非快速眼动期和快速眼动期；在非快速眼动期中，根据睡眠状态由浅入深的逐步变化，又进一步分为睡眠Ⅰ期，睡眠Ⅱ期，睡眠Ⅲ期和睡眠Ⅳ期；睡眠Ⅲ期和睡眠Ⅳ期又可合并为深睡眠期。图2给出了不同睡眠分期对应的脑电信号时序列，自上而下依次为清醒期、睡眠Ⅰ期、睡眠Ⅱ期、深睡眠和快速眼动期。从图2中可以观察到，脑电信号在不同睡眠分期所呈现的特点有所不同。基于脑电信号进行自动分期，能够减轻专家医师的人工负担，也是评估睡眠质量、诊断和治疗睡眠相关疾病的重要辅助工具。",
    "problem_requirement": "本赛题包含2个附件（数据文件），四个课题任务。具体说明如下：\n\n附件1：P300脑机接口实验数据\n\n提供了5个健康成年被试（S1-S5）的P300脑机接口实验数据，平均年龄为20岁。在实验的过程中，要求每一位被试（被测试者）集中注意力。P300脑机接口实验的设计如下：每位被试能够观察到一个由36个字符组成的字符矩阵，如图3所示，字符矩阵以行或列为单位（共6行6列）。每轮实验的设计流程：首先，提示被试注视“目标字符”，例如在图3的字符矩阵上方，出现的灰色字符“A”；其次，进入字符矩阵的闪烁模式，每次以随机的顺序闪烁字符矩阵的一行或一列，闪烁时长为80毫秒，间隔为80毫秒；最后，当所有行和列均闪烁一次后，则结束一轮实验。在被试注视“目标字符”的过程中，当目标字符所在行或列闪烁时，脑电信号中会出现P300电位；而当其他行和列闪烁时，则不会出现P300电位。上述实验流程为1轮，共重复5轮。\n\n每位被试的P300脑电数据包含有4个文件，具体说明如下：\n\n- \\texttt{train\\_data}: 训练用数据；\n- \\texttt{train\\_event}: 训练数据的事件标签；\n- \\texttt{test\\_data}: 测试用数据；\n- \\texttt{test\\_event}: 测试数据的事件标签。\n\n训练用数据包括12个已知目标字符的数据（char01~char12），测试用数据包括10个待识别目标字符的数据（char13~char22）。每个字符矩阵闪烁实验中，脑电数据表格包含有 $20$ 列（每列表示 $1$ 个记录通道，记录通道依次进行编号，表1为记录通道的标识符，图5对应了记录通道的位置），脑电数据表格的行表示样本点数据，采样频率为 $250Hz$。信号采集设备设置了参考电极和接地电极，即记录通道的信号为作用电极与参考电极之间的差值。\n\n\\begin{table}[H]\n\\centering\n\\caption{采集通道的标识符}\n\\begin{tabular}{|c|c|c|c|}\n\\hline\n标识符 & 通道名称 & 标识符 & 通道名称 \\\\\n\\hline\n1 & Fz & 11 & CP6 \\\\\n2 & F3 & 12 & O1 \\\\\n3 & F4 & 13 & O2 \\\\\n4 & C3 & 14 & P7 \\\\\n5 & Cz & 15 & P8 \\\\\n6 & C4 & 16 & T7 \\\\\n7 & P3 & 17 & T8 \\\\\n8 & Pz & 18 & CP3 \\\\\n9 & P4 & 19 & CP4 \\\\\n10 & CP5 & 20 & Oz \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=0.6\\textwidth]{brain_channel.png}\n\\caption{脑电信号采集通道图}\n\\end{figure}\n\n训练数据中的标签文件同样是以子表形式与实验数据相对应，子表的名称为 “charXX(Y)”，$XX$ 对应相应字符的序列号，$Y$ 表示实际的目标字符。子表的内容包含了两列，第一列表示标签，第二列为采样点序号。每轮实验的起始标签为目标字符对应的标识符（字符矩阵中 $36$ 个字符的标识符详见表2，如“101”表示“A”），接下来为闪烁的行或列的标识符（详见图6，如“2”表示第2行，“9”表示第3列），一轮实验的结束标签为“100”。在训练数据的事件标签文件中，第一行给出了目标字符的标识符和对应的采样点序号，接下来是随机闪烁的行和列的标识符和对应的采样点序号，每轮实验以“100”标识符结束，共重复5次。\n\n测试数据中的标签文件同样是以子表形式与实验数据相对应，子表的名称为 “charXX”，$XX$ 对应相应字符的序列号。在测试数据的事件标签文件中，第一行给出了待识别目标字符的标识符，统一表示为“666”，需要通过对脑电信号进行分析，得到出现P300电位的行和列，并判断得到目标字符的识别结果。\\begin{table}[H]\n\\centering\n\\caption{字符矩阵的标识符}\n\\begin{tabular}{|c|c|c|c|c|c|}\n\\hline\nA & 101 & B & 102 & C & 103 \\\\\n\\hline\nD & 104 & E & 105 & F & 106 \\\\\n\\hline\nG & 107 & H & 108 & I & 109 \\\\\n\\hline\nJ & 110 & K & 111 & L & 112 \\\\\n\\hline\nM & 113 & N & 114 & O & 115 \\\\\n\\hline\nP & 116 & Q & 117 & R & 118 \\\\\n\\hline\nS & 119 & T & 120 & U & 121 \\\\\n\\hline\nV & 122 & W & 123 & X & 124 \\\\\n\\hline\nY & 125 & Z & 126 & 1 & 127 \\\\\n\\hline\n2 & 128 & 3 & 129 & 4 & 130 \\\\\n\\hline\n5 & 131 & 6 & 132 & 7 & 133 \\\\\n\\hline\n8 & 134 & 9 & 135 & 0 & 136 \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=0.8\\textwidth]{row_col_identifier.png}\n\\caption{行/列的标识符}\n\\end{figure}\n\n附件2：睡眠脑电数据\n\n提供3000个睡眠脑电特征样本及其标签，取自不同的健康成年人整夜睡眠过程。第一列为“已知标签”，用数字形式来表示不同的睡眠分期：清醒期（6），快速眼动期（5），睡眠Ⅰ期（4），睡眠Ⅱ期（3），深睡眠期（2）；第二至五列为从原始时序列中计算得到的特征参数，依次包括“Alpha”，“Beta”，“Theta”，“Delta”，分别对应了脑电信号在“8-13Hz”，“14-25Hz”，“4-7Hz”和“0.5-4Hz”频率范围内的能量占比，特征参数单位为百分比。\n\n根据以上附件所给出的数据来源和实验数据，请研究以下问题：\n\n问题一：在脑-机接口系统中既要考虑目标的分类准确率，同时又要保证一定的信息传输速率。请根据附件1所给数据，设计或采用一个方法，在尽可能使用较少轮次（要求轮次数小于等于5）的测试数据的情况下，找出附件1中5个被试测试集中的10个待识别目标，并给出具体的分类识别过程，可与几种方法进行对比，来说明设计方法的合理性。\n\n问题二：由于采集的原始脑电数据量较大，这样的信号势必包含较多的冗余信息。根据图5和表1，在20个脑电信号采集通道中，无关或冗余的通道数据不仅会增加系统的复杂度，且影响分类识别的准确率和性能。请分析附件1所给数据，并设计一个通道选择算法，给出针对每个被试的、更有利于分类的通道名称。称组合（要求通道组合的数量小于20大于等于10，每个被试所选的通道可以不相同，具体的通道名称见图5和表1）。基于通道选择的结果，进一步分析对于所有被试都较适用的一组最优通道名称组合，并给出具体分析过程。为了方便参赛者对最优通道组合进行选择，赛题给出了测试数据（char13-char17）的结果，它们的字符分别是：M、F、5、2、I。\n\n问题三：在P300脑-机接口系统中，往往需要花费很长时间获取有标签样本来训练模型。为了减少训练时间，请根据附件1所给数据，选择适量的样本作为有标签样本，其余训练样本作为无标签样本，在问题二所得一组最优通道组合的基础上，设计一种学习的方法，并利用问题二的测试数据（char13-char17）检验方法的有效性，同时利用所设计的学习方法找出测试集中的其余待识别目标（char18-char22）。\n\n问题四：根据附件2中所给出的特征样本，请设计一个睡眠分期预测模型，在尽可能少的训练样本的基础上，得到相对较高的预测准确率，给出训练数据和测试数据的选取方式和分配比例，说明具体的分类识别过程，并结合分类性能指标对预测的效果进行分析。\n\n注意：在研究问题一时，不能将问题二提供的5个测试数据的结果作为已知条件，若使用该条件，则被判为作弊处理。",
    "dataset_path": [
      "2020年中国研究生数学建模竞赛C题补充说明.md",
      "S1",
      "S2",
      "S3",
      "S4",
      "S5",
      "附件2-睡眠脑电数据.xlsx"
    ],
    "dataset_description": {
      "2020年中国研究生数学建模竞赛C题补充说明": "2020年中国研究生数学建模竞赛C题补充说明，主要针对P300脑电数据的勘误信息及针对S2和S3被试的数据处理说明。S2_test_event.xlsx中缺少char22的event信息，S3_test_data.xlsx中缺少char22的原始数据。题目中针对S2和S3被试只需考虑char01-char21，其余被试不做变动。涉及问题一和问题三，2020年中国研究生数学建模竞赛C题补充说明.md中S1，S4和S5待识别目标为10个（char13-char22），2020年中国研究生数学建模竞赛C题补充说明.md中S2和S3的待识别目标改为9个（char13~char21）。",
      "S1": "该数据集包含了5位健康成年被试（S1-S5）的P300脑机接口实验数据，每位被试的数据分为训练和测试两部分，每部分又包括数据文件和事件标签文件。具体来说，对于每个被试，数据集包含四个文件：训练数据（如S1_train_data.xlsx）、训练数据的事件标签（如S1_train_event.xlsx）、测试数据（如S1_test_data.xlsx）和测试数据的事件标签（如S1_test_event.xlsx）。实验设计中，被试需注视一个由36个字符组成的字符矩阵，矩阵以行或列为单位闪烁，目标是通过脑电信号检测P300电位，以识别被试注视的目标字符。",
      "S2": "该数据集包含一位被试（S2）的P300脑机接口实验数据，包括训练数据和测试数据及其对应的事件标签。具体文件包括：S2_train_data.xlsx（训练用数据）、S2_train_event.xlsx（训练数据的事件标签）、S2_test_data.xlsx（测试用数据）、S2_test_event.xlsx（测试数据的事件标签）。这些数据来源于P300脑机接口实验，实验中被试需集中注意力观察一个由36个字符组成的字符矩阵，矩阵以行或列为单位闪烁，目标是通过脑电信号检测P300电位，以识别被试注视的目标字符。",
      "S3": "该数据集包含一位被试（S3）的P300脑机接口实验数据，包括训练数据和测试数据。具体文件包括：S3_train_data.xlsx（训练用数据），S3_train_event.xlsx（训练数据的事件标签），S3_test_data.xlsx（测试用数据），S3_test_event.xlsx（测试数据的事件标签）。这些数据来源于P300脑机接口实验，实验中被试需集中注意力观察一个由36个字符组成的字符矩阵，矩阵以行或列为单位闪烁，目标是通过脑电信号检测P300电位，以识别被试注视的目标字符。",
      "S4": "S4包含S4被试的P300脑机接口实验数据，包括训练数据（train_data.xlsx）及其对应的事件标签（train_event.xlsx），以及测试数据（test_data.xlsx）及其对应的事件标签（test_event.xlsx）。这些数据来源于一个由36个字符组成的字符矩阵实验，其中目标字符的闪烁会引发P300电位，而非目标字符的闪烁则不会。实验共进行了5轮，每轮中字符矩阵的行或列以随机顺序闪烁，每次闪烁时长为80毫秒，间隔也为80毫秒。",
      "S5": "该数据集包含一位被试（S5）的P300脑机接口实验数据，包括训练数据和测试数据。具体文件包括：S5_train_data.xlsx（训练用数据），S5_train_event.xlsx（训练数据的事件标签），S5_test_data.xlsx（测试用数据），S5_test_event.xlsx（测试数据的事件标签）。这些数据来源于P300脑机接口实验，实验中被试需集中注意力观察一个由36个字符组成的字符矩阵，矩阵以行或列为单位闪烁，目标是通过脑电信号检测P300电位，以识别被试注视的目标字符。",
      "附件2-睡眠脑电数据": "附件2-睡眠脑电数据.xlsx包含清醒期的睡眠脑电数据，记录了不同频段（Alpha、Beta、Theta、Delta）的脑电波活动百分比。"
    },
    "variable_description": [
      {},
      {},
      {},
      {},
      {},
      {},
      {
        "已知标签": "表示数据所属的清醒期阶段，数值为6表示清醒期。",
        "Alpha": "Alpha频段（8-13Hz）的脑电波活动百分比。",
        "Beta": "Beta频段（14-25Hz）的脑电波活动百分比。",
        "Theta": "Theta频段（4-7Hz）的脑电波活动百分比。",
        "Delta": "Delta频段（0.5-4Hz）的脑电波活动百分比。",
        "Unnamed: 5": "该列为空，无实际意义。",
        "Alpha：8-13Hz": "重复Alpha频段的描述，无实际数据。",
        "Beta：14-25Hz": "重复Beta频段的描述，无实际数据。",
        "Theta：4-7Hz": "重复Theta频段的描述，无实际数据。",
        "Delta：0.5-4Hz": "重复Delta频段的描述，无实际数据。"
      }
    ],
    "addendum": "注意：在研究问题一时，不能将问题二提供的5个测试数据的结果作为已知条件，若使用该条件，则被判为作弊处理。",
    "data_summary": "Dataset Path:\n['2020年中国研究生数学建模竞赛C题补充说明.md', 'S1', 'S2', 'S3', 'S4', 'S5', '附件2-睡眠脑电数据.xlsx']\n\nData Description:\n该数据集主要包含两部分：一是用于P300脑机接口实验的多被试脑电数据集，包含5位健康成人被试S1–S5的训练和测试数据及其对应的事件标签文件（每位被试通常提供四个文件，格式如S1_train_data.xlsx、S1_train_event.xlsx、S1_test_data.xlsx、S1_test_event.xlsx），实验采用36字符矩阵按行或列闪烁以诱发P300电位，目标是通过检测P300识别被试注视的字符；事件标签文件用于标注每次刺激的类型和时序以便提取事后事件相关电位。数据集中对个别被试有说明性修正：S2_test_event.xlsx缺少char22的event信息，S3_test_data.xlsx缺少char22的原始数据，因此对S2和S3的处理要求将待识别目标范围限定为char01–char21（即仅考虑前21个字符），而对S1、S4、S5的待识别目标仍为char13–char22共10个目标；此外S4的实验细节中明确每轮共进行5轮、每次闪烁时长80毫秒、间隔80毫秒。二是附件形式的睡眠/清醒期脑电数据表（附件2-睡眠脑电数据.xlsx），记录了清醒期样本的频带比率信息，包括Alpha（8–13Hz）、Beta（14–25Hz）、Theta（4–7Hz）、Delta（0.5–4Hz）各频段的百分比以及一个“已知标签”列（数值6表示清醒期），表中还存在若干重复或空列（如Unnamed:5及重复的频段描述列）无实际测量意义。总体上该数据集可用于P300目标识别模型训练与测试、事件相关电位分析以及基于频带百分比的清醒/睡眠态识别研究，但使用时需注意S2与S3的缺失和修正说明，以及个别冗余或空列的清理。",
    "data_description": {
      "2020年中国研究生数学建模竞赛C题补充说明": "2020年中国研究生数学建模竞赛C题补充说明，主要针对P300脑电数据的勘误信息及针对S2和S3被试的数据处理说明。S2_test_event.xlsx中缺少char22的event信息，S3_test_data.xlsx中缺少char22的原始数据。题目中针对S2和S3被试只需考虑char01-char21，其余被试不做变动。涉及问题一和问题三，2020年中国研究生数学建模竞赛C题补充说明.md中S1，S4和S5待识别目标为10个（char13-char22），2020年中国研究生数学建模竞赛C题补充说明.md中S2和S3的待识别目标改为9个（char13~char21）。",
      "S1": "该数据集包含了5位健康成年被试（S1-S5）的P300脑机接口实验数据，每位被试的数据分为训练和测试两部分，每部分又包括数据文件和事件标签文件。具体来说，对于每个被试，数据集包含四个文件：训练数据（如S1_train_data.xlsx）、训练数据的事件标签（如S1_train_event.xlsx）、测试数据（如S1_test_data.xlsx）和测试数据的事件标签（如S1_test_event.xlsx）。实验设计中，被试需注视一个由36个字符组成的字符矩阵，矩阵以行或列为单位闪烁，目标是通过脑电信号检测P300电位，以识别被试注视的目标字符。",
      "S2": "该数据集包含一位被试（S2）的P300脑机接口实验数据，包括训练数据和测试数据及其对应的事件标签。具体文件包括：S2_train_data.xlsx（训练用数据）、S2_train_event.xlsx（训练数据的事件标签）、S2_test_data.xlsx（测试用数据）、S2_test_event.xlsx（测试数据的事件标签）。这些数据来源于P300脑机接口实验，实验中被试需集中注意力观察一个由36个字符组成的字符矩阵，矩阵以行或列为单位闪烁，目标是通过脑电信号检测P300电位，以识别被试注视的目标字符。",
      "S3": "该数据集包含一位被试（S3）的P300脑机接口实验数据，包括训练数据和测试数据。具体文件包括：S3_train_data.xlsx（训练用数据），S3_train_event.xlsx（训练数据的事件标签），S3_test_data.xlsx（测试用数据），S3_test_event.xlsx（测试数据的事件标签）。这些数据来源于P300脑机接口实验，实验中被试需集中注意力观察一个由36个字符组成的字符矩阵，矩阵以行或列为单位闪烁，目标是通过脑电信号检测P300电位，以识别被试注视的目标字符。",
      "S4": "S4包含S4被试的P300脑机接口实验数据，包括训练数据（train_data.xlsx）及其对应的事件标签（train_event.xlsx），以及测试数据（test_data.xlsx）及其对应的事件标签（test_event.xlsx）。这些数据来源于一个由36个字符组成的字符矩阵实验，其中目标字符的闪烁会引发P300电位，而非目标字符的闪烁则不会。实验共进行了5轮，每轮中字符矩阵的行或列以随机顺序闪烁，每次闪烁时长为80毫秒，间隔也为80毫秒。",
      "S5": "该数据集包含一位被试（S5）的P300脑机接口实验数据，包括训练数据和测试数据。具体文件包括：S5_train_data.xlsx（训练用数据），S5_train_event.xlsx（训练数据的事件标签），S5_test_data.xlsx（测试用数据），S5_test_event.xlsx（测试数据的事件标签）。这些数据来源于P300脑机接口实验，实验中被试需集中注意力观察一个由36个字符组成的字符矩阵，矩阵以行或列为单位闪烁，目标是通过脑电信号检测P300电位，以识别被试注视的目标字符。",
      "附件2-睡眠脑电数据": "附件2-睡眠脑电数据.xlsx包含清醒期的睡眠脑电数据，记录了不同频段（Alpha、Beta、Theta、Delta）的脑电波活动百分比。"
    },
    "problem_str": "问题背景：\n大脑是人体中高级神经活动的中枢，拥有着数以亿计的神经元，并通过相互连接来传递和处理人体信息。脑电信号按其产生的方式可分为诱发脑电信号和自发脑电信号。诱发脑电信号是通过某种外界刺激使大脑产生电位变化从而形成的脑电活动；自发脑电信号是指在没有外界特殊刺激下，大脑自发产生的脑电活动。\n\n在日常生活中，人的大脑控制着感知、思维、运动及语言等功能，且以外围神经为媒介向身体各部分发出指令。因此，当外围神经受损或肌肉受损时，大脑发出指令的传输通路便会受阻，人体将无法正常完成大脑指令的输出，也就失去了与外界交流和控制的能力。研究发现，在外围神经失去作用的情况下，人的大脑依旧可以正常运行，而且其发出指令的部分信息可以通过一些路径表征出来。脑-机接口技术旨在不依赖正常的由外围神经或肌肉组织组成的输出通路的通讯系统，实现大脑与外部辅助设备之间的交流沟通。\n\nP300事件相关电位是诱发脑电信号的一种，在小概率刺激发生后300毫秒范围左右出现的一个正向波峰（相对基线来说呈现向上趋势的波）。由于个体间的差异性，P300的发生时间也有所不同，图1表示的是在刺激发生后450毫秒左右的P300波形。P300电位作为一种内源性成分，它不受刺激物理特性影响，与知觉或认知心理活动有关，与注意、记忆、智能等加工过程密切相关。基于P300的脑-机接口优点是使用者无需通过复杂训练就可以获得较高的识别准确率，具有稳定的锁时性和高时间精度特性。\n\n睡眠是身体休整积蓄能量的重要环节，睡眠质量对人的身心状态也有着重大影响。如何提高睡眠质量，减少睡眠相关疾病对健康的影响，日益受到广泛关注。睡眠过程中采集的脑电信号，属于自发型的脑电信号。自发型的睡眠脑电信号能够反映身体状态的自身变化，也是用来诊断和治疗相关疾病的重要依据。\n\n睡眠过程是一个动态变化的复杂过程。在国际睡眠分期的判读标准R\\&K中，对睡眠过程中的不同状态给出了划分：除去清醒期以外，睡眠周期是由两种睡眠状态交替循环，分别是非快速眼动期和快速眼动期；在非快速眼动期中，根据睡眠状态由浅入深的逐步变化，又进一步分为睡眠Ⅰ期，睡眠Ⅱ期，睡眠Ⅲ期和睡眠Ⅳ期；睡眠Ⅲ期和睡眠Ⅳ期又可合并为深睡眠期。图2给出了不同睡眠分期对应的脑电信号时序列，自上而下依次为清醒期、睡眠Ⅰ期、睡眠Ⅱ期、深睡眠和快速眼动期。从图2中可以观察到，脑电信号在不同睡眠分期所呈现的特点有所不同。基于脑电信号进行自动分期，能够减轻专家医师的人工负担，也是评估睡眠质量、诊断和治疗睡眠相关疾病的重要辅助工具。\n\n问题要求：\n本赛题包含2个附件（数据文件），四个课题任务。具体说明如下：\n\n附件1：P300脑机接口实验数据\n\n提供了5个健康成年被试（S1-S5）的P300脑机接口实验数据，平均年龄为20岁。在实验的过程中，要求每一位被试（被测试者）集中注意力。P300脑机接口实验的设计如下：每位被试能够观察到一个由36个字符组成的字符矩阵，如图3所示，字符矩阵以行或列为单位（共6行6列）。每轮实验的设计流程：首先，提示被试注视“目标字符”，例如在图3的字符矩阵上方，出现的灰色字符“A”；其次，进入字符矩阵的闪烁模式，每次以随机的顺序闪烁字符矩阵的一行或一列，闪烁时长为80毫秒，间隔为80毫秒；最后，当所有行和列均闪烁一次后，则结束一轮实验。在被试注视“目标字符”的过程中，当目标字符所在行或列闪烁时，脑电信号中会出现P300电位；而当其他行和列闪烁时，则不会出现P300电位。上述实验流程为1轮，共重复5轮。\n\n每位被试的P300脑电数据包含有4个文件，具体说明如下：\n\n- \\texttt{train\\_data}: 训练用数据；\n- \\texttt{train\\_event}: 训练数据的事件标签；\n- \\texttt{test\\_data}: 测试用数据；\n- \\texttt{test\\_event}: 测试数据的事件标签。\n\n训练用数据包括12个已知目标字符的数据（char01~char12），测试用数据包括10个待识别目标字符的数据（char13~char22）。每个字符矩阵闪烁实验中，脑电数据表格包含有 $20$ 列（每列表示 $1$ 个记录通道，记录通道依次进行编号，表1为记录通道的标识符，图5对应了记录通道的位置），脑电数据表格的行表示样本点数据，采样频率为 $250Hz$。信号采集设备设置了参考电极和接地电极，即记录通道的信号为作用电极与参考电极之间的差值。\n\n\\begin{table}[H]\n\\centering\n\\caption{采集通道的标识符}\n\\begin{tabular}{|c|c|c|c|}\n\\hline\n标识符 & 通道名称 & 标识符 & 通道名称 \\\\\n\\hline\n1 & Fz & 11 & CP6 \\\\\n2 & F3 & 12 & O1 \\\\\n3 & F4 & 13 & O2 \\\\\n4 & C3 & 14 & P7 \\\\\n5 & Cz & 15 & P8 \\\\\n6 & C4 & 16 & T7 \\\\\n7 & P3 & 17 & T8 \\\\\n8 & Pz & 18 & CP3 \\\\\n9 & P4 & 19 & CP4 \\\\\n10 & CP5 & 20 & Oz \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=0.6\\textwidth]{brain_channel.png}\n\\caption{脑电信号采集通道图}\n\\end{figure}\n\n训练数据中的标签文件同样是以子表形式与实验数据相对应，子表的名称为 “charXX(Y)”，$XX$ 对应相应字符的序列号，$Y$ 表示实际的目标字符。子表的内容包含了两列，第一列表示标签，第二列为采样点序号。每轮实验的起始标签为目标字符对应的标识符（字符矩阵中 $36$ 个字符的标识符详见表2，如“101”表示“A”），接下来为闪烁的行或列的标识符（详见图6，如“2”表示第2行，“9”表示第3列），一轮实验的结束标签为“100”。在训练数据的事件标签文件中，第一行给出了目标字符的标识符和对应的采样点序号，接下来是随机闪烁的行和列的标识符和对应的采样点序号，每轮实验以“100”标识符结束，共重复5次。\n\n测试数据中的标签文件同样是以子表形式与实验数据相对应，子表的名称为 “charXX”，$XX$ 对应相应字符的序列号。在测试数据的事件标签文件中，第一行给出了待识别目标字符的标识符，统一表示为“666”，需要通过对脑电信号进行分析，得到出现P300电位的行和列，并判断得到目标字符的识别结果。\\begin{table}[H]\n\\centering\n\\caption{字符矩阵的标识符}\n\\begin{tabular}{|c|c|c|c|c|c|}\n\\hline\nA & 101 & B & 102 & C & 103 \\\\\n\\hline\nD & 104 & E & 105 & F & 106 \\\\\n\\hline\nG & 107 & H & 108 & I & 109 \\\\\n\\hline\nJ & 110 & K & 111 & L & 112 \\\\\n\\hline\nM & 113 & N & 114 & O & 115 \\\\\n\\hline\nP & 116 & Q & 117 & R & 118 \\\\\n\\hline\nS & 119 & T & 120 & U & 121 \\\\\n\\hline\nV & 122 & W & 123 & X & 124 \\\\\n\\hline\nY & 125 & Z & 126 & 1 & 127 \\\\\n\\hline\n2 & 128 & 3 & 129 & 4 & 130 \\\\\n\\hline\n5 & 131 & 6 & 132 & 7 & 133 \\\\\n\\hline\n8 & 134 & 9 & 135 & 0 & 136 \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=0.8\\textwidth]{row_col_identifier.png}\n\\caption{行/列的标识符}\n\\end{figure}\n\n附件2：睡眠脑电数据\n\n提供3000个睡眠脑电特征样本及其标签，取自不同的健康成年人整夜睡眠过程。第一列为“已知标签”，用数字形式来表示不同的睡眠分期：清醒期（6），快速眼动期（5），睡眠Ⅰ期（4），睡眠Ⅱ期（3），深睡眠期（2）；第二至五列为从原始时序列中计算得到的特征参数，依次包括“Alpha”，“Beta”，“Theta”，“Delta”，分别对应了脑电信号在“8-13Hz”，“14-25Hz”，“4-7Hz”和“0.5-4Hz”频率范围内的能量占比，特征参数单位为百分比。\n\n根据以上附件所给出的数据来源和实验数据，请研究以下问题：\n\n问题一：在脑-机接口系统中既要考虑目标的分类准确率，同时又要保证一定的信息传输速率。请根据附件1所给数据，设计或采用一个方法，在尽可能使用较少轮次（要求轮次数小于等于5）的测试数据的情况下，找出附件1中5个被试测试集中的10个待识别目标，并给出具体的分类识别过程，可与几种方法进行对比，来说明设计方法的合理性。\n\n问题二：由于采集的原始脑电数据量较大，这样的信号势必包含较多的冗余信息。根据图5和表1，在20个脑电信号采集通道中，无关或冗余的通道数据不仅会增加系统的复杂度，且影响分类识别的准确率和性能。请分析附件1所给数据，并设计一个通道选择算法，给出针对每个被试的、更有利于分类的通道名称。称组合（要求通道组合的数量小于20大于等于10，每个被试所选的通道可以不相同，具体的通道名称见图5和表1）。基于通道选择的结果，进一步分析对于所有被试都较适用的一组最优通道名称组合，并给出具体分析过程。为了方便参赛者对最优通道组合进行选择，赛题给出了测试数据（char13-char17）的结果，它们的字符分别是：M、F、5、2、I。\n\n问题三：在P300脑-机接口系统中，往往需要花费很长时间获取有标签样本来训练模型。为了减少训练时间，请根据附件1所给数据，选择适量的样本作为有标签样本，其余训练样本作为无标签样本，在问题二所得一组最优通道组合的基础上，设计一种学习的方法，并利用问题二的测试数据（char13-char17）检验方法的有效性，同时利用所设计的学习方法找出测试集中的其余待识别目标（char18-char22）。\n\n问题四：根据附件2中所给出的特征样本，请设计一个睡眠分期预测模型，在尽可能少的训练样本的基础上，得到相对较高的预测准确率，给出训练数据和测试数据的选取方式和分配比例，说明具体的分类识别过程，并结合分类性能指标对预测的效果进行分析。\n\n注意：在研究问题一时，不能将问题二提供的5个测试数据的结果作为已知条件，若使用该条件，则被判为作弊处理。\nAddendum: \n注意：在研究问题一时，不能将问题二提供的5个测试数据的结果作为已知条件，若使用该条件，则被判为作弊处理。\nDataset Path:\n['2020年中国研究生数学建模竞赛C题补充说明.md', 'S1', 'S2', 'S3', 'S4', 'S5', '附件2-睡眠脑电数据.xlsx']\n\nData Description:\n该数据集主要包含两部分：一是用于P300脑机接口实验的多被试脑电数据集，包含5位健康成人被试S1–S5的训练和测试数据及其对应的事件标签文件（每位被试通常提供四个文件，格式如S1_train_data.xlsx、S1_train_event.xlsx、S1_test_data.xlsx、S1_test_event.xlsx），实验采用36字符矩阵按行或列闪烁以诱发P300电位，目标是通过检测P300识别被试注视的字符；事件标签文件用于标注每次刺激的类型和时序以便提取事后事件相关电位。数据集中对个别被试有说明性修正：S2_test_event.xlsx缺少char22的event信息，S3_test_data.xlsx缺少char22的原始数据，因此对S2和S3的处理要求将待识别目标范围限定为char01–char21（即仅考虑前21个字符），而对S1、S4、S5的待识别目标仍为char13–char22共10个目标；此外S4的实验细节中明确每轮共进行5轮、每次闪烁时长80毫秒、间隔80毫秒。二是附件形式的睡眠/清醒期脑电数据表（附件2-睡眠脑电数据.xlsx），记录了清醒期样本的频带比率信息，包括Alpha（8–13Hz）、Beta（14–25Hz）、Theta（4–7Hz）、Delta（0.5–4Hz）各频段的百分比以及一个“已知标签”列（数值6表示清醒期），表中还存在若干重复或空列（如Unnamed:5及重复的频段描述列）无实际测量意义。总体上该数据集可用于P300目标识别模型训练与测试、事件相关电位分析以及基于频带百分比的清醒/睡眠态识别研究，但使用时需注意S2与S3的缺失和修正说明，以及个别冗余或空列的清理。"
  },
  "problem_background": "大脑是人体中高级神经活动的中枢，拥有着数以亿计的神经元，并通过相互连接来传递和处理人体信息。脑电信号按其产生的方式可分为诱发脑电信号和自发脑电信号。诱发脑电信号是通过某种外界刺激使大脑产生电位变化从而形成的脑电活动；自发脑电信号是指在没有外界特殊刺激下，大脑自发产生的脑电活动。\n\n在日常生活中，人的大脑控制着感知、思维、运动及语言等功能，且以外围神经为媒介向身体各部分发出指令。因此，当外围神经受损或肌肉受损时，大脑发出指令的传输通路便会受阻，人体将无法正常完成大脑指令的输出，也就失去了与外界交流和控制的能力。研究发现，在外围神经失去作用的情况下，人的大脑依旧可以正常运行，而且其发出指令的部分信息可以通过一些路径表征出来。脑-机接口技术旨在不依赖正常的由外围神经或肌肉组织组成的输出通路的通讯系统，实现大脑与外部辅助设备之间的交流沟通。\n\nP300事件相关电位是诱发脑电信号的一种，在小概率刺激发生后300毫秒范围左右出现的一个正向波峰（相对基线来说呈现向上趋势的波）。由于个体间的差异性，P300的发生时间也有所不同，图1表示的是在刺激发生后450毫秒左右的P300波形。P300电位作为一种内源性成分，它不受刺激物理特性影响，与知觉或认知心理活动有关，与注意、记忆、智能等加工过程密切相关。基于P300的脑-机接口优点是使用者无需通过复杂训练就可以获得较高的识别准确率，具有稳定的锁时性和高时间精度特性。\n\n睡眠是身体休整积蓄能量的重要环节，睡眠质量对人的身心状态也有着重大影响。如何提高睡眠质量，减少睡眠相关疾病对健康的影响，日益受到广泛关注。睡眠过程中采集的脑电信号，属于自发型的脑电信号。自发型的睡眠脑电信号能够反映身体状态的自身变化，也是用来诊断和治疗相关疾病的重要依据。\n\n睡眠过程是一个动态变化的复杂过程。在国际睡眠分期的判读标准R\\&K中，对睡眠过程中的不同状态给出了划分：除去清醒期以外，睡眠周期是由两种睡眠状态交替循环，分别是非快速眼动期和快速眼动期；在非快速眼动期中，根据睡眠状态由浅入深的逐步变化，又进一步分为睡眠Ⅰ期，睡眠Ⅱ期，睡眠Ⅲ期和睡眠Ⅳ期；睡眠Ⅲ期和睡眠Ⅳ期又可合并为深睡眠期。图2给出了不同睡眠分期对应的脑电信号时序列，自上而下依次为清醒期、睡眠Ⅰ期、睡眠Ⅱ期、深睡眠和快速眼动期。从图2中可以观察到，脑电信号在不同睡眠分期所呈现的特点有所不同。基于脑电信号进行自动分期，能够减轻专家医师的人工负担，也是评估睡眠质量、诊断和治疗睡眠相关疾病的重要辅助工具。",
  "problem_requirement": "本赛题包含2个附件（数据文件），四个课题任务。具体说明如下：\n\n附件1：P300脑机接口实验数据\n\n提供了5个健康成年被试（S1-S5）的P300脑机接口实验数据，平均年龄为20岁。在实验的过程中，要求每一位被试（被测试者）集中注意力。P300脑机接口实验的设计如下：每位被试能够观察到一个由36个字符组成的字符矩阵，如图3所示，字符矩阵以行或列为单位（共6行6列）。每轮实验的设计流程：首先，提示被试注视“目标字符”，例如在图3的字符矩阵上方，出现的灰色字符“A”；其次，进入字符矩阵的闪烁模式，每次以随机的顺序闪烁字符矩阵的一行或一列，闪烁时长为80毫秒，间隔为80毫秒；最后，当所有行和列均闪烁一次后，则结束一轮实验。在被试注视“目标字符”的过程中，当目标字符所在行或列闪烁时，脑电信号中会出现P300电位；而当其他行和列闪烁时，则不会出现P300电位。上述实验流程为1轮，共重复5轮。\n\n每位被试的P300脑电数据包含有4个文件，具体说明如下：\n\n- \\texttt{train\\_data}: 训练用数据；\n- \\texttt{train\\_event}: 训练数据的事件标签；\n- \\texttt{test\\_data}: 测试用数据；\n- \\texttt{test\\_event}: 测试数据的事件标签。\n\n训练用数据包括12个已知目标字符的数据（char01~char12），测试用数据包括10个待识别目标字符的数据（char13~char22）。每个字符矩阵闪烁实验中，脑电数据表格包含有 $20$ 列（每列表示 $1$ 个记录通道，记录通道依次进行编号，表1为记录通道的标识符，图5对应了记录通道的位置），脑电数据表格的行表示样本点数据，采样频率为 $250Hz$。信号采集设备设置了参考电极和接地电极，即记录通道的信号为作用电极与参考电极之间的差值。\n\n\\begin{table}[H]\n\\centering\n\\caption{采集通道的标识符}\n\\begin{tabular}{|c|c|c|c|}\n\\hline\n标识符 & 通道名称 & 标识符 & 通道名称 \\\\\n\\hline\n1 & Fz & 11 & CP6 \\\\\n2 & F3 & 12 & O1 \\\\\n3 & F4 & 13 & O2 \\\\\n4 & C3 & 14 & P7 \\\\\n5 & Cz & 15 & P8 \\\\\n6 & C4 & 16 & T7 \\\\\n7 & P3 & 17 & T8 \\\\\n8 & Pz & 18 & CP3 \\\\\n9 & P4 & 19 & CP4 \\\\\n10 & CP5 & 20 & Oz \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=0.6\\textwidth]{brain_channel.png}\n\\caption{脑电信号采集通道图}\n\\end{figure}\n\n训练数据中的标签文件同样是以子表形式与实验数据相对应，子表的名称为 “charXX(Y)”，$XX$ 对应相应字符的序列号，$Y$ 表示实际的目标字符。子表的内容包含了两列，第一列表示标签，第二列为采样点序号。每轮实验的起始标签为目标字符对应的标识符（字符矩阵中 $36$ 个字符的标识符详见表2，如“101”表示“A”），接下来为闪烁的行或列的标识符（详见图6，如“2”表示第2行，“9”表示第3列），一轮实验的结束标签为“100”。在训练数据的事件标签文件中，第一行给出了目标字符的标识符和对应的采样点序号，接下来是随机闪烁的行和列的标识符和对应的采样点序号，每轮实验以“100”标识符结束，共重复5次。\n\n测试数据中的标签文件同样是以子表形式与实验数据相对应，子表的名称为 “charXX”，$XX$ 对应相应字符的序列号。在测试数据的事件标签文件中，第一行给出了待识别目标字符的标识符，统一表示为“666”，需要通过对脑电信号进行分析，得到出现P300电位的行和列，并判断得到目标字符的识别结果。\\begin{table}[H]\n\\centering\n\\caption{字符矩阵的标识符}\n\\begin{tabular}{|c|c|c|c|c|c|}\n\\hline\nA & 101 & B & 102 & C & 103 \\\\\n\\hline\nD & 104 & E & 105 & F & 106 \\\\\n\\hline\nG & 107 & H & 108 & I & 109 \\\\\n\\hline\nJ & 110 & K & 111 & L & 112 \\\\\n\\hline\nM & 113 & N & 114 & O & 115 \\\\\n\\hline\nP & 116 & Q & 117 & R & 118 \\\\\n\\hline\nS & 119 & T & 120 & U & 121 \\\\\n\\hline\nV & 122 & W & 123 & X & 124 \\\\\n\\hline\nY & 125 & Z & 126 & 1 & 127 \\\\\n\\hline\n2 & 128 & 3 & 129 & 4 & 130 \\\\\n\\hline\n5 & 131 & 6 & 132 & 7 & 133 \\\\\n\\hline\n8 & 134 & 9 & 135 & 0 & 136 \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=0.8\\textwidth]{row_col_identifier.png}\n\\caption{行/列的标识符}\n\\end{figure}\n\n附件2：睡眠脑电数据\n\n提供3000个睡眠脑电特征样本及其标签，取自不同的健康成年人整夜睡眠过程。第一列为“已知标签”，用数字形式来表示不同的睡眠分期：清醒期（6），快速眼动期（5），睡眠Ⅰ期（4），睡眠Ⅱ期（3），深睡眠期（2）；第二至五列为从原始时序列中计算得到的特征参数，依次包括“Alpha”，“Beta”，“Theta”，“Delta”，分别对应了脑电信号在“8-13Hz”，“14-25Hz”，“4-7Hz”和“0.5-4Hz”频率范围内的能量占比，特征参数单位为百分比。\n\n根据以上附件所给出的数据来源和实验数据，请研究以下问题：\n\n问题一：在脑-机接口系统中既要考虑目标的分类准确率，同时又要保证一定的信息传输速率。请根据附件1所给数据，设计或采用一个方法，在尽可能使用较少轮次（要求轮次数小于等于5）的测试数据的情况下，找出附件1中5个被试测试集中的10个待识别目标，并给出具体的分类识别过程，可与几种方法进行对比，来说明设计方法的合理性。\n\n问题二：由于采集的原始脑电数据量较大，这样的信号势必包含较多的冗余信息。根据图5和表1，在20个脑电信号采集通道中，无关或冗余的通道数据不仅会增加系统的复杂度，且影响分类识别的准确率和性能。请分析附件1所给数据，并设计一个通道选择算法，给出针对每个被试的、更有利于分类的通道名称。称组合（要求通道组合的数量小于20大于等于10，每个被试所选的通道可以不相同，具体的通道名称见图5和表1）。基于通道选择的结果，进一步分析对于所有被试都较适用的一组最优通道名称组合，并给出具体分析过程。为了方便参赛者对最优通道组合进行选择，赛题给出了测试数据（char13-char17）的结果，它们的字符分别是：M、F、5、2、I。\n\n问题三：在P300脑-机接口系统中，往往需要花费很长时间获取有标签样本来训练模型。为了减少训练时间，请根据附件1所给数据，选择适量的样本作为有标签样本，其余训练样本作为无标签样本，在问题二所得一组最优通道组合的基础上，设计一种学习的方法，并利用问题二的测试数据（char13-char17）检验方法的有效性，同时利用所设计的学习方法找出测试集中的其余待识别目标（char18-char22）。\n\n问题四：根据附件2中所给出的特征样本，请设计一个睡眠分期预测模型，在尽可能少的训练样本的基础上，得到相对较高的预测准确率，给出训练数据和测试数据的选取方式和分配比例，说明具体的分类识别过程，并结合分类性能指标对预测的效果进行分析。\n\n注意：在研究问题一时，不能将问题二提供的5个测试数据的结果作为已知条件，若使用该条件，则被判为作弊处理。",
  "problem_analysis": "从更宏观的背景出发，本题实质上是一个在噪声环境下从多通道时序生物电信号中提取短时诱发成分（P300）并将其用于目标识别，同时在另一个问题中基于频带能量百分比做睡眠分期判读的复合式建模问题。其主要目标可以分为三类：一是对P300脑—机接口（BCI）系统在有限交互轮数（≤5）下提高单次识别准确率与信息传输速率（ITR）的平衡；二是利用通道选择减少输入维度与计算复杂度，同时提升或至少保持分类性能；三是在标注样本稀少的情形下利用半监督或迁移学习方法减少训练成本并扩展到测试集的未标注目标识别；第四是用尽量少的睡眠样本建立稳健的分期模型并评估其泛化能力。上述目标决定了解题路径会同时涉及信号预处理（滤波、基线校正、伪迹剔除与分段）、时频特征提取或直接ERP波形利用、通道选择或空间滤波（如xDAWN/CSP类）、判别模型（LDA/SVM/正则化线性模型或更复杂的深度学习）以及模型选择的跨验证与性能指标设计（既要看识别率也要看ITR、Kappa或混淆矩阵）。在设计目标函数时需明确是以最大化准确率为主、以最大化ITR为主，还是两者的加权组合，因为轮次数减少会降低平均ERP叠加提升SNR的能力，从而形成明显的权衡：更少轮次能提高实时信息速率但通常牺牲识别稳定性，反之多轮次提高SNR但降低通信效率。\n\n对问题描述中的显性与隐性假设需批判性识别：通常隐含的假设包括P300在每次目标刺激时都能被诱发且其形态（潜伏期、振幅）相对稳定以落在可检测时间窗内；不同通道与被试间的空间分布差异可通过通道选择或个体化训练补偿；事件标签（训练集中的行/列标识与时刻）是准确的并可用于精确分段；Trials相互独立、非平稳性（随时间的潜伏期漂移、疲劳、注意力波动）是可忽略或可通过短期自适应校正解决的；以及遗留数据缺失（如S2、S3中部分缺失说明）不会导致整体结果偏倚。这些假设影响解释与应用价值：若P300潜伏期在被试间或随时间显著可变，固定窗截取或简单模板匹配会降低召回；若事件标注存在系统性偏移，训练得到的模型会学到错误的时序特征；若认为通道冗余但实际部分通道含关键空间信息，则盲目削减通道会丢失判别能力。因而模型应保留对潜伏期漂移、基线变动与通道间相关结构的适应机制，如采用时移容忍的特征（如峰值延迟、动态时间规整）、时间-空间滤波与正则化。\n\n各要素之间存在复杂的相互依赖与潜在张力。轮次数、每轮内闪烁次数与平均化策略、通道数量与空间信息完整性、训练样本数与模型复杂度、特征选择方式与分类器稳健性彼此牵连：例如减少轮次数要求提升单次试验的判别力（更强的特征或更优的通道组合），而减少通道数又可能削弱对P300源的空间采样，必须在通道选择与分类器之间进行联合优化；同样，半监督学习在标签稀少时可借助大量无标签样本，但其性能强烈依赖于初始有标签样本的质量与类别边界的清晰度，错误的伪标签会雪崩式放大错误。因此应用上往往需要将通道选择、特征提取与分类算法作为一个联合流程来迭代求解，而非孤立优化。技术选择上也存在权衡：基于简单线性判别（如LDA）在小样本高维问题中通常更稳定并有利于在线实时使用，而基于深度学习的方法在数据充足且能做数据增强或迁移学习时可能取得更高性能但代价是更高的数据与计算需求以及解释性下降。\n\n时间尺度与动态因素对模型稳定性和可持续性影响巨大。P300潜伏期和振幅随被试的警觉度、疲劳、练习效应及电极阻抗等长期或短期因素漂移，导致训练阶段到测试阶段的分布不稳定（域移）。因此应考虑在线自适应机制（如增量训练、递归最小二乘或基于置信度的伪标签自训练）以及短期校准策略以维持判别边界的有效性。此外，在识别字符时可以把问题视为动态逐步决策问题：而不是固定做5轮后判定，可以设计自适应停止规则（当某一行和某一列的置信度差异超过阈值即提前结束），或通过信息论方法（最大熵减少或贝叶斯后验更新）选择下一步要强化刺激的行/列，从而在保证识别准确率的同时最小化交互轮数，提高ITR。这类自适应或主动实验设计策略要求实时更新后验概率并衡量刺激价值，增加了设计复杂度但有较大潜在收益。\n\n考虑问题的替代表述可以带来不同建模策略：将目标识别看作二分类的ERP检测问题（每个闪烁事件是否为目标）再通过行/列投票汇总成字符，适合使用强大的单次事件检验与统计显著性校正；也可以把整个过程建为序列标注或贝叶斯决策问题，直接优化最终字符的后验概率；通道选择可以从单纯的统计显著性筛选扩展为以判别性能为目标的包装法（wrapper）或嵌入式方法（LASSO、基于模型的特征重要性），并可融合空间滤波（xDAWN）以获得更紧凑的通道集合。睡眠分期问题亦可重新表述：既可看作独立样本的多类分类，也可把时间连续性纳入模型（HMM或CRF），后者可在样本量有限时显著提高鲁棒性与生理连贯性，因为睡眠分期具有强序列依赖。\n\n关于不确定性与潜在风险，应明确来源：信号噪声与伪迹、被试之间的异质性、标签噪声（尤其睡眠人工标注具有主观性）、数据缺失（S2/S3部分缺失对泛化评估的影响）、模型选择的不确定性（多种方法性能接近时需用统计检验判断差异）都可能导致结果在不同数据集或实际应用中的不一致。应采用稳健的评估（如交叉验证、分层抽样、置信区间与显著性检验），并对模型在遭遇输入扰动（通道丢失、电极接触差）时的退化行为进行敏感性分析。实践中还应注意不可将问题二中给出的测试字符结果泄露到问题一的建模与调参中，因为这将引入“信息泄露”偏差并违反试题规定。\n\n最后强调建模过程的迭代性与开放性：建议从简单、可解释的流水线开始（滤波—分段—基线校正—时域/频域特征—LDA或正则化线性模型），以获得基线性能并定位主要误差来源；随后逐步引入更复杂的组件（空间滤波、通道选择、半监督伪标签、自适应刺激策略、序列后处理如HMM）并在每一轮迭代中通过独立验证集评估改进的统计显著性。对通道选择应同时考察单被试最优集合与跨被试稳定集合，采用聚合排序或交叉验证的方式得到既能保持性能又便于实际部署的通道组合。对睡眠分期则应结合时间序列先验与少样本学习策略（迁移学习、数据增强、基于模型的先验），并用Kappa、混淆矩阵与分期过渡一致性来综合评估模型效果。通过这样的迭代、反思与多角度验证，可以在保证理论严谨性的同时提高模型在真实BCI与睡眠分析场景中的适用性与可持续性。",
  "modeling_solution": "总体建模思路与假设：本解法将P300识别问题建为“时空信号+贝叶斯序列决策+最小轮次自适应停机”的联合框架，并将通道选择、半监督学习作为提升单次判别能力与减少标注代价的模块化子问题；睡眠分期问题则建为“少样本有监督初始化 + 序列先验（HMM/平滑）或半监督EM微调”的概率模型。为便于推导，作如下基本假设：1）每次闪烁事件产生的记录值可分解为目标诱发成分（P300，空间分布与时间波形可被线性空间滤波器提取）与零均值噪声，噪声近似高斯且跨通道具有协方差结构；2）P300形态对同一被试在短期内相对稳定，但潜伏期τ存在少量漂移；3）训练事件标注（训练集）可信；测试过程允许实时计算得分并根据后验概率实施早停；4）通道冗余可通过判别性和信息量度量去除而不破坏必要的空间采样。符号说明：令 x(t) ∈ R^C 表示C个通道在时间t的观测，单次闪烁在时间窗口T内的多通道时序记为 X ∈ R^{C×T}，目标字符集合大小为 N（本题N=36），每次闪烁对应的刺激类型（某行或某列）记为 s∈S；对每一闪烁事件定义二值标签 y∈{0,1}（1为目标行/列触发P300）。模型核心分为三部分：时空测度与空间滤波、事件级判别与后验更新、通道选择与半监督学习。\n\n时空测度与基础信号模型：对单次闪烁事件假设观测满足 X = a · p(t−τ)·u + N, 其中 a∈R为事件特有振幅（目标事件的a分布显著高于非目标），p(·)为标准化的P300时域模板（可从训练集中估计），u∈R^C为线性空间分布向量（即P300在各通道上的投影权重），N为零均值噪声矩阵。为提取信号，引入线性空间滤波器w∈R^C，得到投影时间序列 z(t)=w^T x(t)，或短时向量 z = vec(w^T X)（可简化为对投影后的时间窗口求若干统计量如峰值、平均、能量或直接使用投影后时序作为特征）。为了提高SNR，采用xDAWN类空间滤波器：求解广义特征问题 maximize w^T S_signal w / w^T S_total w，其中 S_signal 为目标事件诱发平均所形成的协方差矩阵，S_total 为总协方差，等价于求解广义特征值问题 S_signal w = λ S_total w。取前K个特征向量构成滤波矩阵 W∈R^{C×K}，将原始C通道降维到K通道的最显著P300子空间，从而减少后续判别器复杂度。xDAWN可由训练集中以已知目标刺激事件的平均响应估计p(t)并构造“事件相关期望响应矩阵”来实现，其数学实现见上述广义特征问题。\n\n事件级判别与序列后验更新：对每次闪烁事件，用投影后在时间窗内的时域特征或时频特征 f∈R^d（例如W^T X在窗口上按时间采样或其PCA投影、最大值、时延、能量比）作为输入，训练一个判别模型 g(f) 输出打分 s = g(f)。为在小样本情形下保持稳健，首选正则化线性判别（LDA with shrinkage）或正则化逻辑回归。LDA给出判别向量 v = Σ_w^{-1}(μ1−μ0)，相应得分可视为线性映射 s = v^T f. 将判别分数映射到概率空间，使用带温度项的sigmoid校准： P(y=1|f) = σ(α s + β) 。测试阶段对每一字符（由行与列两项组合决定）采用贝叶斯后验更新：初始化先验 P_0(char)=1/N，遇到一次闪烁对应某个行或列 r，其y=1的概率等于事件为目标的概率 P(y=1|f) 若r对应于该字符所在行/列则此概率乘以字符后验，否则使用 1−P(y=1|f)。更形式化地，对于字符 c，在第t次闪烁观测到特征 f_t 对应刺激 r_t，后验更新为 P_t(c) ∝ P_{t−1}(c) · L_t(c)，其中似然 L_t(c)=P(y_t|f_t) if r_t matches c，否则 L_t(c)=1−P(y_t|f_t)。为了避免数值下溢，使用对数后验累加。识别决策在轮次限制下通过两种策略之一：固定轮次终止（最多R轮，R≤5）或自适应早停，当最大后验 P_t(c_max)超过阈值 θ_conf（例如0.95）且与次优字符差距超过δ时，即停止并输出c_max。阈值θ_conf与δ可通过验证集优化以在准确率与ITR之间取得平衡。信息传输速率（ITR）以常用公式计算：ITR(bits/min) = [log2(N) + P log2(P) + (1−P) log2((1−P)/(N−1))] * (60 / T), 其中P为字符识别准确率，T为完成一次字符识别所用时间（包含闪烁时长、间隔与必要的轮次数），该式用于在设计中评估不同R与θ_conf下的系统性能并据此选择最优工作点。\n\n通道选择算法设计：通道选择视为在C=20通道中选择m（10≤m<20）通道使得判别性能最大化且通道数最小化的组合优化问题。推荐采用两阶段混合策略以兼顾效率与分类目标：第一阶段为过滤式预筛，通过计算每通道的单通道判别信息量（互信息或单通道AUC）与xDAWN模式能量贡献来排序，去除明显无信息的下位通道；第二阶段为包装式贪心或递归消除（Recursive Channel Elimination，RCE）结合交叉验证：从候选通道集合开始，按重要性逐次剔除对交叉验证准确率影响最小的通道，直至剩余通道数m；在每一步采用xDAWN+LDA流水线评估，以保证通道选择针对最终模型优化而非单通道度量。为了得到对所有被试通用的“最优跨被试组合”，对每个被试分别执行上述RCE并记录各通道被保留频率，采用排序汇总法（例如Borda计数）得到跨被试重要度分布，再用交叉被试验证（leave-one-subject-out）在候选通道数范围内搜索最稳健的通用子集。数学上，对每个被试i求得通道得分 vector r_i ∈ R^C（得分可为交叉验证AUC）；跨被试得分 r_bar = (1/M) Σ_i normalize(r_i)。选择前m通道以使得平均交叉被试准确率最大化。该流程同时满足题目对通道组合数量的限制（10≤m<20）。通道选择的统计显著性用置换检验评估：随机置换通道标签构建零分布，检验真实子集的提升是否显著。\n\n半监督学习与标注节省策略（问题三）：在得到最优通道组合与xDAWN子空间后，采用混合半监督策略以用少量标签去标注更多试验并提升判别器。核心方法为自训练（self-training）结合图传播（label propagation）与EM混合模型。步骤：以小量有标签样本训练初始判别器 g_0(f)；对无标签样本计算得分并筛选高置信度伪标签（P(y=1|f) > τ_pos 或 < τ_neg），伪标签加入有标签池并迭代重训练；与此同时基于特征距离构建样本图（节点为试验，边权为相似度 exp(−||f_i−f_j||^2/σ^2)），在图上做标签传播以平滑伪标签并修正边缘样本；可以将图传播输出作为软标签在LDA或正则化逻辑回归的EM步骤中作为期望步骤。为避免伪标签误差累积，引入保守策略：仅采纳每一类最高K%的伪标签或采用交叉一致性（两个不同初始化的分类器对同一样本一致时才接纳）。这种半监督流程同时亦可用于在线自适应：在识别过程中当系统对某些行/列的后验长期稳定时将这些样本作为高置信样本加入训练集中，低频率地进行增量更新。数学上，可将伪标签过程视为对完全数据对数似然的最大化： maximize_{θ} Σ_{labeled} log p(y_i|f_i;θ) + λ Σ_{unlabeled} Σ_{y} q_i(y) log p(y|f_i;θ) subject to q_i approximated by current classifier posteriors; 迭代更新θ与q_i直至收敛。该EM目标与图传播的能量最小化（Σ_{i,j} w_{ij} ||q_i − q_j||^2 + μ Σ_{labeled} ||q_i − y_i||^2）可联合求解获得更稳定的伪标签分布。\n\n识别流程与自适应早停：在测试阶段，对每个字符按最大的允许轮次数R(<=5)连续更新后验概率并按早停准则输出结果。同时可以引入决策成本函数 J = −ITR + λ_error · (1−Accuracy) 或直接最大化 IT R，选择 θ_conf 与R使得在验证集上 J 最小（或ITR最大）。为解决P300潜伏期漂移，用带时间移容忍性的判别特征：在计算f时对时间窗内允许多个候选延迟τ∈[τ_min,τ_max]做最大响应或用匹配滤波并记录最大响应延迟作为稳健特征。此外，若时间允许，可将行列的刺激顺序优化为“信息增益最大化”的贪心采样：在下一个闪烁选择上选择能最大减小字符后验熵的行或列，从而主动加快收敛。这要求在线计算每个候选刺激的期望后验熵并选择最大收益刺激，数学上为 argmin_{r} E_{y|f_r} H(P(c|data, f_r))，其中f_r为在刺激r时预计得到的观测分布（可由训练经验估计）。\n\n睡眠分期模型（问题四）：给定附件2的每个样本含Alpha、Beta、Theta、Delta百分比与标签（类别6,5,4,3,2），目标是在少样本情况下得到高准确率。首先清理数据，去掉重复与空列并归一化频带百分比以消除测量尺度。建议采用两条并行策略：一种是基于纵向序列的HMM（隐Markov模型）利用睡眠阶段的时间连续性约束；另一种是基于少样本鲁棒分类器（如正则化多项式逻辑回归或随机森林）结合半监督扩展。具体HMM建模：设隐状态集合 S = {Wake(6),REM(5),N1(4),N2(3),N3(2)}，观测向量 o_t ∈ R^4 服从状态条件的多元高斯 N(μ_s, Σ_s)。训练时若标签稀少，可用带先验的EM算法（Baum-Welch）对转移矩阵 A 和发射参数 {μ_s,Σ_s}进行估计，并在初始阶段用带先验的最大后验估计（引入参数收缩以防过拟合）。若样本级别的时间序列不可用（表格为独立样本），则采用多类别对数回归或轻量神经网络，但为了少样本情形建议选用带L2正则与class-weight的逻辑回归或随机森林，并结合自举（bootstrap）与数据平衡技术。关于训练/测试样本的选取与比例建议：对HMM因需时间连续性，建议使用整晚数据作为单位，采用留一患者法（leave-one-subject-out）以评估泛化；若仅独立样本，建议保留10%~20%作为标注训练（分层采样保证每类都有代表），其余样本作为无标签用于半监督学习。经验上，20%有标签 + 80%无标签在标签稀少情形可通过EM或标签传播将准确率显著提高；若极端少（如5%）需更强的先验或迁移学习（预训练一份模型于相似数据集）。评价指标包括总体准确率、各类召回率与精确率、以及Cohen’s kappa（衡量不均衡类别下的可靠性），并通过混淆矩阵检查易混淆的阶段（常见N1与REM或觉醒的混淆）。\n\n参数估计、求解策略与计算可行性：xDAWN 的特征向量通过求解广义特征值问题获得（可用标准线性代数库如numpy.linalg.eig或scipy.linalg.eigh），LDA/逻辑回归与半监督EM通过迭代优化，图传播可用PageRank风格迭代解法或Closed-form解（带拉普拉斯正则的解析解）；HMM的EM（Baum-Welch）与Viterbi解码属于标准算法。参数选择（如xDAWN分量数K、LDA收缩参数、伪标签阈值τ、早停阈θ_conf）通过嵌套交叉验证与网格搜索确定，并用置换检验估计显著性。计算资源方面，全部操作在单机多核CPU下即可在合理时间内完成（xDAWN与LDA为低成本；图传播与EM在样本数级别几千时也可接受）。若数据量或模型复杂性上升，可并行化（对被试或交叉验证折并行）以缩短训练时间。\n\n敏感性分析与模型稳定性：对主要超参数（通道数m、xDAWN分量数K、伪标签阈τ、早停阈θ_conf、标注比例）分别进行一维扫描并观察准确率与ITR曲线，计算每一参数改变对性能的弹性系数（相对变化率）。额外检查对噪声与通道缺失的鲁棒性：通过随机丢失若干通道或加入额外白噪声测试模型性能退化，验证选择的通道子集在传感器故障时是否稳健。对于睡眠分期，用不同的标注比例重复训练并绘制学习曲线（accuracy vs labeled fraction），以确定合理的标注预算。\n\n验证与实验设计：在P300问题上，采用被试内交叉验证评估通道选择与半监督学习效果（训练集中的12个已知字符做为训练并在测试集上验证），严格遵守不使用问题二给定的测试字符结果的规则以避免信息泄露。比较基线方法包括：不做通道选择的全通道xDAWN+LDA、单通道AUC排序选择、SVM等。统计检验使用配对t检验或Wilcoxon签名秩检验比较不同方法在被试间的性能差异。对于睡眠分期，使用k折分层交叉验证与leave-one-subject-out两种评估方式，并报告混淆矩阵与Cohen’s kappa。\n\n可扩展性与未来改进：若获得更多数据与计算资源，可将判别器扩展为时序深度模型（例如基于时序卷积网络或带注意力的RNN），并将空间滤波嵌入端到端训练以联合优化通道权重与时域特征。对在线系统可加入自适应校准模块（递增式LDA或基于置信度的增量更新）以应对潜伏期漂移。对睡眠分期，可将HMM扩展为半隐马尔可夫模型（HSMM）以建模不同阶段的持续时间分布，提高阶段边界识别精度。为量化不确定性，可采用贝叶斯模型（贝叶斯逻辑回归或贝叶斯神经网络）输出置信区间以支持决策阈值设定。最后，建议在实际部署前进行离线的蒙特卡洛模拟（基于训练集中对潜伏期、噪声强度、通道丢失率的采样）评估系统在多种场景下的稳健性并据此调整早停策略与通道备份方案。\n\n总结：提出的综合模型将xDAWN空间滤波、正则化线性判别与贝叶斯后验序列更新作为核心，在此基础上以通道选择（RCE+Borda跨被试融合）与半监督伪标签+图传播的方式提升单次判别能力并节省标注成本；通过自适应早停与信息增益驱动的刺激选择在最多5轮的约束下平衡准确率与ITR；睡眠分期则采用HMM或正则化多类分类器联合半监督EM以在少标注情形下保持较高性能。该模型理论上具有可解释性、计算效率与在线适应能力，并配套了参数选择、敏感性分析、验证策略与可扩展发展路线，能够在给定数据条件下为P300识别、通道优化、半监督扩展与睡眠分期提供系统化且可实施的解决方案。",
  "task_descriptions": [
    "子任务1（数据预处理与特征构建）旨在把每位被试的原始多通道时序脑电文件（每被试的 train_data/train_event 与 test_data/test_event，采样率250 Hz，20通道）系统地清理、对齐、分段并提取可供后续判别与空间分析使用的事件级特征与汇总统计量；其输出为经滤波与伪迹剔除的连续数据、每次闪烁的时域 epoch（含标签）、每个 epoch 的特征向量、被试级平均ERP模板及用于空间处理的协方差矩阵和通道质量报告。具体步骤与技术要点：1) 数据载入与校验：读取 Excel/CSV 原始通道数据与事件标注，校验采样率与事件时间点一致、删除空列/冗余列并按题目通道映射重命名；对已知缺失（例如个别被试的丢失条目）做记录并在后续处理时限制相应字符序列；2) 滤波与去噪：对连续数据做 50 Hz 工频陷波（如需）和带通 0.5–30 Hz 滤波以保留ERP成分，建议使用零相位 FIR/IIR 滤波器以避免相位失真；3) 参考与重参考：若原始为单端参考，建议转为公共平均参考（common-average）或记录推导的参考以统一空间基准；4) 下采样与分段：为降低维度将数据下采样（例如 250→125 Hz），基于事件标记截取每次闪烁的 epoch（建议窗口为刺激前 −200 ms 到刺激后 +800 ms），并对每个 epoch 做基线校正（以 −200∼0 ms 平均值扣除）；5) 伪迹与坏道处理：采用峰峰值阈值（例如 ±100 μV）、通道间相关性和时域方差检测异常 epoch 与坏通道，记录并剔除或用通道插值（邻近通道加权）恢复坏通道；在必要时用 ICA（若通道数与数据量允许）识别并去除眼电等独立成分，但需保留记录日志并人工/自动判定成分；6) 事件对齐与标签构建：根据事件序列把每个 epoch 标注为目标/非目标（训练集）并校验每轮闪烁次数与标签完整性，输出每个 epoch 的元数据（被试、字符编号、行/列编号、轮次、时间戳）；7) 特征提取（每 epoch）：提取多层次特征包括（a）时域特征：下采样后的时序样本向量、在预定潜伏区间（如 250–600 ms 或 300–500 ms）内的峰值幅度与峰值延迟、若干非重叠窗口的平均电位与能量（例如 0–300、300–500、500–800 ms）、RMS 与 AUC；（b）频域/时频特征：使用 Welch 或短时变换估计各通道在 Delta (0.5–4 Hz)、Theta (4–7 Hz)、Alpha (8–13 Hz)、Beta (14–25 Hz) 的绝对/相对功率与比值；（c）空间统计特征：每 epoch 的通道协方差矩阵（或其上三角向量化）以供后续空间滤波与降维使用；可选（d）对时延漂移容忍的匹配滤波响应或在潜伏窗内的最大响应值与相应延迟作为额外特征；8) 维度约简与标准化：对原始时序/协方差/频域特征采用 z-score 标准化（被试内标准化优先），并视需要用 PCA 保留 95% 方差或固定成分数以减少维度，保存降维映射以便测试数据一致处理；9) ERP 模板与协方差估计：基于训练集中目标与非目标 epoch 计算被试级平均 ERP（用于后续模板匹配或空间滤波初始化），同时计算目标相关协方差 S_signal 与总体协方差 S_total 并持久化；10) 输出与验证：将清洗后的连续数据、epoch（含标签）、特征矩阵、平均 ERP、协方差矩阵、通道质量报告与处理日志保存为可复现格式（NumPy/CSV/EDF/MNE 原始对象），并生成快速可视化检查项（平均 ERP 波形图、通道热度图、坏 epoch 统计、事件计数一致性）以验证预处理正确性。推荐使用成熟工具库（如 MNE-Python 或 EEGLAB + NumPy/SciPy/Scikit-learn）以实现上述流水线并确保可重复性与参数可配置（滤波带、阈值、下采样率、epoch 窗口、基线区间、PCA 保留能量等应作为可调整超参数）。",
    "子任务2（空间滤波与通道选择）旨在在给定每位被试预处理并分段后的事件级多通道ERP数据（每次闪烁的 epoch、目标/非目标标签、采样率及通道名称映射）基础上，找出对P300判别最有利的通道子集（每个子集通道数 m 满足 10 ≤ m < 20），并输出每个被试的最优通道组合与一个对所有被试均较稳健的跨被试通道组合；为实现这一目标，任务采用明确的两阶段流程：第一阶段为过滤式预筛（filter stage），对每个被试计算每通道的单通道判别度量（例如基于训练集的AUC、互信息、目标/非目标平均振幅差或信噪比）以及基于xDAWN或目标平均ERP构造的通道贡献度（通道在xDAWN投影或信号协方差中所占能量），对通道按这些归一化得分作初步排序并剔除明显低信息通道以形成候选集合；第二阶段为包装式递归消除（wrapper stage），对候选通道集合执行递归通道消除（RCE）：在每一步在当前通道子集上重估 xDAWN 空间滤波器（可选固定分量数K或通过交叉验证选择K）并以收缩LDA或正则化逻辑回归作为基线判别器，通过分层k折交叉验证（例如k=5）评估分类性能指标（主要为字符最终识别相关的事件级AUC和被试内字符识别准确率），将对性能影响最小的通道剔除，迭代直至通道数降至候选范围内的每个 m 值；对于每个被试记录各 m 下的最优子集与对应性能曲线。为得到跨被试通用组合，对每位被试独立执行上述流程以得到通道保留频次或基于交叉验证得分的通道排名，然后采用聚合策略（如Borda计数或归一化得分平均）生成跨被试通道重要度排序，并在留一被试（leave-one-subject-out）或跨被试交叉验证框架下对备选的前 m 个通道子集进行搜索以选择在不同被试间平均性能最优且方差最小的“通用”子集；在选择过程中应始终在每个候选子集上重新估计 xDAWN 与判别器参数以保证评估的一致性。为量化显著性与稳健性，要求对最终候选子集执行置换检验（随机打乱事件标签或通道索引得到零分布）以检验性能提升的统计显著性，并通过模拟通道丢失/噪声增加的鲁棒性测试（随机去除若干通道或加入高斯噪声）评估所选子集在传感器故障下的退化情况。实现细节与工具建议：输入为每位被试的 epoch 矩阵、目标/非目标标签、通道名称（如表1中的 Fz、F3…Oz）；使用现成库（例如 MNE-Python 实现 xDAWN、NumPy/SciPy 做矩阵运算、scikit-learn 做 LDA/逻辑回归与交叉验证、joblib/并行化加速 RCE）并保存中间结果（通道得分向量、xDAWN 投影矩阵、交叉验证返回的性能曲线、选择过程日志）；超参数需明确并记录（单通道度量类型、xDAWN 分量数 K 的候选值、交叉验证折数 k、RCE 的停止准则与目标 m 值范围、置换检验次数），并输出标准化的结果文件：每个被试的按 m 排序的通道排名与最优 m 对应的通道名称列表、跨被试通用通道组合、对应的交叉验证性能与显著性p值、以及对候选组合的稳健性测试报告，确保该子任务的流程可独立重复执行并为后续判别器训练提供明确的通道输入。",
    "子任务3（事件级判别、序列后验决策与半监督自适应学习）旨在以有限有标签样本为起点，在给定的预处理且按事件分段的多通道 epoch 特征与对应刺激序列（每次闪烁对应行/列标识）输入下，构建并部署一个稳健的事件级 P300 判别器、基于事件概率的字符后验累积与早停决策机制，并通过保守且可控的半监督策略扩展训练数据以提高在最多5轮交互约束下的字符识别准确率与信息传输速率（ITR）；本子任务的输入包括：每次闪烁的多通道时序或经空间投影后的特征向量（可已降维）、对应的目标/非目标（若有）标签的少量训练样本、未标注的训练样本集合、以及测试阶段的刺激时序流。方法步骤明确为：1) 初始判别器训练——对有标签样本做标准化与可选PCA后，训练正则化线性模型（首选收缩LDA或带 L2 的逻辑回归），处理类不平衡（类别加权或采样），并用嵌套交叉验证确定正则化强度与降维维度；2) 判别分数校准——将线性得分经 Platt 标定或温度化 sigmo id 映射为概率 P(y=1|f)，并在验证集上标定温度与偏置；3) 事件到字符的后验更新与决策规则——在测试或仿真阶段，对每一次闪烁观测 f_t 计算事件级 P_t = P(y=1|f_t)，对于每个候选字符 c 按其是否被当前刺激 r_t 覆盖，使用对数域累积更新 logPosterior_c ← logPosterior_c + log( P_t ) 若覆盖，或 + log(1−P_t) 若不覆盖；在每次闪烁后评估最大后验字符 p_max 并应用早停准则（当 p_max ≥ θ_conf 且 p_max − p_second ≥ δ 或达到最大允许轮次数 R ≤ 5 时输出决策），θ_conf、δ 和 R 通过在有标签验证集上基于准确率与 ITR 的网格搜索优化；4) 时间漂移鲁棒性——在特征构造或判别阶段对潜伏期做容忍处理（在候选延迟窗口如 250–600 ms 做匹配滤波或在该窗口内取最大相关/能量响应作为特征）以减少潜伏期偏移造成的错误；5) 半监督扩展策略——采用保守的自训练与图传播/EM 混合方案：以初始判别器对无标签样本打分，仅将满足高置信度条件（P≥τ_pos 或 P≤τ_neg，建议 τ_pos≈0.90–0.99、τ_neg≈0.01–0.10）且满足一致性校验（例如两个不同初始化的分类器或一个小型模型集体一致）的小批样本接纳为伪标签，每次迭代接纳数量受限（如不超过未标注池的 5–15% 或不超过每类 K 个样本）并将其加入有标签池重训练；并行用基于 RBF 相似度构建的图传播对软标签进行平滑（sigma 以中位距离启发式设定），或在 EM 框架中把图传播后的后验作为 E 步的软标签以更新模型参数；6) 伪标签误差控制与回滚机制——每次迭代在独立的验证集上检查性能提升，若性能下降超过容忍阈值则回滚上一次更新并降低接纳阈值或终止半监督过程；7) 参数选择与评估指标——在嵌套交叉验证中同时监控事件级 AUC、字符级准确率与 ITR（采用标准 ITR 公式结合每字符平均耗时），以这些指标的加权目标在验证集上选定 θ_conf、δ、τ_pos、伪标签接纳速率与最大迭代次数；8) 实现与工具建议——推荐使用 scikit-learn 实现 LDA/Logistic、Platt 标定与交叉验证，sklearn.semi_supervised 或自实现图传播用于标签平滑，NumPy/SciPy 做数值计算，joblib 并行化训练与迭代；9) 输出与日志——输出包括最终训练好的判别器、校准参数、迭代中加入的伪标签列表及其置信度、测试阶段每次闪烁的事件概率序列、字符后验随时间的轨迹与最终决策以及验证集上的 AUC/准确率/ITR 曲线，所有半监督迭代均保留回滚检查点以保证可复现与可审查。该子任务的目标是以谨慎可控的半监督扩展在不超出 5 轮刺激约束下提升判别与字符识别性能，同时保证伪标签带来的风险可被验证集检测并回滚，从而实现稳健的在线或离线模型增强。",
    "子任务4（睡眠分期模型设计与少样本训练策略）：本子任务的目标是在尽可能少的已标注样本条件下，基于附件2提供的每个样本的 Alpha/Beta/Theta/Delta 百分比特征，构建一个能稳定预测五类睡眠分期（清醒6、REM5、N1(4)、N2(3)、N3(2)）的可复现流程并量化其性能与不确定性；任务范围包括数据清洗与预处理、根据数据是否为整夜连续序列选择建模框架、少样本或半监督训练策略、超参数调优与验证方案、以及统一的性能评估与不确定性估计方法。具体步骤与方法如下：1) 数据清洗与预处理：读取表格，去除空列与冗余列，检查并记录缺失值（用分层中位数、KNN插补或多重插补填补），做必要的异常值处理；对四个频带百分比做归一化（如 z-score 或 min–max）并检查其和约束（若总和不为100%则按比例重归一化），并做基础可视化与类分布统计以评估类别不平衡。2) 模型选择依据数据结构：若数据按整夜序列提供且时间序列信息保留，优先采用隐马尔可夫模型（HMM）或半隐马尔可夫模型（HSMM）——将隐状态定义为五个睡眠阶段、观测分布设为状态条件下的多元高斯（或混合高斯），通过带先验的 Baum–Welch（EM）估计发射与转移参数并用 Viterbi 解码进行预测；HSMM 可在样本量允许时用于显式建模状态持续时间分布以改善边界识别；若数据为独立样本（无时间连续性），则采用少样本鲁棒的判别模型如带 L2 正则与 class-weight 的多项逻辑回归或随机森林，并可作为基线。3) 少样本与半监督策略：在有标签样本极少时，优先采用半监督 EM（将未标注样本的后验概率作为软标签参与参数更新）、标签传播/图传播平滑或自训练（只接纳高置信度伪标签并在每次迭代用验证集检测回退），同时使用参数收缩（L2、贝叶斯先验或协方差收缩）以减少过拟合；推荐的有标签比例实验范围为 5%/10%/20%（分层抽样保证各类代表），其余作为无标签用于半监督训练。4) 划分与交叉验证：对整夜序列优先采用留一被试（leave-one-subject-out）交叉验证以评估泛化；对独立样本采用分层 k 折交叉验证（k=5–10）并在内部做嵌套 CV 进行超参数网格搜索（正则化强度、HMM 状态协方差形式、HSMM 持续时间分布参数、树的数目与深度等）。5) 类不平衡与稳健性：通过类别权重、过/欠采样（SMOTE 等）、阈值调整及代价敏感学习缓解不平衡；同时用正则化与先验避免稀少类别过拟合。6) 性能度量与不确定性评估：报告总体准确率、每类精确率/召回率/F1、混淆矩阵与 Cohen’s kappa；对时间序列模型还评估阶段持续时间分布与阶段转换的一致性；通过概率输出校准（Platt 或 isotonic）并用自助法（bootstrap）估计性能置信区间，必要时给出样本级预测概率以供下游决策。7) 敏感性分析与学习曲线：绘制学习曲线（准确率或 kappa 相对于标注比例）评估标注收益，分析关键超参数与填补策略对性能的影响。8) 工具与实现建议：推荐使用 pandas/numpy 做数据处理，scikit-learn 实现逻辑回归、随机森林和交叉验证，hmmlearn 或 pomegranate 实现 HMM/HSMM，imbalanced-learn 做采样，matplotlib/seaborn 做可视化；所有实验需保存随机种子与模型检查点以保证可复现性。最终输出包括已清洗的数据集、所选模型与超参数、训练/测试划分方案、性能报告（含混淆矩阵与置信区间）、学习曲线与模型概率输出与校准信息。"
  ]
}