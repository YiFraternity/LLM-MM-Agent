{
  "tasks": [],
  "problem_str": "问题背景：\n大气污染系指由于人类活动或自然过程引起某些物质进入大气中，呈现足够的浓度，达到了足够的时间，并因此危害了人体的舒适、健康和福利或危害了生态环境\\cite{ref1}。污染防治实践表明，建立空气质量预报模型，提前获知可能发生的气污染过程并采取相应控制措施，是减少大气污染对人体健康和环境等造成的危害，提高环境空气质量的有效方法之一。\n\n目前常用WRF-CMAQ模拟体系（以下简称WRF-CMAQ模型）对空气质量进行预报。WRF-CMAQ模型主要包括WRF和CMAQ两部分：WRF是一种中尺度数值天气预报系统，用于为CMAQ提供所需的气象场数据；CMAQ是一种三维欧拉大气化学与传输模拟系统，其根据来自WRF的气象信息及场域内的污染排放清单，基于物理和化学反应原理模拟污染物等的变化过程，继而得到具体时间点或时间段的预报结果。WRF和CMAQ的结构如图\\ref{fig:1}、图\\ref{fig:2}所示，详细介绍可以在附录提供的官网中进行查询。\n\n但受制于模拟的气象场以及排放清单的不确定性，以及对包括臭氧在内的污染物生成机理的不完全明晰，WRF-CMAQ预报模型的结果并不理想。故题目提出二次建模概念：即指在WRF-CMAQ等一次预报模型模拟结果的基础上，结合更多的数据源进行再建模，以提高预报的准确性。其中，由于实际气象条件对空气质量影响很大（例如湿度降低有利于臭氧的生成），且污染物浓度实测数据的变化情况对空气质量预报具有一定参考价值，故目前会参考空气质量监测点获得的气象与污染物数据进行二次建模，以优化预报模型。二次模型与WRF-CMAQ模型关系如图\\ref{fig:3}所示。为便于理解，下文将WRF-CMAQ模型运行产生的数据简称为“一次预报数据”，将空气质量监测站点实际监测得到的数据简称为“实测数据”。一般来说，一次预报数据与实测数据相关性不高，但预报过程中常会使用实测数据对一次预报数据进行修正以达到更好的效果。\n\n为进行二次建模以预测给定监测点未来三天的空气质量情况，题目提供了监测点长期空气质量预报基础数据，包括污染物浓度一次预报数据、气象一次预报数据、气象实测数据和污染物浓度实测数据，其中，所有一次预报数据的时间跨度为 2020-7-23~2021-7-13，所有实测数据的时间跨度为 2019-4-16~2021-7-13，数据总量在十万量级（详见附件 1~3）。需要注意的是：(1) 每日预报的时间固定为早晨 7 点，此时可以获得当日 7 时及之前时刻的实测数据，以及运行日期在当日及之前日期的一次预报数据（预报时间范围截至第三日 23 时）。监测时间在当日 7 时以后的逐小时实测数据和运行日期在次日及以后的一次预报数据都是无法获得的，例如：在 2021 年 7 月 13 日晨间对 7 月 13 日至 7 月 15 日的空气质量进行预报过程中，可供参考的实测数据时间范围为 (2019-04-16 00:00, 2021-07-13 07:00)，模型运行日期范围为 (2020-07-23, 2021-07-13)。(2) 受监测数据权限及相应监测设备功能等的限制，部分气象指标的实测数据无法获得。(3) 由于一次预报对邻近日期的准确度较高，故理论上二次预报对邻近日期的准确度也较高。\n\n根据《环境空气质量标准》(GB 3095-2012)，用于衡量空气质量的常规大气污染物共有六种，分别为二氧化硫 ($\\mathrm{SO}_2$)、二氧化氮 ($\\mathrm{NO}_2$)、粒径小于 $10\\mu\\mathrm{m}$ 的颗粒物 ($\\mathrm{PM}_{10}$)、粒径小于 $2.5\\mu\\mathrm{m}$ 的颗粒物 ($\\mathrm{PM}_{2.5}$)、臭氧 ($\\mathrm{O}_3$)、一氧化碳 ($\\mathrm{CO}$)。其中，臭氧污染在全国多地区频发，对臭氧污染的预警与防治是环保部门的工作重点。臭氧浓度预报也是六项污染物预报中较难的一项，其原因在于：作为六项污染物中唯一的二次污染物，臭氧并非来自污染源的直接排放，而是在大气中经过一系列化学及光化学反应生成的（可参考附录——种近地面臭氧污染形成机制部分），这导致用 WRF-CMAQ 模型精确预测臭氧浓度变化的难度很高；同时，国内外已有的研究工作尚未得出臭氧生成机理的一般结论 [4]。因此，如何利用现有的实测数据和一次预报数据建立二次模型以提高臭氧预报的准确度是本次建模的重难点之一。\n\n问题要求：\n请你们团队根据问题要求，基于一次预报数据及实测数据（见附件）进行空气质量预报二次数学建模，完成以下四个问题。请注意，实际工作中会遇到数据为空值或异常值的情况（见附录），故要求建立的模型具有一定的鲁棒性。\n\\textbf{问题1.} 使用附件1中的数据，按照附录中的方法计算监测点A从2020年8月25日到8月28日每天实测的AQI和首要污染物，将结果按照附录“AQI计算结果表”的格式放在正文中。\n\n\\textbf{问题2.} 在污染物排放情况不变的条件下，某一地区的气象条件有利于污染物扩散或沉降时，该地区的AQI会下降，反之会上升。使用附件1中的数据，根据对污染物浓度的影响程度，对气象条件进行合理分类，并阐述各类气象条件的特征。\n\n\\textbf{问题3.} 使用附件1、2中的数据，建立一个同时适用于A、B、C三个监测点（监测点两两间直线距离$>100\\text{km}$，忽略相互影响）的二次预报数学模型，用来预测未来三天6种常规污染物单日浓度值，要求二次预报模型预测结果中AQI预报值的最大相对误差应尽量小，且首要污染物预测准确度尽量高。并使用该模型预测监测点A、B、C在2021年7月13日至7月15日6种常规污染物的单日浓度值，计算相应的AQI和首要污染物，将结果依照附录“污染物浓度及AQI预测结果表”的格式放在论文中。\n\n\\textbf{问题4.} 相邻区域的污染物浓度往往具有一定的相关性，区域协同预报可能会提升空气质量预报的准确度。如图4，监测点A的临近区域内存在监测点A1、A2、A3，使用附件1、3中的数据，建立包含A、A1、A2、A3四个监测点的协同预报模型，要求二次模型预测结果中AQI预报值的最大相对误差应尽量小，且首要污染物预测准确度尽量高。使用该模型预测监测点A、A1、A2、A3在2021年7月13日至7月15日6种常规污染物的单日浓度值，计算相应的AQI和首要污染物，将结果依照附录“污染物浓度及AQI预测结果表”的格式放在论文中。并讨论：与问题3的模型相比，协同预报模型能否提升针对监测点A的污染物浓度预报准确度？说明原因。\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image.png}\n    \\caption{各监测站点相对位置示意图，正东方向为x轴，正北方向为y轴，单位：km}\n    \\label{fig:monitoring_sites}\n\\end{figure}\n\nA(0,0) \\quad A1(-14.4846, -1.9699) \\quad A2(-6.6716, 7.5953) \\quad A3(-3.3543, -5.0138)\nAddendum: \n\\section*{附录}\n\n\\section*{污染天气:}\n\n空气质量污染天气指当日空气质量评级达到“轻度污染”或更高等级的天气。在本题中，空气质量等级是以空气质量指数（Air Quality Index, AQI）为指标进行划分，当某日 AQI 超过 100 时，视当日天气为污染天气。\n\n\\section*{一次污染物与二次污染物:}\n\n一次污染物是指直接从污染源排到大气中的原始污染物质，如硫氧化物 ($\\mathrm{SO}_{x}$)、氮氧化物 ($\\mathrm{NO}_{x}$) 等。二次污染物则是指由一次污染物与大气中已有组分或几种一次污染物之间经过一系列化学或光化学反应而生成的与一次污染物性质不同的新污染物质，如臭氧、硫酸盐、硝酸盐、有机颗粒物等。\n\n\\section*{一种近地面臭氧污染形成机制:}\n\n图 5 为近地面臭氧污染形成的一种机制。该机制中，自由基循环和 $\\mathrm{NO}_{x}$ 循环相互耦合作用，使 $\\mathrm{NO}$ 不断转化为 $\\mathrm{NO}_{2}$，$\\mathrm{NO}_{2}$ 的光解使 $\\mathrm{O}_{3}$ 逐渐积累，导致污染的产生。总的来说，臭氧污染形成过程受到多种一次污染物因素 [3] 及光照强度等气象因素的影响。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=0.8\\textwidth]{ozone_formation_mechanism.png}\n    \\caption{一种臭氧与氮氧化物之间相互转化的反应过程 [5]}\n    \\label{fig:5}\n\\end{figure}\n\n注：VOCs' 代表区别于作为反应物 VOCs 的另一些挥发性有机物。\\subsection*{臭氧（$O_3$）最大8小时滑动平均}\n\n指一个自然日内8时至24时的所有8小时滑动平均浓度中的最大值，其中8小时滑动平均值指连续8小时平均浓度的算术平均值。其计算公式如下：\n\n\\[\nC_{O_3} = \\max_{t=8,9,\\ldots,24} \\left\\{ \\frac{1}{8} \\sum_{i=t-7}^{t} c_t \\right\\}\n\\]\n\n其中$c_t$为臭氧在某日$t-1$时至$t$时的平均污染物浓度。\n\n\\subsection*{空气质量指数、空气质量等级及首要污染物}\n\n根据《环境空气质量指数（AQI）技术规定（试行）》(HJ633-2012)，空气质量指数（AQI）可用于判别空气质量等级。\n\n首先需得到各项污染物的空气质量分指数（IAQI），其计算公式如下：\n\n\\[\nIAQI_P = \\frac{IAQI_{Hi} - IAQI_{Lo}}{BP_{Hi} - BP_{Lo}} \\cdot (C_P - BP_{Lo}) + IAQI_{Lo} \\quad (1)\n\\]\n\n式中各符号含义如下：\n\n\\begin{tabular}{|c|p{10cm}|}\n\\hline\nIAQI$_P$ & 污染物$P$的空气质量分指数，结果进位取整数。 \\\\\n\\hline\n$C_P$ & 污染物$P$的质量浓度值； \\\\\n\\hline\n$BP_{Hi}, BP_{Lo}$ & 与$C_P$相近的污染物浓度限值的高位值与低位值； \\\\\n\\hline\n$IAQI_{Hi}, IAQI_{Lo}$ & 与$BP_{Hi}, BP_{Lo}$对应的空气质量分指数。 \\\\\n\\hline\n\\end{tabular}\n\n各项污染物的质量浓度限值及对应的空气质量分指数级别见表1。\\begin{table}\n\\centering\n\\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}\n\\hline\n序号 & 指数或污染物项目 & \\multicolumn{7}{c|}{空气质量分指数及对应污染物浓度限值} & 单位 \\\\\n\\hline\n0 & 空气质量分指数(IAQI) & 0 & 50 & 100 & 150 & 200 & 300 & 400 & 500 \\\\\n\\hline\n1 & 一氧化碳(CO)24小时平均 & 0 & 2 & 4 & 14 & 24 & 36 & 48 & 60 \\\\\n\\hline\n2 & 二氧化硫(SO₂)24小时平均 & 0 & 50 & 150 & 475 & 800 & 1600 & 2100 & 2620 \\\\\n\\hline\n3 & 二氧化氮(NO₂)24小时平均 & 0 & 40 & 80 & 180 & 280 & 565 & 750 & 940 \\\\\n\\hline\n4 & 臭氧(O₃)最大8小时滑动平均 & 0 & 100 & 160 & 215 & 265 & 800 & - & - \\\\\n\\hline\n5 & 粒径小于等于10μm颗粒物(PM₁₀)24小时平均 & 0 & 50 & 150 & 250 & 350 & 420 & 500 & 600 \\\\\n\\hline\n6 & 粒径小于等于2.5μm颗粒物(PM₂.₅)24小时平均 & 0 & 35 & 75 & 115 & 150 & 250 & 350 & 500 \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n注：(1) 臭氧(O₃)最大8小时滑动平均浓度值高于800 μg/m³的，不再进行其空气质量分指数计算。 \\\\\n(2) 其余污染物浓度高于IAQI=500对应限值时，不再进行其空气质量分指数计算。\n例如，某天某测点臭氧最大 8 小时平均浓度为 $185 \\mu \\mathrm{g} / \\mathrm{m}^{3}$，则 $\\mathrm{BP}_{\\mathrm{Hi}}=215 \\mu \\mathrm{g} / \\mathrm{m}^{3}, \\mathrm{BP}_{\\mathrm{Lo}}=160 \\mu \\mathrm{g} / \\mathrm{m}^{3}, \\mathrm{IAQI}_{\\mathrm{Hi}}=150, \\mathrm{IAQI}_{\\mathrm{Lo}}=100$。可得\n\\[\n\\mathrm{IAQI}_{\\mathrm{O}_{3}}=\\frac{150-100}{215-160} \\cdot (185-160)+100 \\approx 123\n\\]\n空气质量指数 (AQI) 取各分指数中的最大值，即\n\\[\n\\mathrm{AQI}=\\max \\left\\{\\mathrm{IAQI}_{1}, \\mathrm{IAQI}_{2}, \\mathrm{IAQI}_{3}, \\ldots, \\mathrm{IAQI}_{n}\\right\\}\n\\]\n式中，$\\mathrm{IAQI}_{1}, \\mathrm{IAQI}_{2}, \\mathrm{IAQI}_{3}, \\ldots, \\mathrm{IAQI}_{n}$ 为各污染物项目的分指数。在本题中，对于 AQI 的计算仅涉及表 1 提供的六种污染物，因此计算公式如下：\n\\[\n\\mathrm{AQI}=\\max \\left\\{\\mathrm{IAQI}_{\\mathrm{SO}_{2}}, \\mathrm{IAQI}_{\\mathrm{NO}_{2}}, \\mathrm{IAQI}_{\\mathrm{PM}_{10}}, \\mathrm{IAQI}_{\\mathrm{PM}_{2.5}}, \\mathrm{IAQI}_{\\mathrm{O}_{3}}, \\mathrm{IAQI}_{\\mathrm{CO}}\\right\\}\n\\]\n空气质量等级范围根据 AQI 数值划分，等级对应的 AQI 范围见表 2。\n\n\\begin{table}\n\\centering\n\\caption{空气质量等级及对应空气质量指数 (AQI) 范围}\n\\begin{tabular}{|c|c|c|c|c|c|c|}\n\\hline\n空气质量等级 & 优 & 良 & 轻度污染 & 中度污染 & 重度污染 & 严重污染 \\\\\n\\hline\n空气质量指数 (AQI) 范围 & $[0,50]$ & $[51,100]$ & $[101,150]$ & $[151,200]$ & $[201,300]$ & $[301,+\\infty)$ \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n当 AQI 小于或等于 50（即空气质量评价为“优”）时，称当天无首要污染物；\n\n当 AQI 大于 50 时，IAQI 最大的污染物为首要污染物。若 IAQI 最大的污染物为两项或两项以上时，并列为首要污染物。\n\nIAQI 大于 100 的污染物为超标污染物。\n\n例：假设上述测点当天六项污染物为：\n\\begin{align*}\n\\mathrm{SO}_{2}: & \\quad 12 \\mu \\mathrm{g} / \\mathrm{m}^{3} \\\\\n\\mathrm{NO}_{2}: & \\quad 66 \\mu \\mathrm{g} / \\mathrm{m}^{3} \\\\\n\\mathrm{CO}: & \\quad 0.8 \\mathrm{mg} / \\mathrm{m}^{3} \\\\\n\\mathrm{O}_{3}: & \\quad 210 \\mu \\mathrm{g} / \\mathrm{m}^{3} \\text{（最大 8 小时滑动平均）} \\\\\n\\mathrm{PM}_{10}: & \\quad 83 \\mu \\mathrm{g} / \\mathrm{m}^{3} \\\\\n\\mathrm{PM}_{2.5}: & \\quad 39 \\mu \\mathrm{g} / \\mathrm{m}^{3}\n\\end{align*}\n\n根据表 1，计算得各污染物 IAQI 分别为 12、83、20、146、67、55，其中最大值为 $\\mathrm{IAQI}_{\\mathrm{O}_{3}}=146$，则 AQI 为 146，首要污染物为臭氧，当天气质量等级为“轻度污染”。\n\\section*{预测时间/监测时间：}\n预测时间/监测时间是逐小时一次预报数据/实测数据的时间点标记，对应的气象及污染物浓度数据为该时间点起一小时内的平均值。以一次预报数据为例，预测时间为“2020/11/04 05:00”的数据行中，$SO_2$浓度为$X \\mu g/m^3$，表示$SO_2$在2020年11月4日5:00-6:00的平均浓度预测值为$X \\mu g/m^3$。\n\n\\section*{风向：}\n风向是指风的来向，本题用角度表示。定义自正北方向至监测点的风向为$0^\\circ$风向，以顺时针旋转角（单位：$^\\circ$）为正值记录风向。例如，风自正东方向至监测点时，记录此时段风向为$90^\\circ$。\n\n\\section*{比湿：}\n比湿是空气中的水汽质量在混合空气中的质量占比，即\n\\[\nq = \\frac{m_v}{m_a + m_v}\n\\]\n式中，$q$为比湿，无量纲；$m_v$为空气中的水汽质量，单位：kg；$m_a$为干空气质量，单位：kg。\n\n\\section*{边界层高度：}\n附件中的边界层高度是指大气边界层顶部距地面的高度，单位：m。其中，大气边界层是地表与大气进行热量、水汽与空气污染物交换、混合的第一通道，也是气团活动主要场所。边界层上方的自由大气向下流动时，由于无法穿越冠盖逆温层，形成一股向下的压力，使得边界层被压缩，近地污染物较易富集。\n\n\\section*{长波辐射/短波辐射/地面太阳能：}\n长波辐射、短波辐射和地面太阳能均为与地面吸收太阳光照能量有关的指标。其中，长波辐射指地面向宇宙辐射长波的地表能通量，短波辐射指地面吸收的太阳能短波辐射的地表能通量，地面太阳能指地面吸收的太阳能所有波长辐射的地表能通量，三者单位：W/m$^2$。\\subsection*{感热通量/潜热通量}\n\n在不发生物体和媒介的相态变化条件下，通过热传导和对流（湍流）所输送的能量称为感热；由物质发生相变而吸收或放出的热能则称为潜热。地面吸收的太阳辐射能会以感热形式及潜热形式释放至大气中，附件中以能通量形式表示这部分感热及潜热。单位：W/m$^2$。当气温高于地温时，感热通量/潜热通量为负值。\n\n\\subsection*{WRF模式系统、CMAQ模式系统官方网址}\n\nWRF: \\url{https://www.mmm.ucar.edu/weather-research-and-forecasting-model} （参考版本 V3.9）\n\nCMAQ: \\url{https://www.epa.gov/cmaq} （参考版本 V5.2）\n\n\\subsection*{数据异常情形}\n\n关于一次预报数据：预报工作中，服务器受外接电源长时间停电等情况影响，导致部分运行日期的一次预报数据缺失。\n\n关于实测数据：\n\n1. 因监测站点设备调试、维护等原因，实测数据在连续时间内存在部分或全部缺失的情况；\n2. 受监测站点及其附近某些偶然因素的影响，实测数据在某个小时（某天）的数值偏离数据正常分布；\n3. 本题提供的监测气象指标共计五项（温度、湿度、气压、风向、风速），因不同监测站点使用设备存在差异，部分气象指标在某些监测站点无法获取。\n\n\\subsection*{AQI计算结果表样例（用于问题1）}\n\n\\begin{table}[H]\n\\centering\n\\begin{tabular}{|c|c|c|c|}\n\\hline\n监测日期 & 地点 & AQI计算：AQI & AQI计算：首要污染物 \\\\\n\\hline\n2020/8/25 & 监测点A & & \\\\\n\\hline\n2020/8/26 & 监测点A & & \\\\\n\\hline\n2020/8/27 & 监测点A & & \\\\\n\\hline\n2020/8/28 & 监测点A & & \\\\\n\\hline\n\\end{tabular}\n\\end{table}\\begin{tabular}{|c|c|c|c|c|c|c|c|c|}\n\\hline\n\\multirow{2}{*}{预报日期} & \\multirow{2}{*}{地点} & \\multicolumn{7}{c|}{二次模型日值预测} \\\\\n\\cline{3-9}\n & & SO₂ & NO₂ & PM₁₀ & PM₂.₅ & O₃最大八小时滑动平均 & CO & 首要污染物 \\\\\n & & (μg/m³) & (μg/m³) & (μg/m³) & (μg/m³) & (μg/m³) & (mg/m³) & AQI \\\\\n\\hline\n2021/7/13 & 监测点A & & & & & & & \\\\\n\\hline\n2021/7/14 & 监测点A & & & & & & & \\\\\n\\hline\n2021/7/15 & 监测点A & & & & & & & \\\\\n\\hline\n\\end{tabular}\nDataset Path:\n['附件1_监测点A空气质量预报基础数据.xlsx', '附件2_监测点B、C空气质量预报基础数据.xlsx']\n\nData Description:\n本数据集由两份Excel文件构成：附件1（监测点A空气质量预报基础数据）和附件2（监测点B、C空气质量预报基础数据，主要包含监测点B的数据），均为逐小时记录，时间覆盖2020-07-23至2021-07-13，用于未来三天空气质量预报与模型训练/验证。每条记录包含模型运行日期（YYYY-MM-DD）、具体预测时间（YYYY-MM-DD HH:MM:SS）与地点标识，以及一系列气象一次预报与地面观测要素（如近地2米温度、地表温度、比湿/相对湿度、近地10米风速与风向、降雨量、云量、边界层高度、大气压、感热/潜热通量、长波/短波/地面太阳能辐射等，含相应物理单位）和主要污染物的小时平均浓度（SO2、NO2、PM10、PM2.5、O3以μg/m³计，CO以mg/m³计）。数据为小时分辨率、面向单点（监测站）时空分析与短期预报使用，适合用于时序建模、因子影响分析、预报模型输入/验证及空气质量趋势与污染源关系研究。",
  "problem": {
    "background": "大气污染系指由于人类活动或自然过程引起某些物质进入大气中，呈现足够的浓度，达到了足够的时间，并因此危害了人体的舒适、健康和福利或危害了生态环境\\cite{ref1}。污染防治实践表明，建立空气质量预报模型，提前获知可能发生的气污染过程并采取相应控制措施，是减少大气污染对人体健康和环境等造成的危害，提高环境空气质量的有效方法之一。\n\n目前常用WRF-CMAQ模拟体系（以下简称WRF-CMAQ模型）对空气质量进行预报。WRF-CMAQ模型主要包括WRF和CMAQ两部分：WRF是一种中尺度数值天气预报系统，用于为CMAQ提供所需的气象场数据；CMAQ是一种三维欧拉大气化学与传输模拟系统，其根据来自WRF的气象信息及场域内的污染排放清单，基于物理和化学反应原理模拟污染物等的变化过程，继而得到具体时间点或时间段的预报结果。WRF和CMAQ的结构如图\\ref{fig:1}、图\\ref{fig:2}所示，详细介绍可以在附录提供的官网中进行查询。\n\n但受制于模拟的气象场以及排放清单的不确定性，以及对包括臭氧在内的污染物生成机理的不完全明晰，WRF-CMAQ预报模型的结果并不理想。故题目提出二次建模概念：即指在WRF-CMAQ等一次预报模型模拟结果的基础上，结合更多的数据源进行再建模，以提高预报的准确性。其中，由于实际气象条件对空气质量影响很大（例如湿度降低有利于臭氧的生成），且污染物浓度实测数据的变化情况对空气质量预报具有一定参考价值，故目前会参考空气质量监测点获得的气象与污染物数据进行二次建模，以优化预报模型。二次模型与WRF-CMAQ模型关系如图\\ref{fig:3}所示。为便于理解，下文将WRF-CMAQ模型运行产生的数据简称为“一次预报数据”，将空气质量监测站点实际监测得到的数据简称为“实测数据”。一般来说，一次预报数据与实测数据相关性不高，但预报过程中常会使用实测数据对一次预报数据进行修正以达到更好的效果。\n\n为进行二次建模以预测给定监测点未来三天的空气质量情况，题目提供了监测点长期空气质量预报基础数据，包括污染物浓度一次预报数据、气象一次预报数据、气象实测数据和污染物浓度实测数据，其中，所有一次预报数据的时间跨度为 2020-7-23~2021-7-13，所有实测数据的时间跨度为 2019-4-16~2021-7-13，数据总量在十万量级（详见附件 1~3）。需要注意的是：(1) 每日预报的时间固定为早晨 7 点，此时可以获得当日 7 时及之前时刻的实测数据，以及运行日期在当日及之前日期的一次预报数据（预报时间范围截至第三日 23 时）。监测时间在当日 7 时以后的逐小时实测数据和运行日期在次日及以后的一次预报数据都是无法获得的，例如：在 2021 年 7 月 13 日晨间对 7 月 13 日至 7 月 15 日的空气质量进行预报过程中，可供参考的实测数据时间范围为 (2019-04-16 00:00, 2021-07-13 07:00)，模型运行日期范围为 (2020-07-23, 2021-07-13)。(2) 受监测数据权限及相应监测设备功能等的限制，部分气象指标的实测数据无法获得。(3) 由于一次预报对邻近日期的准确度较高，故理论上二次预报对邻近日期的准确度也较高。\n\n根据《环境空气质量标准》(GB 3095-2012)，用于衡量空气质量的常规大气污染物共有六种，分别为二氧化硫 ($\\mathrm{SO}_2$)、二氧化氮 ($\\mathrm{NO}_2$)、粒径小于 $10\\mu\\mathrm{m}$ 的颗粒物 ($\\mathrm{PM}_{10}$)、粒径小于 $2.5\\mu\\mathrm{m}$ 的颗粒物 ($\\mathrm{PM}_{2.5}$)、臭氧 ($\\mathrm{O}_3$)、一氧化碳 ($\\mathrm{CO}$)。其中，臭氧污染在全国多地区频发，对臭氧污染的预警与防治是环保部门的工作重点。臭氧浓度预报也是六项污染物预报中较难的一项，其原因在于：作为六项污染物中唯一的二次污染物，臭氧并非来自污染源的直接排放，而是在大气中经过一系列化学及光化学反应生成的（可参考附录——种近地面臭氧污染形成机制部分），这导致用 WRF-CMAQ 模型精确预测臭氧浓度变化的难度很高；同时，国内外已有的研究工作尚未得出臭氧生成机理的一般结论 [4]。因此，如何利用现有的实测数据和一次预报数据建立二次模型以提高臭氧预报的准确度是本次建模的重难点之一。",
    "problem_requirement": "请你们团队根据问题要求，基于一次预报数据及实测数据（见附件）进行空气质量预报二次数学建模，完成以下四个问题。请注意，实际工作中会遇到数据为空值或异常值的情况（见附录），故要求建立的模型具有一定的鲁棒性。\n\\textbf{问题1.} 使用附件1中的数据，按照附录中的方法计算监测点A从2020年8月25日到8月28日每天实测的AQI和首要污染物，将结果按照附录“AQI计算结果表”的格式放在正文中。\n\n\\textbf{问题2.} 在污染物排放情况不变的条件下，某一地区的气象条件有利于污染物扩散或沉降时，该地区的AQI会下降，反之会上升。使用附件1中的数据，根据对污染物浓度的影响程度，对气象条件进行合理分类，并阐述各类气象条件的特征。\n\n\\textbf{问题3.} 使用附件1、2中的数据，建立一个同时适用于A、B、C三个监测点（监测点两两间直线距离$>100\\text{km}$，忽略相互影响）的二次预报数学模型，用来预测未来三天6种常规污染物单日浓度值，要求二次预报模型预测结果中AQI预报值的最大相对误差应尽量小，且首要污染物预测准确度尽量高。并使用该模型预测监测点A、B、C在2021年7月13日至7月15日6种常规污染物的单日浓度值，计算相应的AQI和首要污染物，将结果依照附录“污染物浓度及AQI预测结果表”的格式放在论文中。\n\n\\textbf{问题4.} 相邻区域的污染物浓度往往具有一定的相关性，区域协同预报可能会提升空气质量预报的准确度。如图4，监测点A的临近区域内存在监测点A1、A2、A3，使用附件1、3中的数据，建立包含A、A1、A2、A3四个监测点的协同预报模型，要求二次模型预测结果中AQI预报值的最大相对误差应尽量小，且首要污染物预测准确度尽量高。使用该模型预测监测点A、A1、A2、A3在2021年7月13日至7月15日6种常规污染物的单日浓度值，计算相应的AQI和首要污染物，将结果依照附录“污染物浓度及AQI预测结果表”的格式放在论文中。并讨论：与问题3的模型相比，协同预报模型能否提升针对监测点A的污染物浓度预报准确度？说明原因。\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image.png}\n    \\caption{各监测站点相对位置示意图，正东方向为x轴，正北方向为y轴，单位：km}\n    \\label{fig:monitoring_sites}\n\\end{figure}\n\nA(0,0) \\quad A1(-14.4846, -1.9699) \\quad A2(-6.6716, 7.5953) \\quad A3(-3.3543, -5.0138)",
    "dataset_path": [
      "附件1_监测点A空气质量预报基础数据.xlsx",
      "附件2_监测点B、C空气质量预报基础数据.xlsx"
    ],
    "dataset_description": {
      "附件1_监测点A空气质量预报基础数据": "附件1_监测点A空气质量预报基础数据.xlsx包含监测点A的逐小时污染物浓度与气象一次预报数据，用于预测未来三天的空气质量情况。数据包括污染物浓度和气象参数，时间跨度为2020-7-23至2021-7-13。",
      "附件2_监测点B、C空气质量预报基础数据": "附件2_监测点B、C空气质量预报基础数据.xlsx包含监测点B的逐小时污染物浓度与气象一次预报数据，用于预测未来三天的空气质量情况。数据的时间跨度为2020-7-23至2021-7-13。"
    },
    "variable_description": [
      {
        "模型运行日期": "模型运行的日期，格式为YYYY-MM-DD",
        "预测时间": "预测的具体时间点，格式为YYYY-MM-DD HH:MM:SS",
        "地点": "监测点的位置标识，例如监测点A",
        "近地2米温度（℃）": "近地2米处的温度，单位为摄氏度",
        "地表温度（K）": "地表温度，单位为开尔文",
        "比湿（kg/kg）": "空气中的水汽质量与干空气质量之比",
        "湿度（%）": "空气中的相对湿度，单位为百分比",
        "近地10米风速（m/s）": "近地10米处的风速，单位为米/秒",
        "近地10米风向（°）": "近地10米处的风向，单位为度",
        "雨量（mm）": "降雨量，单位为毫米",
        "云量": "云量，单位为百分比",
        "边界层高度（m）": "大气边界层的高度，单位为米",
        "大气压（Kpa）": "大气压力，单位为千帕",
        "感热通量（W/m²）": "感热通量，单位为瓦特/平方米",
        "潜热通量（W/m²）": "潜热通量，单位为瓦特/平方米",
        "长波辐射（W/m²）": "长波辐射，单位为瓦特/平方米",
        "短波辐射（W/m²）": "短波辐射，单位为瓦特/平方米",
        "地面太阳能辐射（W/m²）": "地面接收到的太阳能辐射，单位为瓦特/平方米",
        "SO2小时平均浓度(μg/m³)": "二氧化硫的小时平均浓度，单位为微克/立方米",
        "NO2小时平均浓度(μg/m³)": "二氧化氮的小时平均浓度，单位为微克/立方米",
        "PM10小时平均浓度(μg/m³)": "PM10的小时平均浓度，单位为微克/立方米",
        "PM2.5小时平均浓度(μg/m³)": "PM2.5的小时平均浓度，单位为微克/立方米",
        "O3小时平均浓度(μg/m³)": "臭氧的小时平均浓度，单位为微克/立方米",
        "CO小时平均浓度(mg/m³)": "一氧化碳的小时平均浓度，单位为毫克/立方米"
      },
      {
        "模型运行日期": "模型运行的日期，格式为YYYY-MM-DD。",
        "预测时间": "预测的具体时间点，格式为YYYY-MM-DD HH:MM:SS。",
        "地点": "监测点的位置标识。",
        "近地2米温度（℃）": "近地2米处的温度，单位为摄氏度。",
        "地表温度（K）": "地表温度，单位为开尔文。",
        "比湿（kg/kg）": "空气中的水汽质量与干空气质量之比。",
        "湿度（%）": "空气中的相对湿度，单位为百分比。",
        "近地10米风速（m/s）": "近地10米处的风速，单位为米/秒。",
        "近地10米风向（°）": "近地10米处的风向，单位为度。",
        "雨量（mm）": "降雨量，单位为毫米。",
        "云量": "云量，单位为百分比。",
        "边界层高度（m）": "大气边界层的高度，单位为米。",
        "大气压（Kpa）": "大气压力，单位为千帕。",
        "感热通量（W/m²）": "感热通量，单位为瓦特/平方米。",
        "潜热通量（W/m²）": "潜热通量，单位为瓦特/平方米。",
        "长波辐射（W/m²）": "长波辐射，单位为瓦特/平方米。",
        "短波辐射（W/m²）": "短波辐射，单位为瓦特/平方米。",
        "地面太阳能辐射（W/m²）": "地面接收到的太阳能辐射，单位为瓦特/平方米。",
        "SO2小时平均浓度(μg/m³)": "二氧化硫的小时平均浓度，单位为微克/立方米。",
        "NO2小时平均浓度(μg/m³)": "二氧化氮的小时平均浓度，单位为微克/立方米。",
        "PM10小时平均浓度(μg/m³)": "PM10的小时平均浓度，单位为微克/立方米。",
        "PM2.5小时平均浓度(μg/m³)": "PM2.5的小时平均浓度，单位为微克/立方米。",
        "O3小时平均浓度(μg/m³)": "臭氧的小时平均浓度，单位为微克/立方米。",
        "CO小时平均浓度(mg/m³)": "一氧化碳的小时平均浓度，单位为毫克/立方米。"
      }
    ],
    "addendum": "\\section*{附录}\n\n\\section*{污染天气:}\n\n空气质量污染天气指当日空气质量评级达到“轻度污染”或更高等级的天气。在本题中，空气质量等级是以空气质量指数（Air Quality Index, AQI）为指标进行划分，当某日 AQI 超过 100 时，视当日天气为污染天气。\n\n\\section*{一次污染物与二次污染物:}\n\n一次污染物是指直接从污染源排到大气中的原始污染物质，如硫氧化物 ($\\mathrm{SO}_{x}$)、氮氧化物 ($\\mathrm{NO}_{x}$) 等。二次污染物则是指由一次污染物与大气中已有组分或几种一次污染物之间经过一系列化学或光化学反应而生成的与一次污染物性质不同的新污染物质，如臭氧、硫酸盐、硝酸盐、有机颗粒物等。\n\n\\section*{一种近地面臭氧污染形成机制:}\n\n图 5 为近地面臭氧污染形成的一种机制。该机制中，自由基循环和 $\\mathrm{NO}_{x}$ 循环相互耦合作用，使 $\\mathrm{NO}$ 不断转化为 $\\mathrm{NO}_{2}$，$\\mathrm{NO}_{2}$ 的光解使 $\\mathrm{O}_{3}$ 逐渐积累，导致污染的产生。总的来说，臭氧污染形成过程受到多种一次污染物因素 [3] 及光照强度等气象因素的影响。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=0.8\\textwidth]{ozone_formation_mechanism.png}\n    \\caption{一种臭氧与氮氧化物之间相互转化的反应过程 [5]}\n    \\label{fig:5}\n\\end{figure}\n\n注：VOCs' 代表区别于作为反应物 VOCs 的另一些挥发性有机物。\\subsection*{臭氧（$O_3$）最大8小时滑动平均}\n\n指一个自然日内8时至24时的所有8小时滑动平均浓度中的最大值，其中8小时滑动平均值指连续8小时平均浓度的算术平均值。其计算公式如下：\n\n\\[\nC_{O_3} = \\max_{t=8,9,\\ldots,24} \\left\\{ \\frac{1}{8} \\sum_{i=t-7}^{t} c_t \\right\\}\n\\]\n\n其中$c_t$为臭氧在某日$t-1$时至$t$时的平均污染物浓度。\n\n\\subsection*{空气质量指数、空气质量等级及首要污染物}\n\n根据《环境空气质量指数（AQI）技术规定（试行）》(HJ633-2012)，空气质量指数（AQI）可用于判别空气质量等级。\n\n首先需得到各项污染物的空气质量分指数（IAQI），其计算公式如下：\n\n\\[\nIAQI_P = \\frac{IAQI_{Hi} - IAQI_{Lo}}{BP_{Hi} - BP_{Lo}} \\cdot (C_P - BP_{Lo}) + IAQI_{Lo} \\quad (1)\n\\]\n\n式中各符号含义如下：\n\n\\begin{tabular}{|c|p{10cm}|}\n\\hline\nIAQI$_P$ & 污染物$P$的空气质量分指数，结果进位取整数。 \\\\\n\\hline\n$C_P$ & 污染物$P$的质量浓度值； \\\\\n\\hline\n$BP_{Hi}, BP_{Lo}$ & 与$C_P$相近的污染物浓度限值的高位值与低位值； \\\\\n\\hline\n$IAQI_{Hi}, IAQI_{Lo}$ & 与$BP_{Hi}, BP_{Lo}$对应的空气质量分指数。 \\\\\n\\hline\n\\end{tabular}\n\n各项污染物的质量浓度限值及对应的空气质量分指数级别见表1。\\begin{table}\n\\centering\n\\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}\n\\hline\n序号 & 指数或污染物项目 & \\multicolumn{7}{c|}{空气质量分指数及对应污染物浓度限值} & 单位 \\\\\n\\hline\n0 & 空气质量分指数(IAQI) & 0 & 50 & 100 & 150 & 200 & 300 & 400 & 500 \\\\\n\\hline\n1 & 一氧化碳(CO)24小时平均 & 0 & 2 & 4 & 14 & 24 & 36 & 48 & 60 \\\\\n\\hline\n2 & 二氧化硫(SO₂)24小时平均 & 0 & 50 & 150 & 475 & 800 & 1600 & 2100 & 2620 \\\\\n\\hline\n3 & 二氧化氮(NO₂)24小时平均 & 0 & 40 & 80 & 180 & 280 & 565 & 750 & 940 \\\\\n\\hline\n4 & 臭氧(O₃)最大8小时滑动平均 & 0 & 100 & 160 & 215 & 265 & 800 & - & - \\\\\n\\hline\n5 & 粒径小于等于10μm颗粒物(PM₁₀)24小时平均 & 0 & 50 & 150 & 250 & 350 & 420 & 500 & 600 \\\\\n\\hline\n6 & 粒径小于等于2.5μm颗粒物(PM₂.₅)24小时平均 & 0 & 35 & 75 & 115 & 150 & 250 & 350 & 500 \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n注：(1) 臭氧(O₃)最大8小时滑动平均浓度值高于800 μg/m³的，不再进行其空气质量分指数计算。 \\\\\n(2) 其余污染物浓度高于IAQI=500对应限值时，不再进行其空气质量分指数计算。\n例如，某天某测点臭氧最大 8 小时平均浓度为 $185 \\mu \\mathrm{g} / \\mathrm{m}^{3}$，则 $\\mathrm{BP}_{\\mathrm{Hi}}=215 \\mu \\mathrm{g} / \\mathrm{m}^{3}, \\mathrm{BP}_{\\mathrm{Lo}}=160 \\mu \\mathrm{g} / \\mathrm{m}^{3}, \\mathrm{IAQI}_{\\mathrm{Hi}}=150, \\mathrm{IAQI}_{\\mathrm{Lo}}=100$。可得\n\\[\n\\mathrm{IAQI}_{\\mathrm{O}_{3}}=\\frac{150-100}{215-160} \\cdot (185-160)+100 \\approx 123\n\\]\n空气质量指数 (AQI) 取各分指数中的最大值，即\n\\[\n\\mathrm{AQI}=\\max \\left\\{\\mathrm{IAQI}_{1}, \\mathrm{IAQI}_{2}, \\mathrm{IAQI}_{3}, \\ldots, \\mathrm{IAQI}_{n}\\right\\}\n\\]\n式中，$\\mathrm{IAQI}_{1}, \\mathrm{IAQI}_{2}, \\mathrm{IAQI}_{3}, \\ldots, \\mathrm{IAQI}_{n}$ 为各污染物项目的分指数。在本题中，对于 AQI 的计算仅涉及表 1 提供的六种污染物，因此计算公式如下：\n\\[\n\\mathrm{AQI}=\\max \\left\\{\\mathrm{IAQI}_{\\mathrm{SO}_{2}}, \\mathrm{IAQI}_{\\mathrm{NO}_{2}}, \\mathrm{IAQI}_{\\mathrm{PM}_{10}}, \\mathrm{IAQI}_{\\mathrm{PM}_{2.5}}, \\mathrm{IAQI}_{\\mathrm{O}_{3}}, \\mathrm{IAQI}_{\\mathrm{CO}}\\right\\}\n\\]\n空气质量等级范围根据 AQI 数值划分，等级对应的 AQI 范围见表 2。\n\n\\begin{table}\n\\centering\n\\caption{空气质量等级及对应空气质量指数 (AQI) 范围}\n\\begin{tabular}{|c|c|c|c|c|c|c|}\n\\hline\n空气质量等级 & 优 & 良 & 轻度污染 & 中度污染 & 重度污染 & 严重污染 \\\\\n\\hline\n空气质量指数 (AQI) 范围 & $[0,50]$ & $[51,100]$ & $[101,150]$ & $[151,200]$ & $[201,300]$ & $[301,+\\infty)$ \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n当 AQI 小于或等于 50（即空气质量评价为“优”）时，称当天无首要污染物；\n\n当 AQI 大于 50 时，IAQI 最大的污染物为首要污染物。若 IAQI 最大的污染物为两项或两项以上时，并列为首要污染物。\n\nIAQI 大于 100 的污染物为超标污染物。\n\n例：假设上述测点当天六项污染物为：\n\\begin{align*}\n\\mathrm{SO}_{2}: & \\quad 12 \\mu \\mathrm{g} / \\mathrm{m}^{3} \\\\\n\\mathrm{NO}_{2}: & \\quad 66 \\mu \\mathrm{g} / \\mathrm{m}^{3} \\\\\n\\mathrm{CO}: & \\quad 0.8 \\mathrm{mg} / \\mathrm{m}^{3} \\\\\n\\mathrm{O}_{3}: & \\quad 210 \\mu \\mathrm{g} / \\mathrm{m}^{3} \\text{（最大 8 小时滑动平均）} \\\\\n\\mathrm{PM}_{10}: & \\quad 83 \\mu \\mathrm{g} / \\mathrm{m}^{3} \\\\\n\\mathrm{PM}_{2.5}: & \\quad 39 \\mu \\mathrm{g} / \\mathrm{m}^{3}\n\\end{align*}\n\n根据表 1，计算得各污染物 IAQI 分别为 12、83、20、146、67、55，其中最大值为 $\\mathrm{IAQI}_{\\mathrm{O}_{3}}=146$，则 AQI 为 146，首要污染物为臭氧，当天气质量等级为“轻度污染”。\n\\section*{预测时间/监测时间：}\n预测时间/监测时间是逐小时一次预报数据/实测数据的时间点标记，对应的气象及污染物浓度数据为该时间点起一小时内的平均值。以一次预报数据为例，预测时间为“2020/11/04 05:00”的数据行中，$SO_2$浓度为$X \\mu g/m^3$，表示$SO_2$在2020年11月4日5:00-6:00的平均浓度预测值为$X \\mu g/m^3$。\n\n\\section*{风向：}\n风向是指风的来向，本题用角度表示。定义自正北方向至监测点的风向为$0^\\circ$风向，以顺时针旋转角（单位：$^\\circ$）为正值记录风向。例如，风自正东方向至监测点时，记录此时段风向为$90^\\circ$。\n\n\\section*{比湿：}\n比湿是空气中的水汽质量在混合空气中的质量占比，即\n\\[\nq = \\frac{m_v}{m_a + m_v}\n\\]\n式中，$q$为比湿，无量纲；$m_v$为空气中的水汽质量，单位：kg；$m_a$为干空气质量，单位：kg。\n\n\\section*{边界层高度：}\n附件中的边界层高度是指大气边界层顶部距地面的高度，单位：m。其中，大气边界层是地表与大气进行热量、水汽与空气污染物交换、混合的第一通道，也是气团活动主要场所。边界层上方的自由大气向下流动时，由于无法穿越冠盖逆温层，形成一股向下的压力，使得边界层被压缩，近地污染物较易富集。\n\n\\section*{长波辐射/短波辐射/地面太阳能：}\n长波辐射、短波辐射和地面太阳能均为与地面吸收太阳光照能量有关的指标。其中，长波辐射指地面向宇宙辐射长波的地表能通量，短波辐射指地面吸收的太阳能短波辐射的地表能通量，地面太阳能指地面吸收的太阳能所有波长辐射的地表能通量，三者单位：W/m$^2$。\\subsection*{感热通量/潜热通量}\n\n在不发生物体和媒介的相态变化条件下，通过热传导和对流（湍流）所输送的能量称为感热；由物质发生相变而吸收或放出的热能则称为潜热。地面吸收的太阳辐射能会以感热形式及潜热形式释放至大气中，附件中以能通量形式表示这部分感热及潜热。单位：W/m$^2$。当气温高于地温时，感热通量/潜热通量为负值。\n\n\\subsection*{WRF模式系统、CMAQ模式系统官方网址}\n\nWRF: \\url{https://www.mmm.ucar.edu/weather-research-and-forecasting-model} （参考版本 V3.9）\n\nCMAQ: \\url{https://www.epa.gov/cmaq} （参考版本 V5.2）\n\n\\subsection*{数据异常情形}\n\n关于一次预报数据：预报工作中，服务器受外接电源长时间停电等情况影响，导致部分运行日期的一次预报数据缺失。\n\n关于实测数据：\n\n1. 因监测站点设备调试、维护等原因，实测数据在连续时间内存在部分或全部缺失的情况；\n2. 受监测站点及其附近某些偶然因素的影响，实测数据在某个小时（某天）的数值偏离数据正常分布；\n3. 本题提供的监测气象指标共计五项（温度、湿度、气压、风向、风速），因不同监测站点使用设备存在差异，部分气象指标在某些监测站点无法获取。\n\n\\subsection*{AQI计算结果表样例（用于问题1）}\n\n\\begin{table}[H]\n\\centering\n\\begin{tabular}{|c|c|c|c|}\n\\hline\n监测日期 & 地点 & AQI计算：AQI & AQI计算：首要污染物 \\\\\n\\hline\n2020/8/25 & 监测点A & & \\\\\n\\hline\n2020/8/26 & 监测点A & & \\\\\n\\hline\n2020/8/27 & 监测点A & & \\\\\n\\hline\n2020/8/28 & 监测点A & & \\\\\n\\hline\n\\end{tabular}\n\\end{table}\\begin{tabular}{|c|c|c|c|c|c|c|c|c|}\n\\hline\n\\multirow{2}{*}{预报日期} & \\multirow{2}{*}{地点} & \\multicolumn{7}{c|}{二次模型日值预测} \\\\\n\\cline{3-9}\n & & SO₂ & NO₂ & PM₁₀ & PM₂.₅ & O₃最大八小时滑动平均 & CO & 首要污染物 \\\\\n & & (μg/m³) & (μg/m³) & (μg/m³) & (μg/m³) & (μg/m³) & (mg/m³) & AQI \\\\\n\\hline\n2021/7/13 & 监测点A & & & & & & & \\\\\n\\hline\n2021/7/14 & 监测点A & & & & & & & \\\\\n\\hline\n2021/7/15 & 监测点A & & & & & & & \\\\\n\\hline\n\\end{tabular}",
    "data_summary": "Dataset Path:\n['附件1_监测点A空气质量预报基础数据.xlsx', '附件2_监测点B、C空气质量预报基础数据.xlsx']\n\nData Description:\n本数据集由两份Excel文件构成：附件1（监测点A空气质量预报基础数据）和附件2（监测点B、C空气质量预报基础数据，主要包含监测点B的数据），均为逐小时记录，时间覆盖2020-07-23至2021-07-13，用于未来三天空气质量预报与模型训练/验证。每条记录包含模型运行日期（YYYY-MM-DD）、具体预测时间（YYYY-MM-DD HH:MM:SS）与地点标识，以及一系列气象一次预报与地面观测要素（如近地2米温度、地表温度、比湿/相对湿度、近地10米风速与风向、降雨量、云量、边界层高度、大气压、感热/潜热通量、长波/短波/地面太阳能辐射等，含相应物理单位）和主要污染物的小时平均浓度（SO2、NO2、PM10、PM2.5、O3以μg/m³计，CO以mg/m³计）。数据为小时分辨率、面向单点（监测站）时空分析与短期预报使用，适合用于时序建模、因子影响分析、预报模型输入/验证及空气质量趋势与污染源关系研究。",
    "data_description": {
      "附件1_监测点A空气质量预报基础数据": "附件1_监测点A空气质量预报基础数据.xlsx包含监测点A的逐小时污染物浓度与气象一次预报数据，用于预测未来三天的空气质量情况。数据包括污染物浓度和气象参数，时间跨度为2020-7-23至2021-7-13。",
      "附件2_监测点B、C空气质量预报基础数据": "附件2_监测点B、C空气质量预报基础数据.xlsx包含监测点B的逐小时污染物浓度与气象一次预报数据，用于预测未来三天的空气质量情况。数据的时间跨度为2020-7-23至2021-7-13。"
    },
    "problem_str": "问题背景：\n大气污染系指由于人类活动或自然过程引起某些物质进入大气中，呈现足够的浓度，达到了足够的时间，并因此危害了人体的舒适、健康和福利或危害了生态环境\\cite{ref1}。污染防治实践表明，建立空气质量预报模型，提前获知可能发生的气污染过程并采取相应控制措施，是减少大气污染对人体健康和环境等造成的危害，提高环境空气质量的有效方法之一。\n\n目前常用WRF-CMAQ模拟体系（以下简称WRF-CMAQ模型）对空气质量进行预报。WRF-CMAQ模型主要包括WRF和CMAQ两部分：WRF是一种中尺度数值天气预报系统，用于为CMAQ提供所需的气象场数据；CMAQ是一种三维欧拉大气化学与传输模拟系统，其根据来自WRF的气象信息及场域内的污染排放清单，基于物理和化学反应原理模拟污染物等的变化过程，继而得到具体时间点或时间段的预报结果。WRF和CMAQ的结构如图\\ref{fig:1}、图\\ref{fig:2}所示，详细介绍可以在附录提供的官网中进行查询。\n\n但受制于模拟的气象场以及排放清单的不确定性，以及对包括臭氧在内的污染物生成机理的不完全明晰，WRF-CMAQ预报模型的结果并不理想。故题目提出二次建模概念：即指在WRF-CMAQ等一次预报模型模拟结果的基础上，结合更多的数据源进行再建模，以提高预报的准确性。其中，由于实际气象条件对空气质量影响很大（例如湿度降低有利于臭氧的生成），且污染物浓度实测数据的变化情况对空气质量预报具有一定参考价值，故目前会参考空气质量监测点获得的气象与污染物数据进行二次建模，以优化预报模型。二次模型与WRF-CMAQ模型关系如图\\ref{fig:3}所示。为便于理解，下文将WRF-CMAQ模型运行产生的数据简称为“一次预报数据”，将空气质量监测站点实际监测得到的数据简称为“实测数据”。一般来说，一次预报数据与实测数据相关性不高，但预报过程中常会使用实测数据对一次预报数据进行修正以达到更好的效果。\n\n为进行二次建模以预测给定监测点未来三天的空气质量情况，题目提供了监测点长期空气质量预报基础数据，包括污染物浓度一次预报数据、气象一次预报数据、气象实测数据和污染物浓度实测数据，其中，所有一次预报数据的时间跨度为 2020-7-23~2021-7-13，所有实测数据的时间跨度为 2019-4-16~2021-7-13，数据总量在十万量级（详见附件 1~3）。需要注意的是：(1) 每日预报的时间固定为早晨 7 点，此时可以获得当日 7 时及之前时刻的实测数据，以及运行日期在当日及之前日期的一次预报数据（预报时间范围截至第三日 23 时）。监测时间在当日 7 时以后的逐小时实测数据和运行日期在次日及以后的一次预报数据都是无法获得的，例如：在 2021 年 7 月 13 日晨间对 7 月 13 日至 7 月 15 日的空气质量进行预报过程中，可供参考的实测数据时间范围为 (2019-04-16 00:00, 2021-07-13 07:00)，模型运行日期范围为 (2020-07-23, 2021-07-13)。(2) 受监测数据权限及相应监测设备功能等的限制，部分气象指标的实测数据无法获得。(3) 由于一次预报对邻近日期的准确度较高，故理论上二次预报对邻近日期的准确度也较高。\n\n根据《环境空气质量标准》(GB 3095-2012)，用于衡量空气质量的常规大气污染物共有六种，分别为二氧化硫 ($\\mathrm{SO}_2$)、二氧化氮 ($\\mathrm{NO}_2$)、粒径小于 $10\\mu\\mathrm{m}$ 的颗粒物 ($\\mathrm{PM}_{10}$)、粒径小于 $2.5\\mu\\mathrm{m}$ 的颗粒物 ($\\mathrm{PM}_{2.5}$)、臭氧 ($\\mathrm{O}_3$)、一氧化碳 ($\\mathrm{CO}$)。其中，臭氧污染在全国多地区频发，对臭氧污染的预警与防治是环保部门的工作重点。臭氧浓度预报也是六项污染物预报中较难的一项，其原因在于：作为六项污染物中唯一的二次污染物，臭氧并非来自污染源的直接排放，而是在大气中经过一系列化学及光化学反应生成的（可参考附录——种近地面臭氧污染形成机制部分），这导致用 WRF-CMAQ 模型精确预测臭氧浓度变化的难度很高；同时，国内外已有的研究工作尚未得出臭氧生成机理的一般结论 [4]。因此，如何利用现有的实测数据和一次预报数据建立二次模型以提高臭氧预报的准确度是本次建模的重难点之一。\n\n问题要求：\n请你们团队根据问题要求，基于一次预报数据及实测数据（见附件）进行空气质量预报二次数学建模，完成以下四个问题。请注意，实际工作中会遇到数据为空值或异常值的情况（见附录），故要求建立的模型具有一定的鲁棒性。\n\\textbf{问题1.} 使用附件1中的数据，按照附录中的方法计算监测点A从2020年8月25日到8月28日每天实测的AQI和首要污染物，将结果按照附录“AQI计算结果表”的格式放在正文中。\n\n\\textbf{问题2.} 在污染物排放情况不变的条件下，某一地区的气象条件有利于污染物扩散或沉降时，该地区的AQI会下降，反之会上升。使用附件1中的数据，根据对污染物浓度的影响程度，对气象条件进行合理分类，并阐述各类气象条件的特征。\n\n\\textbf{问题3.} 使用附件1、2中的数据，建立一个同时适用于A、B、C三个监测点（监测点两两间直线距离$>100\\text{km}$，忽略相互影响）的二次预报数学模型，用来预测未来三天6种常规污染物单日浓度值，要求二次预报模型预测结果中AQI预报值的最大相对误差应尽量小，且首要污染物预测准确度尽量高。并使用该模型预测监测点A、B、C在2021年7月13日至7月15日6种常规污染物的单日浓度值，计算相应的AQI和首要污染物，将结果依照附录“污染物浓度及AQI预测结果表”的格式放在论文中。\n\n\\textbf{问题4.} 相邻区域的污染物浓度往往具有一定的相关性，区域协同预报可能会提升空气质量预报的准确度。如图4，监测点A的临近区域内存在监测点A1、A2、A3，使用附件1、3中的数据，建立包含A、A1、A2、A3四个监测点的协同预报模型，要求二次模型预测结果中AQI预报值的最大相对误差应尽量小，且首要污染物预测准确度尽量高。使用该模型预测监测点A、A1、A2、A3在2021年7月13日至7月15日6种常规污染物的单日浓度值，计算相应的AQI和首要污染物，将结果依照附录“污染物浓度及AQI预测结果表”的格式放在论文中。并讨论：与问题3的模型相比，协同预报模型能否提升针对监测点A的污染物浓度预报准确度？说明原因。\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image.png}\n    \\caption{各监测站点相对位置示意图，正东方向为x轴，正北方向为y轴，单位：km}\n    \\label{fig:monitoring_sites}\n\\end{figure}\n\nA(0,0) \\quad A1(-14.4846, -1.9699) \\quad A2(-6.6716, 7.5953) \\quad A3(-3.3543, -5.0138)\nAddendum: \n\\section*{附录}\n\n\\section*{污染天气:}\n\n空气质量污染天气指当日空气质量评级达到“轻度污染”或更高等级的天气。在本题中，空气质量等级是以空气质量指数（Air Quality Index, AQI）为指标进行划分，当某日 AQI 超过 100 时，视当日天气为污染天气。\n\n\\section*{一次污染物与二次污染物:}\n\n一次污染物是指直接从污染源排到大气中的原始污染物质，如硫氧化物 ($\\mathrm{SO}_{x}$)、氮氧化物 ($\\mathrm{NO}_{x}$) 等。二次污染物则是指由一次污染物与大气中已有组分或几种一次污染物之间经过一系列化学或光化学反应而生成的与一次污染物性质不同的新污染物质，如臭氧、硫酸盐、硝酸盐、有机颗粒物等。\n\n\\section*{一种近地面臭氧污染形成机制:}\n\n图 5 为近地面臭氧污染形成的一种机制。该机制中，自由基循环和 $\\mathrm{NO}_{x}$ 循环相互耦合作用，使 $\\mathrm{NO}$ 不断转化为 $\\mathrm{NO}_{2}$，$\\mathrm{NO}_{2}$ 的光解使 $\\mathrm{O}_{3}$ 逐渐积累，导致污染的产生。总的来说，臭氧污染形成过程受到多种一次污染物因素 [3] 及光照强度等气象因素的影响。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=0.8\\textwidth]{ozone_formation_mechanism.png}\n    \\caption{一种臭氧与氮氧化物之间相互转化的反应过程 [5]}\n    \\label{fig:5}\n\\end{figure}\n\n注：VOCs' 代表区别于作为反应物 VOCs 的另一些挥发性有机物。\\subsection*{臭氧（$O_3$）最大8小时滑动平均}\n\n指一个自然日内8时至24时的所有8小时滑动平均浓度中的最大值，其中8小时滑动平均值指连续8小时平均浓度的算术平均值。其计算公式如下：\n\n\\[\nC_{O_3} = \\max_{t=8,9,\\ldots,24} \\left\\{ \\frac{1}{8} \\sum_{i=t-7}^{t} c_t \\right\\}\n\\]\n\n其中$c_t$为臭氧在某日$t-1$时至$t$时的平均污染物浓度。\n\n\\subsection*{空气质量指数、空气质量等级及首要污染物}\n\n根据《环境空气质量指数（AQI）技术规定（试行）》(HJ633-2012)，空气质量指数（AQI）可用于判别空气质量等级。\n\n首先需得到各项污染物的空气质量分指数（IAQI），其计算公式如下：\n\n\\[\nIAQI_P = \\frac{IAQI_{Hi} - IAQI_{Lo}}{BP_{Hi} - BP_{Lo}} \\cdot (C_P - BP_{Lo}) + IAQI_{Lo} \\quad (1)\n\\]\n\n式中各符号含义如下：\n\n\\begin{tabular}{|c|p{10cm}|}\n\\hline\nIAQI$_P$ & 污染物$P$的空气质量分指数，结果进位取整数。 \\\\\n\\hline\n$C_P$ & 污染物$P$的质量浓度值； \\\\\n\\hline\n$BP_{Hi}, BP_{Lo}$ & 与$C_P$相近的污染物浓度限值的高位值与低位值； \\\\\n\\hline\n$IAQI_{Hi}, IAQI_{Lo}$ & 与$BP_{Hi}, BP_{Lo}$对应的空气质量分指数。 \\\\\n\\hline\n\\end{tabular}\n\n各项污染物的质量浓度限值及对应的空气质量分指数级别见表1。\\begin{table}\n\\centering\n\\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}\n\\hline\n序号 & 指数或污染物项目 & \\multicolumn{7}{c|}{空气质量分指数及对应污染物浓度限值} & 单位 \\\\\n\\hline\n0 & 空气质量分指数(IAQI) & 0 & 50 & 100 & 150 & 200 & 300 & 400 & 500 \\\\\n\\hline\n1 & 一氧化碳(CO)24小时平均 & 0 & 2 & 4 & 14 & 24 & 36 & 48 & 60 \\\\\n\\hline\n2 & 二氧化硫(SO₂)24小时平均 & 0 & 50 & 150 & 475 & 800 & 1600 & 2100 & 2620 \\\\\n\\hline\n3 & 二氧化氮(NO₂)24小时平均 & 0 & 40 & 80 & 180 & 280 & 565 & 750 & 940 \\\\\n\\hline\n4 & 臭氧(O₃)最大8小时滑动平均 & 0 & 100 & 160 & 215 & 265 & 800 & - & - \\\\\n\\hline\n5 & 粒径小于等于10μm颗粒物(PM₁₀)24小时平均 & 0 & 50 & 150 & 250 & 350 & 420 & 500 & 600 \\\\\n\\hline\n6 & 粒径小于等于2.5μm颗粒物(PM₂.₅)24小时平均 & 0 & 35 & 75 & 115 & 150 & 250 & 350 & 500 \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n注：(1) 臭氧(O₃)最大8小时滑动平均浓度值高于800 μg/m³的，不再进行其空气质量分指数计算。 \\\\\n(2) 其余污染物浓度高于IAQI=500对应限值时，不再进行其空气质量分指数计算。\n例如，某天某测点臭氧最大 8 小时平均浓度为 $185 \\mu \\mathrm{g} / \\mathrm{m}^{3}$，则 $\\mathrm{BP}_{\\mathrm{Hi}}=215 \\mu \\mathrm{g} / \\mathrm{m}^{3}, \\mathrm{BP}_{\\mathrm{Lo}}=160 \\mu \\mathrm{g} / \\mathrm{m}^{3}, \\mathrm{IAQI}_{\\mathrm{Hi}}=150, \\mathrm{IAQI}_{\\mathrm{Lo}}=100$。可得\n\\[\n\\mathrm{IAQI}_{\\mathrm{O}_{3}}=\\frac{150-100}{215-160} \\cdot (185-160)+100 \\approx 123\n\\]\n空气质量指数 (AQI) 取各分指数中的最大值，即\n\\[\n\\mathrm{AQI}=\\max \\left\\{\\mathrm{IAQI}_{1}, \\mathrm{IAQI}_{2}, \\mathrm{IAQI}_{3}, \\ldots, \\mathrm{IAQI}_{n}\\right\\}\n\\]\n式中，$\\mathrm{IAQI}_{1}, \\mathrm{IAQI}_{2}, \\mathrm{IAQI}_{3}, \\ldots, \\mathrm{IAQI}_{n}$ 为各污染物项目的分指数。在本题中，对于 AQI 的计算仅涉及表 1 提供的六种污染物，因此计算公式如下：\n\\[\n\\mathrm{AQI}=\\max \\left\\{\\mathrm{IAQI}_{\\mathrm{SO}_{2}}, \\mathrm{IAQI}_{\\mathrm{NO}_{2}}, \\mathrm{IAQI}_{\\mathrm{PM}_{10}}, \\mathrm{IAQI}_{\\mathrm{PM}_{2.5}}, \\mathrm{IAQI}_{\\mathrm{O}_{3}}, \\mathrm{IAQI}_{\\mathrm{CO}}\\right\\}\n\\]\n空气质量等级范围根据 AQI 数值划分，等级对应的 AQI 范围见表 2。\n\n\\begin{table}\n\\centering\n\\caption{空气质量等级及对应空气质量指数 (AQI) 范围}\n\\begin{tabular}{|c|c|c|c|c|c|c|}\n\\hline\n空气质量等级 & 优 & 良 & 轻度污染 & 中度污染 & 重度污染 & 严重污染 \\\\\n\\hline\n空气质量指数 (AQI) 范围 & $[0,50]$ & $[51,100]$ & $[101,150]$ & $[151,200]$ & $[201,300]$ & $[301,+\\infty)$ \\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n当 AQI 小于或等于 50（即空气质量评价为“优”）时，称当天无首要污染物；\n\n当 AQI 大于 50 时，IAQI 最大的污染物为首要污染物。若 IAQI 最大的污染物为两项或两项以上时，并列为首要污染物。\n\nIAQI 大于 100 的污染物为超标污染物。\n\n例：假设上述测点当天六项污染物为：\n\\begin{align*}\n\\mathrm{SO}_{2}: & \\quad 12 \\mu \\mathrm{g} / \\mathrm{m}^{3} \\\\\n\\mathrm{NO}_{2}: & \\quad 66 \\mu \\mathrm{g} / \\mathrm{m}^{3} \\\\\n\\mathrm{CO}: & \\quad 0.8 \\mathrm{mg} / \\mathrm{m}^{3} \\\\\n\\mathrm{O}_{3}: & \\quad 210 \\mu \\mathrm{g} / \\mathrm{m}^{3} \\text{（最大 8 小时滑动平均）} \\\\\n\\mathrm{PM}_{10}: & \\quad 83 \\mu \\mathrm{g} / \\mathrm{m}^{3} \\\\\n\\mathrm{PM}_{2.5}: & \\quad 39 \\mu \\mathrm{g} / \\mathrm{m}^{3}\n\\end{align*}\n\n根据表 1，计算得各污染物 IAQI 分别为 12、83、20、146、67、55，其中最大值为 $\\mathrm{IAQI}_{\\mathrm{O}_{3}}=146$，则 AQI 为 146，首要污染物为臭氧，当天气质量等级为“轻度污染”。\n\\section*{预测时间/监测时间：}\n预测时间/监测时间是逐小时一次预报数据/实测数据的时间点标记，对应的气象及污染物浓度数据为该时间点起一小时内的平均值。以一次预报数据为例，预测时间为“2020/11/04 05:00”的数据行中，$SO_2$浓度为$X \\mu g/m^3$，表示$SO_2$在2020年11月4日5:00-6:00的平均浓度预测值为$X \\mu g/m^3$。\n\n\\section*{风向：}\n风向是指风的来向，本题用角度表示。定义自正北方向至监测点的风向为$0^\\circ$风向，以顺时针旋转角（单位：$^\\circ$）为正值记录风向。例如，风自正东方向至监测点时，记录此时段风向为$90^\\circ$。\n\n\\section*{比湿：}\n比湿是空气中的水汽质量在混合空气中的质量占比，即\n\\[\nq = \\frac{m_v}{m_a + m_v}\n\\]\n式中，$q$为比湿，无量纲；$m_v$为空气中的水汽质量，单位：kg；$m_a$为干空气质量，单位：kg。\n\n\\section*{边界层高度：}\n附件中的边界层高度是指大气边界层顶部距地面的高度，单位：m。其中，大气边界层是地表与大气进行热量、水汽与空气污染物交换、混合的第一通道，也是气团活动主要场所。边界层上方的自由大气向下流动时，由于无法穿越冠盖逆温层，形成一股向下的压力，使得边界层被压缩，近地污染物较易富集。\n\n\\section*{长波辐射/短波辐射/地面太阳能：}\n长波辐射、短波辐射和地面太阳能均为与地面吸收太阳光照能量有关的指标。其中，长波辐射指地面向宇宙辐射长波的地表能通量，短波辐射指地面吸收的太阳能短波辐射的地表能通量，地面太阳能指地面吸收的太阳能所有波长辐射的地表能通量，三者单位：W/m$^2$。\\subsection*{感热通量/潜热通量}\n\n在不发生物体和媒介的相态变化条件下，通过热传导和对流（湍流）所输送的能量称为感热；由物质发生相变而吸收或放出的热能则称为潜热。地面吸收的太阳辐射能会以感热形式及潜热形式释放至大气中，附件中以能通量形式表示这部分感热及潜热。单位：W/m$^2$。当气温高于地温时，感热通量/潜热通量为负值。\n\n\\subsection*{WRF模式系统、CMAQ模式系统官方网址}\n\nWRF: \\url{https://www.mmm.ucar.edu/weather-research-and-forecasting-model} （参考版本 V3.9）\n\nCMAQ: \\url{https://www.epa.gov/cmaq} （参考版本 V5.2）\n\n\\subsection*{数据异常情形}\n\n关于一次预报数据：预报工作中，服务器受外接电源长时间停电等情况影响，导致部分运行日期的一次预报数据缺失。\n\n关于实测数据：\n\n1. 因监测站点设备调试、维护等原因，实测数据在连续时间内存在部分或全部缺失的情况；\n2. 受监测站点及其附近某些偶然因素的影响，实测数据在某个小时（某天）的数值偏离数据正常分布；\n3. 本题提供的监测气象指标共计五项（温度、湿度、气压、风向、风速），因不同监测站点使用设备存在差异，部分气象指标在某些监测站点无法获取。\n\n\\subsection*{AQI计算结果表样例（用于问题1）}\n\n\\begin{table}[H]\n\\centering\n\\begin{tabular}{|c|c|c|c|}\n\\hline\n监测日期 & 地点 & AQI计算：AQI & AQI计算：首要污染物 \\\\\n\\hline\n2020/8/25 & 监测点A & & \\\\\n\\hline\n2020/8/26 & 监测点A & & \\\\\n\\hline\n2020/8/27 & 监测点A & & \\\\\n\\hline\n2020/8/28 & 监测点A & & \\\\\n\\hline\n\\end{tabular}\n\\end{table}\\begin{tabular}{|c|c|c|c|c|c|c|c|c|}\n\\hline\n\\multirow{2}{*}{预报日期} & \\multirow{2}{*}{地点} & \\multicolumn{7}{c|}{二次模型日值预测} \\\\\n\\cline{3-9}\n & & SO₂ & NO₂ & PM₁₀ & PM₂.₅ & O₃最大八小时滑动平均 & CO & 首要污染物 \\\\\n & & (μg/m³) & (μg/m³) & (μg/m³) & (μg/m³) & (μg/m³) & (mg/m³) & AQI \\\\\n\\hline\n2021/7/13 & 监测点A & & & & & & & \\\\\n\\hline\n2021/7/14 & 监测点A & & & & & & & \\\\\n\\hline\n2021/7/15 & 监测点A & & & & & & & \\\\\n\\hline\n\\end{tabular}\nDataset Path:\n['附件1_监测点A空气质量预报基础数据.xlsx', '附件2_监测点B、C空气质量预报基础数据.xlsx']\n\nData Description:\n本数据集由两份Excel文件构成：附件1（监测点A空气质量预报基础数据）和附件2（监测点B、C空气质量预报基础数据，主要包含监测点B的数据），均为逐小时记录，时间覆盖2020-07-23至2021-07-13，用于未来三天空气质量预报与模型训练/验证。每条记录包含模型运行日期（YYYY-MM-DD）、具体预测时间（YYYY-MM-DD HH:MM:SS）与地点标识，以及一系列气象一次预报与地面观测要素（如近地2米温度、地表温度、比湿/相对湿度、近地10米风速与风向、降雨量、云量、边界层高度、大气压、感热/潜热通量、长波/短波/地面太阳能辐射等，含相应物理单位）和主要污染物的小时平均浓度（SO2、NO2、PM10、PM2.5、O3以μg/m³计，CO以mg/m³计）。数据为小时分辨率、面向单点（监测站）时空分析与短期预报使用，适合用于时序建模、因子影响分析、预报模型输入/验证及空气质量趋势与污染源关系研究。"
  },
  "problem_background": "大气污染系指由于人类活动或自然过程引起某些物质进入大气中，呈现足够的浓度，达到了足够的时间，并因此危害了人体的舒适、健康和福利或危害了生态环境\\cite{ref1}。污染防治实践表明，建立空气质量预报模型，提前获知可能发生的气污染过程并采取相应控制措施，是减少大气污染对人体健康和环境等造成的危害，提高环境空气质量的有效方法之一。\n\n目前常用WRF-CMAQ模拟体系（以下简称WRF-CMAQ模型）对空气质量进行预报。WRF-CMAQ模型主要包括WRF和CMAQ两部分：WRF是一种中尺度数值天气预报系统，用于为CMAQ提供所需的气象场数据；CMAQ是一种三维欧拉大气化学与传输模拟系统，其根据来自WRF的气象信息及场域内的污染排放清单，基于物理和化学反应原理模拟污染物等的变化过程，继而得到具体时间点或时间段的预报结果。WRF和CMAQ的结构如图\\ref{fig:1}、图\\ref{fig:2}所示，详细介绍可以在附录提供的官网中进行查询。\n\n但受制于模拟的气象场以及排放清单的不确定性，以及对包括臭氧在内的污染物生成机理的不完全明晰，WRF-CMAQ预报模型的结果并不理想。故题目提出二次建模概念：即指在WRF-CMAQ等一次预报模型模拟结果的基础上，结合更多的数据源进行再建模，以提高预报的准确性。其中，由于实际气象条件对空气质量影响很大（例如湿度降低有利于臭氧的生成），且污染物浓度实测数据的变化情况对空气质量预报具有一定参考价值，故目前会参考空气质量监测点获得的气象与污染物数据进行二次建模，以优化预报模型。二次模型与WRF-CMAQ模型关系如图\\ref{fig:3}所示。为便于理解，下文将WRF-CMAQ模型运行产生的数据简称为“一次预报数据”，将空气质量监测站点实际监测得到的数据简称为“实测数据”。一般来说，一次预报数据与实测数据相关性不高，但预报过程中常会使用实测数据对一次预报数据进行修正以达到更好的效果。\n\n为进行二次建模以预测给定监测点未来三天的空气质量情况，题目提供了监测点长期空气质量预报基础数据，包括污染物浓度一次预报数据、气象一次预报数据、气象实测数据和污染物浓度实测数据，其中，所有一次预报数据的时间跨度为 2020-7-23~2021-7-13，所有实测数据的时间跨度为 2019-4-16~2021-7-13，数据总量在十万量级（详见附件 1~3）。需要注意的是：(1) 每日预报的时间固定为早晨 7 点，此时可以获得当日 7 时及之前时刻的实测数据，以及运行日期在当日及之前日期的一次预报数据（预报时间范围截至第三日 23 时）。监测时间在当日 7 时以后的逐小时实测数据和运行日期在次日及以后的一次预报数据都是无法获得的，例如：在 2021 年 7 月 13 日晨间对 7 月 13 日至 7 月 15 日的空气质量进行预报过程中，可供参考的实测数据时间范围为 (2019-04-16 00:00, 2021-07-13 07:00)，模型运行日期范围为 (2020-07-23, 2021-07-13)。(2) 受监测数据权限及相应监测设备功能等的限制，部分气象指标的实测数据无法获得。(3) 由于一次预报对邻近日期的准确度较高，故理论上二次预报对邻近日期的准确度也较高。\n\n根据《环境空气质量标准》(GB 3095-2012)，用于衡量空气质量的常规大气污染物共有六种，分别为二氧化硫 ($\\mathrm{SO}_2$)、二氧化氮 ($\\mathrm{NO}_2$)、粒径小于 $10\\mu\\mathrm{m}$ 的颗粒物 ($\\mathrm{PM}_{10}$)、粒径小于 $2.5\\mu\\mathrm{m}$ 的颗粒物 ($\\mathrm{PM}_{2.5}$)、臭氧 ($\\mathrm{O}_3$)、一氧化碳 ($\\mathrm{CO}$)。其中，臭氧污染在全国多地区频发，对臭氧污染的预警与防治是环保部门的工作重点。臭氧浓度预报也是六项污染物预报中较难的一项，其原因在于：作为六项污染物中唯一的二次污染物，臭氧并非来自污染源的直接排放，而是在大气中经过一系列化学及光化学反应生成的（可参考附录——种近地面臭氧污染形成机制部分），这导致用 WRF-CMAQ 模型精确预测臭氧浓度变化的难度很高；同时，国内外已有的研究工作尚未得出臭氧生成机理的一般结论 [4]。因此，如何利用现有的实测数据和一次预报数据建立二次模型以提高臭氧预报的准确度是本次建模的重难点之一。",
  "problem_requirement": "请你们团队根据问题要求，基于一次预报数据及实测数据（见附件）进行空气质量预报二次数学建模，完成以下四个问题。请注意，实际工作中会遇到数据为空值或异常值的情况（见附录），故要求建立的模型具有一定的鲁棒性。\n\\textbf{问题1.} 使用附件1中的数据，按照附录中的方法计算监测点A从2020年8月25日到8月28日每天实测的AQI和首要污染物，将结果按照附录“AQI计算结果表”的格式放在正文中。\n\n\\textbf{问题2.} 在污染物排放情况不变的条件下，某一地区的气象条件有利于污染物扩散或沉降时，该地区的AQI会下降，反之会上升。使用附件1中的数据，根据对污染物浓度的影响程度，对气象条件进行合理分类，并阐述各类气象条件的特征。\n\n\\textbf{问题3.} 使用附件1、2中的数据，建立一个同时适用于A、B、C三个监测点（监测点两两间直线距离$>100\\text{km}$，忽略相互影响）的二次预报数学模型，用来预测未来三天6种常规污染物单日浓度值，要求二次预报模型预测结果中AQI预报值的最大相对误差应尽量小，且首要污染物预测准确度尽量高。并使用该模型预测监测点A、B、C在2021年7月13日至7月15日6种常规污染物的单日浓度值，计算相应的AQI和首要污染物，将结果依照附录“污染物浓度及AQI预测结果表”的格式放在论文中。\n\n\\textbf{问题4.} 相邻区域的污染物浓度往往具有一定的相关性，区域协同预报可能会提升空气质量预报的准确度。如图4，监测点A的临近区域内存在监测点A1、A2、A3，使用附件1、3中的数据，建立包含A、A1、A2、A3四个监测点的协同预报模型，要求二次模型预测结果中AQI预报值的最大相对误差应尽量小，且首要污染物预测准确度尽量高。使用该模型预测监测点A、A1、A2、A3在2021年7月13日至7月15日6种常规污染物的单日浓度值，计算相应的AQI和首要污染物，将结果依照附录“污染物浓度及AQI预测结果表”的格式放在论文中。并讨论：与问题3的模型相比，协同预报模型能否提升针对监测点A的污染物浓度预报准确度？说明原因。\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image.png}\n    \\caption{各监测站点相对位置示意图，正东方向为x轴，正北方向为y轴，单位：km}\n    \\label{fig:monitoring_sites}\n\\end{figure}\n\nA(0,0) \\quad A1(-14.4846, -1.9699) \\quad A2(-6.6716, 7.5953) \\quad A3(-3.3543, -5.0138)",
  "problem_analysis": "本问题本质上是一个以提高短期（未来三天）空气质量预报精度为目标的多源、多尺度、时空耦合的二次建模任务。宏观上，模型的主要目标是以一次数值模拟（WRF-CMAQ）与地面实测观测为输入，构建一个既能在小时级、日值级上准确估计六项常规污染物浓度，又能在基于这些浓度计算出的AQI及首要污染物判定上有稳定、高置信度表现的二次预报器。这个目标既包括连续数值预测的准确性（例如减小AQI的相对误差、减小单种污染物浓度的误差），也包括离散判别的准确性（首要污染物分类、是否为污染天气的判定），并要求模型具有对缺失值、异常值与一次预报偏差的鲁棒性。上述目标直接塑造了建模思路：一方面应利用物理信息与过程知识（如边界层高度、风场、辐射、温湿度对污染物输送、扩散以及光化学生成的影响），另一方面需要采用统计或机器学习方法对一次预报的系统性偏差进行矫正或学习残差；要在时序建模、因果/共变特征构造和空间协同预测间做权衡，并确保训练/验证严格遵循实时预报中的信息可用性约束（避免未来数据泄露）。\n\n问题描述中显性或隐性的假设与约束对建模路径有重要影响。显性假设包括排放在预报期内保持不变（使得气象变化成为主要扰动来源）、在问题3中监测点间直线距离大于100 km 且可忽略相互影响（允许独立建模或共享参数但不必处理短期传输耦合），以及在运行当日早晨7点可获得以前时间的实测与一次预报数据（限定了训练与在线预测时可用信息集）。隐性假设包括测量误差服从可处理的分布、一次预报虽有偏差但含有有价值的结构信息可被学习、以及不同监测点间的观测可被互为训练样本以提升泛化。上述假设对结果解释与应用的限制很明显：例如假定排放不变在实际存在剧烈突发排放或临时减排（如节假日或政策限产）时会导致预测偏差；忽略站点间相互影响在存在强传输事件（管理声明的100 km阈值并不总能屏蔽大尺度输送）时会低估误差；同样，若实测仪器存在系统性故障或同步失灵，基于这些观测的二次修正可能会引入错误的校正。因此模型设计必须显式考虑这些不确定性与假设失效的情形，并在结果说明中表明适用范围与局限。\n\n各要素之间的关系呈现高度非线性与耦合性：气象变量通过多条机制影响不同污染物。风速和边界层高度直接调节污染物稀释与垂直交换，决定一次污染物（SO2、NO2、PM）在地面附近的积累；降水与高湿会迅速清除可溶性和颗粒物，改变PM的短期时序；太阳辐射与温度在白天通过光化学反应显著影响臭氧生成，且臭氧对氮氧化物的依赖表现为非单调的NOx-或VOC-限制性化学机制，导致在不同化学条件下降低NOx可能增加或降低O3。一次预报（WRF-CMAQ）的气象与化学过程模拟存在偏差，这些偏差在不同气象情形下的影响也不同——例如在强辐射、低风速时对臭氧的模拟误差可能更大。监测数据的时间不完整性、局部测站的可得变量种类差异（不同站点缺失某些气象量）以及仪器异常都增加了数据预处理与特征工程的复杂度。因此建模需在尊重物理机制与容许统计学习灵活性的之间寻找平衡：通过物理启发的特征构造（如日照时数、8小时滑动均值、NO2/O3比、PBL*风速的混合特征、前一日累积辐射等）实现可解释性的同时，用机器学习方法捕捉复杂非线性残差，以实现较小的AQI相对误差和高首要污染物预测准确度。\n\n在尺度与时间演化方面，问题涉及小时到日值的尺度转换（例如O3需要按日计算最大8小时滑动平均，PM按24小时平均），这意味着小时级预测的误差被聚合到日值上时可能出现非线性放大或抵消，特别是在AQI计算的分段线性映射与极值选择（AQI取各项IAQI的最大值）下，某些小时级小幅偏差可能导致日值首要污染物突变，产生分类错误。模型因此需优化目标不应仅限于逐小时RMSE，而应关注日聚合后的量化误差指标（AQI相对误差、首要污染物判别准确率、污染/超标事件的识别率）并针对性调整损失函数或采用后处理策略（例如对O3直接优化其最大8小时滑动均值）。长期效应方面，模型训练期跨越近两年，若存在季节性变化、长期排放趋势或一次预报体系的版本更新（WRF/CMAQ的配置变更）会造成时序不平稳，影响模型的稳定性与迁移性。因此在模型评估与部署中要采用滚动时序验证（rolling-origin）以检测模型对时序非平稳性的鲁棒性，并预留模型更新机制以应对未来环境的系统性改变。\n\n面对上述复杂性与不确定性，问题可以被多种方式重新表述以引导不同策略。例如可把任务表述为“基于一次预报的偏差修正问题”，优先采用残差学习（直接学习实测与一次预报的差异）以利用一次预报提供的物理结构；也可表述为“多变量时空回归/分类问题”，强调多站点协同与传输耦合，进而采用空间统计或图神经网络；还可抽象为“概率预报问题”，把目标从点值预测改为置信区间/分位数预测，以更好服务于决策制定。不同表述将直接影响模型选择：残差学习适合在一次预报基本正确但存在系统偏差时使用，能提高可解释性并减少训练需求；时空模型更适合区域协同预报（如问题4），但对数据完整性、计算开销和参数识别提出更高要求；概率性表述则提高对极端事件（污染天气）的告警能力，但需要更复杂的校准与评估体系。\n\n关于不确定性与风险，需要在模型建设各阶段予以识别与缓释。数据层面的不确定性包括缺失与异常值、观测与预报的不一致性、不同站点变量可用性的差异，缓解方法包括以时间序列插值、基于模型的多重插补、或使用对缺失鲁棒的模型（如基于树的方法）并在必要时加入缺失指示变量。模型层面的不确定性涉及过拟合（尤其在复杂机器学习模型与相对有限的污染峰值样本上易发生）、变量共线性以及对外推能力的弱化，这些可以通过正则化、交叉验证、早停、以及保留独立的回测期来抑制。决策层面风险包括在高AQI阈值附近的分类不稳定性和对政策响应建议的误导，需在结果呈现中带上不确定度量（置信区间、概率阈值）并明确模型的适用范围。\n\n在方法论选择与权衡上，应平衡模型复杂度、可解释性、实时可运行性与数据需求。较为稳妥的工程化方案是采用“混合/分层”策略：第一层保留一次预报输出与关键气象量作为基础特征，第二层采用统计/机器学习模型（例如随机森林、梯度提升树或轻量级的时序模型如XGBoost与LightGBM带时间延迟特征；对于更强的时序依赖可选用LSTM/Temporal Convolution等深度学习模型）去学习实测与一次预报之间的残差，以日值指标为目标构建损失（对O3直接优化最大8小时均值）。对于多站点问题（问题3、4），可初步采用共享模型参数但带入站点标签与地理位置特征以实现跨站点泛化；在协同预报（问题4）中，应显式建模站点间的空间相关性（例如利用空间滞后特征、邻近站点的即时观测/预报作为输入，或采用多输出回归、Gaussian process 多变量核、图神经网络）以捕捉传输与空间相关性。所有方法应采用时间序列交叉验证与滚动窗口测试、并避免在训练中使用未来可见信息（例如预报生成时间与可用实测窗口的约束），以真实反映在线预报情形。\n\n对气象条件的分类（问题2）应基于其对污染物浓度的物理影响来设计分类维度而非简单统计簇化。合理的分类维度包括：扩散/混合条件（由边界层高度、风速、垂直稳定度或近地温度梯度表征），输送条件（风向与风速的长期组合，是否存在明显的同向持续输送），清除条件（降水与高湿导致的湿沉降，或强降水事件），光化学促进条件（高短波辐射、高气温、低相对湿度利于O3生成），和稳定逆温/夜间积累条件（低PBL、低风速、辐射冷却导致的近地逆温有利于早晚的污染物积累）。每一类应有明确量化阈值（例如PBL低于某值且风速低于某值定义为“静稳不利扩散”），并说明其对不同污染物的典型影响（例如强光照高温在低NOx情形下大幅增加O3，但在高NOx情形下NO可淬灭O3，表现出化学系统的非线性）。这种基于物理机制的分类在后续模型构建中既能作为解释工具，也可作为分段建模的依据。\n\n评价指标的选择与聚焦也需要审慎：由于题目对AQI相对误差与首要污染物准确度有明确偏好，模型训练/选择应在这两类度量上进行优化或至少纳入多目标评估。单纯使用MSE或RMSE可能导致对AQI极端值的忽视；因此建议同时监测MAE、MAPE（或针对AQI的相对误差分布）、污染等级分类准确率、首要污染物F1分数、超标事件的召回/精确率、以及概率化模型的Brier分数与可靠性。对O3特殊处理尤为重要，因其日值定义为最大8小时滑动平均，模型需直接或间接针对这一统计量进行训练或后处理（例如先预测逐小时O3，再计算滑动均值并对最大值所在时段进行显式优化，或直接训练模型输出日最大8小时均值）。\n\n最后，强调建模应是一个迭代与开放的过程：初始模型应以可解释性与稳健性为主，快速建立残差矫正基线并进行严格时序回测；随后通过误差分析识别系统性失败情形（如特定风向、特定季节、极端天气事件中的低表现），并针对性引入新特征、分段模型或时空耦合组件。并行地，应建立模型监控与再训练机制，定期用最新观测重新校准模型，记录一次预报系统改变、排放情形变化或观测设备变更带来的分布漂移。对于最终用户（环境管理与预警部门），应输出点估计之外的可信区间与风险指标，明确模型在特定情形下的信赖度，避免对边界不稳的判定过度解释。综上，问题的复杂性既要求对物理过程的理解，也要求现实主义的统计学习策略、严格的时序验证与面向决策的不确定性量化，只有在物理启发与数据驱动的有机结合中，二次预报模型才能在可解释性、准确性与鲁棒性之间取得均衡并产生可操作的预报产品。",
  "modeling_solution": "模型总体思路与目标概述：本方案提出一个以“物理启发的残差学习 + 多任务时空协同机器学习”为核心的二次预报框架。其基本思想是：以一次预报（WRF‑CMAQ）作为基线预测，利用地面实测与更多气象指标构造物理可解释的特征和时序/空间特征，对一次预报与实测之间的残差进行建模并校正，从而得到更精确的小时级预测，再通过日值聚合（包括O3的最大8小时滑动均值和其它污染物的24小时平均）计算日AQI与首要污染物。为满足题目对AQI相对误差最小化与首要污染物判别准确度高的要求，训练目标采用多目标损失（同时关注小时级误差、日聚合误差、O3最大8小时误差以及首要污染物判别损失），并在协同预报（问题4）中显式建模站点间空间相关性。整体模型兼顾物理可解释性、时间序列依赖与空间耦合，具有对缺失/异常数据的鲁棒性和可在线部署的工程性。\n\n基本假设：假设1：在预报期内区域排放强度短时近似不变（题目已给定），因此污染物变化主要由气象变化与化学过程决定；假设2：一次预报虽然存在系统偏差，但保留了污染物时空演化的主要物理结构，适合作为残差建模的基线；假设3：监测点间若直线距离>100 km（问题3）则可弱化直接短时输送耦合（但可通过共享模型参数提高泛化）；相邻点（问题4）之间存在可利用的正相关性，应显式纳入；假设4：在线运行时可获得截至当日07:00的所有观测与一次预报历史数据（不得使用未来观测），模型训练与评估须严格遵守这一数据可用性约束；假设5：变量的观测误差与异常点存在，但可通过事前清洗、鲁棒回归与不确定性量化进行缓释。\n\n变量、参数与符号定义（主要按小时级与日级区分）\n采用统一时间索引 t 表示小时（UTC或本地小时），以 s 表示模型运行日（早晨7点），预测目标日集合 D = {d0 = s, d1 = s+1, d2 = s+2}。令 j ∈ {SO2, NO2, PM10, PM2.5, O3, CO} 表示污染物种类。ŷ^{sim}_{t,j} 表示一次预报（WRF‑CMAQ）在时刻 t 对污染物 j 的预测；y^{obs}_{t,j} 表示实测小时平均；r_{t,j} ≡ y^{obs}_{t,j} − ŷ^{sim}_{t,j} 为残差。X_t 表示时刻 t 可用的特征向量，包含一次预报的气象变量（温度、湿度、风速、风向、边界层高度、短/长波辐射、降水、感/潜热通量、大气压、云量等）、实测气象（若可得）与历史污染物观测（滞后若干小时或日）、时间编码（时序周期性：小时、日、周、季节）以及空间邻站信息（对问题4）。θ 表示待估模型参数。对于日值聚合定义：对于 j ∈ {SO2, NO2, PM10, PM2.5, CO} 的日平均浓度 C_{d,j} = (1/24) ∑_{h=0}^{23} c_{d,h,j}，其中 c_{d,h,j} 为当天第 h 小时的小时值；对于臭氧，按附录定义 C_{d,O3} = max_{t=8..24} (1/8) ∑_{i=t−7}^t c_{d,i,O3}，其中小时索引与当地定义对齐。IAQI 映射采用题目给出的分段线性映射表 B_j(·)（对应 BP_Lo, BP_Hi 与 IAQI_Lo, IAQI_Hi），AQI_d = max_j IAQI_{d,j}。首要污染物由最大 IAQI 项判定（若并列则并列列示）。\n\n模型结构与关键方程\n（1）残差建模的基本框架（逐小时）：对每一污染物 j 建立一个多输入多输出模型 g_j，学习残差的条件期望： r_{t,j} ≈ g_j( Z_t ; θ_j )，其中 Z_t = concat( ŷ^{sim}_{t−L1:t+L2,·}, X_{t−L1:t,·}, M_{t,space} )。这里允许使用未来时刻的一次预报作为输入（因为一次预报在运行时可供得），但不可使用未来实测。L1 表示历史窗口长度（例如24~72小时），L2 表示可用的一次预报的未来时段长度（模型运行时从WRF‑CMAQ可获得至预测终点的模拟值，可作为输入）。得到残差估计 r̂_{t,j}，修正后小时预测为 ŷ^{corr}_{t,j} = ŷ^{sim}_{t,j} + r̂_{t,j}，并进行非负性剪切与物理约束（如CO下限0，或粒径浓度上限按观测上界剪裁）。该小时级输出是日聚合输入。\n\n（2）多任务/多站点共享与空间协同：为同时建模A、B、C三站（问题3）或A及邻近A1,A2,A3（问题4），采用共享基座与站点特异头的多任务模型。令 s_i 表示站点标识向量/嵌入（learnable embedding or one‑hot plus lat/lon），则模型可写为 r̂_{t,:,·} = G( H_t ; Θ )，G 输出向量包含所有站点与污染物的残差，H_t 包含全体站点的一次预报、实测可用子集与邻接信息（对问题4可显式使用邻站实测/预报作为输入）。对空间耦合更强的情形（问题4），构建一个图网络：定义邻接矩阵 A with A_{ij} = exp(−d_{ij}^2 / l^2) 或阈值化邻接（d< R），并用图卷积/图注意力（GNN）层融合邻站特征： H^{(k+1)} = σ( D^{-1} A H^{(k)} W^{(k)} ), GNN 输入为站点的时间-特征序列压缩表示，从而学习传输与共同控制下的协同残差结构。\n\n（3）日值聚合与面向AQI/首要污染物的损失：对于从小时级得到的 ŷ^{corr}_{t,j}，按日聚合得到 Ĉ_{d,j}（对O3计算最大8小时滑动平均并取最大），再计算 IAQÎ_{d,j} = B_j( Ĉ_{d,j} )，AQÎ_d = max_j IAQÎ_{d,j}，首要污染物判定由 argmax_j IAQÎ_{d,j} 得到。训练损失为多目标组合：\nL_total = λ_hour * L_hour + λ_day * L_day + λ_O3 * L_O3max8 + λ_class * L_primary + Reg(Θ).\n其中 L_hour 可取所有小时的Huber损失或MAE（对异常值更鲁棒）；L_day 可取日级污染物的MAE或相对误差（例如对AQI相对误差重要时用AQI的相对误差）；L_O3max8 对O3的最大8小时滑动平均使用MSE或MAE直接惩罚；L_primary 为对首要污染物的分类交叉熵或Focal Loss（以提高对少见首要污染物的判别能力）；Reg 为参数正则化。通过调节 λ 权重可将训练目标偏向题目指标（优先保证AQI相对误差最小和首要污染物判别率高）。在实践中可采用阶段化训练：先以L_hour与L_O3训练使小时序列准确，再微调以最小化AQI相对误差与首要污染物分类损失。\n\n（4）物理/经验特征构造（关键的内生方程式与指标）：\n定义混合扩散能力指标混合度 M_t = PBL_t * (u_t + ε)，其中 PBL_t 为边界层高度（m），u_t 为风速（m/s），ε 小正数避免0除。M_t 越大利于稀释，预期PM与一次污染物浓度下降。定义光化学促发指数 S_t = f1(Shortwave_t, T_t, RH_t) 可简单取 S_t = Shortwave_t * max( T_t − T_ref, 0 ) / (1+RH_t) 表征利于O3生成的条件。定义湍流混合尺度与输送方向性，通过风向与邻站的差值构建输送因子 T_{ij,t} = u_t * cos(θ_t − θ_{ij}) * A_{ij}，用于在图模型中衡量从站点 j 向 i 的可能影响。构造历史滞后特征包括前24/48/72小时的均值、方差、最大值与特定小时（昼夜）值；对O3构造日内逐小时周期编码与累积日辐射（累积短波）等。对一次预报误差时间相关性，可加入过去若干小时的残差滞后 r̂_{t−1:t−p,j} 作为模型输入。\n\n数值求解策略与模型实现路线\n预处理与缺失/异常处理阶段：对原始数据先行进行时序一致化（统一时区与缺失时间戳插补），对缺失值采用分层插补：对连续短期缺失（<=6小时）优先用基于相邻小时的加权线性插值或基于同日模板的周期填补；对长期缺失（>6小时）采用多重插补（Iterative Imputer / MICE）或用基于模型的代入（用训练集学习的回归模型预测缺失特征），并在所有被插补的变量上加入缺失指示位以保留缺失信息。异常值检测采用局部霍姆斯-贝德（Hampel）滤波或基于时间序列分位数的截尾（winsorize），同时保留原始值供诊断。一次预报缺失情况（服务器停电）以最近运行的有效一次预报或气象同类站点的插值代替，并加入缺失标志以提示模型不确定性。\n\n基线模型与候选模型：首先构建并训练轻量且鲁棒的树模型（LightGBM 或 XGBoost）作为主力残差学习器，这类模型对缺失值天然鲁棒、训练快速且易解释（可用SHAP分析）。树模型输入为经过特征工程的向量（历史一次预报与实测特征、PBL*wind、光化学指数、时序周期及站点嵌入）。作为增强，可开发时间序列深度学习模型（Temporal Convolutional Network 或 LSTM/Transformer with temporal convolution）以更好捕捉长时依赖；对于问题4的空间耦合场景，可使用GNN（GraphConv/GraphAttention）与时间卷积的混合模块（spatio‑temporal GNN）实现端到端学得的空间传输机制。最终采用模型集成：权重融合LightGBM、TCN、GNN的输出，融合权重通过验证集表现或基于堆叠学习（meta‑learner）确定。\n\n训练策略与时间序列交叉验证：使用滚动起点的时间序列交叉验证（rolling origin），每次将早期段用于训练、随后段用于验证，以真实模拟在线运行下的分布漂移与模型泛化。超参数采用贝叶斯优化（例如Optuna）搜索，加早停以防过拟合。在训练中严格禁止使用未来观测（仅允许未来的一次预报作为输入）。对多目标损失中的权重 λ 可用网格搜索或多目标优化（Pareto优化）确定；也可在训练后阶段性微调以显著降低AQI平均相对误差及提高首要污染物F1分数。实验指标应包括小时级MAE/RMSE、日级AQI平均相对误差、首要污染物判别准确率/召回/F1、以及污染天气（AQI>100）事件的查全率与误报率。\n\n不确定性量化与输出置信区间：采用两条可互补路线：一是使用分位数回归树／LightGBM的quantile模式直接输出各分位预测（例如5%/50%/95%）以构建置信区间；二是对深度模型使用蒙特卡洛 dropout 或集合法（多模型多训练随机种子）得到预测分布。为AQI与首要污染物输出概率化结果，在分类方面采用softmax输出或基于分位置信息估算IAQI分布并计算各污染物成为首要污染物的概率。为便于决策支持，将稠密置信区间与超标概率提供给应用端。\n\nO3特殊处理与损失设计：由于O3日值是最大8小时滑动平均，逐小时预测的小偏差可能在日聚合后产生大波动。两种策略并行：一是模型直接预测逐小时O3并在训练损失中加入对“日内最大8小时滑动均值”的显式惩罚项（L_O3max8），通过反向传播使模型关注导致日聚合误差的小时段；二是构建第二阶段的后处理优化器：在得到逐小时预测后，用小型优化器（例如基于预测的不确定性重新分配小时权重）校准导致日最大8小时滑动平均偏差的关键时段。实务中第一种在端到端学习中效果更好，但训练复杂性与计算成本更高；可先用树模型作为残差学习基线，再针对O3用深度时间模型微调。\n\n空间协同建模（问题4）与邻站利用：构建图模型时邻接权重可由地理距离、历时互相关系数或风向概率构成，A_{ij} = α exp(−d_{ij}^2 / l^2) + (1−α) corr_{ij}，其中 corr_{ij} 是历史观测相关性，α∈[0,1] 调节地理与经验相关性权重。图卷积层在时间维与空间维交替应用，以捕捉输送导致的时延与放大效应。对于题目给定A与A1/A2/A3的短距离案例，该协同模型应能提升对A站O3及瞬时污染峰的捕获能力，尤其在输送主导型事件与风向一致时显著提高准确率。为避免过拟合，实际训练时可先用空间滞后特征（邻站实测/预测的滞后值）做输入并与无空间模型做对比，再在验证集上证明GNN带来的增益。\n\n模型求解资源与实施估计：数据规模约十万条小时记录，树模型（LightGBM）训练在常规多核CPU（16核）上数分钟到数小时级别完成；深度时序模型（TCN/LSTM/Transformer）训练建议使用一块中端GPU（例如NVIDIA RTX 2080/3070）以显著加速（训练时长几小时到十数小时，依架构与窗口长度而定）。GNN的训练对内存要求与站点数平方相关，但本题小范围协同（4站）计算负担极小。为在线部署，建议将最优模型导出为轻量化版本（例如Tree ensemble +小型TCN做后处理），每天07:00在CPU上完成预测即可；若使用深度模型则部署GPU或采用模型蒸馏得到较快的推理器。精度期望：基线LightGBM残差校正通常能把一次预报的MAE降低20%~50%，AQI平均相对误差目标可压缩到单位数到两位数百分比内（具体要依训练/验证结果而定）；协同模型在邻近站点强相关情形下能带来额外几个百分点的AQI误差降低与首要污染物判别提升。\n\n敏感性分析、稳健性检验与验证策略：实施包括参数敏感性（如PBL阈值、窗口长度L1）、模型超参敏感、特征选择敏感以及对缺失/异常数据处理策略的敏感性测试。通过人为向输入加入噪声（Monte‑Carlo perturbation）以评估模型的输出波动，并检验在一次预报缺失或部分站点观测缺失情形下输出的稳定性。验证采用历史回测与独立的最后一段时间做保留测试（例如2021-06作为检验集），并分别统计AQI相对误差的分位数（25/50/75/95%）、首要污染物的混淆矩阵与污染天气（AQI>100）事件的检出率与误报率。对模型失败案例做事后分析，识别是否与特定气象情形（逆温、强输送、强降水、极端辐射）或排放突变有关，并在模型中增加相应的分段子模型或警戒规则。\n\n逐题实现要点与差别\n问题1（AQI计算）：严格按附录对各污染物进行日聚合（PM与其他一次污染物24小时平均，O3按最大8小时滑动平均），应用分段线性IAQI映射，得出AQI与首要污染物。预处理阶段务必对缺失小时采取补救策略（短缺插值或该日无法计算则标注缺失并说明），并对计算中涉及的单位（CO为mg/m3）与表格一致。问题1是模型的验证子任务与基线实施。\n\n问题2（气象条件分类）：基于物理机理提出分类体系并量化阈值：一类“强扩散有利类”（PBL > P1, wind_speed > U1），二类“中等扩散类”（P1 ≥ PBL > P2 或 U1 ≥ wind > U2），三类“静稳不利类”（PBL < P2 且 wind < U2），四类“湿沉降清除类”（降水量 > R_threshold 或相对湿度>RH_threshold 且持续），五类“强光化学促发类”（Shortwave > S_threshold, T > T_threshold, RH < RH2）。每类说明对PM、一次污染物与O3的典型影响（例如静稳不利类：PM/NO2容易累积；强光化学促发类：O3增长显著）。这些阈值可用训练数据统计（如分位数）并在不同季节调整。分类既可用于解释也可作为模型的分段输入（即为不同类别训练不同校正子模型）。\n\n问题3（多站点二次模型）：采用上述多任务共享模型（station embedding + residual learning），训练数据来自A/B/C三站的历史记录，验证遵循滚动时间分割，在线运行时以当日07:00可得的一次预报与截至07:00的实测为输入，预测d0~d2每日六种污染物日值并计算AQI/首要污染物。模型重点关注AQI相对误差（在损失中赋较高权重）与首要污染物分类。若站点间互距 >100 km 且无强耦合，可用共享模型但不引入空间层，仅用站点嵌入实现泛化。\n\n问题4（协同预报）：对A及A1/A2/A3用GNN或带邻站特征的多任务模型建模，邻接矩阵构造结合位置与历史相关性，模型在时空上共享参数但利用图卷积或邻站滞后输入实现信息流动。对比问题3的模型，通过交叉验证检验是否在监测点A上的AQI相对误差与首要污染物判别上有显著提升；若提升，通常原因为邻站提供了额外实时输送/源信息（尤其在无风静稳转瞬输送事件中），且GNN能在带风向指示的情形下捕捉方向性影响。若未见提升，说明站点间信号弱或观测质量/时间对齐问题影响了协同效应。\n\n扩展、改进与长期演进建议：未来可引入在线学习机制（模型每天用最新观测做小步长更新）以应对排放与一次预报系统变化；引入发射工况/节假日日历、交通流量或工业活动代理变量以提高对排放突变的响应；将化学机理信息（例如NOx/VOC限制判定、化学态分类）并入特征或作为条件变量，以改进O3的化学敏感性建模；增加概率化告警（给出超标概率）并对模型输出做后验校准（reliability diagrams）。为更高精度场景，可考虑与数据同化/状态估计结合，把地面观测通过卡尔曼滤波等方法回投到一次预报场以获得更好背景场（但计算复杂度显著增加）。\n\n最终说明与可操作产出：该方案在工程上可分阶段实现：第一阶段实现数据清洗、特征工程与LightGBM残差模型以快速建立基线并产出问题1的AQI计算结果；第二阶段引入时序深度模型与O3专门损失以减小日聚合误差；第三阶段在问题4构建GNN完成协同预报并对比改进效果。所有模型均应输出点预测、置信区间和超标概率，并保存模型解释性报告（SHAP重要性、关键情形分析）以便决策者理解预测驱动因素。该混合方法兼顾物理解释性、统计学习的非线性拟合能力与工程可部署性，既能满足题目对AQI相对误差与首要污染物判别的性能目标，也为后续扩展（更多站点、更长时间尺度、在线更新与不确定性管理）提供了清晰的技术路线。",
  "task_descriptions": [
    "子任务1（数据预处理、日标签构建与物理特征工程）要求将原始逐小时一次预报与实测数据清洗、校准并转换为可用于训练与验证的标准化小时级数据表和日级标签表，同时生成完整的物理启发特征字典与缺失/异常日志。具体工作范围和步骤如下：统一时序与单位——确认并统一所有时间戳到同一时区/本地小时、补齐缺失时间点的索引、去重并对变量单位做强制统一（例如 CO 以 mg/m³，所有颗粒物与气态污染物以 μg/m³），并在元数据中记录原始单元与转换公式；质控与异常值处理——对每个变量做基于移动窗口的鲁棒异常检测（如 Hampel 滤波或基于滚动中位数与 MAD 的方法，典型窗口 5–24 小时，阈值 3σ/MAD），对极端尖峰先做 winsorize（如 1st/99th 百分位截断）并保留原始值备审；短缺与长期缺失策略——对连续短缺段（≤6 小时）优先用时间线性或昼夜周期插值填补，插值时优先利用同日/相邻日同小时的统计周期性信息；对长期或复杂缺失（>6 小时或跨多变量缺失）采用模型化插补（例如 scikit‑learn 的 IterativeImputer/MICE 或 KNNImputer，回归器可选 LightGBM/RandomForest 以利用多变量相关性），对所有被插补字段同时生成二元缺失指示器以保留缺失信息；小时级派生与物理特征构造——将风速/风向转换为矢量分量 u,v（采用气象约定：u = −speed * sin(dir_rad)，v = −speed * cos(dir_rad)，dir 为来向角、单位为弧度），用边界层高度（PBL）与风速构造混合/稀释指数 M = PBL * (wind_speed + ε)（ε 为小正数以避免零），构造光化学促发指数 S = Shortwave * max(T − T_ref, 0) / (1 + RH) 及日累计短波辐射、感热/潜热比等与 O3 相关的物理量；构造降水/高湿/夜间标志（阈值可用训练期分位数确定，例如降水>0.1 mm/h、RH>90%）、昼夜与日照标志（基于短波辐射或小时编码）；时序统计特征——为每个污染物与关键气象量计算多尺度滞后与滑动统计（过去 24/48/72 小时的均值、方差、最大/最小与一阶差分）、标准化异常（滚动 z‑score），并生成逐小时周期编码（小时与日序的 sin/cos 循环编码）以保留昼夜季节周期性；空间与输送指示器（针对有邻站信息情形）——依据邻站经纬与两站方位角，结合本时刻风矢量计算方向性输送因子（如 wind_speed * cos(θ_wind − θ_bearing)）以表征从邻站到本站的可能输送量；残差/基线相关特征（仅作为数据层特征）——当小时实测与一次预报同时可得时计算并记录 obs − sim 的滞后值和统计量供后续模型特征使用；日级标签构建规则（严格、可追溯）——对于 SO2、NO2、PM10、PM2.5、CO 以当日 24 小时有效小时均值为日值，要求该日至少有 18 个有效小时（≥75%）否则该日标注为缺失；对于 O3，按规定计算自然日内所有 8 小时滑动平均并取最大值作为日值，计算每个 8 小时窗口时要求该窗口具有全部 8 小时有效数据（缺失窗口跳过），若没有任何完整窗口则日 O3 标注为缺失；基于题目表格实现 IAQI 的分段线性映射并产生 IAQI 向量、AQI（各 IAQI 的最大值）及首要污染物（若并列则并列列示）；可复现的数据质量准则与输出——输出（1）已清洗与统一的小时级数据表（含原始字段、插补/修正标志與缺失指示器）、（2）日级标签表（24h 平均或 O3 max‑8h、IAQI、AQI、首要污染物及每项是否因数据不足而标注缺失）、（3）完整特征字典（含构造公式与单位）、（4）数据质量报告与缺失/异常日志（包括每变量缺失率、填补方法与填补段位置），并建议工具链与实现细节：优先采用 pandas + numpy 进行时序对齐与基础操作，scikit‑learn 的 IterativeImputer/KNNImputer 与 SimpleImputer 做多变量插补，statsmodels 或自实现的移动窗口函数做滚动统计，保存输出为按站点分文件的压缩 parquet/CSV 与元数据 JSON，以便下游可直接加载与验证。",
    "子任务2旨在以一次预报（WRF‑CMAQ 小时输出）为基线、通过学习实测与一次预报之间的残差来生成更准确的小时级污染物预测并支持日值聚合与首要污染物判定，其范围包括数据输入规范、特征构造、残差建模器设计与训练、模型选择与超参调优、封装输出与模型可解释性评估；目标是构建一个既能在单站点情形下独立运行也能通过共享参数实现多站点泛化的多任务时序残差学习模块，输出经校正的逐小时六类污染物预测并供后续按日聚合计算日均/臭氧最大8小时滑动平均等日值指标。具体方法与步骤：一是明确数据输入：逐小时一次预报的污染物与气象字段、截止可用时间点的逐小时实测污染物与可得气象观测、时间编码（小时/日/周/季节）、站点标识与经纬位置信息；二是构造特征向量：包括一次预报当前小时与未来可用时段的同变量、历史窗口（例如过去24/48/72小时）的一次预报与实测滞后统计量（均值、方差、最大/最小、差分）、物理启发派生量（如PBL×风速稀释指标、光化学促发指数、日累计短波、风向分量u/v及基于方位角的输送因子）、缺失指示位与站点嵌入；三是定义预测目标：逐小时残差 r_{t,j}=obs_{t,j}−sim_{t,j}（对每污染物 j），模型输出残差估计 r̂_{t,j} 以得到修正值 ŷ^{corr}=sim + r̂；四是模型架构与候选器：优先建立基线树式残差学习器（LightGBM 或 XGBoost，多输出或并行单输出），利用其对缺失值的天然鲁棒性与快速训练特性；并行开发深度时序模型（例如 Temporal Convolutional Network、LSTM 或轻量 Transformer）以更好捕捉长时依赖与日内周期性，架构采用共享基座加站点特异头的多任务设计以在多站点训练时共享信息；对存在显著空间耦合时可在输入中加入邻站滞后观测/预报特征或站点位置嵌入。五是损失与训练策略：采用多目标损失组合以直接服务任务关键指标，典型为小时级鲁棒损失（Huber/MAE）以降低异常值敏感性、对臭氧日值的最大8小时滑动平均添加专用惩罚项（在端到端训练中直接计算并反向传播或在微调阶段最小化该日聚合误差）、以及可选的日级AQI相对误差或首要污染物分类交叉熵/聚焦损失以提升分类准确率；训练时严格使用滚动起点（rolling origin）时序交叉验证以避免未来观测泄露，使用早停、L2正则与学习率调度防过拟合。六是超参数优化与模型选择：采用贝叶斯优化工具（如 Optuna）或网格搜索调参，选择基于验证集上小时 MAE/RMSE、日级 AQI 平均相对误差与首要污染物 F1 的综合指标进行模型排序；七是模型集成与后处理：对表现互补的模型采用加权平均或堆叠元学习器融合（例如以小型回归器学习各模型输出的融合权重），对最终小时预测施加物理约束（非负、按合理上界裁剪）并在必要时用简单后处理校准日聚合偏差；八是缺失与异常处理机制：在训练/推理中保留缺失标志，树模型直接处理缺失，深度模型对缺失字段采用掩码并在输入层或填补后训练，训练集中通过数据增强（随机遮挡）提高模型对实测缺失的鲁棒性；九是评估指标与可解释性：在验证过程中记录小时级 MAE/RMSE、日级 AQI 平均相对误差及其分位数、首要污染物准确率/召回/F1、污染天气事件检出率与误报率，并用 SHAP 或特征重要性分析解释树模型的关键驱动因子以便诊断与运营决策。实现技术栈推荐使用 pandas/numpy 做数据处理，scikit‑learn 做预处理与基线工具，LightGBM/XGBoost 做树模型，PyTorch 或 TensorFlow/Keras 实现深度时序模型，Optuna 做超参搜索，SHAP 做解释性分析；最终交付物为训练好的残差模型（可部署版本）、验证报告与经校正的逐小时输出接口。",
    "子任务3（空间协同建模与多站点协同策略）的目标是构建并训练一个面向临近监测站点协同信息融合的端到端时空模型，利用站点间的地理位置、历史观测与一次预报、以及气象导向输送信息，在小时尺度上校正一次预报并输出经校正的逐小时六种污染物预报及其日值聚合（含 O3 最大8小时滑动平均）、IAQI/AQI 与首要污染物概率，从而在监测点 A（以及 B、C 等）上降低 AQI 的相对误差并提高首要污染物判别准确度。该子任务的范围与必要步骤包括：一、数据输入与时间窗口定义——输入为每个站点的逐小时一次预报（WRF‑CMAQ）污染物与气象字段、截至模型运行时可用的逐小时实测观测、站点经纬坐标与时序索引；采用固定历史窗口长度 L（建议 48–72 小时）作为模型输入，预测未来窗口覆盖至第3日末。二、图构建与边权设计——基于站点间欧氏距离 d_ij 与历史观测相关性 corr_ij 构造静态邻接基矩阵 A^0_{ij} = α exp(−d_{ij}^2/l^2) + (1−α) corr_{ij}（α 与 l 由验证集调优）；引入风向/风速导向的时间可变权重 W_{ij,t} = sigmoid(β * u_{i,t} * cos(θ_{i,t} − bearing_{ij})) 将输送方向性与风速耦合到时变邻接 A_{t} = A^0 ⊙ W_{t}，并对行或列归一化（例如 D^{-1}A）以稳定图卷积。三、特征与缺失处理——节点特征为时间序列矩阵（一次预报字段、可得实测字段的滞后统计、物理派生量如 PBL×风速、短波累积等）并包含缺失掩码；短期缺失由掩码机制和时间插值/模型内填补处理，模型输入同时附加缺失指示位以保留可用性信息。四、模型架构——采用时空分离或交替的时空网络：每个节点先由时间编码器（例如多层 TCN 或带掩码的 GRU/Transformer）将历史序列映射为节点时刻表示，再通过多层图神经网络（如 Graph Attention 或 Graph Convolution）在节点与邻接上进行融合以捕捉输送与协同效应，最后由节点特异的解码器输出未来每小时各污染物的残差预测（即学习 obs − sim），模型支持多站点多输出学习并可共享主干参数、为每站添加可学习嵌入以适配站点差异。五、损失设计与 O3 处理——训练损失为加权组合：小时级鲁棒回归损失（Huber/MAE）用于所有污染物残差，O3 额外加入对日聚合的最大8小时滑动平均误差（采用可微分的 soft‑max pooling 或在两阶段训练中以后处理计算并微调），并加入对日级 AQI 相对误差或首要污染物分类（交叉熵/ focal loss）的辅助项以直接优化题目指标；对缺失日/小时使用掩码在损失中屏蔽。六、训练策略与验证——采用滚动起点时间序列交叉验证（rolling origin）以模拟在线预报情形，批次为多个站点的时间窗样本，优化器用 Adam/AdamW，结合学习率调度、早停与 L2 正则；超参数（图构造参数 α,l,β、窗口长度 L、网络深度与隐藏维度等）采用贝叶斯优化（如 Optuna）在验证集上调优。七、缺失与稳健性机制——在邻站观测不可用时模型通过掩码与图权重自动降级对邻接依赖，训练时通过随机遮挡邻站输入增强鲁棒性；对一次预报完全缺失情形可在输入中使用最近有效一次预报并加缺失标志。八、解释性与输出——模型应导出节点注意力/边权随时间的可视化（用于判定哪些邻站与时刻对目标站贡献最大）、局部特征重要性（可用 integrated gradients 或 GAT attention weights），以及最终输出：经校正的逐小时污染物预测、日聚合浓度、IAQI 向量、AQI 值、首要污染物的概率分布和预测不确定度估计（通过模型集成或 MC dropout 获取）。九、实现工具建议——优先使用 PyTorch + PyTorch Geometric 或 DGL 实现时空 GNN，使用 pandas/numpy 进行数据预处理，Optuna 做超参优化，训练与推理在 GPU 上加速（若资源受限可将模型蒸馏为轻量版）。十、评估指标与交付物——在保留验证集上报告目标站（如 A）与整体站点的指标：日级 AQI 平均相对误差、首要污染物准确率/召回/F1、小时级 MAE/RMSE；交付物包括训练好的模型权重、推理脚本（输入截至当日07:00的历史数据输出未来三日预测）、邻接与注意力可视化文件、以及模型使用与再训练说明。",
    "子任务4（模型验证、不确定性量化、气象情形分类、部署与维护）的目标是建立一套可重复、可监控且以决策为导向的验证与运维流程，确保生产模型在小时和日尺度上稳定、可解释并能量化不确定性；其范围包括（1）严格的时序验证协议与性能基线构建：采用滚动起点（rolling‑origin）训练/验证拆分并保留独立测试集，按小时/日分别计算并记录关键指标（小时级 MAE/RMSE，日级 AQI 平均相对误差及其分位数、首要污染物的准确率/召回/F1、污染事件（AQI>100）命中率与误报率、混淆矩阵），对 O3 特别统计最大8小时滑动均值的误差分布；（2）不确定性量化与校准方法：并行采用分位数回归（LightGBM quantile）、模型集成与蒙特卡洛 dropout（深度模型）以获得预测分布，利用置信区间覆盖率（e.g. 90% CI coverage）、连续排名概率评分（CRPS）或分位数损失评估分布性，进而用等概率校准方法（如分位数回归校准、isotonic/Platt 校准或分层校准）调整概率输出并生成超标概率与首要污染物概率分布；（3）鲁棒性与敏感性测试：通过系统化扰动实验（向输入注入噪声、模拟不同缺失模式及一次预报/邻站观测缺失）、参数敏感性分析（窗口长度、PBL阈值等）以及极端/跨季节子集评估，量化模型在输入不确定性和异常情形下的性能退化并记录降级边界；（4）气象情形分类与条件性能报告：实现可复现的气象情形划分（例如强扩散、中等扩散、静稳/不利扩散、湿沉降清除、强光化学促发），所用判据可基于PBL、风速、降水、短波辐射与相对湿度的训练期分位阈值，按类别分别统计性能指标以判别模型优势/弱点并为后续分段模型或规则提供依据；（5）可解释性与故障诊断工具：集成特征重要性与局部解释（如 SHAP、集成注意力/边权可视化），并制定系统化失败案例分析流程（识别数据缺失、输入漂移、气象异常或一次预报异常），为每类失败提出可执行缓解策略（重训练、数据回投、手动规则覆盖）；（6）上线部署与运维规范：定义推理接口与输出契约（每日07:00批处理或API请求输入截至07:00的历史数据，输出逐小时浓度预测、日聚合值、IAQI/AQI、首要污染物概率与不确定区间），实现输入校验与回退策略（当关键输入缺失时使用最近有效一次预报或历史均值并打上不确定性标签），采用容器化部署与模型注册（如 Docker+MLflow/ModelDB），记录完整运行日志与指标链（数据质量、推理时延、每日关键性能统计），并设置告警规则：当实时性能（如 AQI 相对误差或覆盖率）超出阈值或输入分布发生显著漂移（采用 PSI/KL divergence 等统计检测）时自动触发人工审查或自动重训练流程；（7）再训练与版本管理策略：定义重训练触发条件（性能退化、数据量增长或一次预报系统重大变更），并规定重训练频率与回滚机制、模型验证门槛和部署前的回测步骤；（8）交付物与工具链建议：产出可复现的验证脚本与报告、带校准的概率预测接口、性能监控仪表板与失败案例库，推荐使用 pandas/numpy/scikit‑learn 做数据处理与统计检验，LightGBM 与 PyTorch 实现模型与不确定性方法，Optuna 做超参调优，SHAP 做解释，Prometheus/Grafana 或 ELK 做运行监控，MLflow 做模型注册与版本管理；整体要求所有流程、阈值和判据须文档化并可程序化执行，以支持自动化监控、可追溯的模型更新和对外透明的性能汇报。"
  ]
}