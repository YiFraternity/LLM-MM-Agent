{
  "tasks": [],
  "problem_str": "问题背景：\n有些国家会发射特殊目的的空间飞行器，如弹道式导弹、侦察卫星等。对他国发射具有敌意的空间飞行器实施监控并作出快速反应，对于维护国家安全具有重要的战略意义。发现发射和探测其轨道参数是实现监控和作出反应的第一步，没有观测，后续的判断与反应都无从谈起。卫星居高临下，是当今探测空间飞行器发射与轨道参数的重要平台。\n\n观测卫星按轨道特点，可分为高轨地球同步轨道卫星和中低轨近圆轨道卫星。其中同步轨道距地球表面约3.6万千米，轨道平面与地球赤道平面重合，理论上用3颗间隔120度分布的同步轨道卫星可覆盖地球绝大部分表面。中低轨近圆轨道距地球表面数百到几千千米不等，根据观测要求，其轨道平面与赤道平面交成一定角度，且常由若干颗卫星实现组网探测。装置于卫星上的探测器包括有源和无源两类：有源探测器采用主动方式（如雷达，激光）搜寻目标，同时具备定向和测距两种能力；无源探测器则被动接收目标辐射。采用无源探测器的观测卫星常采用红外光学探测器，只接收目标的红外辐射信息，可定向但不能测距。对于火箭尾部喷焰的高度敏感性是红外技术的长处，但易受气候影响与云层干扰则是其缺点。\n\n探测的目的是为了推断空间飞行器的轨道参数，推断是基于观测数据并通过数学模型与计算方法作出的。当观测卫星飞行一段时间，探测器测得目标相对于运动卫星的观测数据，以观测卫星和空间飞行器的运动模型和观测模型为基础，对空间飞行器的轨道参数（包括轨道位置、速度初值和其他模型参数）进行数学推断，为飞行器类别、飞行意图的判断提供信息基础。\n\n空间飞行器轨道一般可分为三段，依次为：靠火箭推进的主动段、在地球外层空间的惯性飞行段和再入大气层后的攻击段。主动段通常由多级火箭相继推进，前一级火箭完成推进后脱落，由后一级火箭接力。惯性飞行段在空气阻力极小的大气层外，靠末级火箭关机前获得的速度在椭圆轨道上作无动力惯性飞行。攻击段则根据任务需求，受控制后再入大气层，飞向目标。对于卫星而言，在其寿命结束前一直绕地飞行，故无攻击段。\n\n图1是空间飞行器的主动段示意图（未按实际比例）。主动段又可细分为若干子段：垂直上升段，程序拐弯段和重力斜飞段。按最优轨道设计，为节约燃料，箭体应尽快穿过稠密大气层，故火箭一般先垂直发射。设A点为地面发射点，AB为垂直上升段，BC弧段为程序拐弯段，CD弧段为重力斜飞段，DE弧段为椭圆轨道。程序拐弯段连接垂直上升段与重力斜飞段，在外力矩控制下使箭体转过一定角度，该段完成后外加力矩撤销，进入斜飞状态。第一级火箭通常负担“垂直段+程序拐弯段（加外力矩）+重力斜飞段的前段”的推进（视发动机的特性），重力斜飞段的后程则靠第二、第三级火箭相继完成。由于斜飞状态下地球引力与推力不在同一直线，所以箭体质心的运动轨迹为带一定弧度的光滑曲线。\n\n问题要求：\n为描述观测卫星和空间飞行器的运动，需要建立适当的坐标系。本题基础坐标系为随地心平移的坐标系，取地球中心$O_c$为原点，地球自转轴取为$z$轴，指向北极为正向，$x$轴由指向零时刻的0经度线，再按右手系确定$y$轴，建立直角坐标系$O_c-X_cY_cZ_c$。地心$O_c$在绕日椭圆轨道上运动，所以理论上$O_c-X_cY_cZ_c$系是非惯性系。但地球公转周期远大于空间飞行器的观测弧段时长，故本题在短时间内认定该系为惯性坐标系，该基础坐标系不随地球旋转。\n\n第二个坐标系是随卫星运动的观测坐标系$O_c-X_cY_cZ_c$，见图2，原点取为卫星中心$O_s$，$X_s$轴沿$O_cO_s$连线，离开地球方向为正，$Z_s$轴与$X_s$轴垂直，$Y_s$轴按右手系确定。如此定义的观测坐标系也叫做UEN坐标系，因为三个坐标轴分别指向上（UP）、东（EAST）和北（NORTH）三个方向。\n\n根据变质量质点的动力学，空间飞行器在基础坐标系下的主动段的简化运动方程如下：\\[ \\ddot{\\vec{r}}(t) = \\vec{F}_e + \\vec{F}_T = -\\frac{G_m}{|\\vec{r}(t)|^3}\\vec{r}(t) + \\vec{v}_r(t)\\frac{\\dot{m}(t)}{m(t)} \\quad (1) \\]\n\n其中向量$\\vec{F}_e$表示飞行器所受的外力加速度之和，$\\vec{F}_T$表示火箭产生的推力加速度，$m(t)$为瞬时质量；$\\dot{m}(t)$是质量变化率；$\\vec{r}(t)$为空间飞行器在基础坐标系下的位置矢量；$\\ddot{\\vec{r}}(t)$表示$\\vec{r}(t)$对时间$t$的二阶导数，即加速度；$G_m$为地球引力常数（本题中地球引力常数取$G_m=3.986005 \\times 10^{14} m^3/s^2$），为了更明确地表示推力加速度的方向，$\\vec{v}_r(t)$取的是燃料相对于火箭尾部喷口的喷射速度的逆矢量。\n方程（1）中如果只保留右侧第一项，则可以表示观测卫星的简化运动方程：\n\\[ \\ddot{\\vec{r}}(t) = \\vec{F}_e = -\\frac{G_m}{|\\vec{r}(t)|^3}\\vec{r}(t) \\quad (2) \\]\n在给定基础坐标系下的位置和速度初值情况下，可以利用常微分方程组数值解方法计算空间飞行器的运动轨迹。不同空间飞行器的本质差异就在于$\\vec{v}_r(t)$和$m(t)$的模型不同，$m(t)$一般而言为严格单调递减的非负函数。$\\vec{v}_r(t)$的方向一般应与飞行器的速度方向接近或相同，其大小一般较为稳定。\n观测卫星对于空间飞行器的观测数据通过化简可以由观测坐标系下的两个无量纲比值确定：\n\\[ \\alpha = \\frac{y_s}{x_s}, \\quad \\beta = \\frac{z_s}{x_s} \\quad (3) \\]\n其中$x_s,y_s,z_s$为空间飞行器在观测坐标系中的坐标。\n\n观测数据不可避免地带有各种误差，观测误差包括随机误差和系统误差。本题假设随机误差为直接叠加在观测数据上的白噪声，可能产生于背景辐射干扰与信息处理等多个方面。系统误差也包括多种来源，如卫星定位误差、指向机构误差、图像校准误差、传感器安装误差等等。在本题框架内，我们假定只考虑与卫星平台相关的系统误差，即不同观测卫星的系统误差相互没有关联，同一观测卫星对于不同空间飞行器的系统误差是一样的。经由适当的简化模型，各种系统误差最终可以折合为观测坐标系的原点位置误差和三轴指向误差。根据工程经验，原点位置误差影响较小，而三轴指向误差影响较大，对三轴指向误差进行估计对于提高估计精度很有帮助，本题只考虑三轴指向误差。三轴指向误差在二维观测数据平面上表现为两个平移误差和一个旋转误差，具体可以用三个常值小量来表示，分别表示第一观测量的平移量、第二观测量的平移量以及观测量在平面内的旋转量。\n\n单个红外光学探测器不具备测距能力，但借助多颗（含两颗）观测卫星的同步观测能够进行逐点定位，再结合空间飞行器的运动模型，可以进行轨道参数估计。在单星观测条件下，利用空间飞行器轨道的特殊性，结合较强的模型约束也可得到一定精度轨道参数估计。由于受大气影响，垂直上升段的火箭尾焰不易观测，程序拐弯段的运动方程又较为复杂，所以本题重点关注重力斜飞段的后程段，本题所附仿真数据也集中于此段。\n\n本题以中低轨近圆轨道卫星为观测星座对假想的空间飞行器进行仿真观测，生成仿真观测数据，要求利用仿真观测数据，对假想空间飞行器的轨道参数进行估计。本题所附文件包括：\n\n参数文件satinfo.txt用来存储观测卫星信息，每行表示一颗卫星，包含六列，分别表示零时刻卫星在基础坐标系下的位置和速度。卫星编号从上到下递增并从0开始。\n\n仿真数据文件meadata_i_j.txt用来存储仿真观测数据信息。i、j为占位符，表示编号为i的卫星对编号为j的飞行器的仿真观测数据信息，按照时间顺序分行，每行分三列，分别是观测时刻以及对应观测数据。\n\n本题所涉及的数据与结果，均应采用国际标准单位，即：时间单位为秒、距离单位为米、速度单位为米每秒等等；所有位置和速度均指基础坐标系下的位置和速度。\n\n在仅考虑随机误差的条件下，请你们团队研究下列问题：\n\n观测卫星在任意时刻的位置计算是估计的前提，请根据satinfo.txt和观测卫星的简化运动方程（2），计算09号观测卫星在50.0s、100.0s、150.0s、200.0s、250.0s五个时刻的三维位置。结果保留6位有效数字。\n\n在本题给定的仿真数据下，06号和09号观测卫星对0号空间飞行器形成了立体交叠观测，请结合立体几何知识按照逐点交汇定位的思路，给出0号空间飞行器在公式（1）框架下的轨道估计，注意选取适当的和的表示模型。按照从50.0s到170.0s间隔10.0s进行采样，计算并列表给出0号空间飞行器在各个采样点的位置和速度，并给出估计残差。结果保留6位有效数字。同时绘制0号空间飞行器的三个位置t-x、t-y、t-z和三个速度t-vx、t-vy、t-vz曲线示意图。\n\n在同时考虑系统误差的条件下，进一步研究下列问题：\n\n3.  若06和09号两颗观测卫星均有可能带有一定的系统误差，对系统误差进行正确的估计能够有效提高精度。利用上述的逐点交汇方法能否同时对系统误差进行估计？若不能，是否还有其他的思路能够同时估计系统误差与轨道？给出你的解决方案与估计结果。在报告中除给出与第二问要求相同的结果外，还应分别给出两颗观测卫星的系统误差估计结果，共六个数值，分别是两颗卫星的。\n\n如果你们还有时间和兴趣，还可考虑下列：\n\n 对只有09号观测卫星单星观测的01号空间飞行器进行轨道估计，结果形式要求同第三问，注意参考第三问的系统误差估计结果。并进一步考虑在同时有多颗观测卫星观测多个空间飞行器的情况下能否联合进行系统误差估计？\n\n本题要求提供可计算出所提交报告中答案的计算程序，所使用的语言和工具不限，但推荐使用C\\C++、Fortran、Matlab、Mathematica、...。\nAddendum: \n在仅考虑随机误差的条件下：\n1. 根据 satinfo.txt 和观测卫星的简化运动方程（2），计算09号观测卫星在50.0s、100.0s、150.0s、200.0s、250.0s五个时刻的三维位置。\n2. 在给定仿真数据下，06号和09号观测卫星对0号空间飞行器形成立体交叠观测，结合立体几何知识，按照逐点交汇定位的思路，给出轨道估计，并计算轨道残差，绘制t-x、t-y、t-z和t-vx、t-vy、t-vz曲线。\n\n在同时考虑系统误差的条件下：\n3. 研究能否同时估计系统误差与轨道，并给出误差估计结果，共六个数值（分别表示两颗卫星的三个指向误差参数）。\n\n扩展问题：\n4. 对只有09号观测卫星单星观测的01号空间飞行器进行轨道估计，并进一步研究在多颗观测卫星观测多个空间飞行器时能否联合估计系统误差。\n\n本题要求提交可计算报告答案的计算程序，推荐使用 C/C++、Fortran、Matlab、Mathematica 等语言和工具。\nDataset Path:\n['satinfo.txt', 'meadata_06_00.txt', 'meadata_09_00.txt', 'meadata_09_01.txt']\n\nData Description:\n该数据集由一份卫星初始状态文件和若干仿真观测文件组成：satinfo.txt 按行存储卫星在零时刻的初始状态，每行六列分别给出该卫星在基础坐标系下的三维位置与三维速度，卫星按文件行序编号从0开始递增；若干名为 meadata_i_j.txt 的仿真观测文件（示例包括 meadata_06_00、meadata_09_00、meadata_09_01 等）分别对应编号为 i 的卫星对编号为 j 的飞行器的观测序列，文件按观测时刻时间顺序逐行记录，每行三列为观测时刻 t 及两项无量纲比值观测 u、v（表示成像平面上的归一化坐标比值），所有文件均为结构化的文本表格格式，适合用于基于初始轨道状态的可视测量仿真、轨道/姿态估计与观测模型验证等后续处理。",
  "problem": {
    "background": "有些国家会发射特殊目的的空间飞行器，如弹道式导弹、侦察卫星等。对他国发射具有敌意的空间飞行器实施监控并作出快速反应，对于维护国家安全具有重要的战略意义。发现发射和探测其轨道参数是实现监控和作出反应的第一步，没有观测，后续的判断与反应都无从谈起。卫星居高临下，是当今探测空间飞行器发射与轨道参数的重要平台。\n\n观测卫星按轨道特点，可分为高轨地球同步轨道卫星和中低轨近圆轨道卫星。其中同步轨道距地球表面约3.6万千米，轨道平面与地球赤道平面重合，理论上用3颗间隔120度分布的同步轨道卫星可覆盖地球绝大部分表面。中低轨近圆轨道距地球表面数百到几千千米不等，根据观测要求，其轨道平面与赤道平面交成一定角度，且常由若干颗卫星实现组网探测。装置于卫星上的探测器包括有源和无源两类：有源探测器采用主动方式（如雷达，激光）搜寻目标，同时具备定向和测距两种能力；无源探测器则被动接收目标辐射。采用无源探测器的观测卫星常采用红外光学探测器，只接收目标的红外辐射信息，可定向但不能测距。对于火箭尾部喷焰的高度敏感性是红外技术的长处，但易受气候影响与云层干扰则是其缺点。\n\n探测的目的是为了推断空间飞行器的轨道参数，推断是基于观测数据并通过数学模型与计算方法作出的。当观测卫星飞行一段时间，探测器测得目标相对于运动卫星的观测数据，以观测卫星和空间飞行器的运动模型和观测模型为基础，对空间飞行器的轨道参数（包括轨道位置、速度初值和其他模型参数）进行数学推断，为飞行器类别、飞行意图的判断提供信息基础。\n\n空间飞行器轨道一般可分为三段，依次为：靠火箭推进的主动段、在地球外层空间的惯性飞行段和再入大气层后的攻击段。主动段通常由多级火箭相继推进，前一级火箭完成推进后脱落，由后一级火箭接力。惯性飞行段在空气阻力极小的大气层外，靠末级火箭关机前获得的速度在椭圆轨道上作无动力惯性飞行。攻击段则根据任务需求，受控制后再入大气层，飞向目标。对于卫星而言，在其寿命结束前一直绕地飞行，故无攻击段。\n\n图1是空间飞行器的主动段示意图（未按实际比例）。主动段又可细分为若干子段：垂直上升段，程序拐弯段和重力斜飞段。按最优轨道设计，为节约燃料，箭体应尽快穿过稠密大气层，故火箭一般先垂直发射。设A点为地面发射点，AB为垂直上升段，BC弧段为程序拐弯段，CD弧段为重力斜飞段，DE弧段为椭圆轨道。程序拐弯段连接垂直上升段与重力斜飞段，在外力矩控制下使箭体转过一定角度，该段完成后外加力矩撤销，进入斜飞状态。第一级火箭通常负担“垂直段+程序拐弯段（加外力矩）+重力斜飞段的前段”的推进（视发动机的特性），重力斜飞段的后程则靠第二、第三级火箭相继完成。由于斜飞状态下地球引力与推力不在同一直线，所以箭体质心的运动轨迹为带一定弧度的光滑曲线。",
    "problem_requirement": "为描述观测卫星和空间飞行器的运动，需要建立适当的坐标系。本题基础坐标系为随地心平移的坐标系，取地球中心$O_c$为原点，地球自转轴取为$z$轴，指向北极为正向，$x$轴由指向零时刻的0经度线，再按右手系确定$y$轴，建立直角坐标系$O_c-X_cY_cZ_c$。地心$O_c$在绕日椭圆轨道上运动，所以理论上$O_c-X_cY_cZ_c$系是非惯性系。但地球公转周期远大于空间飞行器的观测弧段时长，故本题在短时间内认定该系为惯性坐标系，该基础坐标系不随地球旋转。\n\n第二个坐标系是随卫星运动的观测坐标系$O_c-X_cY_cZ_c$，见图2，原点取为卫星中心$O_s$，$X_s$轴沿$O_cO_s$连线，离开地球方向为正，$Z_s$轴与$X_s$轴垂直，$Y_s$轴按右手系确定。如此定义的观测坐标系也叫做UEN坐标系，因为三个坐标轴分别指向上（UP）、东（EAST）和北（NORTH）三个方向。\n\n根据变质量质点的动力学，空间飞行器在基础坐标系下的主动段的简化运动方程如下：\\[ \\ddot{\\vec{r}}(t) = \\vec{F}_e + \\vec{F}_T = -\\frac{G_m}{|\\vec{r}(t)|^3}\\vec{r}(t) + \\vec{v}_r(t)\\frac{\\dot{m}(t)}{m(t)} \\quad (1) \\]\n\n其中向量$\\vec{F}_e$表示飞行器所受的外力加速度之和，$\\vec{F}_T$表示火箭产生的推力加速度，$m(t)$为瞬时质量；$\\dot{m}(t)$是质量变化率；$\\vec{r}(t)$为空间飞行器在基础坐标系下的位置矢量；$\\ddot{\\vec{r}}(t)$表示$\\vec{r}(t)$对时间$t$的二阶导数，即加速度；$G_m$为地球引力常数（本题中地球引力常数取$G_m=3.986005 \\times 10^{14} m^3/s^2$），为了更明确地表示推力加速度的方向，$\\vec{v}_r(t)$取的是燃料相对于火箭尾部喷口的喷射速度的逆矢量。\n方程（1）中如果只保留右侧第一项，则可以表示观测卫星的简化运动方程：\n\\[ \\ddot{\\vec{r}}(t) = \\vec{F}_e = -\\frac{G_m}{|\\vec{r}(t)|^3}\\vec{r}(t) \\quad (2) \\]\n在给定基础坐标系下的位置和速度初值情况下，可以利用常微分方程组数值解方法计算空间飞行器的运动轨迹。不同空间飞行器的本质差异就在于$\\vec{v}_r(t)$和$m(t)$的模型不同，$m(t)$一般而言为严格单调递减的非负函数。$\\vec{v}_r(t)$的方向一般应与飞行器的速度方向接近或相同，其大小一般较为稳定。\n观测卫星对于空间飞行器的观测数据通过化简可以由观测坐标系下的两个无量纲比值确定：\n\\[ \\alpha = \\frac{y_s}{x_s}, \\quad \\beta = \\frac{z_s}{x_s} \\quad (3) \\]\n其中$x_s,y_s,z_s$为空间飞行器在观测坐标系中的坐标。\n\n观测数据不可避免地带有各种误差，观测误差包括随机误差和系统误差。本题假设随机误差为直接叠加在观测数据上的白噪声，可能产生于背景辐射干扰与信息处理等多个方面。系统误差也包括多种来源，如卫星定位误差、指向机构误差、图像校准误差、传感器安装误差等等。在本题框架内，我们假定只考虑与卫星平台相关的系统误差，即不同观测卫星的系统误差相互没有关联，同一观测卫星对于不同空间飞行器的系统误差是一样的。经由适当的简化模型，各种系统误差最终可以折合为观测坐标系的原点位置误差和三轴指向误差。根据工程经验，原点位置误差影响较小，而三轴指向误差影响较大，对三轴指向误差进行估计对于提高估计精度很有帮助，本题只考虑三轴指向误差。三轴指向误差在二维观测数据平面上表现为两个平移误差和一个旋转误差，具体可以用三个常值小量来表示，分别表示第一观测量的平移量、第二观测量的平移量以及观测量在平面内的旋转量。\n\n单个红外光学探测器不具备测距能力，但借助多颗（含两颗）观测卫星的同步观测能够进行逐点定位，再结合空间飞行器的运动模型，可以进行轨道参数估计。在单星观测条件下，利用空间飞行器轨道的特殊性，结合较强的模型约束也可得到一定精度轨道参数估计。由于受大气影响，垂直上升段的火箭尾焰不易观测，程序拐弯段的运动方程又较为复杂，所以本题重点关注重力斜飞段的后程段，本题所附仿真数据也集中于此段。\n\n本题以中低轨近圆轨道卫星为观测星座对假想的空间飞行器进行仿真观测，生成仿真观测数据，要求利用仿真观测数据，对假想空间飞行器的轨道参数进行估计。本题所附文件包括：\n\n参数文件satinfo.txt用来存储观测卫星信息，每行表示一颗卫星，包含六列，分别表示零时刻卫星在基础坐标系下的位置和速度。卫星编号从上到下递增并从0开始。\n\n仿真数据文件meadata_i_j.txt用来存储仿真观测数据信息。i、j为占位符，表示编号为i的卫星对编号为j的飞行器的仿真观测数据信息，按照时间顺序分行，每行分三列，分别是观测时刻以及对应观测数据。\n\n本题所涉及的数据与结果，均应采用国际标准单位，即：时间单位为秒、距离单位为米、速度单位为米每秒等等；所有位置和速度均指基础坐标系下的位置和速度。\n\n在仅考虑随机误差的条件下，请你们团队研究下列问题：\n\n观测卫星在任意时刻的位置计算是估计的前提，请根据satinfo.txt和观测卫星的简化运动方程（2），计算09号观测卫星在50.0s、100.0s、150.0s、200.0s、250.0s五个时刻的三维位置。结果保留6位有效数字。\n\n在本题给定的仿真数据下，06号和09号观测卫星对0号空间飞行器形成了立体交叠观测，请结合立体几何知识按照逐点交汇定位的思路，给出0号空间飞行器在公式（1）框架下的轨道估计，注意选取适当的和的表示模型。按照从50.0s到170.0s间隔10.0s进行采样，计算并列表给出0号空间飞行器在各个采样点的位置和速度，并给出估计残差。结果保留6位有效数字。同时绘制0号空间飞行器的三个位置t-x、t-y、t-z和三个速度t-vx、t-vy、t-vz曲线示意图。\n\n在同时考虑系统误差的条件下，进一步研究下列问题：\n\n3.  若06和09号两颗观测卫星均有可能带有一定的系统误差，对系统误差进行正确的估计能够有效提高精度。利用上述的逐点交汇方法能否同时对系统误差进行估计？若不能，是否还有其他的思路能够同时估计系统误差与轨道？给出你的解决方案与估计结果。在报告中除给出与第二问要求相同的结果外，还应分别给出两颗观测卫星的系统误差估计结果，共六个数值，分别是两颗卫星的。\n\n如果你们还有时间和兴趣，还可考虑下列：\n\n 对只有09号观测卫星单星观测的01号空间飞行器进行轨道估计，结果形式要求同第三问，注意参考第三问的系统误差估计结果。并进一步考虑在同时有多颗观测卫星观测多个空间飞行器的情况下能否联合进行系统误差估计？\n\n本题要求提供可计算出所提交报告中答案的计算程序，所使用的语言和工具不限，但推荐使用C\\C++、Fortran、Matlab、Mathematica、...。",
    "dataset_path": [
      "satinfo.txt",
      "meadata_06_00.txt",
      "meadata_09_00.txt",
      "meadata_09_01.txt"
    ],
    "dataset_description": {
      "satinfo": "参数文件 satinfo.txt 用来存储观测卫星信息，每行表示一颗卫星，包含六列，分别表示零时刻卫星在基础坐标系下的位置和速度。卫星编号从上到下递增并从0开始。",
      "meadata_06_00": "仿真数据文件 meadata_i_j.txt 用来存储仿真观测数据信息。i、j为占位符，表示编号为i的卫星对编号为j的飞行器的仿真观测数据信息，按照时间顺序分行，每行分三列，分别是观测时刻以及对应观测数据。",
      "meadata_09_00": "仿真数据文件 meadata_i_j.txt 用来存储仿真观测数据信息。i、j为占位符，表示编号为i的卫星对编号为j的飞行器的仿真观测数据信息，按照时间顺序分行，每行分三列，分别是观测时刻以及对应观测数据。",
      "meadata_09_01": "仿真数据文件 meadata_i_j.txt 用来存储仿真观测数据信息。i、j为占位符，表示编号为i的卫星对编号为j的飞行器的仿真观测数据信息，按照时间顺序分行，每行分三列，分别是观测时刻以及对应观测数据。"
    },
    "variable_description": [
      {
        "x0": "零时刻卫星在基础坐标系下的 x 坐标",
        "y0": "零时刻卫星在基础坐标系下的 y 坐标",
        "z0": "零时刻卫星在基础坐标系下的 z 坐标",
        "vx0": "零时刻卫星在基础坐标系下的 x 方向速度",
        "vy0": "零时刻卫星在基础坐标系下的 y 方向速度",
        "vz0": "零时刻卫星在基础坐标系下的 z 方向速度"
      },
      {
        "t": "观测时刻",
        "u": "无量纲比值 α = x/z",
        "v": "无量纲比值 β = y/z"
      },
      {
        "t": "观测时刻",
        "u": "无量纲比值 α = x/z",
        "v": "无量纲比值 β = y/z"
      },
      {
        "t": "观测时刻",
        "u": "无量纲比值 α = x/z",
        "v": "无量纲比值 β = y/z"
      }
    ],
    "addendum": "在仅考虑随机误差的条件下：\n1. 根据 satinfo.txt 和观测卫星的简化运动方程（2），计算09号观测卫星在50.0s、100.0s、150.0s、200.0s、250.0s五个时刻的三维位置。\n2. 在给定仿真数据下，06号和09号观测卫星对0号空间飞行器形成立体交叠观测，结合立体几何知识，按照逐点交汇定位的思路，给出轨道估计，并计算轨道残差，绘制t-x、t-y、t-z和t-vx、t-vy、t-vz曲线。\n\n在同时考虑系统误差的条件下：\n3. 研究能否同时估计系统误差与轨道，并给出误差估计结果，共六个数值（分别表示两颗卫星的三个指向误差参数）。\n\n扩展问题：\n4. 对只有09号观测卫星单星观测的01号空间飞行器进行轨道估计，并进一步研究在多颗观测卫星观测多个空间飞行器时能否联合估计系统误差。\n\n本题要求提交可计算报告答案的计算程序，推荐使用 C/C++、Fortran、Matlab、Mathematica 等语言和工具。",
    "data_summary": "Dataset Path:\n['satinfo.txt', 'meadata_06_00.txt', 'meadata_09_00.txt', 'meadata_09_01.txt']\n\nData Description:\n该数据集由一份卫星初始状态文件和若干仿真观测文件组成：satinfo.txt 按行存储卫星在零时刻的初始状态，每行六列分别给出该卫星在基础坐标系下的三维位置与三维速度，卫星按文件行序编号从0开始递增；若干名为 meadata_i_j.txt 的仿真观测文件（示例包括 meadata_06_00、meadata_09_00、meadata_09_01 等）分别对应编号为 i 的卫星对编号为 j 的飞行器的观测序列，文件按观测时刻时间顺序逐行记录，每行三列为观测时刻 t 及两项无量纲比值观测 u、v（表示成像平面上的归一化坐标比值），所有文件均为结构化的文本表格格式，适合用于基于初始轨道状态的可视测量仿真、轨道/姿态估计与观测模型验证等后续处理。",
    "data_description": {
      "satinfo": "参数文件 satinfo.txt 用来存储观测卫星信息，每行表示一颗卫星，包含六列，分别表示零时刻卫星在基础坐标系下的位置和速度。卫星编号从上到下递增并从0开始。",
      "meadata_06_00": "仿真数据文件 meadata_i_j.txt 用来存储仿真观测数据信息。i、j为占位符，表示编号为i的卫星对编号为j的飞行器的仿真观测数据信息，按照时间顺序分行，每行分三列，分别是观测时刻以及对应观测数据。",
      "meadata_09_00": "仿真数据文件 meadata_i_j.txt 用来存储仿真观测数据信息。i、j为占位符，表示编号为i的卫星对编号为j的飞行器的仿真观测数据信息，按照时间顺序分行，每行分三列，分别是观测时刻以及对应观测数据。",
      "meadata_09_01": "仿真数据文件 meadata_i_j.txt 用来存储仿真观测数据信息。i、j为占位符，表示编号为i的卫星对编号为j的飞行器的仿真观测数据信息，按照时间顺序分行，每行分三列，分别是观测时刻以及对应观测数据。"
    },
    "problem_str": "问题背景：\n有些国家会发射特殊目的的空间飞行器，如弹道式导弹、侦察卫星等。对他国发射具有敌意的空间飞行器实施监控并作出快速反应，对于维护国家安全具有重要的战略意义。发现发射和探测其轨道参数是实现监控和作出反应的第一步，没有观测，后续的判断与反应都无从谈起。卫星居高临下，是当今探测空间飞行器发射与轨道参数的重要平台。\n\n观测卫星按轨道特点，可分为高轨地球同步轨道卫星和中低轨近圆轨道卫星。其中同步轨道距地球表面约3.6万千米，轨道平面与地球赤道平面重合，理论上用3颗间隔120度分布的同步轨道卫星可覆盖地球绝大部分表面。中低轨近圆轨道距地球表面数百到几千千米不等，根据观测要求，其轨道平面与赤道平面交成一定角度，且常由若干颗卫星实现组网探测。装置于卫星上的探测器包括有源和无源两类：有源探测器采用主动方式（如雷达，激光）搜寻目标，同时具备定向和测距两种能力；无源探测器则被动接收目标辐射。采用无源探测器的观测卫星常采用红外光学探测器，只接收目标的红外辐射信息，可定向但不能测距。对于火箭尾部喷焰的高度敏感性是红外技术的长处，但易受气候影响与云层干扰则是其缺点。\n\n探测的目的是为了推断空间飞行器的轨道参数，推断是基于观测数据并通过数学模型与计算方法作出的。当观测卫星飞行一段时间，探测器测得目标相对于运动卫星的观测数据，以观测卫星和空间飞行器的运动模型和观测模型为基础，对空间飞行器的轨道参数（包括轨道位置、速度初值和其他模型参数）进行数学推断，为飞行器类别、飞行意图的判断提供信息基础。\n\n空间飞行器轨道一般可分为三段，依次为：靠火箭推进的主动段、在地球外层空间的惯性飞行段和再入大气层后的攻击段。主动段通常由多级火箭相继推进，前一级火箭完成推进后脱落，由后一级火箭接力。惯性飞行段在空气阻力极小的大气层外，靠末级火箭关机前获得的速度在椭圆轨道上作无动力惯性飞行。攻击段则根据任务需求，受控制后再入大气层，飞向目标。对于卫星而言，在其寿命结束前一直绕地飞行，故无攻击段。\n\n图1是空间飞行器的主动段示意图（未按实际比例）。主动段又可细分为若干子段：垂直上升段，程序拐弯段和重力斜飞段。按最优轨道设计，为节约燃料，箭体应尽快穿过稠密大气层，故火箭一般先垂直发射。设A点为地面发射点，AB为垂直上升段，BC弧段为程序拐弯段，CD弧段为重力斜飞段，DE弧段为椭圆轨道。程序拐弯段连接垂直上升段与重力斜飞段，在外力矩控制下使箭体转过一定角度，该段完成后外加力矩撤销，进入斜飞状态。第一级火箭通常负担“垂直段+程序拐弯段（加外力矩）+重力斜飞段的前段”的推进（视发动机的特性），重力斜飞段的后程则靠第二、第三级火箭相继完成。由于斜飞状态下地球引力与推力不在同一直线，所以箭体质心的运动轨迹为带一定弧度的光滑曲线。\n\n问题要求：\n为描述观测卫星和空间飞行器的运动，需要建立适当的坐标系。本题基础坐标系为随地心平移的坐标系，取地球中心$O_c$为原点，地球自转轴取为$z$轴，指向北极为正向，$x$轴由指向零时刻的0经度线，再按右手系确定$y$轴，建立直角坐标系$O_c-X_cY_cZ_c$。地心$O_c$在绕日椭圆轨道上运动，所以理论上$O_c-X_cY_cZ_c$系是非惯性系。但地球公转周期远大于空间飞行器的观测弧段时长，故本题在短时间内认定该系为惯性坐标系，该基础坐标系不随地球旋转。\n\n第二个坐标系是随卫星运动的观测坐标系$O_c-X_cY_cZ_c$，见图2，原点取为卫星中心$O_s$，$X_s$轴沿$O_cO_s$连线，离开地球方向为正，$Z_s$轴与$X_s$轴垂直，$Y_s$轴按右手系确定。如此定义的观测坐标系也叫做UEN坐标系，因为三个坐标轴分别指向上（UP）、东（EAST）和北（NORTH）三个方向。\n\n根据变质量质点的动力学，空间飞行器在基础坐标系下的主动段的简化运动方程如下：\\[ \\ddot{\\vec{r}}(t) = \\vec{F}_e + \\vec{F}_T = -\\frac{G_m}{|\\vec{r}(t)|^3}\\vec{r}(t) + \\vec{v}_r(t)\\frac{\\dot{m}(t)}{m(t)} \\quad (1) \\]\n\n其中向量$\\vec{F}_e$表示飞行器所受的外力加速度之和，$\\vec{F}_T$表示火箭产生的推力加速度，$m(t)$为瞬时质量；$\\dot{m}(t)$是质量变化率；$\\vec{r}(t)$为空间飞行器在基础坐标系下的位置矢量；$\\ddot{\\vec{r}}(t)$表示$\\vec{r}(t)$对时间$t$的二阶导数，即加速度；$G_m$为地球引力常数（本题中地球引力常数取$G_m=3.986005 \\times 10^{14} m^3/s^2$），为了更明确地表示推力加速度的方向，$\\vec{v}_r(t)$取的是燃料相对于火箭尾部喷口的喷射速度的逆矢量。\n方程（1）中如果只保留右侧第一项，则可以表示观测卫星的简化运动方程：\n\\[ \\ddot{\\vec{r}}(t) = \\vec{F}_e = -\\frac{G_m}{|\\vec{r}(t)|^3}\\vec{r}(t) \\quad (2) \\]\n在给定基础坐标系下的位置和速度初值情况下，可以利用常微分方程组数值解方法计算空间飞行器的运动轨迹。不同空间飞行器的本质差异就在于$\\vec{v}_r(t)$和$m(t)$的模型不同，$m(t)$一般而言为严格单调递减的非负函数。$\\vec{v}_r(t)$的方向一般应与飞行器的速度方向接近或相同，其大小一般较为稳定。\n观测卫星对于空间飞行器的观测数据通过化简可以由观测坐标系下的两个无量纲比值确定：\n\\[ \\alpha = \\frac{y_s}{x_s}, \\quad \\beta = \\frac{z_s}{x_s} \\quad (3) \\]\n其中$x_s,y_s,z_s$为空间飞行器在观测坐标系中的坐标。\n\n观测数据不可避免地带有各种误差，观测误差包括随机误差和系统误差。本题假设随机误差为直接叠加在观测数据上的白噪声，可能产生于背景辐射干扰与信息处理等多个方面。系统误差也包括多种来源，如卫星定位误差、指向机构误差、图像校准误差、传感器安装误差等等。在本题框架内，我们假定只考虑与卫星平台相关的系统误差，即不同观测卫星的系统误差相互没有关联，同一观测卫星对于不同空间飞行器的系统误差是一样的。经由适当的简化模型，各种系统误差最终可以折合为观测坐标系的原点位置误差和三轴指向误差。根据工程经验，原点位置误差影响较小，而三轴指向误差影响较大，对三轴指向误差进行估计对于提高估计精度很有帮助，本题只考虑三轴指向误差。三轴指向误差在二维观测数据平面上表现为两个平移误差和一个旋转误差，具体可以用三个常值小量来表示，分别表示第一观测量的平移量、第二观测量的平移量以及观测量在平面内的旋转量。\n\n单个红外光学探测器不具备测距能力，但借助多颗（含两颗）观测卫星的同步观测能够进行逐点定位，再结合空间飞行器的运动模型，可以进行轨道参数估计。在单星观测条件下，利用空间飞行器轨道的特殊性，结合较强的模型约束也可得到一定精度轨道参数估计。由于受大气影响，垂直上升段的火箭尾焰不易观测，程序拐弯段的运动方程又较为复杂，所以本题重点关注重力斜飞段的后程段，本题所附仿真数据也集中于此段。\n\n本题以中低轨近圆轨道卫星为观测星座对假想的空间飞行器进行仿真观测，生成仿真观测数据，要求利用仿真观测数据，对假想空间飞行器的轨道参数进行估计。本题所附文件包括：\n\n参数文件satinfo.txt用来存储观测卫星信息，每行表示一颗卫星，包含六列，分别表示零时刻卫星在基础坐标系下的位置和速度。卫星编号从上到下递增并从0开始。\n\n仿真数据文件meadata_i_j.txt用来存储仿真观测数据信息。i、j为占位符，表示编号为i的卫星对编号为j的飞行器的仿真观测数据信息，按照时间顺序分行，每行分三列，分别是观测时刻以及对应观测数据。\n\n本题所涉及的数据与结果，均应采用国际标准单位，即：时间单位为秒、距离单位为米、速度单位为米每秒等等；所有位置和速度均指基础坐标系下的位置和速度。\n\n在仅考虑随机误差的条件下，请你们团队研究下列问题：\n\n观测卫星在任意时刻的位置计算是估计的前提，请根据satinfo.txt和观测卫星的简化运动方程（2），计算09号观测卫星在50.0s、100.0s、150.0s、200.0s、250.0s五个时刻的三维位置。结果保留6位有效数字。\n\n在本题给定的仿真数据下，06号和09号观测卫星对0号空间飞行器形成了立体交叠观测，请结合立体几何知识按照逐点交汇定位的思路，给出0号空间飞行器在公式（1）框架下的轨道估计，注意选取适当的和的表示模型。按照从50.0s到170.0s间隔10.0s进行采样，计算并列表给出0号空间飞行器在各个采样点的位置和速度，并给出估计残差。结果保留6位有效数字。同时绘制0号空间飞行器的三个位置t-x、t-y、t-z和三个速度t-vx、t-vy、t-vz曲线示意图。\n\n在同时考虑系统误差的条件下，进一步研究下列问题：\n\n3.  若06和09号两颗观测卫星均有可能带有一定的系统误差，对系统误差进行正确的估计能够有效提高精度。利用上述的逐点交汇方法能否同时对系统误差进行估计？若不能，是否还有其他的思路能够同时估计系统误差与轨道？给出你的解决方案与估计结果。在报告中除给出与第二问要求相同的结果外，还应分别给出两颗观测卫星的系统误差估计结果，共六个数值，分别是两颗卫星的。\n\n如果你们还有时间和兴趣，还可考虑下列：\n\n 对只有09号观测卫星单星观测的01号空间飞行器进行轨道估计，结果形式要求同第三问，注意参考第三问的系统误差估计结果。并进一步考虑在同时有多颗观测卫星观测多个空间飞行器的情况下能否联合进行系统误差估计？\n\n本题要求提供可计算出所提交报告中答案的计算程序，所使用的语言和工具不限，但推荐使用C\\C++、Fortran、Matlab、Mathematica、...。\nAddendum: \n在仅考虑随机误差的条件下：\n1. 根据 satinfo.txt 和观测卫星的简化运动方程（2），计算09号观测卫星在50.0s、100.0s、150.0s、200.0s、250.0s五个时刻的三维位置。\n2. 在给定仿真数据下，06号和09号观测卫星对0号空间飞行器形成立体交叠观测，结合立体几何知识，按照逐点交汇定位的思路，给出轨道估计，并计算轨道残差，绘制t-x、t-y、t-z和t-vx、t-vy、t-vz曲线。\n\n在同时考虑系统误差的条件下：\n3. 研究能否同时估计系统误差与轨道，并给出误差估计结果，共六个数值（分别表示两颗卫星的三个指向误差参数）。\n\n扩展问题：\n4. 对只有09号观测卫星单星观测的01号空间飞行器进行轨道估计，并进一步研究在多颗观测卫星观测多个空间飞行器时能否联合估计系统误差。\n\n本题要求提交可计算报告答案的计算程序，推荐使用 C/C++、Fortran、Matlab、Mathematica 等语言和工具。\nDataset Path:\n['satinfo.txt', 'meadata_06_00.txt', 'meadata_09_00.txt', 'meadata_09_01.txt']\n\nData Description:\n该数据集由一份卫星初始状态文件和若干仿真观测文件组成：satinfo.txt 按行存储卫星在零时刻的初始状态，每行六列分别给出该卫星在基础坐标系下的三维位置与三维速度，卫星按文件行序编号从0开始递增；若干名为 meadata_i_j.txt 的仿真观测文件（示例包括 meadata_06_00、meadata_09_00、meadata_09_01 等）分别对应编号为 i 的卫星对编号为 j 的飞行器的观测序列，文件按观测时刻时间顺序逐行记录，每行三列为观测时刻 t 及两项无量纲比值观测 u、v（表示成像平面上的归一化坐标比值），所有文件均为结构化的文本表格格式，适合用于基于初始轨道状态的可视测量仿真、轨道/姿态估计与观测模型验证等后续处理。"
  },
  "problem_background": "有些国家会发射特殊目的的空间飞行器，如弹道式导弹、侦察卫星等。对他国发射具有敌意的空间飞行器实施监控并作出快速反应，对于维护国家安全具有重要的战略意义。发现发射和探测其轨道参数是实现监控和作出反应的第一步，没有观测，后续的判断与反应都无从谈起。卫星居高临下，是当今探测空间飞行器发射与轨道参数的重要平台。\n\n观测卫星按轨道特点，可分为高轨地球同步轨道卫星和中低轨近圆轨道卫星。其中同步轨道距地球表面约3.6万千米，轨道平面与地球赤道平面重合，理论上用3颗间隔120度分布的同步轨道卫星可覆盖地球绝大部分表面。中低轨近圆轨道距地球表面数百到几千千米不等，根据观测要求，其轨道平面与赤道平面交成一定角度，且常由若干颗卫星实现组网探测。装置于卫星上的探测器包括有源和无源两类：有源探测器采用主动方式（如雷达，激光）搜寻目标，同时具备定向和测距两种能力；无源探测器则被动接收目标辐射。采用无源探测器的观测卫星常采用红外光学探测器，只接收目标的红外辐射信息，可定向但不能测距。对于火箭尾部喷焰的高度敏感性是红外技术的长处，但易受气候影响与云层干扰则是其缺点。\n\n探测的目的是为了推断空间飞行器的轨道参数，推断是基于观测数据并通过数学模型与计算方法作出的。当观测卫星飞行一段时间，探测器测得目标相对于运动卫星的观测数据，以观测卫星和空间飞行器的运动模型和观测模型为基础，对空间飞行器的轨道参数（包括轨道位置、速度初值和其他模型参数）进行数学推断，为飞行器类别、飞行意图的判断提供信息基础。\n\n空间飞行器轨道一般可分为三段，依次为：靠火箭推进的主动段、在地球外层空间的惯性飞行段和再入大气层后的攻击段。主动段通常由多级火箭相继推进，前一级火箭完成推进后脱落，由后一级火箭接力。惯性飞行段在空气阻力极小的大气层外，靠末级火箭关机前获得的速度在椭圆轨道上作无动力惯性飞行。攻击段则根据任务需求，受控制后再入大气层，飞向目标。对于卫星而言，在其寿命结束前一直绕地飞行，故无攻击段。\n\n图1是空间飞行器的主动段示意图（未按实际比例）。主动段又可细分为若干子段：垂直上升段，程序拐弯段和重力斜飞段。按最优轨道设计，为节约燃料，箭体应尽快穿过稠密大气层，故火箭一般先垂直发射。设A点为地面发射点，AB为垂直上升段，BC弧段为程序拐弯段，CD弧段为重力斜飞段，DE弧段为椭圆轨道。程序拐弯段连接垂直上升段与重力斜飞段，在外力矩控制下使箭体转过一定角度，该段完成后外加力矩撤销，进入斜飞状态。第一级火箭通常负担“垂直段+程序拐弯段（加外力矩）+重力斜飞段的前段”的推进（视发动机的特性），重力斜飞段的后程则靠第二、第三级火箭相继完成。由于斜飞状态下地球引力与推力不在同一直线，所以箭体质心的运动轨迹为带一定弧度的光滑曲线。",
  "problem_requirement": "为描述观测卫星和空间飞行器的运动，需要建立适当的坐标系。本题基础坐标系为随地心平移的坐标系，取地球中心$O_c$为原点，地球自转轴取为$z$轴，指向北极为正向，$x$轴由指向零时刻的0经度线，再按右手系确定$y$轴，建立直角坐标系$O_c-X_cY_cZ_c$。地心$O_c$在绕日椭圆轨道上运动，所以理论上$O_c-X_cY_cZ_c$系是非惯性系。但地球公转周期远大于空间飞行器的观测弧段时长，故本题在短时间内认定该系为惯性坐标系，该基础坐标系不随地球旋转。\n\n第二个坐标系是随卫星运动的观测坐标系$O_c-X_cY_cZ_c$，见图2，原点取为卫星中心$O_s$，$X_s$轴沿$O_cO_s$连线，离开地球方向为正，$Z_s$轴与$X_s$轴垂直，$Y_s$轴按右手系确定。如此定义的观测坐标系也叫做UEN坐标系，因为三个坐标轴分别指向上（UP）、东（EAST）和北（NORTH）三个方向。\n\n根据变质量质点的动力学，空间飞行器在基础坐标系下的主动段的简化运动方程如下：\\[ \\ddot{\\vec{r}}(t) = \\vec{F}_e + \\vec{F}_T = -\\frac{G_m}{|\\vec{r}(t)|^3}\\vec{r}(t) + \\vec{v}_r(t)\\frac{\\dot{m}(t)}{m(t)} \\quad (1) \\]\n\n其中向量$\\vec{F}_e$表示飞行器所受的外力加速度之和，$\\vec{F}_T$表示火箭产生的推力加速度，$m(t)$为瞬时质量；$\\dot{m}(t)$是质量变化率；$\\vec{r}(t)$为空间飞行器在基础坐标系下的位置矢量；$\\ddot{\\vec{r}}(t)$表示$\\vec{r}(t)$对时间$t$的二阶导数，即加速度；$G_m$为地球引力常数（本题中地球引力常数取$G_m=3.986005 \\times 10^{14} m^3/s^2$），为了更明确地表示推力加速度的方向，$\\vec{v}_r(t)$取的是燃料相对于火箭尾部喷口的喷射速度的逆矢量。\n方程（1）中如果只保留右侧第一项，则可以表示观测卫星的简化运动方程：\n\\[ \\ddot{\\vec{r}}(t) = \\vec{F}_e = -\\frac{G_m}{|\\vec{r}(t)|^3}\\vec{r}(t) \\quad (2) \\]\n在给定基础坐标系下的位置和速度初值情况下，可以利用常微分方程组数值解方法计算空间飞行器的运动轨迹。不同空间飞行器的本质差异就在于$\\vec{v}_r(t)$和$m(t)$的模型不同，$m(t)$一般而言为严格单调递减的非负函数。$\\vec{v}_r(t)$的方向一般应与飞行器的速度方向接近或相同，其大小一般较为稳定。\n观测卫星对于空间飞行器的观测数据通过化简可以由观测坐标系下的两个无量纲比值确定：\n\\[ \\alpha = \\frac{y_s}{x_s}, \\quad \\beta = \\frac{z_s}{x_s} \\quad (3) \\]\n其中$x_s,y_s,z_s$为空间飞行器在观测坐标系中的坐标。\n\n观测数据不可避免地带有各种误差，观测误差包括随机误差和系统误差。本题假设随机误差为直接叠加在观测数据上的白噪声，可能产生于背景辐射干扰与信息处理等多个方面。系统误差也包括多种来源，如卫星定位误差、指向机构误差、图像校准误差、传感器安装误差等等。在本题框架内，我们假定只考虑与卫星平台相关的系统误差，即不同观测卫星的系统误差相互没有关联，同一观测卫星对于不同空间飞行器的系统误差是一样的。经由适当的简化模型，各种系统误差最终可以折合为观测坐标系的原点位置误差和三轴指向误差。根据工程经验，原点位置误差影响较小，而三轴指向误差影响较大，对三轴指向误差进行估计对于提高估计精度很有帮助，本题只考虑三轴指向误差。三轴指向误差在二维观测数据平面上表现为两个平移误差和一个旋转误差，具体可以用三个常值小量来表示，分别表示第一观测量的平移量、第二观测量的平移量以及观测量在平面内的旋转量。\n\n单个红外光学探测器不具备测距能力，但借助多颗（含两颗）观测卫星的同步观测能够进行逐点定位，再结合空间飞行器的运动模型，可以进行轨道参数估计。在单星观测条件下，利用空间飞行器轨道的特殊性，结合较强的模型约束也可得到一定精度轨道参数估计。由于受大气影响，垂直上升段的火箭尾焰不易观测，程序拐弯段的运动方程又较为复杂，所以本题重点关注重力斜飞段的后程段，本题所附仿真数据也集中于此段。\n\n本题以中低轨近圆轨道卫星为观测星座对假想的空间飞行器进行仿真观测，生成仿真观测数据，要求利用仿真观测数据，对假想空间飞行器的轨道参数进行估计。本题所附文件包括：\n\n参数文件satinfo.txt用来存储观测卫星信息，每行表示一颗卫星，包含六列，分别表示零时刻卫星在基础坐标系下的位置和速度。卫星编号从上到下递增并从0开始。\n\n仿真数据文件meadata_i_j.txt用来存储仿真观测数据信息。i、j为占位符，表示编号为i的卫星对编号为j的飞行器的仿真观测数据信息，按照时间顺序分行，每行分三列，分别是观测时刻以及对应观测数据。\n\n本题所涉及的数据与结果，均应采用国际标准单位，即：时间单位为秒、距离单位为米、速度单位为米每秒等等；所有位置和速度均指基础坐标系下的位置和速度。\n\n在仅考虑随机误差的条件下，请你们团队研究下列问题：\n\n观测卫星在任意时刻的位置计算是估计的前提，请根据satinfo.txt和观测卫星的简化运动方程（2），计算09号观测卫星在50.0s、100.0s、150.0s、200.0s、250.0s五个时刻的三维位置。结果保留6位有效数字。\n\n在本题给定的仿真数据下，06号和09号观测卫星对0号空间飞行器形成了立体交叠观测，请结合立体几何知识按照逐点交汇定位的思路，给出0号空间飞行器在公式（1）框架下的轨道估计，注意选取适当的和的表示模型。按照从50.0s到170.0s间隔10.0s进行采样，计算并列表给出0号空间飞行器在各个采样点的位置和速度，并给出估计残差。结果保留6位有效数字。同时绘制0号空间飞行器的三个位置t-x、t-y、t-z和三个速度t-vx、t-vy、t-vz曲线示意图。\n\n在同时考虑系统误差的条件下，进一步研究下列问题：\n\n3.  若06和09号两颗观测卫星均有可能带有一定的系统误差，对系统误差进行正确的估计能够有效提高精度。利用上述的逐点交汇方法能否同时对系统误差进行估计？若不能，是否还有其他的思路能够同时估计系统误差与轨道？给出你的解决方案与估计结果。在报告中除给出与第二问要求相同的结果外，还应分别给出两颗观测卫星的系统误差估计结果，共六个数值，分别是两颗卫星的。\n\n如果你们还有时间和兴趣，还可考虑下列：\n\n 对只有09号观测卫星单星观测的01号空间飞行器进行轨道估计，结果形式要求同第三问，注意参考第三问的系统误差估计结果。并进一步考虑在同时有多颗观测卫星观测多个空间飞行器的情况下能否联合进行系统误差估计？\n\n本题要求提供可计算出所提交报告中答案的计算程序，所使用的语言和工具不限，但推荐使用C\\C++、Fortran、Matlab、Mathematica、...。",
  "problem_analysis": "这道题本质上是一个以观测几何和动力学约束为桥梁的参数估计问题：用若干颗观测卫星在若干时刻给出的视向（归一化像面比值）测量来反演被观测飞行器的三维轨迹与速度，并在必要时同时估计观测平台的系统指向误差。宏观上，建模的主要目标可以分为两类相互耦合的子目标：一是基于已知或可积分得到的观测卫星轨道，利用多站同时的视向观测进行逐点定位（空间三角定位）以恢复目标在每个观测时刻的三维位置；二是利用这些逐点位置信息和飞行器的动力学模型（在被动段可近似为二体牛顿引力运动，在主动段须引入推力与变质量项）进行时间序列上的动力学拟合，从而获得连续的轨道初值和速度估计，必要时再联合估计系统误差参数。这个目标设定塑造了解题思路：观测几何提供瞬时约束（两颗卫星给出的两条射线的最近点提供位置的估计），动力学模型提供跨时刻的耦合约束（把噪声化的逐点定位结果平滑并约束到物理可行的轨道曲线上），而系统误差被视为常数偏置参数可以通过多时刻联合估计来分离出真值与偏差。\n\n问题描述中有若干显性和隐性假设，这些假设既使问题可解也限制了解释与外推的范围。显性的包括把地心坐标系在短时间内视为惯性系（忽略地球绕日公转对观测弧段的影响）；对观测卫星运动采用简化的二体动力学（公式(2)，仅保留地球引力）；将观测值化简为两个无量纲比值alpha=y_s/x_s和beta=z_s/x_s，且把随机观测误差建模为直接加在观测数据上的白噪声；把系统误差最终简化为观测平面内两个平移和一个旋转的常数小量。隐含的假设还有：观测时刻同步精确（或已补偿时差）；观测卫星初始位置与速度可信；传感器模型线性化后用这两个比值就足以描述指向误差的影响；外界扰动力（诸如大气阻力J2摄动、太阳/月球引力、太阳辐射压等）对所研究时间尺度和高度下的影响可以忽略或不显著。所有这些假设使得问题可以用相对简单的代数几何和非线性最小二乘工具来处理，但也意味着若在真实场景下应用结论必须谨慎：若观测时间变长或轨道较高、抑或推力行为复杂、或传感器/时钟误差更复杂，忽略的项会导致偏差和可识别性问题。\n\n各要素之间的关系与耦合决定了问题的复杂性。首先观测卫星轨道与观测坐标系是基础：要把像面比值变为空间射线，需要精确得到卫星在观测时刻在基础系的位置与卫星本体指向（UEN基准），因此卫星的轨道积分精度、时刻对齐以及姿态信息（若有）直接影响定位精度。其次观测几何（两条射线的相对方向和夹角）决定了逐点三角定位的条件数：两条射线接近相互平行时定位不稳定，几何稀疏或视角不良会放大观测噪声导致位置解的方差增大。再次动力学模型将各时刻解连接起来，这既是提高解的稳健性的重要途径，也是辨识系统误差的关键：如果只做独立时刻的逐点交汇定位，系统误差与目标位置会高度耦合、不可区分；但若把动力学约束（比如轨迹近似为二体椭圆或在主动段按某参数化推力运动）作为跨时刻的先验或约束，就可以通过时间一致性把常量偏置与真位置区分开。因此，存在张力需要调和：一方面希望利用每时刻的独立几何信息来捕捉短时行为，另一方面又需要依赖动力学的全局约束来稳定估计并分离系统偏置。\n\n在不同尺度和时域上问题呈现不同挑战。短时间内、在二体近似成立的段，轨道积分与逐点定位配合得当可以得到高精度瞬时位置和速度估计；长时间或当动力学模型因推力、质量变化或高阶重力项而偏离简化模型时，模型误差会累积导致估计系统性偏离，必须引入更复杂的动力学描述（例如引入J2项、大气阻力、推力参数化、质量随时间的具体函数等）或采用滑动窗口重估策略。外界扰动和模型不确定性会使得估计问题在数值上变得非线性且可能存在多个局部极小点，因此对初始猜测及优化方法（如使用逐步加密时间采样、分阶段估计或采用鲁棒/全局优化工具）要求高。此外，考虑系统误差估计时尺度也关键：若系统误差真的是常数并对长弧保持恒定，通过长时间序列联合估计可提高辨识能力；若误差随时间缓慢变化，则需用时间参数化（如低阶多项式或随机游走模型）处理，这又增加了状态维度和不确定性。\n\n从替代视角可以重构问题并导出不同的求解策略。最直接的两类方法是“逐点几何法+动力学平滑”和“联合动力学-偏置最小二乘（批量）”。前者先在每个时间以两条射线的最短连线中点作为位置估计，再用有限差分或低阶多项式拟合速度，然后用动力学平滑滤除噪声；优点直观且实现简单，缺点是无法在单次定位里分离常量系统偏置。后者将目标初始状态、（必要时的）推力/质量参数以及若干观测平台的系统偏置作为待估参数，构成一个非线性最小二乘问题或极大似然问题，通过将所有时间的观测方程与动力学约束一并纳入求解，可以在理论上同时估计轨道和常量偏置，但要求问题在观测上可观测（即参数是可辨识的）并且求解的数值稳定性更差，需良好初值与适当的正则化。代替的在线方法包括扩展卡尔曼滤波和无迹/粒子滤波，这些可用于实时或顺序处理，并能通过状态扩展把系统偏置作为缓慢变化的状态量一起估计；但滤波器对模型线性化和噪声统计假设敏感。若观测网跨多目标，可以构建联合估计框架：把多个目标的动力学方程联立并共享观测平台的系统偏置参数，这种“多目标-多平台联合批量估计”在信息融合上具有更好可观测性，能更可靠地分离平台偏置和目标轨迹，但计算量急剧增加并对初值敏感。\n\n不确定性与风险方面，主要来自测量噪声模型误差、平台轨道/姿态不精确、时间同步误差、未建模动力学误差（如微推力、气动扰动）以及测站（卫星）系统误差本身若违背常量假设会导致误差无法完全分离。理论上的可观测性条件是关键：两颗卫星对单一目标在每时刻能给出位置，但若两条射线角度不足或时间段短，联合估计偏置会发散；单卫星对单目标无真正的几何三角化能力，必须靠动力学关系跨时刻辨识，且若动力学模型亦有未确参数（如未知持续推力或质量流率），则跟随参数的耦合可能导致参数不可识别。为降低风险应采取稳健化策略：进行灵敏度/误差传播分析（例如计算Fisher信息或CRLB以评估理论极限精度）、采用正则化或先验信息（例如卫星指向误差以工程经验给出界限）、分阶段估计（先估轨迹再估偏置或先粗估偏置再精估轨迹）、并在算法上加多起点或全局搜索避免局部极小。\n\n建模与求解过程应当是迭代与开放的：初步可采用题目建议的流程——用公式(2)将观测卫星轨道积分到观测时刻以得到卫星位置信息；基于alpha,beta计算出每时刻在卫星本体UEN系下的视向矢量并转换为基础系，利用两颗卫星同时观测的射线求出最近点/最小二乘交点作为逐点位置估计；随后以这些逐点位置为观测值，构建动力学约束的批量非线性最小二乘问题去估计目标的初始位置和速度（以及需要时的推力/质量参数）；最后把观测重投影以计算残差并评估估计误差。若需要同时估计平台系统偏置，应把偏置参数并入批量估计的状态向量，或把它们建模为缓慢变化的状态并用滤波器在线估计。整个流程应结合数值诊断：检查散度、残差的统计一致性、参数相关性矩阵以判断可辨识性；必要时引入多目标或额外观测（第三颗卫星、地面测站或雷达测距）来提高辨识能力。最终，模型的选择、复杂度与可解释性之间需要权衡：过度简化会产生模型偏差，过度复杂会使参数不可辨识且数值不稳定，因此应以所需应用精度和可用观测数量为准绳，采用分层建模与逐步复杂化的策略，保持对结果不确定性的量化并在新数据或检验结果出现时及时修正模型与结论。",
  "modeling_solution": "总体思路与建模目标。针对题目要求，我提出一个以物理动力学约束与观测几何耦合的分层联合估计模型：在观测层，把每颗观测卫星在各观测时刻的已知位置（由卫星初始状态和二体动力学传播得到）和测得的像面比值(alpha, beta)通过卫星本地UEN坐标系变换建立射线观测方程；在几何层，用两颗卫星的同步观测按两条空间射线的最短连线得到逐点三维位置初估及每点的几何残差；在动力学层，以被观测飞行器的运动方程（两体牛顿重力或必要时含推力/变质量项）作为约束，采用批量非线性最小二乘或滤波器把时序测量连贯起来，得到光滑的轨道与速度估计；在系统误差层，把每颗观测卫星的三轴指向误差用三个常量参数（两个像平面平移分量和一个平面内小角旋转）参数化，直接并入观测方程并与轨道参数一并估计。总体目标是：一）计算并输出观测卫星在给定时刻的位置（用二体或Kepler传播）；二）用06号与09号的同步观测做逐点交汇得到0号飞行器各采样时刻位置与速度与残差；三）在必要时把两颗卫星的系统误差作为额外参数并通过多时刻联合估计分离出偏置；四）讨论单星情形下如何借助动力学约束估计轨道及多目标-多平台联合识别系统误差的可行性。\n\n基本假设与坐标定义。假定地心坐标系O_c-X_cY_cZ_c在研究弧段内可近似为惯性系，地球重力以点质量两体模型为主（常数G_m给定），对卫星和飞行器在所研究时间尺度内采用二体动力学传播，必要时在拟合残差较大时再引入J2或大气阻力项。观测时间同步，测量噪声为零均值独立高斯白噪声，系统误差在每颗卫星上为常数且仅表现为像面内两个平移与一点旋转（小角近似适用）。UEN（UP, EAST, NORTH）坐标系的建立：给定卫星位置向量 r_s (基础系)，取单位向量 u = r_s/|r_s| 作为本地UP（X_s），地球自转轴单位向量 k = (0,0,1) 作为参考，用 y_s = normalize(cross(k,u)) 作为EAST，z_s = cross(u,y_s) 作为NORTH，形成从本地UEN到惯性系的正交矩阵 R_s。观测模型中给出alpha = y_s/x_s, beta = z_s/x_s，其中向量 v_s = [x_s,y_s,z_s]^T = R_s^T (r_target - r_s).\n\n观测方程与系统误差参数化。在无系统误差情况下，测量为 m = h(r_target; r_s) + ε = [y_s/x_s; z_s/x_s] + ε，其中 r_target 是飞行器在基础系的位置。若考虑系统误差，把卫星i在像面上的两个平移偏置 t_i = [tα_i, tβ_i]^T 和小旋转 θ_i 作为常量，观测模型采用小角近似的仿射变换： m_obs = R(θ_i) * m_true + t_i + ε ≈ m_true + t_i + θ_i * J * m_true + ε，其中 J = [[0,-1],[1,0]]. 用显式形式即为： α_obs = α_true + tα + θ*(-β_true) + noise； β_obs = β_true + tβ + θ*(α_true) + noise。该线性近似在θ小（工程上常为亚度量级）时精度足够，且便于雅可比推导和最小二乘求解；若角度较大可用完整旋转矩阵替代。\n\n瞬时逐点交汇定位（初估）。给定在同一时刻两颗卫星i,j的惯性位置 r_si, r_sj 和对应测得的像面比值构造本地方向单位矢量 d_i = normalize([1, α_i, β_i]) 在卫星i本地UEN系中；将其映射到惯性系得 D_i = R_si * d_i。两条射线 L_i(λ) = r_si + λ D_i 与 L_j(μ) = r_sj + μ D_j 一般为异面直线，逐点定位即求最小化 ||r_si + λ D_i - r_sj - μ D_j||^2 的λ,μ，其解由2×2线性系统给出（可解析求解）。两直线最近点中点作为位置估计 p_est，最近点间距作为几何残差。对全观测时间序列得到的逐点估计再用有限差分或小窗口多项式拟合得到速度初估。该逐点交汇法简单、直观，并提供几何条件数（如两射线夹角）作为不确定性指标；但不能在有系统误差时区分常偏置与目标真实位置。\n\n动力学联合估计（批量最小二乘）。为提高精度并在单星情形下获得可识别解，采用批量非线性最小二乘直接拟合观测序列，参数向量包含被估轨道的初始状态 X0 = [r0; v0]（必要时还可加入变质量/推力参数）、以及各观测卫星的系统误差参数集合 {tα_i,tβ_i,θ_i}（需要估计时加入）。对每个观测时刻t_k，通过数值积分（推荐采用自适应步长的Runge–Kutta 4/5 如Dormand-Prince或高阶对称方法）由X0得到飞行器位置 r(t_k)。对每个观测卫星，利用卫星位置 r_s(t_k)（由satinfo用二体方程(2)前向传播得到）计算本地坐标 v_s = R_s^T (r(t_k)-r_s) 并得到预测测量 h(r) = [y/x; z/x]，随后应用系统误差仿射变换得到预测量 m_pred。构造全局目标函数 J(θ) = Σ_k Σ_obs ||m_obs(k) - m_pred(k; θ)||^2 weighted，θ为所有待估参数。采用Levenberg–Marquardt或稀疏Gauss–Newton解此非线性最小二乘问题。为高效计算雅可比，采用链式法则：∂m/∂X0 = ∂m/∂r(t_k) · Φ(t_k,t0) 其中 Φ 是状态转移矩阵（可通过线性化方程的变分方程同时积分获得），∂m/∂r(t_k) 可由复合导数显式给出（因m是y/x,z/x的比值，导数形式简单）。系统误差参数对观测的偏微分也可直接给出（平移对测量的偏导为单位，旋转按线性近似给偏导）。该批量方法天然能将几何瞬时信息与动力学约束兼顾，从而在单卫星场景下也能通过跨时刻动力学耦合辨识出三维状态；当把卫星偏置参数包含进估计时，常量偏置与轨道参数的可辨识性由观测时序长度、观测视角变化与噪声水平决定。\n\n系统误差的可观测性与联合估计策略。是否能同时估计系统误差取决于信息独立性：在任意时刻，仅两颗卫星的观测足以定位位置但无法区分恒定的像面偏置与目标位置同向偏移；但在多时刻且卫星相对几何（视角向量）随时间变化时，偏置对观测的投影模式固定而目标轨迹随动力学约束变化，从而在长弧或合适观测几何下可辨识。为提高可观测性建议把多时刻、多目标观测联合起来估计：把同一卫星对多个目标的观测共享该卫星的系统偏置参数，从而通过不同目标不同轨迹的观测投影增加对偏置的约束。数值上推荐采用稀疏因子图或稀疏Gauss–Newton框架（如在SLAM/视觉规模中常用），并对偏置参数使用适当先验（基于工程经验的方差）以稳定求解。若可用，加入第三颗或更多卫星观测显著增强辨识性并降低相关性。\n\n单星观测情形与先验正则化。对于09号单星观测的01号飞行器，应采用动力学严密的批量拟合，其中系统误差可作为未知常量并通过先验约束（Tikhonov正则化或高斯先验）和较长弧的动力学耦合来估计。务必检查参数相关矩阵与条件数，必要时固定某些偏置分量或引入外部先验以保证可解。若目标处在主动推力段且模型含不可辨识的推力/质量耦合项，则需要把推力参数化为低维时间函数（如常值或线性函数）并评估可观测性。\n\n数值实现建议与计算效率。建议在Matlab或C++中实现：用精确二体解析传播或高精度数值积分传播观测卫星位置；用自适应RK45整合被观测体的动力学与变分方程以得到状态转移矩阵；用稀疏线性代数高效求解Gauss–Newton法中的正规方程，或用LM方法结合信赖域策略。对雅可比优先采用解析导数以提高收敛速度，并并行化观测时间点的投影与残差计算以加速。预期计算资源轻到中等（几十到几百MB内存，CPU数核足以），精度通过积分公差与LM终止阈值控制以实现所需的六位有效数字输出。\n\n不确定性量化、验证与敏感性分析。用逆Hessian近似得到参数协方差估计并计算95%置信区间；用Fisher信息/CRLB分析理论精度界限并评估设计（观测频率、卫星视角）对精度的影响；用蒙特卡洛模拟多次随机噪声抽样评估算法的稳健性与偏差；对关键假设（如系统误差为常量、二体模型精确性）做灵敏度分析，检查残差自相关与统计一致性。验证可以通过留下交叉验证集（如去掉部分观测时间点）并检验轨道预报能力，或与逐点交汇初估比较残差与不一致性。\n\n扩展与改进方向。若需要可把二体模型扩展为包含J2、月太阳引力或大气阻力的更高阶动力学，或把系统误差建模为随时间缓慢变化的随机游走过程并用滤波器在线估计（扩展卡尔曼滤波、无迹卡尔曼或粒子滤波）。在多目标多卫星场景下，构建统一的因子图进行联合批量估计可显著增强平台偏置估计精度。为实时应用，建议用滑动窗口批量优化或递归滤波器，并用观测信息熵/条件数监测观测几何质量以决定是否接受估计或请求更多观测。最终，本模型兼顾物理可解释性与数值可行性，能在题目所给数据条件下产生可复现的数值结果（包括09号卫星在指定时刻的位置、06与09对0号的逐点定位与动力学联合估计、两颗卫星的系统误差估计及01号在09号单星下的轨道估计），并为进一步扩展（更复杂动力学、在线滤波、联合多目标估计）提供清晰的路径与实现细节。",
  "task_descriptions": [
    "子任务1（卫星轨道传播与本地UEN基建立）—— 范围与目标：从提供的 satinfo.txt 中读取编号为09的观测卫星在 t=0 时刻的基础坐标系初始状态（文件按行给出卫星编号从0开始，每行六列：x,y,z,vx,vy,vz；编号09对应文件第10行），以两体点质量模型 d^2r/dt^2 = −G_m r/|r|^3（取常数 G_m = 3.986005e14 m^3/s^2，单位：秒、米、米/s）在惯性地心系内向前传播该卫星状态，精确计算并输出该卫星在时刻 t = 50.0, 100.0, 150.0, 200.0, 250.0 s 的三维位置（以米为单位，结果保留6位有效数字）；同时为每一时刻构造卫星本地的UEN坐标系并输出对应的从UEN到惯性系的正交旋转矩阵。 必要步骤与方法：1) 读入 satinfo.txt，取第10行的初始位置向量 r(0) 和速度向量 v(0)；2) 采用数值或解析两体传播器将状态从 t=0 精确推进到目标时刻——首选数值方法为自适应步长的 Runge–Kutta–Dormand–Prince (RK45) 整合器，建议相对容差 reltol=1e-12、绝对容差 abstol=1e-9，并确保求解器在每个目标时刻给出状态值（直接在步长控制中结束于目标时刻或用高精度插值返回）；作为可选替代，若实现便利可使用开普勒（Kepler）解析传播（通用异常量方法）以获得更高精度和效率；3) 对每个输出时刻计算位置 r_s(t) 并记录其模长 |r_s|；4) 在每个时刻构造UEN基：定义单位向量 X_s = r_s/|r_s|（UP，指向远离地球中心为正），取地球自转轴常矢 k = (0,0,1)^T，计算 Y_s = normalize(cross(k, X_s))（EAST）；为避免极区退化，当 |cross(k,X_s)| 小于阈值（例如 1e-8）时改用备用参考向量（例如 [0,1,0]）代替 k 进行叉乘；最后 Z_s = cross(X_s, Y_s)（NORTH），并将旋转矩阵 R_s 组成为列向量 [X_s, Y_s, Z_s]（或按约定方向形成行/列），该矩阵将UEN坐标向量映射到惯性地心系；5) 格式化并输出每个时刻的 r_s(t)（三个分量，米，六位有效数字）和对应的 R_s，以及用于再现结果的器件与数值参数（所用 G_m、积分器类型与容差、文件行索引规则、单位约定、极区处理方法）。 必要的输入与输出：输入为 satinfo.txt（每行六列，编号自0），常数 G_m 与待计算的五个时间点；输出为五组（r_x,r_y,r_z）位置向量（米，6位有效数字）、每时刻的 UEN→惯性旋转矩阵 R_s、以及可选的速度向量 ṙ(t)（若积分器同时返回速度）。 可复现性提示：明确记录所用的积分器及其容差、时间步终止策略或插值方法、极区叉乘降级规则与坐标约定（单位与坐标轴方向），以保证独立实现能得到一致结果。",
    "子任务2（观测模型与逐点交汇定位）：本子任务的目标是利用已由子任务1得到的两颗观测卫星（编号06与09）在每一观测时刻的惯性系位置 r_si(t) 和对应的本地UEN→惯性旋转矩阵 R_si(t)，以及两颗卫星的仿真观测文件 meadata_06_00.txt、meadata_09_00.txt 中按时刻给出的观测量 (t, α, β)，在每个同步观测时刻通过“两条射线最近点”法求取被观测飞行器（编号0）的逐时刻三维位置初估 p_est(t)、相应的几何残差，并在给定采样时刻区间（题目要求的 50.0s 到 170.0s，步长 10.0s）上由位置序列导出速度估计与观测残差；为此应按以下精确步骤实现：首先在数据准备阶段，读入两颗卫星在每个观测时刻的 r_si(t) 与 R_si(t)（若两颗卫星观测时刻不完全一致，应在保证数值精度的前提下将观测时间对齐——采用对观测量线性或高阶插值以获得共同观测时刻的 α,β，或仅采用两文件的交集时间点）；然后对每个共同时刻 t_k，从观测量构造卫星本地视向矢量 d_local = [1, α, β]^T 并将其归一化为单位向量 û_local = d_local/||d_local||（归一化有利于几何度量一致性），再通过惯性映射 D_i = R_si(t_k) * û_local_i 得到在惯性系下的单位观测方向向量 D_i (i=06,09)；接着以参数 λ, μ 定义两条射线 L_i(λ)=r_si+λ D_i 与 L_j(μ)=r_sj+μ D_j，构造并解析求解最小化 ||r_si+λ D_i - r_sj - μ D_j||^2 的线性方程组：设 w0 = r_si - r_sj，a = D_i·D_i, b = D_i·D_j, c = D_j·D_j，则解 λ,μ 满足 a λ - b μ = -D_i·w0 和 b λ - c μ = -D_j·w0（用矩阵解法求 λ,μ，注意检测行列式 |a(-c)-(-b)(b)|=a c - b^2 的数值大小以判定病态）；计算最近点 p_i = r_si + λ D_i 与 p_j = r_sj + μ D_j，取 p_est = (p_i + p_j)/2 作为该时刻的三维位置估计，并以 d_geom = ||p_i - p_j|| 作为几何残差/定位不确定性指标；同时计算两射线夹角 θ = arccos(D_i·D_j) 或用叉积模量判断观测几何质量，并对病态情形（如 θ 接近 0 或 det 接近 0 或 p_est 在任一卫星的 X_s 分量 x_s 非正或接近零）标注为不可靠或剔除。随后把 p_est 投影回每颗卫星的本地UEN系以计算测量重投影残差：v_s = R_si(t_k)^T (p_est - r_si(t_k))，得到 α_pred = v_s_y / v_s_x，β_pred = v_s_z / v_s_x（注意处理 v_s_x ≈ 0 的数值情况），观测残差为 Δα = α_obs - α_pred，Δβ = β_obs - β_pred；记录每颗卫星的 Δα, Δβ 及其二范数或加权范数作为测量残差。对速度估计，在所需的采样序列（50,60,…,170 s）上采用中心差分（内部点用 v_k = (p_{k+1}-p_{k-1})/(2Δt)，端点用一侧差分 v_0 = (p_1-p_0)/Δt 等）来计算线速度分量，并在必要时先对位置序列做低阶平滑（例如用三点滑动平均或局部二次多项式拟合）以抑制观测噪声放大差分而致的误差；所有差分与平滑应保持时间单位为秒、距离为米。最后按题目输出格式为每个采样时刻生成一行记录：时间 t、位置 p_est(x,y,z)（米，保留所需有效位数）、速度 v_est(vx,vy,vz)（米/秒）、几何残差 d_geom（米）、两颗卫星的投影残差 Δα,Δβ 以及观测几何质量指标（射线夹角 θ 或行列式值），并把时间-位置与时间-速度序列保存为可用于绘图的数据文件；实现工具建议使用具备线性代数与数值插值能力的环境（例如 MATLAB、Python+NumPy/SciPy 或等价的数值库），并在实现中加入对数值病态、时间对齐和异常样本剔除的明确判定与日志记录。",
    "子任务3（动力学约束的批量联合估计与系统指向误差辨识）要求以批量非线性最小二乘框架同时估计被观测飞行器的轨道初始状态与若观测卫星存在的恒定三轴指向误差（每颗卫星用三个常数参数表示：像面两方向平移 tα,tβ 及面内小角旋转 θ），其输入为：按时间序列给定的观测数据集（每条观测记录包含观测时刻 t 与测得的归一化像面比值 α,β，并需按时刻与动力学传播结果对齐）、每颗观测卫星在所有观测时刻的惯性位置 r_s(t) 与对应的本地UEN→惯性旋转矩阵 R_s(t)、以及物理常数（例如地球引力常数 G_m）；输出为待估参数向量 Θ（至少包含目标初始状态 X0=[r0;v0] 和每颗卫星的偏置向量 [tα,tβ,θ]），其最优值的协方差估计、观测残差时间序列及收敛诊断。方法步骤为：1) 明确观测算子與偏置模型——给定任意时刻 t，目标在惯性系的位置 r(t) 由从 X0 用二体动力学数值积分得到；在卫星 s 的本地坐标中 v_s = R_s(t)^T ( r(t) − r_s(t) )，记其分量为 x,y,z，则无偏观测为 α_true = y/x 和 β_true = z/x，同时用小角线性化模型将卫星偏置加入观测：α_pred = α_true + tα − θ·β_true，β_pred = β_true + tβ + θ·α_true（该线性化在 θ 很小时准确）；2) 构造残差矢量 r = stacked( m_obs − m_pred(Θ) ) 并用测量协方差构造加权二次目标函数 J(Θ)=r^T W r；3) 为高效求解，按迭代增量法（如 Levenberg–Marquardt 或 Gauss–Newton 带阻尼）线性化观测方程并在每次迭代计算雅可比矩阵 ∂r/∂Θ；其中对轨道初始状态 X0 的导数通过链式法则给出 ∂m/∂X0 = (∂m/∂r(t)) · Φ(t,t0) ，Φ(t,t0) 为从初始时刻到 t 的状态转移矩阵（需通过同时积分动力学方程与其变分方程获得）；对卫星偏置参数的偏导可直接解析给出（对 tα,tβ 的偏导为单位，对 θ 的偏导为 [−β_true; α_true]）；而 ∂m/∂r(t) 可由 α=y/x,β=z/x 的解析导数表示为 ∂α/∂r = (1/x) ∂y/∂r − (y/x^2) ∂x/∂r，且对局部坐标分量相对于惯性位置的导数等于 R_s(t)^T 的相应行。4) 形成正规方程 (J^T W J + λ diag(J^T W J)) ΔΘ = −J^T W r（LM阻尼 λ 可调整），求解增量 ΔΘ，更新 Θ ← Θ + ΔΘ，重复直到收敛（建议相对增量范数或目标函数下降小于 1e−6，或最大迭代次数 100）；数值积分建议使用高精度自适应 RK（例如 Dormand–Prince）并同时积分变分方程以获得 Φ，积分公差建议 reltol 1e−12、abstol 1e−9（可按实现调整）；5) 收敛后用近似 Hessian H = J^T W J 的逆或广义逆估计参数协方差，报告各参数的标准差和参数相关性；6) 为应对不可辨识或病态情况（例如观测几何不足导致 J^T W J 条件数过大），实现诊断与稳健化措施：计算正规方程条件数并在必要时通过增加先验（Tikhonov 正则化或给偏置施加工程先验方差）、降低待估偏置维度（固定某些偏置为零）或合并更多观测（时序更长或引入其他目标/卫星的数据）来改善可观测性；同时建议实施基于残差的异常值剔除（基于卡方检验）以提升鲁棒性。该子任务应明确记录数值设置、初始猜测（X0 可由逐点定位或轨道解析近似给出，偏置初值常置零）、权重矩阵设定、收敛准则和条件数阈值，并输出最终估计参数、观测重投影残差、参数协方差及可观测性/条件性诊断结果，以便对估计可信度与潜在退化模式进行定量评估。",
    "子任务4的目标是把前述算法工程化为一套可复现、可验证并带不确定度量化的计算流程和软件模块，输入为 satinfo.txt 与相应 meadata_*.txt 文件，输出为（1）09号卫星在指定时刻的位置信息文件；（2）按采样时刻给出的目标位置-速度估计表格及重投影残差文件；（3）参数协方差/置信区间与诊断报告；（4）六张时序图（t-x,t-y,t-z,t-vx,t-vy,t-vz）和若干残差统计图；（5）完整运行日志与配置文件以保证可复现。为实现上述目标，软件应按功能模块化实现：文件I/O模块（解析 satinfo.txt 与 meadata 文件并做时间对齐/插值）；数值传播模块（两体动力学 ODE 求解器，优先选用自适应步长 RK45/Dormand–Prince，推荐初始容差 reltol=1e−12、abstol=1e−9，并提供可选的开普勒解析传播作为对照）；变分方程模块（同时积分线性化变分方程以获得状态转移矩阵 Φ，用于雅可比计算）；逐点几何定位模块（两射线最短连线解析解及几何质量判据）；批量优化模块（实现 Levenberg–Marquardt 或 Gauss–Newton + 阻尼，解析雅可比以提高效率，LM 收敛阈值建议相对参数增量或目标函数下降 <1e−6，最大迭代 100）；数值线性代数模块（支持稀疏/密集矩阵求解、SVD 与条件数估计，允许正则化或先验的注入以处理病态问题）；诊断与不确定性模块（计算近似海森矩阵 H=J^T W J 的逆以给出协方差与参数标准差，报告规范化残差直方图、卡方检验结果、正规方程条件数与奇异值谱）；蒙特卡洛模块（可选，默认 N=100 用以估计估计量稳健性并输出参数分布）；可视化模块（生成并保存时间序列图、残差图与参数相关矩阵图）；以及运行控制与日志模块（读取单独配置文件以控制积分容差、优化参数、权重矩阵、随机种子和并行度，并将运行环境版本信息与关键数值参数记录于日志以便重现）。实现建议与工具：优先使用 Python（NumPy/SciPy/pandas/matplotlib），优化器可选 SciPy.optimize 或 lmfit；若需更高性能建议 C++ 与 Eigen + Ceres + Boost.odeint；所有数值计算应统一使用 SI 单位并在输出中注明；程序应对异常数值情况（如 x_s≈0、射线几何退化、正规方程条件数过大）做自动检测并在日志中记录，同时提供稳健化选项（如添加先验正则化、固定部分偏置或降低估计维度）。验证策略必须包括：单元测试（IO、传播器与雅可比的相互一致性）、保守性检验（两体传播的能量/角动量守恒在允许误差内）、重投影一致性（观测与预测残差统计检验应匹配假定噪声谱）、以及蒙特卡洛/留一法交叉验证；所有测试结果应输出成报告并由脚本可重现。输出格式应为机器可读的 CSV/JSON（结果、残差、协方差矩阵）和高分辨率 PNG 图形，代码仓库需包含 README、示例运行脚本与配置模板、版本锁定信息与随机种子控制以确保完全可复现；此外应提供运行时间与硬件要求说明，并建议在评估参数可观测性时计算正规方程的条件数与参数相关矩阵，以决定是否需要引入先验或扩展观测集合。"
  ]
}