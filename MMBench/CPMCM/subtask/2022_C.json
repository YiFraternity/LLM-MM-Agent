{
  "tasks": [],
  "problem_str": "问题背景：\n汽车制造厂主要由焊装车间、涂装车间、总装车间构成，每个车间有不同的生产偏好，如：焊装车间由于车身夹具的限制偏向最小车型及配置切换生产，涂装车间由于喷漆（固定每5辆车清洗喷头、颜色切换也需清洗喷头）限制偏向颜色以5的倍数切换生产，总装车间由于人员工时（不同车型及配置人员工时不同）及硬件（零部件数量等）等限制偏向按照车型及配置按比例切换生产。\n\n由于各车间的约束不同导致生产调度无法按照同一序列连续生产，特别是涂装车间与总装车间序列差异较大，这就需要在两个车间之间建立一个具有调序功能的缓存区，即PBS（Painted Body Store，汽车制造涂装-总装缓存调序区），用来将涂装车间的出车序列调整到满足总装车间约束的进车序列。\n\n目前，一天安排上线生产的车辆数介于200-450之间，对于每天要上线生产的车辆，车型、颜色等属性均有变化，目前车型大类有2种，颜色大约有10种，各个车间的产能不定，主要根据当天生产安排调整，涂装车间及总装车间的工艺流程如下：\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image.png}\n    \\caption{涂装车间工艺流程图}\n    \\label{fig:paint_process}\n\\end{figure}\n\n\\begin{itemize}\n\n    \\item 涂装车间处理喷漆工艺，主要是将涂料涂覆于白车身表面，最终形成涂膜或者漆膜或者涂层。涂装车间的详细流程如图1所示，主要是将白车身经过前处理电泳-中涂-色漆-清漆，最终得到修饰完整的车身。\n    \\item 总装车间处理装配工艺，主要是组装剩余零部件，得到最终成品车辆。总装车间的详细流程如图 2 所示，主要由内饰线、底盘线、最终线组成，最终经过测试检验后，成品车辆下线入库。\n\\end{itemize}\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image2.png}\n    \\caption{总装车间工艺流程图}\n    \\label{fig:2}\n\\end{figure}\n\n\\section{问题描述}\n\n根据涂装车间的出车序列通过 PBS 调度调整得到总装车间的进车序列。PBS 具体信息如表 3 所示。\n\n\\begin{table}[h]\n    \\centering\n    \\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|}\n        \\hline\n        & 10 & 9 & 8 & 7 & 6 & 5 & 4 & 3 & 2 & 1 & \\\\\n        \\hline\n        进车道6 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        进车道5 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        返回道 & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & \\\\\n        \\hline\n        进车道4 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & 送车横移机 \\\\\n        \\hline\n        涂装-PBS 接车横移机 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & PBS-总装 \\\\\n        \\hline\n        进车道3 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        进车道2 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        进车道1 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n    \\end{tabular}\n    \\caption{涂装-总装缓存调序区（PBS）示意图}\n    \\label{tab:3}\n\\end{table}\n\nPBS 由涂装-PBS 出车口、接车横移机、进车道 6 条（每条进车道有 10 个停车位、FIFO 结构）、返回道 1 条（有 10 个停车位）、送车横移机及 PBS-总装接车口等7个区域组成。各车道距离等分，每车道宽度2米，两相邻车道间间隔1米。横移机运动时的速度保持一致。\n\n 数据示例：\\begin{tabular}{|c|c|c|c|}\n\\hline\n进车顺序 & 车型 & 动力 & 驱动 \\\\\n\\hline\n1 & A & 混动 & 两驱 \\\\\n\\hline\n2 & B & 混动 & 两驱 \\\\\n\\hline\n3 & A & 燃油 & 两驱 \\\\\n\\hline\n4 & B & 燃油 & 两驱 \\\\\n\\hline\n5 & A & 燃油 & 四驱 \\\\\n\\hline\n6 & B & 燃油 & 四驱 \\\\\n\\hline\n\\end{tabular}\n\nPBS接车横移机：\n1. 将车身从涂装-PBS出车口运送到合适进车道。\n2. 将车身从返回道运送到合适进车道。\n\nPBS送车横移机：\n1. 将所选择车身从进车道运送到PBS-总装接车口。\n2. 将需调序车身从进车道运送到返回道。\n\nPBS约束说明：\n1. 送车横移机不能将返回道的车身送入PBS-总装接车口。\n2. 车身在进车道和返回道的移动方向为图中标注方向，不得改变。\n3. 接车横移机和送车横移机上同一时刻分别最多有一个车身。\n4. 接车横移机和送车横移机在完成任意动作后，必须返回中间初始位置，才可以执行下一步动作。\n5. 接车横移机和送车横移机在执行任何动作过程中，均不能被打断。\n6. 当返回道10停车位有车身，同时接车横移机空闲时，优先处理返回道10停车位上的车身。\n7. 当若干进车道1停车位有车身等候，同时送车横移机空闲时，优先处理最先到达1停车位的车身。\n8. 如果任意进车道1停车位有车身，那么送车横移机不能设置为空闲状态。\n9. 进车道和返回道每个时刻最多容纳10个车身，每个停车位最多容纳1个车身。\n10. 同一车道内，多个车身在不同停车位上的移动可以不同步进行。\n11. 当某车身所在停车位的下一停车位出现空位时，车身必须立即开始向下一停车位移动。\n12. 车身在进车道和返回道不同停车位之间移动的过程中，不能被调度。\\begin{itemize}\n    \\item \\textbf{PBS相关时间数据说明：}\n    \\begin{enumerate}\n        \\item 假定车身由横移机卸载到各进车道10停车位或返回道1停车位，以及由各进车道1停车位或返回道10停车位装载到横移机上的时间均可忽略。\n        \\item 假定车身在涂装-PBS出车口处装载到接车横移机上，以及在4车道出口中间位置处，车身由送车横移机上卸载到PBS-总装接车口，时间均可忽略。\n        \\item 进车过程：任意车身到达涂装-PBS出车口时，处于最中间位置，正对进车道4，接车横移机把车身从该位置运送至不同进车道10停车位并返回至初始位置，对于1-6进车道，消耗时间分别为[18, 12, 6, 0, 12, 18]秒。\n        \\item 出车过程：送车横移机从中间初始位置出发，把各进车道1停车位的车身运送至总装-PBS接车口，处于最中间位置，正对进车道4，对于1-6进车道，消耗时间分别为[18, 12, 6, 0, 12, 18]秒。\n        \\item 车进返回道过程：在有需要时，送车横移机从中间初始位置出发，把各进车道1停车位的车身，运送至返回道1停车位，并返回至初始位置，对于1-6进车道，消耗时间分别为[24, 18, 12, 6, 12, 18]秒。\n        \\item 车出返回道过程：接车横移机从中间初始位置出发，把返回道10停车位的车身，运送至任意进车道10停车位并返回至初始位置，对于1-6进车道，消耗时间分别为[24, 18, 12, 6, 12, 18]秒。\n        \\item 车移动过程：任意车身在进车道/返回道中，从某一停车位移动至后一停车位，消耗时间为9秒。\n    \\end{enumerate}\n    \\item \\textbf{可选的调度手段：}\n    \\begin{enumerate}\n        \\item 接车横移机将当前涂装-PBS出车口队列第一个车身或者返回道10停车位的车身送入任意进车道的10停车位。\n        \\item 送车横移机将任意进车道1停车位的车送入返回道1停车位或者PBS-总装接车口。\n        \\item 接车横移机和送车横移机均可以在一段时间内被设置为空闲状态。\n    \\end{enumerate}\n    \\item \\textbf{输入输出：}\n    \\begin{enumerate}\n        \\item 输入：涂装出车序列清单，可提供多个数据清单。\n        \\item 输出：每个车身在每一秒所处的区域（涂装-PBS出车口、接车横移机、任意进车道任意停车位、返回道任意停车位、送车横移机、PBS-总装接车口），可构建二维矩阵，里面存储区域代码（如 200 辆车在第 1000 秒完成全部调度，则需提交 200*1000 的矩阵）。矩阵中每一个值为各个区域代码，总的区域代码有 74 个，区域与代码的对应关系见附件 3。车身不在上述 74 个区域时，对应矩阵值为空白。具体的输出模板文件见附件 4（模板文件只是一个示意，示意的场景是 50 个车身在第 100 秒完成全部调度，每行代表每个车身各个时间点所处区域，每列代表每个时间点各车身所处区域，其中区域代码没具体填写，具体区域代码见附件 3；具体的输出矩阵，需要根据实际数据和算法计算得到，相关数据见附件 1-3，附件 4 只是示意，不代表本题只有 50 个车身）。由于 PBS 相关时间说明第 1、第 2 两条假设，会出现同一时刻车身处于若干不同区域的情形，则在输出矩阵该车身该时刻对应格子中填入这些区域中最后一个区域的代码。例如，第 0 秒，如果涂装-PBS 出车口第一个车身（1 号车身）被装载到接车横移机上，接着被卸载到 4 进车道 10 号车位，则在 1 号车身第 0 秒格子中填入 4 进车道 10 号车位的区域代码“410”；又例如，第 75 秒，如果 5 号车身从送车横移机上被卸载到 PBS-总装接车口，则在 5 号车身第 75 秒格子中填入 PBS-总装接车口区域代码“3”。\n    \\end{enumerate}\n\n\n问题要求：\n\\section*{优化目标：}\n1. 混动车型间隔 2 台非混动车型为优，权重系数 0.4。\n2. 四驱车型与两驱车型倾向 1:1 出车序列，权重系数 0.3。\n3. 返回道使用次数倾向于 0，权重系数 0.2。\n4. 倾向总调度时间越短越好，权重系数 0.1。\n\n注：该权重系数用于多目标得分加权，各权重系数相加等于 1。\n\n\\section*{优化目标具体量化逻辑：}\n设置每个优化目标初始分，根据下述逻辑更新得分后，再乘以相应系数，得到最终加权总分（理论最高分 100 分）。\n\n1. 优化目标 1（权重系数 0.4，初始分 100 分）：检查出车序列，找到所有混动车身，从出车序列头部按照先后顺序开始算，计算每连续两辆混动车身之间的非混动车身数，不等于 2 则扣 1 分。\n\n2. 优化目标 2（权重系数 0.3，初始分 100 分）：对出车序列进行分块，判断每一分快中的四驱车型与两驱车型之比是否满足 1:1，若不满足，则扣 1 分。对出车序列分块的依据是：如果序列以 4 开头，则根据从 2 变为 4 将序列进行分块；如果序列以 2 开头，则根据从 4 变为 2 将序列进行分块。例如：如果出车序列为 442242444224（4 代表四驱车型，2 代表两驱车型），则该序列分块结果为：4422，42，44422，4，最后两个分块 44422 和 4 都不满足 1:1，扣 2 分。\n\n3. 优化目标3（权重系数0.2，初始分100分）：统计返回道使用次数，每使用一次扣1分。\n\n4. 优化目标4（权重系数0.1，初始分为100分）：假设出车队列长度为$C$，第一辆车身进入涂装-PBS出车口时刻记为零，以最后一个车身进入PBS-总装接车口的时刻$T$为总完成时间，其理论最快完成时间为$9C+72$（全部走进车道4，出车序列与入车序列相同），其时间惩罚值设置为$0.01 \\times (T - 9C - 72)$，最后目标得分为$100 - $时间惩罚值。\n\n\\section*{请建模完成以下优化问题：}\n\n\\textbf{问题1：} 严格按照PBS约束说明及相关时间数据说明，根据涂装出车序列，考虑PBS区域调度能力及限制，建立PBS优化调度模型，使得总装进车序列尽可能满足总装生产需求。给出将你们的优化调度方案分别应用于附件1和附件2数据的得分结果，并将使用附件1和附件2两套数据的调度输出结果按照附件4格式分别存入result11.xlsx和result12.xlsx。\n\n\\textbf{问题2：} 如果去除PBS约束说明中第6、7两条约束，其余约束不变，根据涂装出车序列，考虑PBS区域调度能力及限制，建立PBS优化调度模型，使得总装进车序列尽可能满足总装生产需求。给出将你们的优化调度方案分别应用于附件1和附件2数据的得分结果，并将使用附件1和附件2两套数据的调度输出结果按照附件4格式分别存入result21.xlsx和result22.xlsx。\nAddendum: \n\\textbf{参考文献：}\n\\begin{enumerate}\n    \\item Zohali H, Reformulation, linearization, and a hybrid iterated local search algorithm for economic lot-sizing and sequencing in hybrid flow shop problems. Computers \\& Operations Research, 2019, 104:127-138.\n    \\item Shen Z, Tang Q, Huang T. Dynamic Production Scheduling Modeling and Multi-objective Optimization for Automobile Mixed-Model Production. Communications in Computer and Information Science, 2018, 924:25-33.\n    \\item Jalilvand-Nejad A, Fattahi P. A mathematical model and genetic algorithm to cyclic flexible job shop scheduling problem. Journal of Intelligent Manufacturing, 2015, 26(6):1085-1098.\n\\end{enumerate}\\begin{enumerate}\n    \\item Boysen N, Zenker M. A decomposition approach for the car resequencing problem with selectivity banks. Computers \\& Operations Research, 2013, 40(1): 98-108.\n    \\item Yavuz, Mesut. Iterated beam search for the combined car sequencing and level scheduling problem. International Journal of Production Research, 2013, 51(12): 3698-3718.\n    \\item 陈正茂. 基于排序缓冲区的多车间关联排序研究[D]. 华中科技大学, 2008.\n\\end{enumerate}\nDataset Path:\n['附件1.xlsx', '附件2.xlsx', '附件3.xlsx', '附件4.xlsx']\n\nData Description:\n该数据集由四个附件组成，整体围绕汽车进场与调度序列、车型与动力/驱动属性以及车位与设备位置编码展开，适合用于生产调度、布局优化与装配线吞吐分析。附件1和附件2都记录了按“进车顺序”排列的车辆基本信息（包括车型、动力类型和驱动类型），可作为车辆属性表用于标识和过滤不同车型或动力/驱动组合的调度需求；附件3提供了不同进车道和返回道的停车位与设备位置描述及其唯一代码，包含涂装-PBS出车口、接车横移机、送车横移机和PBS-总装接车口等关键位置的空间编码，用于将车辆调度映射到工厂布局与设备资源；附件4的Sheet1则为车辆调度序列的宽表形式记录（第一列为行号，后续列以0–99编号表示多达100个调度字段或时间片/工位序列），适合用于分析序列模式、批次关系和多阶段路径。数据中主要变量为顺序标识（可作为主键或连接键）、类别型特征（车型、动力、驱动）、以及位置/设备编码（空间映射），数据类型以类别与序列/索引为主；在使用前建议统一字段命名、检查并处理缺失或不一致的进车顺序编号、将Sheet1的宽表转换为长表以便时间序列或路径分析，并核对附件间的主键一致性。基于该数据可开展的工作包括车辆进出序列可视化、装配线与搬运设备的负载/瓶颈分析、停车位与设备使用率评估、调度规则优化和仿真建模（例如最小化等待与横移次数、提高PBS与总装对接效率），同时需注意位置代码的空间语义与实际工位布局的对应关系以保证分析结果的可操作性。",
  "problem": {
    "background": "汽车制造厂主要由焊装车间、涂装车间、总装车间构成，每个车间有不同的生产偏好，如：焊装车间由于车身夹具的限制偏向最小车型及配置切换生产，涂装车间由于喷漆（固定每5辆车清洗喷头、颜色切换也需清洗喷头）限制偏向颜色以5的倍数切换生产，总装车间由于人员工时（不同车型及配置人员工时不同）及硬件（零部件数量等）等限制偏向按照车型及配置按比例切换生产。\n\n由于各车间的约束不同导致生产调度无法按照同一序列连续生产，特别是涂装车间与总装车间序列差异较大，这就需要在两个车间之间建立一个具有调序功能的缓存区，即PBS（Painted Body Store，汽车制造涂装-总装缓存调序区），用来将涂装车间的出车序列调整到满足总装车间约束的进车序列。\n\n目前，一天安排上线生产的车辆数介于200-450之间，对于每天要上线生产的车辆，车型、颜色等属性均有变化，目前车型大类有2种，颜色大约有10种，各个车间的产能不定，主要根据当天生产安排调整，涂装车间及总装车间的工艺流程如下：\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image.png}\n    \\caption{涂装车间工艺流程图}\n    \\label{fig:paint_process}\n\\end{figure}\n\n\\begin{itemize}\n\n    \\item 涂装车间处理喷漆工艺，主要是将涂料涂覆于白车身表面，最终形成涂膜或者漆膜或者涂层。涂装车间的详细流程如图1所示，主要是将白车身经过前处理电泳-中涂-色漆-清漆，最终得到修饰完整的车身。\n    \\item 总装车间处理装配工艺，主要是组装剩余零部件，得到最终成品车辆。总装车间的详细流程如图 2 所示，主要由内饰线、底盘线、最终线组成，最终经过测试检验后，成品车辆下线入库。\n\\end{itemize}\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image2.png}\n    \\caption{总装车间工艺流程图}\n    \\label{fig:2}\n\\end{figure}\n\n\\section{问题描述}\n\n根据涂装车间的出车序列通过 PBS 调度调整得到总装车间的进车序列。PBS 具体信息如表 3 所示。\n\n\\begin{table}[h]\n    \\centering\n    \\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|}\n        \\hline\n        & 10 & 9 & 8 & 7 & 6 & 5 & 4 & 3 & 2 & 1 & \\\\\n        \\hline\n        进车道6 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        进车道5 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        返回道 & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & \\\\\n        \\hline\n        进车道4 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & 送车横移机 \\\\\n        \\hline\n        涂装-PBS 接车横移机 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & PBS-总装 \\\\\n        \\hline\n        进车道3 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        进车道2 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        进车道1 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n    \\end{tabular}\n    \\caption{涂装-总装缓存调序区（PBS）示意图}\n    \\label{tab:3}\n\\end{table}\n\nPBS 由涂装-PBS 出车口、接车横移机、进车道 6 条（每条进车道有 10 个停车位、FIFO 结构）、返回道 1 条（有 10 个停车位）、送车横移机及 PBS-总装接车口等7个区域组成。各车道距离等分，每车道宽度2米，两相邻车道间间隔1米。横移机运动时的速度保持一致。\n\n 数据示例：\\begin{tabular}{|c|c|c|c|}\n\\hline\n进车顺序 & 车型 & 动力 & 驱动 \\\\\n\\hline\n1 & A & 混动 & 两驱 \\\\\n\\hline\n2 & B & 混动 & 两驱 \\\\\n\\hline\n3 & A & 燃油 & 两驱 \\\\\n\\hline\n4 & B & 燃油 & 两驱 \\\\\n\\hline\n5 & A & 燃油 & 四驱 \\\\\n\\hline\n6 & B & 燃油 & 四驱 \\\\\n\\hline\n\\end{tabular}\n\nPBS接车横移机：\n1. 将车身从涂装-PBS出车口运送到合适进车道。\n2. 将车身从返回道运送到合适进车道。\n\nPBS送车横移机：\n1. 将所选择车身从进车道运送到PBS-总装接车口。\n2. 将需调序车身从进车道运送到返回道。\n\nPBS约束说明：\n1. 送车横移机不能将返回道的车身送入PBS-总装接车口。\n2. 车身在进车道和返回道的移动方向为图中标注方向，不得改变。\n3. 接车横移机和送车横移机上同一时刻分别最多有一个车身。\n4. 接车横移机和送车横移机在完成任意动作后，必须返回中间初始位置，才可以执行下一步动作。\n5. 接车横移机和送车横移机在执行任何动作过程中，均不能被打断。\n6. 当返回道10停车位有车身，同时接车横移机空闲时，优先处理返回道10停车位上的车身。\n7. 当若干进车道1停车位有车身等候，同时送车横移机空闲时，优先处理最先到达1停车位的车身。\n8. 如果任意进车道1停车位有车身，那么送车横移机不能设置为空闲状态。\n9. 进车道和返回道每个时刻最多容纳10个车身，每个停车位最多容纳1个车身。\n10. 同一车道内，多个车身在不同停车位上的移动可以不同步进行。\n11. 当某车身所在停车位的下一停车位出现空位时，车身必须立即开始向下一停车位移动。\n12. 车身在进车道和返回道不同停车位之间移动的过程中，不能被调度。\\begin{itemize}\n    \\item \\textbf{PBS相关时间数据说明：}\n    \\begin{enumerate}\n        \\item 假定车身由横移机卸载到各进车道10停车位或返回道1停车位，以及由各进车道1停车位或返回道10停车位装载到横移机上的时间均可忽略。\n        \\item 假定车身在涂装-PBS出车口处装载到接车横移机上，以及在4车道出口中间位置处，车身由送车横移机上卸载到PBS-总装接车口，时间均可忽略。\n        \\item 进车过程：任意车身到达涂装-PBS出车口时，处于最中间位置，正对进车道4，接车横移机把车身从该位置运送至不同进车道10停车位并返回至初始位置，对于1-6进车道，消耗时间分别为[18, 12, 6, 0, 12, 18]秒。\n        \\item 出车过程：送车横移机从中间初始位置出发，把各进车道1停车位的车身运送至总装-PBS接车口，处于最中间位置，正对进车道4，对于1-6进车道，消耗时间分别为[18, 12, 6, 0, 12, 18]秒。\n        \\item 车进返回道过程：在有需要时，送车横移机从中间初始位置出发，把各进车道1停车位的车身，运送至返回道1停车位，并返回至初始位置，对于1-6进车道，消耗时间分别为[24, 18, 12, 6, 12, 18]秒。\n        \\item 车出返回道过程：接车横移机从中间初始位置出发，把返回道10停车位的车身，运送至任意进车道10停车位并返回至初始位置，对于1-6进车道，消耗时间分别为[24, 18, 12, 6, 12, 18]秒。\n        \\item 车移动过程：任意车身在进车道/返回道中，从某一停车位移动至后一停车位，消耗时间为9秒。\n    \\end{enumerate}\n    \\item \\textbf{可选的调度手段：}\n    \\begin{enumerate}\n        \\item 接车横移机将当前涂装-PBS出车口队列第一个车身或者返回道10停车位的车身送入任意进车道的10停车位。\n        \\item 送车横移机将任意进车道1停车位的车送入返回道1停车位或者PBS-总装接车口。\n        \\item 接车横移机和送车横移机均可以在一段时间内被设置为空闲状态。\n    \\end{enumerate}\n    \\item \\textbf{输入输出：}\n    \\begin{enumerate}\n        \\item 输入：涂装出车序列清单，可提供多个数据清单。\n        \\item 输出：每个车身在每一秒所处的区域（涂装-PBS出车口、接车横移机、任意进车道任意停车位、返回道任意停车位、送车横移机、PBS-总装接车口），可构建二维矩阵，里面存储区域代码（如 200 辆车在第 1000 秒完成全部调度，则需提交 200*1000 的矩阵）。矩阵中每一个值为各个区域代码，总的区域代码有 74 个，区域与代码的对应关系见附件 3。车身不在上述 74 个区域时，对应矩阵值为空白。具体的输出模板文件见附件 4（模板文件只是一个示意，示意的场景是 50 个车身在第 100 秒完成全部调度，每行代表每个车身各个时间点所处区域，每列代表每个时间点各车身所处区域，其中区域代码没具体填写，具体区域代码见附件 3；具体的输出矩阵，需要根据实际数据和算法计算得到，相关数据见附件 1-3，附件 4 只是示意，不代表本题只有 50 个车身）。由于 PBS 相关时间说明第 1、第 2 两条假设，会出现同一时刻车身处于若干不同区域的情形，则在输出矩阵该车身该时刻对应格子中填入这些区域中最后一个区域的代码。例如，第 0 秒，如果涂装-PBS 出车口第一个车身（1 号车身）被装载到接车横移机上，接着被卸载到 4 进车道 10 号车位，则在 1 号车身第 0 秒格子中填入 4 进车道 10 号车位的区域代码“410”；又例如，第 75 秒，如果 5 号车身从送车横移机上被卸载到 PBS-总装接车口，则在 5 号车身第 75 秒格子中填入 PBS-总装接车口区域代码“3”。\n    \\end{enumerate}\n",
    "problem_requirement": "\\section*{优化目标：}\n1. 混动车型间隔 2 台非混动车型为优，权重系数 0.4。\n2. 四驱车型与两驱车型倾向 1:1 出车序列，权重系数 0.3。\n3. 返回道使用次数倾向于 0，权重系数 0.2。\n4. 倾向总调度时间越短越好，权重系数 0.1。\n\n注：该权重系数用于多目标得分加权，各权重系数相加等于 1。\n\n\\section*{优化目标具体量化逻辑：}\n设置每个优化目标初始分，根据下述逻辑更新得分后，再乘以相应系数，得到最终加权总分（理论最高分 100 分）。\n\n1. 优化目标 1（权重系数 0.4，初始分 100 分）：检查出车序列，找到所有混动车身，从出车序列头部按照先后顺序开始算，计算每连续两辆混动车身之间的非混动车身数，不等于 2 则扣 1 分。\n\n2. 优化目标 2（权重系数 0.3，初始分 100 分）：对出车序列进行分块，判断每一分快中的四驱车型与两驱车型之比是否满足 1:1，若不满足，则扣 1 分。对出车序列分块的依据是：如果序列以 4 开头，则根据从 2 变为 4 将序列进行分块；如果序列以 2 开头，则根据从 4 变为 2 将序列进行分块。例如：如果出车序列为 442242444224（4 代表四驱车型，2 代表两驱车型），则该序列分块结果为：4422，42，44422，4，最后两个分块 44422 和 4 都不满足 1:1，扣 2 分。\n\n3. 优化目标3（权重系数0.2，初始分100分）：统计返回道使用次数，每使用一次扣1分。\n\n4. 优化目标4（权重系数0.1，初始分为100分）：假设出车队列长度为$C$，第一辆车身进入涂装-PBS出车口时刻记为零，以最后一个车身进入PBS-总装接车口的时刻$T$为总完成时间，其理论最快完成时间为$9C+72$（全部走进车道4，出车序列与入车序列相同），其时间惩罚值设置为$0.01 \\times (T - 9C - 72)$，最后目标得分为$100 - $时间惩罚值。\n\n\\section*{请建模完成以下优化问题：}\n\n\\textbf{问题1：} 严格按照PBS约束说明及相关时间数据说明，根据涂装出车序列，考虑PBS区域调度能力及限制，建立PBS优化调度模型，使得总装进车序列尽可能满足总装生产需求。给出将你们的优化调度方案分别应用于附件1和附件2数据的得分结果，并将使用附件1和附件2两套数据的调度输出结果按照附件4格式分别存入result11.xlsx和result12.xlsx。\n\n\\textbf{问题2：} 如果去除PBS约束说明中第6、7两条约束，其余约束不变，根据涂装出车序列，考虑PBS区域调度能力及限制，建立PBS优化调度模型，使得总装进车序列尽可能满足总装生产需求。给出将你们的优化调度方案分别应用于附件1和附件2数据的得分结果，并将使用附件1和附件2两套数据的调度输出结果按照附件4格式分别存入result21.xlsx和result22.xlsx。",
    "dataset_path": [
      "附件1.xlsx",
      "附件2.xlsx",
      "附件3.xlsx",
      "附件4.xlsx"
    ],
    "dataset_description": {
      "附件1": "附件1包含了车辆进车顺序、车型、动力类型和驱动类型的信息。",
      "附件2": "附件2包含了车辆进车顺序、车型、动力类型和驱动类型的信息。",
      "附件3": "附件3包含了不同进车道和返回道的停车位信息，以及涂装-PBS出车口、接车横移机、送车横移机和PBS-总装接车口的位置代码。",
      "附件4": "附件4包含一个名为Sheet1的工作表，内容为车辆调度序列数据。"
    },
    "variable_description": [
      {
        "进车顺序": "车辆进入的顺序编号。",
        "车型": "车辆的型号，如A、B等。",
        "动力": "车辆的动力类型，如燃油、混动等。",
        "驱动": "车辆的驱动类型，如两驱、四驱等。"
      },
      {
        "进车顺序": "车辆进入顺序的编号。",
        "车型": "车辆的型号，如A、B等。",
        "动力": "车辆的动力类型，如燃油、混动等。",
        "驱动": "车辆的驱动类型，如两驱、四驱等。"
      },
      {
        "区域": "表示停车位或设备的位置描述",
        "代码": "表示停车位或设备的唯一标识代码"
      },
      {
        "Unnamed: 0": "行号，表示每行数据的序号",
        "0": "第1列车辆调度数据",
        "1": "第2列车辆调度数据",
        "2": "第3列车辆调度数据",
        "3": "第4列车辆调度数据",
        "4": "第5列车辆调度数据",
        "5": "第6列车辆调度数据",
        "6": "第7列车辆调度数据",
        "7": "第8列车辆调度数据",
        "8": "第9列车辆调度数据",
        "9": "第10列车辆调度数据",
        "10": "第11列车辆调度数据",
        "11": "第12列车辆调度数据",
        "12": "第13列车辆调度数据",
        "13": "第14列车辆调度数据",
        "14": "第15列车辆调度数据",
        "15": "第16列车辆调度数据",
        "16": "第17列车辆调度数据",
        "17": "第18列车辆调度数据",
        "18": "第19列车辆调度数据",
        "19": "第20列车辆调度数据",
        "20": "第21列车辆调度数据",
        "21": "第22列车辆调度数据",
        "22": "第23列车辆调度数据",
        "23": "第24列车辆调度数据",
        "24": "第25列车辆调度数据",
        "25": "第26列车辆调度数据",
        "26": "第27列车辆调度数据",
        "27": "第28列车辆调度数据",
        "28": "第29列车辆调度数据",
        "29": "第30列车辆调度数据",
        "30": "第31列车辆调度数据",
        "31": "第32列车辆调度数据",
        "32": "第33列车辆调度数据",
        "33": "第34列车辆调度数据",
        "34": "第35列车辆调度数据",
        "35": "第36列车辆调度数据",
        "36": "第37列车辆调度数据",
        "37": "第38列车辆调度数据",
        "38": "第39列车辆调度数据",
        "39": "第40列车辆调度数据",
        "40": "第41列车辆调度数据",
        "41": "第42列车辆调度数据",
        "42": "第43列车辆调度数据",
        "43": "第44列车辆调度数据",
        "44": "第45列车辆调度数据",
        "45": "第46列车辆调度数据",
        "46": "第47列车辆调度数据",
        "47": "第48列车辆调度数据",
        "48": "第49列车辆调度数据",
        "49": "第50列车辆调度数据",
        "50": "第51列车辆调度数据",
        "51": "第52列车辆调度数据",
        "52": "第53列车辆调度数据",
        "53": "第54列车辆调度数据",
        "54": "第55列车辆调度数据",
        "55": "第56列车辆调度数据",
        "56": "第57列车辆调度数据",
        "57": "第58列车辆调度数据",
        "58": "第59列车辆调度数据",
        "59": "第60列车辆调度数据",
        "60": "第61列车辆调度数据",
        "61": "第62列车辆调度数据",
        "62": "第63列车辆调度数据",
        "63": "第64列车辆调度数据",
        "64": "第65列车辆调度数据",
        "65": "第66列车辆调度数据",
        "66": "第67列车辆调度数据",
        "67": "第68列车辆调度数据",
        "68": "第69列车辆调度数据",
        "69": "第70列车辆调度数据",
        "70": "第71列车辆调度数据",
        "71": "第72列车辆调度数据",
        "72": "第73列车辆调度数据",
        "73": "第74列车辆调度数据",
        "74": "第75列车辆调度数据",
        "75": "第76列车辆调度数据",
        "76": "第77列车辆调度数据",
        "77": "第78列车辆调度数据",
        "78": "第79列车辆调度数据",
        "79": "第80列车辆调度数据",
        "80": "第81列车辆调度数据",
        "81": "第82列车辆调度数据",
        "82": "第83列车辆调度数据",
        "83": "第84列车辆调度数据",
        "84": "第85列车辆调度数据",
        "85": "第86列车辆调度数据",
        "86": "第87列车辆调度数据",
        "87": "第88列车辆调度数据",
        "88": "第89列车辆调度数据",
        "89": "第90列车辆调度数据",
        "90": "第91列车辆调度数据",
        "91": "第92列车辆调度数据",
        "92": "第93列车辆调度数据",
        "93": "第94列车辆调度数据",
        "94": "第95列车辆调度数据",
        "95": "第96列车辆调度数据",
        "96": "第97列车辆调度数据",
        "97": "第98列车辆调度数据",
        "98": "第99列车辆调度数据",
        "99": "第100列车辆调度数据"
      }
    ],
    "addendum": "\\textbf{参考文献：}\n\\begin{enumerate}\n    \\item Zohali H, Reformulation, linearization, and a hybrid iterated local search algorithm for economic lot-sizing and sequencing in hybrid flow shop problems. Computers \\& Operations Research, 2019, 104:127-138.\n    \\item Shen Z, Tang Q, Huang T. Dynamic Production Scheduling Modeling and Multi-objective Optimization for Automobile Mixed-Model Production. Communications in Computer and Information Science, 2018, 924:25-33.\n    \\item Jalilvand-Nejad A, Fattahi P. A mathematical model and genetic algorithm to cyclic flexible job shop scheduling problem. Journal of Intelligent Manufacturing, 2015, 26(6):1085-1098.\n\\end{enumerate}\\begin{enumerate}\n    \\item Boysen N, Zenker M. A decomposition approach for the car resequencing problem with selectivity banks. Computers \\& Operations Research, 2013, 40(1): 98-108.\n    \\item Yavuz, Mesut. Iterated beam search for the combined car sequencing and level scheduling problem. International Journal of Production Research, 2013, 51(12): 3698-3718.\n    \\item 陈正茂. 基于排序缓冲区的多车间关联排序研究[D]. 华中科技大学, 2008.\n\\end{enumerate}",
    "data_summary": "Dataset Path:\n['附件1.xlsx', '附件2.xlsx', '附件3.xlsx', '附件4.xlsx']\n\nData Description:\n该数据集由四个附件组成，整体围绕汽车进场与调度序列、车型与动力/驱动属性以及车位与设备位置编码展开，适合用于生产调度、布局优化与装配线吞吐分析。附件1和附件2都记录了按“进车顺序”排列的车辆基本信息（包括车型、动力类型和驱动类型），可作为车辆属性表用于标识和过滤不同车型或动力/驱动组合的调度需求；附件3提供了不同进车道和返回道的停车位与设备位置描述及其唯一代码，包含涂装-PBS出车口、接车横移机、送车横移机和PBS-总装接车口等关键位置的空间编码，用于将车辆调度映射到工厂布局与设备资源；附件4的Sheet1则为车辆调度序列的宽表形式记录（第一列为行号，后续列以0–99编号表示多达100个调度字段或时间片/工位序列），适合用于分析序列模式、批次关系和多阶段路径。数据中主要变量为顺序标识（可作为主键或连接键）、类别型特征（车型、动力、驱动）、以及位置/设备编码（空间映射），数据类型以类别与序列/索引为主；在使用前建议统一字段命名、检查并处理缺失或不一致的进车顺序编号、将Sheet1的宽表转换为长表以便时间序列或路径分析，并核对附件间的主键一致性。基于该数据可开展的工作包括车辆进出序列可视化、装配线与搬运设备的负载/瓶颈分析、停车位与设备使用率评估、调度规则优化和仿真建模（例如最小化等待与横移次数、提高PBS与总装对接效率），同时需注意位置代码的空间语义与实际工位布局的对应关系以保证分析结果的可操作性。",
    "data_description": {
      "附件1": "附件1包含了车辆进车顺序、车型、动力类型和驱动类型的信息。",
      "附件2": "附件2包含了车辆进车顺序、车型、动力类型和驱动类型的信息。",
      "附件3": "附件3包含了不同进车道和返回道的停车位信息，以及涂装-PBS出车口、接车横移机、送车横移机和PBS-总装接车口的位置代码。",
      "附件4": "附件4包含一个名为Sheet1的工作表，内容为车辆调度序列数据。"
    },
    "problem_str": "问题背景：\n汽车制造厂主要由焊装车间、涂装车间、总装车间构成，每个车间有不同的生产偏好，如：焊装车间由于车身夹具的限制偏向最小车型及配置切换生产，涂装车间由于喷漆（固定每5辆车清洗喷头、颜色切换也需清洗喷头）限制偏向颜色以5的倍数切换生产，总装车间由于人员工时（不同车型及配置人员工时不同）及硬件（零部件数量等）等限制偏向按照车型及配置按比例切换生产。\n\n由于各车间的约束不同导致生产调度无法按照同一序列连续生产，特别是涂装车间与总装车间序列差异较大，这就需要在两个车间之间建立一个具有调序功能的缓存区，即PBS（Painted Body Store，汽车制造涂装-总装缓存调序区），用来将涂装车间的出车序列调整到满足总装车间约束的进车序列。\n\n目前，一天安排上线生产的车辆数介于200-450之间，对于每天要上线生产的车辆，车型、颜色等属性均有变化，目前车型大类有2种，颜色大约有10种，各个车间的产能不定，主要根据当天生产安排调整，涂装车间及总装车间的工艺流程如下：\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image.png}\n    \\caption{涂装车间工艺流程图}\n    \\label{fig:paint_process}\n\\end{figure}\n\n\\begin{itemize}\n\n    \\item 涂装车间处理喷漆工艺，主要是将涂料涂覆于白车身表面，最终形成涂膜或者漆膜或者涂层。涂装车间的详细流程如图1所示，主要是将白车身经过前处理电泳-中涂-色漆-清漆，最终得到修饰完整的车身。\n    \\item 总装车间处理装配工艺，主要是组装剩余零部件，得到最终成品车辆。总装车间的详细流程如图 2 所示，主要由内饰线、底盘线、最终线组成，最终经过测试检验后，成品车辆下线入库。\n\\end{itemize}\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image2.png}\n    \\caption{总装车间工艺流程图}\n    \\label{fig:2}\n\\end{figure}\n\n\\section{问题描述}\n\n根据涂装车间的出车序列通过 PBS 调度调整得到总装车间的进车序列。PBS 具体信息如表 3 所示。\n\n\\begin{table}[h]\n    \\centering\n    \\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|}\n        \\hline\n        & 10 & 9 & 8 & 7 & 6 & 5 & 4 & 3 & 2 & 1 & \\\\\n        \\hline\n        进车道6 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        进车道5 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        返回道 & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & \\\\\n        \\hline\n        进车道4 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & 送车横移机 \\\\\n        \\hline\n        涂装-PBS 接车横移机 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & PBS-总装 \\\\\n        \\hline\n        进车道3 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        进车道2 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        进车道1 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n    \\end{tabular}\n    \\caption{涂装-总装缓存调序区（PBS）示意图}\n    \\label{tab:3}\n\\end{table}\n\nPBS 由涂装-PBS 出车口、接车横移机、进车道 6 条（每条进车道有 10 个停车位、FIFO 结构）、返回道 1 条（有 10 个停车位）、送车横移机及 PBS-总装接车口等7个区域组成。各车道距离等分，每车道宽度2米，两相邻车道间间隔1米。横移机运动时的速度保持一致。\n\n 数据示例：\\begin{tabular}{|c|c|c|c|}\n\\hline\n进车顺序 & 车型 & 动力 & 驱动 \\\\\n\\hline\n1 & A & 混动 & 两驱 \\\\\n\\hline\n2 & B & 混动 & 两驱 \\\\\n\\hline\n3 & A & 燃油 & 两驱 \\\\\n\\hline\n4 & B & 燃油 & 两驱 \\\\\n\\hline\n5 & A & 燃油 & 四驱 \\\\\n\\hline\n6 & B & 燃油 & 四驱 \\\\\n\\hline\n\\end{tabular}\n\nPBS接车横移机：\n1. 将车身从涂装-PBS出车口运送到合适进车道。\n2. 将车身从返回道运送到合适进车道。\n\nPBS送车横移机：\n1. 将所选择车身从进车道运送到PBS-总装接车口。\n2. 将需调序车身从进车道运送到返回道。\n\nPBS约束说明：\n1. 送车横移机不能将返回道的车身送入PBS-总装接车口。\n2. 车身在进车道和返回道的移动方向为图中标注方向，不得改变。\n3. 接车横移机和送车横移机上同一时刻分别最多有一个车身。\n4. 接车横移机和送车横移机在完成任意动作后，必须返回中间初始位置，才可以执行下一步动作。\n5. 接车横移机和送车横移机在执行任何动作过程中，均不能被打断。\n6. 当返回道10停车位有车身，同时接车横移机空闲时，优先处理返回道10停车位上的车身。\n7. 当若干进车道1停车位有车身等候，同时送车横移机空闲时，优先处理最先到达1停车位的车身。\n8. 如果任意进车道1停车位有车身，那么送车横移机不能设置为空闲状态。\n9. 进车道和返回道每个时刻最多容纳10个车身，每个停车位最多容纳1个车身。\n10. 同一车道内，多个车身在不同停车位上的移动可以不同步进行。\n11. 当某车身所在停车位的下一停车位出现空位时，车身必须立即开始向下一停车位移动。\n12. 车身在进车道和返回道不同停车位之间移动的过程中，不能被调度。\\begin{itemize}\n    \\item \\textbf{PBS相关时间数据说明：}\n    \\begin{enumerate}\n        \\item 假定车身由横移机卸载到各进车道10停车位或返回道1停车位，以及由各进车道1停车位或返回道10停车位装载到横移机上的时间均可忽略。\n        \\item 假定车身在涂装-PBS出车口处装载到接车横移机上，以及在4车道出口中间位置处，车身由送车横移机上卸载到PBS-总装接车口，时间均可忽略。\n        \\item 进车过程：任意车身到达涂装-PBS出车口时，处于最中间位置，正对进车道4，接车横移机把车身从该位置运送至不同进车道10停车位并返回至初始位置，对于1-6进车道，消耗时间分别为[18, 12, 6, 0, 12, 18]秒。\n        \\item 出车过程：送车横移机从中间初始位置出发，把各进车道1停车位的车身运送至总装-PBS接车口，处于最中间位置，正对进车道4，对于1-6进车道，消耗时间分别为[18, 12, 6, 0, 12, 18]秒。\n        \\item 车进返回道过程：在有需要时，送车横移机从中间初始位置出发，把各进车道1停车位的车身，运送至返回道1停车位，并返回至初始位置，对于1-6进车道，消耗时间分别为[24, 18, 12, 6, 12, 18]秒。\n        \\item 车出返回道过程：接车横移机从中间初始位置出发，把返回道10停车位的车身，运送至任意进车道10停车位并返回至初始位置，对于1-6进车道，消耗时间分别为[24, 18, 12, 6, 12, 18]秒。\n        \\item 车移动过程：任意车身在进车道/返回道中，从某一停车位移动至后一停车位，消耗时间为9秒。\n    \\end{enumerate}\n    \\item \\textbf{可选的调度手段：}\n    \\begin{enumerate}\n        \\item 接车横移机将当前涂装-PBS出车口队列第一个车身或者返回道10停车位的车身送入任意进车道的10停车位。\n        \\item 送车横移机将任意进车道1停车位的车送入返回道1停车位或者PBS-总装接车口。\n        \\item 接车横移机和送车横移机均可以在一段时间内被设置为空闲状态。\n    \\end{enumerate}\n    \\item \\textbf{输入输出：}\n    \\begin{enumerate}\n        \\item 输入：涂装出车序列清单，可提供多个数据清单。\n        \\item 输出：每个车身在每一秒所处的区域（涂装-PBS出车口、接车横移机、任意进车道任意停车位、返回道任意停车位、送车横移机、PBS-总装接车口），可构建二维矩阵，里面存储区域代码（如 200 辆车在第 1000 秒完成全部调度，则需提交 200*1000 的矩阵）。矩阵中每一个值为各个区域代码，总的区域代码有 74 个，区域与代码的对应关系见附件 3。车身不在上述 74 个区域时，对应矩阵值为空白。具体的输出模板文件见附件 4（模板文件只是一个示意，示意的场景是 50 个车身在第 100 秒完成全部调度，每行代表每个车身各个时间点所处区域，每列代表每个时间点各车身所处区域，其中区域代码没具体填写，具体区域代码见附件 3；具体的输出矩阵，需要根据实际数据和算法计算得到，相关数据见附件 1-3，附件 4 只是示意，不代表本题只有 50 个车身）。由于 PBS 相关时间说明第 1、第 2 两条假设，会出现同一时刻车身处于若干不同区域的情形，则在输出矩阵该车身该时刻对应格子中填入这些区域中最后一个区域的代码。例如，第 0 秒，如果涂装-PBS 出车口第一个车身（1 号车身）被装载到接车横移机上，接着被卸载到 4 进车道 10 号车位，则在 1 号车身第 0 秒格子中填入 4 进车道 10 号车位的区域代码“410”；又例如，第 75 秒，如果 5 号车身从送车横移机上被卸载到 PBS-总装接车口，则在 5 号车身第 75 秒格子中填入 PBS-总装接车口区域代码“3”。\n    \\end{enumerate}\n\n\n问题要求：\n\\section*{优化目标：}\n1. 混动车型间隔 2 台非混动车型为优，权重系数 0.4。\n2. 四驱车型与两驱车型倾向 1:1 出车序列，权重系数 0.3。\n3. 返回道使用次数倾向于 0，权重系数 0.2。\n4. 倾向总调度时间越短越好，权重系数 0.1。\n\n注：该权重系数用于多目标得分加权，各权重系数相加等于 1。\n\n\\section*{优化目标具体量化逻辑：}\n设置每个优化目标初始分，根据下述逻辑更新得分后，再乘以相应系数，得到最终加权总分（理论最高分 100 分）。\n\n1. 优化目标 1（权重系数 0.4，初始分 100 分）：检查出车序列，找到所有混动车身，从出车序列头部按照先后顺序开始算，计算每连续两辆混动车身之间的非混动车身数，不等于 2 则扣 1 分。\n\n2. 优化目标 2（权重系数 0.3，初始分 100 分）：对出车序列进行分块，判断每一分快中的四驱车型与两驱车型之比是否满足 1:1，若不满足，则扣 1 分。对出车序列分块的依据是：如果序列以 4 开头，则根据从 2 变为 4 将序列进行分块；如果序列以 2 开头，则根据从 4 变为 2 将序列进行分块。例如：如果出车序列为 442242444224（4 代表四驱车型，2 代表两驱车型），则该序列分块结果为：4422，42，44422，4，最后两个分块 44422 和 4 都不满足 1:1，扣 2 分。\n\n3. 优化目标3（权重系数0.2，初始分100分）：统计返回道使用次数，每使用一次扣1分。\n\n4. 优化目标4（权重系数0.1，初始分为100分）：假设出车队列长度为$C$，第一辆车身进入涂装-PBS出车口时刻记为零，以最后一个车身进入PBS-总装接车口的时刻$T$为总完成时间，其理论最快完成时间为$9C+72$（全部走进车道4，出车序列与入车序列相同），其时间惩罚值设置为$0.01 \\times (T - 9C - 72)$，最后目标得分为$100 - $时间惩罚值。\n\n\\section*{请建模完成以下优化问题：}\n\n\\textbf{问题1：} 严格按照PBS约束说明及相关时间数据说明，根据涂装出车序列，考虑PBS区域调度能力及限制，建立PBS优化调度模型，使得总装进车序列尽可能满足总装生产需求。给出将你们的优化调度方案分别应用于附件1和附件2数据的得分结果，并将使用附件1和附件2两套数据的调度输出结果按照附件4格式分别存入result11.xlsx和result12.xlsx。\n\n\\textbf{问题2：} 如果去除PBS约束说明中第6、7两条约束，其余约束不变，根据涂装出车序列，考虑PBS区域调度能力及限制，建立PBS优化调度模型，使得总装进车序列尽可能满足总装生产需求。给出将你们的优化调度方案分别应用于附件1和附件2数据的得分结果，并将使用附件1和附件2两套数据的调度输出结果按照附件4格式分别存入result21.xlsx和result22.xlsx。\nAddendum: \n\\textbf{参考文献：}\n\\begin{enumerate}\n    \\item Zohali H, Reformulation, linearization, and a hybrid iterated local search algorithm for economic lot-sizing and sequencing in hybrid flow shop problems. Computers \\& Operations Research, 2019, 104:127-138.\n    \\item Shen Z, Tang Q, Huang T. Dynamic Production Scheduling Modeling and Multi-objective Optimization for Automobile Mixed-Model Production. Communications in Computer and Information Science, 2018, 924:25-33.\n    \\item Jalilvand-Nejad A, Fattahi P. A mathematical model and genetic algorithm to cyclic flexible job shop scheduling problem. Journal of Intelligent Manufacturing, 2015, 26(6):1085-1098.\n\\end{enumerate}\\begin{enumerate}\n    \\item Boysen N, Zenker M. A decomposition approach for the car resequencing problem with selectivity banks. Computers \\& Operations Research, 2013, 40(1): 98-108.\n    \\item Yavuz, Mesut. Iterated beam search for the combined car sequencing and level scheduling problem. International Journal of Production Research, 2013, 51(12): 3698-3718.\n    \\item 陈正茂. 基于排序缓冲区的多车间关联排序研究[D]. 华中科技大学, 2008.\n\\end{enumerate}\nDataset Path:\n['附件1.xlsx', '附件2.xlsx', '附件3.xlsx', '附件4.xlsx']\n\nData Description:\n该数据集由四个附件组成，整体围绕汽车进场与调度序列、车型与动力/驱动属性以及车位与设备位置编码展开，适合用于生产调度、布局优化与装配线吞吐分析。附件1和附件2都记录了按“进车顺序”排列的车辆基本信息（包括车型、动力类型和驱动类型），可作为车辆属性表用于标识和过滤不同车型或动力/驱动组合的调度需求；附件3提供了不同进车道和返回道的停车位与设备位置描述及其唯一代码，包含涂装-PBS出车口、接车横移机、送车横移机和PBS-总装接车口等关键位置的空间编码，用于将车辆调度映射到工厂布局与设备资源；附件4的Sheet1则为车辆调度序列的宽表形式记录（第一列为行号，后续列以0–99编号表示多达100个调度字段或时间片/工位序列），适合用于分析序列模式、批次关系和多阶段路径。数据中主要变量为顺序标识（可作为主键或连接键）、类别型特征（车型、动力、驱动）、以及位置/设备编码（空间映射），数据类型以类别与序列/索引为主；在使用前建议统一字段命名、检查并处理缺失或不一致的进车顺序编号、将Sheet1的宽表转换为长表以便时间序列或路径分析，并核对附件间的主键一致性。基于该数据可开展的工作包括车辆进出序列可视化、装配线与搬运设备的负载/瓶颈分析、停车位与设备使用率评估、调度规则优化和仿真建模（例如最小化等待与横移次数、提高PBS与总装对接效率），同时需注意位置代码的空间语义与实际工位布局的对应关系以保证分析结果的可操作性。"
  },
  "problem_background": "汽车制造厂主要由焊装车间、涂装车间、总装车间构成，每个车间有不同的生产偏好，如：焊装车间由于车身夹具的限制偏向最小车型及配置切换生产，涂装车间由于喷漆（固定每5辆车清洗喷头、颜色切换也需清洗喷头）限制偏向颜色以5的倍数切换生产，总装车间由于人员工时（不同车型及配置人员工时不同）及硬件（零部件数量等）等限制偏向按照车型及配置按比例切换生产。\n\n由于各车间的约束不同导致生产调度无法按照同一序列连续生产，特别是涂装车间与总装车间序列差异较大，这就需要在两个车间之间建立一个具有调序功能的缓存区，即PBS（Painted Body Store，汽车制造涂装-总装缓存调序区），用来将涂装车间的出车序列调整到满足总装车间约束的进车序列。\n\n目前，一天安排上线生产的车辆数介于200-450之间，对于每天要上线生产的车辆，车型、颜色等属性均有变化，目前车型大类有2种，颜色大约有10种，各个车间的产能不定，主要根据当天生产安排调整，涂装车间及总装车间的工艺流程如下：\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image.png}\n    \\caption{涂装车间工艺流程图}\n    \\label{fig:paint_process}\n\\end{figure}\n\n\\begin{itemize}\n\n    \\item 涂装车间处理喷漆工艺，主要是将涂料涂覆于白车身表面，最终形成涂膜或者漆膜或者涂层。涂装车间的详细流程如图1所示，主要是将白车身经过前处理电泳-中涂-色漆-清漆，最终得到修饰完整的车身。\n    \\item 总装车间处理装配工艺，主要是组装剩余零部件，得到最终成品车辆。总装车间的详细流程如图 2 所示，主要由内饰线、底盘线、最终线组成，最终经过测试检验后，成品车辆下线入库。\n\\end{itemize}\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image2.png}\n    \\caption{总装车间工艺流程图}\n    \\label{fig:2}\n\\end{figure}\n\n\\section{问题描述}\n\n根据涂装车间的出车序列通过 PBS 调度调整得到总装车间的进车序列。PBS 具体信息如表 3 所示。\n\n\\begin{table}[h]\n    \\centering\n    \\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|}\n        \\hline\n        & 10 & 9 & 8 & 7 & 6 & 5 & 4 & 3 & 2 & 1 & \\\\\n        \\hline\n        进车道6 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        进车道5 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        返回道 & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & $\\leftarrow$ & \\\\\n        \\hline\n        进车道4 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & 送车横移机 \\\\\n        \\hline\n        涂装-PBS 接车横移机 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & PBS-总装 \\\\\n        \\hline\n        进车道3 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        进车道2 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n        进车道1 & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & $\\rightarrow$ & \\\\\n        \\hline\n    \\end{tabular}\n    \\caption{涂装-总装缓存调序区（PBS）示意图}\n    \\label{tab:3}\n\\end{table}\n\nPBS 由涂装-PBS 出车口、接车横移机、进车道 6 条（每条进车道有 10 个停车位、FIFO 结构）、返回道 1 条（有 10 个停车位）、送车横移机及 PBS-总装接车口等7个区域组成。各车道距离等分，每车道宽度2米，两相邻车道间间隔1米。横移机运动时的速度保持一致。\n\n 数据示例：\\begin{tabular}{|c|c|c|c|}\n\\hline\n进车顺序 & 车型 & 动力 & 驱动 \\\\\n\\hline\n1 & A & 混动 & 两驱 \\\\\n\\hline\n2 & B & 混动 & 两驱 \\\\\n\\hline\n3 & A & 燃油 & 两驱 \\\\\n\\hline\n4 & B & 燃油 & 两驱 \\\\\n\\hline\n5 & A & 燃油 & 四驱 \\\\\n\\hline\n6 & B & 燃油 & 四驱 \\\\\n\\hline\n\\end{tabular}\n\nPBS接车横移机：\n1. 将车身从涂装-PBS出车口运送到合适进车道。\n2. 将车身从返回道运送到合适进车道。\n\nPBS送车横移机：\n1. 将所选择车身从进车道运送到PBS-总装接车口。\n2. 将需调序车身从进车道运送到返回道。\n\nPBS约束说明：\n1. 送车横移机不能将返回道的车身送入PBS-总装接车口。\n2. 车身在进车道和返回道的移动方向为图中标注方向，不得改变。\n3. 接车横移机和送车横移机上同一时刻分别最多有一个车身。\n4. 接车横移机和送车横移机在完成任意动作后，必须返回中间初始位置，才可以执行下一步动作。\n5. 接车横移机和送车横移机在执行任何动作过程中，均不能被打断。\n6. 当返回道10停车位有车身，同时接车横移机空闲时，优先处理返回道10停车位上的车身。\n7. 当若干进车道1停车位有车身等候，同时送车横移机空闲时，优先处理最先到达1停车位的车身。\n8. 如果任意进车道1停车位有车身，那么送车横移机不能设置为空闲状态。\n9. 进车道和返回道每个时刻最多容纳10个车身，每个停车位最多容纳1个车身。\n10. 同一车道内，多个车身在不同停车位上的移动可以不同步进行。\n11. 当某车身所在停车位的下一停车位出现空位时，车身必须立即开始向下一停车位移动。\n12. 车身在进车道和返回道不同停车位之间移动的过程中，不能被调度。\\begin{itemize}\n    \\item \\textbf{PBS相关时间数据说明：}\n    \\begin{enumerate}\n        \\item 假定车身由横移机卸载到各进车道10停车位或返回道1停车位，以及由各进车道1停车位或返回道10停车位装载到横移机上的时间均可忽略。\n        \\item 假定车身在涂装-PBS出车口处装载到接车横移机上，以及在4车道出口中间位置处，车身由送车横移机上卸载到PBS-总装接车口，时间均可忽略。\n        \\item 进车过程：任意车身到达涂装-PBS出车口时，处于最中间位置，正对进车道4，接车横移机把车身从该位置运送至不同进车道10停车位并返回至初始位置，对于1-6进车道，消耗时间分别为[18, 12, 6, 0, 12, 18]秒。\n        \\item 出车过程：送车横移机从中间初始位置出发，把各进车道1停车位的车身运送至总装-PBS接车口，处于最中间位置，正对进车道4，对于1-6进车道，消耗时间分别为[18, 12, 6, 0, 12, 18]秒。\n        \\item 车进返回道过程：在有需要时，送车横移机从中间初始位置出发，把各进车道1停车位的车身，运送至返回道1停车位，并返回至初始位置，对于1-6进车道，消耗时间分别为[24, 18, 12, 6, 12, 18]秒。\n        \\item 车出返回道过程：接车横移机从中间初始位置出发，把返回道10停车位的车身，运送至任意进车道10停车位并返回至初始位置，对于1-6进车道，消耗时间分别为[24, 18, 12, 6, 12, 18]秒。\n        \\item 车移动过程：任意车身在进车道/返回道中，从某一停车位移动至后一停车位，消耗时间为9秒。\n    \\end{enumerate}\n    \\item \\textbf{可选的调度手段：}\n    \\begin{enumerate}\n        \\item 接车横移机将当前涂装-PBS出车口队列第一个车身或者返回道10停车位的车身送入任意进车道的10停车位。\n        \\item 送车横移机将任意进车道1停车位的车送入返回道1停车位或者PBS-总装接车口。\n        \\item 接车横移机和送车横移机均可以在一段时间内被设置为空闲状态。\n    \\end{enumerate}\n    \\item \\textbf{输入输出：}\n    \\begin{enumerate}\n        \\item 输入：涂装出车序列清单，可提供多个数据清单。\n        \\item 输出：每个车身在每一秒所处的区域（涂装-PBS出车口、接车横移机、任意进车道任意停车位、返回道任意停车位、送车横移机、PBS-总装接车口），可构建二维矩阵，里面存储区域代码（如 200 辆车在第 1000 秒完成全部调度，则需提交 200*1000 的矩阵）。矩阵中每一个值为各个区域代码，总的区域代码有 74 个，区域与代码的对应关系见附件 3。车身不在上述 74 个区域时，对应矩阵值为空白。具体的输出模板文件见附件 4（模板文件只是一个示意，示意的场景是 50 个车身在第 100 秒完成全部调度，每行代表每个车身各个时间点所处区域，每列代表每个时间点各车身所处区域，其中区域代码没具体填写，具体区域代码见附件 3；具体的输出矩阵，需要根据实际数据和算法计算得到，相关数据见附件 1-3，附件 4 只是示意，不代表本题只有 50 个车身）。由于 PBS 相关时间说明第 1、第 2 两条假设，会出现同一时刻车身处于若干不同区域的情形，则在输出矩阵该车身该时刻对应格子中填入这些区域中最后一个区域的代码。例如，第 0 秒，如果涂装-PBS 出车口第一个车身（1 号车身）被装载到接车横移机上，接着被卸载到 4 进车道 10 号车位，则在 1 号车身第 0 秒格子中填入 4 进车道 10 号车位的区域代码“410”；又例如，第 75 秒，如果 5 号车身从送车横移机上被卸载到 PBS-总装接车口，则在 5 号车身第 75 秒格子中填入 PBS-总装接车口区域代码“3”。\n    \\end{enumerate}\n",
  "problem_requirement": "\\section*{优化目标：}\n1. 混动车型间隔 2 台非混动车型为优，权重系数 0.4。\n2. 四驱车型与两驱车型倾向 1:1 出车序列，权重系数 0.3。\n3. 返回道使用次数倾向于 0，权重系数 0.2。\n4. 倾向总调度时间越短越好，权重系数 0.1。\n\n注：该权重系数用于多目标得分加权，各权重系数相加等于 1。\n\n\\section*{优化目标具体量化逻辑：}\n设置每个优化目标初始分，根据下述逻辑更新得分后，再乘以相应系数，得到最终加权总分（理论最高分 100 分）。\n\n1. 优化目标 1（权重系数 0.4，初始分 100 分）：检查出车序列，找到所有混动车身，从出车序列头部按照先后顺序开始算，计算每连续两辆混动车身之间的非混动车身数，不等于 2 则扣 1 分。\n\n2. 优化目标 2（权重系数 0.3，初始分 100 分）：对出车序列进行分块，判断每一分快中的四驱车型与两驱车型之比是否满足 1:1，若不满足，则扣 1 分。对出车序列分块的依据是：如果序列以 4 开头，则根据从 2 变为 4 将序列进行分块；如果序列以 2 开头，则根据从 4 变为 2 将序列进行分块。例如：如果出车序列为 442242444224（4 代表四驱车型，2 代表两驱车型），则该序列分块结果为：4422，42，44422，4，最后两个分块 44422 和 4 都不满足 1:1，扣 2 分。\n\n3. 优化目标3（权重系数0.2，初始分100分）：统计返回道使用次数，每使用一次扣1分。\n\n4. 优化目标4（权重系数0.1，初始分为100分）：假设出车队列长度为$C$，第一辆车身进入涂装-PBS出车口时刻记为零，以最后一个车身进入PBS-总装接车口的时刻$T$为总完成时间，其理论最快完成时间为$9C+72$（全部走进车道4，出车序列与入车序列相同），其时间惩罚值设置为$0.01 \\times (T - 9C - 72)$，最后目标得分为$100 - $时间惩罚值。\n\n\\section*{请建模完成以下优化问题：}\n\n\\textbf{问题1：} 严格按照PBS约束说明及相关时间数据说明，根据涂装出车序列，考虑PBS区域调度能力及限制，建立PBS优化调度模型，使得总装进车序列尽可能满足总装生产需求。给出将你们的优化调度方案分别应用于附件1和附件2数据的得分结果，并将使用附件1和附件2两套数据的调度输出结果按照附件4格式分别存入result11.xlsx和result12.xlsx。\n\n\\textbf{问题2：} 如果去除PBS约束说明中第6、7两条约束，其余约束不变，根据涂装出车序列，考虑PBS区域调度能力及限制，建立PBS优化调度模型，使得总装进车序列尽可能满足总装生产需求。给出将你们的优化调度方案分别应用于附件1和附件2数据的得分结果，并将使用附件1和附件2两套数据的调度输出结果按照附件4格式分别存入result21.xlsx和result22.xlsx。",
  "problem_analysis": "总体上，这一题本质上是一个受物理布局和设备动作约束的离散事件调度与重排问题，属于带有缓冲区约束的汽车再排序（car resequencing）或缓冲调度问题的变形。宏观背景是生产系统中不同工序（涂装与总装）对序列的偏好不一致，必须通过一个带有严格物理动作与时延的缓冲区（PBS）进行实物层面的重排以对接下游节拍与资源约束。因而模型既要保证可行性（遵守PBS中道位、横移机、FIFO、不可中断动作、即时迁移等物理规则），又要在可行解空间内尽量满足多重业务目标（混动车间隔、驱动类型配比、返回道使用次数最小化、总体完成时间最短化），两类目标存在天然的冲突与权衡。目标函数被定量为四项得分并加权合成，这决定了解法要对离散的序列属性（如两种车型之间的间隔计数、4/2配比按分块考察）与连续的调度时序（总工时T）同时敏感，因此算法必须既能操纵序列顺序，又能评估时序性能。\n\n问题描述中包含大量显性与隐性假设，这些前提深刻影响模型可用性与解释力。显性的如将若干装卸时间视为可忽略、车在进/返回道相邻停车位间移动固定为9秒、横移机对不同进车道的往返时间固定、横移机动作不可中断且完成后返回中位等，极大地简化了动作的时间模型，使得横移动作可建成若干固定时长的原子操作。这一简化带来好处是方便构建离散时间或离散事件仿真以校验可行性与计算目标，但代价是移除了可能存在的并行装卸延迟、夹具对接时间、以及横移机实际启动/加速度的连续动态特性，可能导致理论最优解在真实现场执行时出现不可忽视的偏差。隐性的假设包括涂装输出到PBS的到达模式可视为已知且无抖动（题目给出的是完整出车序列），且设备故障或人员突发事件不考虑，这使得问题在静态既定输入下求解更可行，但忽略了现实运行中的随机性。还有若干操作规则（例如第11条“当下一停车位出现空位时，车身必须立即开始移动”）会引起连锁位移和实物占用的强制性动态，这种规则在模型中会产生扭结式的时间依赖性和同步要求，需要在事件驱动仿真中精确实现，否则容易出现逻辑死锁或与横移机安排冲突的情形。\n\n组件之间的相互依赖与潜在复杂性是此问题的核心挑战之一。PBS内部既有多条FIFO进车道（每道10位）与单条返回道，每道的头位（1位）与尾位（10位）分别与送/接横移机交互；横移机在空间上的摆渡时间差导致将某辆车放在不同进车道对后续出车时延与返回概率有直接影响，尤其进车道4对中位对齐且横移时间为零意味着把“希望快速出库”的车辆尽可能安置在4道尾位有天然优势，但多辆此类目标车堆积会导致后续冲突。此外，横移机动作与车道内直线位移是耦合的：当横移机把某车送入或从道位取出时，若道内其他车因“必须立即前移”规则开始移动，横移机预期的空间预留和时间窗口可能被改变，从而使得调度器在分配动作时间点时必须考虑车道内部的级联移动。再者，送车横移机不能将返回道上的车直接送入总装接车口，且当返回道满并且接车横移机空闲时优先处理返回道末位车辆的规则（约束6），以及当若干进车道1位有车候选且送车横移机空闲时优先处理先到达的头位车（约束7），这些优先规则在实际调度中会强烈地限制可选动作序列，使得某些表面上对目标有利的重排策略被制度性地禁止或延迟，从而造成目标之间的不可调和冲突。移除这些优先规则将放宽动作自由度，理论上能提升目标函数但可能改变现场安全或流畅性的要求，且可能让模型解变得更依赖于优化算法的策略选择而不是规则驱动的执行。\n\n从建模方法与可解性角度看，本问题在规模上随着车辆数C（200–450）与时间分辨率（题目要求按秒输出矩阵）变得相当庞大，直接以时间扩展的混合整数线性规划来精确刻画每一秒的每个设备与车位状态会导致变量与约束数量呈爆炸式增长，难以在合理时间内求解到全局最优。更现实的路径是采用离散事件仿真作为可行性检验与目标评估器，结合启发式或基于元启发式的搜索（遗传算法、禁忌搜索、模拟退火、迭代局部搜索、基于局部搜寻的多起点贪心）来生成可行动作策略。在建模时可以考虑若干分解策略以降低复杂度：将问题分为静态分配问题（把涂装输出的每辆车指派到某个进车道与某个道位时刻的目标位置，考虑空间代价与期望出车优先级）与动态调度问题（按照实时时间进程安排横移机动作并处理车道内部自动前移），或者将长期目标（比如驱动配比的1:1）作为软约束在序列层面先用序列重排序算法处理，再在仿真层面尽量减少返回道使用与总时长。另一条可行办法是构建状态压缩的动态规划/最短路径模型，将PBS的每一时间步状态用各道当前占用的头位与尾位构成的紧凑表征来描述，但状态空间仍可能非常大，只能用于较短序列或作为启发式子问题求解器。\n\n多目标权重与量化逻辑也值得批判性审视。原题将4项指标分别初始化100分并通过逐项减罚来计算，最后权重加权求和，这一设计简洁明了但存在离散与尺度不一致的问题。例如第一、第二项都是用离散违例计数扣分，第三项是返回次数直接扣分，第四项是总时差按比例扣分；由于惩罚尺度不同，且扣分都是线性累计，某些目标（如返回道使用次数）在不同天的车流构成下可能占主导作用，权重虽给定但实际影响依赖于基线罚值的分布。这就要求在实际优化前先做基准分析与敏感性测试，评估在真实样本上的各项扣分分布，或考虑把目标改写为同物理单位（例如把第一与第二项的违例转换为时间或成本），以避免权重掩盖尺度效应并导致盲目优化某些容易改善而对整体装配效率影响甚微的指标。此外，目标间存在显著冲突：追求混动车间隔的严格性可能需要在PBS中频繁地对叠加的序列进行调动，增加返回操作次数和横移机占用，反而拉长总完成时间或者逼近返回道使用阈值；同样追求4/2配比会限制可用的插入操作，可能会增加需要把车送入返回道以便后续重排的频率。因此最佳策略往往来自对权重的理解与业务价值权衡，而非单纯地最小化单项违例。\n\n动态性与鲁棒性也是建模必须考虑的问题。题目中提供的是静态完整的涂装出车序列，但在实际运行中涂装出车时间可能有抖动、车辆可能临时返工或停留，横移机可能偶发停机，进车道的即时前移规则可能导致时间上的冲突与短暂阻塞。在模型设计中应考虑两类应对策略：一是稳健优化或鲁棒优化，使得所得调度在小范围扰动下性能退化最小；二是在执行层引入实时再调度或滑动时域策略（rolling horizon），将全局序列规划作为目标引导，在线用短期快速启发式进行动作决策并在车到达或设备状态改变时重新规划。对权重敏感性、规则变更（例如移除约束6、7）与输入扰动的影响应通过情景分析、蒙特卡洛仿真与局部灵敏度分析来评估，识别在何种条件下模型解会改变其结构（例如从以少量返回道使用、低总体时长的策略转换为以多次返回换取更优秀配比）。\n\n关于替代的表述与解法视角，有若干值得探索的方向：可以把问题重构为目标是最大化总装接车序列与总装偏好函数的匹配度，此处总装偏好可以通过期望的车型/动力/驱动“模板”来表示，然后采用匹配与插入策略将涂装序列映射到装配序列，从而把PBS看成一个有限容量的调度器，其代价函数主要来源于横移次数、返回道次数和延迟时间；另一种视角是把PBS当成一个有选择性的多通道缓冲池，重点在于如何在线决定每辆到达车是否直接分配到某道位或暂时放入返回道并对未来到达做预测，这种带预测的分配问题更适合用强化学习或近似动态规划来构造策略。还可以从物理空间优化出发，考虑是否通过改变进车道位置（例如动态安排哪条道为快速道）或调整横移机中位位置来改变时间矩阵，从而在硬件层面减少某些横移时延。在方法选择上，若追求可证明的最优性且C较小，可尝试精确的整数规划或约束编程；若C在题设范围且需在有限时间内给出高质量解，则推荐混合启发式：先通过问题特定贪心规则（优先把能零时延出库的车优先安排在进车道4的尾位；尽量避免将关键车辆推到难以快速提取的道位）构建初始解，再用局部搜索（插入/交换/搬入返回道的操作）在仿真器中评估并改进，或用元启发式多起点并行尝试以探索解空间。\n\n最后，建模过程应保持迭代与开放的心态。初始模型基于题目给定的简化假设是必须的，但在实现过程中应持续验证这些假设的合理性并记录潜在风险，例如忽略装卸时间可能导致输出矩阵中出现“同一秒多地点”的填充规则需要严格执行以保证可比性；即时前移规则与横移机占用的交互关系要通过小规模案例仿真来验证无死锁；权重体系应通过历史或模拟数据做预调优以确保评分反映业务价值。建议的实践路线是先搭建一个事件驱动的PBS仿真器以精确实现所有物理与规则约束，再在仿真器之上开发调度策略生成器并用启发式/元启发式方法优化所得策略，最后进行广泛的场景测试（含权重敏感性、设备故障、到达扰动等）来评估稳健性，并把结果以题目要求的秒级状态矩阵格式输出。通过这种仿真—优化—验证—迭代的流程，模型既能兼顾理论最优化的追求，又能在实际工程实施中表现出可操作性与鲁棒性。",
  "modeling_solution": "总体建模思路与关键假设（总体框架）。本问题本质上为带物理缓冲与设备动作约束的离散事件重排序问题（car resequencing + buffer scheduling）。为兼顾可解性与物理可行性，提出“序列层决策（目标对齐）——PBS物理调度仿真（可行性验证与时序评估）”的两阶段混合模型：第一阶段在保持涂装到达顺序的约束下产生或改良一个目标总装进车序列（或若干备选序列）以最大化题目给定的四项加权评分；第二阶段以事件驱动的物理仿真器严格执行PBS设备与道位约束（含横移机运行时间、道内前移规则、FIFO容量限制、动作不可中断等），并对第一阶段输出序列尝试通过横移机与返回道操作实现该序列，仿真返回实际完成时间T、返回道使用次数R及最终可达到的进车序列，从而计算真实得分并反馈用于改进第一阶段（迭代）。为了在有/无约束6、7两种情形下均适用，模型中把约束6、7参数化（可开/关）。\n\n为便于数学表述，首先给出关键假设：假设涂装出车序列完全已知且到达至PBS的时间顺序为0,0+,…以题目要求的“第一辆到达时刻为0”作为参考，不考虑涂装到达时间的随机扰动（静态问题）；忽略题目允许忽略的若干装卸瞬时耗时；横移机动作为不可中断的原子操作，其从中位到各进车道或返回道的往返时长用题目给定的常数矩阵T_in[l]、T_out[l]、T_return_in[l]、T_return_out[l]表示（l=1..6），道内相邻停车位移动固定耗时 t_move = 9秒；每道与返回道最多10辆，且每停车位最多1辆；接车与送车横移机在任意时刻最多各有1辆且完成动作后必须回中位；若动作发生的多个瞬间叠加，则按题目规则在输出矩阵中填写“最后到达的区域代码”；允许把约束6、7（优先处理返回道10与入车道1先到优先）开关化，便于问题1（含）与问题2（去除6、7）求解对比。\n\n符号与变量定义（紧凑表示）。令 V = {1,…,C} 为涂装出车序列的车辆集合，arrive_order(i) 给出车辆 i 在涂装-PBS出车口的序号（按题目输入）。 对时间离散化以秒为单位，t = 0,1,...,T_max（T_max 由仿真动态决定）。 定义内部状态变量为 s_i(t) ∈ Regions 表示车辆 i 在时间 t 所处区域（Regions 包含涂装-PBS出车口、中位位置、送/接横移机、每道每位编码 L_l_p（l=1..6,p=1..10）、返回道位置 R_p（p=1..10）、PBS-总装接车口 等）。为便于调度决策与约束表达，引入二进制动作变量在逻辑层面： u_in(t) 表示在时刻 t 接车横移机是否开始一次从中位取涂装出车口或返回道10的装车动作； u_out(t) 表示在时刻 t 送车横移机是否开始一次从某进车道1取车并送往PBS-总装或返回道1 的动作； m_in_busy(t) 与 m_out_busy(t) 表征两台横移机在 t 期间是否忙碌。 对序列层建模还引入目标序列 σ = (σ_1,…,σ_C) 表示期望的总装进车顺序（σ_k 为进站第 k 辆车辆的 ID）。这是第一阶段的关键决策对象（可视为重排序输出）。\n\n物理动作与时序约束（仿真器规则的数学表达）。接车横移机从中位将涂装队列头部（若设为立即可取）或返回道10上车辆运至任意进车道10号位并返回中位，其动作占用时间为 t_in(l)（l=1..6 给定分别为 [18,12,6,0,12,18] 秒用于涂装->进车道；从返回道10到进车道则用 t_return_out(l)=[24,18,12,6,12,18] 秒）。送车横移机从中位将进车道1号位车辆送往总装接车口占用 t_out(l)=[18,12,6,0,12,18] 秒，或将进车道1号位车辆送往返回道1占用 t_send_return(l)=[24,18,12,6,12,18] 秒。若在 t 时刻横移机开始动作，则在区间 [t, t + duration) 内该机器为 busy 状态且动作不可中断。道内任意车辆从位 p+1 向 p 前移耗时 t_move = 9 秒，且前移动作一旦开始在 9 秒内不可中断（题目11、12）。道内 FIFO 约束可表达为当位 p 空位出现（无车辆占用且无正在前移至该位的操作），位 p+1 若有车必须立即开始花 9 秒前移至 p（无选择延迟）。停车位容量与不超过一车的约束按常规写出：对任一时刻 t 与任意位，∑_i 1{s_i(t) = pos} ≤ 1。两台横移机除 busy 限制外不能同时在非中位位置干涉道内车辆（仿真控制，避免空间冲突）。\n\n评分函数的数学化（与题目严格对应）。总评分 S = 0.4 * s1 + 0.3 * s2 + 0.2 * s3 + 0.1 * s4，其中每项初始 100 分并按照规则扣罚。s1（混动车间隔）为 100 - V1，V1 为按涂装出车序列或最终总装进车序列（题目要求“检查出车序列”，这里取最终总装进车序列 σ）中对所有连续两辆混动车间非混动车数不等于 2 的次数。在实现中应明确使用哪一条序列（建议以最终进车序列 σ 作为度量，因为PBS目标是产生满足总装需求的进车序列）；s2（四驱/两驱块比）为 100 - V2，其中 V2 为对 σ 的分块（从序列首至尾，根据 2↔4 变换进行断点）中每一块若4:2比例非1:1则扣 1。s3 为 100 - R，其中 R 为仿真实际使用返回道的次数。s4 为 100 - 0.01 * (T - 9C - 72)，T 为仿真中最后一辆进入PBS-总装接车口的时刻（秒），C 为车辆数，若 s4<0 则下界设为 0。最终 S 在 0–100 范围内。\n\n精确数学模型（可用于小规模或作为子问题的混合整数模型）。若希望精确求解小规模样例，可构建时间索引的 MILP：对于每辆 i、每道 l、每位 p、每时间 t，引入二元变量 x_{i,l,p,t}=1 当且仅当车辆 i 在时间 t 占据进车道 l 的停车位 p。 对返回道类似引入 r_{i,p,t}。 对横移机引入动作开始变量 a_in_{i,l,t} 表示接车横移机在 t 开始一个把某车辆装载并送至 l 的动作。 约束包括：每一车辆在任一时刻位于恰好一个区域（或在横移机上）；道位互斥；横移机动作的时间一致性（若 a_in_{i,l,t}=1 则车辆 i 在 [t, t+t_in(l)) 处于接车横移机中并在 t+t_in(l) 时刻出现在对应进车道10位置）；道内前移规则：若 x_{i,l,p+1,t}=1 且 x_{*,l,p,t}=0 且无前移进行，则必须存在 τ∈[t,t+9) 使得某前移动作占用该区间并使得在 t+9 结束时 x_{i,l,p,t+9}=1（可以用预定义前移动作变量表示）。 横移机互斥 m_in_busy(t) = ∑_{i,l} ∑_{τ=t-duration+1}^{t} a_in_{i,l,τ} ≤ 1。 返回道容量、优先规则用线性约束写出（对问题2，把这些约束移除或放宽）。 目标函数为在MILP中最大化 S，等价于最小化加权扣罚（线性化 V1、V2 的计算可以通过引入辅助变量与逻辑约束实现，但会导致模型规模非常大）。 该精确模型对于 C≈20–50可用解器求解或用于生成证据性小案例，但对于题目给定的 200–450 车辆规模不可直接求解。\n\n可行的求解策略（大规模实用方案）。基于问题规模与物理复杂度，推荐采用迭代的启发式/元启发式框架结合高速仿真评估：先用序列层启发式或元启发式（如遗传算法、模拟退火或迭代局部搜索）在车辆顺序空间生成若干候选目标序列 σ（初代可用规则化贪心算法得到：沿涂装到达顺序尽量保留但利用可允许的插入与小幅交换来修正混动车间隔与4/2配比），在评估阶段将每个 σ 通过事件驱动PBS仿真器尝试实现，并计算真实得分 S(σ)。仿真器严格执行所有物理约束并输出完成时间 T、返回次数 R 及每秒每车的区域矩阵。在序列候选生命周期中采用专用的局部操作算子（相邻交换、任意位置插入、把一车送入返回道并在后续位置重插入等），并对这些操作施以“合法性过滤”以避免明显不可行例如导致道位溢出的动作。为避免搜索陷入低质量局部极值，可以采用多起点并行策略或基于遗传的群体多样性维护（交叉操作需小心保证候选序列与涂装到达顺序间的可行映射；或者采用排序编码并在仿真层级映射到具体道位分配）。\n\n在仿真层，采用离散事件模拟（DES）实现PBS规则：事件包括车辆到达中位、横移机动作开始与完成、道内车辆开始与完成前移、车辆进入或离开返回道与总装接车口等。DES 能有效处理不可中断的原子动作与道内即时前移规则且在每次评估中以 O(number of events) 时间复杂度运行（对 450 辆规模每轮仿真在现代CPU上通常毫秒到秒级）。输出要求为按秒的矩阵，可通过在模拟时记录每秒每车的最后区域状态（题目要求若同秒内跨区域则记录最后抵达区域的代码）。对约束6、7 的可切换实现为：当返回道10有车且接车横移机空闲时强制触发优先动作；当若干进车道1位有车时按到达时间排序强制优先；问题2 将这两条规则注释掉以放宽动作选择。\n\n初始化启发策略建议结合业务启发：优先把能快速出库的车辆布置在进车道4（因横移时间为0），把混动车按照间隔2规则做局部插入；为满足4/2比，采用滑动窗口策略对 σ 做分块修正：在从左到右扫描过程中维护两个计数器，当窗口内两驱/四驱比偏离1:1时尝试从后面或者返回道调入合适车型而非盲目swap，以降低返回次数。返回道使用视为昂贵操作，给予较高惩罚（题目权重为0.2，但在实现上在初始解构建时应置成本以偏好避免返回）。得到若干候选 σ 后通过仿真评估并用模拟退火或基于仿真的遗传算法对 σ 进行改良，直至达到时间预算或收敛。\n\n处理并行性、计算资源与工程实现细节。整个框架适合并行化：序列候选的仿真评估可在多核机器上并行运行，局部搜索与种群演化可利用 GPU/CPU 集群并行做多起点尝试。对于车辆数 C 在 200–450 的实例，单次仿真通常很快（几十毫秒到数秒），故在允许数百到数千次仿真评估的情况下可以得到高质量解。若时间预算有限，可采用代理模型（surrogate）来近似仿真结果，例如训练一个回归模型预测给定局部插入/交换对返回次数与完成时间的影响，从而在大规模搜索中降低仿真调用频次；在获得若干高质量候选解后再用精确仿真验证并生成最终输出矩阵和得分。\n\n对问题1 与问题2 的具体处理。问题1（保留约束6、7）在仿真层需强制优先规则，构造初始解时需尊重这些优先导致的可行动作集较小，其结果通常使得返回道使用次数和横移机利用更受限，从而可能需要以牺牲少量混动车间隔/配比达到更低的返回次数与合理的完成时间。问题2（去除约束6、7）将允许仿真器自由选择任一满足设备空闲的动作，序列生成器在更大自由度下通常能通过局部交换减少违例数（混动车间隔与4/2偏差）并在多数情况下降低总体得分损失，因此预期在问题2 得到更高的综合分数。两种情形均采用相同框架但仿真优先规则不同。\n\n模型验证、敏感性与鲁棒性分析。为检验模型和策略的稳健性，应做若干实验：对相同输入序列在去/保留约束6、7 下比较得分；对涂装到达时间加入小幅随机扰动（例如到达时刻 ±Δt 的泊松噪声）进行蒙特卡洛仿真以评估策略对到达时变动的鲁棒性；对横移时间、前移时间等参数进行±10%敏感性分析以检验调度策略在设备性能变化下的可靠性。若策略对扰动敏感，可引入滚动时域重规划（receding horizon）：仅对未来 H 秒窗口内进行详细优化并在每个窗口末端更新状态并重新规划，从而具备在线实时修正能力。对于得分尺度与权重敏感性，建议在前期以历史样本评估各项扣罚分布并如有必要对搜索启发进行再权衡（例如人为在序列生成时把返回道成本放大，以避免在优化早期产生大量返回操作）。\n\n输出格式与可复现性。仿真器应记录每秒每车的区域代码并输出矩阵，满足附件4 的模板。若在同一秒内车辆跨多个区域（因题目允许忽略某些瞬时装卸耗时）按“最后到达区域代码”填入。保证可复现性需要把随机化算子（如遗传算法交叉、模拟退火初始种子等）设定种子并保存日志。对附件1 与附件2，按上述方法分别生成 result11.xlsx、result12.xlsx（问题1）和 result21.xlsx、result22.xlsx（问题2）；并分别输出对应得分与中间统计（返回次数R、完成时间T、混动车间隔违例数V1、4/2违例数V2）。\n\n扩展与未来改进方向。为提高模型的自动化与长期适应性，可进一步开发基于深度强化学习的调度策略，将事件驱动仿真作为环境并训练策略网络在在线情形中做动作选择，特别适用于现场存在随机扰动或设备失效的场景。另一方向是将序列层与物理层更紧密耦合：采用可微分近似仿真器或用自动微分训练代理模型，从而用连续优化技术提高搜索效率。若获得运行数据，可用监督学习训练代理模型来快速预测某一局部动作对最终得分的影响，从而在大规模候选搜索时显著降低仿真调用数。最后，考虑把不确定性纳入模型（机会约束或鲁棒优化）以生成在多种扰动下均表现良好的策略。\n\n总结性陈述。本文提出的模型以“序列优化 + 严格事件驱动仿真”混合框架为核心，既保证输出满足PBS所有物理与逻辑约束，又能在目标评分（混动车间隔、4/2比例、返回次数、完成时间）上进行有效权衡。通过启发式构造、基于仿真的局部搜索与并行并行化评估，可以在题目规模（200–450 辆）下在可接受的计算时间内得到高质量且可执行的调度方案；同时，模型参数化地支持问题1（含优先约束6、7）与问题2（去除6、7）的情形比较，并为后续采用强化学习或代理模型等高级方法提供良好接口。",
  "task_descriptions": [
    "子任务1 的目标是对原始输入数据和说明性参数进行系统化清洗、校验与参数化，生成一组结构化、可直接供后续仿真与优化模块使用的规范化输入文件和参数字典。具体范围包括：读取并校验附件1、附件2（涂装出车序列与车辆属性表）、附件3（74 个区域与进/返道停车位及设备位置代码映射表）和附件4（输出矩阵模板的宽表），对字段名称统一、数据类型强制转换并处理缺失或重复值（包括但不限于：确保每辆车有唯一 ID 与进车顺序、车型/动力/驱动字段非空且为规定类别、进车顺序连续且无重复），若发现缺失或异常记录则生成错误报告并按预定义策略（报错/补全/剔除）处理；将附件4 的宽表格式转换为按车和时间索引的长表（每条记录至少包含：车辆ID、时间戳、原始位置编码或空值），并建立时间轴与序号映射（约定第一辆到达涂装‑PBS 出车口的时刻为 0 秒）；显式参数化并输出 PBS 的常量时序参数和约束开关为机器可读字典（包含接车横移机涂装->进车道耗时 t_in = [18,12,6,0,12,18] 秒、送车横移机出车耗时 t_out = [18,12,6,0,12,18] 秒、车进/出返回道往返耗时 t_return = [24,18,12,6,12,18] 秒、道内相邻停车位前移耗时 t_move = 9 秒，以及题目中被允许忽略的装/卸瞬时假设），并将 PBS 规则中可选项（尤其约束6 与 7：返回道10 优先及进车道1 先到优先）实现为布尔配置项以便上层模块开/关；同时根据附件3 校验并输出完整的区域代码映射表（确认总数为 74，并标注涂装‑PBS 出车口、中位位置、各进车道1–10 位编码、返回道1–10 编码、接/送横移机与 PBS‑总装接车口编码），并生成车道容量和位序约束的静态检查报告（核对每道最多10位、每位最多1车的规则是否在初始数据上被违反）；明确输出交付物格式与位置（清洗后的附件1/2 CSV 或 Excel、长表格式的附件4 转换结果、region_code_mapping.csv、pbs_parameters.json、数据校验日志与错误列表），并建议实施工具与方法（推荐使用 Python + pandas/openpyxl 进行读取与转换、使用断言与 schema 校验库进行完整性检查、记录处理步骤与变更日志以保证可复现性）。该子任务不进行调度或仿真求解，其产出应为后续仿真/优化可直接加载的、格式一致且经校验的输入数据集与参数字典。",
    "子任务2的目标是以“可被执行的目标总装进车序列 σ”为决策变量，系统性地构造并评估一组高质量候选进车序列以最大化题目四项加权得分（混动车间隔 s1、四驱/两驱分块配比 s2、返回道使用次数 s3 及总完成时间 s4）的近似或精确值；为此要求本子任务完成如下工作：输入（清洗后的车辆属性表，包含每辆车的唯一ID、到达顺序、车型/动力/驱动等字段）后，定义 σ 为长度 C 的车辆ID序列，并明确定义并编码评分规则——严格按题目规则计算 s1（对 σ 从头到尾识别所有混动车并统计两者间非混动车数是否等于2 的违例数）与 s2（按从2变为4或从4变为2处断块并判断每块内4:2是否为1:1 的违例计数）；由于 s3（返回道使用次数）与 s4（基于物理调度的完成时 T）需要对缓冲与横移动作代价做时序估计，本子任务须提供两类评估手段：一是快速启发估算器——基于静态成本模型（使用给定的横移时矩阵、道内前移代价 t_move=9s、并假设合理的道位分配策略）计算每个 σ 的预计返回次数与预计完成时间的保守上界或经验值；二是可选的学习型代理（surrogate），用小规模精确仿真样本训练回归模型（例如随机森林或轻量神经网）以在候选搜索中快速预测 s3、s4，从而在搜索迭代中替代昂贵仿真。序列生成方法应包括：（a）基于问题启发的贪心初解构建器：保留涂装到达顺序的局部因果性（例如采用滑动窗口 W 限制的可重排策略），优先把期望快速出库的车辆放置到进车道4类低延迟通道尾位，并在插入时考虑混动车间隔与4/2平衡；（b）定义并实现多种邻域算子：相邻交换、任意位置插入、块交换、k-opt、以及“标记为返回道并在后续位置重插入”的复合操作（用于表示可能的长距离重排）；（c）采用元启发式搜索框架（可选遗传算法、模拟退火或迭代局部搜索/禁忌搜索）在序列空间中并行迭代：个体编码可为直接排列或基于优先级的列表调度编码以便高效交叉/变异且易于保持到达因果性约束；在每次变换后用精确计算的 s1、s2 与启发估算或代理模型预测的 s3、s4 计算综合适应度并用于选择与引导搜索；（d）实现约束处理与可配置策略参数：允许通过参数控制滑动窗口 W、返回操作的单位代价、邻域规模、种群大小与迭代次数，并保证产生的候选序列不会违反基本物理因果性（例如不安排某车在其到达之前进入出车口）——长距离重排必须以“需要使用返回道”的操作标注，以便后续时序验证；输出要求为：一组按得分排序的候选序列集合，每个序列附带精确计算的 s1、s2 值、启发或代理估算的 s3_est、s4_est、产生该序列所用的操作日志（插入/交换/返回标注）以及用于后续评估的元数据（如预计横移机调用次数、预估道位分配概要）；实现建议使用 Python（pandas/numpy 进行数据处理）、DEAP/pygad 等库实现遗传或模拟退火算法、scikit-learn 实现代理模型，并将所有算法参数与随机种子记录以保证可复现性。",
    "子任务3（PBS 物理仿真器与可行性验证器）要求独立实现一个精确、确定性的离散事件仿真（DES）内核，用以严格执行题目给定的 PBS 物理结构与操作规则并输出逐秒的车辆区域状态与关键运行指标。其范围与目标：输入为已清洗的车辆到达序列（按涂装‑PBS 出车口顺序）、PBS 参数字典（各进车道/返回道停车位数、横移机往返各道耗时数组 t_in/t_out/t_return、道内相邻位前移耗时 t_move=9s、被忽略的装卸瞬时假设等）、区域代码映射表；输出为（1）按实际进入 PBS‑总装接车口顺序生成的进车序列，(2) 最后一辆进入接车口的绝对时刻 T，(3) 返回道被使用的累计次数 R，(4) 按题目格式的 C × (T+1) 秒级矩阵（每行为一车，每列为该秒内最后到达区域的代码），以及详尽事件日志和状态快照用于验证。实现要点与步骤：使用事件队列（优先级堆）管理事件（车辆到达中位、接车横移机开始/结束、送车横移机开始/结束、道内车辆前移开始/结束、车辆装卸到总装或返回道等）；用明确的数据结构表示系统状态：每条进车道与返回道为长度为10的数组或循环队列记录各停车位占用与“正在前移”标志，横移机状态记录 busy 标志、当前动作目标道及动作完成时刻；为保证不可中断性，任何横移机开始动作即在事件队列中注册完成事件，期间禁止对该机调度其他动作；对道内前移实现原子动作：当位 p 变为空且位 p+1 有车时立即（在相同仿真时间点）计划一个耗时 t_move 的前移事件并标注该车在该区间不可被调度或移动（以满足题目第11、12条）；实现互斥规则确保任一停车位在任一时刻最多被一个车辆占用且在前移期间被锁定。优先与策略规则应作为可配置项实现（布尔开关）：约束6/7（当返回道10有车且接车机空闲优先处理；当若干进车道1有车且送车机空闲优先最先到达者）在仿真器中可启用或禁用；送车机不得直接将返回道车辆送入接车口等硬约束必须强制执行。时间建模细节：按题目假定将装卸到横移机与从横移机卸载到位的瞬时时间视为零，横移机动作耗时以给定常数表为准，从中位出发并在完成后隐式生成“返回中位”动作（即动作结束即处于中位空闲）；若在同一秒内车辆跨越多个区域，记录时刻列时以事件完成顺序最后发生的区域代码为该秒值。实现细节与健壮性：事件处理采用严格时间顺序且处理同一时刻多事件的确定性策略（例如先处理横移机完成，再处理前移开始，以明确冲突和优先级），对并发冲突使用可配置的 tie‑break 规则（首到优先或按车辆 ID），并在仿真开始前对输入完整性与容量约束做断言检查。验证与输出：在仿真后运行一致性校验（无重叠占用、道内 FIFO 保持、横移机不可同时承担两次动作、返回道/进道位容量未超限），并导出每秒区域矩阵、事件日志、横移机利用率曲线、各道位占用随时间变化的快照；为便于回溯与重复性，仿真应接受随机种子（仅影响并发 tie‑break）并在日志中记录所有配置参数和版本信息。性能与工程实现建议：推荐使用高性能语言或成熟 DES 库（例如 Python+heapq/SimPy、或 C++ 实现）以保证对 200–450 辆规模的多次仿真在秒级或数十秒内完成，事件复杂度近似 O(事件数)；支持批量并行仿真评估（多线程/多进程）与可视化输出（时序图、道位占用热力图）以便上层调度器调用与验证。总体要求：仿真器必须能在不依赖外部调度模块的情况下，单独接收输入参数严格执行所有物理与逻辑约束、切换约束6/7 的实现方式，并输出题目要求的逐秒状态矩阵与完整可验证的运行日志。",
    "子任务4（迭代优化与并行评估、稳健性分析与最终输出生成）应作为一个自包含的闭环优化与验证模块，其输入为：经清洗的车辆属性与到达顺序表（每车唯一ID、车型/动力/驱动等）、PBS参数字典（各进/返回道位数、横移机时长向量、道内前移耗时等）、可调用的PBS离散事件仿真器接口（输入候选进车序列或动作序列，输出按秒的车辆区域矩阵、实际进车序列、完成时间T、返回道使用次数R及事件日志）、以及评分函数实现（按题目规定计算s1—混动车间隔违例数、s2—4/2分块违例数、s3=R、s4基于T与基准时间的惩罚并合成加权总分S）；目标是以有限计算预算在可行空间内寻找并验证高得分的可执行调度方案并生成规定格式的最终输出和完整可复现日志。实现步骤与方法：一）初始化：根据输入生成初始候选集（多起点），可混合使用启发式构造（保留涂装到达顺序的局部性、优先放置低延迟通道车辆、先实现混动车/4‑2平衡的插入策略）与随机扰动以保证多样性；二）主搜索循环：采用元启发式框架（建议遗传算法或迭代局部搜索/模拟退火，支持并行种群评估），定义邻域算子集（相邻交换、任意位置插入、块交换、标记为返回并重新插入等复合算子），在每代/每轮对候选用仿真器严格评估得到真实指标（T、R、按秒矩阵）并计算S，用选择/交叉/变异或局部改进生成新候选；三）并行化与加速：并行化仿真评估（多进程/分布式任务队列）以提高吞吐，采用异步评估与缓存已评估序列结果避免重复仿真；对大规模搜索引入代理/代理模型（surrogate）作为筛选层：用已仿真样本训练回归模型（随机森林或LightGBM）预测R与T，用交叉验证控制代理误差并周期性用真实仿真更新训练集与重训练以避免偏差累积；四）自适应控制：在搜索过程中记录操作有效性并采用自适应算子选择（提升对改善S贡献大的算子的使用频率），并实现重启策略和多起点并行以防早期收敛；五）终止准则与精验：按给定的终止条件（最大仿真次数、最大时间或多代无改进）结束搜索，取前K个候选在仿真器上做最后一次高精度验证（同一随机种子、完整日志记录），生成最终的按秒区域矩阵输出和唯一的最终进车序列；六）稳健性与敏感性分析：对最终候选执行一组预定义扰动实验（例如涂装到达时刻加入 ±Δt 噪声若干次重复、横移/前移时间±10%场景、启用/禁用优先规则6/7的对比），统计得分分布、最坏/均值/方差，评估策略对输入与设备参数扰动的稳健性；七）输出与可复现性：将最终按秒矩阵以题目规定格式写入 Excel/CSV（并包含区域代码映射），同时导出每个候选的摘要 CSV（S、s1–s4、T、R）、完整事件日志、仿真快照、代理模型文件（若使用）、运行配置文件（包含所有算法参数、随机种子、PBS参数、版本信息）和迭代历史以便审计与重复实验；八）实施细节与工具建议：推荐使用 Python 生态（pandas/numpy、multiprocessing/joblib、DEAP/pygad 或自实现元启发式、scikit‑learn/LightGBM 作 surrogate、openpyxl/xlsxwriter 生成 Excel、heapq/SimPy 或 C++ 后端做高性能仿真接口），并在并行环境下合理分配核心用于仿真评估以保证整体效率。整个子任务应以可配置、可复现、日志充分的工程化流程交付——明确保存输入快照、所有随机种子和最终输出路径，且在终稿中包含一份简短的执行报告（最优候选的S分解、T、R、扰动测试摘要和关键算法参数）。"
  ]
}