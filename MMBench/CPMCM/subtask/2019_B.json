{
  "tasks": [],
  "problem_str": "问题背景：\n天文导航（Celestial Navigation）是基于天体已知的坐标位置和运动规律，应用观测天体的天文坐标值来确定航行体的空间位置等导航参数。与其他导航技术相比，天文导航是一种自主式导航，不需要地面设备，不受人工或自然形成的电磁场的干扰，不向外界辐射能量，隐蔽性好，而且定姿、定向、定位精度高，定位误差与时间无关，已被广泛用于卫星、航天飞机、远程弹道导弹等航天器。天文导航的若干背景知识可参阅附件1。\n\n星敏感器是实现航行体自主姿态测量的核心部件，是通过观测太空中的恒星来实现高精度姿态测量。恒星是用于天文导航最重要的一类天体。对天文导航而言，恒星可以看成是位于无穷远处的，近似静止不动的，具有一定光谱特性的理想点光源。\n\n借助天球坐标系，可用赤经与赤纬来描述恒星在某一时刻位置信息（相关定义和概念可参考附件1）。恒星在天球球面上的投影点称为恒星的位置。将星空中恒星的相关数据，按不同的需求编制而成的表册，称为星表。星表是星图识别的主要依据，也是姿态确定的基准。常用的星表中通常列有恒星的位置、自行、星等（亮度）、颜色和距离等丰富的信息。对于天文导航而言，感兴趣的信息主要是恒星的位置和星等。附件2提供了一个简易的星表，提供了部分恒星在天球坐标系下的位置（以赤经、赤纬来标记，单位：角度）和星等信息。\n\n全天自主的星图识别是星敏感器技术中的一项关键技术。星图识别是将星敏感器当前视场中的恒星（星图）与导航星库中的参考星进行对应匹配，以完成视场中恒星的识别。星图识别一般包括图像采集及预处理、特征提取、匹配识别等过程。\n\n图像预处理包括去除噪声和星点质心提取。为简化，本赛题暂不考虑具体的去除噪声和质心提取等问题，认为所讨论的星图图像已经完成了图像预处理。\n\n导航数据库一般包括两部分：导航星表和导航星特征数据库。导航星表是从基本星表中挑选一定亮度范围的导航星，利用其位置（赤经、赤纬）和亮度信息编制而成的简易星表。星敏感器除了需要构建导航星表外，还需要按照特征提取算法，构造导航星的特征向量，存储由特征向量构成的导航星特征数据库。\n\n提取出观测星的特征后，就可以寻找特征类似的导航星。如果找到特征唯一接近的导航星，即可认为二者匹配。匹配识别过程和提取特征的方法紧密相关。本赛题暂不考虑后续的航行体定姿定位问题。\n\n在星图识别的相关工作中需要用到天球坐标系、星敏感器坐标系、星敏感器图像坐标系等。其简单定义为：\n\n(1) 天球坐标系。以天赤道为基圈，过春分点的时圈为主圈，春分点为主点。天球坐标系采用赤经、赤纬作为坐标量。参见附件1相关叙述。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=0.8\\textwidth]{image.png}\n    \\caption{星敏感器坐标系、图像坐标系及前视投影成像示意图}\n\\end{figure}\n\n(2) 星敏感器坐标系。以投影中心 $O$（光轴上与感光面距离为 $f$ 的点，即光心，参见图1）为坐标原点，以光轴为 $Z$ 轴（后面的讨论中，光轴 $OO'$ 与天球面的交点记为 $D$ 点），过 $O$ 点平行于感光面两边的直线作为 $X$ 轴和 $Y$ 轴。图1为星敏感器坐标系、图像坐标系及前视投影成像示意图。\n\n(3) 图像坐标系。以感光面的中心 $O'$（$O$ 点在该平面上的投影点）为坐标原点，平行于感光面两边的直线为 $X$ 轴和 $Y$ 轴的平面坐标系，参见图1。\n\n问题要求：\n请你们团队利用附件提供的相关背景材料和数据，建模分析下面问题：\n\n问题 1 $P_1$、$P_2$、$P_3$ 是 3 颗已知位置的恒星，即它们在天球坐标系下的赤经和赤纬 $\\left( \\left( \\alpha_i, \\delta_i \\right), i=1,2,3 \\right)$ 已知；$Q_1$、$Q_2$、$Q_3$ 是来自恒星 $P_1$、$P_2$、$P_3$ 的平行光经过星敏感器光学系统成像在感光面上的星像点质心中心位置（参见图1）；记 $O'Q_1 = a_1$，$O'Q_2 = a_2$，$O'Q_3 = a_3$，$OO' = f$。\n\n(1) 建立由 $f$，$a_i$，$\\left( \\alpha_i, \\delta_i \\right)$（$i=1,2,3$）等参数解算 $D$ 点在天球坐标系的位置信息的数学模型，并给出具体的求解算法；\n\n(2) 若不利用 $f$ 值的信息，试建立由 $a_i$，$\\left( \\alpha_i, \\delta_i \\right)$（$i=1,2,3$）等参数求解 $D$点在天球坐标系中的位置信息的数学模型，并给出具体的求解算法；\n\n(3) 一般来说，星敏感器视场内的恒星数量多于3颗，请讨论如何选择不同几何位置的三颗星，提高解算 $D$ 点在天球坐标系中的位置信息的精度，并分析相应的误差。\n\n问题2 传统的星图识别方法主要是以角距（即星与星之间的球心角，可直观理解为两颗恒星分别与地心连线之间的夹角）或其衍生的形式为特征，这类方法比较简单，但一般需要较大的存储空间，识别算法实时性不好，且识别率普遍不高。通过对星图中的星点信息进行更为精细的特征提取，构建更高层次的特征，可能会提高星图识别算法的实时性和降低误匹配率。基于附件2提供的简易星表信息，请构建相应的特征提取模型，设计对应的星图识别算法，确定出附件3给出的8幅星图中每一个星像点所对应的恒星编号（对应附件2简易星表的恒星编号），并对算法的性能进行评估。\nAddendum: \n本赛题暂不考虑具体的去除噪声和质心提取等问题，认为所讨论的星图图像已经完成了图像预处理。本赛题暂不考虑后续的航行体定姿定位问题。\nDataset Path:\n['附件1_相关背景知识和附件2、附件3的说明.docx', '附件2_简易星表.mat', 'xingtu01.xlsx', 'xingtu02.xlsx', 'xingtu03.xlsx', 'xingtu04.xlsx', 'xingtu05.xlsx', 'xingtu06.xlsx', 'xingtu07.xlsx', 'xingtu08.xlsx']\n\nData Description:\n该数据集由三类主要文件构成：一份说明性文档（附件1_相关背景知识和附件2、附件3的说明.docx），一份简易星表（附件2_简易星表.mat）以及若干星图/质心坐标数据表（多个 xingtu0x.xlsx 文件，附件3 含 8 幅星图数据的说明）。说明文档提供了天文导航、天球坐标系、常用星表介绍和星图识别算法性能评估的背景知识，并对后续星表与星图数据的内容和使用方法作了说明；简易星表包含恒星编号、赤经、赤纬和视星等等天球坐标与亮度信息，可用于星敏感器建模与天体匹配；星图数据集由多份 Excel 表组成，主要记录了星像点在星敏感器感光面上的质心中心位置（X、Y 像素坐标）以及部分文件中对应的天球坐标（赤经、赤纬），数据文件格式包括带字段标识的多列表格与若干空表单（例如 xingtu02 的 Sheet2、Sheet3 为空），并在不同文件中以不同单位表示赤经/赤纬（有处以弧度、有处以度）与像素坐标，需在处理前统一单位与参考系。数据集中星像点标识符使用统一的编码习惯（如 A01–A15、F01–F12、Gxx、Dxx 等），部分表格提供了明确的字段映射说明（如字段1 为标识符、字段2/3 为 X/Y 像素坐标），部分表格还包含了实际示例坐标值（像素级 X、Y 值分布在几十到数百像素范围），整体适用于星敏感器成像几何分析、恒星定位与匹配、星图识别算法性能评估与标定实验，但在使用前需注意不同文件间单位与格式的不一致并进行必要的预处理与坐标转换。",
  "problem": {
    "background": "天文导航（Celestial Navigation）是基于天体已知的坐标位置和运动规律，应用观测天体的天文坐标值来确定航行体的空间位置等导航参数。与其他导航技术相比，天文导航是一种自主式导航，不需要地面设备，不受人工或自然形成的电磁场的干扰，不向外界辐射能量，隐蔽性好，而且定姿、定向、定位精度高，定位误差与时间无关，已被广泛用于卫星、航天飞机、远程弹道导弹等航天器。天文导航的若干背景知识可参阅附件1。\n\n星敏感器是实现航行体自主姿态测量的核心部件，是通过观测太空中的恒星来实现高精度姿态测量。恒星是用于天文导航最重要的一类天体。对天文导航而言，恒星可以看成是位于无穷远处的，近似静止不动的，具有一定光谱特性的理想点光源。\n\n借助天球坐标系，可用赤经与赤纬来描述恒星在某一时刻位置信息（相关定义和概念可参考附件1）。恒星在天球球面上的投影点称为恒星的位置。将星空中恒星的相关数据，按不同的需求编制而成的表册，称为星表。星表是星图识别的主要依据，也是姿态确定的基准。常用的星表中通常列有恒星的位置、自行、星等（亮度）、颜色和距离等丰富的信息。对于天文导航而言，感兴趣的信息主要是恒星的位置和星等。附件2提供了一个简易的星表，提供了部分恒星在天球坐标系下的位置（以赤经、赤纬来标记，单位：角度）和星等信息。\n\n全天自主的星图识别是星敏感器技术中的一项关键技术。星图识别是将星敏感器当前视场中的恒星（星图）与导航星库中的参考星进行对应匹配，以完成视场中恒星的识别。星图识别一般包括图像采集及预处理、特征提取、匹配识别等过程。\n\n图像预处理包括去除噪声和星点质心提取。为简化，本赛题暂不考虑具体的去除噪声和质心提取等问题，认为所讨论的星图图像已经完成了图像预处理。\n\n导航数据库一般包括两部分：导航星表和导航星特征数据库。导航星表是从基本星表中挑选一定亮度范围的导航星，利用其位置（赤经、赤纬）和亮度信息编制而成的简易星表。星敏感器除了需要构建导航星表外，还需要按照特征提取算法，构造导航星的特征向量，存储由特征向量构成的导航星特征数据库。\n\n提取出观测星的特征后，就可以寻找特征类似的导航星。如果找到特征唯一接近的导航星，即可认为二者匹配。匹配识别过程和提取特征的方法紧密相关。本赛题暂不考虑后续的航行体定姿定位问题。\n\n在星图识别的相关工作中需要用到天球坐标系、星敏感器坐标系、星敏感器图像坐标系等。其简单定义为：\n\n(1) 天球坐标系。以天赤道为基圈，过春分点的时圈为主圈，春分点为主点。天球坐标系采用赤经、赤纬作为坐标量。参见附件1相关叙述。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=0.8\\textwidth]{image.png}\n    \\caption{星敏感器坐标系、图像坐标系及前视投影成像示意图}\n\\end{figure}\n\n(2) 星敏感器坐标系。以投影中心 $O$（光轴上与感光面距离为 $f$ 的点，即光心，参见图1）为坐标原点，以光轴为 $Z$ 轴（后面的讨论中，光轴 $OO'$ 与天球面的交点记为 $D$ 点），过 $O$ 点平行于感光面两边的直线作为 $X$ 轴和 $Y$ 轴。图1为星敏感器坐标系、图像坐标系及前视投影成像示意图。\n\n(3) 图像坐标系。以感光面的中心 $O'$（$O$ 点在该平面上的投影点）为坐标原点，平行于感光面两边的直线为 $X$ 轴和 $Y$ 轴的平面坐标系，参见图1。",
    "problem_requirement": "请你们团队利用附件提供的相关背景材料和数据，建模分析下面问题：\n\n问题 1 $P_1$、$P_2$、$P_3$ 是 3 颗已知位置的恒星，即它们在天球坐标系下的赤经和赤纬 $\\left( \\left( \\alpha_i, \\delta_i \\right), i=1,2,3 \\right)$ 已知；$Q_1$、$Q_2$、$Q_3$ 是来自恒星 $P_1$、$P_2$、$P_3$ 的平行光经过星敏感器光学系统成像在感光面上的星像点质心中心位置（参见图1）；记 $O'Q_1 = a_1$，$O'Q_2 = a_2$，$O'Q_3 = a_3$，$OO' = f$。\n\n(1) 建立由 $f$，$a_i$，$\\left( \\alpha_i, \\delta_i \\right)$（$i=1,2,3$）等参数解算 $D$ 点在天球坐标系的位置信息的数学模型，并给出具体的求解算法；\n\n(2) 若不利用 $f$ 值的信息，试建立由 $a_i$，$\\left( \\alpha_i, \\delta_i \\right)$（$i=1,2,3$）等参数求解 $D$点在天球坐标系中的位置信息的数学模型，并给出具体的求解算法；\n\n(3) 一般来说，星敏感器视场内的恒星数量多于3颗，请讨论如何选择不同几何位置的三颗星，提高解算 $D$ 点在天球坐标系中的位置信息的精度，并分析相应的误差。\n\n问题2 传统的星图识别方法主要是以角距（即星与星之间的球心角，可直观理解为两颗恒星分别与地心连线之间的夹角）或其衍生的形式为特征，这类方法比较简单，但一般需要较大的存储空间，识别算法实时性不好，且识别率普遍不高。通过对星图中的星点信息进行更为精细的特征提取，构建更高层次的特征，可能会提高星图识别算法的实时性和降低误匹配率。基于附件2提供的简易星表信息，请构建相应的特征提取模型，设计对应的星图识别算法，确定出附件3给出的8幅星图中每一个星像点所对应的恒星编号（对应附件2简易星表的恒星编号），并对算法的性能进行评估。",
    "dataset_path": [
      "附件1_相关背景知识和附件2、附件3的说明.docx",
      "附件2_简易星表.mat",
      "xingtu01.xlsx",
      "xingtu02.xlsx",
      "xingtu03.xlsx",
      "xingtu04.xlsx",
      "xingtu05.xlsx",
      "xingtu06.xlsx",
      "xingtu07.xlsx",
      "xingtu08.xlsx"
    ],
    "dataset_description": {
      "附件1_相关背景知识和附件2、附件3的说明": "附件1_相关背景知识和附件2、附件3的说明.docx提供了关于天文导航、天球坐标系、星表以及星图识别算法性能评估的相关背景知识。文件还详细说明了附件2和附件3的内容，其中附件2是一个简易星表，包含恒星编号、赤经、赤纬和星等信息；附件3包含8幅星图数据，记录了星像点在图像坐标系中的位置信息。",
      "附件2_简易星表": "附件2_简易星表.mat包含一系列恒星的天球坐标信息，包括赤经、赤纬和视星等。这些数据用于星敏感器的建模分析。",
      "xingtu01": "xingtu01.xlsx包含星敏感器感光面上的星像点质心中心位置数据，用于分析恒星在天球坐标系中的位置信息。",
      "xingtu02": "xingtu02.xlsx包含恒星在天球坐标系下的赤经和赤纬数据，以及可能的星像点质心中心位置数据。Sheet1包含恒星的赤经和赤纬数据，Sheet2和Sheet3目前为空。",
      "xingtu03": "xingtu03.xlsx包含星敏感器感光面上的星像点质心中心位置数据，用于分析恒星在天球坐标系中的位置信息。",
      "xingtu05": "xingtu05.xlsx包含星敏感器感光面上的星像点质心中心位置数据，用于分析恒星在天球坐标系中的位置信息。",
      "xingtu06": "xingtu06.xlsx包含星敏感器光学系统成像在感光面上的星像点质心中心位置数据，用于分析恒星位置与感光面上成像点之间的关系。",
      "xingtu07": "xingtu07.xlsx包含星敏感器感光面上的星像点质心中心位置数据，用于分析恒星成像在感光面上的位置信息。"
    },
    "variable_description": [
      {},
      {
        "0": "恒星编号",
        "1": "赤经（单位：弧度）",
        "2": "赤纬（单位：度）",
        "3": "视星等"
      },
      {
        "A01": "星像点A01的质心中心位置",
        "A02": "星像点A02的质心中心位置",
        "A03": "星像点A03的质心中心位置",
        "A04": "星像点A04的质心中心位置",
        "A05": "星像点A05的质心中心位置",
        "A06": "星像点A06的质心中心位置",
        "A07": "星像点A07的质心中心位置",
        "A08": "星像点A08的质心中心位置",
        "A09": "星像点A09的质心中心位置",
        "A10": "星像点A10的质心中心位置",
        "A11": "星像点A11的质心中心位置",
        "A12": "星像点A12的质心中心位置",
        "A13": "星像点A13的质心中心位置",
        "A14": "星像点A14的质心中心位置",
        "A15": "星像点A15的质心中心位置",
        "字段1": "星像点的标识符",
        "字段2": "星像点质心中心位置的X坐标",
        "字段3": "星像点质心中心位置的Y坐标"
      },
      {
        "B01": "恒星标识符",
        "24.23": "赤经（单位：度）",
        "38.41": "赤纬（单位：度）"
      },
      {
        "C01": "星像点质心中心位置的标识符",
        "C02": "星像点质心中心位置的横坐标值（单位：像素）",
        "C03": "星像点质心中心位置的纵坐标值（单位：像素）"
      },
      {
        "Dxx": "恒星的标识符，其中 xx 是两位数字，表示不同的恒星",
        "第一列": "赤经（单位：度），表示恒星在天球坐标系中的经度位置",
        "第二列": "赤纬（单位：度），表示恒星在天球坐标系中的纬度位置"
      },
      {
        "E01": "恒星编号",
        "E02": "星像点质心中心位置的横坐标值 (单位: 像素)",
        "E03": "星像点质心中心位置的纵坐标值 (单位: 像素)"
      },
      {
        "F01": "星像点质心中心位置标识符",
        "18.12": "星像点质心中心位置的横坐标值（单位：像素）",
        "376.81": "星像点质心中心位置的纵坐标值（单位：像素）",
        "F02": "星像点质心中心位置标识符",
        "45.17": "星像点质心中心位置的横坐标值（单位：像素）",
        "9.17": "星像点质心中心位置的纵坐标值（单位：像素）",
        "F03": "星像点质心中心位置标识符",
        "78.56": "星像点质心中心位置的横坐标值（单位：像素）",
        "78.44": "星像点质心中心位置的纵坐标值（单位：像素）",
        "F04": "星像点质心中心位置标识符",
        "105.59": "星像点质心中心位置的横坐标值（单位：像素）",
        "299.34": "星像点质心中心位置的纵坐标值（单位：像素）",
        "F05": "星像点质心中心位置标识符",
        "145.50": "星像点质心中心位置的横坐标值（单位：像素）",
        "264.35": "星像点质心中心位置的纵坐标值（单位：像素）",
        "F06": "星像点质心中心位置标识符",
        "213.02": "星像点质心中心位置的横坐标值（单位：像素）",
        "407.92": "星像点质心中心位置的纵坐标值（单位：像素）",
        "F07": "星像点质心中心位置标识符",
        "240.85": "星像点质心中心位置的横坐标值（单位：像素）",
        "52.77": "星像点质心中心位置的纵坐标值（单位：像素）",
        "F08": "星像点质心中心位置标识符",
        "231.25": "星像点质心中心位置的横坐标值（单位：像素）",
        "63.51": "星像点质心中心位置的纵坐标值（单位：像素）",
        "F09": "星像点质心中心位置标识符",
        "280.04": "星像点质心中心位置的横坐标值（单位：像素）",
        "326.91": "星像点质心中心位置的纵坐标值（单位：像素）",
        "F10": "星像点质心中心位置标识符",
        "352.93": "星像点质心中心位置的横坐标值（单位：像素）",
        "184.78": "星像点质心中心位置的纵坐标值（单位：像素）",
        "F11": "星像点质心中心位置标识符",
        "420.78": "星像点质心中心位置的横坐标值（单位：像素）",
        "338.27": "星像点质心中心位置的纵坐标值（单位：像素）",
        "F12": "星像点质心中心位置标识符",
        "465.44": "星像点质心中心位置的横坐标值（单位：像素）",
        "101.18": "星像点质心中心位置的纵坐标值（单位：像素）"
      },
      {
        "Gxx": "星像点的标识符，其中xx为两位数字，表示不同的星像点。",
        "字段1": "星像点在感光面上的X坐标值，单位为像素。",
        "字段2": "星像点在感光面上的Y坐标值，单位为像素。"
      },
      {}
    ],
    "addendum": "本赛题暂不考虑具体的去除噪声和质心提取等问题，认为所讨论的星图图像已经完成了图像预处理。本赛题暂不考虑后续的航行体定姿定位问题。",
    "data_summary": "Dataset Path:\n['附件1_相关背景知识和附件2、附件3的说明.docx', '附件2_简易星表.mat', 'xingtu01.xlsx', 'xingtu02.xlsx', 'xingtu03.xlsx', 'xingtu04.xlsx', 'xingtu05.xlsx', 'xingtu06.xlsx', 'xingtu07.xlsx', 'xingtu08.xlsx']\n\nData Description:\n该数据集由三类主要文件构成：一份说明性文档（附件1_相关背景知识和附件2、附件3的说明.docx），一份简易星表（附件2_简易星表.mat）以及若干星图/质心坐标数据表（多个 xingtu0x.xlsx 文件，附件3 含 8 幅星图数据的说明）。说明文档提供了天文导航、天球坐标系、常用星表介绍和星图识别算法性能评估的背景知识，并对后续星表与星图数据的内容和使用方法作了说明；简易星表包含恒星编号、赤经、赤纬和视星等等天球坐标与亮度信息，可用于星敏感器建模与天体匹配；星图数据集由多份 Excel 表组成，主要记录了星像点在星敏感器感光面上的质心中心位置（X、Y 像素坐标）以及部分文件中对应的天球坐标（赤经、赤纬），数据文件格式包括带字段标识的多列表格与若干空表单（例如 xingtu02 的 Sheet2、Sheet3 为空），并在不同文件中以不同单位表示赤经/赤纬（有处以弧度、有处以度）与像素坐标，需在处理前统一单位与参考系。数据集中星像点标识符使用统一的编码习惯（如 A01–A15、F01–F12、Gxx、Dxx 等），部分表格提供了明确的字段映射说明（如字段1 为标识符、字段2/3 为 X/Y 像素坐标），部分表格还包含了实际示例坐标值（像素级 X、Y 值分布在几十到数百像素范围），整体适用于星敏感器成像几何分析、恒星定位与匹配、星图识别算法性能评估与标定实验，但在使用前需注意不同文件间单位与格式的不一致并进行必要的预处理与坐标转换。",
    "data_description": {
      "附件1_相关背景知识和附件2、附件3的说明": "附件1_相关背景知识和附件2、附件3的说明.docx提供了关于天文导航、天球坐标系、星表以及星图识别算法性能评估的相关背景知识。文件还详细说明了附件2和附件3的内容，其中附件2是一个简易星表，包含恒星编号、赤经、赤纬和星等信息；附件3包含8幅星图数据，记录了星像点在图像坐标系中的位置信息。",
      "附件2_简易星表": "附件2_简易星表.mat包含一系列恒星的天球坐标信息，包括赤经、赤纬和视星等。这些数据用于星敏感器的建模分析。",
      "xingtu01": "xingtu01.xlsx包含星敏感器感光面上的星像点质心中心位置数据，用于分析恒星在天球坐标系中的位置信息。",
      "xingtu02": "xingtu02.xlsx包含恒星在天球坐标系下的赤经和赤纬数据，以及可能的星像点质心中心位置数据。Sheet1包含恒星的赤经和赤纬数据，Sheet2和Sheet3目前为空。",
      "xingtu03": "xingtu03.xlsx包含星敏感器感光面上的星像点质心中心位置数据，用于分析恒星在天球坐标系中的位置信息。",
      "xingtu05": "xingtu05.xlsx包含星敏感器感光面上的星像点质心中心位置数据，用于分析恒星在天球坐标系中的位置信息。",
      "xingtu06": "xingtu06.xlsx包含星敏感器光学系统成像在感光面上的星像点质心中心位置数据，用于分析恒星位置与感光面上成像点之间的关系。",
      "xingtu07": "xingtu07.xlsx包含星敏感器感光面上的星像点质心中心位置数据，用于分析恒星成像在感光面上的位置信息。"
    },
    "problem_str": "问题背景：\n天文导航（Celestial Navigation）是基于天体已知的坐标位置和运动规律，应用观测天体的天文坐标值来确定航行体的空间位置等导航参数。与其他导航技术相比，天文导航是一种自主式导航，不需要地面设备，不受人工或自然形成的电磁场的干扰，不向外界辐射能量，隐蔽性好，而且定姿、定向、定位精度高，定位误差与时间无关，已被广泛用于卫星、航天飞机、远程弹道导弹等航天器。天文导航的若干背景知识可参阅附件1。\n\n星敏感器是实现航行体自主姿态测量的核心部件，是通过观测太空中的恒星来实现高精度姿态测量。恒星是用于天文导航最重要的一类天体。对天文导航而言，恒星可以看成是位于无穷远处的，近似静止不动的，具有一定光谱特性的理想点光源。\n\n借助天球坐标系，可用赤经与赤纬来描述恒星在某一时刻位置信息（相关定义和概念可参考附件1）。恒星在天球球面上的投影点称为恒星的位置。将星空中恒星的相关数据，按不同的需求编制而成的表册，称为星表。星表是星图识别的主要依据，也是姿态确定的基准。常用的星表中通常列有恒星的位置、自行、星等（亮度）、颜色和距离等丰富的信息。对于天文导航而言，感兴趣的信息主要是恒星的位置和星等。附件2提供了一个简易的星表，提供了部分恒星在天球坐标系下的位置（以赤经、赤纬来标记，单位：角度）和星等信息。\n\n全天自主的星图识别是星敏感器技术中的一项关键技术。星图识别是将星敏感器当前视场中的恒星（星图）与导航星库中的参考星进行对应匹配，以完成视场中恒星的识别。星图识别一般包括图像采集及预处理、特征提取、匹配识别等过程。\n\n图像预处理包括去除噪声和星点质心提取。为简化，本赛题暂不考虑具体的去除噪声和质心提取等问题，认为所讨论的星图图像已经完成了图像预处理。\n\n导航数据库一般包括两部分：导航星表和导航星特征数据库。导航星表是从基本星表中挑选一定亮度范围的导航星，利用其位置（赤经、赤纬）和亮度信息编制而成的简易星表。星敏感器除了需要构建导航星表外，还需要按照特征提取算法，构造导航星的特征向量，存储由特征向量构成的导航星特征数据库。\n\n提取出观测星的特征后，就可以寻找特征类似的导航星。如果找到特征唯一接近的导航星，即可认为二者匹配。匹配识别过程和提取特征的方法紧密相关。本赛题暂不考虑后续的航行体定姿定位问题。\n\n在星图识别的相关工作中需要用到天球坐标系、星敏感器坐标系、星敏感器图像坐标系等。其简单定义为：\n\n(1) 天球坐标系。以天赤道为基圈，过春分点的时圈为主圈，春分点为主点。天球坐标系采用赤经、赤纬作为坐标量。参见附件1相关叙述。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=0.8\\textwidth]{image.png}\n    \\caption{星敏感器坐标系、图像坐标系及前视投影成像示意图}\n\\end{figure}\n\n(2) 星敏感器坐标系。以投影中心 $O$（光轴上与感光面距离为 $f$ 的点，即光心，参见图1）为坐标原点，以光轴为 $Z$ 轴（后面的讨论中，光轴 $OO'$ 与天球面的交点记为 $D$ 点），过 $O$ 点平行于感光面两边的直线作为 $X$ 轴和 $Y$ 轴。图1为星敏感器坐标系、图像坐标系及前视投影成像示意图。\n\n(3) 图像坐标系。以感光面的中心 $O'$（$O$ 点在该平面上的投影点）为坐标原点，平行于感光面两边的直线为 $X$ 轴和 $Y$ 轴的平面坐标系，参见图1。\n\n问题要求：\n请你们团队利用附件提供的相关背景材料和数据，建模分析下面问题：\n\n问题 1 $P_1$、$P_2$、$P_3$ 是 3 颗已知位置的恒星，即它们在天球坐标系下的赤经和赤纬 $\\left( \\left( \\alpha_i, \\delta_i \\right), i=1,2,3 \\right)$ 已知；$Q_1$、$Q_2$、$Q_3$ 是来自恒星 $P_1$、$P_2$、$P_3$ 的平行光经过星敏感器光学系统成像在感光面上的星像点质心中心位置（参见图1）；记 $O'Q_1 = a_1$，$O'Q_2 = a_2$，$O'Q_3 = a_3$，$OO' = f$。\n\n(1) 建立由 $f$，$a_i$，$\\left( \\alpha_i, \\delta_i \\right)$（$i=1,2,3$）等参数解算 $D$ 点在天球坐标系的位置信息的数学模型，并给出具体的求解算法；\n\n(2) 若不利用 $f$ 值的信息，试建立由 $a_i$，$\\left( \\alpha_i, \\delta_i \\right)$（$i=1,2,3$）等参数求解 $D$点在天球坐标系中的位置信息的数学模型，并给出具体的求解算法；\n\n(3) 一般来说，星敏感器视场内的恒星数量多于3颗，请讨论如何选择不同几何位置的三颗星，提高解算 $D$ 点在天球坐标系中的位置信息的精度，并分析相应的误差。\n\n问题2 传统的星图识别方法主要是以角距（即星与星之间的球心角，可直观理解为两颗恒星分别与地心连线之间的夹角）或其衍生的形式为特征，这类方法比较简单，但一般需要较大的存储空间，识别算法实时性不好，且识别率普遍不高。通过对星图中的星点信息进行更为精细的特征提取，构建更高层次的特征，可能会提高星图识别算法的实时性和降低误匹配率。基于附件2提供的简易星表信息，请构建相应的特征提取模型，设计对应的星图识别算法，确定出附件3给出的8幅星图中每一个星像点所对应的恒星编号（对应附件2简易星表的恒星编号），并对算法的性能进行评估。\nAddendum: \n本赛题暂不考虑具体的去除噪声和质心提取等问题，认为所讨论的星图图像已经完成了图像预处理。本赛题暂不考虑后续的航行体定姿定位问题。\nDataset Path:\n['附件1_相关背景知识和附件2、附件3的说明.docx', '附件2_简易星表.mat', 'xingtu01.xlsx', 'xingtu02.xlsx', 'xingtu03.xlsx', 'xingtu04.xlsx', 'xingtu05.xlsx', 'xingtu06.xlsx', 'xingtu07.xlsx', 'xingtu08.xlsx']\n\nData Description:\n该数据集由三类主要文件构成：一份说明性文档（附件1_相关背景知识和附件2、附件3的说明.docx），一份简易星表（附件2_简易星表.mat）以及若干星图/质心坐标数据表（多个 xingtu0x.xlsx 文件，附件3 含 8 幅星图数据的说明）。说明文档提供了天文导航、天球坐标系、常用星表介绍和星图识别算法性能评估的背景知识，并对后续星表与星图数据的内容和使用方法作了说明；简易星表包含恒星编号、赤经、赤纬和视星等等天球坐标与亮度信息，可用于星敏感器建模与天体匹配；星图数据集由多份 Excel 表组成，主要记录了星像点在星敏感器感光面上的质心中心位置（X、Y 像素坐标）以及部分文件中对应的天球坐标（赤经、赤纬），数据文件格式包括带字段标识的多列表格与若干空表单（例如 xingtu02 的 Sheet2、Sheet3 为空），并在不同文件中以不同单位表示赤经/赤纬（有处以弧度、有处以度）与像素坐标，需在处理前统一单位与参考系。数据集中星像点标识符使用统一的编码习惯（如 A01–A15、F01–F12、Gxx、Dxx 等），部分表格提供了明确的字段映射说明（如字段1 为标识符、字段2/3 为 X/Y 像素坐标），部分表格还包含了实际示例坐标值（像素级 X、Y 值分布在几十到数百像素范围），整体适用于星敏感器成像几何分析、恒星定位与匹配、星图识别算法性能评估与标定实验，但在使用前需注意不同文件间单位与格式的不一致并进行必要的预处理与坐标转换。"
  },
  "problem_background": "天文导航（Celestial Navigation）是基于天体已知的坐标位置和运动规律，应用观测天体的天文坐标值来确定航行体的空间位置等导航参数。与其他导航技术相比，天文导航是一种自主式导航，不需要地面设备，不受人工或自然形成的电磁场的干扰，不向外界辐射能量，隐蔽性好，而且定姿、定向、定位精度高，定位误差与时间无关，已被广泛用于卫星、航天飞机、远程弹道导弹等航天器。天文导航的若干背景知识可参阅附件1。\n\n星敏感器是实现航行体自主姿态测量的核心部件，是通过观测太空中的恒星来实现高精度姿态测量。恒星是用于天文导航最重要的一类天体。对天文导航而言，恒星可以看成是位于无穷远处的，近似静止不动的，具有一定光谱特性的理想点光源。\n\n借助天球坐标系，可用赤经与赤纬来描述恒星在某一时刻位置信息（相关定义和概念可参考附件1）。恒星在天球球面上的投影点称为恒星的位置。将星空中恒星的相关数据，按不同的需求编制而成的表册，称为星表。星表是星图识别的主要依据，也是姿态确定的基准。常用的星表中通常列有恒星的位置、自行、星等（亮度）、颜色和距离等丰富的信息。对于天文导航而言，感兴趣的信息主要是恒星的位置和星等。附件2提供了一个简易的星表，提供了部分恒星在天球坐标系下的位置（以赤经、赤纬来标记，单位：角度）和星等信息。\n\n全天自主的星图识别是星敏感器技术中的一项关键技术。星图识别是将星敏感器当前视场中的恒星（星图）与导航星库中的参考星进行对应匹配，以完成视场中恒星的识别。星图识别一般包括图像采集及预处理、特征提取、匹配识别等过程。\n\n图像预处理包括去除噪声和星点质心提取。为简化，本赛题暂不考虑具体的去除噪声和质心提取等问题，认为所讨论的星图图像已经完成了图像预处理。\n\n导航数据库一般包括两部分：导航星表和导航星特征数据库。导航星表是从基本星表中挑选一定亮度范围的导航星，利用其位置（赤经、赤纬）和亮度信息编制而成的简易星表。星敏感器除了需要构建导航星表外，还需要按照特征提取算法，构造导航星的特征向量，存储由特征向量构成的导航星特征数据库。\n\n提取出观测星的特征后，就可以寻找特征类似的导航星。如果找到特征唯一接近的导航星，即可认为二者匹配。匹配识别过程和提取特征的方法紧密相关。本赛题暂不考虑后续的航行体定姿定位问题。\n\n在星图识别的相关工作中需要用到天球坐标系、星敏感器坐标系、星敏感器图像坐标系等。其简单定义为：\n\n(1) 天球坐标系。以天赤道为基圈，过春分点的时圈为主圈，春分点为主点。天球坐标系采用赤经、赤纬作为坐标量。参见附件1相关叙述。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=0.8\\textwidth]{image.png}\n    \\caption{星敏感器坐标系、图像坐标系及前视投影成像示意图}\n\\end{figure}\n\n(2) 星敏感器坐标系。以投影中心 $O$（光轴上与感光面距离为 $f$ 的点，即光心，参见图1）为坐标原点，以光轴为 $Z$ 轴（后面的讨论中，光轴 $OO'$ 与天球面的交点记为 $D$ 点），过 $O$ 点平行于感光面两边的直线作为 $X$ 轴和 $Y$ 轴。图1为星敏感器坐标系、图像坐标系及前视投影成像示意图。\n\n(3) 图像坐标系。以感光面的中心 $O'$（$O$ 点在该平面上的投影点）为坐标原点，平行于感光面两边的直线为 $X$ 轴和 $Y$ 轴的平面坐标系，参见图1。",
  "problem_requirement": "请你们团队利用附件提供的相关背景材料和数据，建模分析下面问题：\n\n问题 1 $P_1$、$P_2$、$P_3$ 是 3 颗已知位置的恒星，即它们在天球坐标系下的赤经和赤纬 $\\left( \\left( \\alpha_i, \\delta_i \\right), i=1,2,3 \\right)$ 已知；$Q_1$、$Q_2$、$Q_3$ 是来自恒星 $P_1$、$P_2$、$P_3$ 的平行光经过星敏感器光学系统成像在感光面上的星像点质心中心位置（参见图1）；记 $O'Q_1 = a_1$，$O'Q_2 = a_2$，$O'Q_3 = a_3$，$OO' = f$。\n\n(1) 建立由 $f$，$a_i$，$\\left( \\alpha_i, \\delta_i \\right)$（$i=1,2,3$）等参数解算 $D$ 点在天球坐标系的位置信息的数学模型，并给出具体的求解算法；\n\n(2) 若不利用 $f$ 值的信息，试建立由 $a_i$，$\\left( \\alpha_i, \\delta_i \\right)$（$i=1,2,3$）等参数求解 $D$点在天球坐标系中的位置信息的数学模型，并给出具体的求解算法；\n\n(3) 一般来说，星敏感器视场内的恒星数量多于3颗，请讨论如何选择不同几何位置的三颗星，提高解算 $D$ 点在天球坐标系中的位置信息的精度，并分析相应的误差。\n\n问题2 传统的星图识别方法主要是以角距（即星与星之间的球心角，可直观理解为两颗恒星分别与地心连线之间的夹角）或其衍生的形式为特征，这类方法比较简单，但一般需要较大的存储空间，识别算法实时性不好，且识别率普遍不高。通过对星图中的星点信息进行更为精细的特征提取，构建更高层次的特征，可能会提高星图识别算法的实时性和降低误匹配率。基于附件2提供的简易星表信息，请构建相应的特征提取模型，设计对应的星图识别算法，确定出附件3给出的8幅星图中每一个星像点所对应的恒星编号（对应附件2简易星表的恒星编号），并对算法的性能进行评估。",
  "problem_analysis": "本问题从天文导航与星敏感器成像几何的交叉处提出了一组典型而富有工程意义的建模任务，宏观目标可以概括为：在已知若干恒星在天球坐标系中精确位置（赤经、赤纬）以及在星敏感器感光面上观测到的成像几何量（这里以感光面中心 O' 到星像质心的径向距离 a_i 与/或像面坐标为例）的条件下，重构光轴在天球上的指向（即图中 D 点在天球坐标系中的方位），并进而研究如何在更多星点存在时择优选择用于解算的三元组以提升解算精度与稳定性；同时，围绕星图识别问题，探索如何设计更有判别力、既紧凑又允许快速检索的特征来完成星点→星表的匹配并对算法性能进行评估。为系统而透彻地分析这些问题，需要先明确若干基本物理与几何假设、变量之间的函数关系、可获数据的类型以及误差来源，这些都将直接塑造模型结构、算法选择与结果解释的有效性。\n\n在物理几何层面，核心假设包括：恒星位于“无穷远”，因此其光线可视为平行射线；成像系统可在首近似下用针孔（前视投影）模型描述，感光面与光心之间的有效焦距 f 在第一问的子问题(1)被视为已知量；光学畸变、透镜非理想性、热致焦距漂移、色差及大气/相对论效应（如像差、星光像心漂移、像面几何畸变等）在初始建模中被忽略或视为可由后续标定补偿的系统误差。天球坐标（赤经α、赤纬δ）到空间单位向量的变换使用标准球面到直角坐标的映射 s = [cosδ cosα, cosδ sinα, sinδ]，这是实现代数化求解的基础。图像侧的观测量设定为 O'Q_i = a_i，表示像面中心到星像质心的径向距离；在熟知 f 的情形下，成像几何给出该射线与光轴之间的天球角度 θ_i 满足 tan θ_i = a_i / f，或等价地 cos θ_i = 1 / sqrt(1+(a_i/f)^2)。因此，已知一恒星在天球上的方向 p_i（已知），以及该恒星在图像上的径向距离 a_i（给出）就等价于给定了光轴方向 d 在球面上与 p_i 的夹角约束 p_i · d = cos θ_i。这把问题转换为“球面三边约束”的代数问题：求单位向量 d（D 点的方向）使得对 i=1,2,3 有 p_i·d = c_i（其中 c_i = cos θ_i 由 a_i 与 f 给出）。如果三个 p_i 构成的 3×3 矩阵 P（以 p_i^T 为行）可逆，则理论上可以直接解线性方程 Pd = c 得到 d，随后对解正规化（除以模长）以满足单位向量约束；在理想无噪声情形下解应满足单位范数，否则可使用最小二乘带单位范数约束的优化（拉格朗日乘子或正规化最小二乘）来得到稳健解。该代数策略是第一问(1)的核心思想，并可自然给出数值求解算法：先由 a_i 与 f 计算 θ_i，再把 p_i 与 c_i 代入线性求解/最小二乘并进行必要的正规化或投影到单位球上；数值实现上优先采用高精度的线性代数求逆或 SVD 来避免数值不稳定。\n\n在 f 未知的情形（问题第一问(2)），问题的自由度增加且变为非线性：未知量为单位向量 d（2个自由度）和标量 f，总计 3 自由度，而每对 i 提供的关系为 p_i·d = f / sqrt(f^2 + a_i^2)。通过代数变换可以看到，平方并重排后得到等价形式 f^2 = a_i^2 (p_i·d)^2 / (1 − (p_i·d)^2)，这意味着对于不同 i、j 应满足等比关系，从而可以通过消去 f 得到关于 d 的两条非线性方程（例如利用 (1/(p_i·d)^2 − 1)/a_i^2 = constant）。因此理论上通过解两条非线性方程即可先求 d，然后再利用任一方程求 f；实际数值上建议使用带约束的非线性最小二乘（如用 Rodrigues 向量或四元数参数化旋转/方向以避免奇异性）同时拟合 d 与 f，采用 Levenberg–Marquardt 或信赖域算法从合理初值迭代求解。初值可以由假定某个试验 f（例如从系统标定、像面像点分布尺度估算或经验值）得到的近似解出发，然后在LM中联合优化。该非线性问题可能存在多解或退化情形（例如当三点位于同一大圆或几何上近似共线时），因此需要在算法中加入判别与健壮化步骤（例如多初值、检测奇异条件、对多个解进行代价函数比较并选最小重投影误差解）。\n\n关于第三小问如何在视场中多于三颗恒星时从中选取三颗以提高 D 的解算精度，这涉及数值稳定性与误差敏感性的分析。原则上，解的精度受两个主要因素制约：观测误差（像点质心提取误差、像素化、仿射或径向畸变未校正等）和先验误差（星表中赤经赤纬误差、历元不匹配导致的自行/岁差/章动等）。数学上，若以线性近似考虑 Pd = c，则设计矩阵 P 的条件数直接决定解向观测误差的放大倍数；因此应挑选使得 P^T P 条件数最小的三元组。直观上，这等价于在球面上选择三个彼此间角距大、构成面积较大且非退化的三角形（避免三点近共线或两点接近对称划分光轴），因而能更稳定地约束光轴方向。若还有像面方位信息（即不仅有径向距 a_i，也有像面方位角），则对应的线性系统和 Procrustes 型问题中也应选择使内积矩阵接近对角或行向量近正交的星对组合。此外优先选择亮度较大、像心测量精度高的星点（降低测量方差）以及星表位置精确的恒星。误差分析可通过一阶误差传递（雅可比矩阵）来完成：对求解过程线性化，计算 d 关于观测量（a_i 或像素坐标）的雅可比，从而得到误差协方差的传播公式，可据此比较不同三元组的预期方差并据此择优。在实际工程中，组合选择可通过枚举或贪心启发式（例如在候选星表上搜索面积最大且最小条件数的三角形）得出，同时使用 RANSAC 或多子集加权策略来抵抗孤立的错误观测。\n\n在星图识别问题（问题2）方面，从更高层次考虑，传统以角距或角距衍生量为特征的方法的劣势在于特征维度大、索引冗余、对量化敏感且在高密度星区易产生混淆，因此需要构建既旋转不变又对噪声鲁棒的紧凑特征。设计思路可以是把小规模子图（例如三角形或四点“quad”）的归一化不变量作为基本特征：三角形的边长度比、余弦值或两角比值构成对旋转与尺度（焦距未知时）不敏感的描述子，若再加入亮度排序或亮度比（星等信息）和局部点对间的径向排列序列可显著增强判别力。另一个路线是局部纹理式的特征：以每个星点为中心，按极坐标排序其若干最近邻星点的角度差与径向比构成向量，这在星图旋转、翻转、尺度变化下不变。算子层面，建立离线索引库时可对这些描述子进行量化（例如对比率按对数后做位串化）并构建哈希表或倒排索引来实现近 O(1) 的候选集合检索；检索后用最小二乘或投影重投影误差进行精验证并剔除错误匹配。对于给定数据集（附件2星表与附件3八幅星图），实现流程应包括统一坐标与单位（将所有赤经赤纬、像素坐标统一到相同角度/像素尺度），对每幅星图计算特征库、从星表中预先计算对应特征并建立索引，针对每个图像中的星点或局部子图进行索引查找、候选集生成及最终基于几何一致性（求解旋转/焦距并检验重投影残差）进行确认。性能评估需用明确的度量：识别率（正确识别星点占总星点比）、误识率、每幅图平均匹配时间以及在不同噪声水平（模拟像心抖动、误差方差增加、星表扰动）下的稳健性曲线。同时应报告典型失败场景（高星密度区域、亮度相近造成的排序错误、视场边缘畸变造成的系统误差）并提出缓解策略（增加图像畸变校正、使用星等做先验、引入多尺度/冗余三角形验证、RANSAC）。\n\n在整个建模过程中必须批判性地识别并讨论隐含假设对可解释性的影响。针对于针孔模型与忽略畸变这一简化，解算出的 D 可能系统偏移，尤其当像面边缘星点参与较多时；针对星表时间基准若未校正（历元转换导致的自行、岁差、章动）同样会引入角度偏差；焦距 f 的时间依赖（温变、机械松动）会使第二问的无 f 估计更重要，但也使得 f 与方向存在耦合不确定性，可能产生参数辨识的退化。模型在数据扰动下的行为可通过敏感性分析与蒙特卡洛仿真量化：生成不同幅度的像心噪声、星表误差与畸变项，运行解算流程并统计输出方向与 f 的分布，从而识别最关键的误差源并决定是否需要扩展模型（如引入径向畸变参数、对 f 做时间序列建模或加入多时刻观测进行滤波融合）。另外，可以从不同视角重构问题以获得替代建模策略：例如若能获得像面上星点的完整二维坐标而非仅径向距离 a_i，则问题转为经典的姿态估计（用三对向量做 Wahba 问题并用 SVD/四元数法直接求解），这通常更稳健且易于算法实现；若多帧图像可用，则可以利用时间序列将焦距和姿态作为时变参数在滤波框架（卡尔曼或扩展卡尔曼滤波、粒子滤波）中联合估计，从而提高对瞬时噪声和系统漂移的鲁棒性。\n\n最后，应强调建模本身是一个迭代过程：初始基于理想假设的模型可以提供可行解与诊断信息，随之应通过实测残差分析来识别系统性偏差并逐步引入额外的参数（光学畸变、焦距温漂模型、星表历元校正项）或改进算法（如在特征匹配阶段加入几何一致性检验、使用多尺度特征、在解算阶段采用加权最小二乘以反映不同星点测量置信度）以提升整体精度与稳健性。对于工程实现而言，关键在于构建一条从特征选择、索引检索、几何验证到误差建模与参数更新的闭环，使得随着更多观测与诊断信息的引入，模型能自我修正并收敛到对真实系统更高保真度的表征，而非拘泥于最初的简化假设。",
  "modeling_solution": "总体思路与摘要：本建模方案围绕两大任务展开：一是从已知三颗恒星在天球坐标系的方向（赤经α、赤纬δ）与在星敏感器感光面上观测到的星像几何量（像心到像点径向距离 a_i 与/或像面坐标）出发，直接解算光轴在天球上的指向 D（对应单位向量 d）；二是针对星图识别，设计既紧凑又易检索且对旋转/尺度/噪声鲁棒的特征描述子与检索/几何验证流程以把观测星像点映射到导航星表中的恒星编号。下面先给出统一的假设与符号约定，然后分别给出问题一的解析与数值方案、误差分析和三点选择策略，随后给出问题二的特征模型、索引与匹配算法、验证策略与性能评估、最后讨论模型自适应、校准与扩展途径。\n\n统一假设与符号：恒星可视作无穷远的点光源，其方向可用单位向量表示；成像系统在第一近似下为针孔投影（前视投影），感光面可视为与光轴正交的平面，光心 O 到感光面中心 O' 的距离为有效焦距 f（若未知则作为待估）；忽略高阶光学畸变、色差以及大气/相对论效应（这些可以作为扩展参数在后续标定中引入）。恒星 P_i 的天球方向向量记为 p_i，其由赤经α_i、赤纬δ_i转换为直角坐标 p_i = [cos δ_i cos α_i, cos δ_i sin α_i, sin δ_i]^T。星敏感器光轴方向对应天球上的射线方向单位向量记为 d（即点 D 在单位球上的向量），感光面中心 O' 到星像质心 Q_i 的径向物理距离（像面单位，或像素单位经尺度换算后）记为 a_i（若给出像素需用像素比例尺或已知像素尺度换为角度或长度）。在针孔模型下，通过像心 O' 到点 Q_i 的径向距离 a_i 与焦距 f 可得到射线与光轴的夹角 θ_i 满足 tan θ_i = a_i / f，等价的余弦约束为 cos θ_i = 1 / sqrt(1 + (a_i/f)^2)。光线方向与天球方向的代数约束是 p_i · d = cos θ_i（若同时已知影像的方位角信息，则可得到 2 个约束，用以进一步约束旋转与尺度）。\n\n问题一：已知 f 的情形（线性化精确解）。当焦距 f 已知时，先由观测量 a_i 与 f 计算每颗星像对应的空间夹角余弦 c_i = cos θ_i = 1 / sqrt(1 + (a_i/f)^2)。由针孔模型与无穷远近似可建立线性内积约束 p_i · d = c_i，i = 1,2,3。把 p_i^T 作为行构成矩阵 P (3×3)，c = [c_1,c_2,c_3]^T，则线性方程为 P d = c。若 P 可逆（即三向量线性独立，几何上对应三点不共面以致在球面上不退化），则直接求 d = P^{-1} c。因为数值误差或观测噪声存在，得到的 d 可能不严格为单位向量，故需要正规化 d := d / ||d|| 得到单位向量解。若观测含噪或超定（当实际可用星点>3取子集），采用加权最小二乘：在一般化形式中，若有 n≥3 条约束 p_i·d ≈ c_i，i=1..n，解 d = argmin_{d} (||W^{1/2}(P d - c)||_2^2) subject to ||d|| = 1。可通过拉格朗日乘子法把带单位约束的二次问题转为求解 (P^T W P) d = λ d（本质上是特征问题），或用无约束最小二乘先求解 d_ls = (P^T W P)^{-1} P^T W c 再作归一化处理并用一阶牛顿迭代精化以满足单位范数约束。数值实现建议用高精度的奇异值分解（SVD）或 QR 分解获得稳定解；若 P 条件数过大（接近奇异），应拒绝该三元组并选取更稳定的三元组（参见后文三点选择准则）。\n\n问题一：未知 f 的情形（非线性参数辨识）。当 f 未知时，每个观测给出非线性约束 p_i·d = f / sqrt(f^2 + a_i^2). 记 s_i := p_i·d，显然 s_i ∈ [-1,1] 且满足 s_i = f / sqrt(f^2 + a_i^2) ⇒ s_i^2 = f^2/(f^2 + a_i^2) ⇒ f^2 = a_i^2 s_i^2/(1 − s_i^2). 对不同 i，右端须一致，因此消去 f^2 得到等比关系： a_i^2 s_i^2/(1 − s_i^2) = a_j^2 s_j^2/(1 − s_j^2) for all i,j. 用 i=1,2 与 i=1,3 两组可得到两个独立非线性方程关于 d（通过 s_i = p_i·d）。因此可以先求解 d（2 个自由度）再通过任一方程求出 f 的唯一正根。为数值稳定与工程实现，推荐将问题转为非线性最小二乘联合估计未知变量 x = [d; f]，目标函数为 F(x) = Σ_i w_i (p_i·d − f/sqrt(f^2 + a_i^2))^2，约束 ||d|| = 1 且 f>0。使用参数化以去除单位向量约束（例如以两个角度 φ,ψ 或以 Rodrigues 参数/球面坐标（azimuth, elevation）表示 d），然后用 Levenberg–Marquardt 或信赖域非线性最小二乘求解。初值选择：d0 可由假设某个典型 f0（例如从仪器说明或影像尺度经验估计）代入线性法得到近似解，或通过求解最大似然的简化代价得来的近似；f0 可设为观测 a_i 的典型比例（如 f0 = median(a_i)/tan(mean angular separation estimate)），在 LM 中允许多重初值尝试以避免局部极值。为避免退化与多解情形（例如三点共圆或近共线造成 f 与 d 耦合不可辨识），实现中应检测雅可比的秩与问题的可辨识性（例如通过条件数或 Fisher 信息矩阵的行列式）并在退化时要求更多观测点（n>3）或引入先验（对 f 的正则化）。\n\n参数估计的解析替代：从等比关系可得对 i,j 有 function(s_i,s_j,a_i,a_j) = 0，可通过把 s_i = p_i·d 替换进得到关于 d 的两条纯代数非线性方程，理论上可用闭式方法解二次/四次方程组，但数值上不稳且推导繁琐，因此数值迭代优先。\n\n误差传播与精度评估（同用于两种情形）：对解 d 的不确定性估计可通过一阶误差传播得到近似协方差。设残差向量 r = P d − c（f 已知情况），雅可比 J = ∂r/∂d = P。因此在加权最小二乘下，解协方差 Cov(d) ≈ (J^T W J)^{-1} σ^2，其中 W 是观测权重矩阵（反映每个 c_i 的测量方差），σ^2 为观测残差方差估计。对未知 f 的非线性拟合，雅可比扩展为 J = ∂r/∂x，其中 r_i(x) = p_i·d − f/ sqrt(f^2 + a_i^2)，协方差约为 (J^T W J)^{-1}. 通过这些协方差可计算 d 在天球坐标（赤经/赤纬）上的方差传播，从而给出角度精度。实际实现应做蒙特卡洛仿真：对像点测量噪声（例如像心提取误差的像素σ_px）与星表位置误差做采样，重复解算得到 d 的分布，统计均值与置信区间以评估不确定性与偏差。\n\n三点选择策略以提高精度与稳健性：数学上，解对观测误差的放大系数与设计矩阵 P 的条件数直接相关（更小的条件数对应更低的误差放大）。因此在视场中有 m>3 颗候选星时，应从中选择一个三元组使得对应 P 的条件数最小或等价地使 P^T P 的最小特征值尽可能大（提高信息量）。在球面几何直观上，这对应在单位球面上选择相互之间角距较大、三角形面积较大且尽量非退化（避免三点几何共线或在一条大圆附近）。算法实现上可采用下列策略：先在候选集合中剔除低信噪比星点（利用星等或像心测量可靠性），然后枚举或启发式搜索三元组并计算每个三元组的评分函数 S = 1/cond(P) 或 S = λ_min(P^T P) / trace(P^T P)；选择得分最高的三元组用于求解。若计算资源允许，枚举所有三元组并用协方差传播计算预期 d 方差，选择使 trace(Cov(d)) 最小的三元组。若存在视场内星点较多，可用贪心或随机化方法（如 RANSAC 选子集后聚合）来平衡计算和精度。还可以考虑组合信息：使用多个不相关三元组计算 d 并做加权平均或求一致性下的最优估计，以提高鲁棒性并降低单组错误影响。对误差敏感性的分析须考虑两个主成分：星像测量误差（像心提取精度与像素化）和星表方向误差（历元差、历元未校正的恒星自行）。若星表未作历元校正，应引入恒星自行与岁差/章动模型将星表坐标更新到观测时刻以避免系统偏差。\n\n问题二：星图识别的特征模型与匹配算法。设计目标是构建旋转/翻转/尺度（焦距未知或变化）不变并对噪声鲁棒的紧凑描述子以支持高速索引检索与精确几何验证。基于附件2与附件3数据的特点（星表含位置与星等，星图文件多以像素坐标或像心径向距离给出），建议采用混合的几何不变量与亮度信息作为特征：对每一颗星点定义局部邻域描述子 LND(k) 为以该点为中心的最近 k 个邻星的极坐标序列（按极角排序），具体为向量 [r_1/r_k, r_2/r_k, …, r_{k-1}/r_k; Δθ_1, Δθ_2, …]，其中 r_j 为中心到第 j 近邻的径向距离，利用距离比和角度差能把尺度与整体旋转归一化（距离比消除焦距缩放，角度差对旋转不变）。对于只给出径向距离 a_i 而无方位信息的情况，可采用基于角距（球面角距）不变量的三角形特征：对任意三颗星构造三边长度的比值或余弦值组（例如 u = l12/l13, v = l12/l23），这些比值在相似变换下保持不变（若焦距未知，投影尺度影响可被比值消除）。为增强判别力，在特征中同时加入星等（亮度）的小型向量，例如中心星与邻星的星等差值序列或亮度排序，因星等在星表中通常具有较好辨别力。为了进一步提高抗噪性，可对上面的实值描述子进行对数变换和归一化并量化为离散码（例如每个分量分为 B 个区间，组成位串），形成哈希键。\n\n离线索引建立：在导航星表上对所有可能的局部结构（例如以每颗星为中心构造的 LND(k) 或所有三角形/四元组的比值特征）预计算描述子并构建倒排索引或多维近邻结构（如 KD-tree、LSH 或对离散化位串用哈希表）。为了限制存储与搜索复杂度，可在星表上只保留亮度在感兴趣范围内的导航星或仅保存若干最稳定的特征（例如基于信息熵筛选区分度高的三角形）。若星表规模大，采用分层索引：先用低维度粗糙签名（例如两边比）快速筛选候选三角形，再用更精细描述子做精筛。\n\n在线匹配流程：对观测星图先进行预处理（统一单位与坐标系，若图像含像素坐标则转换为物理像面距离或角度），为每颗观测星构造局部描述子 LND_obs 或枚举图中若干三角形特征并查索引库得到候选星表三元组集合。对每个候选集合做几何验证：若图像与星表均能转为单位向量（通过像面坐标与已知或估计的焦距转换为方向向量），则用 Wahba 问题/Procrustes 方法或四元数法（Davenport q-method）估计从星表方向集合到图像方向集合的旋转 R，并计算重投影残差。若焦距未知但可从多对点估计，则联合估计旋转与尺度（f）并计算残差。用 RANSAC 或类似的鲁棒估计器处理候选集中的错误匹配，最终以重投影残差最小且一致性最高的映射给出星点对应。当只使用不含方位信息的径向距离时，几何验证要基于角距一致性：将候选三角形的球面边长（星表）与观测图三角形的由 a_i 与 f（如果未知须搜索 f）推导出的边长进行比较，或直接比较角距比值不变量。\n\n匹配后的确认与精标定：一旦识别出若干个正确匹配对（通常≥3），可使用最小二乘的姿态解算（Wahba）得到精确的旋转矩阵 R，并用 R 与观测像点做束调整（bundle adjustment）来同时优化姿态 R、焦距 f 与可能的径向畸变参数，使得全局残差最小，此步骤既可提升姿态精度又可反过来提升星点识别置信度。\n\n性能评估指标与实验设计：识别算法要用明确量度评估，至少包含识别率（正确识别星点占总观测星点比例）、误识率（错误匹配占匹配总数比例）、平均单幅图匹配时间和重投影残差统计（均值与方差）。此外做鲁棒性测试：在不同噪声水平下（例如像心测量误差σ_px从0.1像素到3像素）、不同星等遗漏率（模拟遮挡或低信噪比引起的漏检）、不同焦距未知情形下评估识别率变化曲线。实现细节包括统一单位（把附件中不同文件的赤经/赤纬角度/弧度、像素坐标转换为统一角度/物理长度量）、对星表进行历元校正并筛除自行大或星等不稳定的恒星以构建导航星表。对给定数据集（附件3的8幅星图），应先对每幅图做特征提取并在星表上查找匹配，返回每个观测星对应的最可能星表编号，并用几何验证过滤错误匹配；最终统计每幅图的识别正确数量并记录算法耗时。\n\n计算与数值实现建议：线性问题（已知 f）主要依赖矩阵运算（SVD、QR、特征分解），数值复杂度小，桌面级电脑即可在毫秒/千分之一秒量级完成单次运算。非线性拟合（未知 f）需用 LM 或信赖域法，单次迭代代价受参数维数与观测数影响，通常数十到数百次迭代足够，建议并行化多初值尝试。星图识别中的索引构建是离线操作，在线检索使用 KD-tree/LSH 可在次毫秒到几毫秒完成。若在嵌入式实时系统中部署，应优先使用量化特征与哈希索引以降低在线计算负担，并把复杂几何验证放在候选较少的情形下执行。若需批量处理或对大数据集做广泛蒙特卡洛敏感性分析，建议使用多核并行或 GPU 加速（特别是特征提取与密集匹配部分）。\n\n模型适应、校准与不确定性量化：实际应用中须定期做标定以校正像面畸变与焦距漂移。建议初期通过观测多幅含已知恒星的图像进行离线标定，采用束调整联合估计相机内参（焦距、主点、径向与切向畸变）与外参（姿态）并获得参数协方差。在线可用扩展卡尔曼滤波或递推最小二乘来跟踪焦距与畸变随时间的缓慢变化（热漂移、机械变形），并把滤波结果用作未来图像的先验。不确定性量化可通过 Fisher 信息矩阵、雅可比一阶传播与蒙特卡洛仿真三种方式综合给出参数置信区间与识别置信度。\n\n进一步扩展与创新方向：若允许利用数据驱动方法，可训练一个轻量级的深度学习嵌入（例如 Siamese 网络或图神经网络）把每个局部子图映射为紧凑向量，离线在星表上生成嵌入并建立近邻索引以实现更鲁棒的匹配；此策略对缺失星点与噪声更具适应性。另一扩展是多帧联合识别与联合标定：利用航行体在短时间内的微小视角变化，把多帧观测联合求解姿态与相机内参（bundle adjustment over time），可显著提高对 f 与畸变的辨识能力并提升识别率。若考虑高精度工程应用，应把光学畸变模型（径向多项式、薄-透镜组合模型）与传感器几何误差纳入观测模型并在束调整中估计。长期来看，可把不确定性信息反馈到特征选择策略中（优先选择对参数信息贡献大的星点），并在系统运行时用自适应策略动态选择用于态势解算的星点集合以持续优化姿态精度。\n\n结论性陈述：针对问题一，已知 f 时可将问题转化为线性系统 P d = c 并直接用矩阵求逆或加权最小二乘得到稳定解；未知 f 时应把问题视为低维非线性最小二乘联合估计（d,f），采用 LM 等算法并注意初值与可辨识性问题；对多星情况，通过条件数、三角形面积或协方差传播量化信息量并据此择优选点可显著降低误差放大。针对问题二，提出了以局部邻域不变量（距离比、角差）与亮度信息为核心的混合特征设计，并结合离线索引+在线哈希/KD-tree检索+几何验证（Wahba/Procrustes与RANSAC）形成高效鲁棒的识别流程。整个方案兼顾解析可解部分与数值迭代部分，提供了误差传播、鲁棒性评估与实际部署的校准/自适应策略，并为后续引入更复杂光学模型或机器学习提升识别能力留下明确可行的扩展路径。",
  "task_descriptions": [
    "子任务1（数据预处理、坐标与物理假设、基准标定）的目标是把原始星表与星图观测数据规范化为统一、可直接用于几何建模的输入——包括（1）统一单位与参考系的星表赤经/赤纬与观测像点坐标、（2）由赤经/赤纬到天球方向单位向量的确定、以及（3）建立并标定针孔投影的相机内参基准（最少包含有效焦距 f、主点坐标、像素尺度，并可选估计径向/切向畸变系数）并对这些量给出协方差估计；为实现上述目标本子任务应按以下步骤精确执行：首先解析所有输入文件并标准化单位与命名（把赤经α、赤纬δ统一为弧度或度并注明历元，把像素坐标统一为以图像左上角或感光面中心为参考的像素/物理长度，并记录各表格中字段映射和空表单情形），其次进行星表时标校正——若有观测时间信息则按给定时刻对星表坐标施加岁差/章动与恒星自行修正以把星表坐标变换到观测历元；若无观测时间则明确假定使用星表原历元并记录该假设；第三将每颗导航恒星的赤经/赤纬经球面到直角坐标变换为天球方向单位向量 s = [cosδ cosα, cosδ sinα, sinδ]^T，并输出单位向量集合与其标识符；第四规范化并校验观测像点数据：把像素坐标减去初始主点猜测（例如图像中心）、用已知或预设的像素尺寸换算为物理像面单位，并统一量纲以便与焦距 f 配合使用；第五在针孔成像假设下建立初始相机内参估计：若文档或设备给出近似 f 则采用该值并通过最小二乘用若干已知对应（若数据集包含部分已知对应）线性求解校正主点与像素尺度，否则用观测中的已知星对（星表方向向量与像面坐标）构造线性化投影关系并用SVD/最小二乘估计初值（至少3个非退化对应），同时记录解的条件数以判别退化几何；第六为提高精度，用鲁棒非线性优化（例如以Levenberg–Marquardt实现的束调整/最小二乘）对相机内参（f、主点、可选畸变系数）及存在的少量外参进行联合精化，目标函数是像点的重投影误差，优化过程中应使用鲁棒损失或RANSAC去除异常对应并输出最终残差统计；第七通过雅可比与近似Hessian计算参数协方差（或由优化器直接给出拟合协方差估计），并把这些不确定性与残差一起作为标定质量度量；最后把所有处理结果保存为统一数据结构：校准后的相机内参与协方差、规范化的像点坐标（物理量或角度）、每颗星对应的天球单位向量、以及处理日志（单位转换、历元假设、异常剔除信息、残差与条件数），并提供基本一致性检查（重投影残差分布、参数协方差、三点几何判定）以便下游使用。实现本子任务应使用数值线性代数（SVD/QR）、非线性最小二乘器（LM或信赖域）、天文坐标变换例程（岁差/章动/自行修正）及鲁棒估计方法；所有假设（针孔模型、星为无穷远、是否估计畸变、历元处理策略）必须在输出日志中明确记录。",
    "子任务 2 的目标是根据输入观测（每颗恒星的天球位置 α_i, δ_i，转为单位方向向量 p_i，以及感光面上像心 O' 到星像质心的径向距离 a_i）在两种情形下稳定、数值可靠地求解星敏感器光轴方向 d（单位向量，代表天球上 D 点方向）与在未知焦距情形下同时估计有效焦距 f；本任务的范围仅包括建立明确的数学方程、给出逐步数值求解流程、必要的参数化与约束处理、初值策略、雅可比与协方差计算方法以及退化判别准则，并产出解、残差与不确定性估计。 对于已知 f 的情形：先将每对 (α_i,δ_i) → p_i = [cosδ_i cosα_i, cosδ_i sinα_i, sinδ_i]^T，计算标量 c_i = 1/√(1+(a_i/f)^2)，构成线性系统 P d = c（P 的 i 行为 p_i^T）；若恰好 n=3 且 det(P) 非退化，则用 SVD/QR 计算 d = P^{-1} c 并归一化为单位向量；若 n>3 或存在测量噪声，则用加权最小二乘求解 d_ls = argmin_d ||W^{1/2}(P d − c)||_2（W 为对角权重矩阵，权值为各 c_i 测量方差的倒数），可通过正规化后归一化或通过拉格朗日乘子将单位范数约束包含进解法（等价于解 (P^T W P) d = λ d 的本征问题）；数值实现应使用伪逆/SVD 以处理欠定或病态情况，并报告 P 的条件数；用残差 r = P d − c 计算残差方差 σ^2 ≈ ||W^{1/2} r||^2/(n−m)（m=未知数维度），并用近似协方差 Cov(d) ≈ (P^T W P)^{-1} σ^2 估计不确定性。 对于未知 f 的情形：采用联合非线性最小二乘估计参数向量 x，其中可选参数化为 x = [φ,θ,f]（用两个球面角 φ,θ 表示单位向量 d，以保证 ||d||=1，或直接用 3 元向量 d 并在优化中显式约束归一化），构造残差 r_i(x) = p_i·d(φ,θ) − f/√(f^2 + a_i^2)，并最小化 Σ_i w_i r_i^2 以得到最优 x；建议用 Levenberg–Marquardt 或信赖域算法实现，优先提供解析雅可比以加速与稳定收敛： ∂r_i/∂f = −a_i^2/(f^2 + a_i^2)^{3/2}（负号），而对 d 的参数化角度的偏导可由链式法则给出（或若直接优化 d，则 ∂r_i/∂d = p_i 并需在每步归一化 d）；初始化采用经验或分步策略：用一个合理的 f0（设备说明或典型值）计算 c_i0 并用已知-f 的线性解得 d0，或以多重初值（不同 f0）并行运行以避免局部极小；迭代结束后用雅可比 J(x*) 估算参数协方差 Cov(x) ≈ (J^T W J)^{-1} σ^2 并报告 f 与 d 的置信区间。 实施细节与数值鲁棒性：所有优化应强制 f>0 且对 d 保持单位化（通过参数化或每步投影），当 J^T W J 条件数过大或秩不足时指示问题不可辨识（需更多观测点或更好的几何），并在输出中返回条件数、残差 RMS、收敛状态与迭代历史；测量权重 W 由像心测量方差与星表方向不确定性共同设定；若解析雅可比难以推导，可采用自动微分或数值差分但需控制步长。 输出包括：单位向量 d（对应天球上的 D 点方向）、若估计则返回 f 的标量值、残差向量与残差 RMS、参数协方差矩阵与由其导出的角度不确定度估计、以及诊断量（P 或 J 的条件数、是否收敛、是否存在退化），推荐实现工具为高质量线性代数库与非线性最小二乘器（例如 LAPACK/SVD、scipy.optimize.least_squares 或 Ceres），并在实现中记录初值与权重设置以便结果可重复。",
    "子任务3聚焦于对用于求解光轴方向（及必要时焦距）的观测子集进行误差传播评估、最优三点(或更大子集)选择以及解算过程的稳健化判据和步骤的系统化实现：其范围包括（1）输入与假设：接受规范化的天球单位向量 p_i（由赤经/赤纬转换）、对应观测量（例如像面径向距 a_i 或已转换的角余弦 c_i）、每个观测的测量方差（像心提取误差σ_px及其换算到 c_i 的方差）和星表方向不确定度作为噪声模型；（2）理论误差传播：对线性情形（已知焦距或线性化模型）计算雅可比并使用近似协方差公式 Cov(d) ≈ (P^T W P)^{-1} σ^2（其中 P 的行为 p_i^T，W 为观测权重矩阵，σ^2 为残差方差估计），对非线性联合估计情形计算整体雅可比 J = ∂r/∂x（x 为待估参数向量，如方向参数化与/或 f），并用 Cov(x) ≈ (J^T W J)^{-1} σ^2 估计参数不确定度；同时计算 Fisher 信息量、条件数与最小特征值等诊断量以量化信息量与数值稳定性。基于上述基础，制定明确的三点选择与评分准则：对任一候选三元组构建评分函数 S（可选形式包括 S1 = λ_min(P^T P)（越大越好）、S2 = 1/cond(P) 或 S3 = 1/trace(Cov(d))），并结合几何量（球面三角形面积、三点之间的最小/最大角距）与观测置信度（星等/测量方差）做加权评分，优先选择角距分布广、三角形面积大且观测方差小的组合以降低误差放大。实现策略：若候选星数较小则枚举所有三元组并计算上述评分与协方差，若候选星数较大则采用启发式搜索（贪心法：先选高SNR星，再按角距或增益量最大化选择；或随机采样与多次优化，类似 RANSAC 的采样验证）以降低计算负担；对评分最高的若干三元组进行蒙特卡洛仿真（用给定噪声模型对观测扰动多次抽样并解算，得到经验协方差与偏差分布）以验证一阶线性传播的近似并检验有无系统偏差。稳健化与退化检测：对每个候选组计算 P 或 J 的秩与条件数并与预设阈值比较（若秩不足或 cond 超阈值则判为几何退化并剔除），在实际解算中采用加权最小二乘或带正则化项的最小二乘以缓和病态问题，并在存在异常观测或潜在错误匹配时使用 RANSAC/一致性检验剔除离群子集；对于冗余方案，建议并行用多组高评分三元组求解并以协方差为权重进行加权融合或用最小化重投影残差的全局加权拟合替代单一三元组结果。输出与诊断要求：为所选最优三点（或融合后的解）输出数值结果、预期协方差矩阵、蒙特卡洛估计的经验标准差、评分值、条件数与退化标志、残差 RMS 以及若干决策建议（如需更多观测或切换到冗余拟合）；实现上应使用可靠的线性代数工具（SVD/QR）、数值优化与雅可比计算库、以及用于蒙特卡洛模拟的随机采样模块，并把所有阈值、权重设定与噪声模型记录在日志以保证结果可复现。",
    "子任务4 的目标是设计并实现一条完整、可复现且高效的星图识别流水线——从观测星点到导航星表编号的映射——包括特征设计与提取、离线索引构建、在线候选检索、几何验证与精化，以及统一的性能评估指标与测试程序。具体范围与输入：输入为经预处理的单幅星图数据（每个星像的像素/像面坐标与质心不确定度、若有则包含星等/亮度信息）、导航星表（恒星编号、赤经/赤纬→单位方向向量、视星等）以及可选的相机近似内参（像素尺度/主点/近似焦距）；本子任务不承担像点去噪或历元校正等工作，但需明确记录输入格式与单位。方法与步骤（一体化描述）：1）坐标与尺度归一化：将观测像素坐标统一到以感光面中心或主点为原点的物理像面单位，必要时用像素尺度换算并记录不确定度；2）局部与多点不变特征设计：为每颗观测星构造局部邻域不变描述子 LND(k)（以该星为中心按极角排序的最近 k 个邻星的径向比 r_j/r_k 与角差序列，使用对数与归一化以增强数值稳定性），同时在图上枚举若干三角形/四元组并计算边长比、余弦不变量与星等比值作为补充特征；3）特征量化与离线索引：对上述实值特征进行对数/归一化处理后量化为离散码（每分量划分 B 个区间），在导航星表上预计算相同类别的特征并建立多级索引结构——粗筛可采用哈希表或 LSH，精筛用 KD-tree 或倒排索引，以平衡存储与在线检索时间；4）在线候选检索：对观测特征先用粗筛快速检索出若干候选星表子图（每特征保留 top-N 候选），合并重复候选并按照特征匹配得分（基于距比差、角差和星等差的加权和）排序；5）几何验证与鲁棒估计：对每个候选子图执行基于几何一致性的验证——若能构造方向向量则求解旋转（Wahba/Davenport q-method 或 Procrustes），若焦距未知则联合估计旋转与尺度/焦距，所有几何拟合采用 RANSAC 去除离群并计算重投影残差；6）精化与全局束调整：在确认若干可靠匹配后，用非线性最小二乘（Levenberg–Marquardt 或 Ceres）对姿态（旋转）、可观测内参（如焦距）和可选径向畸变参数进行束调整，输出最终的点对映射与残差统计；7）置信度打分与输出：为每个映射返回匹配置信度、重投影 RMS、参与拟合的观测数量及其不确定度估计，最终输出每幅图的映射表（观测点→星表编号）与相关元数据。实现细节与参数：建议取 k（邻域大小）为 4–8，量化区间 B 依据星表密度调节（常用 8–16），粗筛保留候选数 N 以 10–50 为宜，RANSAC 迭代次数根据容错率与置信度设定；使用对数距离比与亮度排序可显著提升对尺度与亮度扰动的鲁棒性；为嵌入式实时场景优先采用量化哈希做在线检索并限制精筛次数以控制延迟。所需工具与库：离线/在线索引可用 KD-tree、LSH 或 Faiss；几何计算与线性代数用 Eigen、NumPy/SciPy 或 OpenCV；非线性最小二乘与束调整可用 Ceres、ceres-solver 或 scipy.optimize.least_squares；RANSAC 可用 sklearn 或自实现。性能评估与测试协议（必须包含）：统一衡量指标包括识别率（正确匹配数/观测星数）、误识率、平均每幅匹配时间、重投影残差均值与方差；评估应包含噪声敏感性测试（像心误差范围的蒙特卡洛仿真）、缺星率测试（模拟漏检或遮挡）、以及焦距不确定性测试；所有测试需输出 ROC/精度-召回曲线和在不同参数设置下的运行时间曲线以供折衷选择。输出与交付物：实现代码（含离线索引构建与在线匹配模块）、一份输入/输出格式规范、每幅星图的匹配结果文件（观测ID→星表编号、置信度、重投影残差）、索引统计（条目数、平均候选数）、以及一份标准化的性能报告（按上述指标）。本子任务不涉及星表历元校正或像点质心提取，但要求在实现中明确记录所有假设、参数与单位以确保结果可重复与可移植。"
  ]
}