{
  "tasks": [],
  "problem_str": "问题背景：\n信号的功率放大是电子通信系统的关键功能之一，其实现模块称为功率放大器（PA，Power Amplifier），简称功放。功放的输出信号相对于输入信号可能产生非线性变形，这将带来无益的干扰信号，影响信信息的正确传递和接收，此现象称为非线性失真。传统电路设计上，可通过降低输出功率的方式减轻非线性失真效应。\n\n功放非线性属于有源电子器件的固有特性，研究其机理并采取措施改善，具有重要意义。目前已提出了各种技术来克服改善功放的非线性失真，其中预失真技术是被研究和应用较多的一项新技术，其最新的研究成果已经被用于实际的产品（如无线通信系统等），但在新算法、实现复杂度、计算速度、效果精度等方面仍有相当的研究价值。\n\n本题从数学建模的角度进行探索。若记输入信号 $x(t)$，输出信号为 $z(t)$，$t$ 为时间变量，则功放非线性在数学上可表示为 \n$z(t) = G(x(t))$，\n其中 $G$ 为非线性函数。预失真的基本原理是：在功放前设置一个预失真处理模块，这两个模块的合成总效果使整体输入-输出特性线性化，输出功率得到充分利用。原理框图如图1所示。\n\n其中 $x(t)$ 和 $z(t)$ 的含义如前所述，$y(t)$ 为预失真器的输出。设功放输入-输出传输特性为 $G(\\cdot)$，预失真器特性为 $F(\\cdot)$，那么预失真处理原理可表示为 \n$$z(t) = G(y(t)) = G(F(x(t))) = (G \\circ F)(x(t)) = L(x(t)) \\tag{1}$$\n$G \\circ F = L$ 表示为 $G(\\cdot)$ 和 $F(\\cdot)$ 的复合函数等于 $L(\\cdot)$。线性化则要求 \n$$z(t) = L(x(t)) = g \\cdot x(t) \\tag{2}$$\n式中常数 $g$ 是功放的理想“幅度放大倍数” ($g > 1$)。因此，若功放特性 $G(\\cdot)$ 已知，则预失真技术的核心是寻找预失真器的特性 $F(\\cdot)$，使得它们复合后能满足 \n$$(G \\circ F)(x(t)) = L(x(t)) = g \\cdot x(t). \\tag{3}$$\n如果测得功放的输入和输出信号值，就能拟合功放的特性函数 $G(\\cdot)$，然后利用 (3) 式，可以求得 $F(\\cdot)$。\n\n2.功放的非线性模型\n\n由于各类功放的固有特性不同，特性函数$G()$差异较大，即使同一功放，由于输入信号类型、环境温度等的改变，其非线性特性也会发生变化。根据函数逼近的Weierstrass定理，对解析函数$G(x)$总可以用一个次数充分大的多项式逼近到任意程度，故可采用计算简单的多项式表示非线性函数。\n\n如果某一时刻的输出仅与此时刻的输入相关，称为无记忆功放，其特性可用多项式表示为：\n$$z(t) = \\sum_{k=1}^K h_k x^k(t), \\quad t \\in [0,T] \\tag{4}$$\n式中 $K$ 表示非线性的阶数（即多项式次数），诸 $h_k$ 为各次幂的系数。在函数逼近理论中，$z(t)$ 是用函数数组 $\\{x^0, x^2, x^3, \\ldots, x^K\\}$ 生成的 $K+1$ 维空间里的这组基的线性组合表示。用函数空间的一组正交函数基 $\\{\\varphi_k(x)\\}_{k=0}^K$ 的线性组合表示则性能更佳、计算更方便，故 (4) 亦可用正交基等其它方式表示。\n\n如果对功放输入 $x(t)$ / 输出 $z(t)$ 进行离散采样后值分别为 $x(n)$ / $z(n)$（采样过程符合 Nyquist 采样定理要求），则 (4) 可用离散多项式表示如下：\n$$z(n) = \\sum_{k=1}^K h_k x^k(n) = h_1 x(n) + h_2 x^2(n) + \\cdots + h_K x^K(n), \\quad n = 0,1,2,\\ldots,N \\tag{5}$$\n\n如果功放的某一时刻输出不仅与此时刻输入有关，而且与此前某一时间段的输入有关，则称为有记忆功放。对 (5) 式增加记忆效应，可以写为：\n$$z(n) = \\sum_{k=1}^K \\sum_{m=0}^M h_{km} x^k(n-m) = h_{10}x(n) + h_{11}x(n-1) + \\cdots + h_{1M}x(n-M) \\\\ + h_{20}x^2(n) + h_{21}x^2(n-1) + \\cdots + h_{2M}x^2(n-M) \\\\ + \\cdots \\cdots \\\\ + h_{K0}x^K(n) + h_{K1}x^K(n-1) + \\cdots + h_{KM}x^K(n-M), \\quad n=0,1,2,\\ldots,N \\tag{6}$$\n\n式中 $M$ 表示记忆深度，诸 $h_{km}$ 为系数。具有记忆效应的功放模型也可以用更一般的 Volterra 级数 [1][2] 表示，由于 Volterra 级数太复杂，简化模型有 Wiener、Hammerstein 等 [3][4]。由于常用复值输入-输出信号，(6) 也可表示为便于计算的“和记忆多项式”模型：\n$$z(n) = \\sum_{k=1}^K \\sum_{m=0}^M h_{km} x(n-m) |x(n-m)|^{k-1}, \\quad n=0,1,2,\\ldots,N \\tag{7}$$\n\n3.预失真处理模型\n\n在功放的特性$G()$已知条件下，求解方程(3)是一类特殊的函数方程，求解的理论方法因具体问题而定，而工程上常采取数值计算，用最小化目标误差函数的方法，求得近似的$F()$。目标误差函数的选取和判断准则因建模方法而异，总体原则是使预失真和功放的联合模型呈线性后误差最小。\n\n本题探索中，预失真处理建模还需考虑以下2个约束条件：\n\n预失真处理的“输出幅度限制”。由于功放的输入幅度需保持在一定范围，过大的值会导致饱和溢出，因此，本题的建模中限定预失真处理的输出幅度不大于所给出的功放输入幅度最大值。\n\n预失真处理加载后，尽可能使功放的输出“功率最大化”。 为了充分发挥功放的作用，预失真处理模型的建立必需考虑尽可能使功放的信号平均输出功率最大，因此预失真处理后的输出幅度（等效为功放的输入幅度）需尽可能提高。\n4.计算结果评价\n\n以上模型的数值计算结果业界常用NMSE、EVM等参数评价其准确度，具体定义如下。\n\n采用归一化均方误差 (Normalized Mean Square Error, NMSE) 来表征计算精度，其表达式为$$NMSE = 10 \\log_{10} \\frac{\\sum_{n=1}^{N} |z(n) - \\hat{z}(n)|^2}{\\sum_{n=1}^{N} |z(n)|^2} \\tag{8}$$\n\n如果用 $z$ 表示实际信号值，$\\hat{z}$ 表示通过模型计算的信号值，NMSE 就反映了模型与物理实际模块的接近程度。功放前加载预失真处理后，也可用 NMSE 判断整体模型输出值与理想输出值的近似程度。\n\n误差矢量幅度（Error Vector Magnitude，EVM）定义为误差矢量信号平均功率的均方根和参照信号平均功率的均方根的比值，以百分数形式表示。如果用 $X$ 表示理想的信号输出值，$e$ 表示理想输出与整体模型输出信号的误差，可用 EVM 衡量整体模型对信号的幅度失真程度。\n\n$$EVM = \\frac{\\sqrt{E[|e|^2]}}{\\sqrt{E[|X|^2]}} \\times 100\\% \\tag{9}$$\n\n问题要求：\n在上述提供的背景材料以及自行查阅相关文献资料的基础上，请你们的团队研究下列问题。要求写出计算的过程、注明所用的优化方法、解释选择中间参数的理由、并附上所用的程序（C/C++/Java/Matlab等）。为保证所用模型的工程可实现性，请考虑选用适当复杂度的模型和算法。\n\n以下各题中的数学建模鼓励创新，不局限于背景介绍的模型方法。\n\n1. 无记忆功放\n\n数据文件1给出了某功放无记忆效应的复输入-输出测试数据，其输入-输出幅度图为：\n                    \n图2  功放输入/输出幅度散点图\n\n请根据提供的数据，完成以下任务。\n\nA．建立此功放的非线性特性的数学模型，然后用NMSE评价所建模型的准确度。\n\nB．根据线性化原则以及“输出幅度限制”和“功率最大化”约束，建立预失真模型。写出目标误差函数，计算线性化后最大可能的幅度放大倍数，运用评价指标参数NMSE/EVM评价预失真补偿的结果。\n\n2. 有记忆功放\n\n数据文件2给出了某功放的有记忆效应的复输入-输出数据，请完成以下任务。\n\nA．建立此功放的非线性特性的数学模型，然后用NMSE评价所建模型的准确度。\n\nB．根据线性化原则以及“输出幅度限制”和“功率最大化”约束，以框图的方式建立预失真处理的模型实现示意图（提示：可定义基本实现单元模块和确定其之间关系，组成整体图），然后计算预失真模型相关参数。运用评价指标参数NMSE/EVM评价预失真补偿的计算结果。\n\n3． 拓展研究\n\n相邻信道功率比（Adjacent Channel Power Ratio，ACPR）是表示信道的带外失真的参数，衡量由于非线性效应所产生的新频率分量对邻道信号的影响程度。其定义为：\n$$ACPR = 10 \\log_{10} \\frac{\\int_{f_2}^{f_3} s(f)\\,df}{\\int_{f_1}^{f_2} s(f)\\,df} \\tag{10}$$\n\n其中 $s(f)$ 为信号的功率谱密度函数，$[f_1,f_2]$ 为传输信道，$[f_2,f_3]$ 为相邻信道。功率谱密度的计算可通过对信号的自相关函数进行 Fourier 变换计算，也可以通过直接法等计算（假定本题涉及的信号为时间平稳信号）。\n\n如果题2所附的数据采样频率 $F_s = 30.72 \\times 12 \\,\\text{MHz}$，传输信道按照 20MHz 来算，邻信道也是 20MHz。根据给出的数据，请计算功放预失真补偿前后的功率谱密度，并用图形的方式表示三类信号的功率谱密度（输入信号、无预失真补偿的功率放大器输出信号、采用预失真补偿的功率放大器输出信号），最后用 ACPR 对结果进行分析评价。\nAddendum: \n参考文献\n[1] John Tsimbinos, Identification and Compensation of Nonlinear Distortion, PhD Dissertation, School of Electronic Engineering, University Of South Australia, Adelaide, February 1995.\n[2] Tianhai Wang, et al. Volterra-Mapping-Based Behavioral Modeling of Nonlinear Circuits and Systems for High Frequencies.  IEEE Trans. Microwave Theory and Techniques, 2003,51(5):1433-1440\n[3] Raviv Raich, et al. Orthogonal Polynomials for Power Amplifier Modeling and Predistorter Design.  IEEE Trans. Vehicular technology, 2004,53(5):1468-1479\n[4]Dennis R.Morgan et al. A Generalized Memory Polynomial Model for Digital Predistortion of RF Power Amplifiers. IEEE Trans. Signal Processing , 2006,54(10):3852-3860\nDataset Path:\n['pa_in_memory.txt', 'pa_out_memory.txt', 'pa_in_out_memory.mat', 'pa_in_memoryless.txt', 'pa_out_memoryless.txt', 'pa_in_out_memoryless.mat']\n\nData Description:\n本数据集包含用于功率放大器（PA）建模与仿真的一组输入/输出基带复信号，既有带记忆效应（memory）也有无记忆（memoryless）两类数据，文件类型包括逐点文本文件（例如 pa_in_memory.txt、pa_out_memory.txt、pa_in_memoryless.txt、pa_out_memoryless.txt）和结构化 MATLAB 文件（pa_in_out_memory.mat、pa_in_out_memoryless.mat）；文本文件以每行一个复数的形式存储（格式示例：6.1519e-015-4.9215e-015i），MAT 文件可直接用 MATLAB 或 Python 的 scipy.io.loadmat 读取并通常包含字段 pa_in（输入复序列）、pa_out（输出复序列）及可选的 Fs（采样率）用于频域分析，同时带有 __header__、__version__、__globals__ 等元信息。数据为列向量形式、数据类型为 complex128，每组包含 1000 个时域采样点（shape 大小示例为 [1000,1]），数值幅度范围示例：输入幅值最大约 1.0553、输出幅值最大约 1.9274（幅度最小为 0），输出相对于输入包含非线性失真和（或）记忆效应（时延相关）以便用于非线性建模、失真分析和功放性能对比验证。",
  "problem": {
    "background": "信号的功率放大是电子通信系统的关键功能之一，其实现模块称为功率放大器（PA，Power Amplifier），简称功放。功放的输出信号相对于输入信号可能产生非线性变形，这将带来无益的干扰信号，影响信信息的正确传递和接收，此现象称为非线性失真。传统电路设计上，可通过降低输出功率的方式减轻非线性失真效应。\n\n功放非线性属于有源电子器件的固有特性，研究其机理并采取措施改善，具有重要意义。目前已提出了各种技术来克服改善功放的非线性失真，其中预失真技术是被研究和应用较多的一项新技术，其最新的研究成果已经被用于实际的产品（如无线通信系统等），但在新算法、实现复杂度、计算速度、效果精度等方面仍有相当的研究价值。\n\n本题从数学建模的角度进行探索。若记输入信号 $x(t)$，输出信号为 $z(t)$，$t$ 为时间变量，则功放非线性在数学上可表示为 \n$z(t) = G(x(t))$，\n其中 $G$ 为非线性函数。预失真的基本原理是：在功放前设置一个预失真处理模块，这两个模块的合成总效果使整体输入-输出特性线性化，输出功率得到充分利用。原理框图如图1所示。\n\n其中 $x(t)$ 和 $z(t)$ 的含义如前所述，$y(t)$ 为预失真器的输出。设功放输入-输出传输特性为 $G(\\cdot)$，预失真器特性为 $F(\\cdot)$，那么预失真处理原理可表示为 \n$$z(t) = G(y(t)) = G(F(x(t))) = (G \\circ F)(x(t)) = L(x(t)) \\tag{1}$$\n$G \\circ F = L$ 表示为 $G(\\cdot)$ 和 $F(\\cdot)$ 的复合函数等于 $L(\\cdot)$。线性化则要求 \n$$z(t) = L(x(t)) = g \\cdot x(t) \\tag{2}$$\n式中常数 $g$ 是功放的理想“幅度放大倍数” ($g > 1$)。因此，若功放特性 $G(\\cdot)$ 已知，则预失真技术的核心是寻找预失真器的特性 $F(\\cdot)$，使得它们复合后能满足 \n$$(G \\circ F)(x(t)) = L(x(t)) = g \\cdot x(t). \\tag{3}$$\n如果测得功放的输入和输出信号值，就能拟合功放的特性函数 $G(\\cdot)$，然后利用 (3) 式，可以求得 $F(\\cdot)$。\n\n2.功放的非线性模型\n\n由于各类功放的固有特性不同，特性函数$G()$差异较大，即使同一功放，由于输入信号类型、环境温度等的改变，其非线性特性也会发生变化。根据函数逼近的Weierstrass定理，对解析函数$G(x)$总可以用一个次数充分大的多项式逼近到任意程度，故可采用计算简单的多项式表示非线性函数。\n\n如果某一时刻的输出仅与此时刻的输入相关，称为无记忆功放，其特性可用多项式表示为：\n$$z(t) = \\sum_{k=1}^K h_k x^k(t), \\quad t \\in [0,T] \\tag{4}$$\n式中 $K$ 表示非线性的阶数（即多项式次数），诸 $h_k$ 为各次幂的系数。在函数逼近理论中，$z(t)$ 是用函数数组 $\\{x^0, x^2, x^3, \\ldots, x^K\\}$ 生成的 $K+1$ 维空间里的这组基的线性组合表示。用函数空间的一组正交函数基 $\\{\\varphi_k(x)\\}_{k=0}^K$ 的线性组合表示则性能更佳、计算更方便，故 (4) 亦可用正交基等其它方式表示。\n\n如果对功放输入 $x(t)$ / 输出 $z(t)$ 进行离散采样后值分别为 $x(n)$ / $z(n)$（采样过程符合 Nyquist 采样定理要求），则 (4) 可用离散多项式表示如下：\n$$z(n) = \\sum_{k=1}^K h_k x^k(n) = h_1 x(n) + h_2 x^2(n) + \\cdots + h_K x^K(n), \\quad n = 0,1,2,\\ldots,N \\tag{5}$$\n\n如果功放的某一时刻输出不仅与此时刻输入有关，而且与此前某一时间段的输入有关，则称为有记忆功放。对 (5) 式增加记忆效应，可以写为：\n$$z(n) = \\sum_{k=1}^K \\sum_{m=0}^M h_{km} x^k(n-m) = h_{10}x(n) + h_{11}x(n-1) + \\cdots + h_{1M}x(n-M) \\\\ + h_{20}x^2(n) + h_{21}x^2(n-1) + \\cdots + h_{2M}x^2(n-M) \\\\ + \\cdots \\cdots \\\\ + h_{K0}x^K(n) + h_{K1}x^K(n-1) + \\cdots + h_{KM}x^K(n-M), \\quad n=0,1,2,\\ldots,N \\tag{6}$$\n\n式中 $M$ 表示记忆深度，诸 $h_{km}$ 为系数。具有记忆效应的功放模型也可以用更一般的 Volterra 级数 [1][2] 表示，由于 Volterra 级数太复杂，简化模型有 Wiener、Hammerstein 等 [3][4]。由于常用复值输入-输出信号，(6) 也可表示为便于计算的“和记忆多项式”模型：\n$$z(n) = \\sum_{k=1}^K \\sum_{m=0}^M h_{km} x(n-m) |x(n-m)|^{k-1}, \\quad n=0,1,2,\\ldots,N \\tag{7}$$\n\n3.预失真处理模型\n\n在功放的特性$G()$已知条件下，求解方程(3)是一类特殊的函数方程，求解的理论方法因具体问题而定，而工程上常采取数值计算，用最小化目标误差函数的方法，求得近似的$F()$。目标误差函数的选取和判断准则因建模方法而异，总体原则是使预失真和功放的联合模型呈线性后误差最小。\n\n本题探索中，预失真处理建模还需考虑以下2个约束条件：\n\n预失真处理的“输出幅度限制”。由于功放的输入幅度需保持在一定范围，过大的值会导致饱和溢出，因此，本题的建模中限定预失真处理的输出幅度不大于所给出的功放输入幅度最大值。\n\n预失真处理加载后，尽可能使功放的输出“功率最大化”。 为了充分发挥功放的作用，预失真处理模型的建立必需考虑尽可能使功放的信号平均输出功率最大，因此预失真处理后的输出幅度（等效为功放的输入幅度）需尽可能提高。\n4.计算结果评价\n\n以上模型的数值计算结果业界常用NMSE、EVM等参数评价其准确度，具体定义如下。\n\n采用归一化均方误差 (Normalized Mean Square Error, NMSE) 来表征计算精度，其表达式为$$NMSE = 10 \\log_{10} \\frac{\\sum_{n=1}^{N} |z(n) - \\hat{z}(n)|^2}{\\sum_{n=1}^{N} |z(n)|^2} \\tag{8}$$\n\n如果用 $z$ 表示实际信号值，$\\hat{z}$ 表示通过模型计算的信号值，NMSE 就反映了模型与物理实际模块的接近程度。功放前加载预失真处理后，也可用 NMSE 判断整体模型输出值与理想输出值的近似程度。\n\n误差矢量幅度（Error Vector Magnitude，EVM）定义为误差矢量信号平均功率的均方根和参照信号平均功率的均方根的比值，以百分数形式表示。如果用 $X$ 表示理想的信号输出值，$e$ 表示理想输出与整体模型输出信号的误差，可用 EVM 衡量整体模型对信号的幅度失真程度。\n\n$$EVM = \\frac{\\sqrt{E[|e|^2]}}{\\sqrt{E[|X|^2]}} \\times 100\\% \\tag{9}$$",
    "problem_requirement": "在上述提供的背景材料以及自行查阅相关文献资料的基础上，请你们的团队研究下列问题。要求写出计算的过程、注明所用的优化方法、解释选择中间参数的理由、并附上所用的程序（C/C++/Java/Matlab等）。为保证所用模型的工程可实现性，请考虑选用适当复杂度的模型和算法。\n\n以下各题中的数学建模鼓励创新，不局限于背景介绍的模型方法。\n\n1. 无记忆功放\n\n数据文件1给出了某功放无记忆效应的复输入-输出测试数据，其输入-输出幅度图为：\n                    \n图2  功放输入/输出幅度散点图\n\n请根据提供的数据，完成以下任务。\n\nA．建立此功放的非线性特性的数学模型，然后用NMSE评价所建模型的准确度。\n\nB．根据线性化原则以及“输出幅度限制”和“功率最大化”约束，建立预失真模型。写出目标误差函数，计算线性化后最大可能的幅度放大倍数，运用评价指标参数NMSE/EVM评价预失真补偿的结果。\n\n2. 有记忆功放\n\n数据文件2给出了某功放的有记忆效应的复输入-输出数据，请完成以下任务。\n\nA．建立此功放的非线性特性的数学模型，然后用NMSE评价所建模型的准确度。\n\nB．根据线性化原则以及“输出幅度限制”和“功率最大化”约束，以框图的方式建立预失真处理的模型实现示意图（提示：可定义基本实现单元模块和确定其之间关系，组成整体图），然后计算预失真模型相关参数。运用评价指标参数NMSE/EVM评价预失真补偿的计算结果。\n\n3． 拓展研究\n\n相邻信道功率比（Adjacent Channel Power Ratio，ACPR）是表示信道的带外失真的参数，衡量由于非线性效应所产生的新频率分量对邻道信号的影响程度。其定义为：\n$$ACPR = 10 \\log_{10} \\frac{\\int_{f_2}^{f_3} s(f)\\,df}{\\int_{f_1}^{f_2} s(f)\\,df} \\tag{10}$$\n\n其中 $s(f)$ 为信号的功率谱密度函数，$[f_1,f_2]$ 为传输信道，$[f_2,f_3]$ 为相邻信道。功率谱密度的计算可通过对信号的自相关函数进行 Fourier 变换计算，也可以通过直接法等计算（假定本题涉及的信号为时间平稳信号）。\n\n如果题2所附的数据采样频率 $F_s = 30.72 \\times 12 \\,\\text{MHz}$，传输信道按照 20MHz 来算，邻信道也是 20MHz。根据给出的数据，请计算功放预失真补偿前后的功率谱密度，并用图形的方式表示三类信号的功率谱密度（输入信号、无预失真补偿的功率放大器输出信号、采用预失真补偿的功率放大器输出信号），最后用 ACPR 对结果进行分析评价。",
    "dataset_path": [
      "pa_in_memory.txt",
      "pa_out_memory.txt",
      "pa_in_out_memory.mat",
      "pa_in_memoryless.txt",
      "pa_out_memoryless.txt",
      "pa_in_out_memoryless.mat"
    ],
    "dataset_description": {
      "pa_in_memory": "这是一个纯文本文件，存储了功放输入信号（memoryless 输入）的数据。文件内容主要由复数构成，例如：6.1519e-015-4.9215e-015i，-1.2304e-015-4.9215e-015i，...，每一行代表一个采样点的输入值，格式为 实部 ± 虚部 i。这些数据可以用来表示基带信号的时域输入样本，用于后续非线性建模或功放仿真。",
      "pa_out_memory": "这是一个纯文本文件，存储了功放输出信号（具有记忆效应）的数据。与第一个文件类似，其内容也是复数序列：-0.0037878-0.0044593i，-0.0013122-0.0041377i，...，这些数据代表了功率放大器输出的信号波形。与输入信号相比，输出信号包含非线性失真和记忆效应（时延相关），可用于对比分析功放的性能。",
      "pa_in_out_memory": "这是一个 MATLAB 数据文件，同时保存了输入信号和输出信号。相比前两个 .txt 文件逐点存储的方式，.mat 文件是结构化存储，方便直接在 MATLAB 或 Python (scipy.io.loadmat) 中读取。",
      "pa_in_memoryless": "这是一个文本文件，存储功率放大器输入信号（无记忆效应），每一行是一个复数（格式为实部 ± 虚部 i，如 6.1519e-015-4.9215e-015i），数据代表基带信号在时域上的采样点，作为功率放大器输入参考信号。",
      "pa_out_memoryless": "这是一个文本文件，保存功率放大器输出信号（无记忆效应），内容为复数序列（如 1.8456e-014-1.4765e-014i），数据代表经过功率放大器后的输出波形，可用于比较输入与输出的非线性特性。",
      "pa_in_out_memoryless": "这是一个 MATLAB 数据文件，同时包含输入信号和输出信号，以结构化数组存储，便于在 MATLAB 或 Python（如 scipy.io.loadmat）中直接加载，典型字段包括 pa_in（输入信号，复数序列，对应 pa_in_memoryless.txt 内容）、pa_out（输出信号，复数序列，对应 pa_out_memoryless.txt 内容）、Fs（采样率，部分文件包含，用于信号频域分析和建模）。"
    },
    "variable_description": [
      {},
      {},
      {
        "pa_in_memory": {
          "description": "记忆功放的输入信号（基带复信号，时域采样）",
          "dtype": "complex128",
          "shape": [
            1000,
            1
          ],
          "ndim": 2,
          "is_complex": true,
          "num_samples": 1000,
          "abs_min": 0.0,
          "abs_max": 1.0552674011147538,
          "notes": "列向量；与 pa_in_memory.txt 内容对应"
        },
        "pa_out_memory": {
          "description": "记忆功放的输出信号（包含非线性效应后的基带复信号，时域采样）",
          "dtype": "complex128",
          "shape": [
            1000,
            1
          ],
          "ndim": 2,
          "is_complex": true,
          "num_samples": 1000,
          "abs_min": 0.0,
          "abs_max": 1.9274454614619805,
          "notes": "列向量；与 pa_out_memory.txt 内容对应"
        },
        "__meta__": {
          "__header__": "MATLAB file header string (版本/平台信息)",
          "__version__": "MAT 文件版本号（例如 '1.0' 或 '1.0 MAT-file' 之类）",
          "__globals__": "[]（空列表）"
        }
      },
      {},
      {
        "pa_in_memoryless": {
          "description": "无记忆功放的输入信号（基带复信号，时域采样）",
          "dtype": "complex128",
          "shape": [
            1000,
            1
          ],
          "ndim": 2,
          "is_complex": true,
          "num_samples": 1000,
          "abs_min": 0.0,
          "abs_max": 1.0552674011147538,
          "notes": "列向量；与 pa_in_memoryless.txt 内容对应"
        },
        "pa_out_memoryless": {
          "description": "无记忆功放的输出信号（包含非线性效应后的基带复信号，时域采样）",
          "dtype": "complex128",
          "shape": [
            1000,
            1
          ],
          "ndim": 2,
          "is_complex": true,
          "num_samples": 1000,
          "abs_min": 0.0,
          "abs_max": 1.9274454614619805,
          "notes": "列向量；与 pa_out_memoryless.txt 内容对应"
        },
        "__meta__": {
          "__header__": "MATLAB file header string (版本/平台信息)",
          "__version__": "MAT 文件版本号（例如 '1.0' 或 '1.0 MAT-file' 之类）",
          "__globals__": "[]（空列表）"
        }
      }
    ],
    "addendum": "参考文献\n[1] John Tsimbinos, Identification and Compensation of Nonlinear Distortion, PhD Dissertation, School of Electronic Engineering, University Of South Australia, Adelaide, February 1995.\n[2] Tianhai Wang, et al. Volterra-Mapping-Based Behavioral Modeling of Nonlinear Circuits and Systems for High Frequencies.  IEEE Trans. Microwave Theory and Techniques, 2003,51(5):1433-1440\n[3] Raviv Raich, et al. Orthogonal Polynomials for Power Amplifier Modeling and Predistorter Design.  IEEE Trans. Vehicular technology, 2004,53(5):1468-1479\n[4]Dennis R.Morgan et al. A Generalized Memory Polynomial Model for Digital Predistortion of RF Power Amplifiers. IEEE Trans. Signal Processing , 2006,54(10):3852-3860",
    "data_summary": "Dataset Path:\n['pa_in_memory.txt', 'pa_out_memory.txt', 'pa_in_out_memory.mat', 'pa_in_memoryless.txt', 'pa_out_memoryless.txt', 'pa_in_out_memoryless.mat']\n\nData Description:\n本数据集包含用于功率放大器（PA）建模与仿真的一组输入/输出基带复信号，既有带记忆效应（memory）也有无记忆（memoryless）两类数据，文件类型包括逐点文本文件（例如 pa_in_memory.txt、pa_out_memory.txt、pa_in_memoryless.txt、pa_out_memoryless.txt）和结构化 MATLAB 文件（pa_in_out_memory.mat、pa_in_out_memoryless.mat）；文本文件以每行一个复数的形式存储（格式示例：6.1519e-015-4.9215e-015i），MAT 文件可直接用 MATLAB 或 Python 的 scipy.io.loadmat 读取并通常包含字段 pa_in（输入复序列）、pa_out（输出复序列）及可选的 Fs（采样率）用于频域分析，同时带有 __header__、__version__、__globals__ 等元信息。数据为列向量形式、数据类型为 complex128，每组包含 1000 个时域采样点（shape 大小示例为 [1000,1]），数值幅度范围示例：输入幅值最大约 1.0553、输出幅值最大约 1.9274（幅度最小为 0），输出相对于输入包含非线性失真和（或）记忆效应（时延相关）以便用于非线性建模、失真分析和功放性能对比验证。",
    "data_description": {
      "pa_in_memory": "这是一个纯文本文件，存储了功放输入信号（memoryless 输入）的数据。文件内容主要由复数构成，例如：6.1519e-015-4.9215e-015i，-1.2304e-015-4.9215e-015i，...，每一行代表一个采样点的输入值，格式为 实部 ± 虚部 i。这些数据可以用来表示基带信号的时域输入样本，用于后续非线性建模或功放仿真。",
      "pa_out_memory": "这是一个纯文本文件，存储了功放输出信号（具有记忆效应）的数据。与第一个文件类似，其内容也是复数序列：-0.0037878-0.0044593i，-0.0013122-0.0041377i，...，这些数据代表了功率放大器输出的信号波形。与输入信号相比，输出信号包含非线性失真和记忆效应（时延相关），可用于对比分析功放的性能。",
      "pa_in_out_memory": "这是一个 MATLAB 数据文件，同时保存了输入信号和输出信号。相比前两个 .txt 文件逐点存储的方式，.mat 文件是结构化存储，方便直接在 MATLAB 或 Python (scipy.io.loadmat) 中读取。",
      "pa_in_memoryless": "这是一个文本文件，存储功率放大器输入信号（无记忆效应），每一行是一个复数（格式为实部 ± 虚部 i，如 6.1519e-015-4.9215e-015i），数据代表基带信号在时域上的采样点，作为功率放大器输入参考信号。",
      "pa_out_memoryless": "这是一个文本文件，保存功率放大器输出信号（无记忆效应），内容为复数序列（如 1.8456e-014-1.4765e-014i），数据代表经过功率放大器后的输出波形，可用于比较输入与输出的非线性特性。",
      "pa_in_out_memoryless": "这是一个 MATLAB 数据文件，同时包含输入信号和输出信号，以结构化数组存储，便于在 MATLAB 或 Python（如 scipy.io.loadmat）中直接加载，典型字段包括 pa_in（输入信号，复数序列，对应 pa_in_memoryless.txt 内容）、pa_out（输出信号，复数序列，对应 pa_out_memoryless.txt 内容）、Fs（采样率，部分文件包含，用于信号频域分析和建模）。"
    },
    "problem_str": "问题背景：\n信号的功率放大是电子通信系统的关键功能之一，其实现模块称为功率放大器（PA，Power Amplifier），简称功放。功放的输出信号相对于输入信号可能产生非线性变形，这将带来无益的干扰信号，影响信信息的正确传递和接收，此现象称为非线性失真。传统电路设计上，可通过降低输出功率的方式减轻非线性失真效应。\n\n功放非线性属于有源电子器件的固有特性，研究其机理并采取措施改善，具有重要意义。目前已提出了各种技术来克服改善功放的非线性失真，其中预失真技术是被研究和应用较多的一项新技术，其最新的研究成果已经被用于实际的产品（如无线通信系统等），但在新算法、实现复杂度、计算速度、效果精度等方面仍有相当的研究价值。\n\n本题从数学建模的角度进行探索。若记输入信号 $x(t)$，输出信号为 $z(t)$，$t$ 为时间变量，则功放非线性在数学上可表示为 \n$z(t) = G(x(t))$，\n其中 $G$ 为非线性函数。预失真的基本原理是：在功放前设置一个预失真处理模块，这两个模块的合成总效果使整体输入-输出特性线性化，输出功率得到充分利用。原理框图如图1所示。\n\n其中 $x(t)$ 和 $z(t)$ 的含义如前所述，$y(t)$ 为预失真器的输出。设功放输入-输出传输特性为 $G(\\cdot)$，预失真器特性为 $F(\\cdot)$，那么预失真处理原理可表示为 \n$$z(t) = G(y(t)) = G(F(x(t))) = (G \\circ F)(x(t)) = L(x(t)) \\tag{1}$$\n$G \\circ F = L$ 表示为 $G(\\cdot)$ 和 $F(\\cdot)$ 的复合函数等于 $L(\\cdot)$。线性化则要求 \n$$z(t) = L(x(t)) = g \\cdot x(t) \\tag{2}$$\n式中常数 $g$ 是功放的理想“幅度放大倍数” ($g > 1$)。因此，若功放特性 $G(\\cdot)$ 已知，则预失真技术的核心是寻找预失真器的特性 $F(\\cdot)$，使得它们复合后能满足 \n$$(G \\circ F)(x(t)) = L(x(t)) = g \\cdot x(t). \\tag{3}$$\n如果测得功放的输入和输出信号值，就能拟合功放的特性函数 $G(\\cdot)$，然后利用 (3) 式，可以求得 $F(\\cdot)$。\n\n2.功放的非线性模型\n\n由于各类功放的固有特性不同，特性函数$G()$差异较大，即使同一功放，由于输入信号类型、环境温度等的改变，其非线性特性也会发生变化。根据函数逼近的Weierstrass定理，对解析函数$G(x)$总可以用一个次数充分大的多项式逼近到任意程度，故可采用计算简单的多项式表示非线性函数。\n\n如果某一时刻的输出仅与此时刻的输入相关，称为无记忆功放，其特性可用多项式表示为：\n$$z(t) = \\sum_{k=1}^K h_k x^k(t), \\quad t \\in [0,T] \\tag{4}$$\n式中 $K$ 表示非线性的阶数（即多项式次数），诸 $h_k$ 为各次幂的系数。在函数逼近理论中，$z(t)$ 是用函数数组 $\\{x^0, x^2, x^3, \\ldots, x^K\\}$ 生成的 $K+1$ 维空间里的这组基的线性组合表示。用函数空间的一组正交函数基 $\\{\\varphi_k(x)\\}_{k=0}^K$ 的线性组合表示则性能更佳、计算更方便，故 (4) 亦可用正交基等其它方式表示。\n\n如果对功放输入 $x(t)$ / 输出 $z(t)$ 进行离散采样后值分别为 $x(n)$ / $z(n)$（采样过程符合 Nyquist 采样定理要求），则 (4) 可用离散多项式表示如下：\n$$z(n) = \\sum_{k=1}^K h_k x^k(n) = h_1 x(n) + h_2 x^2(n) + \\cdots + h_K x^K(n), \\quad n = 0,1,2,\\ldots,N \\tag{5}$$\n\n如果功放的某一时刻输出不仅与此时刻输入有关，而且与此前某一时间段的输入有关，则称为有记忆功放。对 (5) 式增加记忆效应，可以写为：\n$$z(n) = \\sum_{k=1}^K \\sum_{m=0}^M h_{km} x^k(n-m) = h_{10}x(n) + h_{11}x(n-1) + \\cdots + h_{1M}x(n-M) \\\\ + h_{20}x^2(n) + h_{21}x^2(n-1) + \\cdots + h_{2M}x^2(n-M) \\\\ + \\cdots \\cdots \\\\ + h_{K0}x^K(n) + h_{K1}x^K(n-1) + \\cdots + h_{KM}x^K(n-M), \\quad n=0,1,2,\\ldots,N \\tag{6}$$\n\n式中 $M$ 表示记忆深度，诸 $h_{km}$ 为系数。具有记忆效应的功放模型也可以用更一般的 Volterra 级数 [1][2] 表示，由于 Volterra 级数太复杂，简化模型有 Wiener、Hammerstein 等 [3][4]。由于常用复值输入-输出信号，(6) 也可表示为便于计算的“和记忆多项式”模型：\n$$z(n) = \\sum_{k=1}^K \\sum_{m=0}^M h_{km} x(n-m) |x(n-m)|^{k-1}, \\quad n=0,1,2,\\ldots,N \\tag{7}$$\n\n3.预失真处理模型\n\n在功放的特性$G()$已知条件下，求解方程(3)是一类特殊的函数方程，求解的理论方法因具体问题而定，而工程上常采取数值计算，用最小化目标误差函数的方法，求得近似的$F()$。目标误差函数的选取和判断准则因建模方法而异，总体原则是使预失真和功放的联合模型呈线性后误差最小。\n\n本题探索中，预失真处理建模还需考虑以下2个约束条件：\n\n预失真处理的“输出幅度限制”。由于功放的输入幅度需保持在一定范围，过大的值会导致饱和溢出，因此，本题的建模中限定预失真处理的输出幅度不大于所给出的功放输入幅度最大值。\n\n预失真处理加载后，尽可能使功放的输出“功率最大化”。 为了充分发挥功放的作用，预失真处理模型的建立必需考虑尽可能使功放的信号平均输出功率最大，因此预失真处理后的输出幅度（等效为功放的输入幅度）需尽可能提高。\n4.计算结果评价\n\n以上模型的数值计算结果业界常用NMSE、EVM等参数评价其准确度，具体定义如下。\n\n采用归一化均方误差 (Normalized Mean Square Error, NMSE) 来表征计算精度，其表达式为$$NMSE = 10 \\log_{10} \\frac{\\sum_{n=1}^{N} |z(n) - \\hat{z}(n)|^2}{\\sum_{n=1}^{N} |z(n)|^2} \\tag{8}$$\n\n如果用 $z$ 表示实际信号值，$\\hat{z}$ 表示通过模型计算的信号值，NMSE 就反映了模型与物理实际模块的接近程度。功放前加载预失真处理后，也可用 NMSE 判断整体模型输出值与理想输出值的近似程度。\n\n误差矢量幅度（Error Vector Magnitude，EVM）定义为误差矢量信号平均功率的均方根和参照信号平均功率的均方根的比值，以百分数形式表示。如果用 $X$ 表示理想的信号输出值，$e$ 表示理想输出与整体模型输出信号的误差，可用 EVM 衡量整体模型对信号的幅度失真程度。\n\n$$EVM = \\frac{\\sqrt{E[|e|^2]}}{\\sqrt{E[|X|^2]}} \\times 100\\% \\tag{9}$$\n\n问题要求：\n在上述提供的背景材料以及自行查阅相关文献资料的基础上，请你们的团队研究下列问题。要求写出计算的过程、注明所用的优化方法、解释选择中间参数的理由、并附上所用的程序（C/C++/Java/Matlab等）。为保证所用模型的工程可实现性，请考虑选用适当复杂度的模型和算法。\n\n以下各题中的数学建模鼓励创新，不局限于背景介绍的模型方法。\n\n1. 无记忆功放\n\n数据文件1给出了某功放无记忆效应的复输入-输出测试数据，其输入-输出幅度图为：\n                    \n图2  功放输入/输出幅度散点图\n\n请根据提供的数据，完成以下任务。\n\nA．建立此功放的非线性特性的数学模型，然后用NMSE评价所建模型的准确度。\n\nB．根据线性化原则以及“输出幅度限制”和“功率最大化”约束，建立预失真模型。写出目标误差函数，计算线性化后最大可能的幅度放大倍数，运用评价指标参数NMSE/EVM评价预失真补偿的结果。\n\n2. 有记忆功放\n\n数据文件2给出了某功放的有记忆效应的复输入-输出数据，请完成以下任务。\n\nA．建立此功放的非线性特性的数学模型，然后用NMSE评价所建模型的准确度。\n\nB．根据线性化原则以及“输出幅度限制”和“功率最大化”约束，以框图的方式建立预失真处理的模型实现示意图（提示：可定义基本实现单元模块和确定其之间关系，组成整体图），然后计算预失真模型相关参数。运用评价指标参数NMSE/EVM评价预失真补偿的计算结果。\n\n3． 拓展研究\n\n相邻信道功率比（Adjacent Channel Power Ratio，ACPR）是表示信道的带外失真的参数，衡量由于非线性效应所产生的新频率分量对邻道信号的影响程度。其定义为：\n$$ACPR = 10 \\log_{10} \\frac{\\int_{f_2}^{f_3} s(f)\\,df}{\\int_{f_1}^{f_2} s(f)\\,df} \\tag{10}$$\n\n其中 $s(f)$ 为信号的功率谱密度函数，$[f_1,f_2]$ 为传输信道，$[f_2,f_3]$ 为相邻信道。功率谱密度的计算可通过对信号的自相关函数进行 Fourier 变换计算，也可以通过直接法等计算（假定本题涉及的信号为时间平稳信号）。\n\n如果题2所附的数据采样频率 $F_s = 30.72 \\times 12 \\,\\text{MHz}$，传输信道按照 20MHz 来算，邻信道也是 20MHz。根据给出的数据，请计算功放预失真补偿前后的功率谱密度，并用图形的方式表示三类信号的功率谱密度（输入信号、无预失真补偿的功率放大器输出信号、采用预失真补偿的功率放大器输出信号），最后用 ACPR 对结果进行分析评价。\nAddendum: \n参考文献\n[1] John Tsimbinos, Identification and Compensation of Nonlinear Distortion, PhD Dissertation, School of Electronic Engineering, University Of South Australia, Adelaide, February 1995.\n[2] Tianhai Wang, et al. Volterra-Mapping-Based Behavioral Modeling of Nonlinear Circuits and Systems for High Frequencies.  IEEE Trans. Microwave Theory and Techniques, 2003,51(5):1433-1440\n[3] Raviv Raich, et al. Orthogonal Polynomials for Power Amplifier Modeling and Predistorter Design.  IEEE Trans. Vehicular technology, 2004,53(5):1468-1479\n[4]Dennis R.Morgan et al. A Generalized Memory Polynomial Model for Digital Predistortion of RF Power Amplifiers. IEEE Trans. Signal Processing , 2006,54(10):3852-3860\nDataset Path:\n['pa_in_memory.txt', 'pa_out_memory.txt', 'pa_in_out_memory.mat', 'pa_in_memoryless.txt', 'pa_out_memoryless.txt', 'pa_in_out_memoryless.mat']\n\nData Description:\n本数据集包含用于功率放大器（PA）建模与仿真的一组输入/输出基带复信号，既有带记忆效应（memory）也有无记忆（memoryless）两类数据，文件类型包括逐点文本文件（例如 pa_in_memory.txt、pa_out_memory.txt、pa_in_memoryless.txt、pa_out_memoryless.txt）和结构化 MATLAB 文件（pa_in_out_memory.mat、pa_in_out_memoryless.mat）；文本文件以每行一个复数的形式存储（格式示例：6.1519e-015-4.9215e-015i），MAT 文件可直接用 MATLAB 或 Python 的 scipy.io.loadmat 读取并通常包含字段 pa_in（输入复序列）、pa_out（输出复序列）及可选的 Fs（采样率）用于频域分析，同时带有 __header__、__version__、__globals__ 等元信息。数据为列向量形式、数据类型为 complex128，每组包含 1000 个时域采样点（shape 大小示例为 [1000,1]），数值幅度范围示例：输入幅值最大约 1.0553、输出幅值最大约 1.9274（幅度最小为 0），输出相对于输入包含非线性失真和（或）记忆效应（时延相关）以便用于非线性建模、失真分析和功放性能对比验证。"
  },
  "problem_background": "信号的功率放大是电子通信系统的关键功能之一，其实现模块称为功率放大器（PA，Power Amplifier），简称功放。功放的输出信号相对于输入信号可能产生非线性变形，这将带来无益的干扰信号，影响信信息的正确传递和接收，此现象称为非线性失真。传统电路设计上，可通过降低输出功率的方式减轻非线性失真效应。\n\n功放非线性属于有源电子器件的固有特性，研究其机理并采取措施改善，具有重要意义。目前已提出了各种技术来克服改善功放的非线性失真，其中预失真技术是被研究和应用较多的一项新技术，其最新的研究成果已经被用于实际的产品（如无线通信系统等），但在新算法、实现复杂度、计算速度、效果精度等方面仍有相当的研究价值。\n\n本题从数学建模的角度进行探索。若记输入信号 $x(t)$，输出信号为 $z(t)$，$t$ 为时间变量，则功放非线性在数学上可表示为 \n$z(t) = G(x(t))$，\n其中 $G$ 为非线性函数。预失真的基本原理是：在功放前设置一个预失真处理模块，这两个模块的合成总效果使整体输入-输出特性线性化，输出功率得到充分利用。原理框图如图1所示。\n\n其中 $x(t)$ 和 $z(t)$ 的含义如前所述，$y(t)$ 为预失真器的输出。设功放输入-输出传输特性为 $G(\\cdot)$，预失真器特性为 $F(\\cdot)$，那么预失真处理原理可表示为 \n$$z(t) = G(y(t)) = G(F(x(t))) = (G \\circ F)(x(t)) = L(x(t)) \\tag{1}$$\n$G \\circ F = L$ 表示为 $G(\\cdot)$ 和 $F(\\cdot)$ 的复合函数等于 $L(\\cdot)$。线性化则要求 \n$$z(t) = L(x(t)) = g \\cdot x(t) \\tag{2}$$\n式中常数 $g$ 是功放的理想“幅度放大倍数” ($g > 1$)。因此，若功放特性 $G(\\cdot)$ 已知，则预失真技术的核心是寻找预失真器的特性 $F(\\cdot)$，使得它们复合后能满足 \n$$(G \\circ F)(x(t)) = L(x(t)) = g \\cdot x(t). \\tag{3}$$\n如果测得功放的输入和输出信号值，就能拟合功放的特性函数 $G(\\cdot)$，然后利用 (3) 式，可以求得 $F(\\cdot)$。\n\n2.功放的非线性模型\n\n由于各类功放的固有特性不同，特性函数$G()$差异较大，即使同一功放，由于输入信号类型、环境温度等的改变，其非线性特性也会发生变化。根据函数逼近的Weierstrass定理，对解析函数$G(x)$总可以用一个次数充分大的多项式逼近到任意程度，故可采用计算简单的多项式表示非线性函数。\n\n如果某一时刻的输出仅与此时刻的输入相关，称为无记忆功放，其特性可用多项式表示为：\n$$z(t) = \\sum_{k=1}^K h_k x^k(t), \\quad t \\in [0,T] \\tag{4}$$\n式中 $K$ 表示非线性的阶数（即多项式次数），诸 $h_k$ 为各次幂的系数。在函数逼近理论中，$z(t)$ 是用函数数组 $\\{x^0, x^2, x^3, \\ldots, x^K\\}$ 生成的 $K+1$ 维空间里的这组基的线性组合表示。用函数空间的一组正交函数基 $\\{\\varphi_k(x)\\}_{k=0}^K$ 的线性组合表示则性能更佳、计算更方便，故 (4) 亦可用正交基等其它方式表示。\n\n如果对功放输入 $x(t)$ / 输出 $z(t)$ 进行离散采样后值分别为 $x(n)$ / $z(n)$（采样过程符合 Nyquist 采样定理要求），则 (4) 可用离散多项式表示如下：\n$$z(n) = \\sum_{k=1}^K h_k x^k(n) = h_1 x(n) + h_2 x^2(n) + \\cdots + h_K x^K(n), \\quad n = 0,1,2,\\ldots,N \\tag{5}$$\n\n如果功放的某一时刻输出不仅与此时刻输入有关，而且与此前某一时间段的输入有关，则称为有记忆功放。对 (5) 式增加记忆效应，可以写为：\n$$z(n) = \\sum_{k=1}^K \\sum_{m=0}^M h_{km} x^k(n-m) = h_{10}x(n) + h_{11}x(n-1) + \\cdots + h_{1M}x(n-M) \\\\ + h_{20}x^2(n) + h_{21}x^2(n-1) + \\cdots + h_{2M}x^2(n-M) \\\\ + \\cdots \\cdots \\\\ + h_{K0}x^K(n) + h_{K1}x^K(n-1) + \\cdots + h_{KM}x^K(n-M), \\quad n=0,1,2,\\ldots,N \\tag{6}$$\n\n式中 $M$ 表示记忆深度，诸 $h_{km}$ 为系数。具有记忆效应的功放模型也可以用更一般的 Volterra 级数 [1][2] 表示，由于 Volterra 级数太复杂，简化模型有 Wiener、Hammerstein 等 [3][4]。由于常用复值输入-输出信号，(6) 也可表示为便于计算的“和记忆多项式”模型：\n$$z(n) = \\sum_{k=1}^K \\sum_{m=0}^M h_{km} x(n-m) |x(n-m)|^{k-1}, \\quad n=0,1,2,\\ldots,N \\tag{7}$$\n\n3.预失真处理模型\n\n在功放的特性$G()$已知条件下，求解方程(3)是一类特殊的函数方程，求解的理论方法因具体问题而定，而工程上常采取数值计算，用最小化目标误差函数的方法，求得近似的$F()$。目标误差函数的选取和判断准则因建模方法而异，总体原则是使预失真和功放的联合模型呈线性后误差最小。\n\n本题探索中，预失真处理建模还需考虑以下2个约束条件：\n\n预失真处理的“输出幅度限制”。由于功放的输入幅度需保持在一定范围，过大的值会导致饱和溢出，因此，本题的建模中限定预失真处理的输出幅度不大于所给出的功放输入幅度最大值。\n\n预失真处理加载后，尽可能使功放的输出“功率最大化”。 为了充分发挥功放的作用，预失真处理模型的建立必需考虑尽可能使功放的信号平均输出功率最大，因此预失真处理后的输出幅度（等效为功放的输入幅度）需尽可能提高。\n4.计算结果评价\n\n以上模型的数值计算结果业界常用NMSE、EVM等参数评价其准确度，具体定义如下。\n\n采用归一化均方误差 (Normalized Mean Square Error, NMSE) 来表征计算精度，其表达式为$$NMSE = 10 \\log_{10} \\frac{\\sum_{n=1}^{N} |z(n) - \\hat{z}(n)|^2}{\\sum_{n=1}^{N} |z(n)|^2} \\tag{8}$$\n\n如果用 $z$ 表示实际信号值，$\\hat{z}$ 表示通过模型计算的信号值，NMSE 就反映了模型与物理实际模块的接近程度。功放前加载预失真处理后，也可用 NMSE 判断整体模型输出值与理想输出值的近似程度。\n\n误差矢量幅度（Error Vector Magnitude，EVM）定义为误差矢量信号平均功率的均方根和参照信号平均功率的均方根的比值，以百分数形式表示。如果用 $X$ 表示理想的信号输出值，$e$ 表示理想输出与整体模型输出信号的误差，可用 EVM 衡量整体模型对信号的幅度失真程度。\n\n$$EVM = \\frac{\\sqrt{E[|e|^2]}}{\\sqrt{E[|X|^2]}} \\times 100\\% \\tag{9}$$",
  "problem_requirement": "在上述提供的背景材料以及自行查阅相关文献资料的基础上，请你们的团队研究下列问题。要求写出计算的过程、注明所用的优化方法、解释选择中间参数的理由、并附上所用的程序（C/C++/Java/Matlab等）。为保证所用模型的工程可实现性，请考虑选用适当复杂度的模型和算法。\n\n以下各题中的数学建模鼓励创新，不局限于背景介绍的模型方法。\n\n1. 无记忆功放\n\n数据文件1给出了某功放无记忆效应的复输入-输出测试数据，其输入-输出幅度图为：\n                    \n图2  功放输入/输出幅度散点图\n\n请根据提供的数据，完成以下任务。\n\nA．建立此功放的非线性特性的数学模型，然后用NMSE评价所建模型的准确度。\n\nB．根据线性化原则以及“输出幅度限制”和“功率最大化”约束，建立预失真模型。写出目标误差函数，计算线性化后最大可能的幅度放大倍数，运用评价指标参数NMSE/EVM评价预失真补偿的结果。\n\n2. 有记忆功放\n\n数据文件2给出了某功放的有记忆效应的复输入-输出数据，请完成以下任务。\n\nA．建立此功放的非线性特性的数学模型，然后用NMSE评价所建模型的准确度。\n\nB．根据线性化原则以及“输出幅度限制”和“功率最大化”约束，以框图的方式建立预失真处理的模型实现示意图（提示：可定义基本实现单元模块和确定其之间关系，组成整体图），然后计算预失真模型相关参数。运用评价指标参数NMSE/EVM评价预失真补偿的计算结果。\n\n3． 拓展研究\n\n相邻信道功率比（Adjacent Channel Power Ratio，ACPR）是表示信道的带外失真的参数，衡量由于非线性效应所产生的新频率分量对邻道信号的影响程度。其定义为：\n$$ACPR = 10 \\log_{10} \\frac{\\int_{f_2}^{f_3} s(f)\\,df}{\\int_{f_1}^{f_2} s(f)\\,df} \\tag{10}$$\n\n其中 $s(f)$ 为信号的功率谱密度函数，$[f_1,f_2]$ 为传输信道，$[f_2,f_3]$ 为相邻信道。功率谱密度的计算可通过对信号的自相关函数进行 Fourier 变换计算，也可以通过直接法等计算（假定本题涉及的信号为时间平稳信号）。\n\n如果题2所附的数据采样频率 $F_s = 30.72 \\times 12 \\,\\text{MHz}$，传输信道按照 20MHz 来算，邻信道也是 20MHz。根据给出的数据，请计算功放预失真补偿前后的功率谱密度，并用图形的方式表示三类信号的功率谱密度（输入信号、无预失真补偿的功率放大器输出信号、采用预失真补偿的功率放大器输出信号），最后用 ACPR 对结果进行分析评价。",
  "problem_analysis": "本问题属于工程驱动的逆问题与系统辨识范畴，其核心目标是用数学模型精确描述功率放大器（PA）的非线性及记忆特性，并在此基础上设计一个可实现的预失真器，使得预失真器与功放串联后整体近似线性放大器（即输出与原始输入成比例关系），同时满足实际工程约束（预失真器输出幅度不超过功放可接受的最大输入幅度）并尽可能提高功放的平均输出功率。这个总体目标把建模、辨识、逆问题求解、约束优化与实现复杂度联系在了一起，直接塑造了解题思路：首先需要在可控复杂度范围内选取合适的行为模型来逼近 PA 的映射 G(·)（无记忆时通常用复多项式或正交多项式，有记忆时通常用记忆多项式、广义记忆多项式或简化的 Volterra 结构）；其次依赖于对 G 的估计去求解近似逆映射 F，使得 G∘F ≈ g·I（g 为放大倍数）；再者在求解过程中必须把“幅度上限”与“功率最大化”两个目标纳入为约束或多目标优化的一部分；最后还要考虑如何以有限数据与有限计算资源获得稳定、可在线更新的参数估计与实现方案。以上目标决定了倾向于采用“线性广义参数模型”加最小二乘/正则化估计的技术路线，因为这类模型一方面能用线性回归工具直接解决参数估计问题（计算简单、可解释），另一方面便于控制模型阶数和记忆深度以满足工程可实现性。\n\n在构建模型与算法时必须显性识别并批判性审视若干关键假设与隐含约束。首先通常假设信号的基带复样本满足平稳性或近似平稳，采样满足 Nyquist 条件且数据足够代表工作范围；若这些条件不完全满足（例如输入统计特性变化、温度造成的特性漂移或数据稀疏覆盖不到高幅值区），则所估模型在实际运行中可能失效。其次使用多项式或记忆多项式表示本质上假设 PA 的映射在观测范围内可以被有限阶、有限记忆的线性参数模型良好逼近；若 PA 出现饱和、硬非线性区或非平稳效应，有限阶模型可能不能给出可接受的逼近，且逆映射可能不存在或不稳定。第三在用最小二乘法估计参数时隐含噪声为零均值独立同分布的假设，若测量噪声或量化误差显著，应采用正则化（岭回归）或稳健估计以避免过拟合与病态矩阵问题。第四在设计预失真器时通常采用因果、稳定的实现，且为了实时实现模型需限制运算复杂度；但理想的数学逆可能为非因果或高延迟，这要求在工程实现上做近似与折中，从而限制线性化精度。\n\n各要素之间存在丰富的相互依赖与张力。模型选择（阶数 K 与记忆深度 M）直接影响参数数量、辨识精度及实现复杂度；更高阶或更长记忆能捕捉更复杂失真但也更易过拟合并增加计算与硬件负担。优化目标存在本质上的多目标折中：一方面希望 NMSE/EVM 最小化以保证线性化效果，另一方面希望预失真的输出幅度尽可能接近允许的最大输入以提高输出功率；但推高幅度往往使非线性更加严重，从而需要更复杂的预失真来补偿，且可能使带外辐射（ACPR）恶化。评价指标间也存在张力：最低 NMSE 并不必然带来最佳 ACPR 或 EVM，因此在实际系统中常常需要加权或约束式地同时考虑频域（ACPR）与时域（EVM、NMSE）指标。另一个关键依赖是逆问题的可识别性：若在估计过程中测得的输入输出对没有涵盖 PA 的全幅值—相位空间，则逆映射在未观测区间无法可靠推断，导致预失真在那些输入状态下表现失真甚至引发饱和。\n\n在时间尺度与动态因素方面，需要注意模型与预失真解的稳定性与自适应需求。PA 特性会随温度、偏置与工作点漂移，输入信号统计特性（如瞬时功率分布）也会随业务情形变化，因此静态辨识后得到的预失真器可能随时间退化。为此工程上通常采用在线自适应算法（如间接学习架构 ILA，训练一个后逆模型然后置换为前驱，或直接学习架构通过最小化输出误差在线更新参数），并结合缓慢的梯度下降、RLS 或小批量最小二乘来平衡收敛速度与鲁棒性。此外求解过程中必须约束因果性和实时延迟，记忆深度 M 决定滤波器长度和系统延迟，过长的记忆会增加实现延迟并可能违反实时性要求。还有长期效应例如器件老化或环境变化，会导致模型与在线更新机制需要持续运行以保证性能。\n\n替代性的模型表述与方法选择会显著影响研究路径。可以把问题视为纯函数逼近/系统辨识问题，选择多项式、正交多项式或基于正交化的记忆多项式来做线性参数估计；也可以把它视为频域特性塑形问题，直接以频谱约束（如最小化邻频道能量 ACPR）为目标做多目标优化；或者把预失真器设计看作受控系统的逆设计问题，通过凸/非凸优化在误差约束与功率最大化间做权衡。间接学习架构（先识别后逆）在工程上常被采用因为其实现简单且不需要显式求解复杂的复合逆，但在非线性强、记忆深的情形下直接学习可能更有效。除此之外还可以采用 LUT（查表）方法把幅度-相位映射直接存储，优点是简单直观、查找速度快，但对内存与插值方法要求高，且难以处理记忆效应；基于参数模型（例如广义记忆多项式 GMP）则更易于正则化与在线更新。\n\n不确定性与风险主要来自数据与模型不匹配、噪声与估计不稳定性、以及实现约束导致的近似误差。减轻策略包括使用交叉验证或信息准则（AIC/BIC）选择模型复杂度、使用正则化（岭回归、LASSO）抑制过拟合、用正交化基（例如 Gram–Schmidt 生成的正交多项式）改善数值条件、并在设计中明确把幅度约束作为硬约束处理（通过投影或饱和运算），以避免训练出的预失真器在部署时导致超幅而使 PA 饱和。此外现实中建议在辨识与测试阶段采用覆盖整个幅值分布的训练信号（包括高功率包络）以提高逆模型在极端条件下的鲁棒性。若 PA 在工作范围出现不可逆的饱和区域，则不应尝试线性化到该区，应通过限制运行点或降低目标增益 g 来保持可逆性。\n\n在算法与实现方面，一个现实可行的迭代流程是：先做数据预处理与探索性分析（幅度与相位统计、瞬时功率、频谱估计），然后选择合适的基函数与记忆深度（用少量模型阶次与 M 开始），用最小二乘或带正则化的最小二乘估计 PA 模型并评估 NMSE；接着采用间接学习（训练一个后向模型 H 使 H(z) ≈ x）或直接在前向回路中优化 F 的参数，通过加权最小二乘或约束优化使 G(F(x)) ≈ g x，同时在优化中加入幅度上界与功率最大化的目标（例如最大化 E[|F(x)|^2] 在幅度上界下，或在满足 NMSE ≤ ε 下最大化输出功率）；实现上优先选择线性参数化的预失真模型（如记忆多项式），用批处理最小二乘或递归最小二乘实现实时更新；在频域上用 FFT 与窗函数估计 PSD 并计算 ACPR，必要时把 ACPR 作为约束或多目标的一部分。整个过程应是迭代的：根据测试指标（NMSE、EVM、ACPR）调整模型阶数、正则化强度与学习率，并在部署后保留在线辨识/校正机制以应对漂移。\n\n总之，该问题既有清晰的数学结构（线性参数模型的最小二乘框架、约束优化与逆问题求解）又充满工程折衷（模型复杂度、实时实现、稳定性与多目标性能指标之间的权衡）。良好的做法是在初期采用简单、稳定的模型与估计方法、在受控条件下评估其 NMSE/EVM/ACPR 与功率增益权衡，然后逐步在模型复杂度和在线自适应机制上迭代，以兼顾理论精度与工程可实现性。",
  "modeling_solution": "总体思路与建模目标概述：本题核心是两步工作：第一步用一个结构化、可实现的行为模型精确辨识功放的非线性输入—输出映射 G(·)（无记忆与有记忆分别建模）；第二步在所辨识的 G(·) 基础上设计预失真 F(·)，使得级联 G∘F 近似线性放大 L(x)=g x，同时满足预失真器输出幅度不超过给定的功放输入上限并尽可能提高预失真后送入功放的平均功率（即接近幅度上限以提高输出功率）。评价指标以 NMSE、EVM、ACPR 为准。为工程可实现性与数值稳定性起见，优先采用线性参数化模型（记忆多项式/广义记忆多项式 GMP 与正交化基），利用最小二乘与带正则化的最小二乘（Ridge/RLS）求解参数，逆映射采用间接学习架构（ILA）与受约束最小二乘或交替迭代法近似求解。下文先给出假设与符号定义，再给出模型形式、预失真器设计的数学表述与求解策略、数值实现与参数选择建议、适应性与验证方法以及拓展方向。\n\n一、基本假设与符号\n假定输入/输出为基带复信号的离散采样序列：x(n)（原始发送基带信号），z(n)（未经预失真而由功放输出），y(n)（预失真器输出，作为功放输入）。采样点数 N 足够代表工作包络与相位分布。功放映射记作 z(n)=G[x(·)]，在无记忆情况下 G 仅依赖当前样点；在有记忆情况下允许依赖于过去 M 个样点。假设观测值包含测量噪声且分布近似零均值，且功放在所考察幅值范围内可被有限阶、有限记忆的线性参数模型近似。定义幅度上限 A_max 为功放允许的最大输入幅度（由数据观察得出如 ~1.0553）；目标线性增益为 g>1（可优化求取）。记 NMSE、EVM、ACPR 如问题描述公式 (8)、(9)、(10)。\n\n二、功放行为模型（辨识模型）\n无记忆情形：采用复值“幅度加项”基的多项式表达以提高数值稳定性及对 AM-AM/AM-PM 的捕捉能力。形式可选两种等价结构之一：\n(1) 复系数多项式： z(n)=∑_{k=1}^K h_k x(n)^k ，但此形式在复信号上存在线性相关性和数值病态。\n(2) 和记忆多项式的无记忆特例（通常更稳健）： z(n)=∑_{k=1}^K h_k x(n) |x(n)|^{k-1} 。该结构明确分离相位保持项 x(n) 与幅度非线性 |x|^{k-1}，便于解释 AM-AM/AM-PM（h_k 为复系数含相移）。\n为改善条件数与减少参数相关性，对基函数做正交化处理，使用 Gram–Schmidt 或采用正交多项式（如正交拉盖尔或Chebyshev在幅度变量上的离散正交化），得到一组正交基 {φ_j(x)}，写 z(n)=∑ θ_j φ_j(x(n))，用 θ 向量代表待估参数。\n\n有记忆情形：采用广义记忆多项式（GMP）/记忆多项式模型表述（既是工程上常用且计算可行的折衷）：\nz(n)=∑_{k=1}^K ∑_{m=0}^M h_{k,m} x(n-m) |x(n-m)|^{k-1} .\n必要时加交叉时延项与滞后交互项（例如交叉项 x(n-m)|x(n-m′)|^{p}）以增强拟合能力，但每增加一类项参数数目显著增加，需要正则化或稀疏选择（LASSO/OMP）。为数值稳定和可解释性，同样建议对所有基函数做列正交化并标准化。\n\n参数估计：将上述模型写成线性参数形式 z = Φ h + ε，其中每一列为一个基函数在 N 个样本处的取值，h 为参数向量。用常规最小二乘解 ĥ = (Φ^H Φ + λ I)^{-1} Φ^H z，其中 λ 为岭回归正则因子以防止病态与过拟合；λ 可通过交叉验证或广义交叉验证确定。对有记忆模型参数规模 P=K*(M+1)（或更大）应确保 N ≫ P，否则需减少阶数/记忆或引入稀疏正则化。若采用在线自适应，使用 RLS（递归最小二乘）或带遗忘因子的 RLS 以跟踪漂移。估计完成后用 NMSE 评估模型拟合质量。\n\n三、预失真器设计（F(·) 的构造与优化）\n总体目标用数学表述为最小化误差 E = ∑_{n=1}^N |G(F(x(n))) - g x(n)|^2，约束为 |F(x(n))| ≤ A_max ∀n（幅度上限），并且在同等 NMSE 约束下尽可能使平均功率 P_y = (1/N)∑ |F(x(n))|^2 最大化或尽可能使 g 最大（两者等价到尺度与饱和限制的差异）。该问题是非线性且一般非凸（因为 G 非线性、F 参数非线性复合），但采用以下工程可实现的数值策略。\n\n参数化预失真器：为易实现，设 F(·) 也用记忆多项式或广义记忆多项式形式（与功放模型同类结构，有利于直接用线性回归求参数）：\ny(n)=F(x)(n)=∑_{p=1}^P ∑_{q=0}^Q a_{p,q} x(n-q) |x(n-q)|^{p-1} .\n参数 a 可为复值。P、Q 不宜过大以保证实现复杂度可控。\n\n求解方法一（间接学习架构，工程首选）：先在数据上拟合一个“后逆”模型 H such that H(z) ≈ x。即用数据对 (z(n), x(n)) 训练一个模型 x̂(n)=H(z(n))，模型结构可与 F 相同使参数向量 b 可线性求解。训练完成后将 H 的参数直接复制为前置预失真器 F 的初值（ILA 常用理由：G∘H ≈ I 在训练点上意味着 H 接近 G^{-1}，置换为前置器在无限数据和理想条件下可行）。随后对 F 的输出加入幅度投影：若对某些 x(n) 计算出的 y(n) 超越 A_max，则将其按比例缩放到 A_max（或使用软限制函数进行平滑）。为提高平均功率，允许在不违反幅度约束的前提下对 y(n) 做整体幅度放大 α：用 line-search 找到最大 α 使得 NMSE(G(α·H(x)), g x) ≤ ε（或尽量小），并对 α·H(x) 投影到幅度上界。该方法简单、数值稳定且在工程中被广泛采用。\n\n求解方法二（直接约束最小二乘 / 交替最小化）：直接最小化 J(a,g) = ∑ |G(F_a(x(n))) - g x(n)|^2 - μ ∑ |F_a(x(n))|^2  s.t. |F_a(x(n))| ≤ A_max. 其中引入负项 μ≥0 将功率最大化转为目标的一部分（将原始多目标转为单目标）。该 J 对 a 非线性，此时可用交替最小化：固定 a 求 g 的闭式最小二乘解；固定 g 用高斯-牛顿或Levenberg–Marquardt 求解 a（依据模型的Jacobian，由样本构成的非线性最小二乘），在每一步对 y(n) 做幅度投影以保证约束。为了避免陷入局部极值，在高斯-牛顿中加正则化并用 ILA 解作为初值。若使用此法，建议在每次迭代将目标中功率项用拉格朗日乘子形式并调整 μ 以实现期望的功率/误差折中。为将约束处理为凸形式，可在 G 已辨识的线性参数化近似下对小扰动线性化，得到二次约束问题（QCQP）并用凸求解器迭代逼近。\n\n求解方法三（多目标优化与第三方工具）：若希望同时把 NMSE、EVM 与 ACPR 纳入优化，可采用多目标优化框架（加权和或约束优化）。例如最小化 NMSE + β·ACPR_adjacent - γ·P_y，或最小化 NMSE subject to ACPR ≤ target, P_y ≥ target。这类问题可使用 SQP（序列二次规划）或现代凸-非凸混合求解器（如 IPOPT、SNOPT、MATLAB fmincon/CVX）实现。注意 ACPR 的表达依赖频谱估计，计算开销较大且导致目标噪声较高，通常用于离线优化而非实时更新。\n\n预失真放大倍数 g 的选择与最大值估计：理论上若存在精确逆 F=G^{-1}，可选择 g=1（或任何常数，若原始功放天然增益不为1则 g 选择为期望闭环增益）。在工程中 g 的最大可行值受输出幅度与饱和约束限制：需保证 g·x(n) 的幅值序列最大不上超过功放的最大输出幅度（或在前置器输出后的峰值不会使功放进入不可逆饱和区）。用样本估计法：对每个候选 g 检查是否存在 y(n) satisfying |y(n)|≤A_max and G(y(n)) ≈ g x(n)；用 ILA 得到 ŷ(n)≈H(z) 初始解后可直接计算 g_max ≈ argmax_g {g : |H_g(x(n))| ≤ A_max after scaling}，或更实用的方法是先用 ILA 得到前置器并做全样本幅度缩放直到满幅但不超限，从而得到实际可达到的放大倍数。\n\n四、数值实现细节与稳定性改进\n基函数正交化：Φ 矩阵列之间高度相关会导致 (Φ^H Φ) 条件数不好，建议在构造基函数后对列进行正交化（Gram–Schmidt 或使用经济 SVD）并在回代时转换参数以便数值稳定。正则化/稀疏化：使用岭回归 λ 通过交叉验证选择以降低估计方差；当参数过多时采用 L1 正则（LASSO）或先用正交匹配追踪（OMP）选出显著基项再 LS 求解以降低复杂度并利于硬件实现。在线更新：使用 RLS（带遗忘因子）或小步长 SGD 以跟踪器件特性随温度/偏置的变化；在在线更新时对参数变化设置最大步幅并检测失控（如突然参数发散）以回滚。\n\n幅度投影与软饱和：硬投影会引入位移误差与不连续性。实际可用软饱和函数（例如双曲正切或平滑的有界函数）来近似投影，或先做线性缩放使得最大值等于 A_max 再用小幅度软剪切以防止瞬态超限。\n\nEVM 与 ACPR 的计算：EVM 用样本形式估计 E[|e|^2] 与 E[|X|^2]；ACPR 用 Welch 法或带窗的周期图估计功率谱密度 s(f)，对目标信道 [f1,f2] 与邻道 [f2,f3] 做数值积分并以 dB 表示。为减少方差，建议对 PSD 使用多窗重叠平均（Welch）或多次FFT平均。\n\n五、验证策略与模型选择\n将数据分为训练/验证/测试集，训练用以估计参数，验证用于选择阶数 K、记忆 M 与正则参数 λ，测试集用于最终性能报告（NMSE、EVM、ACPR）。采用交叉验证或信息准则（AIC、BIC）来权衡模型复杂度与拟合质量。对模型敏感性进行参数扰动试验（例如改变 K、M、λ、遗忘因子）并观察指标的波动范围，以评估鲁棒性。若使用间接学习架构，评估 H 的泛化能力（在未见幅值区间上的行为）以避免在部署后引入超限。\n\n六、计算资源与实现复杂度估计\n记忆多项式模型参数数目约为 P=K*(M+1)。在 N≈1000 的样本下，保持 P ≪ N（例如 P ≤ 200）以保证估计充分。求解正规方程的复杂度主要在 (Φ^H Φ) 的构造与求逆，复杂度约 O(P^2 N + P^3)；带正则化的直接求解与 SVD 更稳定。在线 RLS 的每步复杂度 O(P^2)。对于实时 FPGA/ASIC 实现，需将 P 降到可接受范围并将复乘操作分解到实部/虚部。同时 PSD/ACPR 计算需要 FFT（N_fft log N_fft）开销，离线/周期性评估即可。\n\n七、扩展与创新点\n建议采用正交记忆多项式（对列正交化的 GMP），并结合稀疏编码（LASSO/OMP）以找到参数稀疏解，既保留拟合精度又降低实现复杂度。提出一个双阶段优化策略作为创新：先通过 ILA 快速得到近似逆并用比例放大/投影来最大化输出功率；再在离线环境用多目标优化（NMSE、ACPR、EVM、功率）细化参数以满足更严格的频谱掩码。为提高频域（ACPR）性能，建议在训练损失里加入频域正则项：例如在目标里加入 w·∑_{f∈邻道} S_y(f)（或其样本估计）或对输入引入小带通扰动并把所得 PSD 的邻频道能量作为惩罚项。最后可探索用数据驱动的深度网络作为非线性映射近似（虽然实现复杂且欠缺可解释性），并将其与小规模记忆多项式做混合（低阶多项式捕捉主要行为，神经网络补偿残差）。\n\n八、适应性与长期维护\n由于 PA 随时间漂移，建议在部署时保留定期或循环的在线校准流程：低速背景测量/训练周期中用已知训练序列或接收回环测量更新模型；对参数更新采用小步长与RLS以避免瞬态不稳。对检测到性能降级（NMSE/EVM/ACPR 超阈值）启动更激进的重训练。若数据覆盖不足，可使用多工况聚合与加权更新以兼顾各类输入统计特性。\n\n九、实验验证与指标报告\n在给定数据集上，先用无记忆/有记忆模型估计 G 并报告训练/验证 NMSE。用 ILA 得到前置器并对训练数据与独立测试数据报告 NMSE、EVM；对有记忆情形计算输入信号、未经预失真功放输出、采用预失真补偿的功放输出三类信号的 PSD（Welch）并绘图，计算并报告预/后 ACPR 分别值以验证带外抑制能力。若目标为最大化功率，在保证 NMSE≤阈值的约束下输出所能得到的最大 α 或相应的平均功率增长百分比。\n\n结论（简述性建议）：对无记忆数据首选无记忆记数多项式（x|x|^{k-1}）或其正交化版本并用最小二乘/岭回归估计；对有记忆数据采用 GMP 并用列正交加稀疏选择减小参数数目；预失真采用间接学习架构快速构造初始解，再以交替最小二乘/有限次Gauss–Newton 在含幅度投影与功率最大化目标下细化；使用 Welch FFT 估算 PSD 并计算 ACPR；在线采用 RLS/Mini-batch SGD 同步更新以跟踪漂移。在工程实现上通过基函数稀疏化、固定记忆深度与系数量化实现硬件实时化；若需更高精度可将频域约束直接纳入离线优化以改善邻频道泄露。以上方法兼顾数学可分析性、数值稳定性与工程实现性，能够在给定数据与资源下给出可验证的 NMSE/EVM/ACPR 改进并实现功率最大化的可操作方案。",
  "task_descriptions": [
    "子任务1（数据准备、探索性分析与无记忆功放行为模型辨识）的目标是从给定的无记忆型 PA 输入/输出复基带样本集中，系统地读取并清洗数据，做充分的探索性统计以确定信号幅值范围（例如识别最大允许输入幅度 A_max）、将数据划分为训练/验证/测试子集，并在此基础上建立、估计并验证一个数值稳定且工程可实现的无记忆行为模型，最终输出明确的模型形式与参数、模型条件数及在训练/验证/测试集上的 NMSE（按式(8)）和可选的 EVM（按式(9)）评价。为完成该任务，请按如下步骤操作：1) 数据输入与预处理：用 MATLAB（loadmat）或 Python（numpy, scipy.io.loadmat）读取 pa_in_out_memoryless.mat 或相应文本文件，检查并去除 NaN/异常值，计算并报告样本数 N、输入/输出幅度最大值与分布、瞬时功率统计，以确定 A_max 与数据覆盖性；2) 划分数据集：把 N≈1000 样本按建议比例（例如 70% 训练、15% 验证、15% 测试，或交叉验证方案）划分，确保验证/测试集独立于训练集用于模型选择与泛化评估；3) 模型结构选择：为无记忆情形建议优先采用“幅度分离”复值基函数形式 z(n)=∑_{k=1}^K h_k x(n)|x(n)|^{k-1}（相比直接复多项式 x^k 有更好解释 AM‑AM/AM‑PM 且条件通常更好），并说明候选阶数 K 的搜索范围（建议从 1 到 7 或依据 N 控制 P=K ≤ N/5）；4) 设计矩阵构造与数值处理：为训练样本构造设计矩阵 Φ（每列为一个基函数在所有训练样本处的取值），对列进行标准化（零均值/单位方差或范数归一化）并用 QR 分解或经济 SVD（或 Gram–Schmidt）对列正交化以改善条件数；若实现环境不支持复线性解，可将复值问题等价转换为实矩阵形式（实部/虚部堆叠）；5) 参数估计与正则化：使用带 Tikhonov 正则化的复最小二乘（岭回归）求解 ĥ=(Φ^H Φ + λI)^{-1}Φ^H z，λ 的选择通过 k‑折交叉验证或广义交叉验证（GCV）在验证集上最小化 NMSE 或利用信息准则（AIC/BIC）确定；在 Φ^H Φ 条件数过大或参数维数接近样本数时，考虑降阶或采用稀疏化方法（LASSO/OMP）先选显著基再回归；6) 模型验证与诊断：在验证/测试集上计算并报告 NMSE（按式(8)）、可选 EVM（按式(9)）、残差幅度/相位分布与自相关，以检测系统性误差或模型欠拟合/过拟合，并记录模型的条件数与有效参数数目；7) 输出与交付物：提交最终模型形式与系数向量（数值）、所选 K 与 λ、训练/验证/测试 上的 NMSE（dB）、EVM（%，如计算）、设计矩阵的条件数和简要诊断说明（是否建议降低阶数或采用稀疏化），以及完整重现实验所需的脚本/代码（MATLAB 或 Python，包含数据读取、设计矩阵构造、正交化/QR、岭回归或 sklearn 的 Ridge/Lasso 调用及交叉验证流程）。在整个过程中应保持 P ≪ N 以保证稳定估计，且所有步骤应以可复现的脚本实现（推荐工具：MATLAB 或 Python + numpy/scipy/sklearn），不在本子任务中进行任何预失真器设计或频域分析。",
    "子任务2（预失真器参数化、目标函数与求解策略）应以“给定功放辨识结果或已采得的训练样本对 {(x(n),z(n))} 以及功放可接受的最大输入幅度 A_max 为前提，构造并求解一个工程可实现的预失真器 F(·) 的参数向量”为范围与目标：具体要求用明确的、可实现的参数化形式表示 F（推荐使用与功放模型同类的记忆多项式/广义记忆多项式结构以保持线性参数形式，即 y(n)=F_a[x](n)=∑_{p=1}^P ∑_{q=0}^Q a_{p,q} x(n-q)|x(n-q)|^{p-1}，系数 a_{p,q} 为复数，P 与 Q 由实现复杂度和训练样本数量共同决定），并以满足幅度硬约束 |y(n)| ≤ A_max 为必须条件同时尽量提高平均送入功放的功率 P_y=(1/N)∑|y(n)|^2 为次要目标，在此约束下使级联误差最小化；把数学目标明确为最小化 J(a,g)=∑_{n=1}^N |G(y(n)) - g x(n)|^2（g 可为固定目标增益或作为待估标量），并可将“功率最大化”通过加入负权项 -μ P_y 或通过在满足 NMSE≤ε 的前提下对整体放大因子 α（即 y←α·y）做线搜索来实现。关于求解策略，提供两条工程可行路径：间接学习架构（ILA）——在后向方向用相同结构线性回归拟合 H 使 H(z) ≈ x（可用岭回归/Ridge 或 LASSO 做正则化并对复值问题按实虚部进行堆叠），将 H 的参数直接作为前置预失真器的初值，随后对得到的 y(n) 做幅度投影（硬投影或软饱和如 tanh 近似）并通过一维线搜索或二分法寻找最大缩放因子 α 满足幅度约束且误差在容许范围内；直接约束最小化——以 J(a,g)（并带有幅度约束 |F_a(x(n))|≤A_max）为原问题，采用交替优化：固定 a 解 g（闭式最小二乘），固定 g 用非线性最小二乘求 a（采用 Gauss–Newton 或 Levenberg–Marquardt，或用带约束的 SQP/序列二次规划求解器如 MATLAB fmincon / Python scipy.optimize.minimize with trust-constr），每次迭代后对 y 做投影以维持可行性，并用 ILA 解作为初始化以提升收敛性和避免陷入差的局部最优；数值稳定性措施包括对设计矩阵列进行标准化/QR 正交化或 SVD，使用 Tikhonov 正则化（岭）或稀疏化（L1）以控制参数维度并通过 k 折交叉验证选择超参数 λ 与模型阶数 (P,Q)，复值参数的求解采用将复方程拆为实部/虚部等价实矩阵方法或直接支持复数的数值库；幅度约束可用硬投影（逐样本裁剪并比例缩放）或更平滑的软饱和函数来减少不连续性对收敛的影响；为实现功率最大化，可在 ILA 初值上做全样本整体幅度放大并在每步检测 NMSE/EVM，并在需要时将功率项以拉格朗日乘子方式并入目标以做权衡（调整 μ）。建议使用的工具与算法包括 MATLAB（lsqnonlin、fmincon、ridge、lsqr）、Python（numpy/scipy.linalg、scipy.optimize.least_squares、cvxpy用于凸子问题、sklearn 的 Ridge/Lasso）以及若需在线更新则采用 RLS/带遗忘因子的递归最小二乘或小步长 SGD；最终输出为预失真参数向量 a、（若估计）标量 g 或放大因子 α、满足幅度约束的预失真输出序列 y(n) 的生成函数与实现细节（复杂度 P=(P·(Q+1))、需要的乘加运算数），并应提供用于超参数选择（P,Q,λ,μ）与收敛判据（NMSE/EVM 阈值、最大迭代次数）的明确定义，以便独立复现与工程实现。",
    "子任务3（数值稳定性、正则化、在线自适应与实现复杂度估计；频域分析与评价方法）的目标是提供一套可操作的数值处理、正则化与在线更新策略以及频域评估流程，确保线性参数化设计矩阵 Φ 在求解与部署时数值稳定且适合实时实现，并为 NMSE、EVM 与 ACPR 的计算给出可重复的参数化方法与实现复杂度估算。具体要求与步骤如下：首先输入为已构造的设计矩阵 Φ（含所有训练样本对对应的基函数列，复数情形可按实/虚部堆叠成实矩阵）与输出向量 z；在构造后应立即计算 Φ^H Φ 的条件数并对列归一化（按列范数或零均值单位方差），若条件数较大则对 Φ 进行列正交化（推荐使用经济 QR 或 SVD，以得到正交基 Q 与上三角 R，保存变换以便参数回转），并将最终求解转化为在正交基上的最小二乘问题以改善数值稳定性。其次在求解参数时必须采用正则化：对线性问题使用岭回归（Tikhonov）形式 ĥ=(Φ^H Φ+λI)^{-1}Φ^H z，λ 的选择通过 k 折交叉验证或广义交叉验证（GCV）自动化搜索；当参数维数 P 接近样本数或存在强相关列时优先采用 SVD 截断或岭回归；若需稀疏化以降低实现复杂度，可先用正交匹配追踪（OMP）或 LASSO（通过 sklearn/ CVXPy）选择显著基项再做精炼最小二乘。第三，给出数值与复杂度估算：构造 Φ^H Φ 的成本约为 O(P^2 N)，求逆或 SVD 约为 O(P^3)，因此在实时/硬件场景应控制 P（推荐 P ≤ 200，且 N ≫ P）；在线递归算法选择带遗忘因子的 RLS（每步复杂度 O(P^2)）或小步长 SGD（每步 O(P)），并建议 RLS 遗忘因子在 0.98–0.999 之间、初始协方差用 δI（δ≈10^−3…10^−6）正则化以避免发散；在线更新需实现步长/增益上限、参数范数阈值与回滚策略（当 NMSE/EVM 突变或参数范数超阈值时回退到上一次稳态参数），并定期（或触发式）以批量最小二乘重校准以消除累积误差。第四，为避免因幅度投影引起的不连续性，建议采用平滑裁剪（例如饱和函数 tanh 或平滑分段线性）或先做全样本线性缩放再局部软裁剪，且任何投影应在训练与在线阶段一致实现以保持一致性。第五，频域评估的实现细节：采用 Welch 方法估计 PSD（选择窗函数如 Hanning、重叠 50%–75%、Nfft 可取为 2^nextpow2(样本段长度)），对给定采样率 Fs 和信道带宽 B（例如题目示例 Fs 已知、B=20 MHz）将频率区间映射到 PSD 索引，按 ACPR 定义数值积分邻频道与主频道能量并用 10·log10 表示；EVM 以样本形式计算 EVM = sqrt(mean(|e|^2))/sqrt(mean(|X|^2))·100%，NMSE 用题目公式实现并在报告中以 dB 给出；为降低 PSD 与 ACPR 的方差，建议多窗口/多次平均或延长 Nfft。最后给出实现工具与验证建议：线下/离线计算使用 MATLAB（qr、svd、ridge、lsqnonlin）、Python（numpy, scipy.linalg, sklearn.Ridge/Lasso, scipy.signal.welch, FFTW）与 CVXPy（凸子问题），在线实现需考虑将复乘分解为实运算、参数定点化/量化误差评估与乘加计数估算（给出估算公式：每个基项一复乘约为 4 实乘+2 实加，每个样点总复乘约为 P），并在交付文档中列出 P、每样点运算量、内存（参数数目）与推荐硬件实现上限以便工程权衡与部署决策。",
    "在独立测试与部署验收阶段，子任务 4 的目标是以系统化、可重复的流程验证所设计预失真器在时域与频域的性能（NMSE、EVM、ACPR）、量化其对平均输出功率与可实现放大倍数的提升，并给出明确的迭代改进规则与在线部署/监控策略；为此该子任务需接受为输入的三类时域序列（原始输入 x(n)、未经预失真时的 PA 输出 z(n)、经预失真后 PA 的输出 z_pd(n)）及采样率 Fs 和信道带宽 B，并按以下单一、连贯流程执行： (1) 离线性能评估——在独立测试集上计算并报告 NMSE（按式(8)、以 dB 表示）、EVM（按式(9)、以%表示）与 ACPR（利用 Welch 方法估计 PSD，推荐参数：Hann 窗、50% 重叠、段长可取 1024 或根据样本量取下一 2 的幂、Nfft 选 4096 或更高以提高频率分辨率），明确主信道和邻道的频率索引映射（以 B=20 MHz 为例映射到 Fs 的对应频带），并绘制三类信号的 PSD 比较图和误差矢量图/星座图； (2) 功率与放大因子检验——通过对预失真器输出做逐步线性缩放（线搜索或二分法）直至触及幅度上限 A_max 或某项性能阈值被违反，确定实际可安全实现的最大放大倍数 g_max 及对应的平均送入功放功率增益，并记录导致约束触发的具体指标（峰值超限或 NMSE/EVM/ACPR 超阈）； (3) 判定准则与迭代改进策略——按事先定义的阈值（建议示例：NMSE 退化或未改善 ≥1 dB、EVM 超过目标如 3–5% 视调制格式而定、ACPR 超过许可掩码）判定是否需要改进；若需改进，按优先级迭代：先调整正则化强度与基函数稀疏化（λ、LASSO/OMP 篩选），再微调模型阶数/记忆深度（K、M），随后在离线用带频域惩罚项或多目标优化（将邻频道能量作为惩罚或约束）精化参数；每次改进后重复 (1)–(2) 验证性能并记录版本化参数与度量； (4) 部署与在线监控机制——部署时保留两套参数集（当前运行集与 last‑known‑good），在现场以滑动窗口方式（建议窗口长度 N_window 例如 2048 样本或代表约 10–100 ms 的时长，依系统而定）周期性计算 NMSE、EVM 与快速 ACPR 估算，当任一指标越限触发等级化响应：轻微越限触发 RLS/小步长自适应更新（遗忘因子 0.98–0.999、参数变化幅度限制与步长上限），严重越限回滚到 last‑known‑good 并上报；所有参数更新须满足最小样本量与渐进验证（更新后需在验证窗内恢复或改善指标），并对每次更新记录诊断数据以便离线回溯； (5) 安全与实现约束——在任何在线或离线步骤均强制执行样本级幅度投影/软饱和以保证 |y(n)| ≤ A_max，限制每次参数更新的范数增量以防参数发散，并评估计算与记忆成本（每样本复基项 P 导致约 P 复乘的开销，部署时须保证实时硬件/固件能承受）； (6) 报告与验收条目——最终交付一份版本化的验证报告包含：测试机上三信号的 NMSE/EVM/ACPR 数值表、PSD 与星座图、确定的 g_max 与平均功率提升百分比、触发改进的阈值与最近一次改进记录、在线监控策略细则（监控间隔、阈值、回滚策略、RLS 超参）及实现资源估算（参数个数 P、每样本运算量、建议窗口/FFT 参数和所需内存），并提供可执行的 MATLAB/Python 验证脚本（包含 Welch/FFT、NMSE/EVM/ACPR 计算、线搜索放大测试及自动化迭代流程）以便独立复现与工程接入。"
  ]
}