{
  "tasks": [],
  "problem_str": "问题背景：\n2016年全国研究生数学建模竞赛B题\n\n具有遗传性疾病和性状的遗传位点分析\n\n人体的每条染色体携带一个DNA分子，人的遗传密码由人体中的DNA携带。DNA是由分别带有A,T,C,G四种碱基的脱氧核苷酸链接组成的双螺旋长链分子。在这条双螺旋的长链中，共有约30亿个碱基对，而基因则是DNA长链中有遗传效应的一些片段。在组成DNA的数量浩瀚的碱基对（或对应的脱氧核苷酸）中，有一些特定位置的单个核苷酸经常发生变异引起DNA的多态性，我们称之为位点。染色体、基因和位点的结构关系见图1.\n\n在DNA长链中，位点个数约为碱基对个数的1/1000。由于位点在DNA长链中出现频繁，多态性丰富，近年来成为人们研究DNA遗传信息的重要载体，被称为人类研究遗传学的第三类遗传标记。\n\n大量研究表明，人体的许多表型性状差异以及对药物和疾病的易感性等都可能与某些位点相关联，或和包含有多个位点的基因相关联。因此，定位与性状或疾病相关联的位点在染色体或基因中的位置，能帮助研究人员了解性状和一些疾病的遗传机理，也能使人们对致病位点加以干预，防止一些遗传病的发生。\n\n近年来，研究人员大都采用全基因组的方法来确定致病位点或致病基因，具体做法是：招募大量志愿者（样本），包括具有某种遗传病的人和健康的人，通常用1表示病人，0表示健康者。 对每个样本，采用碱基(A,T,C,G)的编码方式来获取每个位点的信息(因为染色体具有双螺旋结构，所以用两个碱基的组合表示一个位点的信息）；如表1中，在位点rs100015位置，不同样本的编码都是T和C的组合，有三种不同编码方式TT,TC和CC。类似地其他的位点虽然碱基的组合不同，但也只有三种不同编码。研究人员可以通过对样本的健康状况和位点编码的对比分析来确定致病位点，从而发现遗传病或性状的遗传机理。\\begin{table}\n\\centering\n\\begin{tabular}{|c|c|c|c|c|c|}\n\\hline\n样本编号 & 样本健康状况 & \\multicolumn{4}{c|}{染色体片段位点名称和位点等位基因信息} \\\\\n\\cline{3-6}\n & & rs100015 & rs56341 & & rs21132 \\\\\n\\hline\n1 & 1 & TT & CA & \\dots & GT \\\\\n\\hline\n2 & 0 & TT & CC & \\dots & GG \\\\\n\\hline\n3 & 1 & TC & CC & \\dots & GG \\\\\n\\hline\n4 & 1 & TC & CA & \\dots & GG \\\\\n\\hline\n5 & 0 & CC & CC & \\dots & GG \\\\\n\\hline\n6 & 0 & TT & CC & \\dots & GG \\\\\n\\hline\n\\end{tabular}\n\\caption{在对每个样本采集完全基因组信息后，一般有以下的数据信息（以6个样本为例，其中3个病人，3个健康者）。}\n\\end{table}\n\n问题要求：\n本题目针对某种遗传疾病(简称疾病A)提供1000个样本的信息，这些信息包括这1000个样本的疾病信息、样本的9445个位点编码信息，以及包含这些位点的基因信息。这些信息包含在附录中的2个文件(phenotype.txt , genotype.dat)和1个文件夹gene_info(包含300个文件)中。\n\nphenotype.txt文件中包含了样本具有遗传疾病A的信息，即一列0和1组成的数据，其中共有500个0，500个1，表示我们现在共有1000个样本，其中500个0就是500个没患有疾病A的人，500个1就是有500个患有遗传病A的人。如同表一中的第二列。\n\ngenotype.dat文件中包含了上述1000个样本在某条染色体片段上所有的位点信息。该文件总共有1001行，9445列。如同上表1中第三列到第六列的编码信息。具体来说，第一行表示9445个位点的名称，都是以字母rs开头的；接下来，有1000行，每一行表示一个样本在该条染色体片段上所有位点(9445个位点)的编码信息。例如，该文件中第2行，就表示1号样本在该条染色体片段上9445个位点的编码信息。\n\n文件夹gene_info中包含了300个dat文件，表示300个基因的信息；每个dat文件中包含了若干个位点的名称，表示该基因包含的位点信息，事实上，可以把基因理解为若干个位点组成的集合。注意到在genotype.dat文件中已包含所有位点的编码信息，所以我们可以得到每一个基因所包含位点的编码信息。例如gene_1.dat，表示基因gene_1包含了rs3094315, rs3131972,..., rs4040617，共7个位点。\n\n另外，人体的许多遗传疾病和性状是有关联的，如高血压，心脏病、脂肪肝和酒精依赖等。科研人员往往把相关的性状或疾病放在一起研究，这样能提高发现致病位点或基因的能力；\n\n附录中的multi_phenos.txt文件中提供了上述1000个样本的10种相关性状的信息。文件中的每一列表示一个性状，每一行对应一个样本。文件中的0和1信息同phenotype.txt文件。\n\n所有这些文件都可以利用Notepad++软件打开。装好notepad++后，当需要打开某个数据文件时，先点击该文件，然后点击右键，屏幕出现菜单，其中一栏是“edit with notepad++”,点击这一栏即可。许多软件也可以将文件中的数据直接读入内存。（如matlab可用importdata函数读入）\n\n本题包含以下问题：\n\n问题一、请用适当的方法，把genotype.dat中每个位点的碱基(A,T,C,G) 编码方式转化成数值编码方式，便于进行数据分析。\n\n问题二、根据附录中1000个样本在某条有可能致病的染色体片段上的9445个位点的编码信息(见genotype.dat)和样本患有遗传疾病A的信息（见phenotype.txt文件）。设计或采用一个方法，找出某种疾病最有可能的一个或几个致病位点，并给出相关的理论依据。\n\n问题三、同上题中的样本患有遗传疾病A的信息（phenotype.txt文件）。现有300个基因，每个基因所包含的位点名称见文件夹gene_info中的300个dat文件，每个dat文件列出了对应基因所包含的位点(位点信息见文件genotype.dat)。由于可以把基因理解为若干个位点组成的集合，遗传疾病与基因的关联性可以由基因中包含的位点的全集或其子集合表现出来请找出与疾病最有可能相关的一个或几个基因，并说明理由。\n\n问题四、在问题二中，已知9445个位点，其编码信息见genotype.dat文件。在实际的研究中，科研人员往往把相关的性状或疾病看成一个整体，然后来探寻与它们相关的位点或基因。试根据multi_phenos.txt文件给出的1000个样本的10个相关联性状的信息及其9445个位点的编码信息(见genotype.dat)，找出与multi_phenos.txt中10个性状有关联的位点。\n\n对你得到的结果都应该进行适当的统计分析和检验，从而从理论上说明你所发现的致病位点和基因的合理性。\n\n关键词：遗传统计学， 全基因组关联性分析(GWAS)，位点(SNPs)\nAddendum: \n关键词：遗传统计学，全基因组关联性分析 (GWAS)，位点 (SNPs)\nDataset Path:\n['gene_info', 'genotype.dat', 'multi_phenos.txt', 'phenotype.txt']\n\nData Description:\n该数据集包含针对一条可能致病染色体片段的多源遗传信息与表型标签，适用于寻找与遗传疾病A相关的致病位点与基因：共有1000个样本的基因型与表型信息，基因型数据以纯文本形式存储在genotype.dat中，覆盖9445个唯一位点（位点使用如rs3094315之类的标识符表示），位点信息与存放在gene_info目录下的300个基因对应的dat文件一一匹配，每个基因的dat文件列出该基因包含的位点名称（即与genotype.dat中的位点对应的子集），此外还有multi_phenos.txt提供的二进制（0/1）位点特征矩阵用于表达多个遗传特征的存在/缺失，最终的疾病表型由phenotype.txt给出，含1000个样本的二元标签（0=未患病，1=患病）；文件均为文本格式，数据可用于单位点关联分析、基因层面负荷检验、机器学习特征选择与分类建模等下游分析以识别候选致病变异与基因。",
  "problem": {
    "background": "2016年全国研究生数学建模竞赛B题\n\n具有遗传性疾病和性状的遗传位点分析\n\n人体的每条染色体携带一个DNA分子，人的遗传密码由人体中的DNA携带。DNA是由分别带有A,T,C,G四种碱基的脱氧核苷酸链接组成的双螺旋长链分子。在这条双螺旋的长链中，共有约30亿个碱基对，而基因则是DNA长链中有遗传效应的一些片段。在组成DNA的数量浩瀚的碱基对（或对应的脱氧核苷酸）中，有一些特定位置的单个核苷酸经常发生变异引起DNA的多态性，我们称之为位点。染色体、基因和位点的结构关系见图1.\n\n在DNA长链中，位点个数约为碱基对个数的1/1000。由于位点在DNA长链中出现频繁，多态性丰富，近年来成为人们研究DNA遗传信息的重要载体，被称为人类研究遗传学的第三类遗传标记。\n\n大量研究表明，人体的许多表型性状差异以及对药物和疾病的易感性等都可能与某些位点相关联，或和包含有多个位点的基因相关联。因此，定位与性状或疾病相关联的位点在染色体或基因中的位置，能帮助研究人员了解性状和一些疾病的遗传机理，也能使人们对致病位点加以干预，防止一些遗传病的发生。\n\n近年来，研究人员大都采用全基因组的方法来确定致病位点或致病基因，具体做法是：招募大量志愿者（样本），包括具有某种遗传病的人和健康的人，通常用1表示病人，0表示健康者。 对每个样本，采用碱基(A,T,C,G)的编码方式来获取每个位点的信息(因为染色体具有双螺旋结构，所以用两个碱基的组合表示一个位点的信息）；如表1中，在位点rs100015位置，不同样本的编码都是T和C的组合，有三种不同编码方式TT,TC和CC。类似地其他的位点虽然碱基的组合不同，但也只有三种不同编码。研究人员可以通过对样本的健康状况和位点编码的对比分析来确定致病位点，从而发现遗传病或性状的遗传机理。\\begin{table}\n\\centering\n\\begin{tabular}{|c|c|c|c|c|c|}\n\\hline\n样本编号 & 样本健康状况 & \\multicolumn{4}{c|}{染色体片段位点名称和位点等位基因信息} \\\\\n\\cline{3-6}\n & & rs100015 & rs56341 & & rs21132 \\\\\n\\hline\n1 & 1 & TT & CA & \\dots & GT \\\\\n\\hline\n2 & 0 & TT & CC & \\dots & GG \\\\\n\\hline\n3 & 1 & TC & CC & \\dots & GG \\\\\n\\hline\n4 & 1 & TC & CA & \\dots & GG \\\\\n\\hline\n5 & 0 & CC & CC & \\dots & GG \\\\\n\\hline\n6 & 0 & TT & CC & \\dots & GG \\\\\n\\hline\n\\end{tabular}\n\\caption{在对每个样本采集完全基因组信息后，一般有以下的数据信息（以6个样本为例，其中3个病人，3个健康者）。}\n\\end{table}",
    "problem_requirement": "本题目针对某种遗传疾病(简称疾病A)提供1000个样本的信息，这些信息包括这1000个样本的疾病信息、样本的9445个位点编码信息，以及包含这些位点的基因信息。这些信息包含在附录中的2个文件(phenotype.txt , genotype.dat)和1个文件夹gene_info(包含300个文件)中。\n\nphenotype.txt文件中包含了样本具有遗传疾病A的信息，即一列0和1组成的数据，其中共有500个0，500个1，表示我们现在共有1000个样本，其中500个0就是500个没患有疾病A的人，500个1就是有500个患有遗传病A的人。如同表一中的第二列。\n\ngenotype.dat文件中包含了上述1000个样本在某条染色体片段上所有的位点信息。该文件总共有1001行，9445列。如同上表1中第三列到第六列的编码信息。具体来说，第一行表示9445个位点的名称，都是以字母rs开头的；接下来，有1000行，每一行表示一个样本在该条染色体片段上所有位点(9445个位点)的编码信息。例如，该文件中第2行，就表示1号样本在该条染色体片段上9445个位点的编码信息。\n\n文件夹gene_info中包含了300个dat文件，表示300个基因的信息；每个dat文件中包含了若干个位点的名称，表示该基因包含的位点信息，事实上，可以把基因理解为若干个位点组成的集合。注意到在genotype.dat文件中已包含所有位点的编码信息，所以我们可以得到每一个基因所包含位点的编码信息。例如gene_1.dat，表示基因gene_1包含了rs3094315, rs3131972,..., rs4040617，共7个位点。\n\n另外，人体的许多遗传疾病和性状是有关联的，如高血压，心脏病、脂肪肝和酒精依赖等。科研人员往往把相关的性状或疾病放在一起研究，这样能提高发现致病位点或基因的能力；\n\n附录中的multi_phenos.txt文件中提供了上述1000个样本的10种相关性状的信息。文件中的每一列表示一个性状，每一行对应一个样本。文件中的0和1信息同phenotype.txt文件。\n\n所有这些文件都可以利用Notepad++软件打开。装好notepad++后，当需要打开某个数据文件时，先点击该文件，然后点击右键，屏幕出现菜单，其中一栏是“edit with notepad++”,点击这一栏即可。许多软件也可以将文件中的数据直接读入内存。（如matlab可用importdata函数读入）\n\n本题包含以下问题：\n\n问题一、请用适当的方法，把genotype.dat中每个位点的碱基(A,T,C,G) 编码方式转化成数值编码方式，便于进行数据分析。\n\n问题二、根据附录中1000个样本在某条有可能致病的染色体片段上的9445个位点的编码信息(见genotype.dat)和样本患有遗传疾病A的信息（见phenotype.txt文件）。设计或采用一个方法，找出某种疾病最有可能的一个或几个致病位点，并给出相关的理论依据。\n\n问题三、同上题中的样本患有遗传疾病A的信息（phenotype.txt文件）。现有300个基因，每个基因所包含的位点名称见文件夹gene_info中的300个dat文件，每个dat文件列出了对应基因所包含的位点(位点信息见文件genotype.dat)。由于可以把基因理解为若干个位点组成的集合，遗传疾病与基因的关联性可以由基因中包含的位点的全集或其子集合表现出来请找出与疾病最有可能相关的一个或几个基因，并说明理由。\n\n问题四、在问题二中，已知9445个位点，其编码信息见genotype.dat文件。在实际的研究中，科研人员往往把相关的性状或疾病看成一个整体，然后来探寻与它们相关的位点或基因。试根据multi_phenos.txt文件给出的1000个样本的10个相关联性状的信息及其9445个位点的编码信息(见genotype.dat)，找出与multi_phenos.txt中10个性状有关联的位点。\n\n对你得到的结果都应该进行适当的统计分析和检验，从而从理论上说明你所发现的致病位点和基因的合理性。\n\n关键词：遗传统计学， 全基因组关联性分析(GWAS)，位点(SNPs)",
    "dataset_path": [
      "gene_info",
      "genotype.dat",
      "multi_phenos.txt",
      "phenotype.txt"
    ],
    "dataset_description": {
      "gene_info": "gene_info包含1000个样本在某条可能致病的染色体片段上的9445个位点的基因型信息（genotype.dat）和样本是否患有遗传疾病A的信息（phenotype.txt）。此外，数据集中还包含了300个基因的位点信息，每个基因的位点名称存储在gene_info文件夹下的300个dat文件中。每个dat文件列出了对应基因所包含的位点，这些位点信息与genotype.dat文件中的位点信息相对应。数据集旨在通过分析基因型数据和疾病表型数据，找出与遗传疾病A相关的致病位点和基因。",
      "genotype": "genotype.dat包含多个样本在某条可能致病的染色体片段上的9445个位点的基因型信息。每个位点由其独特的标识符（如rs3094315）表示，基因型信息以纯文本形式列出。",
      "multi_phenos": "multi_phenos.txt包含多个样本在多个遗传位点上的二进制编码信息，每个样本在每个位点上的值为0或1，表示某种遗传特征的存在与否。",
      "phenotype": "phenotype.txt包含1000个样本的遗传疾病A的患病状态信息，其中0表示未患病，1表示患病。"
    },
    "variable_description": [
      {},
      {},
      {},
      {}
    ],
    "addendum": "关键词：遗传统计学，全基因组关联性分析 (GWAS)，位点 (SNPs)",
    "data_summary": "Dataset Path:\n['gene_info', 'genotype.dat', 'multi_phenos.txt', 'phenotype.txt']\n\nData Description:\n该数据集包含针对一条可能致病染色体片段的多源遗传信息与表型标签，适用于寻找与遗传疾病A相关的致病位点与基因：共有1000个样本的基因型与表型信息，基因型数据以纯文本形式存储在genotype.dat中，覆盖9445个唯一位点（位点使用如rs3094315之类的标识符表示），位点信息与存放在gene_info目录下的300个基因对应的dat文件一一匹配，每个基因的dat文件列出该基因包含的位点名称（即与genotype.dat中的位点对应的子集），此外还有multi_phenos.txt提供的二进制（0/1）位点特征矩阵用于表达多个遗传特征的存在/缺失，最终的疾病表型由phenotype.txt给出，含1000个样本的二元标签（0=未患病，1=患病）；文件均为文本格式，数据可用于单位点关联分析、基因层面负荷检验、机器学习特征选择与分类建模等下游分析以识别候选致病变异与基因。",
    "data_description": {
      "gene_info": "gene_info包含1000个样本在某条可能致病的染色体片段上的9445个位点的基因型信息（genotype.dat）和样本是否患有遗传疾病A的信息（phenotype.txt）。此外，数据集中还包含了300个基因的位点信息，每个基因的位点名称存储在gene_info文件夹下的300个dat文件中。每个dat文件列出了对应基因所包含的位点，这些位点信息与genotype.dat文件中的位点信息相对应。数据集旨在通过分析基因型数据和疾病表型数据，找出与遗传疾病A相关的致病位点和基因。",
      "genotype": "genotype.dat包含多个样本在某条可能致病的染色体片段上的9445个位点的基因型信息。每个位点由其独特的标识符（如rs3094315）表示，基因型信息以纯文本形式列出。",
      "multi_phenos": "multi_phenos.txt包含多个样本在多个遗传位点上的二进制编码信息，每个样本在每个位点上的值为0或1，表示某种遗传特征的存在与否。",
      "phenotype": "phenotype.txt包含1000个样本的遗传疾病A的患病状态信息，其中0表示未患病，1表示患病。"
    },
    "problem_str": "问题背景：\n2016年全国研究生数学建模竞赛B题\n\n具有遗传性疾病和性状的遗传位点分析\n\n人体的每条染色体携带一个DNA分子，人的遗传密码由人体中的DNA携带。DNA是由分别带有A,T,C,G四种碱基的脱氧核苷酸链接组成的双螺旋长链分子。在这条双螺旋的长链中，共有约30亿个碱基对，而基因则是DNA长链中有遗传效应的一些片段。在组成DNA的数量浩瀚的碱基对（或对应的脱氧核苷酸）中，有一些特定位置的单个核苷酸经常发生变异引起DNA的多态性，我们称之为位点。染色体、基因和位点的结构关系见图1.\n\n在DNA长链中，位点个数约为碱基对个数的1/1000。由于位点在DNA长链中出现频繁，多态性丰富，近年来成为人们研究DNA遗传信息的重要载体，被称为人类研究遗传学的第三类遗传标记。\n\n大量研究表明，人体的许多表型性状差异以及对药物和疾病的易感性等都可能与某些位点相关联，或和包含有多个位点的基因相关联。因此，定位与性状或疾病相关联的位点在染色体或基因中的位置，能帮助研究人员了解性状和一些疾病的遗传机理，也能使人们对致病位点加以干预，防止一些遗传病的发生。\n\n近年来，研究人员大都采用全基因组的方法来确定致病位点或致病基因，具体做法是：招募大量志愿者（样本），包括具有某种遗传病的人和健康的人，通常用1表示病人，0表示健康者。 对每个样本，采用碱基(A,T,C,G)的编码方式来获取每个位点的信息(因为染色体具有双螺旋结构，所以用两个碱基的组合表示一个位点的信息）；如表1中，在位点rs100015位置，不同样本的编码都是T和C的组合，有三种不同编码方式TT,TC和CC。类似地其他的位点虽然碱基的组合不同，但也只有三种不同编码。研究人员可以通过对样本的健康状况和位点编码的对比分析来确定致病位点，从而发现遗传病或性状的遗传机理。\\begin{table}\n\\centering\n\\begin{tabular}{|c|c|c|c|c|c|}\n\\hline\n样本编号 & 样本健康状况 & \\multicolumn{4}{c|}{染色体片段位点名称和位点等位基因信息} \\\\\n\\cline{3-6}\n & & rs100015 & rs56341 & & rs21132 \\\\\n\\hline\n1 & 1 & TT & CA & \\dots & GT \\\\\n\\hline\n2 & 0 & TT & CC & \\dots & GG \\\\\n\\hline\n3 & 1 & TC & CC & \\dots & GG \\\\\n\\hline\n4 & 1 & TC & CA & \\dots & GG \\\\\n\\hline\n5 & 0 & CC & CC & \\dots & GG \\\\\n\\hline\n6 & 0 & TT & CC & \\dots & GG \\\\\n\\hline\n\\end{tabular}\n\\caption{在对每个样本采集完全基因组信息后，一般有以下的数据信息（以6个样本为例，其中3个病人，3个健康者）。}\n\\end{table}\n\n问题要求：\n本题目针对某种遗传疾病(简称疾病A)提供1000个样本的信息，这些信息包括这1000个样本的疾病信息、样本的9445个位点编码信息，以及包含这些位点的基因信息。这些信息包含在附录中的2个文件(phenotype.txt , genotype.dat)和1个文件夹gene_info(包含300个文件)中。\n\nphenotype.txt文件中包含了样本具有遗传疾病A的信息，即一列0和1组成的数据，其中共有500个0，500个1，表示我们现在共有1000个样本，其中500个0就是500个没患有疾病A的人，500个1就是有500个患有遗传病A的人。如同表一中的第二列。\n\ngenotype.dat文件中包含了上述1000个样本在某条染色体片段上所有的位点信息。该文件总共有1001行，9445列。如同上表1中第三列到第六列的编码信息。具体来说，第一行表示9445个位点的名称，都是以字母rs开头的；接下来，有1000行，每一行表示一个样本在该条染色体片段上所有位点(9445个位点)的编码信息。例如，该文件中第2行，就表示1号样本在该条染色体片段上9445个位点的编码信息。\n\n文件夹gene_info中包含了300个dat文件，表示300个基因的信息；每个dat文件中包含了若干个位点的名称，表示该基因包含的位点信息，事实上，可以把基因理解为若干个位点组成的集合。注意到在genotype.dat文件中已包含所有位点的编码信息，所以我们可以得到每一个基因所包含位点的编码信息。例如gene_1.dat，表示基因gene_1包含了rs3094315, rs3131972,..., rs4040617，共7个位点。\n\n另外，人体的许多遗传疾病和性状是有关联的，如高血压，心脏病、脂肪肝和酒精依赖等。科研人员往往把相关的性状或疾病放在一起研究，这样能提高发现致病位点或基因的能力；\n\n附录中的multi_phenos.txt文件中提供了上述1000个样本的10种相关性状的信息。文件中的每一列表示一个性状，每一行对应一个样本。文件中的0和1信息同phenotype.txt文件。\n\n所有这些文件都可以利用Notepad++软件打开。装好notepad++后，当需要打开某个数据文件时，先点击该文件，然后点击右键，屏幕出现菜单，其中一栏是“edit with notepad++”,点击这一栏即可。许多软件也可以将文件中的数据直接读入内存。（如matlab可用importdata函数读入）\n\n本题包含以下问题：\n\n问题一、请用适当的方法，把genotype.dat中每个位点的碱基(A,T,C,G) 编码方式转化成数值编码方式，便于进行数据分析。\n\n问题二、根据附录中1000个样本在某条有可能致病的染色体片段上的9445个位点的编码信息(见genotype.dat)和样本患有遗传疾病A的信息（见phenotype.txt文件）。设计或采用一个方法，找出某种疾病最有可能的一个或几个致病位点，并给出相关的理论依据。\n\n问题三、同上题中的样本患有遗传疾病A的信息（phenotype.txt文件）。现有300个基因，每个基因所包含的位点名称见文件夹gene_info中的300个dat文件，每个dat文件列出了对应基因所包含的位点(位点信息见文件genotype.dat)。由于可以把基因理解为若干个位点组成的集合，遗传疾病与基因的关联性可以由基因中包含的位点的全集或其子集合表现出来请找出与疾病最有可能相关的一个或几个基因，并说明理由。\n\n问题四、在问题二中，已知9445个位点，其编码信息见genotype.dat文件。在实际的研究中，科研人员往往把相关的性状或疾病看成一个整体，然后来探寻与它们相关的位点或基因。试根据multi_phenos.txt文件给出的1000个样本的10个相关联性状的信息及其9445个位点的编码信息(见genotype.dat)，找出与multi_phenos.txt中10个性状有关联的位点。\n\n对你得到的结果都应该进行适当的统计分析和检验，从而从理论上说明你所发现的致病位点和基因的合理性。\n\n关键词：遗传统计学， 全基因组关联性分析(GWAS)，位点(SNPs)\nAddendum: \n关键词：遗传统计学，全基因组关联性分析 (GWAS)，位点 (SNPs)\nDataset Path:\n['gene_info', 'genotype.dat', 'multi_phenos.txt', 'phenotype.txt']\n\nData Description:\n该数据集包含针对一条可能致病染色体片段的多源遗传信息与表型标签，适用于寻找与遗传疾病A相关的致病位点与基因：共有1000个样本的基因型与表型信息，基因型数据以纯文本形式存储在genotype.dat中，覆盖9445个唯一位点（位点使用如rs3094315之类的标识符表示），位点信息与存放在gene_info目录下的300个基因对应的dat文件一一匹配，每个基因的dat文件列出该基因包含的位点名称（即与genotype.dat中的位点对应的子集），此外还有multi_phenos.txt提供的二进制（0/1）位点特征矩阵用于表达多个遗传特征的存在/缺失，最终的疾病表型由phenotype.txt给出，含1000个样本的二元标签（0=未患病，1=患病）；文件均为文本格式，数据可用于单位点关联分析、基因层面负荷检验、机器学习特征选择与分类建模等下游分析以识别候选致病变异与基因。"
  },
  "problem_background": "2016年全国研究生数学建模竞赛B题\n\n具有遗传性疾病和性状的遗传位点分析\n\n人体的每条染色体携带一个DNA分子，人的遗传密码由人体中的DNA携带。DNA是由分别带有A,T,C,G四种碱基的脱氧核苷酸链接组成的双螺旋长链分子。在这条双螺旋的长链中，共有约30亿个碱基对，而基因则是DNA长链中有遗传效应的一些片段。在组成DNA的数量浩瀚的碱基对（或对应的脱氧核苷酸）中，有一些特定位置的单个核苷酸经常发生变异引起DNA的多态性，我们称之为位点。染色体、基因和位点的结构关系见图1.\n\n在DNA长链中，位点个数约为碱基对个数的1/1000。由于位点在DNA长链中出现频繁，多态性丰富，近年来成为人们研究DNA遗传信息的重要载体，被称为人类研究遗传学的第三类遗传标记。\n\n大量研究表明，人体的许多表型性状差异以及对药物和疾病的易感性等都可能与某些位点相关联，或和包含有多个位点的基因相关联。因此，定位与性状或疾病相关联的位点在染色体或基因中的位置，能帮助研究人员了解性状和一些疾病的遗传机理，也能使人们对致病位点加以干预，防止一些遗传病的发生。\n\n近年来，研究人员大都采用全基因组的方法来确定致病位点或致病基因，具体做法是：招募大量志愿者（样本），包括具有某种遗传病的人和健康的人，通常用1表示病人，0表示健康者。 对每个样本，采用碱基(A,T,C,G)的编码方式来获取每个位点的信息(因为染色体具有双螺旋结构，所以用两个碱基的组合表示一个位点的信息）；如表1中，在位点rs100015位置，不同样本的编码都是T和C的组合，有三种不同编码方式TT,TC和CC。类似地其他的位点虽然碱基的组合不同，但也只有三种不同编码。研究人员可以通过对样本的健康状况和位点编码的对比分析来确定致病位点，从而发现遗传病或性状的遗传机理。\\begin{table}\n\\centering\n\\begin{tabular}{|c|c|c|c|c|c|}\n\\hline\n样本编号 & 样本健康状况 & \\multicolumn{4}{c|}{染色体片段位点名称和位点等位基因信息} \\\\\n\\cline{3-6}\n & & rs100015 & rs56341 & & rs21132 \\\\\n\\hline\n1 & 1 & TT & CA & \\dots & GT \\\\\n\\hline\n2 & 0 & TT & CC & \\dots & GG \\\\\n\\hline\n3 & 1 & TC & CC & \\dots & GG \\\\\n\\hline\n4 & 1 & TC & CA & \\dots & GG \\\\\n\\hline\n5 & 0 & CC & CC & \\dots & GG \\\\\n\\hline\n6 & 0 & TT & CC & \\dots & GG \\\\\n\\hline\n\\end{tabular}\n\\caption{在对每个样本采集完全基因组信息后，一般有以下的数据信息（以6个样本为例，其中3个病人，3个健康者）。}\n\\end{table}",
  "problem_requirement": "本题目针对某种遗传疾病(简称疾病A)提供1000个样本的信息，这些信息包括这1000个样本的疾病信息、样本的9445个位点编码信息，以及包含这些位点的基因信息。这些信息包含在附录中的2个文件(phenotype.txt , genotype.dat)和1个文件夹gene_info(包含300个文件)中。\n\nphenotype.txt文件中包含了样本具有遗传疾病A的信息，即一列0和1组成的数据，其中共有500个0，500个1，表示我们现在共有1000个样本，其中500个0就是500个没患有疾病A的人，500个1就是有500个患有遗传病A的人。如同表一中的第二列。\n\ngenotype.dat文件中包含了上述1000个样本在某条染色体片段上所有的位点信息。该文件总共有1001行，9445列。如同上表1中第三列到第六列的编码信息。具体来说，第一行表示9445个位点的名称，都是以字母rs开头的；接下来，有1000行，每一行表示一个样本在该条染色体片段上所有位点(9445个位点)的编码信息。例如，该文件中第2行，就表示1号样本在该条染色体片段上9445个位点的编码信息。\n\n文件夹gene_info中包含了300个dat文件，表示300个基因的信息；每个dat文件中包含了若干个位点的名称，表示该基因包含的位点信息，事实上，可以把基因理解为若干个位点组成的集合。注意到在genotype.dat文件中已包含所有位点的编码信息，所以我们可以得到每一个基因所包含位点的编码信息。例如gene_1.dat，表示基因gene_1包含了rs3094315, rs3131972,..., rs4040617，共7个位点。\n\n另外，人体的许多遗传疾病和性状是有关联的，如高血压，心脏病、脂肪肝和酒精依赖等。科研人员往往把相关的性状或疾病放在一起研究，这样能提高发现致病位点或基因的能力；\n\n附录中的multi_phenos.txt文件中提供了上述1000个样本的10种相关性状的信息。文件中的每一列表示一个性状，每一行对应一个样本。文件中的0和1信息同phenotype.txt文件。\n\n所有这些文件都可以利用Notepad++软件打开。装好notepad++后，当需要打开某个数据文件时，先点击该文件，然后点击右键，屏幕出现菜单，其中一栏是“edit with notepad++”,点击这一栏即可。许多软件也可以将文件中的数据直接读入内存。（如matlab可用importdata函数读入）\n\n本题包含以下问题：\n\n问题一、请用适当的方法，把genotype.dat中每个位点的碱基(A,T,C,G) 编码方式转化成数值编码方式，便于进行数据分析。\n\n问题二、根据附录中1000个样本在某条有可能致病的染色体片段上的9445个位点的编码信息(见genotype.dat)和样本患有遗传疾病A的信息（见phenotype.txt文件）。设计或采用一个方法，找出某种疾病最有可能的一个或几个致病位点，并给出相关的理论依据。\n\n问题三、同上题中的样本患有遗传疾病A的信息（phenotype.txt文件）。现有300个基因，每个基因所包含的位点名称见文件夹gene_info中的300个dat文件，每个dat文件列出了对应基因所包含的位点(位点信息见文件genotype.dat)。由于可以把基因理解为若干个位点组成的集合，遗传疾病与基因的关联性可以由基因中包含的位点的全集或其子集合表现出来请找出与疾病最有可能相关的一个或几个基因，并说明理由。\n\n问题四、在问题二中，已知9445个位点，其编码信息见genotype.dat文件。在实际的研究中，科研人员往往把相关的性状或疾病看成一个整体，然后来探寻与它们相关的位点或基因。试根据multi_phenos.txt文件给出的1000个样本的10个相关联性状的信息及其9445个位点的编码信息(见genotype.dat)，找出与multi_phenos.txt中10个性状有关联的位点。\n\n对你得到的结果都应该进行适当的统计分析和检验，从而从理论上说明你所发现的致病位点和基因的合理性。\n\n关键词：遗传统计学， 全基因组关联性分析(GWAS)，位点(SNPs)",
  "problem_analysis": "整体上，这个数学建模任务属于典型的全基因组关联分析（GWAS）及其延伸问题，目标既包括识别与单一二元疾病表型显著相关的致病位点（SNPs），又包括在基因层面（gene-level）或多性状（multi-phenotype）框架下发现关联信号，同时要求对所用方法的理论依据、假设与统计检验进行严谨论证。从宏观角度出发，模型的主要目标可以分为两类：解释性推断（发现哪些位点或基因与疾病A或多性状显著相关，并评估其统计显著性与置信度）与预测性建模（构建能对新个体疾病状态进行分类或风险评分的模型）。这两个目标会引导不同的方法选择和评价准则：前者强调假设检验、控制假阳性率和可解释性，后者更偏重于泛化能力、交叉验证和预测性能度量。理解并明确目标对于后续数据预处理、编码策略、检验选择和校正方案至关重要，因为用于推断因果或潜在致病位点的严格统计证据需要更保守的多重检验校正和潜在混杂因素的控制，而用于构建预测模型时可能会采用机器学习方法并在一定程度上牺牲可解释性以换取更高的分类准确率。\n\n在具体建模前必须识别并讨论问题中显性和隐含的假设与约束，这些前提决定了分析结果的解释范围与可信度。显性的假设包括样本的二元表型已被可靠测量、给定的genotype.dat提供的每个样本-位点的基因型数据是准确的且缺失率可控，gene_info中的基因位点列表合理对应于生物学上的基因定义。隐含的关键假设常常包括群体同质性（或说不存在明显的种群结构导致的系统性分层）、位点之间的独立性或可通过关联结构（如连锁不平衡LD）来解释有关信号、以及小样本效应或测序/分型错误不会系统性地偏倚病例与对照的差异。若这些假设被违反，例如存在未被校正的人口分层或样本批次效应，则单位点的简单卡方检验或逻辑回归的p值可能出现严重偏差，引发大量假阳性或掩盖真实信号。因此在建模流程中应把质量控制（QC）列为第一步：筛除低基因型调用率的样本或位点、剔除等位基因频率（MAF）过低的SNP（或用专门的稀有变异检测策略处理）、考查和检验Hardy-Weinberg平衡（尤其在对照组）、检查样本间亲缘关系与种群结构（主成分分析PCA或混合线性模型）的存在并在后续模型中作为协变量加以调整。只有在经过这些预处理后，所得的统计检验和所推断的位点才具有更可靠的生物学含义。\n\n关于位点编码（问题一），应理解不同编码代表的生物学遗传模型：由于每个位点以两个碱基表示，可定义三类基因型（例如AA、AB、BB）。常见的数值编码策略包括加性编码（0、1、2表示其中一个等位基因的剂量，适合多数GWAS前提）、显性/隐性编码（把携带至少一个风险等位基因编码为1或只在纯合时编码为1）以及将两个等位基因分别做虚拟变量或使用基于基因型的分类变量来保持最大灵活性。每种编码隐含不同的遗传效应假设；因此合理策略是以加性模型为主（既简单又有较好鲁棒性），并在候选位点上额外检验显性/隐性或模型不对称性。编码还需要解决数据清洗与缺失值填补问题，缺失可以用样本或位点的最常见基因型填补、基于EM的基因型概率填补或用多重插补来反映不确定性。在数学层面上，把碱基对映射到数值也要求对等位基因方向（哪一个作为参考等位基因）进行一致定义，以便于后续回归系数的生物学解释。\n\n在单位点关联分析（问题二）的模型路径上，经典方法包括基于列联表的卡方检验或Fisher精确检验用于每个SNP的病例/对照频率比较，以及以SNP剂量为解释变量的二元逻辑回归，这允许加入协变量（如性别、年龄、主成分以控制种群结构）并提供对效应大小（优势比OR）与显著性检验的估计。由于9445个独立或相关测试带来严重的多重比较问题，需要对p值进行校正，保守方法是Bonferroni校正，但在高维基因组数据上常用的更现实的控制方式是基于FDR（Benjamini-Hochberg）或采用基于置换的经验p值来估计显著阈值。连锁不平衡（LD）意味着相邻SNP间高度相关，导致标准独立检验的有效测试数低于物理SNP数；为此可通过估算独立信号数（LD pruning或利用有效自由度校正）来调节校正强度。候选致病位点的优先级通常不仅仅取决于纯统计显著性，还考虑效应大小、等位基因频率、是否位于基因编码区域或调控元件（例如启动子、增强子）、以及与已知生物通路的一致性。对于在单位点检验中发现的显著SNP，需要进行稳健性分析（在包含/不包含协变量情况下重复检验、分层分析、交叉验证或置换检验），并尝试用逐步回归或条件分析（conditioning）来判断信号是否来自独立位点还是由LD带来的标签信号。\n\n在基因层面检验（问题三），由于单个位点检验对稀有变异或多个小效应位点的检测能力有限，把SNP按基因聚合进行荷载或变异集检验是更合适的策略。常见的基因级方法包括Burden测试（把基因内变异按等位基因计数求和作为解释变量）、SKAT（序列核关联测试，允许不同位点效应方向不一致并使用核方法聚合信号）以及混合Burden-SKAT方法（如SKAT-O）来平衡功效对多种效应构型的鲁棒性。基因测试需要定义基因包含的SNP集，考虑是否包含上下游调控区域，并可对位点加权（例如按次要等位基因频率给低频/稀有变异更高权重，或按功能注释给有预测破坏性变异更高权重）。在解释基因级结果时应注意基因长度和SNP数量的偏差（更长或包含更多SNP的基因更容易获得显著性），因此在检验或FDR校正时要用基因长度或SNP计数作为调整项或通过置换生成经验显著性来控制这一偏倚。理论依据包括统计功效的提升（把多个微弱但一致方向的效应累积起来）和更直接的生物解释（基因而非单个SNP通常是功能单元），但同时也要考虑基因边界外的调控变异和跨基因的调控网络，这可能导致将真正的信号误归因于错位的基因。进一步的验证策略应包括富集分析（路径/通路层面）、在独立队列的复制，以及基因表达或功能注释数据的整合（eQTL、ChIP-seq、转录组数据）以提升因果解释力。\n\n问题四扩展为多性状框架时存在潜在的额外功效机会与统计复杂性。多性状联合分析（multi-trait GWAS）可以利用性状间的相关性来提高检测信号的统计功效，常用方法包括基于多元回归或MANOVA的多变量检验、基于主成分或基因-表型典型相关分析（CCA）的降维策略、以及最近发展的MTAG或多性状混合模型，它们试图在保持错误率可控的同时通过合并信息增强微小效应位点的可检测性。在实施时需衡量多个性状的相关结构，避免把不相关但在样本上有相同混杂来源的性状联结导致的假阳性。务必对多性状分析的假设进行检验（例如性状的相关矩阵是否稳健、是否存在横向污染），并可以通过置换或基于参数的多重检验校正来控制整体的错误发现率。此外，多性状方法需要应对不同性状的测量尺度与不平衡（某些性状可能更稀有），这可以通过对每个性状作标准化或用加权方案平衡贡献来处理。整合多属性信息还有助于区分具有广泛影响的“主效用”SNP（pleiotropy）与仅影响单一性状的位点，但区分真性多效性与共因子效应（例如环境共同作用）仍需谨慎，常用方法为条件分析或孟德尔随机化等工具来提供因果线索。\n\n此外，模型构建中必须严肃对待不确定性与风险。GWAS固有的高度多重检验和群体结构混淆意味着所报告的候选位点须在独立样本中复制才能被认为是稳固发现。统计显著性并不等同于生物学因果性：一个SNP可能仅作为临近因果变异的标签（由于LD），因此需要细化定位（fine-mapping）和功能验证（如生物实验、表达定量位点eQTL分析或CRISPR实验）来确认因果角色。在方法选择上存在权衡：典型的频数检验与逻辑回归易于解释与实施但可能忽视复杂交互与非线性，机器学习方法（随机森林、梯度提升机、LASSO等）在预测任务上可能表现更好，但通常牺牲了位点级可解释性且难以直接给出显著性水平；贝叶斯方法则能自然地对多重比较和先验信息建模并输出位点的后验概率，但计算复杂度高且结果对先验敏感。针对稀有变异，常规单位点检验无能为力，此时需要聚合检验或专门的稀有变异设计。交互效应（SNP×SNP即表型上的表遗传学相互作用，SNP×环境交互）会造成主效应检验的效力下降且增加模型复杂度，需要特别设计的检验策略和更大的样本量。\n\n关于模型动态性与长期效应的考量，遗传关联分析不是静态的；随时间推移人群的等位基因频率、生态环境与流行病学背景会改变，使得从单一队列得到的关联在不同时间或不同人群中可能失效。某些疾病表型受年龄或生活方式强烈影响，单次横断面分析可能掩盖年龄依赖或时间依赖效应，因此在可能情况下应考虑纵向数据或分年龄段、分环境进行分层分析以探查时间动态。此外，选择样本时的抽样偏差（例如医院化招募、志愿者偏倚）会限制结果的可推广性；对这类偏差的敏感性分析应当作为结果解释的一部分。\n\n最后，要把建模过程看成一个迭代与开放的流程而非一次性工程。合理的工作流程应当包括初始数据质量控制与描述性统计、单位点与基因级初步检验、针对显著或有趣候选的稳健性检验与条件分析、整合外部注释（功能预测、eQTL、通路数据库）并用独立队列进行复制验证。任何阶段出现与预期不符的证据都应促使回溯性检查前提（如重新评估种群结构、批次效应、基因型调用阈值），并可能需要调整模型或采用替代策略（例如从单位点检验转向基因集或通路分析，或使用多性状联合检验来增强功效）。在报告结果时，应清楚陈述所用方法的假设、检验的多重比较校正策略、效应大小与置信区间、以及对结果的生物学解释的不确定性，并建议实验验证与独立队列复制作为下一步。总体上，这一系列分析既要求严密的统计学控制，也需与生物学知识相结合，采用跨学科的迭代式方法才能在理论上与实践上稳健地识别并理解候选致病位点和相关基因。",
  "modeling_solution": "总体思路与假设：本模型把寻找致病位点与相关基因的问题表述为一类带有严格质量控制、种群结构调整和多重检验校正的联合统计推断与预测任务。核心假设包括：样本的表型测量为二元（0/1）且可靠，genotype.dat中每个位点的基因型调用误差服从独立随机误差且总体缺失率不高；群体结构存在但可以用主成分或线性混合模型（LMM）加以校正；大多数位点对表型的效应可近似为线性剂量效应（additive model）但在候选位点应检验显性/隐性模型；基因层面的致病作用可视为若干位点效应的累积或变异集的聚合效应。基于这些假设，模型分为四个相互衔接的模块：数据预处理与编码、位点单点关联测试（GWAS模块）、基因水平聚合检验（gene-level模块）与多性状联合分析（multi-trait模块）；此外并行纳入机器学习的预测/特征选择流程供候选位点优先级排序与稳健性检验使用。变量与参数记号定义如下：n 表示样本数（1000），p 表示位点数（9445），y∈{0,1}^n 为疾病表型向量，G为 n×p 的基因型矩阵，G_ij 为个体 i 在位点 j 的剂量编码（0/1/2，对应参考等位基因剂量），X为 n×k 的协变量矩阵（含常数项、若干主成分PCs、性别/年龄等若有），对于基因集合检验令 G_g 为 n×p_g 的基因 g 包含的位点矩阵，w 为加权向量。需估计的参数包括每个位点的效应 β_j，基因级效应向量或核函数参数，以及混合模型中的方差成分σ_g^2和σ_e^2。\n\n编码与预处理策略（回答问题一的数学表达与实施）：将碱基对两字母组合（如 TT, TC, CC）先统一映射为等位基因对 {A,B} 与单一参考等位基因（例如将次要等位基因 minor allele 记为 a），然后采用加性剂量编码 G_ij ∈ {0,1,2} 表示个体携带次要等位基因的拷贝数。数学上，对第 j 位点，指定一等位基因为参考，令 G_ij = count(minor allele)。缺失值采用等位基因频率加权的期望剂量填补（E[G_ij] = 2·MAF_j）或利用EM法在样本层面插补基因型概率以保留不确定性；实用上优先用样本中最常见基因型或基于位点 MAF 的期望值填补，后续对填补方法做敏感性分析。为了避免等位基因方向不一致带来的符号歧义，所有位点统一以 minor allele 作为剂量的计数方向。初步质量控制（QC）包括：剔除缺失率过高的位点或样本（如位点或样本缺失率 > 5%）、过滤次要等位基因频率小于阈值（例如 MAF < 1% 或者依据分析侧重点可设 0.5%），在对照组检验 Hardy-Weinberg 平衡（如 HWE p < 1e-6 则剔除），并进行 LD 修剪与亲缘检测。为控制群体结构，基于G进行主成分分析（PCA）得到前 q 个PCs（例如 q=5或10）并作协变量加入 X。此模块的计算可用矩阵操作实现：对 G 做按列中心化与标准化后做奇异值分解得到PCs。\n\n单位点关联模型与检验（问题二的数学核心）：对每个位点 j 建立带协变量的二元逻辑回归模型 logit(P(y_i=1)) = X_i α + G_ij β_j，其中 X_i 为第 i 行协变量（含常数和PCs），β_j 为位点效应。用最大似然法估计参数并通过 Wald 统计量或似然比检验（LRT）或 Score 检验得到每个位点的 p 值。统计表达为估计的效应 β̂_j 与其标准误 se(β̂_j)，Z_j = β̂_j / se(β̂_j) ~ N(0,1) 在原假设 β_j=0 时近似成立，p 值通过双侧正态分布获得。若存在明显的相关结构或样本相关性，则使用线性混合模型（LMM）或广义线性混合模型将样本间的相关性建模：y = Xα + G_j β_j + u + ε，其中 u ~ N(0,σ_g^2 K) 表示个体间的遗传背景效应，K 为基于全基因型的 GRM（genetic relationship matrix），方差成分通过 REML 估计，效应检验可通过基于LMM的 Score检验或变体（如GEMMA, REGENIE实现）。对于每个位点，保存 OR (odds ratio)、95%置信区间与 p 值。由于多重检验问题，需要进行校正；给出两种选择：严格的 Bonferroni 阈值 α_B = α / p（例如 α=0.05），或基于 Benjamini-Hochberg (BH) 的 False Discovery Rate (FDR) 控制以提高功效。此外，估计位点间的有效独立测试数 Meff 以放宽 Bonferroni（Meff 可通过对 LD 矩阵的特征值分解得到：Meff ≈ Σ_i I(λ_i > 1) 或基于 Li和Ji方法）。为减少 LD 导致的重复信号，先做 LD 修剪保留代表性SNPs，或在发现多个邻近显著SNP时做条件分析：在已识别领先SNP作为协变量的模型中再次检验相邻 SNP，以判断信号是否独立。\n\n基因层面聚合检验（问题三的数学策略）：对每个基因 g 使用两类互补方法：Burden 测试和 SKAT（Sequence Kernel Association Test）。Burden 测试构建基因计分 S_i = Σ_{j∈g} w_j G_ij，其含权重 w_j 可按 MAF 的函数（常用 Beta(1,25) 权重，给稀有变异更高权重）或功能注释权重。然后在逻辑回归框架中检验 logit(P(y_i=1)) = X_i α + γ S_i，检验 γ=0。SKAT 把基因看成核机模型，检验统计量 Q = (y - μ̂)' K_g (y - μ̂)，其中 μ̂ 是在无基因效应下的拟合概率，K_g = G_g W W' G_g' 为基因特征核矩阵，W 为对位点加权对角矩阵。Q 的无效分布为加权卡方（可用 Davies 方法、moment-matching 或精确置换估计 p 值）。SKAT 的优点在于允许基因内位点效应方向不一致而仍保持功效。为兼顾两者的优缺点，可采用 SKAT-O 混合方法自动选择最优组合。对基因检验的显著性也需多重检验校正（使用基因数 300 的 Bonferroni 或 FDR），并在基因长度或 SNP 数目上采用置换检验或调整策略以纠正偏差。结果可进一步用基于 Bayes 的 fine-mapping 在基因范围内估计位点的 posterior inclusion probability (PIP) 来对候选位点排序。Bayes 因子近似可用 Wakefield 的 ABF 公式，PIP_j ∝ BF_j · π_j，其中先验 π_j 可设为与 MAF 或功能注释相关的值。\n\n多性状联合分析（问题四的数学扩展）：设 Y 为 n×t 的多性状矩阵（t=10），对每个位点 j 做多变量回归模型 Y = X A + G_j b_j + E，其中 b_j 为 t 维效应向量，检验 H0: b_j = 0。统计量可以用基于 Wilks’ lambda 或 Pillai’s trace 的 MANOVA 检验，或在每个位点上进行多元广义线性回归并对总体效应做联合 z^2 统计量（例如 Q_j = b̂_j' Σ̂^{-1} b̂_j ~ χ^2_t）。也可做基于主成分的表型降维（对 Y 做 PCA，取前 r 个表型PC，检验在这些 PC 上的位点效应）或者用典型相关分析（CCA）寻找表型与位点的线性组合相关性。若表型间相关性强且部分性状受同一遗传因素控制，多性状联合方法会提高检测力。另一个现代选择是使用 MTAG（多性状基因组学联合分析，需 summary statistics）或 MultiPhen（把基因位点做自变量、多个表型做因变量的回归），以及基于混合模型的多性状LMM以同时建模表型协方差结构。对多性状测试的多重检验校正需考虑位点数量与测试自由度的增长，可用 permutation 来估计家族错误率（family-wise error rate, FWER）。\n\n组合策略、优先级排序与整合注释：在得到单点 p 值、OR、基因级 p 值与多性状联合 p 值后，建立候选位点/基因的优先级评分 S 综合考虑统计显著性（-log10 p）、效应大小（|β̂|或OR远离1）、等位基因频率（MAF）、位置注释（是否位于编码区/保守区域/调控元件）、与多个性状的一致性（是否在 multi-trait 分析中也显著）和基因功能注释（已知疾病相关通路或表达）。数学上定义综合评分 S = w1·Φ(p)+w2·|β̂|+w3·f( MAF )+w4·A, 其中 Φ(p) = -log10(p) 标准化后，f(MAF) 为给低频变异加权函数，A 为注释加分项，权重 w 可由主观或数据驱动的方法（如基于训练集的回归模型）确定。对候选位点进行条件分析与细化：在包含领先SNP的回归模型中再次检验邻近位点，以识别独立信号，随后可以做 Bayesian fine-mapping 计算区间中每个位点的 PIP，以获得 95% credible set。\n\n数值求解与计算实现细节：单点检验可并行化为 p 个独立 GLM 求解问题，使用矩阵运算加速：对于对数几率回归可用 iteratively reweighted least squares (IRLS) 或使用二阶牛顿法。LMM 方程和方差组分估计使用 REML 和谱分解加速（如用 eigendecomposition of K）。SKAT 的矩阵核计算 Q = (y-μ)' K (y-μ) 也可通过矩阵乘法有效计算。多性状检验需要估计表型协方差矩阵 Σ，其逆或分解在 t 小（10）时易处理。对高维度或复杂模型（如全基因组 LMM）建议使用专门软件（PLINK2, GEMMA, BOLT-LMM, SKAT R package, REGENIE），并在本规模（n=1000, p≈9445）下可在普通科研服务器上较快完成；建议并行化 SNP 循环并在多核环境下运行，必要时通过 LD pruning 或稀疏化方法先降低 p。需要注意数值稳定性与精度，选取 double 精度并检查极端 MAF 情况下的收敛性。\n\n统计校正、稳健性与验证：多重比较严格控制采用两步：在初步筛选使用 FDR 控制以确定候选位点/基因集合，在最终宣称需要复制的发现时使用更严格的 Bonferroni 或基于有效独立测试数的校正。使用置换检验估计经验 p 值和阈值，尤其在 gene-level 测试和 multi-trait 测试中更可靠。对模型的稳健性进行敏感性分析：改变 MAF 截断（例如 0.5%, 1%, 5%）、缺失值插补方法、加入/去除不同数量的 PC、使用或不使用 LMM 校正以评估信号是否保持。用交叉验证（k-fold CV）评估预测模型（LASSO logistic、随机森林、XGBoost）的泛化能力，并用 AUC、精确率-召回率等指标比较。最终的生物学验证建议包括寻找独立队列复制、整合 eQTL/基因表达数据（看显著SNP是否是调控该基因表达的eQTL）、注释到已知通路与病理机理。\n\n具体步骤化的实施流程（按时间顺序执行以保证结果可复现）：首先对 genotype.dat 做编码与QC，生成中心化标准化的 G 与 PC；其次对每个位点做带PC的逻辑回归（若样本内存在相关性则换用 LMM），并保存 OR, p 值；第三步对显著位点做 LD 群集分析（clumping）与条件回归以找出独立信号；第四步基因层面使用 Burden、SKAT、SKAT-O 并用置换校正 p 值；第五步使用 multi-trait 回归或 MANOVA/CCA 对 multi_phenos.txt 的 10 个性状做联合检验以识别 pleiotropic 位点；第六步整合结果并按综合评分排序，做细化的 Bayes fine-mapping 与功能注释；第七步对候选位点/基因进行稳健性与灵敏性分析并准备复制验证方案。每一阶段应保存中间结果与日志以便审计。\n\n不确定性量化与长期拓展：模型应包括对不确定性的显式量化：p 值与置信区间、PIP、以及对关键参数的 Bootstrap/置换置信区间。未来扩展可引入贝叶斯层次模型以整合先验生物学信息（例如注释驱动先验、RARE variant 先验），并将多性状模型扩展为因果推断（如利用 Mendelian Randomization 或结构方程模型）以分辨多效性 vs 共因子效应。随着更大样本或功能注释数据到来，可用 fine-mapping 与基因表达整合（colocalization 分析）提高因果位点的识别能力。此外，可把模型模块化为可重复管道（workflow），借助 Snakemake 或 Nextflow 自动化以便在新数据中快速重训练/校准。最后建议将最终候选位点与公开数据库（dbSNP、GWAS Catalog、GTEx）比对以检验一致性，并制定实验验证优先级以指导后续生物学实验。\n\n结论性陈述：本方案将位点的碱基编码以一致的加性剂量数值化，并以带协变量的逻辑回归或混合模型进行严格的单点检验，采用 Burden/SKAT 等方法在基因层面聚合信号，并用多性状多变量方法挖掘与多种表型共同关联的位点。通过 PCA 或 LMM 控制群体结构，利用多重检验校正与置换检验控制错误发现率，结合 Bayes fine-mapping 与功能注释对优先候选位点与基因排序。该框架兼顾解释性（统计显著性、效应估计、置信度）与预测性（正则化/机器学习模型评估），并嵌入稳健性检验和可复制验证路径，能为问题二、三、四提出系统且可操作的候选致病位点与基因名单及其理论统计支持。",
  "task_descriptions": [
    "子任务1（数据预处理与碱基到数值编码）的目的在于将原始文本格式的基因型（如 \"TT\",\"TC\",\"CC\"）解析为可用于数值计算的加性剂量矩阵，并同时完成必要的质量控制（QC），以生成干净、可复现且有完整元数据记录的输入文件；该子任务的输入为原始的genotype.dat（第一行为9445个位点标识符，后续每行为一个样本在所有位点的两碱基基因型字符串）和可选的样本表型/元数据文件，输出为（1）n×p 的加性剂量矩阵G（缺失以NA表示，剂量为0/1/2，参照后述原则），（2）每个位点的QC表（缺失率、等位基因频率MAF、参考/次要等位基因、HWE p 值、是否为多等位或互补模糊位点等），（3）每个样本的QC表（样本缺失率、杂合率、亲缘度指标等），以及完整的QC日志；具体步骤与方法如下：首先解析文本并标准化基因型表示（将两字母顺序视为无序，统一大写，约定缺失标记如 \"NN\",\"00\" 转为 NA），对每个位点统计出现的核苷酸集合并剔除明确的多等位位点或对多等位位点标注为“multi-allelic”以供审查；若仅包含一种等位基因则标注为单型并可在默认QC阈值下剔除；若恰好两种等位基因，则通过计数染色体拷贝数（每个样本基因型按字符计数）计算等位基因频率并将次要等位基因（minor allele）定义为计数较小者，生成加性剂量编码 G_ij = count(minor allele) ∈ {0,1,2}（异质型不区分顺序）；接着计算并记录每个位点的缺失率和样本的缺失率，按默认阈值剔除缺失率过高的位点与样本（建议阈值位点缺失率 > 5%，样本缺失率 > 5%，可参数化调整）；计算每个位点的 MAF 并按阈值过滤低频位点（建议初始阈值 MAF < 0.01，可根据研究重点放宽或收紧）；在有对照样本信息时对对照组执行 Hardy–Weinberg 平衡检验并对 HWE p 值极小（建议 p < 1e-6）的位点作标注或剔除；对样本层面计算杂合率并用均值±3标准差识别异常个体，计算成对相关性/PI_HAT（或基于 GRM 的亲缘度），对高度相关或重复的样本（PI_HAT > 0.2）做标注并决定保留一方或记录成簇；对于缺失基因型的插补提供两种可选策略并在输出中注明所用方法：简单快速方法为按位点用期望剂量填补（E[G_ij] = 2·MAF_j）或用样本中最常见基因型填补；更稳健方法为基于 EM 的基因型概率插补或调用外部工具（如 BEAGLE/IMPUTE）做基于连锁信息的分相与隐马尔科夫填补，用户可根据计算资源与精度需求选择；在编码完成后为后续分析准备标准化矩阵（每列按 2·MAF 中心化并按 sqrt(2·MAF·(1−MAF)) 标准化以便 PCA/相关性分析），并可执行可选的位点筛选（例如按 LD 修剪保留代表SNP）以减少下游冗余；整个流程应利用可复现的工具和脚本（推荐使用 PLINK 或 plink2 执行缺失率、MAF、HWE、相关性、LD pruning；使用 Python（pandas, numpy）或 R（data.table, SNPRelate）做文本解析和额外计算），并以结构化文本/CSV保存所有输出和日志（包括参数和阈值），以便审计与后续分析严格复现。",
    "子任务2（单位点关联分析）——目标是基于经编码和必要缺失处理后的基因型矩阵 G（n×p，n=1000，p≈9445）与二元表型向量 y（phenotype.txt），在严格控制潜在混杂（如群体结构、相关性、性别/年龄等协变量）下，对每个SNP独立检验其与疾病A的关联，输出每个SNP的效应估计、不确定性、显著性及独立信号集合以供后续细化；为实现该目标，需按以下步骤执行：一是准备输入——确认G中缺失值已按一致策略处理或可在模型中处理，构建协变量矩阵 X（包含截距项和若干主成分PCs以控制种群结构，以及可用的性别/年龄等混杂变量）；二是选择与实施主要检验模型——在假设个体独立且样本结构不复杂时对每个SNP j拟合带协变量的二元逻辑回归 logit(P(y=1)) = Xα + G_j β_j，使用最大似然估计获得 β̂_j、se(β̂_j)、Wald 统计并计算 OR 与95%置信区间与双侧p值；在存在样本相关或近亲、或观察到系统性通量（从QQ图或λGC）时改用线性/广义线性混合模型（LMM/GLMM）或基于遗传关系矩阵的方差分量方法以校正背景效应（推荐使用 GEMMA、BOLT-LMM、REGENIE 等实现）；为处理罕见等位基因或完全分离问题，应在必要时使用 Firth 校正或精确检验；三是多重比较与显著性判定——记录原始p值并计算 FDR（Benjamini–Hochberg）以及基于总测试数或有效独立测试数 Meff（通过LD矩阵特征值法估计）的Bonferroni阈值，必要时通过置换产生经验阈值；四是识别独立信号与条件分析——对达到筛选阈值的SNP做LD clumping（如PLINK clump）以汇总区域簇并在领先SNP作为协变量的条件回归模型中反复检验以鉴别独立信号；五是结果校验与优质输出——为每SNP生成标准化结果表（SNP ID、位置、参考/次要等位基因、MAF、β̂、se、OR、95%CI、原始p、FDR、是否通过Bonferroni阈值、所属clump与条件检验结果），并产生Manhattan与QQ图及基因组控制因子以评估整体校准；六是可选的后续精细化准备——对显著区域可计算Wakefield近似贝叶斯因子并估计 posterior inclusion probability (PIP) 为后续fine‑mapping作准备。实现细节建议并行化SNP循环以加速计算，常用软件/工具包括 PLINK/PLINK2（快速单位点检验、clumping、Firth 选项）、R 的 glm/logistf、Python 的 statsmodels、以及 GEMMA/BOLT‑LMM/REGENIE（LMM）。该子任务的输出应包括可复现的脚本/参数记录、每SNP的完整统计汇总表、独立信号列表与条件分析记录、以及用于判定显著性的阈值与方法说明。",
    "子任务3的目标是在给定已编码为剂量矩阵（G，元素为0/1/2，缺失已处理）和每个基因对应的位点列表（gene_info目录内每个dat文件）以及表型向量y和协变量矩阵X（含截距与若干主成分或其他混杂校正变量）的前提下，对每个基因进行统计聚合检验以检测基因层面的关联信号，并在显著基因内进行位点级细化以产出候选致病位点的优先级与功能注释；具体实施步骤为：首先对每个基因g读取其SNP子集并从G中抽取对应子矩阵G_g，记录每位点的MAF、缺失率和单点统计信息以便后续注释与敏感性分析；其次对基因级检验并行实施至少三类互补方法——（1）Burden测试：按权重w_j（建议使用MAF加权如Beta(1,25)或功能注释加权）构造样本基因负荷S_i=Σ_{j∈g} w_j G_ij，并在逻辑回归框架（logit(P(y=1))=Xα+γS）中检验γ=0，报告估计值与置信区间；（2）SKAT：在二元表型的广义线性核检验框架下构造核K_g = G_g W W' G_g'（W为位点权重对角矩阵），计算Q统计量并用Davies方法或精确置换估计p值；（3）SKAT‑O：采用SKAT‑O自动在Burden与SKAT之间权衡以兼顾效应方向一致与方向相反两种情形；在可用情况下使用SKAT R包或等效实现并确保在二元表型下以适当的拟合零模型（包含X）得到稳健p值；第三，对所有基因的原始p值进行多重检验校正（对300个基因可同时报告Bonferroni校正阈值与Benjamini–Hochberg FDR），并为校正基因长度和SNP数偏倚附加置换检验：对表型向量做B次置换（B≥1000，必要时更多）得到基于经验分布的p值或基因特异性阈值；第四，对显著或候选基因实施位点级细化：计算基因内每个SNP的单点统计量并采用贝叶斯细化方法（例如Wakefield ABF近似或使用susieR/FINEMAP）估计每个变异的posterior inclusion probability (PIP)，并基于PIP构建95% credible set以定位最可能的致病位点；第五，整合功能注释以辅助排序：对候选SNP输出其功能类别（编码改变/错义/无义/剪接/非编码）、保守性分数（PhyloP/GERP）、调控注释和已知eQTL信息（如GTEx）、以及SNP在单点与基因检验中的贡献权重；第六，进行敏感性分析：比较不同权重方案（MAF权重、等权、功能权重）、不同MAF截断（例如包含/排除MAF<0.01的稀有变异）、以及是否含或不含某些协变量（不同数量的PCs）对基因显著性的影响，并在输出中记录所有参数设置以保证可复现；第七，输出规范化结果文件集：每个基因的Burden/SKAT/SKAT‑O原始p、置换p、校正后p（FDR/Bonferroni）、基因内SNP列表及其MAF、单点统计、PIP与95% credible set、功能注释标签与综合优先级分数，并生成用于解释的图表（基因区域曼哈顿图、PIP热图、置换分布图）；实现工具建议以PLINK（提取SNP、计算MAF等基础QC）、SKAT R包（基因检验）、susieR或FINEMAP（贝叶斯细化）、ANNOVAR或Ensembl VEP（功能注释）为主，整个流程应并行化以提高效率，并保存所有中间结果、随机种子与运行参数以便审计与复现。",
    "子任务4（多性状联合分析、预测建模与候选位点/基因优先级排序的独立任务）要求以经预处理并数值化的基因型矩阵 G (n×p)、多性状矩阵 Y (n×t，t=10) 以及可选的协变量矩阵 X (n×k，例如PCs、年龄、性别) 为唯一输入，独立完成三类互补工作：A) 多性状关联检测——对每个位点 j 或每个基因集合，实施至少两种互补的联合检验策略以提高对具有微小或多效性效应变异的检出功效：一为基于多变量广义线性模型/ MANOVA 的联合检验（拟合 Y = X A + G_j B_j + E，检验 B_j = 0，采用 Wilks’ λ、Pillai 或齐次性-自由度校正的 χ^2/ F 统计量或等价的 Q = b̂'Σ̂^{-1}b̂ 的卡方型总体效应检验）；二为降维后检验（对 Y 做 PCA/CCA，取前 r 个表型主成分或典型相关向量作为综合表型，在这些主成分上对每个 SNP/基因做单变量检验以捕获共有信号）；在样本相关或存在群体结构时，优先采用多性状线性混合模型（mvLMM）将遗传相关矩阵 (GRM) 作为随机效应纳入以校正背景，所有检验须同时纳入协变量 X 并通过置换或估计的协方差矩阵来获得稳健的 p 值；对多重比较采用适当校正（FDR、基于有效独立测试数的Bonferroni或置换估计的经验阈值），并输出每位点/基因的多性状联合 p 值、效应向量估计与检验统计量； B) 预测建模与特征稳健性筛选——基于相同输入构建可评估泛化能力的分类/回归模型以衡量位点集合的预测信息并作为特征重要性来源：用于单一目标（例如疾病标签）或多输出目标的模型可包括正则化线性模型（LASSO/Elastic‑Net via glmnet）、树模型（随机森林、XGBoost）与稀疏多输出模型，所有模型应采用嵌套交叉验证（外层用于性能评估，内层用于超参数选择）并在训练集中使用稳定性选择（stability selection）或递归特征消除来识别稳定被选中的SNP/基因；评价指标包括AUC/ROC、精确率/召回率、F1、校准曲线与多输出的micro/macro平均指标，同时记录各特征的标准化重要性或回归系数分布以量化不确定性； C) 优先级综合评分与稳健性检验——对来自 A 和 B 的证据进行系统整合以生成位点/基因的综合优先级 S：设 S 为加权函数，合成项包括多性状联合检验显著性（-log10 p 标准化）、单点/基因效应量的一致性（跨表型或跨方法的β向量一致性）、预测模型中的特征稳定性分数（被选中频率或平均重要性）、等位基因频率加权（为稀有变异引入权重）、以及可选的功能注释分值；权重可通过预先定义或用一个小规模训练-校验集合优化以平衡发现和稳定性；对最终候选集逐项实施敏感性分析（改变协变量集、改变MAF阈值、不同缺失插补策略、不同多性状降维数 r、LMM 与非LMM 的比较），并用置换测试估计家族错误率（FWER）或使用Bootstrap评估评分的置信区间；输出包括按优先级排序的候选SNP/基因清单与每项证据的细目（联合 p 值、预测中重要性、稳定性频次、MAF、校正后的显著性），并提供可复现的实现说明（建议工具：R 的 mvtnorm/CCA/MASS、MultiPhen 或 GEMMA 的 mvLMM 实现用于多性状检验，glmnet/ randomForest/ xgboost 和 scikit‑learn 用于预测与稳定性选择，p.adjust/qvalue 与置换脚本用于多重检验校正），所有计算应以明确随机种子、并行化策略和输出日志记录以便独立复现；最终结果以支持后续实验验证和独立队列复制的候选优先级名单为目标。"
  ]
}