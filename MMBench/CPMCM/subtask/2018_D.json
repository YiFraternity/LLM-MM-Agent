{
  "tasks": [],
  "problem_str": "问题背景：\n2018年中国研究生数学建模竞赛D题\n\n基于卫星高度计海面高度异常资料\n\n获取潮汐调和常数方法及应用\n\n1. 潮汐潮流现象的研究意义\n\n海洋潮汐是在天体引潮力作用下形成的长周期波动现象，在水平方向上表现为潮流的涨落，在铅直方向上则表现为潮位的升降。潮汐潮流运动是海洋中的基本运动之一，它是动力海洋学研究的重要组成部分，对它的研究直接影响着波浪、风暴潮、环流、水团等其他海洋现象的研究，在大陆架浅海海洋中，对潮汐潮流的研究更具重要性。\n\n海岸附近和河口区域是人类进行生产活动十分频繁的地带，而这个地带的潮汐现象非常显著，它直接或间接地影响着人们的生产和生活。潮汐潮流工作的开展和研究，可为国防建设、交通航运、海洋资源开发、能源利用、环境保护、海港建设和海岸防护提供资料。例如，沿海地区的海滩围垦、农田排灌，水产的捕捞和养殖，制盐，海港的选址及建设，以至于潮能发电等活动，无不与潮汐潮流现象有着密切的关系。\n\n2. 潮汐潮流数值模拟所面临的问题\n\n区域海洋潮汐的数值模拟需要提供开边界的水位调和常数，而开边界的水位调和常数，或者来源于观测、或者来源于全球海洋潮汐的数值模拟；而全球海洋潮汐的数值模拟，相当耗费资源。虽然目前有国外学者或研究机构，能够提供区域海洋潮汐的调和常数，但实质上的评价结果难以令人满意。\n\n从区域海洋潮汐的数值模拟的现状来讲，四个主要分潮（$M_{2}$、$S_{2}$、$K_{1}$、$O_{1}$）的单一分潮的数值模拟与同化可以得到令人满意的结果，但其它分潮（$N_{2}$、$K_{2}$、$P_{1}$、$Q_{1}$等）的单一分潮的数值模拟与同化，结果却差强人意；这意味着其它分潮的数值模拟，只有与四个主要分潮同时进行数值模拟，才能得到可以接受的结果。从具体操作来讲，其它分潮由于相对较弱，导致模拟结果的精度难以提高。\n\n长周期分潮（$S_{a}$、$S_{sa}$、$M_{m}$、$M_{f}$）的获取，目前已有基于全球长周期分潮数值模拟手段的报道，但其面临的困境，与其它较弱分潮面临的困境没有差别。\n\n从各分潮的调和常数获取的发展史来说，通过对已有观测结果进行插值曾经是首选，但发展过程中逐渐被数值模拟方法所取代。高度计资料的出现，引发部分学者开展了插值方法的研究，并取得了一些值得一提的结果，尽管被所谓的主流方式淹没，但也难掩其光芒所在。鉴于目前已有高度计资料作为支持，其它分潮及长周期分潮的调和常数获取的插值方法研究大有可为。\\section{资料描述}\n\n\\subsection{地形数据}\n\n地形数据来自 ETOP5，全球的分辨率为 \\(5' \\times 5'\\)，图 1 的区域是 \\(2^\\circ \\sim 25^\\circ \\mathrm{N}, 99^\\circ \\sim 122^\\circ \\mathrm{E}\\)。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image.png}\n    \\caption{南海地形图}\n    \\label{fig:1}\n\\end{figure}\n\n\\subsection{验潮站资料}\n\n中国近海及周边海域 770 个验潮点的资料，和 56 个验潮点的资料（是国际上公开的长期验潮站数据分析得到的调和常数），包括 9 个分潮 \\(\\left(M_{2}、S_{2}、K_{1}、O_{1}、N_{2}、K_{2}、P_{1}、Q_{1}、S_{a}\\right)\\) 的潮汐调和常数。\n\n图 2 显示了上述资料点所在的位置，从图中可以看出上述验潮点主要分布在近岸或岛屿附近。\\subsection{TOPEX/POSEIDON 卫星高度计简介}\n\n卫星高度计是一种向卫星下方海洋发射脉冲的雷达，通过测量脉冲经海面反射之后的往返时间，获得卫星距海面的高度。主要用途：利用所得到的海面动力高度同化反演海洋重力场、流场、潮、大地水准面、海洋重力异常；根据回波强度获取风速资料；根据回波形前沿斜率获取海面有效波高。\n\nTOPEX/POSEIDON 卫星是由美国国家航空航天局和法国空间局联合于 1992 年 8 月 10 日发射的，是世界上第一颗专门为研究世界大洋环流而设计的高度计卫星。其轨道高度达 1336km，倾角为 66°，覆盖面大，保证了资料的连续性。轨道的交点周期（绕地球一圈的时间）为 6745.8s，轨道运行 127 圈以后精确重复，轨道重复周期为 9.9156 天。相邻最近的轨道之间在赤道上的间隔为 $360°/127 = 2.835°$。卫星在一个周期内的每一圈分为上行轨和下行轨两条轨道，一个完整的周期内共有 254 条轨道，沿轨道的两个相邻的星下观测点的距离为 5.75km。高度计系统的定规精度和测高精度较以前有显著提高，其测量精度约为 5cm，是目前观测海面高度精度最高的卫星。\n\n当然，本文只是涉及到 TOPEX/POSEIDON 卫星高度计资料与潮汐相关的研究，即海面高度异常产品。\\subsection{南海高度计资料}\n\n图3给出了 $2^\\circ \\sim 25^\\circ \\text{N}$, $99^\\circ \\sim 122^\\circ \\text{E}$, TOPEX/POSEIDON 卫星高度计星下观测点所在的轨道。一共有超过4000个数据点，每个点都对应一个海面高度异常的时间序列，从1992年到2017年，时间跨度为25年。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image.png}\n    \\caption{南海 TOPEX/POSEIDON 高度计资料的星下轨迹}\n    \\label{fig:3}\n\\end{figure}\n\n本题所附文件包括：\n\n1. 地形数据来自 ETOPO5，全球的分辨率为 $5' \\times 5'$，此处数据度范围 $2^\\circ \\sim 25^\\circ \\text{N}$, $99^\\circ \\sim 122^\\circ \\text{E}$（附数据说明）。\n\n2. 中国近海及周边海域验潮点的资料，包括9个分潮 ($M_2$, $S_2$, $K_1$, $O_1$, $N_2$, $K_2$, $P_1$, $Q_1$, $S_a$) 的潮汐调和常数。还包括56个验潮点的资料，同样给出了上述9个分潮的潮汐调和常数，是国际上公开的长期验潮站数据分析得到的调和常数（附数据说明）。\n\n3. 南海海面高度异常数据文件及说明。\n\n4. 调和分析方法简介（包括分潮的 Doodson 数、分潮角速度和交点因子与订正角 $\\rho_m$, $\\Delta\\mu_4^m$, $\\Delta\\mu_5^m$ 列表）\n\n本题所涉及的数据与结果，均应采用国际标准单位，即：时间单位为秒、距离单位为米、速度单位为米每秒等。\n\n问题要求：\n根据以上介绍及提供的数据文件及表格，请你们团队研究下列问题：\n\n1. 根据沿轨道的星下观测点的海面高度异常值，提取所有星下观测点各主要分潮 ($M_{2}$、$S_{2}$、$K_{1}$、$O_{1}$) 的潮汐调和常数，注意能有效提取那些分潮的潮汐调和常数取决于相应的资料长度；对提取的潮汐调和常数，应利用潮汐验潮点的调和常数给予评价或检验，并给出评价结果的分析或评价。\n\n2. 得到所有星下观测点各主要分潮 ($M_{2}$、$S_{2}$、$K_{1}$、$O_{1}$) 的潮汐调和常数，沿轨道作图后，可发现潮汐调和常数在沿轨道方向，在空间有细结构，而此细结构是内潮对正压潮的调制；请设法对沿轨道的各分潮的潮汐调和常数进行正压潮和内潮的分离。\n\n3. 设计数据插值或拟合方法给出南海的各主要分潮的同潮图，并利用潮汐验潮点的调和常数给予评价或检验，并给出评价结果的分析或评价。\n\n如果你们还有时间和兴趣，还可考虑下列：\n\n4. 如果在对沿轨道的潮汐调和常数分离、插值或拟合的过程中，利用了特定的函数进行拟合，是否能够确定出需利用的特定函数的最佳（高）次数？上述结论是否对第3问有启示或帮助。\n\n本题要求提供可计算出所提交报告中答案的计算程序，所使用的语言和工具不限，但推荐使用C/C++、Fortran、Matlab等。\nAddendum: \n本题涉及的所有数据与结果，均应采用国际标准单位，即：时间单位为秒、距离单位为米、速度单位为米每秒等。\n\n参考文献：\n[1] 陈宗镛，《潮汐学》，北京：科学出版社，1980.\n[2] 方国洪，郑文振，陈宗镛，王骥，《潮汐和潮流的分析与预报》，北京：海洋出版社，1986.\n[3] 黄祖珂，黄磊，《潮汐原理与计算》，青岛：中国海洋大学出版社，2005.\n[4] 孙丽艳：《渤黄东海潮汐底摩擦系数的优化研究》［硕士学位论文］，青岛：中国海洋大学海洋环境学院，2006.\n[5] 范丽丽：《风暴潮数值同化研究和高度计资料拟合方法研究》［硕士学位论文］，青岛：中国海洋大学海洋环境学院，2011.\n[6] Mazzega, P., and M. Berge, 1994. Ocean tides in the Asian semi-enclosed seas from TOPEX/POSEIDON. J. Geophys. Res., 99: 24,867–24,881.\n[7] Yangi, T., Morimoto A., Ichikawa K., 1997. Co-tidal and co-range charts for the East China Sea and the Yellow Sea derived from satellite altimetric data. J. Oceanography, 53: 303–309.\n[8] Fan, L.L., Wang B., Lv X.Q., 2011. Cotidal Charts near Hawaii Derived from TOPEX/Poseidon Altimetry Data. J. Atmos. Ocean Technol., 28: 606–614.\n[9] Fang, G.H., Wang Y.G., Wei Z.X., Choi B.H., Wang X.Y., Wang J., 2004. Empirical cotidal charts of the Bohai, Yellow, and East China Seas from 10 years of TOPEX/Poseidon altimetry. J. Geophys. Res., Vol.109: C11006.\n[10] Wang Y.H., Fang G.H., Wei Z.X., Wang Y.G., Wang X.Y., Xu X.Q., 2012. Cotidal charts and tidal power input atlases of the global ocean from TOPEX/Poseidon and JASON-1 altimetry. Acta Oceanol. Sin., 31(4): 11-23.\nDataset Path:\n['参考文献', '水深', '调和分析方法简介.docx', '验潮站', '高度计']\n\nData Description:\n该数据集汇聚了用于研究南海及相邻海区潮汐特征与内潮信号提取的多源资料与方法说明，包含：参考文献集合（若干PDF，讨论从高度计资料中提取内潮信号、沿轨道星下观测点海面高度异常分析、潮汐调和常数提取与评价等）；水深资料（depth.dat、水深.jpg及说明文件），用于描述海底地形对潮汐与内潮的影响；高度计资料（TP.dat、高度计.jpg及说明文件），提供卫星观测的海面高度异常以提取主要半日与日周分潮（M2、S2、K1、O1）的谐振幅与初相位；验潮站资料（含南海与东海的站点位置图、East China Seas与World seas子集及说明文件），用于潮汐调和常数的基准评价和空间插值验证；以及方法文档（“调和分析方法简介.docx”与若干数据说明），介绍潮汐调和分析基本原理、分潮角速度与初相位计算、最小二乘法提取谐和常数、正压潮与内潮分离思路及拟合/插值方法选择与阶次讨论。总体目标是通过对卫星高度计与验潮站观测的联合分析、结合水深信息，提取并检验M2、S2、K1、O1等主要分潮的调和常数，研究潮汐调和常数的空间精细结构，尝试分离正压潮与内潮成分，并设计适当的插值或拟合策略以生成南海主要分潮的同潮图及进行方法学评价。",
  "problem": {
    "background": "2018年中国研究生数学建模竞赛D题\n\n基于卫星高度计海面高度异常资料\n\n获取潮汐调和常数方法及应用\n\n1. 潮汐潮流现象的研究意义\n\n海洋潮汐是在天体引潮力作用下形成的长周期波动现象，在水平方向上表现为潮流的涨落，在铅直方向上则表现为潮位的升降。潮汐潮流运动是海洋中的基本运动之一，它是动力海洋学研究的重要组成部分，对它的研究直接影响着波浪、风暴潮、环流、水团等其他海洋现象的研究，在大陆架浅海海洋中，对潮汐潮流的研究更具重要性。\n\n海岸附近和河口区域是人类进行生产活动十分频繁的地带，而这个地带的潮汐现象非常显著，它直接或间接地影响着人们的生产和生活。潮汐潮流工作的开展和研究，可为国防建设、交通航运、海洋资源开发、能源利用、环境保护、海港建设和海岸防护提供资料。例如，沿海地区的海滩围垦、农田排灌，水产的捕捞和养殖，制盐，海港的选址及建设，以至于潮能发电等活动，无不与潮汐潮流现象有着密切的关系。\n\n2. 潮汐潮流数值模拟所面临的问题\n\n区域海洋潮汐的数值模拟需要提供开边界的水位调和常数，而开边界的水位调和常数，或者来源于观测、或者来源于全球海洋潮汐的数值模拟；而全球海洋潮汐的数值模拟，相当耗费资源。虽然目前有国外学者或研究机构，能够提供区域海洋潮汐的调和常数，但实质上的评价结果难以令人满意。\n\n从区域海洋潮汐的数值模拟的现状来讲，四个主要分潮（$M_{2}$、$S_{2}$、$K_{1}$、$O_{1}$）的单一分潮的数值模拟与同化可以得到令人满意的结果，但其它分潮（$N_{2}$、$K_{2}$、$P_{1}$、$Q_{1}$等）的单一分潮的数值模拟与同化，结果却差强人意；这意味着其它分潮的数值模拟，只有与四个主要分潮同时进行数值模拟，才能得到可以接受的结果。从具体操作来讲，其它分潮由于相对较弱，导致模拟结果的精度难以提高。\n\n长周期分潮（$S_{a}$、$S_{sa}$、$M_{m}$、$M_{f}$）的获取，目前已有基于全球长周期分潮数值模拟手段的报道，但其面临的困境，与其它较弱分潮面临的困境没有差别。\n\n从各分潮的调和常数获取的发展史来说，通过对已有观测结果进行插值曾经是首选，但发展过程中逐渐被数值模拟方法所取代。高度计资料的出现，引发部分学者开展了插值方法的研究，并取得了一些值得一提的结果，尽管被所谓的主流方式淹没，但也难掩其光芒所在。鉴于目前已有高度计资料作为支持，其它分潮及长周期分潮的调和常数获取的插值方法研究大有可为。\\section{资料描述}\n\n\\subsection{地形数据}\n\n地形数据来自 ETOP5，全球的分辨率为 \\(5' \\times 5'\\)，图 1 的区域是 \\(2^\\circ \\sim 25^\\circ \\mathrm{N}, 99^\\circ \\sim 122^\\circ \\mathrm{E}\\)。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image.png}\n    \\caption{南海地形图}\n    \\label{fig:1}\n\\end{figure}\n\n\\subsection{验潮站资料}\n\n中国近海及周边海域 770 个验潮点的资料，和 56 个验潮点的资料（是国际上公开的长期验潮站数据分析得到的调和常数），包括 9 个分潮 \\(\\left(M_{2}、S_{2}、K_{1}、O_{1}、N_{2}、K_{2}、P_{1}、Q_{1}、S_{a}\\right)\\) 的潮汐调和常数。\n\n图 2 显示了上述资料点所在的位置，从图中可以看出上述验潮点主要分布在近岸或岛屿附近。\\subsection{TOPEX/POSEIDON 卫星高度计简介}\n\n卫星高度计是一种向卫星下方海洋发射脉冲的雷达，通过测量脉冲经海面反射之后的往返时间，获得卫星距海面的高度。主要用途：利用所得到的海面动力高度同化反演海洋重力场、流场、潮、大地水准面、海洋重力异常；根据回波强度获取风速资料；根据回波形前沿斜率获取海面有效波高。\n\nTOPEX/POSEIDON 卫星是由美国国家航空航天局和法国空间局联合于 1992 年 8 月 10 日发射的，是世界上第一颗专门为研究世界大洋环流而设计的高度计卫星。其轨道高度达 1336km，倾角为 66°，覆盖面大，保证了资料的连续性。轨道的交点周期（绕地球一圈的时间）为 6745.8s，轨道运行 127 圈以后精确重复，轨道重复周期为 9.9156 天。相邻最近的轨道之间在赤道上的间隔为 $360°/127 = 2.835°$。卫星在一个周期内的每一圈分为上行轨和下行轨两条轨道，一个完整的周期内共有 254 条轨道，沿轨道的两个相邻的星下观测点的距离为 5.75km。高度计系统的定规精度和测高精度较以前有显著提高，其测量精度约为 5cm，是目前观测海面高度精度最高的卫星。\n\n当然，本文只是涉及到 TOPEX/POSEIDON 卫星高度计资料与潮汐相关的研究，即海面高度异常产品。\\subsection{南海高度计资料}\n\n图3给出了 $2^\\circ \\sim 25^\\circ \\text{N}$, $99^\\circ \\sim 122^\\circ \\text{E}$, TOPEX/POSEIDON 卫星高度计星下观测点所在的轨道。一共有超过4000个数据点，每个点都对应一个海面高度异常的时间序列，从1992年到2017年，时间跨度为25年。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image.png}\n    \\caption{南海 TOPEX/POSEIDON 高度计资料的星下轨迹}\n    \\label{fig:3}\n\\end{figure}\n\n本题所附文件包括：\n\n1. 地形数据来自 ETOPO5，全球的分辨率为 $5' \\times 5'$，此处数据度范围 $2^\\circ \\sim 25^\\circ \\text{N}$, $99^\\circ \\sim 122^\\circ \\text{E}$（附数据说明）。\n\n2. 中国近海及周边海域验潮点的资料，包括9个分潮 ($M_2$, $S_2$, $K_1$, $O_1$, $N_2$, $K_2$, $P_1$, $Q_1$, $S_a$) 的潮汐调和常数。还包括56个验潮点的资料，同样给出了上述9个分潮的潮汐调和常数，是国际上公开的长期验潮站数据分析得到的调和常数（附数据说明）。\n\n3. 南海海面高度异常数据文件及说明。\n\n4. 调和分析方法简介（包括分潮的 Doodson 数、分潮角速度和交点因子与订正角 $\\rho_m$, $\\Delta\\mu_4^m$, $\\Delta\\mu_5^m$ 列表）\n\n本题所涉及的数据与结果，均应采用国际标准单位，即：时间单位为秒、距离单位为米、速度单位为米每秒等。",
    "problem_requirement": "根据以上介绍及提供的数据文件及表格，请你们团队研究下列问题：\n\n1. 根据沿轨道的星下观测点的海面高度异常值，提取所有星下观测点各主要分潮 ($M_{2}$、$S_{2}$、$K_{1}$、$O_{1}$) 的潮汐调和常数，注意能有效提取那些分潮的潮汐调和常数取决于相应的资料长度；对提取的潮汐调和常数，应利用潮汐验潮点的调和常数给予评价或检验，并给出评价结果的分析或评价。\n\n2. 得到所有星下观测点各主要分潮 ($M_{2}$、$S_{2}$、$K_{1}$、$O_{1}$) 的潮汐调和常数，沿轨道作图后，可发现潮汐调和常数在沿轨道方向，在空间有细结构，而此细结构是内潮对正压潮的调制；请设法对沿轨道的各分潮的潮汐调和常数进行正压潮和内潮的分离。\n\n3. 设计数据插值或拟合方法给出南海的各主要分潮的同潮图，并利用潮汐验潮点的调和常数给予评价或检验，并给出评价结果的分析或评价。\n\n如果你们还有时间和兴趣，还可考虑下列：\n\n4. 如果在对沿轨道的潮汐调和常数分离、插值或拟合的过程中，利用了特定的函数进行拟合，是否能够确定出需利用的特定函数的最佳（高）次数？上述结论是否对第3问有启示或帮助。\n\n本题要求提供可计算出所提交报告中答案的计算程序，所使用的语言和工具不限，但推荐使用C/C++、Fortran、Matlab等。",
    "dataset_path": [
      "参考文献",
      "水深",
      "调和分析方法简介.docx",
      "验潮站",
      "高度计"
    ],
    "dataset_description": {
      "参考文献": "参考文献包含多个PDF文档，这些文档涉及从高度计资料中提取内潮信号的方法研究。具体包括对沿轨道星下观测点的海面高度异常值的分析，提取主要分潮（M_{2}、S_{2}、K_{1}、O_{1}）的潮汐调和常数，并利用潮汐验潮点的调和常数进行评价。此外，文档还探讨了潮汐调和常数的空间细结构，尝试分离正压潮和内潮，并设计数据插值或拟合方法生成南海各主要分潮的同潮图。",
      "水深": "水深文件夹包含关于南海潮汐调和常数研究的数据集。主要内容包括：数据说明文档（数据说明.txt），水深数据文件（depth.dat），以及水深分布的可视化图像（水深.jpg）。数据集旨在研究沿轨道星下观测点的海面高度异常值，提取主要分潮（M_{2}、S_{2}、K_{1}、O_{1}）的潮汐调和常数，并进行正压潮和内潮的分离。此外，数据集还支持设计数据插值或拟合方法以生成南海各主要分潮的同潮图，并利用潮汐验潮点的调和常数进行评价或检验。",
      "调和分析方法简介": "调和分析方法简介.docx为《调和分析方法简介》，内容主要介绍了潮汐调和分析的基本概念、分潮的分类、分潮角速度和初相位的计算方法、以及最小二乘法提取分潮调和常数的原理。",
      "验潮站": "验潮站文件夹包含南海及东中国海的潮汐调和常数研究数据。主要内容包括：数据说明文档（数据说明.txt），地理位置示意图（位置.jpg），特定海域的数据子文件夹（East China Seas, World seas）。研究目标涉及提取主要分潮（$M_{2}$、$S_{2}$、$K_{1}$、$O_{1}$）的潮汐调和常数，评估这些常数，分离正压潮和内潮，以及生成同潮图。此外，还探讨了利用特定函数进行拟合的最佳次数问题。",
      "高度计": "高度计文件夹包含关于南海海面高度异常值的数据集，用于研究主要分潮（$M_{2}$、$S_{2}$、$K_{1}$、$O_{1}$）的潮汐调和常数。文件夹内包括数据说明文档（数据说明.txt），高度计图像（高度计.jpg），以及高度计数据文件（TP.dat）。研究目标包括提取潮汐调和常数，进行正压潮和内潮的分离，设计数据插值或拟合方法生成同潮图，并利用潮汐验潮点的调和常数进行评价。"
    },
    "variable_description": [
      {},
      {},
      {},
      {},
      {}
    ],
    "addendum": "本题涉及的所有数据与结果，均应采用国际标准单位，即：时间单位为秒、距离单位为米、速度单位为米每秒等。\n\n参考文献：\n[1] 陈宗镛，《潮汐学》，北京：科学出版社，1980.\n[2] 方国洪，郑文振，陈宗镛，王骥，《潮汐和潮流的分析与预报》，北京：海洋出版社，1986.\n[3] 黄祖珂，黄磊，《潮汐原理与计算》，青岛：中国海洋大学出版社，2005.\n[4] 孙丽艳：《渤黄东海潮汐底摩擦系数的优化研究》［硕士学位论文］，青岛：中国海洋大学海洋环境学院，2006.\n[5] 范丽丽：《风暴潮数值同化研究和高度计资料拟合方法研究》［硕士学位论文］，青岛：中国海洋大学海洋环境学院，2011.\n[6] Mazzega, P., and M. Berge, 1994. Ocean tides in the Asian semi-enclosed seas from TOPEX/POSEIDON. J. Geophys. Res., 99: 24,867–24,881.\n[7] Yangi, T., Morimoto A., Ichikawa K., 1997. Co-tidal and co-range charts for the East China Sea and the Yellow Sea derived from satellite altimetric data. J. Oceanography, 53: 303–309.\n[8] Fan, L.L., Wang B., Lv X.Q., 2011. Cotidal Charts near Hawaii Derived from TOPEX/Poseidon Altimetry Data. J. Atmos. Ocean Technol., 28: 606–614.\n[9] Fang, G.H., Wang Y.G., Wei Z.X., Choi B.H., Wang X.Y., Wang J., 2004. Empirical cotidal charts of the Bohai, Yellow, and East China Seas from 10 years of TOPEX/Poseidon altimetry. J. Geophys. Res., Vol.109: C11006.\n[10] Wang Y.H., Fang G.H., Wei Z.X., Wang Y.G., Wang X.Y., Xu X.Q., 2012. Cotidal charts and tidal power input atlases of the global ocean from TOPEX/Poseidon and JASON-1 altimetry. Acta Oceanol. Sin., 31(4): 11-23.",
    "data_summary": "Dataset Path:\n['参考文献', '水深', '调和分析方法简介.docx', '验潮站', '高度计']\n\nData Description:\n该数据集汇聚了用于研究南海及相邻海区潮汐特征与内潮信号提取的多源资料与方法说明，包含：参考文献集合（若干PDF，讨论从高度计资料中提取内潮信号、沿轨道星下观测点海面高度异常分析、潮汐调和常数提取与评价等）；水深资料（depth.dat、水深.jpg及说明文件），用于描述海底地形对潮汐与内潮的影响；高度计资料（TP.dat、高度计.jpg及说明文件），提供卫星观测的海面高度异常以提取主要半日与日周分潮（M2、S2、K1、O1）的谐振幅与初相位；验潮站资料（含南海与东海的站点位置图、East China Seas与World seas子集及说明文件），用于潮汐调和常数的基准评价和空间插值验证；以及方法文档（“调和分析方法简介.docx”与若干数据说明），介绍潮汐调和分析基本原理、分潮角速度与初相位计算、最小二乘法提取谐和常数、正压潮与内潮分离思路及拟合/插值方法选择与阶次讨论。总体目标是通过对卫星高度计与验潮站观测的联合分析、结合水深信息，提取并检验M2、S2、K1、O1等主要分潮的调和常数，研究潮汐调和常数的空间精细结构，尝试分离正压潮与内潮成分，并设计适当的插值或拟合策略以生成南海主要分潮的同潮图及进行方法学评价。",
    "data_description": {
      "参考文献": "参考文献包含多个PDF文档，这些文档涉及从高度计资料中提取内潮信号的方法研究。具体包括对沿轨道星下观测点的海面高度异常值的分析，提取主要分潮（M_{2}、S_{2}、K_{1}、O_{1}）的潮汐调和常数，并利用潮汐验潮点的调和常数进行评价。此外，文档还探讨了潮汐调和常数的空间细结构，尝试分离正压潮和内潮，并设计数据插值或拟合方法生成南海各主要分潮的同潮图。",
      "水深": "水深文件夹包含关于南海潮汐调和常数研究的数据集。主要内容包括：数据说明文档（数据说明.txt），水深数据文件（depth.dat），以及水深分布的可视化图像（水深.jpg）。数据集旨在研究沿轨道星下观测点的海面高度异常值，提取主要分潮（M_{2}、S_{2}、K_{1}、O_{1}）的潮汐调和常数，并进行正压潮和内潮的分离。此外，数据集还支持设计数据插值或拟合方法以生成南海各主要分潮的同潮图，并利用潮汐验潮点的调和常数进行评价或检验。",
      "调和分析方法简介": "调和分析方法简介.docx为《调和分析方法简介》，内容主要介绍了潮汐调和分析的基本概念、分潮的分类、分潮角速度和初相位的计算方法、以及最小二乘法提取分潮调和常数的原理。",
      "验潮站": "验潮站文件夹包含南海及东中国海的潮汐调和常数研究数据。主要内容包括：数据说明文档（数据说明.txt），地理位置示意图（位置.jpg），特定海域的数据子文件夹（East China Seas, World seas）。研究目标涉及提取主要分潮（$M_{2}$、$S_{2}$、$K_{1}$、$O_{1}$）的潮汐调和常数，评估这些常数，分离正压潮和内潮，以及生成同潮图。此外，还探讨了利用特定函数进行拟合的最佳次数问题。",
      "高度计": "高度计文件夹包含关于南海海面高度异常值的数据集，用于研究主要分潮（$M_{2}$、$S_{2}$、$K_{1}$、$O_{1}$）的潮汐调和常数。文件夹内包括数据说明文档（数据说明.txt），高度计图像（高度计.jpg），以及高度计数据文件（TP.dat）。研究目标包括提取潮汐调和常数，进行正压潮和内潮的分离，设计数据插值或拟合方法生成同潮图，并利用潮汐验潮点的调和常数进行评价。"
    },
    "problem_str": "问题背景：\n2018年中国研究生数学建模竞赛D题\n\n基于卫星高度计海面高度异常资料\n\n获取潮汐调和常数方法及应用\n\n1. 潮汐潮流现象的研究意义\n\n海洋潮汐是在天体引潮力作用下形成的长周期波动现象，在水平方向上表现为潮流的涨落，在铅直方向上则表现为潮位的升降。潮汐潮流运动是海洋中的基本运动之一，它是动力海洋学研究的重要组成部分，对它的研究直接影响着波浪、风暴潮、环流、水团等其他海洋现象的研究，在大陆架浅海海洋中，对潮汐潮流的研究更具重要性。\n\n海岸附近和河口区域是人类进行生产活动十分频繁的地带，而这个地带的潮汐现象非常显著，它直接或间接地影响着人们的生产和生活。潮汐潮流工作的开展和研究，可为国防建设、交通航运、海洋资源开发、能源利用、环境保护、海港建设和海岸防护提供资料。例如，沿海地区的海滩围垦、农田排灌，水产的捕捞和养殖，制盐，海港的选址及建设，以至于潮能发电等活动，无不与潮汐潮流现象有着密切的关系。\n\n2. 潮汐潮流数值模拟所面临的问题\n\n区域海洋潮汐的数值模拟需要提供开边界的水位调和常数，而开边界的水位调和常数，或者来源于观测、或者来源于全球海洋潮汐的数值模拟；而全球海洋潮汐的数值模拟，相当耗费资源。虽然目前有国外学者或研究机构，能够提供区域海洋潮汐的调和常数，但实质上的评价结果难以令人满意。\n\n从区域海洋潮汐的数值模拟的现状来讲，四个主要分潮（$M_{2}$、$S_{2}$、$K_{1}$、$O_{1}$）的单一分潮的数值模拟与同化可以得到令人满意的结果，但其它分潮（$N_{2}$、$K_{2}$、$P_{1}$、$Q_{1}$等）的单一分潮的数值模拟与同化，结果却差强人意；这意味着其它分潮的数值模拟，只有与四个主要分潮同时进行数值模拟，才能得到可以接受的结果。从具体操作来讲，其它分潮由于相对较弱，导致模拟结果的精度难以提高。\n\n长周期分潮（$S_{a}$、$S_{sa}$、$M_{m}$、$M_{f}$）的获取，目前已有基于全球长周期分潮数值模拟手段的报道，但其面临的困境，与其它较弱分潮面临的困境没有差别。\n\n从各分潮的调和常数获取的发展史来说，通过对已有观测结果进行插值曾经是首选，但发展过程中逐渐被数值模拟方法所取代。高度计资料的出现，引发部分学者开展了插值方法的研究，并取得了一些值得一提的结果，尽管被所谓的主流方式淹没，但也难掩其光芒所在。鉴于目前已有高度计资料作为支持，其它分潮及长周期分潮的调和常数获取的插值方法研究大有可为。\\section{资料描述}\n\n\\subsection{地形数据}\n\n地形数据来自 ETOP5，全球的分辨率为 \\(5' \\times 5'\\)，图 1 的区域是 \\(2^\\circ \\sim 25^\\circ \\mathrm{N}, 99^\\circ \\sim 122^\\circ \\mathrm{E}\\)。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image.png}\n    \\caption{南海地形图}\n    \\label{fig:1}\n\\end{figure}\n\n\\subsection{验潮站资料}\n\n中国近海及周边海域 770 个验潮点的资料，和 56 个验潮点的资料（是国际上公开的长期验潮站数据分析得到的调和常数），包括 9 个分潮 \\(\\left(M_{2}、S_{2}、K_{1}、O_{1}、N_{2}、K_{2}、P_{1}、Q_{1}、S_{a}\\right)\\) 的潮汐调和常数。\n\n图 2 显示了上述资料点所在的位置，从图中可以看出上述验潮点主要分布在近岸或岛屿附近。\\subsection{TOPEX/POSEIDON 卫星高度计简介}\n\n卫星高度计是一种向卫星下方海洋发射脉冲的雷达，通过测量脉冲经海面反射之后的往返时间，获得卫星距海面的高度。主要用途：利用所得到的海面动力高度同化反演海洋重力场、流场、潮、大地水准面、海洋重力异常；根据回波强度获取风速资料；根据回波形前沿斜率获取海面有效波高。\n\nTOPEX/POSEIDON 卫星是由美国国家航空航天局和法国空间局联合于 1992 年 8 月 10 日发射的，是世界上第一颗专门为研究世界大洋环流而设计的高度计卫星。其轨道高度达 1336km，倾角为 66°，覆盖面大，保证了资料的连续性。轨道的交点周期（绕地球一圈的时间）为 6745.8s，轨道运行 127 圈以后精确重复，轨道重复周期为 9.9156 天。相邻最近的轨道之间在赤道上的间隔为 $360°/127 = 2.835°$。卫星在一个周期内的每一圈分为上行轨和下行轨两条轨道，一个完整的周期内共有 254 条轨道，沿轨道的两个相邻的星下观测点的距离为 5.75km。高度计系统的定规精度和测高精度较以前有显著提高，其测量精度约为 5cm，是目前观测海面高度精度最高的卫星。\n\n当然，本文只是涉及到 TOPEX/POSEIDON 卫星高度计资料与潮汐相关的研究，即海面高度异常产品。\\subsection{南海高度计资料}\n\n图3给出了 $2^\\circ \\sim 25^\\circ \\text{N}$, $99^\\circ \\sim 122^\\circ \\text{E}$, TOPEX/POSEIDON 卫星高度计星下观测点所在的轨道。一共有超过4000个数据点，每个点都对应一个海面高度异常的时间序列，从1992年到2017年，时间跨度为25年。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image.png}\n    \\caption{南海 TOPEX/POSEIDON 高度计资料的星下轨迹}\n    \\label{fig:3}\n\\end{figure}\n\n本题所附文件包括：\n\n1. 地形数据来自 ETOPO5，全球的分辨率为 $5' \\times 5'$，此处数据度范围 $2^\\circ \\sim 25^\\circ \\text{N}$, $99^\\circ \\sim 122^\\circ \\text{E}$（附数据说明）。\n\n2. 中国近海及周边海域验潮点的资料，包括9个分潮 ($M_2$, $S_2$, $K_1$, $O_1$, $N_2$, $K_2$, $P_1$, $Q_1$, $S_a$) 的潮汐调和常数。还包括56个验潮点的资料，同样给出了上述9个分潮的潮汐调和常数，是国际上公开的长期验潮站数据分析得到的调和常数（附数据说明）。\n\n3. 南海海面高度异常数据文件及说明。\n\n4. 调和分析方法简介（包括分潮的 Doodson 数、分潮角速度和交点因子与订正角 $\\rho_m$, $\\Delta\\mu_4^m$, $\\Delta\\mu_5^m$ 列表）\n\n本题所涉及的数据与结果，均应采用国际标准单位，即：时间单位为秒、距离单位为米、速度单位为米每秒等。\n\n问题要求：\n根据以上介绍及提供的数据文件及表格，请你们团队研究下列问题：\n\n1. 根据沿轨道的星下观测点的海面高度异常值，提取所有星下观测点各主要分潮 ($M_{2}$、$S_{2}$、$K_{1}$、$O_{1}$) 的潮汐调和常数，注意能有效提取那些分潮的潮汐调和常数取决于相应的资料长度；对提取的潮汐调和常数，应利用潮汐验潮点的调和常数给予评价或检验，并给出评价结果的分析或评价。\n\n2. 得到所有星下观测点各主要分潮 ($M_{2}$、$S_{2}$、$K_{1}$、$O_{1}$) 的潮汐调和常数，沿轨道作图后，可发现潮汐调和常数在沿轨道方向，在空间有细结构，而此细结构是内潮对正压潮的调制；请设法对沿轨道的各分潮的潮汐调和常数进行正压潮和内潮的分离。\n\n3. 设计数据插值或拟合方法给出南海的各主要分潮的同潮图，并利用潮汐验潮点的调和常数给予评价或检验，并给出评价结果的分析或评价。\n\n如果你们还有时间和兴趣，还可考虑下列：\n\n4. 如果在对沿轨道的潮汐调和常数分离、插值或拟合的过程中，利用了特定的函数进行拟合，是否能够确定出需利用的特定函数的最佳（高）次数？上述结论是否对第3问有启示或帮助。\n\n本题要求提供可计算出所提交报告中答案的计算程序，所使用的语言和工具不限，但推荐使用C/C++、Fortran、Matlab等。\nAddendum: \n本题涉及的所有数据与结果，均应采用国际标准单位，即：时间单位为秒、距离单位为米、速度单位为米每秒等。\n\n参考文献：\n[1] 陈宗镛，《潮汐学》，北京：科学出版社，1980.\n[2] 方国洪，郑文振，陈宗镛，王骥，《潮汐和潮流的分析与预报》，北京：海洋出版社，1986.\n[3] 黄祖珂，黄磊，《潮汐原理与计算》，青岛：中国海洋大学出版社，2005.\n[4] 孙丽艳：《渤黄东海潮汐底摩擦系数的优化研究》［硕士学位论文］，青岛：中国海洋大学海洋环境学院，2006.\n[5] 范丽丽：《风暴潮数值同化研究和高度计资料拟合方法研究》［硕士学位论文］，青岛：中国海洋大学海洋环境学院，2011.\n[6] Mazzega, P., and M. Berge, 1994. Ocean tides in the Asian semi-enclosed seas from TOPEX/POSEIDON. J. Geophys. Res., 99: 24,867–24,881.\n[7] Yangi, T., Morimoto A., Ichikawa K., 1997. Co-tidal and co-range charts for the East China Sea and the Yellow Sea derived from satellite altimetric data. J. Oceanography, 53: 303–309.\n[8] Fan, L.L., Wang B., Lv X.Q., 2011. Cotidal Charts near Hawaii Derived from TOPEX/Poseidon Altimetry Data. J. Atmos. Ocean Technol., 28: 606–614.\n[9] Fang, G.H., Wang Y.G., Wei Z.X., Choi B.H., Wang X.Y., Wang J., 2004. Empirical cotidal charts of the Bohai, Yellow, and East China Seas from 10 years of TOPEX/Poseidon altimetry. J. Geophys. Res., Vol.109: C11006.\n[10] Wang Y.H., Fang G.H., Wei Z.X., Wang Y.G., Wang X.Y., Xu X.Q., 2012. Cotidal charts and tidal power input atlases of the global ocean from TOPEX/Poseidon and JASON-1 altimetry. Acta Oceanol. Sin., 31(4): 11-23.\nDataset Path:\n['参考文献', '水深', '调和分析方法简介.docx', '验潮站', '高度计']\n\nData Description:\n该数据集汇聚了用于研究南海及相邻海区潮汐特征与内潮信号提取的多源资料与方法说明，包含：参考文献集合（若干PDF，讨论从高度计资料中提取内潮信号、沿轨道星下观测点海面高度异常分析、潮汐调和常数提取与评价等）；水深资料（depth.dat、水深.jpg及说明文件），用于描述海底地形对潮汐与内潮的影响；高度计资料（TP.dat、高度计.jpg及说明文件），提供卫星观测的海面高度异常以提取主要半日与日周分潮（M2、S2、K1、O1）的谐振幅与初相位；验潮站资料（含南海与东海的站点位置图、East China Seas与World seas子集及说明文件），用于潮汐调和常数的基准评价和空间插值验证；以及方法文档（“调和分析方法简介.docx”与若干数据说明），介绍潮汐调和分析基本原理、分潮角速度与初相位计算、最小二乘法提取谐和常数、正压潮与内潮分离思路及拟合/插值方法选择与阶次讨论。总体目标是通过对卫星高度计与验潮站观测的联合分析、结合水深信息，提取并检验M2、S2、K1、O1等主要分潮的调和常数，研究潮汐调和常数的空间精细结构，尝试分离正压潮与内潮成分，并设计适当的插值或拟合策略以生成南海主要分潮的同潮图及进行方法学评价。"
  },
  "problem_background": "2018年中国研究生数学建模竞赛D题\n\n基于卫星高度计海面高度异常资料\n\n获取潮汐调和常数方法及应用\n\n1. 潮汐潮流现象的研究意义\n\n海洋潮汐是在天体引潮力作用下形成的长周期波动现象，在水平方向上表现为潮流的涨落，在铅直方向上则表现为潮位的升降。潮汐潮流运动是海洋中的基本运动之一，它是动力海洋学研究的重要组成部分，对它的研究直接影响着波浪、风暴潮、环流、水团等其他海洋现象的研究，在大陆架浅海海洋中，对潮汐潮流的研究更具重要性。\n\n海岸附近和河口区域是人类进行生产活动十分频繁的地带，而这个地带的潮汐现象非常显著，它直接或间接地影响着人们的生产和生活。潮汐潮流工作的开展和研究，可为国防建设、交通航运、海洋资源开发、能源利用、环境保护、海港建设和海岸防护提供资料。例如，沿海地区的海滩围垦、农田排灌，水产的捕捞和养殖，制盐，海港的选址及建设，以至于潮能发电等活动，无不与潮汐潮流现象有着密切的关系。\n\n2. 潮汐潮流数值模拟所面临的问题\n\n区域海洋潮汐的数值模拟需要提供开边界的水位调和常数，而开边界的水位调和常数，或者来源于观测、或者来源于全球海洋潮汐的数值模拟；而全球海洋潮汐的数值模拟，相当耗费资源。虽然目前有国外学者或研究机构，能够提供区域海洋潮汐的调和常数，但实质上的评价结果难以令人满意。\n\n从区域海洋潮汐的数值模拟的现状来讲，四个主要分潮（$M_{2}$、$S_{2}$、$K_{1}$、$O_{1}$）的单一分潮的数值模拟与同化可以得到令人满意的结果，但其它分潮（$N_{2}$、$K_{2}$、$P_{1}$、$Q_{1}$等）的单一分潮的数值模拟与同化，结果却差强人意；这意味着其它分潮的数值模拟，只有与四个主要分潮同时进行数值模拟，才能得到可以接受的结果。从具体操作来讲，其它分潮由于相对较弱，导致模拟结果的精度难以提高。\n\n长周期分潮（$S_{a}$、$S_{sa}$、$M_{m}$、$M_{f}$）的获取，目前已有基于全球长周期分潮数值模拟手段的报道，但其面临的困境，与其它较弱分潮面临的困境没有差别。\n\n从各分潮的调和常数获取的发展史来说，通过对已有观测结果进行插值曾经是首选，但发展过程中逐渐被数值模拟方法所取代。高度计资料的出现，引发部分学者开展了插值方法的研究，并取得了一些值得一提的结果，尽管被所谓的主流方式淹没，但也难掩其光芒所在。鉴于目前已有高度计资料作为支持，其它分潮及长周期分潮的调和常数获取的插值方法研究大有可为。\\section{资料描述}\n\n\\subsection{地形数据}\n\n地形数据来自 ETOP5，全球的分辨率为 \\(5' \\times 5'\\)，图 1 的区域是 \\(2^\\circ \\sim 25^\\circ \\mathrm{N}, 99^\\circ \\sim 122^\\circ \\mathrm{E}\\)。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image.png}\n    \\caption{南海地形图}\n    \\label{fig:1}\n\\end{figure}\n\n\\subsection{验潮站资料}\n\n中国近海及周边海域 770 个验潮点的资料，和 56 个验潮点的资料（是国际上公开的长期验潮站数据分析得到的调和常数），包括 9 个分潮 \\(\\left(M_{2}、S_{2}、K_{1}、O_{1}、N_{2}、K_{2}、P_{1}、Q_{1}、S_{a}\\right)\\) 的潮汐调和常数。\n\n图 2 显示了上述资料点所在的位置，从图中可以看出上述验潮点主要分布在近岸或岛屿附近。\\subsection{TOPEX/POSEIDON 卫星高度计简介}\n\n卫星高度计是一种向卫星下方海洋发射脉冲的雷达，通过测量脉冲经海面反射之后的往返时间，获得卫星距海面的高度。主要用途：利用所得到的海面动力高度同化反演海洋重力场、流场、潮、大地水准面、海洋重力异常；根据回波强度获取风速资料；根据回波形前沿斜率获取海面有效波高。\n\nTOPEX/POSEIDON 卫星是由美国国家航空航天局和法国空间局联合于 1992 年 8 月 10 日发射的，是世界上第一颗专门为研究世界大洋环流而设计的高度计卫星。其轨道高度达 1336km，倾角为 66°，覆盖面大，保证了资料的连续性。轨道的交点周期（绕地球一圈的时间）为 6745.8s，轨道运行 127 圈以后精确重复，轨道重复周期为 9.9156 天。相邻最近的轨道之间在赤道上的间隔为 $360°/127 = 2.835°$。卫星在一个周期内的每一圈分为上行轨和下行轨两条轨道，一个完整的周期内共有 254 条轨道，沿轨道的两个相邻的星下观测点的距离为 5.75km。高度计系统的定规精度和测高精度较以前有显著提高，其测量精度约为 5cm，是目前观测海面高度精度最高的卫星。\n\n当然，本文只是涉及到 TOPEX/POSEIDON 卫星高度计资料与潮汐相关的研究，即海面高度异常产品。\\subsection{南海高度计资料}\n\n图3给出了 $2^\\circ \\sim 25^\\circ \\text{N}$, $99^\\circ \\sim 122^\\circ \\text{E}$, TOPEX/POSEIDON 卫星高度计星下观测点所在的轨道。一共有超过4000个数据点，每个点都对应一个海面高度异常的时间序列，从1992年到2017年，时间跨度为25年。\n\n\\begin{figure}[h]\n    \\centering\n    \\includegraphics[width=\\textwidth]{image.png}\n    \\caption{南海 TOPEX/POSEIDON 高度计资料的星下轨迹}\n    \\label{fig:3}\n\\end{figure}\n\n本题所附文件包括：\n\n1. 地形数据来自 ETOPO5，全球的分辨率为 $5' \\times 5'$，此处数据度范围 $2^\\circ \\sim 25^\\circ \\text{N}$, $99^\\circ \\sim 122^\\circ \\text{E}$（附数据说明）。\n\n2. 中国近海及周边海域验潮点的资料，包括9个分潮 ($M_2$, $S_2$, $K_1$, $O_1$, $N_2$, $K_2$, $P_1$, $Q_1$, $S_a$) 的潮汐调和常数。还包括56个验潮点的资料，同样给出了上述9个分潮的潮汐调和常数，是国际上公开的长期验潮站数据分析得到的调和常数（附数据说明）。\n\n3. 南海海面高度异常数据文件及说明。\n\n4. 调和分析方法简介（包括分潮的 Doodson 数、分潮角速度和交点因子与订正角 $\\rho_m$, $\\Delta\\mu_4^m$, $\\Delta\\mu_5^m$ 列表）\n\n本题所涉及的数据与结果，均应采用国际标准单位，即：时间单位为秒、距离单位为米、速度单位为米每秒等。",
  "problem_requirement": "根据以上介绍及提供的数据文件及表格，请你们团队研究下列问题：\n\n1. 根据沿轨道的星下观测点的海面高度异常值，提取所有星下观测点各主要分潮 ($M_{2}$、$S_{2}$、$K_{1}$、$O_{1}$) 的潮汐调和常数，注意能有效提取那些分潮的潮汐调和常数取决于相应的资料长度；对提取的潮汐调和常数，应利用潮汐验潮点的调和常数给予评价或检验，并给出评价结果的分析或评价。\n\n2. 得到所有星下观测点各主要分潮 ($M_{2}$、$S_{2}$、$K_{1}$、$O_{1}$) 的潮汐调和常数，沿轨道作图后，可发现潮汐调和常数在沿轨道方向，在空间有细结构，而此细结构是内潮对正压潮的调制；请设法对沿轨道的各分潮的潮汐调和常数进行正压潮和内潮的分离。\n\n3. 设计数据插值或拟合方法给出南海的各主要分潮的同潮图，并利用潮汐验潮点的调和常数给予评价或检验，并给出评价结果的分析或评价。\n\n如果你们还有时间和兴趣，还可考虑下列：\n\n4. 如果在对沿轨道的潮汐调和常数分离、插值或拟合的过程中，利用了特定的函数进行拟合，是否能够确定出需利用的特定函数的最佳（高）次数？上述结论是否对第3问有启示或帮助。\n\n本题要求提供可计算出所提交报告中答案的计算程序，所使用的语言和工具不限，但推荐使用C/C++、Fortran、Matlab等。",
  "problem_analysis": "总体上看，本题属于观测数据驱动的海洋潮汐与内潮识别问题，核心在于如何从分布在南海区域的卫星高度计沿轨观测点时间序列中可靠地提取主要潮汐分潮（主要是 M2、S2、K1、O1）的调和常数，进一步在空间上重建同潮图，并在此基础上尽可能地分离出由内潮（baroclinic tide）引起的细结构与大尺度的正压潮（barotropic tide）。从宏观角度，建模目标既包括计量学任务（在时空不均匀、含噪声的观测上估计每个观测点的复振幅与相位并给出不确定度），又包括物理解释任务（判定小尺度沿轨变化是否为内潮所致并给出合理的分离方法），还包括方法学任务（选择或设计合适的插值/拟合策略来生成空间连续的同潮图并用潮位站数据进行独立验证）。这些目标共同塑造了解题路径：首先需要对个别沿轨点做稳健的调和分析以得到初始谐振幅相位和误差估计，其次要把点wise结果映射到空间场，利用物理先验（如浅海中的潮汐传播、动量守恒、能量通量及与水深的关系）来约束插值或正则化，最后用独立的潮位站（尤其是长期验潮站）做交叉验证并对方法与结果的可靠性做定量评估。\n\n在设计模型与方法之前，必须批判性地识别并讨论问题陈述中显性与隐性的假设，并理解这些假设对结果的影响。第一类显性假设是线性叠加的潮汐理论：潮汐分潮可以视为确定频率下的线性正弦项之和（包括必要的交点因子和订正角），因此可以用最小二乘拟合得到振幅与相位。该假设简化了实际问题，但隐含地忽略了非线性项（如 M4、M6、组合谐波与潮流与底摩擦的非线性耦合），这些非线性成分在狭窄海峡与潮流强的浅滩处可能不可忽视并会“污染”我们对主要分潮的估计。第二类假设涉及观测系统物理与数据处理：假定高度计资料在做了常规大气、潮汐自潮、气压等校正后，剩余的主要是潮汐与随机噪声，并且测高精度约为 5 cm。但这忽略了近岸回波污染、海面状态误差、轨道定位误差、长时间尺度的海平面趋势或季节内变以及内部波/流场引起的非潮汐变异，它们都会干扰谐和分析。第三类假设是时间稳定性：用 1992–2017 年的长纪录去估计潮汐常数，隐含着假定潮汐振幅/相位在该区间内相对平稳或仅受可由节点因子调节的天文调制；但海洋动力学的长期变化、气候态（ENSO）和平均海平面上升可能导致微小时间变化，尤其内潮的产生与传播又高度依赖海水密度结构的季节/年际变化，因此需要谨慎对待。第四类假设与空间尺度有关：ETOPO5 的 5' × 5' 水深数据被用于解释地形对潮汐与内潮的影响，但该分辨率在沿海狭窄通道和复杂岛屿地形处可能过于粗糙，从而限制了对内潮产生机制和空间分布的解析度。\n\n在要素关系与相互依赖方面，卫星观测的时空采样性质、海底地形、分潮频率、海水稳度和观测噪声共同决定了能否稳定分辨不同潮汐分潮以及是否能在空间上揭示真实的物理细结构。卫星轨道几何导致的采样稀疏性与重复性（TOPEX/POSEIDON 的重复周期为 9.9156 d，127 条轨道，沿轨点相邻间隔约 5.75 km）带来两方面影响：一方面沿轨的点间距足以捕捉到数十公里尺度的內潮波动，但跨轨方向的覆盖稀疏使得二维重构受限且易产生走样（aliasing）；另一方面轨道重复周期与潮汐主要频率之间的关系会影响频率分辨能力和谱混叠，特别是近频分潮（例如 M2 与 N2 频率接近）需要更长的观测时长（频率分辨率约为 1/T）才能区分，且节点因子与订正角的周期性（例如 18.61 年的天文节点）要求较长时间纪录以正确处理天文调制。进一步的相互依赖是物理上潮汐传播（受水深与边界条件支配）决定了振幅与相位的空间连贯性，这一先验应约束插值与正则化；同时内潮是由地形不均匀与潮流与地形相互作用产生并向外辐射的条带状结构，通常表现为较小幅值但细尺度的沿轨变化，因此分离正压潮与内潮需要在空间频谱上进行区分或借助物理模型（如低模理论或潮汐潮流数值方案）来提供预估场。\n\n这些复杂关系带来一系列可预见的挑战与潜在矛盾。第一，观测与近岸潮位站之间存在尺度与响应差异：潮位站更接近海岸，受局地潮流、河口径流、风应力等非潮汐过程影响，而卫星高度计在近岸区域数据质量降低（陆影响、反射混叠），因此直接用潮位站资料作为“真值”进行评价需要慎重处理基线与代表性问题。第二，数据噪声与非潮汐信号会对谐和拟合产生偏差：如果非潮汐信号在观测频带内具有能量（例如季节内绕潮变率的非线性谐波或内部波谱），最小二乘拟合可能把它部分解释为某些潮汐分潮，导致系统性误差，因此需要在拟合中引入趋势、季节项或采用稳健回归以降低偏倚。第三，插值/拟合策略的选择存在张力：更平滑的插值（强正则化）会抑制内潮等细结构而更好地匹配大尺度正压潮；而强调保留细节的低正则化方案可能过度拟合噪声并产生虚假的细节。因此应在保真性与稳健性之间进行权衡，并利用独立验证与统计准则（例如交叉验证、信息准则）来选择正则化参数。\n\n在尺度与时间维度上，问题的复杂性还表现为动态性。首先，潮汐的核心频率是天文决定的，但幅度与相位在年际与季节尺度上可能发生变化，特别是内潮与流场耦合会随季节性分层强度改变而改变其生成效率与辐射模式；因此用长期平均的调和常数描述当下或短期状态存在一定局限性。其次，观测采样的不均匀性导致时变的有效数据长度与覆盖，某些轨迹点可能在 25 年内采样稀少或有大量间断，进而降低局部频谱分辨率并增加估计方差。对模型稳定性而言，需做灵敏性分析：例如在不同时间子集上重复估计看振幅/相位是否稳定、扰动轨道数据（添加合成噪声或移除部分样点）检验插值鲁棒性、以及通过蒙特卡洛方法估计参数不确定度。若简化或理想化处理忽略关键机制（如忽视节点因子或不进行大气/延迟校正），则可能导致系统性偏差并影响同潮图的可用性，尤其在需要海洋工程或航海应用的精度要求下后果更明显。\n\n从方法论角度，可以提出若干可替代的表述与策略：一种是纯统计-经验路线，侧重于点位的最小二乘谐和拟合加上空间统计插值（如克里金、客观分析、样条或多项式展开），强调数据驱动与交叉验证；另一种是物理-统计混合路线，利用简化的潮汐传播物理模型（例如线性浅水方程的解析近似或经验模式）作为先验或协方差模型，将观测通过调和分析与正则化同时嵌入，或通过协同同化把卫星数据同数值潮汐模型结合以实现更有物理约束的空间重构；第三种是更依赖于频谱/模态分解的方法以分离内潮，例如沿轨应用高通或带通空间滤波、常数与小尺度成分的 EOF/SSA 分解、或构建水深敏感的模式基（基于模式计算的 barotropic 模拟与内潮模态）来解释沿轨细节。不同表述的选择将影响到插值方法、是否保留细结构、如何量化不确定性以及最终结果在工程或科学上的可解释性。\n\n不确定性与风险分布在数据质量、方法选择与物理模型不完全性上。数据端的不确定性包括高度计测量误差、轨道定位误差、地球重力场与大地水准面相关误差、地面潮位站的基准差异与非潮汐扰动；方法端的风险包括拟合/插值阶次选择不当造成的欠拟合或过拟合、正则化参数选择的主观性、以及在沿轨内潮分离时误把噪音或非潮汐信号当作内潮；物理模型方面，若试图用简化模型对内潮产生机制进行解释，则受限于水深分辨率与海洋密度剖面的不足，可能无法正确再现内潮的模式与幅度。应对这些不确定性需要系统化策略：对拟合结果提供参数不确定度（通过协方差矩阵、蒙特卡洛或自举方法），进行留一交叉验证与与潮位站的独立比较，做多种插值方法与正则化参数的灵敏性试验，并在可能时用数值潮汐模型或ADCP、剖面观测等独立数据检验内潮解释。\n\n最后，需要强调建模过程的迭代性与开放性。在初期可采用较为简单且可量化的步骤：对每个沿轨点采用带天文频率项的最小二乘拟合并计算标准误差，处理节点因子并剔除明显异常；随后用低通空间滤波或物理先验得到的平滑场代表正压潮，将观测剩余视为内潮与噪声的混合并用高通方法或模态回归分离；在此基础上进行空间插值（可采用协方差函数依赖于水深或通过物理模型导出的协方差）生成同潮图并用独立潮位站做定量验证与误差统计；根据验证结果调整正则化、滤波参数或引入更复杂的物理约束（例如引入局地浅水数值模型以修正近岸相位/振幅偏差）。整个过程中要保持可复现性（保存代码、参数、交叉验证结果）并对关键假设（如时间稳定性、线性叠加）进行显式检验与敏感性分析。只有在通过多轮迭代、对方法的稳健性与物理一致性进行充分验证之后，才能对南海的同潮图及沿轨的内潮识别给出可信的结论与应用建议。",
  "modeling_solution": "总体思路与模型框架。为回答题目中既要从卫星沿轨观测时间序列可靠地提取主要潮汐分潮（M2、S2、K1、O1）的调和常数、又要在空间上分离正压潮（barotropic tide）与内潮（baroclinic tide）并生成南海同潮图，我提出一个“时域谐和提取 + 空间物理统计分解（物理先验 + 数据驱动）”的混合建模框架。该框架分两层：第一层在每个星下观测点用时间域谐和分析得到各分潮的复调和常数及其协方差；第二层在空间上对复调和常数做物理约束的分解，将观测场表示为平滑的正压潮场与沿轨方向呈细尺度振荡的内潮场之和，并通过正则化或贝叶斯更新同时估计两者及其不确定度。设计这样的两层结构既利用时间序列的频谱分辨能力，又在空间上结合地形（水深）等物理先验约束内潮产生与传播的尺度，从而提高对细结构的解释力与鲁棒性。\n\n主要假设。为便于分析与计算并保持物理意义，我作出下列假设：潮汐可在所关心（天文）频率上近似为线性叠加的谐波分量，每一分潮可用复调和常数（振幅与初相位）表示；观测的海面高度异常在经过常见的高度计预处理（去除大气潮汐、大气加载、轨道改正、潮汐自潮等常规校正）后，剩余主要由潮汐、内部波/内潮与随机观测噪声构成；正压潮在空间上平滑（特征尺度为百公里量级或更大），而内潮产生于地形与分层的相互作用并在沿轨方向表现为短横向尺度与显著的沿向振荡条带；ETOPO5 的水深可作为解释内潮产生位置与估计局地波数的先验（虽分辨率有限但仍有指示性）；时间稳定性假设适度：对 1992–2017 年长期数据可估计长期平均的调和常数并应用节点因子与订正角进行天文修正，但分析中应检验季节/年际变化的影响并在必要时对时间分段估计以量化变动性。以上假设在近岸强非线性区、非常浅海或被海岸/岛屿极度扰动的点上可能被破坏，需在数据质量控制与验证步骤中特别警示。\n\n变量和符号定义。以观测点索引 p 表示单个卫星沿轨星下点，t 表示观测时间（秒），m 表示潮汐分潮（例如 M2、S2、K1、O1）。观测的海面高度异常为 y_p(t)。对应分潮的角频率为 ω_m（由“调和分析方法简介”表给出并含交点因子及订正角处理所需的天文项）。每一分潮在点 p 的复调和常数写作 H_p^m = A_p^m e^{i φ_p^m}（A 为振幅，φ 为初相位）。时间域谐和模型写作：\ny_p(t) = Σ_m Re{ H_p^m e^{i ω_m t} } + T_p(t) + ε_p(t),\n其中 T_p(t) 包括趋势项、季节性或低频非潮汐项（可选）以减少将低频能量错误解释为潮汐分量的风险，ε_p(t) 为观测噪声与未建模过程。对时间域的最小二乘拟合将给出 H_p^m 的估计值与协方差矩阵 Cov(H_p^m).\n\n空间分解模型。在得到每个观测点的 H_p^m（复数）及其不确定度后，在空间上用下式将其分解为平滑的正压潮场 B^m(x) 与沿轨细尺度内潮场 I^m_p：\nH_p^m = B^m(x_p) + I_p^m + η_p^m.\n其中 x_p 是观测点的二维位置坐标（经纬或地理直角投影），η_p^m 是残差（观测与模型不匹配，包括估计误差）。B^m(x) 在空间上用一组低秩/光滑基函数展成（例如二维薄板样条基、球谐基、或基于高斯过程的核回归）：B^m(x) = Σ_k c_k^m φ_k(x)。I_p^m 代表内潮成分，按物理形态选用“沿轨方向波列”或“沿轨高通过滤后剩余”的表示：在最通用的形式中，沿每条轨迹 s（轨迹坐标）把 I 写为若干模态的叠加 I_p^m = Σ_r α_{t,r}^m(s_p) e^{i θ_{t,r}^m(s_p)}，或更简单地将 I_p^m 视为沿轨的高频空间成分，由带通空间滤波（以空间波长阈值 λ_c 分离）或通过沿轨的参数化正弦（幅度缓变、局地波数 k(s) 可由水深给出或从数据的沿轨空间谱估计）来提取。为保证可解性与稳定性，我建议采用下述折衷参数化：B^m 用低阶平滑基函数表示（k 个基，k << p），I_p^m 在每条轨迹上用局地正弦包（amplitude envelope × e^{i ∫ k(s) ds }）或直接用带通空间滤波得出的复值残差表示，并在跨轨方向加平滑约束以反映内潮沿跨轨方向的有限扩散。\n\n目标函数与正则化。将上述表示写成矩阵形式 H = Φ c + I + η，其中 H 是复杂向量（所有观测点的 H_p^m），Φ 为基函数到点的设计矩阵，c 是待估系数向量，I 是内潮向量。构造目标函数（带权最小二乘 + 正则项）：\nJ(c, I) = ||W (Φ c + I - H)||_2^2 + λ_b ||L_b c||_2^2 + λ_i ||L_i I||_2^2.\n其中 W 是观测权重矩阵（通常为 Cov(H)^{-1/2}，反映每点估计的不确定度及数据质量），L_b 是对 B 的空间光滑算子（例如离散的二阶导数或拉普拉斯算子），λ_b 控制正压潮平滑强度；L_i 对 I 的正则化可采用两类项的组合：一是跨轨方向的平滑（抑制非物理的横向随机波动），二是频域约束（鼓励 I 在某一波数带宽内有能量，即在空间傅里叶域约束其谱为指定带通），λ_i 控制内潮能量的正则化强度。若采用贝叶斯框架，上式对应最大后验估计，先验协方差可与上述正则项对应写出，从而可以得到后验协方差的解析近似以量化不确定度。\n\n求解策略与迭代算法。求解可采用交替最小化（Alternating Minimization）或联合求解的线性/准线性方法。一个稳健的工作流程是：第一步，在每个观测点对时间序列用加权最小二乘拟合提取 H_p^m 并得到其协方差（采用QR或SVD以增加数值稳定性；在设计矩阵中包含 cos(ωt), sin(ωt) 项、趋势项和若干长周期项以降低误配）；第二步，用简单空间平滑（例如克里金或二维薄板样条，用观测不确定度加权）得到初始的 B^{m,(0)}；第三步 得到初始内潮残差 I^{(0)} = H - Φ c^{(0)}。第四步 对每条轨迹用沿轨谱分析（空间 FFT 或多段 Welch 方法）估计内潮的主要空间波数 k(s) 或主要波长 λ；若可用水深与分层先验，可用线性模态理论（两层或连续 Stratified 模型的近似色散关系）将局地水深转换为第一模态的近似波长作为初值。第五步 在已估计 k(s) 的基础上，对 I 在每条轨迹上做调制正弦振幅拟合（复幅度随 s 缓慢变化，利用平滑基展开或正则化），得到改进的 I。第六步 固定 I，利用权重 W 求解对 c 的线性正则化最小二乘问题（可用共轭梯度或直接 SVD，Φ 通常较稀疏或可通过基函数压缩处理）。第七步 重复上述交替步骤直至 J 收敛或残差减小至阈值。若选择联合求解，可将未知量合并为一个大线性系统并用稀疏线性代数（如带正则化的最小二乘）直接求解；若参数维度较大，采用迭代求解器（共轭梯度、LSQR）并在每次乘积中利用 Φ 的结构加速。\n\n时间域谐和分析的细节与频率可分辨性。对时间域拟合必须考虑记录长度对频率分辨率的限制：频率分辨率约为 1/T，总记录 25 年可以分离许多近频分潮（例如 M2 与 N2 相近需较长记录才能分辨）。设计时在拟合中应包含天文节点因子、订正角（题中给资料列表）与必要的次要长周期项以降低混叠误差。对包含缺测和不规则采样的点，采用加权最小二乘并用协方差估计点误差。输出 H_p^m 的误差协方差将用于第二层空间倒算中的权重 W。\n\n内潮与正压潮的分离策略（方法上创新点）。传统的做法通常通过空间低通/高通滤波来分离，但单纯滤波易受采样与噪声影响。我的建议是采用“物理先验 + 频域约束”的混合方法：首先利用水深字段与线性内潮模态理论给出内潮主波长范围的先验（若无直接剖面数据，采用典型分层参数以得到波速近似并据此估计第一模的波长 λ1 ≈ 2π c_1 / ω_m，其中 c_1 可由两层模型近似或经验关系获得）；然后在沿轨方向用带通空间滤波器定位在该波长带的能量作为候选内潮成分；接着把该候选成分作为 I 的初值并在整个空间上用正则化拟合其振幅场，使其在跨轨方向上连续且在非产生区被抑制。该策略将高频空间信息与地形物理机制相结合，既能抑制噪声误检，又能保留物理上合理的内潮条带。进一步，内潮模式可以用 EOF/SSA（经验正交分解 / 单变量谱分析）在沿轨集合上提取具有相干性的模态（横向扩展或跨轨相关），并将这些模态作为 I 的基函数之一，这在不同轨迹上共存的内潮辐射带能被一致解释。\n\n插值/生成同潮图的方法与模型选择。对于正压潮 B^m(x) 的空间重建，建议使用物理约束的高斯过程回归（GP）或协方差驱动的克里金方法，其协方差函数设计应基于两方面信息：地形相关性（例如与水深有关的相关尺度）与卫星覆盖的各向异性（沿轨方向的分辨率高于跨轨）。协方差可参数化为 Sigma(x,x') = σ^2 exp( -|x-x'|^2 / (2 L^2(x,x')) )，其中 L 可作为水深的函数（浅海水域 L 较小，代表更快的空间变化）。超参数（σ, L 等）通过最大似然或交叉验证估计。若需要面向工程应用的快速同潮图生成，可把 B 用二维薄板样条或低阶球谐展开，这些方法便于并行化与快速求解。对内潮 I 的空间插值推荐沿轨插值后在跨轨方向用平滑或调和延拓（harmonic continuation）约束，避免跨水深断崖的不合理延伸。\n\n不确定性量化与验证策略。全过程要把不确定性传播纳入：先在时间域获得 H_p^m 的协方差矩阵 Cov(H)；在空间倒算中用 W = Cov(H)^{-1/2} 加权以体现每点不确定性；对最终解 B 和 I 的不确定度可利用线性逆问题的后验协方差解析估算（若目标为线性），或用蒙特卡洛/自举（bootstrap）通过对时间序列随机抽取子样本、或对轨道样本进行留一交叉验证以评估稳健性。用于独立验证的基准为题目给出的 56 个长期潮位站的调和常数：把重构的 B^m(x)（或 B+I，视需求）插值到潮位站位置并与站点调和常数比较，统计偏差、均方根误差、相位误差与相关系数；同时做留一法交叉验证（对卫星点逐点或逐轨留出）以选择正则化参数 λ_b、λ_i 以及空间滤波带宽，使用 AIC、BIC 或预测交叉验证误差作为选择准则。还应检查重构结果在潮流动力学上的物理一致性（例如计算能量通量及与地形的局地集中是否符合内潮辐射机制），并用合成试验（向无噪观测中注入合成内潮分量）检验方法的检出率与误检率。\n\n数值实现与计算要求。数据量级方面：题中区域约 4000 个星下点、25 年时间序列，对每点进行谐和分析的计算量可通过逐点线性最小二乘分解高效完成；Φ 基函数数目建议控制在几百以内以便求解稳定且便于并行。时间域拟合采用逐点加权最小二乘，利用 QR/SVD 以获得稳健估计与协方差；空间倒算采用稀疏矩阵技术与迭代线性解算器（LSQR、共轭梯度），并对 Φ、L_b、L_i 采用稀疏存储与按轨块处理以降低内存占用。可并行化部分包括：点级的时间域拟合、轨道级的沿轨谱分析与内潮参数估计，以及空间正则化求解中的矩阵乘法（利用多核或集群并行）。对于求解精度，时间域谐和拟合的标准误差将由观测长度、噪声水平与模型项数决定；空间倒算的目标是使模型误差（在独立潮位站上的预测误差）在可接受范围内（例如振幅误差小于若干厘米、相位误差在数度范围内，具体可与题目中给出的验潮站精度要求对照）。\n\n敏感性、稳定性与诊断。要执行一套系统的敏感性分析：对 λ_b、λ_i、带通滤波波长阈值 λ_c、基函数数目 k、水深依赖协方差尺度函数 L(depth) 等超参数进行网格搜索与交叉验证，评估输出 B 与 I 在这些参数下的变化；对不同时间子集（例如分季节或十年段）重复估计以检查潮位常数是否稳态并检测内潮的季节变化；对轨道采样缺失与噪声进行蒙特卡洛扰动以评估解的鲁棒性。若观测在近岸受陆地干扰严重，应在数据预处理阶段标记并弱化（或剔除）这些点，以防止污染大尺度解。\n\n可扩展性与未来改进。该框架具高度可扩展性：可把更多卫星（JASON 系列等）并入时间域拟合中以提高空间覆盖与频谱分辨；可把数值潮汐模式（线性/非线性浅水方程模式）的输出作为 B 的先验或作为协方差的基准，实现物理同化（variational 或统计同化）以进一步约束正压潮；若获得密度剖面（CTD、Argo）数据，可直接用垂直模态理论计算更准确的内潮模态结构与色散关系，并把模态基引入 I 的表示以提高物理可解释性。方法上还可将交替最小化推广为完全贝叶斯层次模型并用 MCMC 或变分贝叶斯求解，从而得到更完整的不确定性描述（代价更高）；或采用稀疏正则化（L1）以寻找少数显著的内潮通道。最后，可将所得内潮与正压潮分量用于能量通量估计、潮汐耗散计算或作为区域潮汐同化的边界条件，这些都是后续应用方向。\n\n具体公式与实现要点（概要）。时间域拟合用设计矩阵 D_p(t) 含 cos(ω_m t), sin(ω_m t) 项及必要的长期项，求解 β_p = (D_p^T W_t D_p)^{-1} D_p^T W_t y_p 得到分潮的系数，复常数 H_p^m = β_{p,cos} - i β_{p,sin}（或等价形式），其协方差 Cov(H_p) 由拟合残差与 D_p 的正规矩阵给出。空间倒算以复数线性最小二乘为本，求解：\nmin_{c,I} ||W (Φ c + I - H)||^2 + λ_b ||L_b c||^2 + λ_i ||L_i I||^2,\n可交替解： c = argmin ||W (Φ c - (H - I))||^2 + λ_b ||L_b c||^2（这是线性的），I 对每条轨迹独立解或在所有轨迹上用带通约束解。若 I 在轨迹上参数化为 I_t(s) = a_t(s) e^{i ψ_t(s)}（a, ψ 缓变），可把 a、ψ 用低秩基（样条）展开并用非线性拟合（或线性化的复系数拟合）估计。\n\n总结性说明。该模型融合了传统谐和分析、空间统计插值与物理约束的内潮模态思路，并在算法上采用带权正则化与交替最小化以在噪声与欠采样条件下稳健地分离正压潮与内潮。它能利用题目提供的长时间序列优势提高频率分辨力，并利用水深这一物理信息约束内潮的空间尺度，从而在生成南海主要分潮同潮图的同时揭示沿轨的细结构并给出明确的不确定度估计。该方案便于实现、可并行化、对超参数有明确定量选择准则（交叉验证、信息准则），并为将来引入数值潮汐模式同化、垂直模态物理约束或贝叶斯层级建模提供清晰扩展路径。",
  "task_descriptions": [
    "子任务1（单点时域谐和提取）的目标是以可重复、可量化的程序从每个卫星星下观测点的海面高度异常时间序列中精确估计 M2、S2、K1、O1 四个分潮的复调和常数（振幅与相位）并给出每个估计值的协方差与质量标识；其范围仅限于数据准备、逐点建模与不确定度评估，不涉及空间插值或物理分解。为实现该目标，应按以下确定性步骤执行：一是输入与初步筛选——读取提供的 TOPEX/POSEIDON 高度计时间序列文件（TP.dat）和“调和分析方法简介”中给出的各分潮角速度、交点因子与订正角表，读取 ETOPO5 水深/陆地掩膜用于识别近岸/陆缘观测并标注潜在的陆污染点；二是数据预处理——对每条时间序列做时间基线统一（将时间转换为秒并对齐天文历算所需参考时刻）、剔除显著孤立异常值、填记缺测并记录有效样本数与时间跨度；如高度计产品未包含常规校正，则应一并应用或确认已应用轨道改正、电离层/对流层延迟校正、海面状态误差校正与潮汐自潮等（若无法校正则在质量标识中说明）；三是模型与设计矩阵构建——为每一点构造时域线性模型 y(t)=Σ_m [C_m cos(ω_m t+Δ_m(t)) + S_m sin(ω_m t+Δ_m(t))] + T(t) + ε(t)，其中 ω_m 取自题库，Δ_m(t) 包含交点因子/订正角的天文时间依赖性，T(t) 至少包含常数项与一次趋势或必要的长周期项以减少低频能量对天文频率成分的泄漏；四是最小二乘求解与数值稳定性——使用加权线性最小二乘（权重可设为观测不确定度的倒数或一律为1）并通过 QR 分解或 SVD 求解 normal 方程以保证数值稳定，同时为不服从高斯噪声的异常点提供稳健替代（如迭代重加权最小二乘或 Huber 损失选项）；五是不确定度与显著性评估——从拟合残差估计噪声方差，计算参数协方差矩阵 Cov(β)=(D^T W D)^{-1} σ^2，从 cos/sin 对应系数转换为复调和常数 H_m=A_m e^{iφ_m} 并用误差传播给出振幅 A_m 的标准误及相位 φ_m 的不确定度；六是频率可分辨性判定——对每一条记录计算频率分辨率 Δf≈1/T 并与目标分潮间的频率差比较，若 Δf 太大导致谱混叠则在输出中标注“不可分辨/需联合拟合”并记录推荐处理策略；七是质量控制与输出格式——为每个观测点输出：点位信息、时间跨度与样本数、每一分潮的振幅、相位、复常数、参数协方差矩阵、拟合残差统计（RMS、偏差）、信噪比与最终质量标识（基于样本数、记录长度、残差水平与参数显著性阈值）；并把实现细节（所用角速度表、节点因子计算公式、权重与离散化设置、SVD/QR库版本）记录为元数据以确保可复现。建议使用数值线性代数成熟的软件环境（如 MATLAB 的 backslash/SVD、Python 的 numpy/scipy.linalg、或 Fortran/C++ 调用 LAPACK），并对大批量点并行化逐点拟合以提高效率；整个子任务的验收标准为：对每个有足够记录长度的星下点均产生一套完整的谐和常数、对应不确定度与质量标识文件，且所有计算步骤和参数设置在元数据中被明确定义以便审查与复现。",
    "子任务 2（空间分解与正压潮/内潮初始分离）旨在把每一潮汐分潮在所有观测点的复调和常数 H_p (复数，含振幅与相位) 分解为平滑的正压潮场 B(x) 与沿轨细尺度的内潮场 I_p 的线性和，明确任务范围为以数值化、可复现的逆问题方法在给定输入数据与先验下估计 B(x) 与 I_p 及其近似不确定度，并输出用于后续插值与分析的参数化表示；所需输入为：所有观测点的地理位置 x_p（经纬须投影到局部笛卡尔网格）、每点对应的复调和常数 H_p 及其协方差矩阵或方差估计、ETOPO5 水深字段用于地形先验与产生区指示、目标分潮的角频率与节点/订正因子表。方法要点如下：模型设定为 H = Φ c + I + η，其中 Φ c 是 B(x) 在选定平滑基（可选二维薄板样条基、低阶球谐或基于高斯过程的核基，其系数为 c）上的展开，I 在观测点直接表示为沿轨带通/高频成分（按轨迹索引独立参数化以保留沿轨细结构），η 为观测残差；权重矩阵 W 由 H_p 的协方差决定（通常取 W = Cov(H)^{-1/2}）并在目标函数中用于加权。构造带正则化的加权最小二乘目标 J(c,I) = || W (Φ c + I − H) ||^2 + λ_b || L_b c ||^2 + λ_i || L_i I ||^2，其中 L_b 为鼓励 B 在空间上平滑的算子（如离散拉普拉斯或二阶导算子），L_i 对 I 作两类约束：一是沿轨带通/谱约束（鼓励 I 的空间谱集中在由地形与模态理论给出的波长范围内），二是跨轨方向平滑以抑制随机噪声；正则化参数 λ_b、λ_i 通过广义交叉验证、留一交叉验证或 L-curve 法确定。实现步骤明确为：1) 用 ETOPO5 与经验两层近似模型估计每条轨迹局地第一模相速度与对应的主波长λ1（采用 g' = g Δρ/ρ 与 c1^2 ≈ g' h1 h2/(h1+h2) 的两层近似，并对 Δρ/ρ 采用合理区间做敏感性检验），据此设定沿轨带通中心波长及带宽；2) 在每条轨上对 H 的空间分布做谱分析（FFT/Welch）以识别显著沿向波数并初始化 I 的复值初始场（例如通过沿轨带通滤波得到初值）；3) 在初始化后采用交替最小二乘迭代：固定 I 解线性正则化问题求 c（用 SVD 或带Tikhonov正则的正规方程/LSQR求解器），再固定 c 在每条轨上用带通参数化（振幅用样条或低秩基表示，复相位按累计波数积分或以直接复系数形式拟合）解 I 的正则化问题（每轨可并行化，利用频域先验约束以改善稳定性）；4) 迭代直至模型减小或系数收敛；5) 用线性逆问题理论近似后验协方差（若规模允许）或用蒙特卡洛重采样在有限次迭代上估算 B 与 I 的不确定度。数值与实现细节：所有空间运算在局部笛卡尔投影下完成，沿轨谱估计建议采用重叠窗的Welch方法以降低方差；线性代数求解采用稳健的库（例如 LAPACK/SVD、scipy.sparse+LSQR、MATLAB backslash），并行策略按轨或按点并行以提高效率；正则化算子和带通滤波器在离散化时需与观测点间距相匹配（节距建议 5–50 km 范围内调整）；最终结果应包括 Φ c 的系数、每轨 I 的参数化系数、模型残差统计与用于超参数选择的验证度量。该子任务不涉及对时间域拟合的实现细节或最终同潮图的展示，其交付物为可复现的程序/脚本与数值解：B(x)（基系数或栅格场）、沿轨 I 参数化及其不确定度估计、并附超参数选择与谱分析报告，以便独立验证与后续空间插值。",
    "子任务 3 的目标是从给定的点位潮汐调和常数（每个观测点的复调和常数 H_p^m 或等价的振幅/相位及其协方差）、观测点位置与地形（水深格网与陆地掩膜）、以及用于独立验算的潮位站调和常数出发，构建可发布的南海范围内每个主要分潮（M2、S2、K1、O1）的空间场（同潮图：复调和常数或振幅场与相位场）并对结果进行定量验证与不确定度量化；为此应按以下步骤实施：一是数据准备与投影：将点位坐标投影到局部笛卡尔网格，应用陆地掩膜剔除陆上点，检查并统一复值表示（优先使用复数形式 H = A e^{iφ}，或实虚部），对相位进行环绕展开以避免插值伪影并保留协方差信息用于加权；二是网格与分辨率设计：明确输出栅格（经纬或投影坐标）分辨率并确保与观测空间密度与内潮尺度相匹配，设置近岸缓冲区处理规则以避免陆地外推；三是插值/拟合方法选择：优先采用带物理先验和不确定度传递能力的协方差驱动方法（如克里金/高斯过程回归），协方差函数可设计为各向异性且与水深相关的尺度函数 L(depth)（允许沿轨方向短尺度、跨轨方向长尺度的各向异性），同时提供薄板样条与低阶基展开（球谐或多项式）作为备用或快速替代；在插值复数调和常数时可直接对复数场进行克里金或分别对实部与虚部插值并在结果处重建振幅与相位，但必须处理相位连续性问题；四是超参数标定与正则化：用留一交叉验证（LOO）、K 折或最大似然估计确定协方差超参数（方差、相关尺度、各向异性方向）及平滑/正则化强度，必要时采用留轨（按卫星轨道）和留站两类交叉验证以评估对不同采样模式的稳健性，并用 L-curve、AIC/BIC 或预测误差作为判据；五是不确定度传播：利用点位协方差矩阵在克里金框架内解析得到栅格后验协方差以生成每像元的置信区间；若点位协方差不可用或模型非线性，则采用蒙特卡洛法或自举：从每点的联合误差分布中抽样生成若干实现并分别插值以统计输出分布；六是内潮/高频残差处理与输出合成：若输入包括已分离的平滑正压场与沿轨残差，则将两部分按物理规则在栅格上合成（先插值平滑场，再按轨延拓或用模态基在跨轨方向平滑内潮残差并加回），否则在插值前对点位数据采用空间带通或协方差滤波以避免将细尺度内潮误解释为大尺度场；七是验证与诊断：在潮位站位置进行独立预测并计算评价指标（偏差 bias、均方根误差 RMSE、相位误差（度）与向量差、相关系数 R、标准化残差分布），同时做留一/留轨交叉验证报告，输出残差的空间分布图、功率谱或空间自相关以检测未建模的细结构或过度平滑；八是成果与交付物：生成每分潮的复调和常数栅格（或振幅与相位栅格）、对应的不确定度栅格、验证统计报告、残差与诊断图、以及用于再现的插值/协方差模型参数与超参数选择记录；九是建议的实现工具与数值注意事项：可采用 Python（numpy/scipy、pykrige/GSTools、scikit-learn）、R（gstat、fields）或 MATLAB（Kriging/fit functions）等成熟库并利用并行化处理大规模蒙特卡洛采样，注意对观测稀疏区与近岸区域采取保守外推策略以避免非物理插值。该子任务的交付应包含可重复的代码或脚本、明确的输入/输出格式、以及完整的超参数选择与交叉验证记录，以便独立复现和客观评价同潮图的精度与不确定性。",
    "子任务4（敏感性分析、稳健性检验与可扩展性改进）的目标是系统、可重复地量化并最小化模型与数据处理管线中所有关键超参数、假设和数据质量问题对最终潮汐/内潮分解与插值结果的影响，并提出明确的改进与实现建议；为此该子任务应独立完成下列工作流程：一是明确输入与可变集——接收经预处理的点位复调和常数及其协方差矩阵、观测点位置、ETOPO5 水深栅格、潮位站基准数据以及任何用于先验（如模态波速估计）的参数范围；二是列出需敏感性检验的超参数和假设清单（例如正压潮平滑强度 λ_b、内潮正则化 λ_i、沿轨带通中心波长与带宽 λ_c、平滑/基函数阶数 k、协方差尺度函数 L(depth)、时间分段长度、近岸数据筛选阈值与观测权重策略）；三是设计并实施系统化试验方案——对每个超参数做有控制的单变量扫描与多变量格点搜索，并结合留一/留轨/留站交叉验证、K 折验证、以及基于预测误差的模型选择指标（交叉验证误差、AIC/BIC、L-curve 曲线拐点），记录每组设置下的判据（振幅 RMSE、相位误差（度）、偏差、归一化残差分布、相关系数、功率谱与相干性、以及对潮位站的独立预测误差）；四是数据质量敏感性试验——系统模拟并评估近岸陆地污染、轨道定位偏差、缺测与不规则采样、不同噪声水平与非潮汐周期成分对反演结果的影响（通过在原始时间序列或点位 H 上注入合成误差或随机丢点实现），并确定对观测权重或剔除规则的定量阈值；五是合成检验与性能边界识别——用多组已知参数的合成试验（在真场中注入合成正压潮+若干幅值/波长/相位的内潮分量并加入噪声）评估方法的检出率、误检率、灵敏度阈值和定位精度，绘制 ROC 曲线或检出概率随内潮振幅/波长的变化曲线；六是比较不同方法与正则化形式——在同一数据集上并行实现并比较若干替代方案（纯空间低通/高通滤波、沿轨带通滤波+样条幅度拟合、EOF/SSA 模态分解、基于协方差的克里金/GP 以及基于物理模态先验的混合正则化），用相同验证指标量化各自优劣与适用情形；七是不确定性传播与稳健性评估——采用蒙特卡洛重采样、自举与（如计算资源允许）近似贝叶斯方法（变分贝叶斯或 MCMC 的简化实现）来量化最终场的置信区间与参数后验分布，并检验结果对随机种子、初值与迭代收敛容忍度的敏感性；八是计算实现与可扩展性要求——为大规模网格搜索、蒙特卡洛和多方法比较采用并行化策略（按点/按轨/按超参数并行），推荐使用数值库与算法如 FFT/Welch（空间谱）、SVD/QR（稳健线性解）、LSQR/CG（迭代稀疏线性求解）、以及 Python（numpy/scipy、dask）、MATLAB、或高性能 C++/Fortran + MPI 实现，并给出内存、CPU 与并行度估算及收敛判据（例如目标函数相对变化 < 1e-4 或超参数改变量低于阈值）；九是结果整理与决策规则——基于上述试验给出一套推荐的默认超参数、数据筛选规则和方法选择指南（并提供在不同数据覆盖/噪声情形下的备选方案），同时生成完整的诊断输出（超参数敏感性图、交叉验证曲面、合成实验 ROC、残差与谱图、及对潮位站的独立验证汇总），并在可复现的代码包中记录所有随机种子、版本信息与参数集合以便审查与复现。该子任务仅产出敏感性分析、稳健性结论、推荐参数与实施规范及可复现的测试和验证脚本，不产生或讨论最终的潮汐场解本身。"
  ]
}